function uiCodemirrorDirective(t,e){function n(t,n,s,l){var u=angular.extend({value:n.text()},e.codemirror||{},t.$eval(s.uiCodemirror),t.$eval(s.uiCodemirrorOpts)),c=r(n,u);i(c,s.uiCodemirror||s.uiCodemirrorOpts,t),o(c,l,t),a(c,s.uiRefresh,t),t.$on("CodeMirror",function(t,e){if(!angular.isFunction(e))throw new Error("the CodeMirror event requires a callback function");e(c)}),angular.isFunction(u.onLoad)&&u.onLoad(c)}function r(t,e){var n;return"TEXTAREA"===t[0].tagName?n=window.CodeMirror.fromTextArea(t[0],e):(t.html(""),n=new window.CodeMirror(function(e){t.append(e)},e)),n}function i(t,e,n){function r(e,n){angular.isObject(e)&&i.forEach(function(r){if(e.hasOwnProperty(r)){if(n&&e[r]===n[r])return;t.setOption(r,e[r])}})}if(e){var i=Object.keys(window.CodeMirror.defaults);n.$watch(e,r,!0)}}function o(t,e,n){e&&(e.$formatters.push(function(t){if(angular.isUndefined(t)||null===t)return"";if(angular.isObject(t)||angular.isArray(t))throw new Error("ui-codemirror cannot use an object or an array as a model");return t}),e.$render=function(){var n=e.$viewValue||"";t.setValue(n)},t.on("change",function(t){var r=t.getValue();r!==e.$viewValue&&n.$evalAsync(function(){e.$setViewValue(r)})}))}function a(e,n,r){n&&r.$watch(n,function(n,r){n!==r&&t(function(){e.refresh()})})}return{restrict:"EA",require:"?ngModel",compile:function(){if(angular.isUndefined(window.CodeMirror))throw new Error("ui-codemirror needs CodeMirror to work... (o rly?)");return n}}}!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){function e(t){if(t in d.style)return t;for(var e=["Moz","Webkit","O","ms"],n=t.charAt(0).toUpperCase()+t.substr(1),r=0;r<e.length;++r){var i=e[r]+n;if(i in d.style)return i}}function n(){return d.style[h.transform]="",d.style[h.transform]="rotateY(90deg)",""!==d.style[h.transform]}function r(t){return"string"==typeof t&&this.parse(t),this}function i(t,e,n){e===!0?t.queue(n):e?t.queue(e,n):t.each(function(){n.call(this)})}function o(e){var n=[];return t.each(e,function(e){e=t.camelCase(e),e=t.transit.propertyMap[e]||t.cssProps[e]||e,e=l(e),h[e]&&(e=l(h[e])),t.inArray(e,n)===-1&&n.push(e)}),n}function a(e,n,r,i){var a=o(e);t.cssEase[r]&&(r=t.cssEase[r]);var s=""+c(n)+" "+r;parseInt(i,10)>0&&(s+=" "+c(i));var l=[];return t.each(a,function(t,e){l.push(e+" "+s)}),l.join(", ")}function s(e,n){n||(t.cssNumber[e]=!0),t.transit.propertyMap[e]=h.transform,t.cssHooks[e]={get:function(n){var r=t(n).css("transit:transform");return r.get(e)},set:function(n,r){var i=t(n).css("transit:transform");i.setFromString(e,r),t(n).css({"transit:transform":i})}}}function l(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function u(t,e){return"string"!=typeof t||t.match(/^[\-0-9\.]+$/)?""+t+e:t}function c(e){var n=e;return"string"!=typeof n||n.match(/^[\-0-9\.]+/)||(n=t.fx.speeds[n]||t.fx.speeds._default),u(n,"ms")}t.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var d=document.createElement("div"),h={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;h.transition=e("transition"),h.transitionDelay=e("transitionDelay"),h.transform=e("transform"),h.transformOrigin=e("transformOrigin"),h.filter=e("Filter"),h.transform3d=n();var f={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},g=h.transitionEnd=f[h.transition]||null;for(var v in h)h.hasOwnProperty(v)&&"undefined"==typeof t.support[v]&&(t.support[v]=h[v]);return d=null,t.cssEase={_default:"ease",in:"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},t.cssHooks["transit:transform"]={get:function(e){return t(e).data("transform")||new r},set:function(e,n){var i=n;i instanceof r||(i=new r(i)),"WebkitTransform"!==h.transform||p?e.style[h.transform]=i.toString():e.style[h.transform]=i.toString(!0),t(e).data("transform",i)}},t.cssHooks.transform={set:t.cssHooks["transit:transform"].set},t.cssHooks.filter={get:function(t){return t.style[h.filter]},set:function(t,e){t.style[h.filter]=e}},t.fn.jquery<"1.8"&&(t.cssHooks.transformOrigin={get:function(t){return t.style[h.transformOrigin]},set:function(t,e){t.style[h.transformOrigin]=e}},t.cssHooks.transition={get:function(t){return t.style[h.transition]},set:function(t,e){t.style[h.transition]=e}}),s("scale"),s("scaleX"),s("scaleY"),s("translate"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),r.prototype={setFromString:function(t,e){var n="string"==typeof e?e.split(","):e.constructor===Array?e:[e];n.unshift(t),r.prototype.set.apply(this,n)},set:function(t){var e=Array.prototype.slice.apply(arguments,[1]);this.setter[t]?this.setter[t].apply(this,e):this[t]=e.join(",")},get:function(t){return this.getter[t]?this.getter[t].apply(this):this[t]||0},setter:{rotate:function(t){this.rotate=u(t,"deg")},rotateX:function(t){this.rotateX=u(t,"deg")},rotateY:function(t){this.rotateY=u(t,"deg")},scale:function(t,e){void 0===e&&(e=t),this.scale=t+","+e},skewX:function(t){this.skewX=u(t,"deg")},skewY:function(t){this.skewY=u(t,"deg")},perspective:function(t){this.perspective=u(t,"px")},x:function(t){this.set("translate",t,null)},y:function(t){this.set("translate",null,t)},translate:function(t,e){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==t&&void 0!==t&&(this._translateX=u(t,"px")),null!==e&&void 0!==e&&(this._translateY=u(e,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var t=(this.scale||"1,1").split(",");return t[0]&&(t[0]=parseFloat(t[0])),t[1]&&(t[1]=parseFloat(t[1])),t[0]===t[1]?t[0]:t},rotate3d:function(){for(var t=(this.rotate3d||"0,0,0,0deg").split(","),e=0;e<=3;++e)t[e]&&(t[e]=parseFloat(t[e]));return t[3]&&(t[3]=u(t[3],"deg")),t}},parse:function(t){var e=this;t.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(t,n,r){e.setFromString(n,r)})},toString:function(t){var e=[];for(var n in this)if(this.hasOwnProperty(n)){if(!h.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(t&&"scale"===n?e.push(n+"3d("+this[n]+",1)"):t&&"translate"===n?e.push(n+"3d("+this[n]+",0)"):e.push(n+"("+this[n]+")"))}return e.join(" ")}},t.fn.transition=t.fn.transit=function(e,n,r,o){var s=this,l=0,u=!0,d=t.extend(!0,{},e);"function"==typeof n&&(o=n,n=void 0),"object"==typeof n&&(r=n.easing,l=n.delay||0,u="undefined"==typeof n.queue||n.queue,o=n.complete,n=n.duration),"function"==typeof r&&(o=r,r=void 0),"undefined"!=typeof d.easing&&(r=d.easing,delete d.easing),"undefined"!=typeof d.duration&&(n=d.duration,delete d.duration),"undefined"!=typeof d.complete&&(o=d.complete,delete d.complete),"undefined"!=typeof d.queue&&(u=d.queue,delete d.queue),"undefined"!=typeof d.delay&&(l=d.delay,delete d.delay),"undefined"==typeof n&&(n=t.fx.speeds._default),"undefined"==typeof r&&(r=t.cssEase._default),n=c(n);var p=a(d,n,r,l),f=t.transit.enabled&&h.transition,v=f?parseInt(n,10)+parseInt(l,10):0;if(0===v){var m=function(t){s.css(d),o&&o.apply(s),t&&t()};return i(s,u,m),s}var y={},b=function(e){var n=!1,r=function(){n&&s.unbind(g,r),v>0&&s.each(function(){this.style[h.transition]=y[this]||null}),"function"==typeof o&&o.apply(s),"function"==typeof e&&e()};v>0&&g&&t.transit.useTransitionEnd?(n=!0,s.bind(g,r)):window.setTimeout(r,v),s.each(function(){v>0&&(this.style[h.transition]=p),t(this).css(d)})},x=function(t){this.offsetWidth,b(t)};return i(s,u,x),this},t.transit.getTransitionValue=a,t}),function(t){function e(t){var e=t.length,r=n.type(t);return"function"!==r&&!n.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===r||0===e||"number"==typeof e&&e>0&&e-1 in t))}if(!t.jQuery){var n=function(t,e){return new n.fn.init(t,e)};n.isWindow=function(t){return null!=t&&t==t.window},n.type=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i[a.call(t)]||"object":typeof t},n.isArray=Array.isArray||function(t){return"array"===n.type(t)},n.isPlainObject=function(t){var e;if(!t||"object"!==n.type(t)||t.nodeType||n.isWindow(t))return!1;try{if(t.constructor&&!o.call(t,"constructor")&&!o.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||o.call(t,e)},n.each=function(t,n,r){var i,o=0,a=t.length,s=e(t);if(r){if(s)for(;o<a&&(i=n.apply(t[o],r),i!==!1);o++);else for(o in t)if(i=n.apply(t[o],r),i===!1)break}else if(s)for(;o<a&&(i=n.call(t[o],o,t[o]),i!==!1);o++);else for(o in t)if(i=n.call(t[o],o,t[o]),i===!1)break;return t},n.data=function(t,e,i){if(void 0===i){var o=t[n.expando],a=o&&r[o];if(void 0===e)return a;if(a&&e in a)return a[e]}else if(void 0!==e){var o=t[n.expando]||(t[n.expando]=++n.uuid);return r[o]=r[o]||{},r[o][e]=i,i}},n.removeData=function(t,e){var i=t[n.expando],o=i&&r[i];o&&n.each(e,function(t,e){delete o[e]})},n.extend=function(){var t,e,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[l]||{},l++),"object"!=typeof s&&"function"!==n.type(s)&&(s={}),l===u&&(s=this,l--);l<u;l++)if(null!=(o=arguments[l]))for(i in o)t=s[i],r=o[i],s!==r&&(c&&r&&(n.isPlainObject(r)||(e=n.isArray(r)))?(e?(e=!1,a=t&&n.isArray(t)?t:[]):a=t&&n.isPlainObject(t)?t:{},s[i]=n.extend(c,a,r)):void 0!==r&&(s[i]=r));return s},n.queue=function(t,r,i){function o(t,n){var r=n||[];return null!=t&&(e(Object(t))?!function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;)t[i++]=e[r++];if(n!==n)for(;void 0!==e[r];)t[i++]=e[r++];return t.length=i,t}(r,"string"==typeof t?[t]:t):[].push.call(r,t)),r}if(t){r=(r||"fx")+"queue";var a=n.data(t,r);return i?(!a||n.isArray(i)?a=n.data(t,r,o(i)):a.push(i),a):a||[]}},n.dequeue=function(t,e){n.each(t.nodeType?[t]:t,function(t,r){e=e||"fx";var i=n.queue(r,e),o=i.shift();"inprogress"===o&&(o=i.shift()),o&&("fx"===e&&i.unshift("inprogress"),o.call(r,function(){n.dequeue(r,e)}))})},n.fn=n.prototype={init:function(t){if(t.nodeType)return this[0]=t,this;throw new Error("Not a DOM node.")},offset:function(){var e=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:e.top+(t.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:e.left+(t.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function t(){for(var t=this.offsetParent||document;t&&"html"===!t.nodeType.toLowerCase&&"static"===t.style.position;)t=t.offsetParent;return t||document}var e=this[0],t=t.apply(e),r=this.offset(),i=/^(?:body|html)$/i.test(t.nodeName)?{top:0,left:0}:n(t).offset();return r.top-=parseFloat(e.style.marginTop)||0,r.left-=parseFloat(e.style.marginLeft)||0,t.style&&(i.top+=parseFloat(t.style.borderTopWidth)||0,i.left+=parseFloat(t.style.borderLeftWidth)||0),{top:r.top-i.top,left:r.left-i.left}}};var r={};n.expando="velocity"+(new Date).getTime(),n.uuid=0;for(var i={},o=i.hasOwnProperty,a=i.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),l=0;l<s.length;l++)i["[object "+s[l]+"]"]=s[l].toLowerCase();n.fn.init.prototype=n.fn,t.Velocity={Utilities:n}}}(window),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):t()}(function(){return function(t,e,n,r){function i(t){for(var e=-1,n=t?t.length:0,r=[];++e<n;){var i=t[e];i&&r.push(i)}return r}function o(t){return g.isWrapped(t)?t=[].slice.call(t):g.isNode(t)&&(t=[t]),t}function a(t){var e=h.data(t,"velocity");return null===e?r:e}function s(t){return function(e){return Math.round(e*t)*(1/t)}}function l(t,n,r,i){function o(t,e){return 1-3*e+3*t}function a(t,e){return 3*e-6*t}function s(t){return 3*t}function l(t,e,n){return((o(e,n)*t+a(e,n))*t+s(e))*t}function u(t,e,n){return 3*o(e,n)*t*t+2*a(e,n)*t+s(e)}function c(e,n){for(var i=0;i<g;++i){var o=u(n,t,r);if(0===o)return n;var a=l(n,t,r)-e;n-=a/o}return n}function d(){for(var e=0;e<b;++e)k[e]=l(e*x,t,r)}function h(e,n,i){var o,a,s=0;do a=n+(i-n)/2,o=l(a,t,r)-e,o>0?i=a:n=a;while(Math.abs(o)>m&&++s<y);return a}function p(e){for(var n=0,i=1,o=b-1;i!=o&&k[i]<=e;++i)n+=x;--i;var a=(e-k[i])/(k[i+1]-k[i]),s=n+a*x,l=u(s,t,r);return l>=v?c(e,s):0==l?s:h(e,n,n+x)}function f(){M=!0,t==n&&r==i||d()}var g=4,v=.001,m=1e-7,y=10,b=11,x=1/(b-1),_="Float32Array"in e;if(4!==arguments.length)return!1;for(var w=0;w<4;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var k=_?new Float32Array(b):new Array(b),M=!1,C=function(e){return M||f(),t===n&&r===i?e:0===e?0:1===e?1:l(p(e),n,i)};C.getControlPoints=function(){return[{x:t,y:n},{x:r,y:i}]};var S="generateBezier("+[t,n,r,i]+")";return C.toString=function(){return S},C}function u(t,e){var n=t;return g.isString(t)?b.Easings[t]||(n=!1):n=g.isArray(t)&&1===t.length?s.apply(null,t):g.isArray(t)&&2===t.length?x.apply(null,t.concat([e])):!(!g.isArray(t)||4!==t.length)&&l.apply(null,t),n===!1&&(n=b.Easings[b.defaults.easing]?b.defaults.easing:y),n}function c(t){if(t)for(var e=(new Date).getTime(),n=0,i=b.State.calls.length;n<i;n++)if(b.State.calls[n]){var o=b.State.calls[n],s=o[0],l=o[2],u=o[3],p=!!u;u||(u=b.State.calls[n][3]=e-16);for(var f=Math.min((e-u)/l.duration,1),v=0,m=s.length;v<m;v++){var y=s[v],x=y.element;if(a(x)){var w=!1;if(l.display!==r&&null!==l.display&&"none"!==l.display){if("flex"===l.display){var M=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];h.each(M,function(t,e){_.setPropertyValue(x,"display",e)})}_.setPropertyValue(x,"display",l.display)}l.visibility!==r&&"hidden"!==l.visibility&&_.setPropertyValue(x,"visibility",l.visibility);for(var C in y)if("element"!==C){var S,L=y[C],A=g.isString(L.easing)?b.Easings[L.easing]:L.easing;if(1===f)S=L.endValue;else if(S=L.startValue+(L.endValue-L.startValue)*A(f),!p&&S===L.currentValue)continue;if(L.currentValue=S,_.Hooks.registered[C]){var E=_.Hooks.getRoot(C),T=a(x).rootPropertyValueCache[E];T&&(L.rootPropertyValue=T)}var P=_.setPropertyValue(x,C,L.currentValue+(0===parseFloat(S)?"":L.unitType),L.rootPropertyValue,L.scrollData);_.Hooks.registered[C]&&(_.Normalizations.registered[E]?a(x).rootPropertyValueCache[E]=_.Normalizations.registered[E]("extract",null,P[1]):a(x).rootPropertyValueCache[E]=P[1]),"transform"===P[0]&&(w=!0)}l.mobileHA&&a(x).transformCache.translate3d===r&&(a(x).transformCache.translate3d="(0px, 0px, 0px)",w=!0),w&&_.flushTransformCache(x)}}l.display!==r&&"none"!==l.display&&(b.State.calls[n][2].display=!1),l.visibility!==r&&"hidden"!==l.visibility&&(b.State.calls[n][2].visibility=!1),l.progress&&l.progress.call(o[1],o[1],f,Math.max(0,u+l.duration-e),u),1===f&&d(n)}b.State.isTicking&&k(c)}function d(t,e){if(!b.State.calls[t])return!1;for(var n=b.State.calls[t][0],i=b.State.calls[t][1],o=b.State.calls[t][2],s=b.State.calls[t][4],l=!1,u=0,c=n.length;u<c;u++){var d=n[u].element;if(e||o.loop||("none"===o.display&&_.setPropertyValue(d,"display",o.display),"hidden"===o.visibility&&_.setPropertyValue(d,"visibility",o.visibility)),o.loop!==!0&&(h.queue(d)[1]===r||!/\.velocityQueueEntryFlag/i.test(h.queue(d)[1]))&&a(d)){a(d).isAnimating=!1,a(d).rootPropertyValueCache={};var p=!1;h.each(_.Lists.transforms3D,function(t,e){var n=/^scale/.test(e)?1:0,i=a(d).transformCache[e];a(d).transformCache[e]!==r&&new RegExp("^\\("+n+"[^.]").test(i)&&(p=!0,delete a(d).transformCache[e])}),o.mobileHA&&(p=!0,delete a(d).transformCache.translate3d),p&&_.flushTransformCache(d),_.Values.removeClass(d,"velocity-animating")}if(!e&&o.complete&&!o.loop&&u===c-1)try{o.complete.call(i,i)}catch(t){setTimeout(function(){throw t},1)}s&&o.loop!==!0&&s(i),o.loop!==!0||e||(h.each(a(d).tweensContainer,function(t,e){/^rotate/.test(t)&&360===parseFloat(e.endValue)&&(e.endValue=0,e.startValue=360)}),b(d,"reverse",{loop:!0,delay:o.delay})),o.queue!==!1&&h.dequeue(d,o.queue)}b.State.calls[t]=!1;for(var f=0,g=b.State.calls.length;f<g;f++)if(b.State.calls[f]!==!1){l=!0;break}l===!1&&(b.State.isTicking=!1,delete b.State.calls,b.State.calls=[])}var h,p=function(){if(n.documentMode)return n.documentMode;for(var t=7;t>4;t--){var e=n.createElement("div");if(e.innerHTML="<!--[if IE "+t+"]><span></span><![endif]-->",e.getElementsByTagName("span").length)return e=null,t}return r}(),f=function(){var t=0;return e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(e){var n,r=(new Date).getTime();return n=Math.max(0,16-(r-t)),t=r+n,setTimeout(function(){e(r+n)},n)}}(),g={isString:function(t){return"string"==typeof t},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isNode:function(t){return t&&t.nodeType},isNodeList:function(t){return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(t))&&t.length!==r&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)},isWrapped:function(t){return t&&(t.jquery||e.Zepto&&e.Zepto.zepto.isZ(t))},isSVG:function(t){return e.SVGElement&&t instanceof e.SVGElement},isEmptyObject:function(t){for(var e in t)return!1;return!0}},v=!1;if(t.fn&&t.fn.jquery?(h=t,v=!0):h=e.Velocity.Utilities,p<=8&&!v)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(p<=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var m=400,y="swing",b={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:e.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:h,Redirects:{},Easings:{},Promise:e.Promise,defaults:{queue:"",duration:m,easing:y,begin:r,complete:r,progress:r,display:r,visibility:r,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(t){h.data(t,"velocity",{isSVG:g.isSVG(t),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:1,patch:0},debug:!1};e.pageYOffset!==r?(b.State.scrollAnchor=e,b.State.scrollPropertyLeft="pageXOffset",b.State.scrollPropertyTop="pageYOffset"):(b.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,b.State.scrollPropertyLeft="scrollLeft",b.State.scrollPropertyTop="scrollTop");var x=function(){function t(t){return-t.tension*t.x-t.friction*t.v}function e(e,n,r){var i={x:e.x+r.dx*n,v:e.v+r.dv*n,tension:e.tension,friction:e.friction};return{dx:i.v,dv:t(i)}}function n(n,r){var i={dx:n.v,dv:t(n)},o=e(n,.5*r,i),a=e(n,.5*r,o),s=e(n,r,a),l=1/6*(i.dx+2*(o.dx+a.dx)+s.dx),u=1/6*(i.dv+2*(o.dv+a.dv)+s.dv);return n.x=n.x+l*r,n.v=n.v+u*r,n}return function t(e,r,i){var o,a,s,l={x:-1,v:0,tension:null,friction:null},u=[0],c=0,d=1e-4,h=.016;for(e=parseFloat(e)||500,r=parseFloat(r)||20,i=i||null,l.tension=e,l.friction=r,o=null!==i,o?(c=t(e,r),a=c/i*h):a=h;;)if(s=n(s||l,a),u.push(1+s.x),c+=16,!(Math.abs(s.x)>d&&Math.abs(s.v)>d))break;return o?function(t){return u[t*(u.length-1)|0]}:c}}();b.Easings={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)}},h.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(t,e){b.Easings[e[0]]=l.apply(null,e[1])});var _=b.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var t=0;t<_.Lists.colors.length;t++){var e="color"===_.Lists.colors[t]?"0 0 0 1":"255 255 255 1";_.Hooks.templates[_.Lists.colors[t]]=["Red Green Blue Alpha",e]}var n,r,i;if(p)for(n in _.Hooks.templates){r=_.Hooks.templates[n],i=r[0].split(" ");var o=r[1].match(_.RegEx.valueSplit);"Color"===i[0]&&(i.push(i.shift()),o.push(o.shift()),_.Hooks.templates[n]=[i.join(" "),o.join(" ")])}for(n in _.Hooks.templates){r=_.Hooks.templates[n],i=r[0].split(" ");for(var t in i){var a=n+i[t],s=t;_.Hooks.registered[a]=[n,s]}}},getRoot:function(t){var e=_.Hooks.registered[t];return e?e[0]:t},cleanRootPropertyValue:function(t,e){return _.RegEx.valueUnwrap.test(e)&&(e=e.match(_.RegEx.valueUnwrap)[1]),_.Values.isCSSNullValue(e)&&(e=_.Hooks.templates[t][1]),e},extractValue:function(t,e){var n=_.Hooks.registered[t];if(n){var r=n[0],i=n[1];return e=_.Hooks.cleanRootPropertyValue(r,e),e.toString().match(_.RegEx.valueSplit)[i]}return e},injectValue:function(t,e,n){var r=_.Hooks.registered[t];if(r){var i,o,a=r[0],s=r[1];return n=_.Hooks.cleanRootPropertyValue(a,n),i=n.toString().match(_.RegEx.valueSplit),i[s]=e,o=i.join(" ")}return n}},Normalizations:{registered:{clip:function(t,e,n){switch(t){case"name":return"clip";case"extract":var r;return _.RegEx.wrappedValueAlreadyExtracted.test(n)?r=n:(r=n.toString().match(_.RegEx.valueUnwrap),r=r?r[1].replace(/,(\s+)?/g," "):n),r;case"inject":return"rect("+n+")"}},blur:function(t,e,n){switch(t){case"name":return"-webkit-filter";case"extract":var r=parseFloat(n);if(!r&&0!==r){var i=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);r=i?i[1]:0}return r;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(t,e,n){if(p<=8)switch(t){case"name":return"filter";case"extract":var r=n.toString().match(/alpha\(opacity=(.*)\)/i);return n=r?r[1]/100:1;case"inject":return e.style.zoom=1,parseFloat(n)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(n),10)+")"}else switch(t){case"name":return"opacity";case"extract":return n;case"inject":return n}}},register:function(){p<=9||b.State.isGingerbread||(_.Lists.transformsBase=_.Lists.transformsBase.concat(_.Lists.transforms3D));for(var t=0;t<_.Lists.transformsBase.length;t++)!function(){var e=_.Lists.transformsBase[t];_.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return"transform";case"extract":return a(n)===r||a(n).transformCache[e]===r?/^scale/i.test(e)?1:0:a(n).transformCache[e].replace(/[()]/g,"");case"inject":var o=!1;switch(e.substr(0,e.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(i);break;case"scal":case"scale":b.State.isAndroid&&a(n).transformCache[e]===r&&i<1&&(i=1),o=!/(\d)$/i.test(i);break;case"skew":o=!/(deg|\d)$/i.test(i);break;case"rotate":o=!/(deg|\d)$/i.test(i)}return o||(a(n).transformCache[e]="("+i+")"),a(n).transformCache[e]}}}();for(var t=0;t<_.Lists.colors.length;t++)!function(){var e=_.Lists.colors[t];_.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return e;case"extract":var o;if(_.RegEx.wrappedValueAlreadyExtracted.test(i))o=i;else{var a,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(i)?a=s[i]!==r?s[i]:s.black:_.RegEx.isHex.test(i)?a="rgb("+_.Values.hexToRgb(i).join(" ")+")":/^rgba?\(/i.test(i)||(a=s.black),o=(a||i).toString().match(_.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return p<=8||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return p<=8?4===i.split(" ").length&&(i=i.split(/\s+/).slice(0,3).join(" ")):3===i.split(" ").length&&(i+=" 1"),(p<=8?"rgb":"rgba")+"("+i.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},SVGAttribute:function(t){var e="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(p||b.State.isAndroid&&!b.State.isChrome)&&(e+="|transform"),new RegExp("^("+e+")$","i").test(t)},prefixCheck:function(t){if(b.State.prefixMatches[t])return[b.State.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],n=0,r=e.length;n<r;n++){var i;if(i=0===n?t:e[n]+t.replace(/^\w/,function(t){return t.toUpperCase()}),g.isString(b.State.prefixElement.style[i]))return b.State.prefixMatches[t]=i,[i,!0]}return[t,!1]}},Values:{hexToRgb:function(t){var e,n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return t=t.replace(n,function(t,e,n,r){return e+e+n+n+r+r}),e=r.exec(t),e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]},isCSSNullValue:function(t){return 0==t||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(t)},getUnitType:function(t){return/^(rotate|skew)/i.test(t)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(t)?"":"px"},getDisplayType:function(t){var e=t&&t.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(e)?"inline":/^(li)$/i.test(e)?"list-item":/^(tr)$/i.test(e)?"table-row":"block"},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=(t.className.length?" ":"")+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.toString().replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(t,n,i,o){function s(t,n){function i(){u&&_.setPropertyValue(t,"display","none")}var l=0;if(p<=8)l=h.css(t,n);else{var u=!1;if(/^(width|height)$/.test(n)&&0===_.getPropertyValue(t,"display")&&(u=!0,_.setPropertyValue(t,"display",_.Values.getDisplayType(t))),!o){if("height"===n&&"border-box"!==_.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var c=t.offsetHeight-(parseFloat(_.getPropertyValue(t,"borderTopWidth"))||0)-(parseFloat(_.getPropertyValue(t,"borderBottomWidth"))||0)-(parseFloat(_.getPropertyValue(t,"paddingTop"))||0)-(parseFloat(_.getPropertyValue(t,"paddingBottom"))||0);return i(),c}if("width"===n&&"border-box"!==_.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var d=t.offsetWidth-(parseFloat(_.getPropertyValue(t,"borderLeftWidth"))||0)-(parseFloat(_.getPropertyValue(t,"borderRightWidth"))||0)-(parseFloat(_.getPropertyValue(t,"paddingLeft"))||0)-(parseFloat(_.getPropertyValue(t,"paddingRight"))||0);return i(),d}}var f;f=a(t)===r?e.getComputedStyle(t,null):a(t).computedStyle?a(t).computedStyle:a(t).computedStyle=e.getComputedStyle(t,null),(p||b.State.isFirefox)&&"borderColor"===n&&(n="borderTopColor"),l=9===p&&"filter"===n?f.getPropertyValue(n):f[n],""!==l&&null!==l||(l=t.style[n]),i()}if("auto"===l&&/^(top|right|bottom|left)$/i.test(n)){var g=s(t,"position");("fixed"===g||"absolute"===g&&/top|left/i.test(n))&&(l=h(t).position()[n]+"px")}return l}var l;if(_.Hooks.registered[n]){var u=n,c=_.Hooks.getRoot(u);i===r&&(i=_.getPropertyValue(t,_.Names.prefixCheck(c)[0])),_.Normalizations.registered[c]&&(i=_.Normalizations.registered[c]("extract",t,i)),l=_.Hooks.extractValue(u,i)}else if(_.Normalizations.registered[n]){var d,f;d=_.Normalizations.registered[n]("name",t),"transform"!==d&&(f=s(t,_.Names.prefixCheck(d)[0]),_.Values.isCSSNullValue(f)&&_.Hooks.templates[n]&&(f=_.Hooks.templates[n][1])),l=_.Normalizations.registered[n]("extract",t,f)}return/^[\d-]/.test(l)||(l=a(t)&&a(t).isSVG&&_.Names.SVGAttribute(n)?/^(height|width)$/i.test(n)?t.getBBox()[n]:t.getAttribute(n):s(t,_.Names.prefixCheck(n)[0])),_.Values.isCSSNullValue(l)&&(l=0),b.debug>=2&&console.log("Get "+n+": "+l),l},setPropertyValue:function(t,n,r,i,o){var s=n;if("scroll"===n)o.container?o.container["scroll"+o.direction]=r:"Left"===o.direction?e.scrollTo(r,o.alternateValue):e.scrollTo(o.alternateValue,r);else if(_.Normalizations.registered[n]&&"transform"===_.Normalizations.registered[n]("name",t))_.Normalizations.registered[n]("inject",t,r),s="transform",r=a(t).transformCache[n];else{if(_.Hooks.registered[n]){var l=n,u=_.Hooks.getRoot(n);i=i||_.getPropertyValue(t,u),r=_.Hooks.injectValue(l,r,i),n=u}if(_.Normalizations.registered[n]&&(r=_.Normalizations.registered[n]("inject",t,r),n=_.Normalizations.registered[n]("name",t)),s=_.Names.prefixCheck(n)[0],p<=8)try{t.style[s]=r}catch(t){b.debug&&console.log("Browser does not support ["+r+"] for ["+s+"]")}else a(t)&&a(t).isSVG&&_.Names.SVGAttribute(n)?t.setAttribute(n,r):t.style[s]=r;b.debug>=2&&console.log("Set "+n+" ("+s+"): "+r)}return[s,r]},flushTransformCache:function(t){function e(e){return parseFloat(_.getPropertyValue(t,e))}var n="";if((p||b.State.isAndroid&&!b.State.isChrome)&&a(t).isSVG){var r={translate:[e("translateX"),e("translateY")],skewX:[e("skewX")],skewY:[e("skewY")],scale:1!==e("scale")?[e("scale"),e("scale")]:[e("scaleX"),e("scaleY")],rotate:[e("rotateZ"),0,0]};h.each(a(t).transformCache,function(t){/^translate/i.test(t)?t="translate":/^scale/i.test(t)?t="scale":/^rotate/i.test(t)&&(t="rotate"),r[t]&&(n+=t+"("+r[t].join(" ")+") ",delete r[t])})}else{var i,o;h.each(a(t).transformCache,function(e){return i=a(t).transformCache[e],"transformPerspective"===e?(o=i,!0):(9===p&&"rotateZ"===e&&(e="rotate"),void(n+=e+i+" "))}),o&&(n="perspective"+o+" "+n)}_.setPropertyValue(t,"transform",n)}};_.Hooks.register(),_.Normalizations.register(),b.hook=function(t,e,n){var i=r;return t=o(t),h.each(t,function(t,o){if(a(o)===r&&b.init(o),n===r)i===r&&(i=b.CSS.getPropertyValue(o,e));else{var s=b.CSS.setPropertyValue(o,e,n);"transform"===s[0]&&b.CSS.flushTransformCache(o),
i=s}}),i};var w=function(){function t(){return l?A.promise||null:p}function s(){function t(t){function p(t,e){var n=r,i=r,o=r;return g.isArray(t)?(n=t[0],!g.isArray(t[1])&&/^[\d-]/.test(t[1])||g.isFunction(t[1])||_.RegEx.isHex.test(t[1])?o=t[1]:(g.isString(t[1])&&!_.RegEx.isHex.test(t[1])||g.isArray(t[1]))&&(i=e?t[1]:u(t[1],l.duration),t[2]!==r&&(o=t[2]))):n=t,e||(i=i||l.easing),g.isFunction(n)&&(n=n.call(s,C,M)),g.isFunction(o)&&(o=o.call(s,C,M)),[n||0,i,o]}function f(t,e){var n,r;return r=(e||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(t){return n=t,""}),n||(n=_.Values.getUnitType(t)),[r,n]}function m(){var t={myParent:s.parentNode||n.body,position:_.getPropertyValue(s,"position"),fontSize:_.getPropertyValue(s,"fontSize")},r=t.position===I.lastPosition&&t.myParent===I.lastParent,i=t.fontSize===I.lastFontSize;I.lastParent=t.myParent,I.lastPosition=t.position,I.lastFontSize=t.fontSize;var o=100,l={};if(i&&r)l.emToPx=I.lastEmToPx,l.percentToPxWidth=I.lastPercentToPxWidth,l.percentToPxHeight=I.lastPercentToPxHeight;else{var u=a(s).isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");b.init(u),t.myParent.appendChild(u),h.each(["overflow","overflowX","overflowY"],function(t,e){b.CSS.setPropertyValue(u,e,"hidden")}),b.CSS.setPropertyValue(u,"position",t.position),b.CSS.setPropertyValue(u,"fontSize",t.fontSize),b.CSS.setPropertyValue(u,"boxSizing","content-box"),h.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(t,e){b.CSS.setPropertyValue(u,e,o+"%")}),b.CSS.setPropertyValue(u,"paddingLeft",o+"em"),l.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(_.getPropertyValue(u,"width",null,!0))||1)/o,l.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(_.getPropertyValue(u,"height",null,!0))||1)/o,l.emToPx=I.lastEmToPx=(parseFloat(_.getPropertyValue(u,"paddingLeft"))||1)/o,t.myParent.removeChild(u)}return null===I.remToPx&&(I.remToPx=parseFloat(_.getPropertyValue(n.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(e.innerWidth)/100,I.vhToPx=parseFloat(e.innerHeight)/100),l.remToPx=I.remToPx,l.vwToPx=I.vwToPx,l.vhToPx=I.vhToPx,b.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),s),l}if(l.begin&&0===C)try{l.begin.call(v,v)}catch(t){setTimeout(function(){throw t},1)}if("scroll"===E){var w,k,S,L=/^x$/i.test(l.axis)?"Left":"Top",T=parseFloat(l.offset)||0;l.container?g.isWrapped(l.container)||g.isNode(l.container)?(l.container=l.container[0]||l.container,w=l.container["scroll"+L],S=w+h(s).position()[L.toLowerCase()]+T):l.container=null:(w=b.State.scrollAnchor[b.State["scrollProperty"+L]],k=b.State.scrollAnchor[b.State["scrollProperty"+("Left"===L?"Top":"Left")]],S=h(s).offset()[L.toLowerCase()]+T),d={scroll:{rootPropertyValue:!1,startValue:w,currentValue:w,endValue:S,unitType:"",easing:l.easing,scrollData:{container:l.container,direction:L,alternateValue:k}},element:s},b.debug&&console.log("tweensContainer (scroll): ",d.scroll,s)}else if("reverse"===E){if(!a(s).tweensContainer)return void h.dequeue(s,l.queue);"none"===a(s).opts.display&&(a(s).opts.display="auto"),"hidden"===a(s).opts.visibility&&(a(s).opts.visibility="visible"),a(s).opts.loop=!1,a(s).opts.begin=null,a(s).opts.complete=null,x.easing||delete l.easing,x.duration||delete l.duration,l=h.extend({},a(s).opts,l);var P=h.extend(!0,{},a(s).tweensContainer);for(var D in P)if("element"!==D){var O=P[D].startValue;P[D].startValue=P[D].currentValue=P[D].endValue,P[D].endValue=O,g.isEmptyObject(x)||(P[D].easing=l.easing),b.debug&&console.log("reverse tweensContainer ("+D+"): "+JSON.stringify(P[D]),s)}d=P}else if("start"===E){var P;a(s).tweensContainer&&a(s).isAnimating===!0&&(P=a(s).tweensContainer),h.each(y,function(t,e){if(RegExp("^"+_.Lists.colors.join("$|^")+"$").test(t)){var n=p(e,!0),i=n[0],o=n[1],a=n[2];if(_.RegEx.isHex.test(i)){for(var s=["Red","Green","Blue"],l=_.Values.hexToRgb(i),u=a?_.Values.hexToRgb(a):r,c=0;c<s.length;c++){var d=[l[c]];o&&d.push(o),u!==r&&d.push(u[c]),y[t+s[c]]=d}delete y[t]}}});for(var N in y){var G=p(y[N]),W=G[0],F=G[1],R=G[2];N=_.Names.camelCase(N);var B=_.Hooks.getRoot(N),H=!1;if(a(s).isSVG||_.Names.prefixCheck(B)[1]!==!1||_.Normalizations.registered[B]!==r){(l.display!==r&&null!==l.display&&"none"!==l.display||l.visibility!==r&&"hidden"!==l.visibility)&&/opacity|filter/.test(N)&&!R&&0!==W&&(R=0),l._cacheValues&&P&&P[N]?(R===r&&(R=P[N].endValue+P[N].unitType),H=a(s).rootPropertyValueCache[B]):_.Hooks.registered[N]?R===r?(H=_.getPropertyValue(s,B),R=_.getPropertyValue(s,N,H)):H=_.Hooks.templates[B][1]:R===r&&(R=_.getPropertyValue(s,N));var j,V,$,q=!1;if(j=f(N,R),R=j[0],$=j[1],j=f(N,W),W=j[0].replace(/^([+-\/*])=/,function(t,e){return q=e,""}),V=j[1],R=parseFloat(R)||0,W=parseFloat(W)||0,"%"===V&&(/^(fontSize|lineHeight)$/.test(N)?(W/=100,V="em"):/^scale/.test(N)?(W/=100,V=""):/(Red|Green|Blue)$/i.test(N)&&(W=W/100*255,V="")),/[\/*]/.test(q))V=$;else if($!==V&&0!==R)if(0===W)V=$;else{o=o||m();var U=/margin|padding|left|right|width|text|word|letter/i.test(N)||/X$/.test(N)||"x"===N?"x":"y";switch($){case"%":R*="x"===U?o.percentToPxWidth:o.percentToPxHeight;break;case"px":break;default:R*=o[$+"ToPx"]}switch(V){case"%":R*=1/("x"===U?o.percentToPxWidth:o.percentToPxHeight);break;case"px":break;default:R*=1/o[V+"ToPx"]}}switch(q){case"+":W=R+W;break;case"-":W=R-W;break;case"*":W=R*W;break;case"/":W=R/W}d[N]={rootPropertyValue:H,startValue:R,currentValue:R,endValue:W,unitType:V,easing:F},b.debug&&console.log("tweensContainer ("+N+"): "+JSON.stringify(d[N]),s)}else b.debug&&console.log("Skipping ["+B+"] due to a lack of browser support.")}d.element=s}d.element&&(_.Values.addClass(s,"velocity-animating"),z.push(d),""===l.queue&&(a(s).tweensContainer=d,a(s).opts=l),a(s).isAnimating=!0,C===M-1?(b.State.calls.length>1e4&&(b.State.calls=i(b.State.calls)),b.State.calls.push([z,v,l,null,A.resolver]),b.State.isTicking===!1&&(b.State.isTicking=!0,c())):C++)}var o,s=this,l=h.extend({},b.defaults,x),d={};switch(a(s)===r&&b.init(s),parseFloat(l.delay)&&l.queue!==!1&&h.queue(s,l.queue,function(t){b.velocityQueueEntryFlag=!0,a(s).delayTimer={setTimeout:setTimeout(t,parseFloat(l.delay)),next:t}}),l.duration.toString().toLowerCase()){case"fast":l.duration=200;break;case"normal":l.duration=m;break;case"slow":l.duration=600;break;default:l.duration=parseFloat(l.duration)||1}b.mock!==!1&&(b.mock===!0?l.duration=l.delay=1:(l.duration*=parseFloat(b.mock)||1,l.delay*=parseFloat(b.mock)||1)),l.easing=u(l.easing,l.duration),l.begin&&!g.isFunction(l.begin)&&(l.begin=null),l.progress&&!g.isFunction(l.progress)&&(l.progress=null),l.complete&&!g.isFunction(l.complete)&&(l.complete=null),l.display!==r&&null!==l.display&&(l.display=l.display.toString().toLowerCase(),"auto"===l.display&&(l.display=b.CSS.Values.getDisplayType(s))),l.visibility!==r&&null!==l.visibility&&(l.visibility=l.visibility.toString().toLowerCase()),l.mobileHA=l.mobileHA&&b.State.isMobile&&!b.State.isGingerbread,l.queue===!1?l.delay?setTimeout(t,l.delay):t():h.queue(s,l.queue,function(e,n){return n===!0?(A.promise&&A.resolver(v),!0):(b.velocityQueueEntryFlag=!0,void t(e))}),""!==l.queue&&"fx"!==l.queue||"inprogress"===h.queue(s)[0]||h.dequeue(s)}var l,p,f,v,y,x,k=arguments[0]&&(h.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||g.isString(arguments[0].properties));if(g.isWrapped(this)?(l=!1,f=0,v=this,p=this):(l=!0,f=1,v=k?arguments[0].elements:arguments[0]),v=o(v)){k?(y=arguments[0].properties,x=arguments[0].options):(y=arguments[f],x=arguments[f+1]);var M=v.length,C=0;if("stop"!==y&&!h.isPlainObject(x)){var S=f+1;x={};for(var L=S;L<arguments.length;L++)g.isArray(arguments[L])||!/^(fast|normal|slow)$/i.test(arguments[L])&&!/^\d/.test(arguments[L])?g.isString(arguments[L])||g.isArray(arguments[L])?x.easing=arguments[L]:g.isFunction(arguments[L])&&(x.complete=arguments[L]):x.duration=arguments[L]}var A={promise:null,resolver:null,rejecter:null};l&&b.Promise&&(A.promise=new b.Promise(function(t,e){A.resolver=t,A.rejecter=e}));var E;switch(y){case"scroll":E="scroll";break;case"reverse":E="reverse";break;case"stop":h.each(v,function(t,e){a(e)&&a(e).delayTimer&&(clearTimeout(a(e).delayTimer.setTimeout),a(e).delayTimer.next&&a(e).delayTimer.next(),delete a(e).delayTimer)});var T=[];return h.each(b.State.calls,function(t,e){e&&h.each(e[1],function(n,i){var o=g.isString(x)?x:"";return x!==r&&e[2].queue!==o||void h.each(v,function(e,n){n===i&&(x!==r&&(h.each(h.queue(n,o),function(t,e){g.isFunction(e)&&e(null,!0)}),h.queue(n,o,[])),a(n)&&""===o&&h.each(a(n).tweensContainer,function(t,e){e.endValue=e.currentValue}),T.push(t))})})}),h.each(T,function(t,e){d(e,!0)}),A.promise&&A.resolver(v),t();default:if(!h.isPlainObject(y)||g.isEmptyObject(y)){if(g.isString(y)&&b.Redirects[y]){var P=h.extend({},x),D=P.duration,O=P.delay||0;return P.backwards===!0&&(v=h.extend(!0,[],v).reverse()),h.each(v,function(t,e){parseFloat(P.stagger)?P.delay=O+parseFloat(P.stagger)*t:g.isFunction(P.stagger)&&(P.delay=O+P.stagger.call(e,t,M)),P.drag&&(P.duration=parseFloat(D)||(/^(callout|transition)/.test(y)?1e3:m),P.duration=Math.max(P.duration*(P.backwards?1-t/M:(t+1)/M),.75*P.duration,200)),b.Redirects[y].call(e,e,P||{},t,M,v,A.promise?A:r)}),t()}var N="Velocity: First argument ("+y+") was not a property map, a known action, or a registered redirect. Aborting.";return A.promise?A.rejecter(new Error(N)):console.log(N),t()}E="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},z=[];h.each(v,function(t,e){g.isNode(e)&&s.call(e)});var G,P=h.extend({},b.defaults,x);if(P.loop=parseInt(P.loop),G=2*P.loop-1,P.loop)for(var W=0;W<G;W++){var F={delay:P.delay,progress:P.progress};W===G-1&&(F.display=P.display,F.visibility=P.visibility,F.complete=P.complete),w(v,"reverse",F)}return t()}};b=h.extend(w,b),b.animate=w;var k=e.requestAnimationFrame||f;return b.State.isMobile||n.hidden===r||n.addEventListener("visibilitychange",function(){n.hidden?(k=function(t){return setTimeout(function(){t(!0)},16)},c()):k=e.requestAnimationFrame||f}),t.Velocity=b,t!==e&&(t.fn.velocity=w,t.fn.velocity.defaults=b.defaults),h.each(["Down","Up"],function(t,e){b.Redirects["slide"+e]=function(t,n,i,o,a,s){var l=h.extend({},n),u=l.begin,c=l.complete,d={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},p={};l.display===r&&(l.display="Down"===e?"inline"===b.CSS.Values.getDisplayType(t)?"inline-block":"block":"none"),l.begin=function(){u&&u.call(a,a);for(var n in d){p[n]=t.style[n];var r=b.CSS.getPropertyValue(t,n);d[n]="Down"===e?[r,0]:[0,r]}p.overflow=t.style.overflow,t.style.overflow="hidden"},l.complete=function(){for(var e in p)t.style[e]=p[e];c&&c.call(a,a),s&&s.resolver(a)},b(t,d,l)}}),h.each(["In","Out"],function(t,e){b.Redirects["fade"+e]=function(t,n,i,o,a,s){var l=h.extend({},n),u={opacity:"In"===e?1:0},c=l.complete;i!==o-1?l.complete=l.begin=null:l.complete=function(){c&&c.call(a,a),s&&s.resolver(a)},l.display===r&&(l.display="In"===e?"auto":"none"),b(this,u,l)}}),b}(window.jQuery||window.Zepto||window,window,document)}),!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function n(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function r(t){return null===t?NaN:+t}function i(t){return!isNaN(t)}function o(t){return{left:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function a(t){return t.length}function s(t){for(var e=1;t*e%1;)e*=10;return e}function l(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function u(){this._=Object.create(null)}function c(t){return(t+="")===ba||t[0]===xa?xa+t:t}function d(t){return(t+="")[0]===xa?t.slice(1):t}function h(t){return c(t)in this._}function p(t){return(t=c(t))in this._&&delete this._[t]}function f(){var t=[];for(var e in this._)t.push(d(e));return t}function g(){var t=0;for(var e in this._)++t;return t}function v(){for(var t in this._)return!1;return!0}function m(){this._=Object.create(null)}function y(t){return t}function b(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function x(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=_a.length;n<r;++n){var i=_a[n]+e;if(i in t)return i}}function _(){}function w(){}function k(t){function e(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}var n=[],r=new u;return e.on=function(e,i){var o,a=r.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},e}function M(){la.event.preventDefault()}function C(){for(var t,e=la.event;t=e.sourceEvent;)e=t;return e}function S(t){for(var e=new w,n=0,r=arguments.length;++n<r;)e[arguments[n]]=k(e);return e.of=function(n,r){return function(i){try{var o=i.sourceEvent=la.event;i.target=t,la.event=i,e[i.type].apply(n,r)}finally{la.event=o}}},e}function L(t){return ka(t,La),t}function A(t){return"function"==typeof t?t:function(){return Ma(t,this)}}function E(t){return"function"==typeof t?t:function(){return Ca(t,this)}}function T(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=la.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?s:a:t.local?o:i}function P(t){return t.trim().replace(/\s+/g," ")}function D(t){return new RegExp("(?:^|\\s+)"+la.requote(t)+"(?:\\s+|$)","g")}function O(t){return(t+"").trim().split(/^|\s+/)}function N(t,e){function n(){for(var n=-1;++n<i;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<i;)t[n](this,r)}t=O(t).map(I);var i=t.length;return"function"==typeof e?r:n}function I(t){var e=D(t);return function(n,r){if(i=n.classList)return r?i.add(t):i.remove(t);var i=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(i)||n.setAttribute("class",P(i+" "+t))):n.setAttribute("class",P(i.replace(e," ")))}}function z(t,e,n){function r(){this.style.removeProperty(t)}function i(){this.style.setProperty(t,e,n)}function o(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?o:i}function G(t,e){function n(){delete this[t]}function r(){this[t]=e}function i(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?i:r}function W(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n===Aa&&e.documentElement.namespaceURI===Aa?e.createElement(t):e.createElementNS(n,t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=la.ns.qualify(t)).local?n:e}function F(){var t=this.parentNode;t&&t.removeChild(this)}function R(t){return{__data__:t}}function B(t){return function(){return Sa(this,t)}}function H(t){return arguments.length||(t=n),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function j(t,e){for(var n=0,r=t.length;n<r;n++)for(var i,o=t[n],a=0,s=o.length;a<s;a++)(i=o[a])&&e(i,a,n);return t}function V(t){return ka(t,Ta),t}function $(t){var e,n;return function(r,i,o){var a,s=t[o].update,l=s.length;for(o!=n&&(n=o,e=0),i>=e&&(e=i+1);!(a=s[e])&&++e<l;);return a}}function q(t,e,n){function r(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function i(){var i=l(e,ca(arguments));r.call(this),this.addEventListener(t,this[a]=i,i.$=n),i._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+la.requote(t)+"$");for(var r in this)if(e=r.match(n)){var i=this[r];this.removeEventListener(e[1],i,i.$),delete this[r]}}var a="__on"+t,s=t.indexOf("."),l=U;s>0&&(t=t.slice(0,s));var u=Pa.get(t);return u&&(t=u,l=X),s?e?i:r:e?_:o}function U(t,e){return function(n){var r=la.event;la.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{la.event=r}}}function X(t,e){var n=U(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function Y(n){var r=".dragsuppress-"+ ++Oa,i="click"+r,o=la.select(e(n)).on("touchmove"+r,M).on("dragstart"+r,M).on("selectstart"+r,M);if(null==Da&&(Da=!("onselectstart"in n)&&x(n.style,"userSelect")),Da){var a=t(n).style,s=a[Da];a[Da]="none"}return function(t){if(o.on(r,null),Da&&(a[Da]=s),t){var e=function(){o.on(i,null)};o.on(i,function(){M(),e()},!0),setTimeout(e,0)}}}function K(t,n){n.changedTouches&&(n=n.changedTouches[0]);var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();if(Na<0){var o=e(t);if(o.scrollX||o.scrollY){r=la.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=r[0][0].getScreenCTM();Na=!(a.f||a.e),r.remove()}}return Na?(i.x=n.pageX,i.y=n.pageY):(i.x=n.clientX,i.y=n.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function Z(){return la.event.changedTouches[0].identifier}function Q(t){return t>0?1:t<0?-1:0}function J(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function tt(t){return t>1?0:t<-1?Ga:Math.acos(t)}function et(t){return t>1?Ra:t<-1?-Ra:Math.asin(t)}function nt(t){return((t=Math.exp(t))-1/t)/2}function rt(t){return((t=Math.exp(t))+1/t)/2}function it(t){return((t=Math.exp(2*t))-1)/(t+1)}function ot(t){return(t=Math.sin(t/2))*t}function at(){}function st(t,e,n){return this instanceof st?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof st?new st(t.h,t.s,t.l):_t(""+t,wt,st):new st(t,e,n)}function lt(t,e,n){function r(t){return t>360?t-=360:t<0&&(t+=360),t<60?o+(a-o)*t/60:t<180?a:t<240?o+(a-o)*(240-t)/60:o}function i(t){return Math.round(255*r(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,n=n<0?0:n>1?1:n,a=n<=.5?n*(1+e):n+e-n*e,o=2*n-a,new mt(i(t+120),i(t),i(t-120))}function ut(t,e,n){return this instanceof ut?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ut?new ut(t.h,t.c,t.l):t instanceof dt?pt(t.l,t.a,t.b):pt((t=kt((t=la.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ut(t,e,n)}function ct(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new dt(n,Math.cos(t*=Ba)*e,Math.sin(t)*e)}function dt(t,e,n){return this instanceof dt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof dt?new dt(t.l,t.a,t.b):t instanceof ut?ct(t.h,t.c,t.l):kt((t=mt(t)).r,t.g,t.b):new dt(t,e,n)}function ht(t,e,n){var r=(t+16)/116,i=r+e/500,o=r-n/200;return i=ft(i)*Qa,r=ft(r)*Ja,o=ft(o)*ts,new mt(vt(3.2404542*i-1.5371385*r-.4985314*o),vt(-.969266*i+1.8760108*r+.041556*o),vt(.0556434*i-.2040259*r+1.0572252*o))}function pt(t,e,n){return t>0?new ut(Math.atan2(n,e)*Ha,Math.sqrt(e*e+n*n),t):new ut(NaN,NaN,t)}function ft(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function gt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function vt(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function mt(t,e,n){return this instanceof mt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof mt?new mt(t.r,t.g,t.b):_t(""+t,mt,lt):new mt(t,e,n)}function yt(t){return new mt(t>>16,t>>8&255,255&t)}function bt(t){return yt(t)+""}function xt(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function _t(t,e,n){var r,i,o,a=0,s=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return n(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return e(Ct(i[0]),Ct(i[1]),Ct(i[2]))}return(o=rs.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),e(a,s,l))}function wt(t,e,n){var r,i,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,l=(a+o)/2;return s?(i=l<.5?s/(a+o):s/(2-a-o),r=t==a?(e-n)/s+(e<n?6:0):e==a?(n-t)/s+2:(t-e)/s+4,r*=60):(r=NaN,i=l>0&&l<1?0:r),new st(r,i,l)}function kt(t,e,n){t=Mt(t),e=Mt(e),n=Mt(n);var r=gt((.4124564*t+.3575761*e+.1804375*n)/Qa),i=gt((.2126729*t+.7151522*e+.072175*n)/Ja),o=gt((.0193339*t+.119192*e+.9503041*n)/ts);return dt(116*i-16,500*(r-i),200*(i-o))}function Mt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ct(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function St(t){return"function"==typeof t?t:function(){return t}}function Lt(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),At(e,n,t,r)}}function At(t,e,n,r){function i(){var t,e=l.status;if(!e&&Tt(l)||e>=200&&e<300||304===e){try{t=n.call(o,l)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,l)}var o={},a=la.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=i:l.onreadystatechange=function(){l.readyState>3&&i()},l.onprogress=function(t){var e=la.event;la.event=t;try{a.progress.call(o,l)}finally{la.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(u=t,o):u},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(ca(arguments)))}}),o.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),l.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=i&&o.on("error",i).on("load",function(t){i(null,t)}),a.beforesend.call(o,l),l.send(null==r?null:r),o},o.abort=function(){return l.abort(),o},la.rebind(o,a,"on"),null==r?o:o.get(Et(r))}function Et(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Tt(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Pt(t,e,n){var r=arguments.length;r<2&&(e=0),r<3&&(n=Date.now());var i=n+e,o={c:t,t:i,n:null};return os?os.n=o:is=o,os=o,as||(ss=clearTimeout(ss),as=1,ls(Dt)),o}function Dt(){var t=Ot(),e=Nt()-t;e>24?(isFinite(e)&&(clearTimeout(ss),ss=setTimeout(Dt,e)),as=0):(as=1,ls(Dt))}function Ot(){for(var t=Date.now(),e=is;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Nt(){for(var t,e=is,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:is=e.n;return os=t,n}function It(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function zt(t,e){var n=Math.pow(10,3*ya(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Gt(t){var e=t.decimal,n=t.thousands,r=t.grouping,i=t.currency,o=r&&n?function(t,e){for(var i=t.length,o=[],a=0,s=r[0],l=0;i>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>e));)s=r[a=(a+1)%r.length];return o.reverse().join(n)}:y;return function(t){var n=cs.exec(t),r=n[1]||" ",a=n[2]||">",s=n[3]||"-",l=n[4]||"",u=n[5],c=+n[6],d=n[7],h=n[8],p=n[9],f=1,g="",v="",m=!1,y=!0;switch(h&&(h=+h.substring(1)),(u||"0"===r&&"="===a)&&(u=r="0",a="="),p){case"n":d=!0,p="g";break;case"%":f=100,v="%",p="f";break;case"p":f=100,v="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(g="0"+p.toLowerCase());case"c":y=!1;case"d":m=!0,h=0;break;case"s":f=-1,p="r"}"$"===l&&(g=i[0],v=i[1]),"r"!=p||h||(p="g"),null!=h&&("g"==p?h=Math.max(1,Math.min(21,h)):"e"!=p&&"f"!=p||(h=Math.max(0,Math.min(20,h)))),p=ds.get(p)||Wt;var b=u&&d;return function(t){var n=v;if(m&&t%1)return"";var i=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===s?"":s;if(f<0){var l=la.formatPrefix(t,h);t=l.scale(t),n=l.symbol+v}else t*=f;t=p(t,h);var x,_,w=t.lastIndexOf(".");if(w<0){var k=y?t.lastIndexOf("e"):-1;k<0?(x=t,_=""):(x=t.substring(0,k),_=t.substring(k))}else x=t.substring(0,w),_=e+t.substring(w+1);!u&&d&&(x=o(x,1/0));var M=g.length+x.length+_.length+(b?0:i.length),C=M<c?new Array(M=c-M+1).join(r):"";return b&&(x=o(C+x,C.length?c-_.length:1/0)),i+=g,t=x+_,("<"===a?i+t+C:">"===a?C+i+t:"^"===a?C.substring(0,M>>=1)+i+t+C.substring(M):i+(b?t:C+t))+n}}}function Wt(t){return t+""}function Ft(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Rt(t,e,n){function r(e){var n=t(e),r=o(n,1);return e-n<r-e?n:r}function i(n){return e(n=t(new ps(n-1)),1),n}function o(t,n){return e(t=new ps((+t)),n),t}function a(t,r,o){var a=i(t),s=[];if(o>1)for(;a<r;)n(a)%o||s.push(new Date((+a))),e(a,1);else for(;a<r;)s.push(new Date((+a))),e(a,1);return s}function s(t,e,n){try{ps=Ft;var r=new Ft;return r._=t,a(r,e,n)}finally{ps=Date}}t.floor=t,t.round=r,t.ceil=i,t.offset=o,t.range=a;var l=t.utc=Bt(t);return l.floor=l,l.round=Bt(r),l.ceil=Bt(i),l.offset=Bt(o),l.range=s,t}function Bt(t){return function(e,n){try{ps=Ft;var r=new Ft;return r._=e,t(r,n)._}finally{ps=Date}}}function Ht(t){function e(t){function e(e){for(var n,i,o,a=[],s=-1,l=0;++s<r;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=gs[n=t.charAt(++s)])&&(n=t.charAt(++s)),(o=A[n])&&(n=o(e,null==i?"e"===n?" ":"0":i)),a.push(n),l=s+1);return a.push(t.slice(l,s)),a.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=n(r,t,e,0);if(i!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var o=null!=r.Z&&ps!==Ft,a=new(o?Ft:ps);return"j"in r?a.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),a.setFullYear(r.y,0,1),a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(a.getDay()+5)%7:r.w+7*r.U-(a.getDay()+6)%7)):a.setFullYear(r.y,r.m,r.d),a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),o?a._:a},e.toString=function(){return t},e}function n(t,e,n,r){for(var i,o,a,s=0,l=e.length,u=n.length;s<l;){if(r>=u)return-1;if(i=e.charCodeAt(s++),37===i){if(a=e.charAt(s++),o=E[a in gs?e.charAt(s++):a],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function r(t,e,n){w.lastIndex=0;var r=w.exec(e.slice(n));return r?(t.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function i(t,e,n){x.lastIndex=0;var r=x.exec(e.slice(n));return r?(t.w=_.get(r[0].toLowerCase()),n+r[0].length):-1}function o(t,e,n){S.lastIndex=0;var r=S.exec(e.slice(n));return r?(t.m=L.get(r[0].toLowerCase()),n+r[0].length):-1}function a(t,e,n){M.lastIndex=0;var r=M.exec(e.slice(n));return r?(t.m=C.get(r[0].toLowerCase()),n+r[0].length):-1}function s(t,e,r){return n(t,A.c.toString(),e,r)}function l(t,e,r){return n(t,A.x.toString(),e,r)}function u(t,e,r){return n(t,A.X.toString(),e,r)}function c(t,e,n){var r=b.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}var d=t.dateTime,h=t.date,p=t.time,f=t.periods,g=t.days,v=t.shortDays,m=t.months,y=t.shortMonths;e.utc=function(t){function n(t){try{ps=Ft;var e=new ps;return e._=t,r(e)}finally{ps=Date}}var r=e(t);return n.parse=function(t){try{ps=Ft;var e=r.parse(t);return e&&e._}finally{ps=Date}},n.toString=r.toString,n},e.multi=e.utc.multi=le;var b=la.map(),x=Vt(g),_=$t(g),w=Vt(v),k=$t(v),M=Vt(m),C=$t(m),S=Vt(y),L=$t(y);f.forEach(function(t,e){b.set(t.toLowerCase(),e)});var A={a:function(t){return v[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return y[t.getMonth()]},B:function(t){return m[t.getMonth()]},c:e(d),d:function(t,e){return jt(t.getDate(),e,2)},e:function(t,e){return jt(t.getDate(),e,2)},H:function(t,e){return jt(t.getHours(),e,2)},I:function(t,e){return jt(t.getHours()%12||12,e,2)},j:function(t,e){return jt(1+hs.dayOfYear(t),e,3)},L:function(t,e){return jt(t.getMilliseconds(),e,3)},m:function(t,e){return jt(t.getMonth()+1,e,2)},M:function(t,e){return jt(t.getMinutes(),e,2)},p:function(t){return f[+(t.getHours()>=12)]},S:function(t,e){return jt(t.getSeconds(),e,2)},U:function(t,e){return jt(hs.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return jt(hs.mondayOfYear(t),e,2)},x:e(h),X:e(p),y:function(t,e){return jt(t.getFullYear()%100,e,2)},Y:function(t,e){return jt(t.getFullYear()%1e4,e,4)},Z:ae,"%":function(){return"%"}},E={a:r,A:i,b:o,B:a,c:s,d:te,e:te,H:ne,I:ne,j:ee,L:oe,m:Jt,M:re,p:c,S:ie,U:Ut,w:qt,W:Xt,x:l,X:u,y:Kt,Y:Yt,Z:Zt,"%":se};return e}function jt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Vt(t){return new RegExp("^(?:"+t.map(la.requote).join("|")+")","i")}function $t(t){for(var e=new u,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function qt(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ut(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Xt(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function Yt(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Kt(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.y=Qt(+r[0]),n+r[0].length):-1}function Zt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Qt(t){return t+(t>68?1900:2e3)}function Jt(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function te(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ee(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function ne(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function re(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ie(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function oe(t,e,n){vs.lastIndex=0;var r=vs.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ae(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=ya(e)/60|0,i=ya(e)%60;return n+jt(r,"0",2)+jt(i,"0",2)}function se(t,e,n){ms.lastIndex=0;var r=ms.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function le(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}function ue(){}function ce(t,e,n){var r=n.s=t+e,i=r-t,o=r-i;n.t=t-o+(e-i)}function de(t,e){t&&_s.hasOwnProperty(t.type)&&_s[t.type](t,e)}function he(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function pe(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)he(t[n],e,1);e.polygonEnd()}function fe(){function t(t,e){t*=Ba,e=e*Ba/2+Ga/4;var n=t-r,a=n>=0?1:-1,s=a*n,l=Math.cos(e),u=Math.sin(e),c=o*u,d=i*l+c*Math.cos(s),h=c*a*Math.sin(s);ks.add(Math.atan2(h,d)),r=t,i=l,o=u}var e,n,r,i,o;Ms.point=function(a,s){Ms.point=t,r=(e=a)*Ba,i=Math.cos(s=(n=s)*Ba/2+Ga/4),o=Math.sin(s)},Ms.lineEnd=function(){t(e,n)}}function ge(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function ve(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function me(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ye(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function be(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function xe(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function _e(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function we(t,e){return ya(t[0]-e[0])<Ia&&ya(t[1]-e[1])<Ia}function ke(t,e){t*=Ba;var n=Math.cos(e*=Ba);Me(n*Math.cos(t),n*Math.sin(t),Math.sin(e));
}function Me(t,e,n){++Cs,Ls+=(t-Ls)/Cs,As+=(e-As)/Cs,Es+=(n-Es)/Cs}function Ce(){function t(t,i){t*=Ba;var o=Math.cos(i*=Ba),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(i),u=Math.atan2(Math.sqrt((u=n*l-r*s)*u+(u=r*a-e*l)*u+(u=e*s-n*a)*u),e*a+n*s+r*l);Ss+=u,Ts+=u*(e+(e=a)),Ps+=u*(n+(n=s)),Ds+=u*(r+(r=l)),Me(e,n,r)}var e,n,r;zs.point=function(i,o){i*=Ba;var a=Math.cos(o*=Ba);e=a*Math.cos(i),n=a*Math.sin(i),r=Math.sin(o),zs.point=t,Me(e,n,r)}}function Se(){zs.point=ke}function Le(){function t(t,e){t*=Ba;var n=Math.cos(e*=Ba),a=n*Math.cos(t),s=n*Math.sin(t),l=Math.sin(e),u=i*l-o*s,c=o*a-r*l,d=r*s-i*a,h=Math.sqrt(u*u+c*c+d*d),p=r*a+i*s+o*l,f=h&&-tt(p)/h,g=Math.atan2(h,p);Os+=f*u,Ns+=f*c,Is+=f*d,Ss+=g,Ts+=g*(r+(r=a)),Ps+=g*(i+(i=s)),Ds+=g*(o+(o=l)),Me(r,i,o)}var e,n,r,i,o;zs.point=function(a,s){e=a,n=s,zs.point=t,a*=Ba;var l=Math.cos(s*=Ba);r=l*Math.cos(a),i=l*Math.sin(a),o=Math.sin(s),Me(r,i,o)},zs.lineEnd=function(){t(e,n),zs.lineEnd=Se,zs.point=ke}}function Ae(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n}function Ee(){return!0}function Te(t,e,n,r,i){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(we(n,r)){i.lineStart();for(var s=0;s<e;++s)i.point((n=t[s])[0],n[1]);return void i.lineEnd()}var l=new De(n,t,null,(!0)),u=new De(n,null,l,(!1));l.o=u,o.push(l),a.push(u),l=new De(r,t,null,(!1)),u=new De(r,null,l,(!0)),l.o=u,o.push(l),a.push(u)}}),a.sort(e),Pe(o),Pe(a),o.length){for(var s=0,l=n,u=a.length;s<u;++s)a[s].e=l=!l;for(var c,d,h=o[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;c=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(var s=0,u=c.length;s<u;++s)i.point((d=c[s])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(f){c=p.p.z;for(var s=c.length-1;s>=0;--s)i.point((d=c[s])[0],d[1])}else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,c=p.z,f=!f}while(!p.v);i.lineEnd()}}}function Pe(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function De(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Oe(t,e,n,r){return function(i,o){function a(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function s(t,e){var n=i(t,e);v.point(n[0],n[1])}function l(){y.point=s,v.lineStart()}function u(){y.point=a,v.lineEnd()}function c(t,e){g.push([t,e]);var n=i(t,e);x.point(n[0],n[1])}function d(){x.lineStart(),g=[]}function h(){c(g[0][0],g[0][1]),x.lineEnd();var t,e=x.clean(),n=b.buffer(),r=n.length;if(g.pop(),f.push(g),g=null,r)if(1&e){t=n[0];var i,r=t.length-1,a=-1;if(r>0){for(_||(o.polygonStart(),_=!0),o.lineStart();++a<r;)o.point((i=t[a])[0],i[1]);o.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Ne))}var p,f,g,v=e(o),m=i.invert(r[0],r[1]),y={point:a,lineStart:l,lineEnd:u,polygonStart:function(){y.point=c,y.lineStart=d,y.lineEnd=h,p=[],f=[]},polygonEnd:function(){y.point=a,y.lineStart=l,y.lineEnd=u,p=la.merge(p);var t=Re(m,f);p.length?(_||(o.polygonStart(),_=!0),Te(p,ze,t,n,o)):t&&(_||(o.polygonStart(),_=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),_&&(o.polygonEnd(),_=!1),p=f=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},b=Ie(),x=e(b),_=!1;return y}}function Ne(t){return t.length>1}function Ie(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:_,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ze(t,e){return((t=t.x)[0]<0?t[1]-Ra-Ia:Ra-t[1])-((e=e.x)[0]<0?e[1]-Ra-Ia:Ra-e[1])}function Ge(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Ga:-Ga,l=ya(o-n);ya(l-Ga)<Ia?(t.point(n,r=(r+a)/2>0?Ra:-Ra),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=Ga&&(ya(n-i)<Ia&&(n-=i*Ia),ya(o-s)<Ia&&(o-=s*Ia),r=We(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function We(t,e,n,r){var i,o,a=Math.sin(t-n);return ya(a)>Ia?Math.atan((Math.sin(e)*(o=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(e))*Math.sin(t))/(i*o*a)):(e+r)/2}function Fe(t,e,n,r){var i;if(null==t)i=n*Ra,r.point(-Ga,i),r.point(0,i),r.point(Ga,i),r.point(Ga,0),r.point(Ga,-i),r.point(0,-i),r.point(-Ga,-i),r.point(-Ga,0),r.point(-Ga,i);else if(ya(t[0]-e[0])>Ia){var o=t[0]<e[0]?Ga:-Ga;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function Re(t,e){var n=t[0],r=t[1],i=[Math.sin(n),-Math.cos(n),0],o=0,a=0;ks.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(c)for(var d=u[0],h=d[0],p=d[1]/2+Ga/4,f=Math.sin(p),g=Math.cos(p),v=1;;){v===c&&(v=0),t=u[v];var m=t[0],y=t[1]/2+Ga/4,b=Math.sin(y),x=Math.cos(y),_=m-h,w=_>=0?1:-1,k=w*_,M=k>Ga,C=f*b;if(ks.add(Math.atan2(C*w*Math.sin(k),g*x+C*Math.cos(k))),o+=M?_+w*Wa:_,M^h>=n^m>=n){var S=me(ge(d),ge(t));xe(S);var L=me(i,S);xe(L);var A=(M^_>=0?-1:1)*et(L[2]);(r>A||r===A&&(S[0]||S[1]))&&(a+=M^_>=0?1:-1)}if(!v++)break;h=m,f=b,g=x,d=t}}return(o<-Ia||o<Ia&&ks<-Ia)^1&a}function Be(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(d,h){var p,f=[d,h],g=e(d,h),v=a?g?0:i(d,h):g?i(d+(d<0?Ga:-Ga),h):0;if(!n&&(u=l=g)&&t.lineStart(),g!==l&&(p=r(n,f),(we(n,p)||we(f,p))&&(f[0]+=Ia,f[1]+=Ia,g=e(f[0],f[1]))),g!==l)c=0,g?(t.lineStart(),p=r(f,n),t.point(p[0],p[1])):(p=r(n,f),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(s&&n&&a^g){var m;v&o||!(m=r(f,n,!0))||(c=0,a?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||n&&we(n,f)||t.point(f[0],f[1]),n=f,l=g,o=v},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}}function r(t,e,n){var r=ge(t),i=ge(e),a=[1,0,0],s=me(r,i),l=ve(s,s),u=s[0],c=l-u*u;if(!c)return!n&&t;var d=o*l/c,h=-o*u/c,p=me(a,s),f=be(a,d),g=be(s,h);ye(f,g);var v=p,m=ve(f,v),y=ve(v,v),b=m*m-y*(ve(f,f)-1);if(!(b<0)){var x=Math.sqrt(b),_=be(v,(-m-x)/y);if(ye(_,f),_=_e(_),!n)return _;var w,k=t[0],M=e[0],C=t[1],S=e[1];M<k&&(w=k,k=M,M=w);var L=M-k,A=ya(L-Ga)<Ia,E=A||L<Ia;if(!A&&S<C&&(w=C,C=S,S=w),E?A?C+S>0^_[1]<(ya(_[0]-k)<Ia?C:S):C<=_[1]&&_[1]<=S:L>Ga^(k<=_[0]&&_[0]<=M)){var T=be(v,(-m+x)/y);return ye(T,f),[_,_e(T)]}}}function i(e,n){var r=a?t:Ga-t,i=0;return e<-r?i|=1:e>r&&(i|=2),n<-r?i|=4:n>r&&(i|=8),i}var o=Math.cos(t),a=o>0,s=ya(o)>Ia,l=gn(t,6*Ba);return Oe(e,n,l,a?[0,-t]:[-Ga,t-Ga])}function He(t,e,n,r){return function(i){var o,a=i.a,s=i.b,l=a.x,u=a.y,c=s.x,d=s.y,h=0,p=1,f=c-l,g=d-u;if(o=t-l,f||!(o>0)){if(o/=f,f<0){if(o<h)return;o<p&&(p=o)}else if(f>0){if(o>p)return;o>h&&(h=o)}if(o=n-l,f||!(o<0)){if(o/=f,f<0){if(o>p)return;o>h&&(h=o)}else if(f>0){if(o<h)return;o<p&&(p=o)}if(o=e-u,g||!(o>0)){if(o/=g,g<0){if(o<h)return;o<p&&(p=o)}else if(g>0){if(o>p)return;o>h&&(h=o)}if(o=r-u,g||!(o<0)){if(o/=g,g<0){if(o>p)return;o>h&&(h=o)}else if(g>0){if(o<h)return;o<p&&(p=o)}return h>0&&(i.a={x:l+h*f,y:u+h*g}),p<1&&(i.b={x:l+p*f,y:u+p*g}),i}}}}}}function je(t,e,n,r){function i(r,i){return ya(r[0]-t)<Ia?i>0?0:3:ya(r[0]-n)<Ia?i>0?2:1:ya(r[1]-e)<Ia?i>0?1:0:i>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var n=i(t,1),r=i(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,n=v.length,r=t[1],i=0;i<n;++i)for(var o,a=1,s=v[i],l=s.length,u=s[0];a<l;++a)o=s[a],u[1]<=r?o[1]>r&&J(u,o,t)>0&&++e:o[1]<=r&&J(u,o,t)<0&&--e,u=o;return 0!==e}function u(o,s,l,u){var c=0,d=0;if(null==o||(c=i(o,l))!==(d=i(s,l))||a(o,s)<0^l>0){do u.point(0===c||3===c?t:n,c>1?r:e);while((c=(c+l+4)%4)!==d)}else u.point(s[0],s[1])}function c(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function d(t,e){c(t,e)&&s.point(t,e)}function h(){E.point=f,v&&v.push(m=[]),M=!0,k=!1,_=w=NaN}function p(){g&&(f(y,b),x&&k&&L.rejoin(),g.push(L.buffer())),E.point=d,k&&s.lineEnd()}function f(t,e){t=Math.max(-Ws,Math.min(Ws,t)),e=Math.max(-Ws,Math.min(Ws,e));var n=c(t,e);if(v&&m.push([t,e]),M)y=t,b=e,x=n,M=!1,n&&(s.lineStart(),s.point(t,e));else if(n&&k)s.point(t,e);else{var r={a:{x:_,y:w},b:{x:t,y:e}};A(r)?(k||(s.lineStart(),s.point(r.a.x,r.a.y)),s.point(r.b.x,r.b.y),n||s.lineEnd(),C=!1):n&&(s.lineStart(),s.point(t,e),C=!1)}_=t,w=e,k=n}var g,v,m,y,b,x,_,w,k,M,C,S=s,L=Ie(),A=He(t,e,n,r),E={point:d,lineStart:h,lineEnd:p,polygonStart:function(){s=L,g=[],v=[],C=!0},polygonEnd:function(){s=S,g=la.merge(g);var e=l([t,r]),n=C&&e,i=g.length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),u(null,null,1,s),s.lineEnd()),i&&Te(g,o,e,u,s),s.polygonEnd()),g=v=m=null}};return E}}function Ve(t){var e=0,n=Ga/3,r=sn(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Ga/180,n=t[1]*Ga/180):[e/Ga*180,n/Ga*180]},i}function $e(t,e){function n(t,e){var n=Math.sqrt(o-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),a-n*Math.cos(t)]}var r=Math.sin(t),i=(r+Math.sin(e))/2,o=1+r*(2*i-r),a=Math.sqrt(o)/i;return n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/i,et((o-(t*t+n*n)*i*i)/(2*i))]},n}function qe(){function t(t,e){Rs+=i*t-r*e,r=t,i=e}var e,n,r,i;$s.point=function(o,a){$s.point=t,e=r=o,n=i=a},$s.lineEnd=function(){t(e,n)}}function Ue(t,e){t<Bs&&(Bs=t),t>js&&(js=t),e<Hs&&(Hs=e),e>Vs&&(Vs=e)}function Xe(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=n}function n(t,e){a.push("L",t,",",e)}function r(){s.point=t}function i(){a.push("Z")}var o=Ye(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:r,polygonStart:function(){s.lineEnd=i},polygonEnd:function(){s.lineEnd=r,s.point=t},pointRadius:function(t){return o=Ye(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function Ye(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ke(t,e){Ls+=t,As+=e,++Es}function Ze(){function t(t,r){var i=t-e,o=r-n,a=Math.sqrt(i*i+o*o);Ts+=a*(e+t)/2,Ps+=a*(n+r)/2,Ds+=a,Ke(e=t,n=r)}var e,n;Us.point=function(r,i){Us.point=t,Ke(e=r,n=i)}}function Qe(){Us.point=Ke}function Je(){function t(t,e){var n=t-r,o=e-i,a=Math.sqrt(n*n+o*o);Ts+=a*(r+t)/2,Ps+=a*(i+e)/2,Ds+=a,a=i*t-r*e,Os+=a*(r+t),Ns+=a*(i+e),Is+=3*a,Ke(r=t,i=e)}var e,n,r,i;Us.point=function(o,a){Us.point=t,Ke(e=r=o,n=i=a)},Us.lineEnd=function(){t(e,n)}}function tn(t){function e(e,n){t.moveTo(e+a,n),t.arc(e,n,a,0,Wa)}function n(e,n){t.moveTo(e,n),s.point=r}function r(e,n){t.lineTo(e,n)}function i(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:i,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=i,s.point=e},pointRadius:function(t){return a=t,s},result:_};return s}function en(t){function e(t){return(s?r:n)(t)}function n(e){return on(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})}function r(e){function n(n,r){n=t(n,r),e.point(n[0],n[1])}function r(){b=NaN,M.point=o,e.lineStart()}function o(n,r){var o=ge([n,r]),a=t(n,r);i(b,x,y,_,w,k,b=a[0],x=a[1],y=n,_=o[0],w=o[1],k=o[2],s,e),e.point(b,x)}function a(){M.point=n,e.lineEnd()}function l(){r(),M.point=u,M.lineEnd=c}function u(t,e){o(d=t,h=e),p=b,f=x,g=_,v=w,m=k,M.point=o}function c(){i(b,x,y,_,w,k,p,f,d,g,v,m,s,e),M.lineEnd=a,a()}var d,h,p,f,g,v,m,y,b,x,_,w,k,M={point:n,lineStart:r,lineEnd:a,polygonStart:function(){e.polygonStart(),M.lineStart=l},polygonEnd:function(){e.polygonEnd(),M.lineStart=r}};return M}function i(e,n,r,s,l,u,c,d,h,p,f,g,v,m){var y=c-e,b=d-n,x=y*y+b*b;if(x>4*o&&v--){var _=s+p,w=l+f,k=u+g,M=Math.sqrt(_*_+w*w+k*k),C=Math.asin(k/=M),S=ya(ya(k)-1)<Ia||ya(r-h)<Ia?(r+h)/2:Math.atan2(w,_),L=t(S,C),A=L[0],E=L[1],T=A-e,P=E-n,D=b*T-y*P;(D*D/x>o||ya((y*T+b*P)/x-.5)>.3||s*p+l*f+u*g<a)&&(i(e,n,r,s,l,u,A,E,S,_/=M,w/=M,k,v,m),m.point(A,E),i(A,E,S,_,w,k,c,d,h,p,f,g,v,m))}}var o=.5,a=Math.cos(30*Ba),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function nn(t){var e=en(function(e,n){return t([e*Ha,n*Ha])});return function(t){return ln(e(t))}}function rn(t){this.stream=t}function on(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function an(t){return sn(function(){return t})()}function sn(t){function e(t){return t=s(t[0]*Ba,t[1]*Ba),[t[0]*h+l,u-t[1]*h]}function n(t){return t=s.invert((t[0]-l)/h,(u-t[1])/h),t&&[t[0]*Ha,t[1]*Ha]}function r(){s=Ae(a=dn(m,b,x),o);var t=o(g,v);return l=p-t[0]*h,u=f+t[1]*h,i()}function i(){return c&&(c.valid=!1,c=null),e}var o,a,s,l,u,c,d=en(function(t,e){return t=o(t,e),[t[0]*h+l,u-t[1]*h]}),h=150,p=480,f=250,g=0,v=0,m=0,b=0,x=0,_=Gs,w=y,k=null,M=null;return e.stream=function(t){return c&&(c.valid=!1),c=ln(_(a,d(w(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(_=null==t?(k=t,Gs):Be((k=+t)*Ba),i()):k},e.clipExtent=function(t){return arguments.length?(M=t,w=t?je(t[0][0],t[0][1],t[1][0],t[1][1]):y,i()):M},e.scale=function(t){return arguments.length?(h=+t,r()):h},e.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],r()):[p,f]},e.center=function(t){return arguments.length?(g=t[0]%360*Ba,v=t[1]%360*Ba,r()):[g*Ha,v*Ha]},e.rotate=function(t){return arguments.length?(m=t[0]%360*Ba,b=t[1]%360*Ba,x=t.length>2?t[2]%360*Ba:0,r()):[m*Ha,b*Ha,x*Ha]},la.rebind(e,d,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,r()}}function ln(t){return on(t,function(e,n){t.point(e*Ba,n*Ba)})}function un(t,e){return[t,e]}function cn(t,e){return[t>Ga?t-Wa:t<-Ga?t+Wa:t,e]}function dn(t,e,n){return t?e||n?Ae(pn(t),fn(e,n)):pn(t):e||n?fn(e,n):cn}function hn(t){return function(e,n){return e+=t,[e>Ga?e-Wa:e<-Ga?e+Wa:e,n]}}function pn(t){var e=hn(t);return e.invert=hn(-t),e}function fn(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*r+s*i;return[Math.atan2(l*o-c*a,s*r-u*i),et(c*o+l*a)]}var r=Math.cos(t),i=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*o-l*a;return[Math.atan2(l*o+u*a,s*r+c*i),et(c*r-s*i)]},n}function gn(t,e){var n=Math.cos(t),r=Math.sin(t);return function(i,o,a,s){var l=a*e;null!=i?(i=vn(n,i),o=vn(n,o),(a>0?i<o:i>o)&&(i+=a*Wa)):(i=t+a*Wa,o=t-.5*l);for(var u,c=i;a>0?c>o:c<o;c-=l)s.point((u=_e([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function vn(t,e){var n=ge(e);n[0]-=t,xe(n);var r=tt(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Ia)%(2*Math.PI)}function mn(t,e,n){var r=la.range(t,e-Ia,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function yn(t,e,n){var r=la.range(t,e-Ia,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function bn(t){return t.source}function xn(t){return t.target}function _n(t,e,n,r){var i=Math.cos(e),o=Math.sin(e),a=Math.cos(r),s=Math.sin(r),l=i*Math.cos(t),u=i*Math.sin(t),c=a*Math.cos(n),d=a*Math.sin(n),h=2*Math.asin(Math.sqrt(ot(r-e)+i*a*ot(n-t))),p=1/Math.sin(h),f=h?function(t){var e=Math.sin(t*=h)*p,n=Math.sin(h-t)*p,r=n*l+e*c,i=n*u+e*d,a=n*o+e*s;return[Math.atan2(i,r)*Ha,Math.atan2(a,Math.sqrt(r*r+i*i))*Ha]}:function(){return[t*Ha,e*Ha]};return f.distance=h,f}function wn(){function t(t,i){var o=Math.sin(i*=Ba),a=Math.cos(i),s=ya((t*=Ba)-e),l=Math.cos(s);Xs+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=r*o-n*a*l)*s),n*o+r*a*l),e=t,n=o,r=a}var e,n,r;Ys.point=function(i,o){e=i*Ba,n=Math.sin(o*=Ba),r=Math.cos(o),Ys.point=t},Ys.lineEnd=function(){Ys.point=Ys.lineEnd=_}}function kn(t,e){function n(e,n){var r=Math.cos(e),i=Math.cos(n),o=t(r*i);return[o*i*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),i=e(r),o=Math.sin(i),a=Math.cos(i);return[Math.atan2(t*o,r*a),Math.asin(r&&n*o/r)]},n}function Mn(t,e){function n(t,e){a>0?e<-Ra+Ia&&(e=-Ra+Ia):e>Ra-Ia&&(e=Ra-Ia);var n=a/Math.pow(i(e),o);return[n*Math.sin(o*t),a-n*Math.cos(o*t)]}var r=Math.cos(t),i=function(t){return Math.tan(Ga/4+t/2)},o=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(i(e)/i(t)),a=r*Math.pow(i(t),o)/o;return o?(n.invert=function(t,e){var n=a-e,r=Q(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(a/r,1/o))-Ra]},n):Sn}function Cn(t,e){function n(t,e){var n=o-e;return[n*Math.sin(i*t),o-n*Math.cos(i*t)]}var r=Math.cos(t),i=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),o=r/i+t;return ya(i)<Ia?un:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/i,o-Q(i)*Math.sqrt(t*t+n*n)]},n)}function Sn(t,e){return[t,Math.log(Math.tan(Ga/4+e/2))]}function Ln(t){var e,n=an(t),r=n.scale,i=n.translate,o=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=Ga*r(),l=i();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}function An(t,e){return[Math.log(Math.tan(Ga/4+e/2)),-t]}function En(t){return t[0]}function Tn(t){return t[1]}function Pn(t){for(var e=t.length,n=[0,1],r=2,i=2;i<e;i++){for(;r>1&&J(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function Dn(t,e){return t[0]-e[0]||t[1]-e[1]}function On(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Nn(t,e,n,r){var i=t[0],o=n[0],a=e[0]-i,s=r[0]-o,l=t[1],u=n[1],c=e[1]-l,d=r[1]-u,h=(s*(l-u)-d*(i-o))/(d*a-s*c);return[i+h*a,l+h*c]}function In(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function zn(){rr(this),this.edge=this.site=this.circle=null}function Gn(t){var e=sl.pop()||new zn;return e.site=t,e}function Wn(t){Xn(t),il.remove(t),sl.push(t),rr(t)}function Fn(t){var e=t.circle,n=e.x,r=e.cy,i={x:n,y:r},o=t.P,a=t.N,s=[t];Wn(t);for(var l=o;l.circle&&ya(n-l.circle.x)<Ia&&ya(r-l.circle.cy)<Ia;)o=l.P,s.unshift(l),Wn(l),l=o;s.unshift(l),Xn(l);for(var u=a;u.circle&&ya(n-u.circle.x)<Ia&&ya(r-u.circle.cy)<Ia;)a=u.N,s.push(u),Wn(u),u=a;s.push(u),Xn(u);var c,d=s.length;for(c=1;c<d;++c)u=s[c],l=s[c-1],tr(u.edge,l.site,u.site,i);l=s[0],u=s[d-1],u.edge=Qn(l.site,u.site,null,i),Un(l),Un(u)}function Rn(t){for(var e,n,r,i,o=t.x,a=t.y,s=il._;s;)if(r=Bn(s,a)-o,r>Ia)s=s.L;else{if(i=o-Hn(s,a),!(i>Ia)){r>-Ia?(e=s.P,n=s):i>-Ia?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=Gn(t);if(il.insert(e,l),e||n){if(e===n)return Xn(e),n=Gn(e.site),il.insert(l,n),l.edge=n.edge=Qn(e.site,l.site),Un(e),void Un(n);if(!n)return void(l.edge=Qn(e.site,l.site));Xn(e),Xn(n);var u=e.site,c=u.x,d=u.y,h=t.x-c,p=t.y-d,f=n.site,g=f.x-c,v=f.y-d,m=2*(h*v-p*g),y=h*h+p*p,b=g*g+v*v,x={x:(v*y-p*b)/m+c,y:(h*b-g*y)/m+d};tr(n.edge,u,f,x),l.edge=Qn(u,t,null,x),n.edge=Qn(t,f,null,x),Un(e),Un(n)}}function Bn(t,e){var n=t.site,r=n.x,i=n.y,o=i-e;if(!o)return r;var a=t.P;if(!a)return-(1/0);n=a.site;var s=n.x,l=n.y,u=l-e;if(!u)return s;var c=s-r,d=1/o-1/u,h=c/u;return d?(-h+Math.sqrt(h*h-2*d*(c*c/(-2*u)-l+u/2+i-o/2)))/d+r:(r+s)/2}function Hn(t,e){var n=t.N;if(n)return Bn(n,e);var r=t.site;return r.y===e?r.x:1/0}function jn(t){this.site=t,this.edges=[]}function Vn(t){for(var e,n,r,i,o,a,s,l,u,c,d=t[0][0],h=t[1][0],p=t[0][1],f=t[1][1],g=rl,v=g.length;v--;)if(o=g[v],o&&o.prepare())for(s=o.edges,l=s.length,a=0;a<l;)c=s[a].end(),r=c.x,i=c.y,u=s[++a%l].start(),e=u.x,n=u.y,(ya(r-e)>Ia||ya(i-n)>Ia)&&(s.splice(a,0,new er(Jn(o.site,c,ya(r-d)<Ia&&f-i>Ia?{x:d,y:ya(e-d)<Ia?n:f}:ya(i-f)<Ia&&h-r>Ia?{x:ya(n-f)<Ia?e:h,y:f}:ya(r-h)<Ia&&i-p>Ia?{x:h,y:ya(e-h)<Ia?n:p}:ya(i-p)<Ia&&r-d>Ia?{x:ya(n-p)<Ia?e:d,y:p}:null),o.site,null)),++l)}function $n(t,e){return e.angle-t.angle}function qn(){rr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Un(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i.x,s=i.y,l=r.x-a,u=r.y-s,c=o.x-a,d=o.y-s,h=2*(l*d-u*c);if(!(h>=-za)){var p=l*l+u*u,f=c*c+d*d,g=(d*p-u*f)/h,v=(l*f-c*p)/h,d=v+s,m=ll.pop()||new qn;m.arc=t,m.site=i,m.x=g+a,m.y=d+Math.sqrt(g*g+v*v),m.cy=d,t.circle=m;for(var y=null,b=al._;b;)if(m.y<b.y||m.y===b.y&&m.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}al.insert(y,m),y||(ol=m)}}}}function Xn(t){var e=t.circle;e&&(e.P||(ol=e.N),al.remove(e),ll.push(e),rr(e),t.circle=null)}function Yn(t){for(var e,n=nl,r=He(t[0][0],t[0][1],t[1][0],t[1][1]),i=n.length;i--;)e=n[i],(!Kn(e,t)||!r(e)||ya(e.a.x-e.b.x)<Ia&&ya(e.a.y-e.b.y)<Ia)&&(e.a=e.b=null,n.splice(i,1))}function Kn(t,e){var n=t.b;if(n)return!0;var r,i,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,d=t.r,h=c.x,p=c.y,f=d.x,g=d.y,v=(h+f)/2,m=(p+g)/2;if(g===p){if(v<a||v>=s)return;if(h>f){if(o){if(o.y>=u)return}else o={x:v,y:l};n={x:v,y:u}}else{if(o){if(o.y<l)return}else o={x:v,y:u};n={x:v,y:l}}}else if(r=(h-f)/(g-p),i=m-r*v,r<-1||r>1)if(h>f){if(o){if(o.y>=u)return}else o={x:(l-i)/r,y:l};n={x:(u-i)/r,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-i)/r,y:u};n={x:(l-i)/r,y:l}}else if(p<g){if(o){if(o.x>=s)return}else o={x:a,y:r*a+i};n={x:s,y:r*s+i}}else{if(o){if(o.x<a)return}else o={x:s,y:r*s+i};n={x:a,y:r*a+i}}return t.a=o,t.b=n,!0}function Zn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Qn(t,e,n,r){var i=new Zn(t,e);return nl.push(i),n&&tr(i,t,e,n),r&&tr(i,e,t,r),rl[t.i].edges.push(new er(i,t,e)),rl[e.i].edges.push(new er(i,e,t)),i}function Jn(t,e,n){var r=new Zn(t,null);return r.a=e,r.b=n,nl.push(r),r}function tr(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function er(t,e,n){var r=t.a,i=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function nr(){this._=null}function rr(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ir(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function or(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ar(t){for(;t.L;)t=t.L;return t}function sr(t,e){var n,r,i,o=t.sort(lr).pop();for(nl=[],rl=new Array(t.length),il=new nr,al=new nr;;)if(i=ol,o&&(!i||o.y<i.y||o.y===i.y&&o.x<i.x))o.x===n&&o.y===r||(rl[o.i]=new jn(o),Rn(o),n=o.x,r=o.y),o=t.pop();else{if(!i)break;Fn(i.arc)}e&&(Yn(e),Vn(e));var a={cells:rl,edges:nl};return il=al=nl=rl=null,a}function lr(t,e){return e.y-t.y||e.x-t.x}function ur(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function cr(t){return t.x}function dr(t){return t.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function pr(t,e,n,r,i,o){if(!t(e,n,r,i,o)){var a=.5*(n+i),s=.5*(r+o),l=e.nodes;l[0]&&pr(t,l[0],n,r,a,s),l[1]&&pr(t,l[1],a,r,i,s),l[2]&&pr(t,l[2],n,s,a,o),l[3]&&pr(t,l[3],a,s,i,o)}}function fr(t,e,n,r,i,o,a){var s,l=1/0;return function t(u,c,d,h,p){if(!(c>o||d>a||h<r||p<i)){if(f=u.point){var f,g=e-u.x,v=n-u.y,m=g*g+v*v;if(m<l){var y=Math.sqrt(l=m);r=e-y,i=n-y,o=e+y,a=n+y,s=f}}for(var b=u.nodes,x=.5*(c+h),_=.5*(d+p),w=e>=x,k=n>=_,M=k<<1|w,C=M+4;M<C;++M)if(u=b[3&M])switch(3&M){case 0:t(u,c,d,x,_);break;case 1:t(u,x,d,h,_);break;case 2:t(u,c,_,x,p);break;case 3:t(u,x,_,h,p)}}}(t,r,i,o,a),s}function gr(t,e){t=la.rgb(t),e=la.rgb(e);var n=t.r,r=t.g,i=t.b,o=e.r-n,a=e.g-r,s=e.b-i;return function(t){return"#"+xt(Math.round(n+o*t))+xt(Math.round(r+a*t))+xt(Math.round(i+s*t))}}function vr(t,e){var n,r={},i={};for(n in t)n in e?r[n]=br(t[n],e[n]):i[n]=t[n];for(n in e)n in t||(i[n]=e[n]);return function(t){for(n in r)i[n]=r[n](t);return i}}function mr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function yr(t,e){var n,r,i,o=cl.lastIndex=dl.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=cl.exec(t))&&(r=dl.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:mr(n,r)})),o=dl.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function br(t,e){for(var n,r=la.interpolators.length;--r>=0&&!(n=la.interpolators[r](t,e)););return n}function xr(t,e){var n,r=[],i=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;n<s;++n)r.push(br(t[n],e[n]));for(;n<o;++n)i[n]=t[n];for(;n<a;++n)i[n]=e[n];return function(t){for(n=0;n<s;++n)i[n]=r[n](t);return i}}function _r(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function wr(t){return function(e){return 1-t(1-e)}}function kr(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function Mr(t){return t*t}function Cr(t){return t*t*t}function Sr(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Lr(t){return function(e){return Math.pow(e,t)}}function Ar(t){return 1-Math.cos(t*Ra)}function Er(t){return Math.pow(2,10*(t-1))}function Tr(t){return 1-Math.sqrt(1-t*t)}function Pr(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Wa*Math.asin(1/t):(t=1,n=e/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Wa/e)}}function Dr(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Or(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Nr(t,e){t=la.hcl(t),e=la.hcl(e);var n=t.h,r=t.c,i=t.l,o=e.h-n,a=e.c-r,s=e.l-i;return isNaN(a)&&(a=0,r=isNaN(r)?e.c:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:o<-180&&(o+=360),function(t){return ct(n+o*t,r+a*t,i+s*t)+""}}function Ir(t,e){t=la.hsl(t),e=la.hsl(e);var n=t.h,r=t.s,i=t.l,o=e.h-n,a=e.s-r,s=e.l-i;return isNaN(a)&&(a=0,r=isNaN(r)?e.s:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:o<-180&&(o+=360),function(t){return lt(n+o*t,r+a*t,i+s*t)+""}}function zr(t,e){t=la.lab(t),e=la.lab(e);var n=t.l,r=t.a,i=t.b,o=e.l-n,a=e.a-r,s=e.b-i;return function(t){return ht(n+o*t,r+a*t,i+s*t)+""}}function Gr(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Wr(t){var e=[t.a,t.b],n=[t.c,t.d],r=Rr(e),i=Fr(e,n),o=Rr(Br(n,e,-i))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ha,this.translate=[t.e,t.f],this.scale=[r,o],this.skew=o?Math.atan2(i,o)*Ha:0}function Fr(t,e){return t[0]*e[0]+t[1]*e[1]}function Rr(t){var e=Math.sqrt(Fr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Br(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Hr(t){return t.length?t.pop()+",":""}function jr(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var i=n.push("translate(",null,",",null,")");r.push({i:i-4,x:mr(t[0],e[0])},{i:i-2,x:mr(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}function Vr(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(Hr(n)+"rotate(",null,")")-2,x:mr(t,e)})):e&&n.push(Hr(n)+"rotate("+e+")")}function $r(t,e,n,r){t!==e?r.push({i:n.push(Hr(n)+"skewX(",null,")")-2,x:mr(t,e)}):e&&n.push(Hr(n)+"skewX("+e+")")}function qr(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var i=n.push(Hr(n)+"scale(",null,",",null,")");r.push({i:i-4,x:mr(t[0],e[0])},{i:i-2,x:mr(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(Hr(n)+"scale("+e+")")}function Ur(t,e){var n=[],r=[];return t=la.transform(t),e=la.transform(e),jr(t.translate,e.translate,n,r),Vr(t.rotate,e.rotate,n,r),$r(t.skew,e.skew,n,r),qr(t.scale,e.scale,n,r),t=e=null,function(t){for(var e,i=-1,o=r.length;++i<o;)n[(e=r[i]).i]=e.x(t);return n.join("")}}function Xr(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Yr(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Kr(t){for(var e=t.source,n=t.target,r=Qr(e,n),i=[e];e!==r;)e=e.parent,i.push(e);for(var o=i.length;n!==r;)i.splice(o,0,n),n=n.parent;return i}function Zr(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Qr(t,e){if(t===e)return t;for(var n=Zr(t),r=Zr(e),i=n.pop(),o=r.pop(),a=null;i===o;)a=i,i=n.pop(),o=r.pop();return a}function Jr(t){t.fixed|=2}function ti(t){t.fixed&=-7}function ei(t){t.fixed|=4,t.px=t.x,t.py=t.y}function ni(t){t.fixed&=-5}function ri(t,e,n){var r=0,i=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&(ri(o,e,n),t.charge+=o.charge,r+=o.charge*o.cx,i+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,r+=u*t.point.x,i+=u*t.point.y}t.cx=r/t.charge,t.cy=i/t.charge}function ii(t,e){return la.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ci,t}function oi(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(i=t.children)&&(r=i.length))for(var r,i;--r>=0;)n.push(i[r])}function ai(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(o=t.children)&&(i=o.length))for(var i,o,a=-1;++a<i;)n.push(o[a]);for(;null!=(t=r.pop());)e(t)}function si(t){return t.children}function li(t){return t.value}function ui(t,e){return e.value-t.value}function ci(t){return la.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function di(t){return t.x}function hi(t){return t.y}function pi(t,e,n){t.y0=e,t.y=n}function fi(t){return la.range(t.length)}function gi(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function vi(t){for(var e,n=1,r=0,i=t[0][1],o=t.length;n<o;++n)(e=t[n][1])>i&&(r=n,i=e);return r}function mi(t){return t.reduce(yi,0)}function yi(t,e){return t+e[1]}function bi(t,e){return xi(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function xi(t,e){for(var n=-1,r=+t[0],i=(t[1]-r)/e,o=[];++n<=e;)o[n]=i*n+r;return o}function _i(t){return[la.min(t),la.max(t)]}function wi(t,e){return t.value-e.value}function ki(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Mi(t,e){t._pack_next=e,e._pack_prev=t}function Ci(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return.999*i*i>n*n+r*r}function Si(t){function e(t){c=Math.min(t.x-t.r,c),d=Math.max(t.x+t.r,d),h=Math.min(t.y-t.r,h),p=Math.max(t.y+t.r,p)}if((n=t.children)&&(u=n.length)){var n,r,i,o,a,s,l,u,c=1/0,d=-(1/0),h=1/0,p=-(1/0);if(n.forEach(Li),r=n[0],r.x=-r.r,r.y=0,e(r),u>1&&(i=n[1],i.x=i.r,i.y=0,e(i),u>2))for(o=n[2],Ti(r,i,o),e(o),ki(r,o),r._pack_prev=o,ki(o,i),i=r._pack_next,a=3;a<u;a++){Ti(r,i,o=n[a]);var f=0,g=1,v=1;for(s=i._pack_next;s!==i;s=s._pack_next,g++)if(Ci(s,o)){f=1;break}if(1==f)for(l=r._pack_prev;l!==s._pack_prev&&!Ci(l,o);l=l._pack_prev,v++);f?(g<v||g==v&&i.r<r.r?Mi(r,i=s):Mi(r=l,i),a--):(ki(r,o),i=o,e(o))}var m=(c+d)/2,y=(h+p)/2,b=0;for(a=0;a<u;a++)o=n[a],o.x-=m,o.y-=y,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=b,n.forEach(Ai)}}function Li(t){t._pack_next=t._pack_prev=t}function Ai(t){delete t._pack_next,delete t._pack_prev}function Ei(t,e,n,r){var i=t.children;if(t.x=e+=r*t.x,t.y=n+=r*t.y,t.r*=r,i)for(var o=-1,a=i.length;++o<a;)Ei(i[o],e,n,r)}function Ti(t,e,n){var r=t.r+n.r,i=e.x-t.x,o=e.y-t.y;if(r&&(i||o)){var a=e.r+n.r,s=i*i+o*o;a*=a,r*=r;var l=.5+(r-a)/(2*s),u=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);n.x=t.x+l*i+u*o,n.y=t.y+l*o-u*i}else n.x=t.x+r,n.y=t.y}function Pi(t,e){return t.parent==e.parent?1:2}function Di(t){var e=t.children;return e.length?e[0]:t.t}function Oi(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Ni(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Ii(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)e=i[o],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function zi(t,e,n){return t.a.parent===e.parent?t.a:n}function Gi(t){return 1+la.max(t,function(t){return t.y})}function Wi(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Fi(t){var e=t.children;return e&&e.length?Fi(e[0]):t}function Ri(t){var e,n=t.children;return n&&(e=n.length)?Ri(n[e-1]):t}function Bi(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Hi(t,e){var n=t.x+e[3],r=t.y+e[0],i=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return i<0&&(n+=i/2,i=0),o<0&&(r+=o/2,o=0),{x:n,y:r,dx:i,dy:o}}function ji(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function Vi(t){return t.rangeExtent?t.rangeExtent():ji(t.range())}function $i(t,e,n,r){var i=n(t[0],t[1]),o=r(e[0],e[1]);return function(t){return o(i(t))}}function qi(t,e){var n,r=0,i=t.length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,
i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function Ui(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:wl}function Xi(t,e,n,r){var i=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)i.push(n(t[a-1],t[a])),o.push(r(e[a-1],e[a]));return function(e){var n=la.bisect(t,e,1,s)-1;return o[n](i[n](e))}}function Yi(t,e,n,r){function i(){var i=Math.min(t.length,e.length)>2?Xi:$i,l=r?Yr:Xr;return a=i(t,e,l,n),s=i(e,t,l,br),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),i()):t},o.range=function(t){return arguments.length?(e=t,i()):e},o.rangeRound=function(t){return o.range(t).interpolate(Gr)},o.clamp=function(t){return arguments.length?(r=t,i()):r},o.interpolate=function(t){return arguments.length?(n=t,i()):n},o.ticks=function(e){return Ji(t,e)},o.tickFormat=function(e,n){return to(t,e,n)},o.nice=function(e){return Zi(t,e),i()},o.copy=function(){return Yi(t,e,n,r)},i()}function Ki(t,e){return la.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Zi(t,e){return qi(t,Ui(Qi(t,e)[2])),qi(t,Ui(Qi(t,e)[2])),t}function Qi(t,e){null==e&&(e=10);var n=ji(t),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),o=e/r*i;return o<=.15?i*=10:o<=.35?i*=5:o<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+.5*i,n[2]=i,n}function Ji(t,e){return la.range.apply(la,Qi(t,e))}function to(t,e,n){var r=Qi(t,e);if(n){var i=cs.exec(n);if(i.shift(),"s"===i[8]){var o=la.formatPrefix(Math.max(ya(r[0]),ya(r[1])));return i[7]||(i[7]="."+eo(o.scale(r[2]))),i[8]="f",n=la.format(i.join("")),function(t){return n(o.scale(t))+o.symbol}}i[7]||(i[7]="."+no(i[8],r)),n=i.join("")}else n=",."+eo(r[2])+"f";return la.format(n)}function eo(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function no(t,e){var n=eo(e[2]);return t in kl?Math.abs(n-eo(Math.max(ya(e[0]),ya(e[1]))))+ +("e"!==t):n-2*("%"===t)}function ro(t,e,n,r){function i(t){return(n?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(i(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((r=e.map(Number)).map(i)),a):r},a.base=function(n){return arguments.length?(e=+n,t.domain(r.map(i)),a):e},a.nice=function(){var e=qi(r.map(i),n?Math:Cl);return t.domain(e),r=e.map(o),a},a.ticks=function(){var t=ji(r),a=[],s=t[0],l=t[1],u=Math.floor(i(s)),c=Math.ceil(i(l)),d=e%1?2:e;if(isFinite(c-u)){if(n){for(;u<c;u++)for(var h=1;h<d;h++)a.push(o(u)*h);a.push(o(u))}else for(a.push(o(u));u++<c;)for(var h=d-1;h>0;h--)a.push(o(u)*h);for(u=0;a[u]<s;u++);for(c=a.length;a[c-1]>l;c--);a=a.slice(u,c)}return a},a.tickFormat=function(t,n){if(!arguments.length)return Ml;arguments.length<2?n=Ml:"function"!=typeof n&&(n=la.format(n));var r=Math.max(1,e*t/a.ticks().length);return function(t){var a=t/o(Math.round(i(t)));return a*e<e-.5&&(a*=e),a<=r?n(t):""}},a.copy=function(){return ro(t.copy(),e,n,r)},Ki(a,t)}function io(t,e,n){function r(e){return t(i(e))}var i=oo(e),o=oo(1/e);return r.invert=function(e){return o(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(i)),r):n},r.ticks=function(t){return Ji(n,t)},r.tickFormat=function(t,e){return to(n,t,e)},r.nice=function(t){return r.domain(Zi(n,t))},r.exponent=function(a){return arguments.length?(i=oo(e=a),o=oo(1/e),t.domain(n.map(i)),r):e},r.copy=function(){return io(t.copy(),e,n)},Ki(r,t)}function oo(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function ao(t,e){function n(n){return o[((i.get(n)||("range"===e.t?i.set(n,t.push(n)):NaN))-1)%o.length]}function r(e,n){return la.range(t.length).map(function(t){return e+n*t})}var i,o,a;return n.domain=function(r){if(!arguments.length)return t;t=[],i=new u;for(var o,a=-1,s=r.length;++a<s;)i.has(o=r[a])||i.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var l=i[0],u=i[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+s);return o=r(l+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(i,s){arguments.length<2&&(s=0);var l=i[0],u=i[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+s)|0;return o=r(l+Math.round(c*s/2+(u-l-(t.length-1+s)*c)/2),c),a=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(i,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=i[1]<i[0],c=i[u-0],d=i[1-u],h=(d-c)/(t.length-s+2*l);return o=r(c+h*l,h),u&&o.reverse(),a=h*(1-s),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=i[1]<i[0],c=i[u-0],d=i[1-u],h=Math.floor((d-c)/(t.length-s+2*l));return o=r(c+Math.round((d-c-(t.length-s)*h)/2),h),u&&o.reverse(),a=Math.round(h*(1-s)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return ji(e.a[0])},n.copy=function(){return ao(t,e)},n.domain(t)}function so(t,e){function o(){var n=0,r=e.length;for(s=[];++n<r;)s[n-1]=la.quantile(t,n/r);return a}function a(t){if(!isNaN(t=+t))return e[la.bisect(s,t)]}var s;return a.domain=function(e){return arguments.length?(t=e.map(r).filter(i).sort(n),o()):t},a.range=function(t){return arguments.length?(e=t,o()):e},a.quantiles=function(){return s},a.invertExtent=function(n){return n=e.indexOf(n),n<0?[NaN,NaN]:[n>0?s[n-1]:t[0],n<s.length?s[n]:t[t.length-1]]},a.copy=function(){return so(t,e)},o()}function lo(t,e,n){function r(e){return n[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function i(){return o=n.length/(e-t),a=n.length-1,r}var o,a;return r.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],i()):[t,e]},r.range=function(t){return arguments.length?(n=t,i()):n},r.invertExtent=function(e){return e=n.indexOf(e),e=e<0?NaN:e/o+t,[e,e+1/o]},r.copy=function(){return lo(t,e,n)},i()}function uo(t,e){function n(n){if(n<=n)return e[la.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return uo(t,e)},n}function co(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Ji(t,e)},e.tickFormat=function(e,n){return to(t,e,n)},e.copy=function(){return co(t)},e}function ho(){return 0}function po(t){return t.innerRadius}function fo(t){return t.outerRadius}function go(t){return t.startAngle}function vo(t){return t.endAngle}function mo(t){return t&&t.padAngle}function yo(t,e,n,r){return(t-n)*e-(e-r)*t>0?0:1}function bo(t,e,n,r,i){var o=t[0]-e[0],a=t[1]-e[1],s=(i?r:-r)/Math.sqrt(o*o+a*a),l=s*a,u=-s*o,c=t[0]+l,d=t[1]+u,h=e[0]+l,p=e[1]+u,f=(c+h)/2,g=(d+p)/2,v=h-c,m=p-d,y=v*v+m*m,b=n-r,x=c*p-h*d,_=(m<0?-1:1)*Math.sqrt(Math.max(0,b*b*y-x*x)),w=(x*m-v*_)/y,k=(-x*v-m*_)/y,M=(x*m+v*_)/y,C=(-x*v+m*_)/y,S=w-f,L=k-g,A=M-f,E=C-g;return S*S+L*L>A*A+E*E&&(w=M,k=C),[[w-l,k-u],[w*n/b,k*n/b]]}function xo(t){function e(e){function a(){u.push("M",o(t(c),s))}for(var l,u=[],c=[],d=-1,h=e.length,p=St(n),f=St(r);++d<h;)i.call(this,l=e[d],d)?c.push([+p.call(this,l,d),+f.call(this,l,d)]):c.length&&(a(),c=[]);return c.length&&a(),u.length?u.join(""):null}var n=En,r=Tn,i=Ee,o=_o,a=o.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e.defined=function(t){return arguments.length?(i=t,e):i},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=Pl.get(t)||_o).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function _o(t){return t.length>1?t.join("L"):t+"Z"}function wo(t){return t.join("L")+"Z"}function ko(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);return n>1&&i.push("H",r[0]),i.join("")}function Mo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("V",(r=t[e])[1],"H",r[0]);return i.join("")}function Co(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r=t[e])[0],"V",r[1]);return i.join("")}function So(t,e){return t.length<4?_o(t):t[1]+Eo(t.slice(1,-1),To(t,e))}function Lo(t,e){return t.length<3?wo(t):t[0]+Eo((t.push(t[0]),t),To([t[t.length-2]].concat(t,[t[1]]),e))}function Ao(t,e){return t.length<3?_o(t):t[0]+Eo(t,To(t,e))}function Eo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return _o(t);var n=t.length!=e.length,r="",i=t[0],o=t[1],a=e[0],s=a,l=1;if(n&&(r+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],i=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,r+="C"+(i[0]+a[0])+","+(i[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],s=e[u],r+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[l];r+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return r}function To(t,e){for(var n,r=[],i=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)n=o,o=a,a=t[s],r.push([i*(a[0]-n[0]),i*(a[1]-n[1])]);return r}function Po(t){if(t.length<3)return _o(t);var e=1,n=t.length,r=t[0],i=r[0],o=r[1],a=[i,i,i,(r=t[1])[0]],s=[o,o,o,r[1]],l=[i,",",o,"L",Io(Nl,a),",",Io(Nl,s)];for(t.push(t[n-1]);++e<=n;)r=t[e],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),zo(l,a,s);return t.pop(),l.push("L",r),l.join("")}function Do(t){if(t.length<4)return _o(t);for(var e,n=[],r=-1,i=t.length,o=[0],a=[0];++r<3;)e=t[r],o.push(e[0]),a.push(e[1]);for(n.push(Io(Nl,o)+","+Io(Nl,a)),--r;++r<i;)e=t[r],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),zo(n,o,a);return n.join("")}function Oo(t){for(var e,n,r=-1,i=t.length,o=i+4,a=[],s=[];++r<4;)n=t[r%i],a.push(n[0]),s.push(n[1]);for(e=[Io(Nl,a),",",Io(Nl,s)],--r;++r<o;)n=t[r%i],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),zo(e,a,s);return e.join("")}function No(t,e){var n=t.length-1;if(n)for(var r,i,o=t[0][0],a=t[0][1],s=t[n][0]-o,l=t[n][1]-a,u=-1;++u<=n;)r=t[u],i=u/n,r[0]=e*r[0]+(1-e)*(o+i*s),r[1]=e*r[1]+(1-e)*(a+i*l);return Po(t)}function Io(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function zo(t,e,n){t.push("C",Io(Dl,e),",",Io(Dl,n),",",Io(Ol,e),",",Io(Ol,n),",",Io(Nl,e),",",Io(Nl,n))}function Go(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Wo(t){for(var e=0,n=t.length-1,r=[],i=t[0],o=t[1],a=r[0]=Go(i,o);++e<n;)r[e]=(a+(a=Go(i=o,o=t[e+1])))/2;return r[e]=a,r}function Fo(t){for(var e,n,r,i,o=[],a=Wo(t),s=-1,l=t.length-1;++s<l;)e=Go(t[s],t[s+1]),ya(e)<Ia?a[s]=a[s+1]=0:(n=a[s]/e,r=a[s+1]/e,i=n*n+r*r,i>9&&(i=3*e/Math.sqrt(i),a[s]=i*n,a[s+1]=i*r));for(s=-1;++s<=l;)i=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([i||0,a[s]*i||0]);return o}function Ro(t){return t.length<3?_o(t):t[0]+Eo(t,Fo(t))}function Bo(t){for(var e,n,r,i=-1,o=t.length;++i<o;)e=t[i],n=e[0],r=e[1]-Ra,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function Ho(t){function e(e){function l(){g.push("M",s(t(m),d),c,u(t(v.reverse()),d),"Z")}for(var h,p,f,g=[],v=[],m=[],y=-1,b=e.length,x=St(n),_=St(i),w=n===r?function(){return p}:St(r),k=i===o?function(){return f}:St(o);++y<b;)a.call(this,h=e[y],y)?(v.push([p=+x.call(this,h,y),f=+_.call(this,h,y)]),m.push([+w.call(this,h,y),+k.call(this,h,y)])):v.length&&(l(),v=[],m=[]);return v.length&&l(),g.length?g.join(""):null}var n=En,r=En,i=0,o=Tn,a=Ee,s=_o,l=s.key,u=s,c="L",d=.7;return e.x=function(t){return arguments.length?(n=r=t,e):r},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(i=o=t,e):o},e.y0=function(t){return arguments.length?(i=t,e):i},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=Pl.get(t)||_o).key,u=s.reverse||s,c=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(d=t,e):d},e}function jo(t){return t.radius}function Vo(t){return[t.x,t.y]}function $o(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]-Ra;return[n*Math.cos(r),n*Math.sin(r)]}}function qo(){return 64}function Uo(){return"circle"}function Xo(t){var e=Math.sqrt(t/Ga);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Yo(t){return function(){var e,n,r;(e=this[t])&&(r=e[n=e.active])&&(r.timer.c=null,r.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Ko(t,e,n){return ka(t,Bl),t.namespace=e,t.id=n,t}function Zo(t,e,n,r){var i=t.id,o=t.namespace;return j(t,"function"==typeof n?function(t,a,s){t[o][i].tween.set(e,r(n.call(t,t.__data__,a,s)))}:(n=r(n),function(t){t[o][i].tween.set(e,n)}))}function Qo(t){return null==t&&(t=""),function(){this.textContent=t}}function Jo(t){return null==t?"__transition__":"__transition_"+t+"__"}function ta(t,e,n,r,i){function o(t){var e=g.delay;return c.t=e+l,e<=t?a(t-e):void(c.c=a)}function a(n){var i=f.active,o=f[i];o&&(o.timer.c=null,o.timer.t=NaN,--f.count,delete f[i],o.event&&o.event.interrupt.call(t,t.__data__,o.index));for(var a in f)if(+a<r){var u=f[a];u.timer.c=null,u.timer.t=NaN,--f.count,delete f[a]}c.c=s,Pt(function(){return c.c&&s(n||1)&&(c.c=null,c.t=NaN),1},0,l),f.active=r,g.event&&g.event.start.call(t,t.__data__,e),p=[],g.tween.forEach(function(n,r){(r=r.call(t,t.__data__,e))&&p.push(r)}),h=g.ease,d=g.duration}function s(i){for(var o=i/d,a=h(o),s=p.length;s>0;)p[--s].call(t,a);if(o>=1)return g.event&&g.event.end.call(t,t.__data__,e),--f.count?delete f[r]:delete t[n],1}var l,c,d,h,p,f=t[n]||(t[n]={active:0,count:0}),g=f[r];g||(l=i.time,c=Pt(o,0,l),g=f[r]={tween:new u,time:l,timer:c,delay:i.delay,duration:i.duration,ease:i.ease,index:e},i=null,++f.count)}function ea(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"})}function na(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"})}function ra(t){return t.toISOString()}function ia(t,e,n){function r(e){return t(e)}function i(t,n){var r=t[1]-t[0],i=r/n,o=la.bisect(Kl,i);return o==Kl.length?[e.year,Qi(t.map(function(t){return t/31536e6}),n)[2]]:o?e[i/Kl[o-1]<Kl[o]/i?o-1:o]:[Jl,Qi(t,n)[2]]}return r.invert=function(e){return oa(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(oa)},r.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,oa(+n+1),e).length}var o=r.domain(),a=ji(o),s=null==t?i(a,10):"number"==typeof t&&i(a,t);return s&&(t=s[0],e=s[1]),r.domain(qi(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=oa(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=oa(+e+1);return e}}:t))},r.ticks=function(t,e){var n=ji(r.domain()),o=null==t?i(n,10):"number"==typeof t?i(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],oa(+n[1]+1),e<1?1:e)},r.tickFormat=function(){return n},r.copy=function(){return ia(t.copy(),e,n)},Ki(r,t)}function oa(t){return new Date(t)}function aa(t){return JSON.parse(t.responseText)}function sa(t){var e=da.createRange();return e.selectNode(da.body),e.createContextualFragment(t.responseText)}var la={version:"3.5.17"},ua=[].slice,ca=function(t){return ua.call(t)},da=this.document;if(da)try{ca(da.documentElement.childNodes)[0].nodeType}catch(t){ca=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),da)try{da.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var ha=this.Element.prototype,pa=ha.setAttribute,fa=ha.setAttributeNS,ga=this.CSSStyleDeclaration.prototype,va=ga.setProperty;ha.setAttribute=function(t,e){pa.call(this,t,e+"")},ha.setAttributeNS=function(t,e,n){fa.call(this,t,e,n+"")},ga.setProperty=function(t,e,n){va.call(this,t,e+"",n)}}la.ascending=n,la.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},la.min=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<o;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<o;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=r;break}for(;++i<o;)null!=(r=e.call(t,t[i],i))&&n>r&&(n=r)}return n},la.max=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<o;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<o;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=r;break}for(;++i<o;)null!=(r=e.call(t,t[i],i))&&r>n&&(n=r)}return n},la.extent=function(t,e){var n,r,i,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=t[o])&&r>=r){n=i=r;break}for(;++o<a;)null!=(r=t[o])&&(n>r&&(n=r),i<r&&(i=r))}else{for(;++o<a;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=i=r;break}for(;++o<a;)null!=(r=e.call(t,t[o],o))&&(n>r&&(n=r),i<r&&(i=r))}return[n,i]},la.sum=function(t,e){var n,r=0,o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)i(n=+t[a])&&(r+=n);else for(;++a<o;)i(n=+e.call(t,t[a],a))&&(r+=n);return r},la.mean=function(t,e){var n,o=0,a=t.length,s=-1,l=a;if(1===arguments.length)for(;++s<a;)i(n=r(t[s]))?o+=n:--l;else for(;++s<a;)i(n=r(e.call(t,t[s],s)))?o+=n:--l;if(l)return o/l},la.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),i=+t[r-1],o=n-r;return o?i+o*(t[r]-i):i},la.median=function(t,e){var o,a=[],s=t.length,l=-1;if(1===arguments.length)for(;++l<s;)i(o=r(t[l]))&&a.push(o);else for(;++l<s;)i(o=r(e.call(t,t[l],l)))&&a.push(o);if(a.length)return la.quantile(a.sort(n),.5)},la.variance=function(t,e){var n,o,a=t.length,s=0,l=0,u=-1,c=0;if(1===arguments.length)for(;++u<a;)i(n=r(t[u]))&&(o=n-s,s+=o/++c,l+=o*(n-s));else for(;++u<a;)i(n=r(e.call(t,t[u],u)))&&(o=n-s,s+=o/++c,l+=o*(n-s));if(c>1)return l/(c-1)},la.deviation=function(){var t=la.variance.apply(this,arguments);return t?Math.sqrt(t):t};var ma=o(n);la.bisectLeft=ma.left,la.bisect=la.bisectRight=ma.right,la.bisector=function(t){return o(1===t.length?function(e,r){return n(t(e),r)}:t)},la.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,o<2&&(e=0));for(var r,i,o=n-e;o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t},la.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},la.pairs=function(t){for(var e,n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=[e=i,i=t[++n]];return o},la.transpose=function(t){if(!(i=t.length))return[];for(var e=-1,n=la.min(t,a),r=new Array(n);++e<n;)for(var i,o=-1,s=r[e]=new Array(i);++o<i;)s[o]=t[o][e];return r},la.zip=function(){return la.transpose(arguments)},la.keys=function(t){var e=[];for(var n in t)e.push(n);return e},la.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},la.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},la.merge=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(r=t[i],e=r.length;--e>=0;)n[--a]=r[e];return n};var ya=Math.abs;la.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var r,i=[],o=s(ya(n)),a=-1;if(t*=o,e*=o,n*=o,n<0)for(;(r=t+n*++a)>e;)i.push(r/o);else for(;(r=t+n*++a)<e;)i.push(r/o);return i},la.map=function(t,e){var n=new u;if(t instanceof u)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(1===arguments.length)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e.call(t,r=t[i],i),r)}else for(var a in t)n.set(a,t[a]);return n};var ba="__proto__",xa="\0";l(u,{has:h,get:function(t){return this._[c(t)]},set:function(t,e){return this._[c(t)]=e},remove:p,keys:f,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:d(e),value:this._[e]});return t},size:g,empty:v,forEach:function(t){for(var e in this._)t.call(this,d(e),this._[e])}}),la.nest=function(){function t(e,a,s){if(s>=o.length)return r?r.call(i,a):n?a.sort(n):a;for(var l,c,d,h,p=-1,f=a.length,g=o[s++],v=new u;++p<f;)(h=v.get(l=g(c=a[p])))?h.push(c):v.set(l,[c]);return e?(c=e(),d=function(n,r){c.set(n,t(e,r,s))}):(c={},d=function(n,r){c[n]=t(e,r,s)}),v.forEach(d),c}function e(t,n){if(n>=o.length)return t;var r=[],i=a[n++];return t.forEach(function(t,i){r.push({key:t,values:e(i,n)})}),i?r.sort(function(t,e){return i(t.key,e.key)}):r}var n,r,i={},o=[],a=[];return i.map=function(e,n){return t(n,e,0)},i.entries=function(n){return e(t(la.map,n,0),0)},i.key=function(t){return o.push(t),i},i.sortKeys=function(t){return a[o.length-1]=t,i},i.sortValues=function(t){return n=t,i},i.rollup=function(t){return r=t,i},i},la.set=function(t){var e=new m;if(t)for(var n=0,r=t.length;n<r;++n)e.add(t[n]);return e},l(m,{has:h,add:function(t){return this._[c(t+="")]=!0,t},remove:p,values:f,size:g,empty:v,forEach:function(t){for(var e in this._)t.call(this,d(e))}}),la.behavior={},la.rebind=function(t,e){for(var n,r=1,i=arguments.length;++r<i;)t[n=arguments[r]]=b(t,e,e[n]);return t};var _a=["webkit","ms","moz","Moz","o","O"];la.dispatch=function(){for(var t=new w,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=k(t);return t},w.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},la.event=null,la.requote=function(t){return t.replace(wa,"\\$&")};var wa=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ka={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},Ma=function(t,e){return e.querySelector(t)},Ca=function(t,e){return e.querySelectorAll(t)},Sa=function(t,e){var n=t.matches||t[x(t,"matchesSelector")];return(Sa=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(Ma=function(t,e){return Sizzle(t,e)[0]||null},Ca=Sizzle,Sa=Sizzle.matchesSelector),la.selection=function(){return la.select(da.documentElement)};var La=la.selection.prototype=[];La.select=function(t){var e,n,r,i,o=[];t=A(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(r=this[a]).parentNode;for(var l=-1,u=r.length;++l<u;)(i=r[l])?(e.push(n=t.call(i,i.__data__,l,a)),n&&"__data__"in i&&(n.__data__=i.__data__)):e.push(null)}return L(o)},La.selectAll=function(t){var e,n,r=[];t=E(t);for(var i=-1,o=this.length;++i<o;)for(var a=this[i],s=-1,l=a.length;++s<l;)(n=a[s])&&(r.push(e=ca(t.call(n,n.__data__,s,i))),e.parentNode=n);return L(r)};var Aa="http://www.w3.org/1999/xhtml",Ea={svg:"http://www.w3.org/2000/svg",xhtml:Aa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};la.ns={prefix:Ea,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),Ea.hasOwnProperty(n)?{space:Ea[n],local:t}:t}},La.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=la.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(T(e,t[e]));return this}return this.each(T(t,e))},La.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=O(t)).length,i=-1;if(e=n.classList){for(;++i<r;)if(!e.contains(t[i]))return!1}else for(e=n.getAttribute("class");++i<r;)if(!D(t[i]).test(e))return!1;return!0}for(e in t)this.each(N(e,t[e]));return this}return this.each(N(t,e))},La.style=function(t,n,r){var i=arguments.length;if(i<3){if("string"!=typeof t){i<2&&(n="");for(r in t)this.each(z(r,t[r],n));return this}if(i<2){var o=this.node();return e(o).getComputedStyle(o,null).getPropertyValue(t)}r=""}return this.each(z(t,n,r))},La.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(G(e,t[e]));return this}return this.each(G(t,e))},La.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},La.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},La.append=function(t){return t=W(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},La.insert=function(t,e){return t=W(t),e=A(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},La.remove=function(){return this.each(F)},La.data=function(t,e){function n(t,n){var r,i,o,a=t.length,d=n.length,h=Math.min(a,d),p=new Array(d),f=new Array(d),g=new Array(a);if(e){var v,m=new u,y=new Array(a);for(r=-1;++r<a;)(i=t[r])&&(m.has(v=e.call(i,i.__data__,r))?g[r]=i:m.set(v,i),y[r]=v);for(r=-1;++r<d;)(i=m.get(v=e.call(n,o=n[r],r)))?i!==!0&&(p[r]=i,i.__data__=o):f[r]=R(o),m.set(v,!0);for(r=-1;++r<a;)r in y&&m.get(y[r])!==!0&&(g[r]=t[r])}else{for(r=-1;++r<h;)i=t[r],o=n[r],i?(i.__data__=o,p[r]=i):f[r]=R(o);for(;r<d;++r)f[r]=R(n[r]);for(;r<a;++r)g[r]=t[r]}f.update=p,f.parentNode=p.parentNode=g.parentNode=t.parentNode,s.push(f),l.push(p),c.push(g)}var r,i,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(r=this[0]).length);++o<a;)(i=r[o])&&(t[o]=i.__data__);return t}var s=V([]),l=L([]),c=L([]);if("function"==typeof t)for(;++o<a;)n(r=this[o],t.call(r,r.parentNode.__data__,o));else for(;++o<a;)n(r=this[o],t);return l.enter=function(){return s},l.exit=function(){return c},l},La.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},La.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;o<a;o++){i.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;s<l;s++)(r=n[s])&&t.call(r,r.__data__,s,o)&&e.push(r)}return L(i)},La.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],i=r.length-1,o=r[i];--i>=0;)(n=r[i])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},La.sort=function(t){t=H.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},La.each=function(t){return j(this,function(e,n,r){t.call(e,e.__data__,n,r)})},La.call=function(t){var e=ca(arguments);return t.apply(e[0]=this,e),this},La.empty=function(){return!this.node()},La.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],r=0,i=n.length;r<i;r++){var o=n[r];if(o)return o}return null},La.size=function(){var t=0;return j(this,function(){++t}),t};var Ta=[];la.selection.enter=V,la.selection.enter.prototype=Ta,Ta.append=La.append,Ta.empty=La.empty,Ta.node=La.node,Ta.call=La.call,Ta.size=La.size,Ta.select=function(t){for(var e,n,r,i,o,a=[],s=-1,l=this.length;++s<l;){r=(i=this[s]).update,a.push(e=[]),e.parentNode=i.parentNode;for(var u=-1,c=i.length;++u<c;)(o=i[u])?(e.push(r[u]=n=t.call(i.parentNode,o.__data__,u,s)),n.__data__=o.__data__):e.push(null)}return L(a)},Ta.insert=function(t,e){return arguments.length<2&&(e=$(this)),La.insert.call(this,t,e)},la.select=function(e){var n;return"string"==typeof e?(n=[Ma(e,da)],n.parentNode=da.documentElement):(n=[e],n.parentNode=t(e)),L([n])},la.selectAll=function(t){var e;return"string"==typeof t?(e=ca(Ca(t,da)),e.parentNode=da.documentElement):(e=ca(t),e.parentNode=null),L([e])},La.on=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){r<2&&(e=!1);for(n in t)this.each(q(n,t[n],e));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(q(t,e,n))};var Pa=la.map({mouseenter:"mouseover",mouseleave:"mouseout"});da&&Pa.forEach(function(t){"on"+t in da&&Pa.remove(t)});var Da,Oa=0;la.mouse=function(t){return K(t,C())};var Na=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;la.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=C().changedTouches),e)for(var r,i=0,o=e.length;i<o;++i)if((r=e[i]).identifier===n)return K(t,r)},la.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function n(t,e,n,o,a){return function(){function s(){var t,n,r=e(h,g);r&&(t=r[0]-b[0],n=r[1]-b[1],f|=t|n,b=r,p({type:"drag",x:r[0]+u[0],y:r[1]+u[1],dx:t,dy:n}))}function l(){e(h,g)&&(m.on(o+v,null).on(a+v,null),y(f),p({type:"dragend"}))}var u,c=this,d=la.event.target.correspondingElement||la.event.target,h=c.parentNode,p=r.of(c,arguments),f=0,g=t(),v=".drag"+(null==g?"":"-"+g),m=la.select(n(d)).on(o+v,s).on(a+v,l),y=Y(d),b=e(h,g);i?(u=i.apply(c,arguments),u=[u.x-b[0],u.y-b[1]]):u=[0,0],p({type:"dragstart"})}}var r=S(t,"drag","dragstart","dragend"),i=null,o=n(_,la.mouse,e,"mousemove","mouseup"),a=n(Z,la.touch,y,"touchmove","touchend");return t.origin=function(e){return arguments.length?(i=e,t):i},la.rebind(t,r,"on")},la.touches=function(t,e){return arguments.length<2&&(e=C().touches),e?ca(e).map(function(e){var n=K(t,e);return n.identifier=e.identifier,n}):[]};var Ia=1e-6,za=Ia*Ia,Ga=Math.PI,Wa=2*Ga,Fa=Wa-Ia,Ra=Ga/2,Ba=Ga/180,Ha=180/Ga,ja=Math.SQRT2,Va=2,$a=4;la.interpolateZoom=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[0],l=e[1],u=e[2],c=s-i,d=l-o,h=c*c+d*d;if(h<za)r=Math.log(u/a)/ja,n=function(t){return[i+t*c,o+t*d,a*Math.exp(ja*t*r)]};else{var p=Math.sqrt(h),f=(u*u-a*a+$a*h)/(2*a*Va*p),g=(u*u-a*a-$a*h)/(2*u*Va*p),v=Math.log(Math.sqrt(f*f+1)-f),m=Math.log(Math.sqrt(g*g+1)-g);r=(m-v)/ja,n=function(t){var e=t*r,n=rt(v),s=a/(Va*p)*(n*it(ja*e+v)-nt(v));return[i+s*c,o+s*d,a*n/rt(ja*e+v)]}}return n.duration=1e3*r,n},la.behavior.zoom=function(){function t(t){t.on(P,d).on(Ua+".zoom",p).on("dblclick.zoom",f).on(N,h)}function n(t){return[(t[0]-C.x)/C.k,(t[1]-C.y)/C.k]}function r(t){return[t[0]*C.k+C.x,t[1]*C.k+C.y]}function i(t){C.k=Math.max(A[0],Math.min(A[1],t))}function o(t,e){e=r(e),C.x+=t[0]-e[0],C.y+=t[1]-e[1]}function a(e,n,r,a){e.__chart__={x:C.x,y:C.y,k:C.k},i(Math.pow(2,a)),o(v=n,r),e=la.select(e),E>0&&(e=e.transition().duration(E)),e.call(t.event)}function s(){_&&_.domain(x.range().map(function(t){return(t-C.x)/C.k}).map(x.invert)),k&&k.domain(w.range().map(function(t){return(t-C.y)/C.k}).map(w.invert))}function l(t){T++||t({type:"zoomstart"})}function u(t){s(),t({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function c(t){--T||(t({type:"zoomend"}),v=null)}function d(){function t(){s=1,o(la.mouse(i),h),u(a)}function r(){d.on(D,null).on(O,null),p(s),c(a)}var i=this,a=I.of(i,arguments),s=0,d=la.select(e(i)).on(D,t).on(O,r),h=n(la.mouse(i)),p=Y(i);Rl.call(i),l(a)}function h(){function t(){var t=la.touches(f);return p=C.k,t.forEach(function(t){t.identifier in v&&(v[t.identifier]=n(t))}),t}function e(){var e=la.event.target;la.select(e).on(x,r).on(_,s),w.push(e);for(var n=la.event.changedTouches,i=0,o=n.length;i<o;++i)v[n[i].identifier]=null;var l=t(),u=Date.now();if(1===l.length){if(u-b<500){var c=l[0];a(f,c,v[c.identifier],Math.floor(Math.log(C.k)/Math.LN2)+1),M()}b=u}else if(l.length>1){var c=l[0],d=l[1],h=c[0]-d[0],p=c[1]-d[1];m=h*h+p*p}}function r(){var t,e,n,r,a=la.touches(f);Rl.call(f);for(var s=0,l=a.length;s<l;++s,r=null)if(n=a[s],r=v[n.identifier]){if(e)break;t=n,e=r}if(r){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,d=m&&Math.sqrt(c/m);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+r[0])/2,(e[1]+r[1])/2],i(d*p)}b=null,o(t,e),u(g)}function s(){if(la.event.touches.length){for(var e=la.event.changedTouches,n=0,r=e.length;n<r;++n)delete v[e[n].identifier];for(var i in v)return void t()}la.selectAll(w).on(y,null),k.on(P,d).on(N,h),S(),c(g)}var p,f=this,g=I.of(f,arguments),v={},m=0,y=".zoom-"+la.event.changedTouches[0].identifier,x="touchmove"+y,_="touchend"+y,w=[],k=la.select(f),S=Y(f);e(),l(g),k.on(P,null).on(N,e)}function p(){var t=I.of(this,arguments);y?clearTimeout(y):(Rl.call(this),g=n(v=m||la.mouse(this)),l(t)),y=setTimeout(function(){y=null,c(t)},50),M(),i(Math.pow(2,.002*qa())*C.k),o(v,g),u(t)}function f(){var t=la.mouse(this),e=Math.log(C.k)/Math.LN2;a(this,t,n(t),la.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var g,v,m,y,b,x,_,w,k,C={x:0,y:0,k:1},L=[960,500],A=Xa,E=250,T=0,P="mousedown.zoom",D="mousemove.zoom",O="mouseup.zoom",N="touchstart.zoom",I=S(t,"zoomstart","zoom","zoomend");
return Ua||(Ua="onwheel"in da?(qa=function(){return-la.event.deltaY*(la.event.deltaMode?120:1)},"wheel"):"onmousewheel"in da?(qa=function(){return la.event.wheelDelta},"mousewheel"):(qa=function(){return-la.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=I.of(this,arguments),e=C;Wl?la.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},l(t)}).tween("zoom:zoom",function(){var n=L[0],r=L[1],i=v?v[0]:n/2,o=v?v[1]:r/2,a=la.interpolateZoom([(i-C.x)/C.k,(o-C.y)/C.k,n/C.k],[(i-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var r=a(e),s=n/r[2];this.__chart__=C={x:i-r[0]*s,y:o-r[1]*s,k:s},u(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=C,l(t),u(t),c(t))})},t.translate=function(e){return arguments.length?(C={x:+e[0],y:+e[1],k:C.k},s(),t):[C.x,C.y]},t.scale=function(e){return arguments.length?(C={x:C.x,y:C.y,k:null},i(+e),s(),t):C.k},t.scaleExtent=function(e){return arguments.length?(A=null==e?Xa:[+e[0],+e[1]],t):A},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(L=e&&[+e[0],+e[1]],t):L},t.duration=function(e){return arguments.length?(E=+e,t):E},t.x=function(e){return arguments.length?(_=e,x=e.copy(),C={x:0,y:0,k:1},t):_},t.y=function(e){return arguments.length?(k=e,w=e.copy(),C={x:0,y:0,k:1},t):k},la.rebind(t,I,"on")};var qa,Ua,Xa=[0,1/0];la.color=at,at.prototype.toString=function(){return this.rgb()+""},la.hsl=st;var Ya=st.prototype=new at;Ya.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,this.l/t)},Ya.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,t*this.l)},Ya.rgb=function(){return lt(this.h,this.s,this.l)},la.hcl=ut;var Ka=ut.prototype=new at;Ka.brighter=function(t){return new ut(this.h,this.c,Math.min(100,this.l+Za*(arguments.length?t:1)))},Ka.darker=function(t){return new ut(this.h,this.c,Math.max(0,this.l-Za*(arguments.length?t:1)))},Ka.rgb=function(){return ct(this.h,this.c,this.l).rgb()},la.lab=dt;var Za=18,Qa=.95047,Ja=1,ts=1.08883,es=dt.prototype=new at;es.brighter=function(t){return new dt(Math.min(100,this.l+Za*(arguments.length?t:1)),this.a,this.b)},es.darker=function(t){return new dt(Math.max(0,this.l-Za*(arguments.length?t:1)),this.a,this.b)},es.rgb=function(){return ht(this.l,this.a,this.b)},la.rgb=mt;var ns=mt.prototype=new at;ns.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,i=30;return e||n||r?(e&&e<i&&(e=i),n&&n<i&&(n=i),r&&r<i&&(r=i),new mt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new mt(i,i,i)},ns.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new mt(t*this.r,t*this.g,t*this.b)},ns.hsl=function(){return wt(this.r,this.g,this.b)},ns.toString=function(){return"#"+xt(this.r)+xt(this.g)+xt(this.b)};var rs=la.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});rs.forEach(function(t,e){rs.set(t,yt(e))}),la.functor=St,la.xhr=Lt(y),la.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var a=At(t,e,null==n?r:i(n),o);return a.row=function(t){return arguments.length?a.response(null==(n=t)?r:i(t)):n},a}function r(t){return n.parse(t.responseText)}function i(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return n.parse=function(t,e){var r;return n.parseRows(t,function(t,n){if(r)return r(t,n-1);var i=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(i(t),n)}:i})},n.parseRows=function(t,e){function n(){if(c>=u)return a;if(i)return i=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var r=t.charCodeAt(n+1);return 13===r?(i=!0,10===t.charCodeAt(n+2)&&++c):10===r&&(i=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c<u;){var r=t.charCodeAt(c++),s=1;if(10===r)i=!0;else if(13===r)i=!0,10===t.charCodeAt(c)&&(++c,++s);else if(r!==l)continue;return t.slice(e,c-s)}return t.slice(e)}for(var r,i,o={},a={},s=[],u=t.length,c=0,d=0;(r=n())!==a;){for(var h=[];r!==o&&r!==a;)h.push(r),r=n();e&&null==(h=e(h,d++))||s.push(h)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var r=new m,i=[];return e.forEach(function(t){for(var e in t)r.has(e)||i.push(r.add(e))}),[i.map(a).join(t)].concat(e.map(function(e){return i.map(function(t){return a(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},la.csv=la.dsv(",","text/csv"),la.tsv=la.dsv("\t","text/tab-separated-values");var is,os,as,ss,ls=this[x(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};la.timer=function(){Pt.apply(this,arguments)},la.timer.flush=function(){Ot(),Nt()},la.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var us=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(zt);la.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=la.round(t,It(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),us[8+n/3]};var cs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ds=la.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=la.round(t,It(t,e))).toFixed(Math.max(0,Math.min(20,It(t*(1+1e-15),e))))}}),hs=la.time={},ps=Date;Ft.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){fs.setUTCDate.apply(this._,arguments)},setDay:function(){fs.setUTCDay.apply(this._,arguments)},setFullYear:function(){fs.setUTCFullYear.apply(this._,arguments)},setHours:function(){fs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){fs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){fs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){fs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){fs.setUTCSeconds.apply(this._,arguments)},setTime:function(){fs.setTime.apply(this._,arguments)}};var fs=Date.prototype;hs.year=Rt(function(t){return t=hs.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),hs.years=hs.year.range,hs.years.utc=hs.year.utc.range,hs.day=Rt(function(t){var e=new ps(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),hs.days=hs.day.range,hs.days.utc=hs.day.utc.range,hs.dayOfYear=function(t){var e=hs.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=hs[t]=Rt(function(t){return(t=hs.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=hs.year(t).getDay();return Math.floor((hs.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});hs[t+"s"]=n.range,hs[t+"s"].utc=n.utc.range,hs[t+"OfYear"]=function(t){var n=hs.year(t).getDay();return Math.floor((hs.dayOfYear(t)+(n+e)%7)/7)}}),hs.week=hs.sunday,hs.weeks=hs.sunday.range,hs.weeks.utc=hs.sunday.utc.range,hs.weekOfYear=hs.sundayOfYear;var gs={"-":"",_:" ",0:"0"},vs=/^\s*\d+/,ms=/^%/;la.locale=function(t){return{numberFormat:Gt(t),timeFormat:Ht(t)}};var ys=la.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});la.format=ys.numberFormat,la.geo={},ue.prototype={s:0,t:0,add:function(t){ce(t,this.t,bs),ce(bs.s,this.s,this),this.s?this.t+=bs.t:this.s=bs.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var bs=new ue;la.geo.stream=function(t,e){t&&xs.hasOwnProperty(t.type)?xs[t.type](t,e):de(t,e)};var xs={Feature:function(t,e){de(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)de(n[r].geometry,e)}},_s={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){he(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)he(n[r],e,0)},Polygon:function(t,e){pe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)pe(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)de(n[r],e)}};la.geo.area=function(t){return ws=0,la.geo.stream(t,Ms),ws};var ws,ks=new ue,Ms={sphere:function(){ws+=4*Ga},point:_,lineStart:_,lineEnd:_,polygonStart:function(){ks.reset(),Ms.lineStart=fe},polygonEnd:function(){var t=2*ks;ws+=t<0?4*Ga+t:t,Ms.lineStart=Ms.lineEnd=Ms.point=_}};la.geo.bounds=function(){function t(t,e){b.push(x=[c=t,h=t]),e<d&&(d=e),e>p&&(p=e)}function e(e,n){var r=ge([e*Ba,n*Ba]);if(m){var i=me(m,r),o=[i[1],-i[0],0],a=me(o,i);xe(a),a=_e(a);var l=e-f,u=l>0?1:-1,g=a[0]*Ha*u,v=ya(l)>180;if(v^(u*f<g&&g<u*e)){var y=a[1]*Ha;y>p&&(p=y)}else if(g=(g+360)%360-180,v^(u*f<g&&g<u*e)){var y=-a[1]*Ha;y<d&&(d=y)}else n<d&&(d=n),n>p&&(p=n);v?e<f?s(c,e)>s(c,h)&&(h=e):s(e,h)>s(c,h)&&(c=e):h>=c?(e<c&&(c=e),e>h&&(h=e)):e>f?s(c,e)>s(c,h)&&(h=e):s(e,h)>s(c,h)&&(c=e)}else t(e,n);m=r,f=e}function n(){_.point=e}function r(){x[0]=c,x[1]=h,_.point=t,m=null}function i(t,n){if(m){var r=t-f;y+=ya(r)>180?r+(r>0?360:-360):r}else g=t,v=n;Ms.point(t,n),e(t,n)}function o(){Ms.lineStart()}function a(){i(g,v),Ms.lineEnd(),ya(y)>Ia&&(c=-(h=180)),x[0]=c,x[1]=h,m=null}function s(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,d,h,p,f,g,v,m,y,b,x,_={point:t,lineStart:n,lineEnd:r,polygonStart:function(){_.point=i,_.lineStart=o,_.lineEnd=a,y=0,Ms.polygonStart()},polygonEnd:function(){Ms.polygonEnd(),_.point=t,_.lineStart=n,_.lineEnd=r,ks<0?(c=-(h=180),d=-(p=90)):y>Ia?p=90:y<-Ia&&(d=-90),x[0]=c,x[1]=h}};return function(t){p=h=-(c=d=1/0),b=[],la.geo.stream(t,_);var e=b.length;if(e){b.sort(l);for(var n,r=1,i=b[0],o=[i];r<e;++r)n=b[r],u(n[0],i)||u(n[1],i)?(s(i[0],n[1])>s(i[0],i[1])&&(i[1]=n[1]),s(n[0],i[1])>s(i[0],i[1])&&(i[0]=n[0])):o.push(i=n);for(var a,n,f=-(1/0),e=o.length-1,r=0,i=o[e];r<=e;i=n,++r)n=o[r],(a=s(i[1],n[0]))>f&&(f=a,c=n[0],h=i[1])}return b=x=null,c===1/0||d===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,d],[h,p]]}}(),la.geo.centroid=function(t){Cs=Ss=Ls=As=Es=Ts=Ps=Ds=Os=Ns=Is=0,la.geo.stream(t,zs);var e=Os,n=Ns,r=Is,i=e*e+n*n+r*r;return i<za&&(e=Ts,n=Ps,r=Ds,Ss<Ia&&(e=Ls,n=As,r=Es),i=e*e+n*n+r*r,i<za)?[NaN,NaN]:[Math.atan2(n,e)*Ha,et(r/Math.sqrt(i))*Ha]};var Cs,Ss,Ls,As,Es,Ts,Ps,Ds,Os,Ns,Is,zs={sphere:_,point:ke,lineStart:Ce,lineEnd:Se,polygonStart:function(){zs.lineStart=Le},polygonEnd:function(){zs.lineStart=Ce}},Gs=Oe(Ee,Ge,Fe,[-Ga,-Ga/2]),Ws=1e9;la.geo.clipExtent=function(){var t,e,n,r,i,o,a={stream:function(t){return i&&(i.valid=!1),i=o(t),i.valid=!0,i},extent:function(s){return arguments.length?(o=je(t=+s[0][0],e=+s[0][1],n=+s[1][0],r=+s[1][1]),i&&(i.valid=!1,i=null),a):[[t,e],[n,r]]}};return a.extent([[0,0],[960,500]])},(la.geo.conicEqualArea=function(){return Ve($e)}).raw=$e,la.geo.albers=function(){return la.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},la.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(r(o,a),e)||i(o,a),e}var e,n,r,i,o=la.geo.albers(),a=la.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=la.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=a.stream(t),r=s.stream(t);return{point:function(t,i){e.point(t,i),n.point(t,i),r.point(t,i)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var u=o.scale(),c=+e[0],d=+e[1];return n=o.translate(e).clipExtent([[c-.455*u,d-.238*u],[c+.455*u,d+.238*u]]).stream(l).point,r=a.translate([c-.307*u,d+.201*u]).clipExtent([[c-.425*u+Ia,d+.12*u+Ia],[c-.214*u-Ia,d+.234*u-Ia]]).stream(l).point,i=s.translate([c-.205*u,d+.212*u]).clipExtent([[c-.214*u+Ia,d+.166*u+Ia],[c-.115*u-Ia,d+.234*u-Ia]]).stream(l).point,t},t.scale(1070)};var Fs,Rs,Bs,Hs,js,Vs,$s={point:_,lineStart:_,lineEnd:_,polygonStart:function(){Rs=0,$s.lineStart=qe},polygonEnd:function(){$s.lineStart=$s.lineEnd=$s.point=_,Fs+=ya(Rs/2)}},qs={point:Ue,lineStart:_,lineEnd:_,polygonStart:_,polygonEnd:_},Us={point:Ke,lineStart:Ze,lineEnd:Qe,polygonStart:function(){Us.lineStart=Je},polygonEnd:function(){Us.point=Ke,Us.lineStart=Ze,Us.lineEnd=Qe}};la.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=i(o)),la.geo.stream(t,a)),o.result()}function e(){return a=null,t}var n,r,i,o,a,s=4.5;return t.area=function(t){return Fs=0,la.geo.stream(t,i($s)),Fs},t.centroid=function(t){return Ls=As=Es=Ts=Ps=Ds=Os=Ns=Is=0,la.geo.stream(t,i(Us)),Is?[Os/Is,Ns/Is]:Ds?[Ts/Ds,Ps/Ds]:Es?[Ls/Es,As/Es]:[NaN,NaN]},t.bounds=function(t){return js=Vs=-(Bs=Hs=1/0),la.geo.stream(t,i(qs)),[[Bs,Hs],[js,Vs]]},t.projection=function(t){return arguments.length?(i=(n=t)?t.stream||nn(t):y,e()):n},t.context=function(t){return arguments.length?(o=null==(r=t)?new Xe:new tn(t),"function"!=typeof s&&o.pointRadius(s),e()):r},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(la.geo.albersUsa()).context(null)},la.geo.transform=function(t){return{stream:function(e){var n=new rn(e);for(var r in t)n[r]=t[r];return n}}},rn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},la.geo.projection=an,la.geo.projectionMutator=sn,(la.geo.equirectangular=function(){return an(un)}).raw=un.invert=un,la.geo.rotation=function(t){function e(e){return e=t(e[0]*Ba,e[1]*Ba),e[0]*=Ha,e[1]*=Ha,e}return t=dn(t[0]%360*Ba,t[1]*Ba,t.length>2?t[2]*Ba:0),e.invert=function(e){return e=t.invert(e[0]*Ba,e[1]*Ba),e[0]*=Ha,e[1]*=Ha,e},e},cn.invert=un,la.geo.circle=function(){function t(){var t="function"==typeof r?r.apply(this,arguments):r,e=dn(-t[0]*Ba,-t[1]*Ba,0).invert,i=[];return n(null,null,1,{point:function(t,n){i.push(t=e(t,n)),t[0]*=Ha,t[1]*=Ha}}),{type:"Polygon",coordinates:[i]}}var e,n,r=[0,0],i=6;return t.origin=function(e){return arguments.length?(r=e,t):r},t.angle=function(r){return arguments.length?(n=gn((e=+r)*Ba,i*Ba),t):e},t.precision=function(r){return arguments.length?(n=gn(e*Ba,(i=+r)*Ba),t):i},t.angle(90)},la.geo.distance=function(t,e){var n,r=(e[0]-t[0])*Ba,i=t[1]*Ba,o=e[1]*Ba,a=Math.sin(r),s=Math.cos(r),l=Math.sin(i),u=Math.cos(i),c=Math.sin(o),d=Math.cos(o);return Math.atan2(Math.sqrt((n=d*a)*n+(n=u*c-l*d*s)*n),l*c+u*d*s)},la.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return la.range(Math.ceil(o/v)*v,i,v).map(h).concat(la.range(Math.ceil(u/m)*m,l,m).map(p)).concat(la.range(Math.ceil(r/f)*f,n,f).filter(function(t){return ya(t%v)>Ia}).map(c)).concat(la.range(Math.ceil(s/g)*g,a,g).filter(function(t){return ya(t%m)>Ia}).map(d))}var n,r,i,o,a,s,l,u,c,d,h,p,f=10,g=f,v=90,m=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[h(o).concat(p(l).slice(1),h(i).reverse().slice(1),p(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],i=+e[1][0],u=+e[0][1],l=+e[1][1],o>i&&(e=o,o=i,i=e),u>l&&(e=u,u=l,l=e),t.precision(y)):[[o,u],[i,l]]},t.minorExtent=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(y)):[[r,s],[n,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(v=+e[0],m=+e[1],t):[v,m]},t.minorStep=function(e){return arguments.length?(f=+e[0],g=+e[1],t):[f,g]},t.precision=function(e){return arguments.length?(y=+e,c=mn(s,a,90),d=yn(r,n,y),h=mn(u,l,90),p=yn(o,i,y),t):y},t.majorExtent([[-180,-90+Ia],[180,90-Ia]]).minorExtent([[-180,-80-Ia],[180,80+Ia]])},la.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||r.apply(this,arguments),n||i.apply(this,arguments)]}}var e,n,r=bn,i=xn;return t.distance=function(){return la.geo.distance(e||r.apply(this,arguments),n||i.apply(this,arguments))},t.source=function(n){return arguments.length?(r=n,e="function"==typeof n?null:n,t):r},t.target=function(e){return arguments.length?(i=e,n="function"==typeof e?null:e,t):i},t.precision=function(){return arguments.length?t:0},t},la.geo.interpolate=function(t,e){return _n(t[0]*Ba,t[1]*Ba,e[0]*Ba,e[1]*Ba)},la.geo.length=function(t){return Xs=0,la.geo.stream(t,Ys),Xs};var Xs,Ys={sphere:_,point:_,lineStart:wn,lineEnd:_,polygonStart:_,polygonEnd:_},Ks=kn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(la.geo.azimuthalEqualArea=function(){return an(Ks)}).raw=Ks;var Zs=kn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},y);(la.geo.azimuthalEquidistant=function(){return an(Zs)}).raw=Zs,(la.geo.conicConformal=function(){return Ve(Mn)}).raw=Mn,(la.geo.conicEquidistant=function(){return Ve(Cn)}).raw=Cn;var Qs=kn(function(t){return 1/t},Math.atan);(la.geo.gnomonic=function(){return an(Qs)}).raw=Qs,Sn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Ra]},(la.geo.mercator=function(){return Ln(Sn)}).raw=Sn;var Js=kn(function(){return 1},Math.asin);(la.geo.orthographic=function(){return an(Js)}).raw=Js;var tl=kn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(la.geo.stereographic=function(){return an(tl)}).raw=tl,An.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Ra]},(la.geo.transverseMercator=function(){var t=Ln(An),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=An,la.geom={},la.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,i=St(n),o=St(r),a=t.length,s=[],l=[];for(e=0;e<a;e++)s.push([+i.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(Dn),e=0;e<a;e++)l.push([s[e][0],-s[e][1]]);var u=Pn(s),c=Pn(l),d=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(e=u.length-1;e>=0;--e)p.push(t[s[u[e]][2]]);for(e=+d;e<c.length-h;++e)p.push(t[s[c[e]][2]]);return p}var n=En,r=Tn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e)},la.geom.polygon=function(t){return ka(t,el),t};var el=la.geom.polygon.prototype=[];el.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],i=0;++e<n;)t=r,r=this[e],i+=t[1]*r[0]-t[0]*r[1];return.5*i},el.centroid=function(t){var e,n,r=-1,i=this.length,o=0,a=0,s=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)e=s,s=this[r],n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o*t,a*t]},el.clip=function(t){for(var e,n,r,i,o,a,s=In(t),l=-1,u=this.length-In(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,i=this[l],o=e[(r=e.length-s)-1],n=-1;++n<r;)a=e[n],On(a,c,i)?(On(o,c,i)||t.push(Nn(o,a,c,i)),t.push(a)):On(o,c,i)&&t.push(Nn(o,a,c,i)),o=a;s&&t.push(t[0]),c=i}return t};var nl,rl,il,ol,al,sl=[],ll=[];jn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort($n),e.length},er.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},nr.prototype={insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ar(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(ir(this,n),t=n,n=t.U),n.C=!1,r.C=!0,or(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(or(this,n),t=n,n=t.U),n.C=!1,r.C=!0,ir(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?ar(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,ir(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,or(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,ir(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,or(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ir(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,or(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}},la.geom.voronoi=function(t){function e(t){var e=new Array(t.length),r=s[0][0],i=s[0][1],o=s[1][0],a=s[1][1];return sr(n(t),s).cells.forEach(function(n,s){var l=n.edges,u=n.site,c=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=r&&u.x<=o&&u.y>=i&&u.y<=a?[[r,a],[o,a],[o,i],[r,i]]:[];c.point=t[s]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/Ia)*Ia,y:Math.round(a(t,e)/Ia)*Ia,i:e}})}var r=En,i=Tn,o=r,a=i,s=ul;return t?e(t):(e.links=function(t){return sr(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return sr(n(t)).cells.forEach(function(n,r){for(var i,o,a=n.site,s=n.edges.sort($n),l=-1,u=s.length,c=s[u-1].edge,d=c.l===a?c.r:c.l;++l<u;)i=c,o=d,c=s[l].edge,d=c.l===a?c.r:c.l,r<o.i&&r<d.i&&ur(a,o,d)<0&&e.push([t[r],t[o.i],t[d.i]])}),e},e.x=function(t){return arguments.length?(o=St(r=t),e):r},e.y=function(t){return arguments.length?(a=St(i=t),e):i},e.clipExtent=function(t){return arguments.length?(s=null==t?ul:t,e):s===ul?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===ul?null:s&&s[1]},e)};var ul=[[-1e6,-1e6],[1e6,1e6]];la.geom.delaunay=function(t){return la.geom.voronoi().triangles(t)},la.geom.quadtree=function(t,e,n,r,i){function o(t){function o(t,e,n,r,i,o,a,s){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(ya(l-n)+ya(c-r)<.01)u(t,e,n,r,i,o,a,s);else{var d=t.point;t.x=t.y=t.point=null,u(t,d,l,c,i,o,a,s),u(t,e,n,r,i,o,a,s)}else t.x=n,t.y=r,t.point=e}else u(t,e,n,r,i,o,a,s)}function u(t,e,n,r,i,a,s,l){var u=.5*(i+s),c=.5*(a+l),d=n>=u,h=r>=c,p=h<<1|d;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=hr()),d?i=u:s=u,h?a=c:l=c,o(t,e,n,r,i,a,s,l)}var c,d,h,p,f,g,v,m,y,b=St(s),x=St(l);if(null!=e)g=e,v=n,m=r,y=i;else if(m=y=-(g=v=1/0),d=[],h=[],f=t.length,a)for(p=0;p<f;++p)c=t[p],c.x<g&&(g=c.x),c.y<v&&(v=c.y),c.x>m&&(m=c.x),c.y>y&&(y=c.y),d.push(c.x),h.push(c.y);else for(p=0;p<f;++p){var _=+b(c=t[p],p),w=+x(c,p);_<g&&(g=_),w<v&&(v=w),_>m&&(m=_),w>y&&(y=w),d.push(_),h.push(w)}var k=m-g,M=y-v;k>M?y=v+k:m=g+M;var C=hr();if(C.add=function(t){o(C,t,+b(t,++p),+x(t,p),g,v,m,y)},C.visit=function(t){pr(t,C,g,v,m,y)},C.find=function(t){return fr(C,t[0],t[1],g,v,m,y)},p=-1,null==e){for(;++p<f;)o(C,t[p],d[p],h[p],g,v,m,y);--p}else t.forEach(C.add);return d=h=t=c=null,C}var a,s=En,l=Tn;return(a=arguments.length)?(s=cr,l=dr,3===a&&(i=n,r=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(l=t,o):l},o.extent=function(t){return arguments.length?(null==t?e=n=r=i=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),o):null==e?null:[[e,n],[r,i]]},o.size=function(t){return arguments.length?(null==t?e=n=r=i=null:(e=n=0,r=+t[0],i=+t[1]),o):null==e?null:[r-e,i-n]},o)},la.interpolateRgb=gr,la.interpolateObject=vr,la.interpolateNumber=mr,la.interpolateString=yr;var cl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dl=new RegExp(cl.source,"g");la.interpolate=br,la.interpolators=[function(t,e){var n=typeof e;return("string"===n?rs.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?gr:yr:e instanceof at?gr:Array.isArray(e)?xr:"object"===n&&isNaN(e)?vr:mr)(t,e)}],la.interpolateArray=xr;var hl=function(){return y},pl=la.map({linear:hl,poly:Lr,quad:function(){return Mr},cubic:function(){return Cr},sin:function(){return Ar},exp:function(){return Er},circle:function(){return Tr},elastic:Pr,back:Dr,bounce:function(){return Or}}),fl=la.map({in:y,out:wr,"in-out":kr,"out-in":function(t){return kr(wr(t))}});la.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,r=e>=0?t.slice(e+1):"in";return n=pl.get(n)||hl,r=fl.get(r)||y,_r(r(n.apply(null,ua.call(arguments,1))))},la.interpolateHcl=Nr,la.interpolateHsl=Ir,la.interpolateLab=zr,la.interpolateRound=Gr,la.transform=function(t){var e=da.createElementNS(la.ns.prefix.svg,"g");return(la.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Wr(n?n.matrix:gl)})(t)},Wr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var gl={a:1,b:0,c:0,d:1,e:0,f:0};la.interpolateTransform=Ur,la.layout={},la.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(Kr(t[n]));return e}},la.layout.chord=function(){function t(){var t,u,d,h,p,f={},g=[],v=la.range(o),m=[];for(n=[],r=[],t=0,h=-1;++h<o;){for(u=0,p=-1;++p<o;)u+=i[h][p];g.push(u),m.push(la.range(o)),t+=u}for(a&&v.sort(function(t,e){return a(g[t],g[e])}),s&&m.forEach(function(t,e){t.sort(function(t,n){return s(i[e][t],i[e][n])})}),t=(Wa-c*o)/t,u=0,h=-1;++h<o;){for(d=u,p=-1;++p<o;){var y=v[h],b=m[y][p],x=i[y][b],_=u,w=u+=x*t;f[y+"-"+b]={index:y,subindex:b,startAngle:_,endAngle:w,value:x}}r[y]={index:y,startAngle:d,endAngle:u,value:g[y]},u+=c}for(h=-1;++h<o;)for(p=h-1;++p<o;){var k=f[h+"-"+p],M=f[p+"-"+h];(k.value||M.value)&&n.push(k.value<M.value?{source:M,target:k}:{source:k,target:M})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,r,i,o,a,s,l,u={},c=0;return u.matrix=function(t){return arguments.length?(o=(i=t)&&i.length,n=r=null,u):i},u.padding=function(t){return arguments.length?(c=t,n=r=null,u):c},u.sortGroups=function(t){return arguments.length?(a=t,n=r=null,u):a},u.sortSubgroups=function(t){return arguments.length?(s=t,n=null,u):s},u.sortChords=function(t){return arguments.length?(l=t,n&&e(),u):l},u.chords=function(){return n||t(),n},u.groups=function(){return r||t(),r},u},la.layout.force=function(){function t(t){return function(e,n,r,i){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=i-n,l=o*o+a*a;if(s*s/m<l){if(l<g){var u=e.charge/l;t.px-=o*u,t.py-=a*u}return!0}if(e.point&&l&&l<g){var u=e.pointCharge/l;t.px-=o*u,t.py-=a*u}}return!e.charge}}function e(t){t.px=la.event.x,t.py=la.event.y,l.resume()}var n,r,i,o,a,s,l={},u=la.dispatch("start","tick","end"),c=[1,1],d=.9,h=vl,p=ml,f=-30,g=yl,v=.1,m=.64,b=[],x=[];return l.tick=function(){if((i*=.99)<.005)return n=null,u.end({type:"end",alpha:i=0}),!0;var e,r,l,h,p,g,m,y,_,w=b.length,k=x.length;for(r=0;r<k;++r)l=x[r],h=l.source,p=l.target,y=p.x-h.x,_=p.y-h.y,(g=y*y+_*_)&&(g=i*a[r]*((g=Math.sqrt(g))-o[r])/g,y*=g,_*=g,
p.x-=y*(m=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=_*m,h.x+=y*(m=1-m),h.y+=_*m);if((m=i*v)&&(y=c[0]/2,_=c[1]/2,r=-1,m))for(;++r<w;)l=b[r],l.x+=(y-l.x)*m,l.y+=(_-l.y)*m;if(f)for(ri(e=la.geom.quadtree(b),i,s),r=-1;++r<w;)(l=b[r]).fixed||e.visit(t(l));for(r=-1;++r<w;)l=b[r],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*d,l.y-=(l.py-(l.py=l.y))*d);u.tick({type:"tick",alpha:i})},l.nodes=function(t){return arguments.length?(b=t,l):b},l.links=function(t){return arguments.length?(x=t,l):x},l.size=function(t){return arguments.length?(c=t,l):c},l.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,l):h},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(p="function"==typeof t?t:+t,l):p},l.friction=function(t){return arguments.length?(d=+t,l):d},l.charge=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.chargeDistance=function(t){return arguments.length?(g=t*t,l):Math.sqrt(g)},l.gravity=function(t){return arguments.length?(v=+t,l):v},l.theta=function(t){return arguments.length?(m=t*t,l):Math.sqrt(m)},l.alpha=function(t){return arguments.length?(t=+t,i?t>0?i=t:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:i=0})):t>0&&(u.start({type:"start",alpha:i=t}),n=Pt(l.tick)),l):i},l.start=function(){function t(t,r){if(!n){for(n=new Array(i),l=0;l<i;++l)n[l]=[];for(l=0;l<u;++l){var o=x[l];n[o.source.index].push(o.target),n[o.target.index].push(o.source)}}for(var a,s=n[e],l=-1,c=s.length;++l<c;)if(!isNaN(a=s[l][t]))return a;return Math.random()*r}var e,n,r,i=b.length,u=x.length,d=c[0],g=c[1];for(e=0;e<i;++e)(r=b[e]).index=e,r.weight=0;for(e=0;e<u;++e)r=x[e],"number"==typeof r.source&&(r.source=b[r.source]),"number"==typeof r.target&&(r.target=b[r.target]),++r.source.weight,++r.target.weight;for(e=0;e<i;++e)r=b[e],isNaN(r.x)&&(r.x=t("x",d)),isNaN(r.y)&&(r.y=t("y",g)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(o=[],"function"==typeof h)for(e=0;e<u;++e)o[e]=+h.call(this,x[e],e);else for(e=0;e<u;++e)o[e]=h;if(a=[],"function"==typeof p)for(e=0;e<u;++e)a[e]=+p.call(this,x[e],e);else for(e=0;e<u;++e)a[e]=p;if(s=[],"function"==typeof f)for(e=0;e<i;++e)s[e]=+f.call(this,b[e],e);else for(e=0;e<i;++e)s[e]=f;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return r||(r=la.behavior.drag().origin(y).on("dragstart.force",Jr).on("drag.force",e).on("dragend.force",ti)),arguments.length?void this.on("mouseover.force",ei).on("mouseout.force",ni).call(r):r},la.rebind(l,u,"on")};var vl=20,ml=1,yl=1/0;la.layout.hierarchy=function(){function t(i){var o,a=[i],s=[];for(i.depth=0;null!=(o=a.pop());)if(s.push(o),(u=n.call(t,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=o,c.depth=o.depth+1;r&&(o.value=0),o.children=u}else r&&(o.value=+r.call(t,o,o.depth)||0),delete o.children;return ai(i,function(t){var n,i;e&&(n=t.children)&&n.sort(e),r&&(i=t.parent)&&(i.value+=t.value)}),s}var e=ui,n=si,r=li;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(r=e,t):r},t.revalue=function(e){return r&&(oi(e,function(t){t.children&&(t.value=0)}),ai(e,function(e){var n;e.children||(e.value=+r.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},la.layout.partition=function(){function t(e,n,r,i){var o=e.children;if(e.x=n,e.y=e.depth*i,e.dx=r,e.dy=i,o&&(a=o.length)){var a,s,l,u=-1;for(r=e.value?r/e.value:0;++u<a;)t(s=o[u],n,l=s.value*r,i),n+=l}}function e(t){var n=t.children,r=0;if(n&&(i=n.length))for(var i,o=-1;++o<i;)r=Math.max(r,e(n[o]));return 1+r}function n(n,o){var a=r.call(this,n,o);return t(a[0],0,i[0],i[1]/e(a[0])),a}var r=la.layout.hierarchy(),i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},ii(n,r)},la.layout.pie=function(){function t(a){var s,l=a.length,u=a.map(function(n,r){return+e.call(t,n,r)}),c=+("function"==typeof r?r.apply(this,arguments):r),d=("function"==typeof i?i.apply(this,arguments):i)-c,h=Math.min(Math.abs(d)/l,+("function"==typeof o?o.apply(this,arguments):o)),p=h*(d<0?-1:1),f=la.sum(u),g=f?(d-l*p)/f:0,v=la.range(l),m=[];return null!=n&&v.sort(n===bl?function(t,e){return u[e]-u[t]}:function(t,e){return n(a[t],a[e])}),v.forEach(function(t){m[t]={data:a[t],value:s=u[t],startAngle:c,endAngle:c+=s*g+p,padAngle:h}}),m}var e=Number,n=bl,r=0,i=Wa,o=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(r=e,t):r},t.endAngle=function(e){return arguments.length?(i=e,t):i},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var bl={};la.layout.stack=function(){function t(s,l){if(!(h=s.length))return s;var u=s.map(function(n,r){return e.call(t,n,r)}),c=u.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),a.call(t,e,n)]})}),d=n.call(t,c,l);u=la.permute(u,d),c=la.permute(c,d);var h,p,f,g,v=r.call(t,c,l),m=u[0].length;for(f=0;f<m;++f)for(i.call(t,u[0][f],g=v[f],c[0][f][1]),p=1;p<h;++p)i.call(t,u[p][f],g+=c[p-1][f][1],c[p][f][1]);return s}var e=y,n=fi,r=gi,i=pi,o=di,a=hi;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:xl.get(e)||fi,t):n},t.offset=function(e){return arguments.length?(r="function"==typeof e?e:_l.get(e)||gi,t):r},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(i=e,t):i},t};var xl=la.map({"inside-out":function(t){var e,n,r=t.length,i=t.map(vi),o=t.map(mi),a=la.range(r).sort(function(t,e){return i[t]-i[e]}),s=0,l=0,u=[],c=[];for(e=0;e<r;++e)n=a[e],s<l?(s+=o[n],u.push(n)):(l+=o[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return la.range(t.length).reverse()},default:fi}),_l=la.map({silhouette:function(t){var e,n,r,i=t.length,o=t[0].length,a=[],s=0,l=[];for(n=0;n<o;++n){for(e=0,r=0;e<i;e++)r+=t[e][n][1];r>s&&(s=r),a.push(r)}for(n=0;n<o;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,r,i,o,a,s,l,u,c=t.length,d=t[0],h=d.length,p=[];for(p[0]=l=u=0,n=1;n<h;++n){for(e=0,i=0;e<c;++e)i+=t[e][n][1];for(e=0,o=0,s=d[n][0]-d[n-1][0];e<c;++e){for(r=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);r<e;++r)a+=(t[r][n][1]-t[r][n-1][1])/s;o+=a*t[e][n][1]}p[n]=l-=i?o/i*s:0,l<u&&(u=l)}for(n=0;n<h;++n)p[n]-=u;return p},expand:function(t){var e,n,r,i=t.length,o=t[0].length,a=1/i,s=[];for(n=0;n<o;++n){for(e=0,r=0;e<i;e++)r+=t[e][n][1];if(r)for(e=0;e<i;e++)t[e][n][1]/=r;else for(e=0;e<i;e++)t[e][n][1]=a}for(n=0;n<o;++n)s[n]=0;return s},zero:gi});la.layout.histogram=function(){function t(t,o){for(var a,s,l=[],u=t.map(n,this),c=r.call(this,u,o),d=i.call(this,c,u,o),o=-1,h=u.length,p=d.length-1,f=e?1:1/h;++o<p;)a=l[o]=[],a.dx=d[o+1]-(a.x=d[o]),a.y=0;if(p>0)for(o=-1;++o<h;)s=u[o],s>=c[0]&&s<=c[1]&&(a=l[la.bisect(d,s,1,p)-1],a.y+=f,a.push(t[o]));return l}var e=!0,n=Number,r=_i,i=bi;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(r=St(e),t):r},t.bins=function(e){return arguments.length?(i="number"==typeof e?function(t){return xi(t,e)}:St(e),t):i},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},la.layout.pack=function(){function t(t,o){var a=n.call(this,t,o),s=a[0],l=i[0],u=i[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,ai(s,function(t){t.r=+c(t.value)}),ai(s,Si),r){var d=r*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;ai(s,function(t){t.r+=d}),ai(s,Si),ai(s,function(t){t.r-=d})}return Ei(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),a}var e,n=la.layout.hierarchy().sort(wi),r=0,i=[1,1];return t.size=function(e){return arguments.length?(i=e,t):i},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(r=+e,t):r},ii(t,n)},la.layout.tree=function(){function t(t,i){var c=a.call(this,t,i),d=c[0],h=e(d);if(ai(h,n),h.parent.m=-h.z,oi(h,r),u)oi(d,o);else{var p=d,f=d,g=d;oi(d,function(t){t.x<p.x&&(p=t),t.x>f.x&&(f=t),t.depth>g.depth&&(g=t)});var v=s(p,f)/2-p.x,m=l[0]/(f.x+s(f,p)/2+v),y=l[1]/(g.depth||1);oi(d,function(t){t.x=(t.x+v)*m,t.y=t.depth*y})}return c}function e(t){for(var e,n={A:null,children:[t]},r=[n];null!=(e=r.pop());)for(var i,o=e.children,a=0,s=o.length;a<s;++a)r.push((o[a]=i={_:o[a],parent:e,children:(i=o[a].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=i);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e.length){Ii(t);var o=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+s(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+s(t._,r._));t.parent.A=i(t,r,t.parent.A||n[0])}function r(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function i(t,e,n){if(e){for(var r,i=t,o=t,a=e,l=i.parent.children[0],u=i.m,c=o.m,d=a.m,h=l.m;a=Oi(a),i=Di(i),a&&i;)l=Di(l),o=Oi(o),o.a=t,r=a.z+d-i.z-u+s(a._,i._),r>0&&(Ni(zi(a,t,n),t,r),u+=r,c+=r),d+=a.m,u+=i.m,h+=l.m,c+=o.m;a&&!Oi(o)&&(o.t=a,o.m+=d-c),i&&!Di(l)&&(l.t=i,l.m+=u-h,n=t)}return n}function o(t){t.x*=l[0],t.y=t.depth*l[1]}var a=la.layout.hierarchy().sort(null).value(null),s=Pi,l=[1,1],u=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(u=null==(l=e)?o:null,t):u?null:l},t.nodeSize=function(e){return arguments.length?(u=null==(l=e)?null:o,t):u?l:null},ii(t,a)},la.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),l=s[0],u=0;ai(l,function(t){var e=t.children;e&&e.length?(t.x=Wi(e),t.y=Gi(e)):(t.x=a?u+=n(t,a):0,t.y=0,a=t)});var c=Fi(l),d=Ri(l),h=c.x-n(c,d)/2,p=d.x+n(d,c)/2;return ai(l,i?function(t){t.x=(t.x-l.x)*r[0],t.y=(l.y-t.y)*r[1]}:function(t){t.x=(t.x-h)/(p-h)*r[0],t.y=(1-(l.y?t.y/l.y:1))*r[1]}),s}var e=la.layout.hierarchy().sort(null).value(null),n=Pi,r=[1,1],i=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=null==(r=e),t):i?null:r},t.nodeSize=function(e){return arguments.length?(i=null!=(r=e),t):i?r:null},ii(t,e)},la.layout.treemap=function(){function t(t,e){for(var n,r,i=-1,o=t.length;++i<o;)r=(n=t[i]).value*(e<0?0:e),n.area=isNaN(r)||r<=0?0:r}function e(n){var o=n.children;if(o&&o.length){var a,s,l,u=d(n),c=[],h=o.slice(),f=1/0,g="slice"===p?u.dx:"dice"===p?u.dy:"slice-dice"===p?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(h,u.dx*u.dy/n.value),c.area=0;(l=h.length)>0;)c.push(a=h[l-1]),c.area+=a.area,"squarify"!==p||(s=r(c,g))<=f?(h.pop(),f=s):(c.area-=c.pop().area,i(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,f=1/0);c.length&&(i(c,g,u,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var r=e.children;if(r&&r.length){var o,a=d(e),s=r.slice(),l=[];for(t(s,a.dx*a.dy/e.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(i(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);r.forEach(n)}}function r(t,e){for(var n,r=t.area,i=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(n<o&&(o=n),n>i&&(i=n));return r*=r,e*=e,r?Math.max(e*i*f/r,r/(e*o*f)):1/0}function i(t,e,n,r){var i,o=-1,a=t.length,s=n.x,u=n.y,c=e?l(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++o<a;)i=t[o],i.x=s,i.y=u,i.dy=c,s+=i.dx=Math.min(n.x+n.dx-s,c?l(i.area/c):0);i.z=!0,i.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++o<a;)i=t[o],i.x=s,i.y=u,i.dx=c,u+=i.dy=Math.min(n.y+n.dy-u,c?l(i.area/c):0);i.z=!1,i.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function o(r){var i=a||s(r),o=i[0];return o.x=o.y=0,o.value?(o.dx=u[0],o.dy=u[1]):o.dx=o.dy=0,a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?n:e)(o),h&&(a=i),i}var a,s=la.layout.hierarchy(),l=Math.round,u=[1,1],c=null,d=Bi,h=!1,p="squarify",f=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(u=t,o):u},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Bi(e):Hi(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Hi(e,t)}if(!arguments.length)return c;var r;return d=null==(c=t)?Bi:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(l=t?Math.round:Number,o):l!=Number},o.sticky=function(t){return arguments.length?(h=t,a=null,o):h},o.ratio=function(t){return arguments.length?(f=t,o):f},o.mode=function(t){return arguments.length?(p=t+"",o):p},ii(o,s)},la.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,r,i;do n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r;while(!i||i>1);return t+e*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=la.random.normal.apply(la,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=la.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},la.scale={};var wl={floor:y,ceil:y};la.scale.linear=function(){return Yi([0,1],[0,1],br,!1)};var kl={s:1,g:1,p:1,r:1,e:1};la.scale.log=function(){return ro(la.scale.linear().domain([0,1]),10,!0,[1,10])};var Ml=la.format(".0e"),Cl={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};la.scale.pow=function(){return io(la.scale.linear(),1,[0,1])},la.scale.sqrt=function(){return la.scale.pow().exponent(.5)},la.scale.ordinal=function(){return ao([],{t:"range",a:[[]]})},la.scale.category10=function(){return la.scale.ordinal().range(Sl)},la.scale.category20=function(){return la.scale.ordinal().range(Ll)},la.scale.category20b=function(){return la.scale.ordinal().range(Al)},la.scale.category20c=function(){return la.scale.ordinal().range(El)};var Sl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(bt),Ll=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(bt),Al=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(bt),El=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(bt);la.scale.quantile=function(){return so([],[])},la.scale.quantize=function(){return lo(0,1,[0,1])},la.scale.threshold=function(){return uo([.5],[0,1])},la.scale.identity=function(){return co([0,1])},la.svg={},la.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+r.apply(this,arguments)),c=a.apply(this,arguments)-Ra,d=s.apply(this,arguments)-Ra,h=Math.abs(d-c),p=c>d?0:1;if(u<t&&(f=u,u=t,t=f),h>=Fa)return e(u,p)+(t?e(t,1-p):"")+"Z";var f,g,v,m,y,b,x,_,w,k,M,C,S=0,L=0,A=[];if((m=(+l.apply(this,arguments)||0)/2)&&(v=o===Tl?Math.sqrt(t*t+u*u):+o.apply(this,arguments),p||(L*=-1),u&&(L=et(v/u*Math.sin(m))),t&&(S=et(v/t*Math.sin(m)))),u){y=u*Math.cos(c+L),b=u*Math.sin(c+L),x=u*Math.cos(d-L),_=u*Math.sin(d-L);var E=Math.abs(d-c-2*L)<=Ga?0:1;if(L&&yo(y,b,x,_)===p^E){var T=(c+d)/2;y=u*Math.cos(T),b=u*Math.sin(T),x=_=null}}else y=b=0;if(t){w=t*Math.cos(d-S),k=t*Math.sin(d-S),M=t*Math.cos(c+S),C=t*Math.sin(c+S);var P=Math.abs(c-d+2*S)<=Ga?0:1;if(S&&yo(w,k,M,C)===1-p^P){var D=(c+d)/2;w=t*Math.cos(D),k=t*Math.sin(D),M=C=null}}else w=k=0;if(h>Ia&&(f=Math.min(Math.abs(u-t)/2,+i.apply(this,arguments)))>.001){g=t<u^p?0:1;var O=f,N=f;if(h<Ga){var I=null==M?[w,k]:null==x?[y,b]:Nn([y,b],[M,C],[x,_],[w,k]),z=y-I[0],G=b-I[1],W=x-I[0],F=_-I[1],R=1/Math.sin(Math.acos((z*W+G*F)/(Math.sqrt(z*z+G*G)*Math.sqrt(W*W+F*F)))/2),B=Math.sqrt(I[0]*I[0]+I[1]*I[1]);N=Math.min(f,(t-B)/(R-1)),O=Math.min(f,(u-B)/(R+1))}if(null!=x){var H=bo(null==M?[w,k]:[M,C],[y,b],u,O,p),j=bo([x,_],[w,k],u,O,p);f===O?A.push("M",H[0],"A",O,",",O," 0 0,",g," ",H[1],"A",u,",",u," 0 ",1-p^yo(H[1][0],H[1][1],j[1][0],j[1][1]),",",p," ",j[1],"A",O,",",O," 0 0,",g," ",j[0]):A.push("M",H[0],"A",O,",",O," 0 1,",g," ",j[0])}else A.push("M",y,",",b);if(null!=M){var V=bo([y,b],[M,C],t,-N,p),$=bo([w,k],null==x?[y,b]:[x,_],t,-N,p);f===N?A.push("L",$[0],"A",N,",",N," 0 0,",g," ",$[1],"A",t,",",t," 0 ",p^yo($[1][0],$[1][1],V[1][0],V[1][1]),",",1-p," ",V[1],"A",N,",",N," 0 0,",g," ",V[0]):A.push("L",$[0],"A",N,",",N," 0 0,",g," ",V[0])}else A.push("L",w,",",k)}else A.push("M",y,",",b),null!=x&&A.push("A",u,",",u," 0 ",E,",",p," ",x,",",_),A.push("L",w,",",k),null!=M&&A.push("A",t,",",t," 0 ",P,",",1-p," ",M,",",C);return A.push("Z"),A.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=po,r=fo,i=ho,o=Tl,a=go,s=vo,l=mo;return t.innerRadius=function(e){return arguments.length?(n=St(e),t):n},t.outerRadius=function(e){return arguments.length?(r=St(e),t):r},t.cornerRadius=function(e){return arguments.length?(i=St(e),t):i},t.padRadius=function(e){return arguments.length?(o=e==Tl?Tl:St(e),t):o},t.startAngle=function(e){return arguments.length?(a=St(e),t):a},t.endAngle=function(e){return arguments.length?(s=St(e),t):s},t.padAngle=function(e){return arguments.length?(l=St(e),t):l},t.centroid=function(){var t=(+n.apply(this,arguments)+ +r.apply(this,arguments))/2,e=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Ra;return[Math.cos(e)*t,Math.sin(e)*t]},t};var Tl="auto";la.svg.line=function(){return xo(y)};var Pl=la.map({linear:_o,"linear-closed":wo,step:ko,"step-before":Mo,"step-after":Co,basis:Po,"basis-open":Do,"basis-closed":Oo,bundle:No,cardinal:Ao,"cardinal-open":So,"cardinal-closed":Lo,monotone:Ro});Pl.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Dl=[0,2/3,1/3,0],Ol=[0,1/3,2/3,0],Nl=[0,1/6,2/3,1/6];la.svg.line.radial=function(){var t=xo(Bo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Mo.reverse=Co,Co.reverse=Mo,la.svg.area=function(){return Ho(y)},la.svg.area.radial=function(){var t=Ho(Bo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},la.svg.chord=function(){function t(t,s){var l=e(this,o,t,s),u=e(this,a,t,s);return"M"+l.p0+r(l.r,l.p1,l.a1-l.a0)+(n(l,u)?i(l.r,l.p1,l.r,l.p0):i(l.r,l.p1,u.r,u.p0)+r(u.r,u.p1,u.a1-u.a0)+i(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,n,r){var i=e.call(t,n,r),o=s.call(t,i,r),a=l.call(t,i,r)-Ra,c=u.call(t,i,r)-Ra;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function r(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Ga)+",1 "+e}function i(t,e,n,r){return"Q 0,0 "+r}var o=bn,a=xn,s=jo,l=go,u=vo;return t.radius=function(e){return arguments.length?(s=St(e),t):s},t.source=function(e){return arguments.length?(o=St(e),t):o},t.target=function(e){return arguments.length?(a=St(e),t):a},t.startAngle=function(e){return arguments.length?(l=St(e),t):l},t.endAngle=function(e){return arguments.length?(u=St(e),t):u},t},la.svg.diagonal=function(){function t(t,i){var o=e.call(this,t,i),a=n.call(this,t,i),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(r),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=bn,n=xn,r=Vo;return t.source=function(n){return arguments.length?(e=St(n),t):e},t.target=function(e){return arguments.length?(n=St(e),t):n},t.projection=function(e){return arguments.length?(r=e,t):r},t},la.svg.diagonal.radial=function(){var t=la.svg.diagonal(),e=Vo,n=t.projection;return t.projection=function(t){return arguments.length?n($o(e=t)):e},t},la.svg.symbol=function(){function t(t,r){return(Il.get(e.call(this,t,r))||Xo)(n.call(this,t,r))}var e=Uo,n=qo;return t.type=function(n){return arguments.length?(e=St(n),t):e},t.size=function(e){return arguments.length?(n=St(e),t):n},t};var Il=la.map({circle:Xo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Gl)),n=e*Gl;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/zl),n=e*zl/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/zl),n=e*zl/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});la.svg.symbolTypes=Il.keys();var zl=Math.sqrt(3),Gl=Math.tan(30*Ba);La.transition=function(t){for(var e,n,r=Wl||++Hl,i=Jo(t),o=[],a=Fl||{time:Date.now(),ease:Sr,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(e=[]);for(var u=this[s],c=-1,d=u.length;++c<d;)(n=u[c])&&ta(n,c,i,r,a),e.push(n)}return Ko(o,i,r)},La.interrupt=function(t){return this.each(null==t?Rl:Yo(Jo(t)))};var Wl,Fl,Rl=Yo(Jo()),Bl=[],Hl=0;Bl.call=La.call,Bl.empty=La.empty,Bl.node=La.node,Bl.size=La.size,la.transition=function(t,e){return t&&t.transition?Wl?t.transition(e):t:la.selection().transition(t)},la.transition.prototype=Bl,Bl.select=function(t){var e,n,r,i=this.id,o=this.namespace,a=[];t=A(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,d=u.length;++c<d;)(r=u[c])&&(n=t.call(r,r.__data__,c,s))?("__data__"in r&&(n.__data__=r.__data__),ta(n,c,o,i,r[o][i]),e.push(n)):e.push(null)}return Ko(a,o,i)},Bl.selectAll=function(t){var e,n,r,i,o,a=this.id,s=this.namespace,l=[];t=E(t);for(var u=-1,c=this.length;++u<c;)for(var d=this[u],h=-1,p=d.length;++h<p;)if(r=d[h]){o=r[s][a],n=t.call(r,r.__data__,h,u),l.push(e=[]);for(var f=-1,g=n.length;++f<g;)(i=n[f])&&ta(i,f,s,a,o),e.push(i)}return Ko(l,s,a)},Bl.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;o<a;o++){i.push(e=[]);for(var n=this[o],s=0,l=n.length;s<l;s++)(r=n[s])&&t.call(r,r.__data__,s,o)&&e.push(r)}return Ko(i,this.namespace,this.id)},Bl.tween=function(t,e){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(t):j(this,null==e?function(e){e[r][n].tween.remove(t)}:function(i){i[r][n].tween.set(t,e)})},Bl.attr=function(t,e){function n(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}function i(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(s);return n!==t&&(e=a(n,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?r:(t+="",function(){var e,n=this.getAttributeNS(s.space,s.local);return n!==t&&(e=a(n,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a="transform"==t?Ur:br,s=la.ns.qualify(t);return Zo(this,"attr."+t,e,s.local?o:i)},Bl.attrTween=function(t,e){function n(t,n){var r=e.call(this,t,n,this.getAttribute(i));return r&&function(t){this.setAttribute(i,r(t))}}function r(t,n){var r=e.call(this,t,n,this.getAttributeNS(i.space,i.local));return r&&function(t){this.setAttributeNS(i.space,i.local,r(t))}}var i=la.ns.qualify(t);return this.tween("attr."+t,i.local?r:n)},Bl.style=function(t,n,r){function i(){this.style.removeProperty(t)}function o(n){return null==n?i:(n+="",function(){var i,o=e(this).getComputedStyle(this,null).getPropertyValue(t);return o!==n&&(i=br(o,n),function(e){this.style.setProperty(t,i(e),r)})})}var a=arguments.length;if(a<3){if("string"!=typeof t){a<2&&(n="");for(r in t)this.style(r,t[r],n);return this}r=""}return Zo(this,"style."+t,n,o)},Bl.styleTween=function(t,n,r){function i(i,o){var a=n.call(this,i,o,e(this).getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),r)}}return arguments.length<3&&(r=""),this.tween("style."+t,i)},Bl.text=function(t){return Zo(this,"text",t,Qo)},Bl.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Bl.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=la.ease.apply(la,arguments)),j(this,function(r){r[n][e].ease=t}))},Bl.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:j(this,"function"==typeof t?function(r,i,o){r[n][e].delay=+t.call(r,r.__data__,i,o)}:(t=+t,function(r){r[n][e].delay=t}))},Bl.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:j(this,"function"==typeof t?function(r,i,o){r[n][e].duration=Math.max(1,t.call(r,r.__data__,i,o))}:(t=Math.max(1,t),function(r){r[n][e].duration=t}))},Bl.each=function(t,e){var n=this.id,r=this.namespace;if(arguments.length<2){var i=Fl,o=Wl;try{Wl=n,j(this,function(e,i,o){Fl=e[r][n],t.call(e,e.__data__,i,o)})}finally{Fl=i,Wl=o}}else j(this,function(i){var o=i[r][n];(o.event||(o.event=la.dispatch("start","end","interrupt"))).on(t,e)});return this},Bl.transition=function(){for(var t,e,n,r,i=this.id,o=++Hl,a=this.namespace,s=[],l=0,u=this.length;l<u;l++){s.push(t=[]);for(var e=this[l],c=0,d=e.length;c<d;c++)(n=e[c])&&(r=n[a][i],ta(n,c,a,o,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),t.push(n)}return Ko(s,a,o)},la.svg.axis=function(){function t(t){t.each(function(){var t,u=la.select(this),c=this.__chart__||n,d=this.__chart__=n.copy(),h=null==l?d.ticks?d.ticks.apply(d,s):d.domain():l,p=null==e?d.tickFormat?d.tickFormat.apply(d,s):y:e,f=u.selectAll(".tick").data(h,d),g=f.enter().insert("g",".domain").attr("class","tick").style("opacity",Ia),v=la.transition(f.exit()).style("opacity",Ia).remove(),m=la.transition(f.order()).style("opacity",1),b=Math.max(i,0)+a,x=Vi(d),_=u.selectAll(".domain").data([0]),w=(_.enter().append("path").attr("class","domain"),la.transition(_));g.append("line"),g.append("text");var k,M,C,S,L=g.select("line"),A=m.select("line"),E=f.select("text").text(p),T=g.select("text"),P=m.select("text"),D="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(t=ea,k="x",C="y",M="x2",S="y2",E.attr("dy",D<0?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+x[0]+","+D*o+"V0H"+x[1]+"V"+D*o)):(t=na,k="y",C="x",M="y2",S="x2",E.attr("dy",".32em").style("text-anchor",D<0?"end":"start"),w.attr("d","M"+D*o+","+x[0]+"H0V"+x[1]+"H"+D*o)),L.attr(S,D*i),T.attr(C,D*b),A.attr(M,0).attr(S,D*i),P.attr(k,0).attr(C,D*b),d.rangeBand){var O=d,N=O.rangeBand()/2;c=d=function(t){return O(t)+N}}else c.rangeBand?c=d:v.call(t,d,c);g.call(t,c,d),m.call(t,d,d)})}var e,n=la.scale.linear(),r=jl,i=6,o=6,a=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(r=e in Vl?e+"":jl,t):r},t.ticks=function(){return arguments.length?(s=ca(arguments),t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(i=+e,o=+arguments[n-1],t):i},t.innerTickSize=function(e){return arguments.length?(i=+e,t):i},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var jl="bottom",Vl={top:1,right:1,bottom:1,left:1};la.svg.brush=function(){function t(e){e.each(function(){var e=la.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),a=e.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=e.selectAll(".resize").data(g,y);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return $l[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var l,d=la.transition(e),h=la.transition(a);u&&(l=Vi(u),h.attr("x",l[0]).attr("width",l[1]-l[0]),r(d)),c&&(l=Vi(c),h.attr("y",l[0]).attr("height",l[1]-l[0]),i(d)),n(d)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+d[+/e$/.test(t)]+","+h[+/^s/.test(t)]+")"})}function r(t){t.select(".extent").attr("x",d[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",d[1]-d[0])}function i(t){t.select(".extent").attr("y",h[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function o(){function o(){32==la.event.keyCode&&(E||(b=null,P[0]-=d[1],P[1]-=h[1],E=2),M())}function g(){32==la.event.keyCode&&2==E&&(P[0]+=d[1],P[1]+=h[1],E=0,M())}function v(){var t=la.mouse(_),e=!1;x&&(t[0]+=x[0],t[1]+=x[1]),E||(la.event.altKey?(b||(b=[(d[0]+d[1])/2,(h[0]+h[1])/2]),P[0]=d[+(t[0]<b[0])],P[1]=h[+(t[1]<b[1])]):b=null),L&&m(t,u,0)&&(r(C),e=!0),A&&m(t,c,1)&&(i(C),e=!0),e&&(n(C),k({type:"brush",mode:E?"move":"resize"}))}function m(t,e,n){var r,i,o=Vi(e),l=o[0],u=o[1],c=P[n],g=n?h:d,v=g[1]-g[0];if(E&&(l-=c,u-=v+c),r=(n?f:p)?Math.max(l,Math.min(u,t[n])):t[n],E?i=(r+=c)+v:(b&&(c=Math.max(l,Math.min(u,2*b[n]-r))),c<r?(i=r,r=c):i=c),g[0]!=r||g[1]!=i)return n?s=null:a=null,g[0]=r,g[1]=i,!0}function y(){v(),C.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),la.select("body").style("cursor",null),D.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),T(),k({type:"brushend"})}var b,x,_=this,w=la.select(la.event.target),k=l.of(_,arguments),C=la.select(_),S=w.datum(),L=!/^(n|s)$/.test(S)&&u,A=!/^(e|w)$/.test(S)&&c,E=w.classed("extent"),T=Y(_),P=la.mouse(_),D=la.select(e(_)).on("keydown.brush",o).on("keyup.brush",g);if(la.event.changedTouches?D.on("touchmove.brush",v).on("touchend.brush",y):D.on("mousemove.brush",v).on("mouseup.brush",y),C.interrupt().selectAll("*").interrupt(),E)P[0]=d[0]-P[0],P[1]=h[0]-P[1];else if(S){var O=+/w$/.test(S),N=+/^n/.test(S);x=[d[1-O]-P[0],h[1-N]-P[1]],P[0]=d[O],P[1]=h[N]}else la.event.altKey&&(b=P.slice());C.style("pointer-events","none").selectAll(".resize").style("display",null),la.select("body").style("cursor",w.style("cursor")),k({type:"brushstart"}),v()}var a,s,l=S(t,"brushstart","brush","brushend"),u=null,c=null,d=[0,0],h=[0,0],p=!0,f=!0,g=ql[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:d,y:h,i:a,j:s},n=this.__chart__||e;this.__chart__=e,Wl?la.select(this).transition().each("start.brush",function(){a=n.i,s=n.j,d=n.x,h=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=xr(d,e.x),r=xr(h,e.y);return a=s=null,function(i){d=e.x=n(i),h=e.y=r(i),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,g=ql[!u<<1|!c],t):u},t.y=function(e){return arguments.length?(c=e,g=ql[!u<<1|!c],t):c},t.clamp=function(e){return arguments.length?(u&&c?(p=!!e[0],f=!!e[1]):u?p=!!e:c&&(f=!!e),t):u&&c?[p,f]:u?p:c?f:null},t.extent=function(e){var n,r,i,o,l;return arguments.length?(u&&(n=e[0],r=e[1],c&&(n=n[0],r=r[0]),a=[n,r],u.invert&&(n=u(n),r=u(r)),r<n&&(l=n,n=r,r=l),n==d[0]&&r==d[1]||(d=[n,r])),c&&(i=e[0],o=e[1],u&&(i=i[1],o=o[1]),s=[i,o],c.invert&&(i=c(i),o=c(o)),o<i&&(l=i,i=o,o=l),i==h[0]&&o==h[1]||(h=[i,o])),t):(u&&(a?(n=a[0],r=a[1]):(n=d[0],r=d[1],u.invert&&(n=u.invert(n),r=u.invert(r)),r<n&&(l=n,n=r,r=l))),c&&(s?(i=s[0],o=s[1]):(i=h[0],o=h[1],c.invert&&(i=c.invert(i),o=c.invert(o)),o<i&&(l=i,i=o,o=l))),u&&c?[[n,i],[r,o]]:u?[n,r]:c&&[i,o])},t.clear=function(){return t.empty()||(d=[0,0],h=[0,0],a=s=null),t},t.empty=function(){return!!u&&d[0]==d[1]||!!c&&h[0]==h[1]},la.rebind(t,l,"on")};var $l={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ql=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ul=hs.format=ys.timeFormat,Xl=Ul.utc,Yl=Xl("%Y-%m-%dT%H:%M:%S.%LZ");Ul.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?ra:Yl,
ra.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},ra.toString=Yl.toString,hs.second=Rt(function(t){return new ps(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),hs.seconds=hs.second.range,hs.seconds.utc=hs.second.utc.range,hs.minute=Rt(function(t){return new ps(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),hs.minutes=hs.minute.range,hs.minutes.utc=hs.minute.utc.range,hs.hour=Rt(function(t){var e=t.getTimezoneOffset()/60;return new ps(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),hs.hours=hs.hour.range,hs.hours.utc=hs.hour.utc.range,hs.month=Rt(function(t){return t=hs.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),hs.months=hs.month.range,hs.months.utc=hs.month.utc.range;var Kl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Zl=[[hs.second,1],[hs.second,5],[hs.second,15],[hs.second,30],[hs.minute,1],[hs.minute,5],[hs.minute,15],[hs.minute,30],[hs.hour,1],[hs.hour,3],[hs.hour,6],[hs.hour,12],[hs.day,1],[hs.day,2],[hs.week,1],[hs.month,1],[hs.month,3],[hs.year,1]],Ql=Ul.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ee]]),Jl={range:function(t,e,n){return la.range(Math.ceil(t/n)*n,+e,n).map(oa)},floor:y,ceil:y};Zl.year=hs.year,hs.scale=function(){return ia(la.scale.linear(),Zl,Ql)};var tu=Zl.map(function(t){return[t[0].utc,t[1]]}),eu=Xl.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ee]]);tu.year=hs.year.utc,hs.scale.utc=function(){return ia(la.scale.linear(),tu,eu)},la.text=Lt(function(t){return t.responseText}),la.json=function(t,e){return At(t,"application/json",aa,e)},la.html=function(t,e){return At(t,"text/html",sa,e)},la.xml=Lt(function(t){return t.responseXML}),"function"==typeof define&&define.amd?(this.d3=la,define(la)):"object"==typeof module&&module.exports?module.exports=la:this.d3=la}(),function(){var t={};t.dev=!1,t.tooltip=t.tooltip||{},t.utils=t.utils||{},t.models=t.models||{},t.charts={},t.logs={},t.dom={},"undefined"!=typeof module&&"undefined"!=typeof exports&&"undefined"==typeof d3&&(d3=require("d3")),t.dispatch=d3.dispatch("render_start","render_end"),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),t.dev&&(t.dispatch.on("render_start",function(e){t.logs.startTime=+new Date}),t.dispatch.on("render_end",function(e){t.logs.endTime=+new Date,t.logs.totalTime=t.logs.endTime-t.logs.startTime,t.log("total",t.logs.totalTime)})),t.log=function(){if(t.dev&&window.console&&console.log&&console.log.apply)console.log.apply(console,arguments);else if(t.dev&&window.console&&"function"==typeof console.log&&Function.prototype.bind){var e=Function.prototype.bind.call(console.log,console);e.apply(console,arguments)}return arguments[arguments.length-1]},t.deprecated=function(t,e){console&&console.warn&&console.warn("nvd3 warning: `"+t+"` has been deprecated. ",e||"")},t.render=function(e){e=e||1,t.render.active=!0,t.dispatch.render_start();var n=function(){for(var r,i,o=0;o<e&&(i=t.render.queue[o]);o++)r=i.generate(),typeof i.callback==typeof Function&&i.callback(r);t.render.queue.splice(0,o),t.render.queue.length?setTimeout(n):(t.dispatch.render_end(),t.render.active=!1)};setTimeout(n)},t.render.active=!1,t.render.queue=[],t.addGraph=function(e){typeof arguments[0]==typeof Function&&(e={generate:arguments[0],callback:arguments[1]}),t.render.queue.push(e),t.render.active||t.render()},"undefined"!=typeof module&&"undefined"!=typeof exports&&(module.exports=t),"undefined"!=typeof window&&(window.nv=t),t.dom.write=function(t){return void 0!==window.fastdom?fastdom.mutate(t):t()},t.dom.read=function(t){return void 0!==window.fastdom?fastdom.measure(t):t()},t.interactiveGuideline=function(){"use strict";function e(d){d.each(function(d){function h(){var t=d3.mouse(this),r=t[0],i=t[1],s=!0,l=!1;if(c&&(r=d3.event.offsetX,i=d3.event.offsetY,"svg"!==d3.event.target.tagName&&(s=!1),d3.event.target.className.baseVal.match("nv-legend")&&(l=!0)),s&&(r-=n.left,i-=n.top),"mouseout"===d3.event.type||r<0||i<0||r>f||i>g||d3.event.relatedTarget&&void 0===d3.event.relatedTarget.ownerSVGElement||l){if(c&&d3.event.relatedTarget&&void 0===d3.event.relatedTarget.ownerSVGElement&&(void 0===d3.event.relatedTarget.className||d3.event.relatedTarget.className.match(u.nvPointerEventsClass)))return;return a.elementMouseout({mouseX:r,mouseY:i}),e.renderGuideLine(null),void u.hidden(!0)}u.hidden(!1);var d="function"==typeof o.rangeBands,h=void 0;if(d){var p=d3.bisect(o.range(),r)-1;if(!(o.range()[p]+o.rangeBand()>=r))return a.elementMouseout({mouseX:r,mouseY:i}),e.renderGuideLine(null),void u.hidden(!0);h=o.domain()[d3.bisect(o.range(),r)-1]}else h=o.invert(r);a.elementMousemove({mouseX:r,mouseY:i,pointXValue:h}),"dblclick"===d3.event.type&&a.elementDblclick({mouseX:r,mouseY:i,pointXValue:h}),"click"===d3.event.type&&a.elementClick({mouseX:r,mouseY:i,pointXValue:h}),"mousedown"===d3.event.type&&a.elementMouseDown({mouseX:r,mouseY:i,pointXValue:h}),"mouseup"===d3.event.type&&a.elementMouseUp({mouseX:r,mouseY:i,pointXValue:h})}var p=d3.select(this),f=r||960,g=i||400,v=p.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([d]),m=v.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");m.append("g").attr("class","nv-interactiveGuideLine"),l&&(l.on("touchmove",h).on("mousemove",h,!0).on("mouseout",h,!0).on("mousedown",h,!0).on("mouseup",h,!0).on("dblclick",h).on("click",h),e.guideLine=null,e.renderGuideLine=function(n){s&&(e.guideLine&&e.guideLine.attr("x1")===n||t.dom.write(function(){var e=v.select(".nv-interactiveGuideLine").selectAll("line").data(null!=n?[t.utils.NaNtoZero(n)]:[],String);e.enter().append("line").attr("class","nv-guideline").attr("x1",function(t){return t}).attr("x2",function(t){return t}).attr("y1",g).attr("y2",0),e.exit().remove()}))})})}var n={left:0,top:0},r=null,i=null,o=d3.scale.linear(),a=d3.dispatch("elementMousemove","elementMouseout","elementClick","elementDblclick","elementMouseDown","elementMouseUp"),s=!0,l=null,u=t.models.tooltip(),c=window.ActiveXObject;return u.duration(0).hideDelay(0).hidden(!1),e.dispatch=a,e.tooltip=u,e.margin=function(t){return arguments.length?(n.top="undefined"!=typeof t.top?t.top:n.top,n.left="undefined"!=typeof t.left?t.left:n.left,e):n},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.xScale=function(t){return arguments.length?(o=t,e):o},e.showGuideLine=function(t){return arguments.length?(s=t,e):s},e.svgContainer=function(t){return arguments.length?(l=t,e):l},e},t.interactiveBisect=function(t,e,n){"use strict";if(!(t instanceof Array))return null;var r;r="function"!=typeof n?function(t){return t.x}:n;var i=function(t,e){return r(t)-e},o=d3.bisector(i).left,a=d3.max([0,o(t,e)-1]),s=r(t[a]);if("undefined"==typeof s&&(s=a),s===e)return a;var l=d3.min([a+1,t.length-1]),u=r(t[l]);return"undefined"==typeof u&&(u=l),Math.abs(u-e)>=Math.abs(s-e)?a:l},t.nearestValueIndex=function(t,e,n){"use strict";var r=1/0,i=null;return t.forEach(function(t,o){var a=Math.abs(e-t);null!=t&&a<=r&&a<n&&(r=a,i=o)}),i},t.models.tooltip=function(){"use strict";function e(){if(!d||!d.node()){var t=[1];d=d3.select(document.body).select("#"+r).data(t),d.enter().append("div").attr("class","nvtooltip "+(l?l:"xy-tooltip")).attr("id",r).style("top",0).style("left",0).style("opacity",0).style("position","fixed").selectAll("div, table, td, tr").classed(v,!0).classed(v,!0),d.exit().remove()}}function n(){if(p&&w(i))return t.dom.write(function(){e();var t=x(i);t&&(d.node().innerHTML=t),M()}),n}var r="nvtooltip-"+Math.floor(1e5*Math.random()),i=null,o="w",a=25,s=0,l=null,u=!0,c=200,d=null,h={left:null,top:null},p=!0,f=100,g=!0,v="nv-pointer-events-none",m=function(t,e){return t},y=function(t){return t},b=function(t,e){return t},x=function(t){if(null===t)return"";var e=d3.select(document.createElement("table"));if(g){var n=e.selectAll("thead").data([t]).enter().append("thead");n.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",!0).html(y(t.value))}var r=e.selectAll("tbody").data([t]).enter().append("tbody"),i=r.selectAll("tr").data(function(t){return t.series}).enter().append("tr").classed("highlight",function(t){return t.highlight});i.append("td").classed("legend-color-guide",!0).append("div").style("background-color",function(t){return t.color}),i.append("td").classed("key",!0).classed("total",function(t){return!!t.total}).html(function(t,e){return b(t.key,e)}),i.append("td").classed("value",!0).html(function(t,e){return m(t.value,e)}),i.filter(function(t,e){return void 0!==t.percent}).append("td").classed("percent",!0).html(function(t,e){return"("+d3.format("%")(t.percent)+")"}),i.selectAll("td").each(function(t){if(t.highlight){var e=d3.scale.linear().domain([0,1]).range(["#fff",t.color]),n=.6;d3.select(this).style("border-bottom-color",e(n)).style("border-top-color",e(n))}});var o=e.node().outerHTML;return void 0!==t.footer&&(o+="<div class='footer'>"+t.footer+"</div>"),o},_=function(){var t={left:null!==d3.event?d3.event.clientX:0,top:null!==d3.event?d3.event.clientY:0};if("none"!=getComputedStyle(document.body).transform){var e=document.body.getBoundingClientRect();t.left-=e.left,t.top-=e.top}return t},w=function(e){if(e&&e.series){if(t.utils.isArray(e.series))return!0;if(t.utils.isObject(e.series))return e.series=[e.series],!0}return!1},k=function(t){var e,n,r,i=d.node().offsetHeight,s=d.node().offsetWidth,l=document.documentElement.clientWidth,u=document.documentElement.clientHeight;switch(o){case"e":e=-s-a,n=-(i/2),t.left+e<0&&(e=a),(r=t.top+n)<0&&(n-=r),(r=t.top+n+i)>u&&(n-=r-u);break;case"w":e=a,n=-(i/2),t.left+e+s>l&&(e=-s-a),(r=t.top+n)<0&&(n-=r),(r=t.top+n+i)>u&&(n-=r-u);break;case"n":e=-(s/2)-5,n=a,t.top+n+i>u&&(n=-i-a),(r=t.left+e)<0&&(e-=r),(r=t.left+e+s)>l&&(e-=r-l);break;case"s":e=-(s/2),n=-i-a,t.top+n<0&&(n=a),(r=t.left+e)<0&&(e-=r),(r=t.left+e+s)>l&&(e-=r-l);break;case"center":e=-(s/2),n=-(i/2);break;default:e=0,n=0}return{left:e,top:n}},M=function(){t.dom.read(function(){var t=_(),e=k(t),n=t.left+e.left,r=t.top+e.top;if(u)d.interrupt().transition().delay(c).duration(0).style("opacity",0);else{var i="translate("+h.left+"px, "+h.top+"px)",o="translate("+Math.round(n)+"px, "+Math.round(r)+"px)",a=d3.interpolateString(i,o),s=d.style("opacity")<.1;d.interrupt().transition().duration(s?0:f).styleTween("transform",function(t){return a},"important").styleTween("-webkit-transform",function(t){return a}).style("-ms-transform",o).style("opacity",1)}h.left=n,h.top=r})};return n.nvPointerEventsClass=v,n.options=t.utils.optionsFunc.bind(n),n._options=Object.create({},{duration:{get:function(){return f},set:function(t){f=t}},gravity:{get:function(){return o},set:function(t){o=t}},distance:{get:function(){return a},set:function(t){a=t}},snapDistance:{get:function(){return s},set:function(t){s=t}},classes:{get:function(){return l},set:function(t){l=t}},enabled:{get:function(){return p},set:function(t){p=t}},hideDelay:{get:function(){return c},set:function(t){c=t}},contentGenerator:{get:function(){return x},set:function(t){x=t}},valueFormatter:{get:function(){return m},set:function(t){m=t}},headerFormatter:{get:function(){return y},set:function(t){y=t}},keyFormatter:{get:function(){return b},set:function(t){b=t}},headerEnabled:{get:function(){return g},set:function(t){g=t}},position:{get:function(){return _},set:function(t){_=t}},chartContainer:{get:function(){return document.body},set:function(e){t.deprecated("chartContainer","feature removed after 1.8.3")}},fixedTop:{get:function(){return null},set:function(e){t.deprecated("fixedTop","feature removed after 1.8.1")}},offset:{get:function(){return{left:0,top:0}},set:function(e){t.deprecated("offset","use chart.tooltip.distance() instead")}},hidden:{get:function(){return u},set:function(t){u!=t&&(u=!!t,n())}},data:{get:function(){return i},set:function(t){t.point&&(t.value=t.point.x,t.series=t.series||{},t.series.value=t.point.y,t.series.color=t.point.color||t.series.color),i=t}},node:{get:function(){return d.node()},set:function(t){}},id:{get:function(){return r},set:function(t){}}}),t.utils.initOptions(n),n},t.utils.windowSize=function(){var t={width:640,height:480};return window.innerWidth&&window.innerHeight?(t.width=window.innerWidth,t.height=window.innerHeight,t):"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth?(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight,t):document.body&&document.body.offsetWidth?(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight,t):t},t.utils.isArray=Array.isArray,t.utils.isObject=function(t){return null!==t&&"object"==typeof t},t.utils.isFunction=function(t){return"function"==typeof t},t.utils.isDate=function(t){return"[object Date]"===toString.call(t)},t.utils.isNumber=function(t){return!isNaN(t)&&"number"==typeof t},t.utils.windowResize=function(e){return window.addEventListener?window.addEventListener("resize",e):t.log("ERROR: Failed to bind to window.resize with: ",e),{callback:e,clear:function(){window.removeEventListener("resize",e)}}},t.utils.getColor=function(e){if(void 0===e)return t.utils.defaultColor();if(t.utils.isArray(e)){var n=d3.scale.ordinal().range(e);return function(t,e){var r=void 0===e?t:e;return t.color||n(r)}}return e},t.utils.defaultColor=function(){return t.utils.getColor(d3.scale.category20().range())},t.utils.customTheme=function(e,n,r){n=n||function(t){return t.key},r=r||d3.scale.category20().range();var i=r.length;return function(o,a){var s=n(o);return t.utils.isFunction(e[s])?e[s]():void 0!==e[s]?e[s]:(i||(i=r.length),i-=1,r[i])}},t.utils.pjax=function(e,n){var r=function(r){d3.html(r,function(r){var i=d3.select(n).node();i.parentNode.replaceChild(d3.select(r).select(n).node(),i),t.utils.pjax(e,n)})};d3.selectAll(e).on("click",function(){history.pushState(this.href,this.textContent,this.href),r(this.href),d3.event.preventDefault()}),d3.select(window).on("popstate",function(){d3.event.state&&r(d3.event.state)})},t.utils.calcApproxTextWidth=function(e){if(t.utils.isFunction(e.style)&&t.utils.isFunction(e.text)){var n=parseInt(e.style("font-size").replace("px",""),10),r=e.text().length;return t.utils.NaNtoZero(r*n*.5)}return 0},t.utils.NaNtoZero=function(e){return!t.utils.isNumber(e)||isNaN(e)||null===e||e===1/0||e===-(1/0)?0:e},d3.selection.prototype.watchTransition=function(t){var e=[this].concat([].slice.call(arguments,1));return t.transition.apply(t,e)},t.utils.renderWatch=function(e,n){if(!(this instanceof t.utils.renderWatch))return new t.utils.renderWatch(e,n);var r=void 0!==n?n:250,i=[],o=this;this.models=function(t){return t=[].slice.call(arguments,0),t.forEach(function(t){t.__rendered=!1,function(t){t.dispatch.on("renderEnd",function(e){t.__rendered=!0,o.renderEnd("model")})}(t),i.indexOf(t)<0&&i.push(t)}),this},this.reset=function(t){void 0!==t&&(r=t),i=[]},this.transition=function(t,e,n){if(e=arguments.length>1?[].slice.call(arguments,1):[],n=e.length>1?e.pop():void 0!==r?r:250,t.__rendered=!1,i.indexOf(t)<0&&i.push(t),0===n)return t.__rendered=!0,t.delay=function(){return this},t.duration=function(){return this},t;0===t.length?t.__rendered=!0:t.every(function(t){return!t.length})?t.__rendered=!0:t.__rendered=!1;var a=0;return t.transition().duration(n).each(function(){++a}).each("end",function(n,r){0===--a&&(t.__rendered=!0,o.renderEnd.apply(this,e))})},this.renderEnd=function(){i.every(function(t){return t.__rendered})&&(i.forEach(function(t){t.__rendered=!1}),e.renderEnd.apply(this,arguments))}},t.utils.deepExtend=function(e){var n=arguments.length>1?[].slice.call(arguments,1):[];n.forEach(function(n){for(var r in n){var i=t.utils.isArray(e[r]),o=t.utils.isObject(e[r]),a=t.utils.isObject(n[r]);o&&!i&&a?t.utils.deepExtend(e[r],n[r]):e[r]=n[r]}})},t.utils.state=function(){if(!(this instanceof t.utils.state))return new t.utils.state;var e={},n=function(){},r=function(){return{}},i=null,o=null;this.dispatch=d3.dispatch("change","set"),this.dispatch.on("set",function(t){n(t,!0)}),this.getter=function(t){return r=t,this},this.setter=function(t,e){return e||(e=function(){}),n=function(n,r){t(n),r&&e()},this},this.init=function(e){i=i||{},t.utils.deepExtend(i,e)};var a=function(){var t=r();if(JSON.stringify(t)===JSON.stringify(e))return!1;for(var n in t)void 0===e[n]&&(e[n]={}),e[n]=t[n],o=!0;return!0};this.update=function(){i&&(n(i,!1),i=null),a.call(this)&&this.dispatch.change(e)}},t.utils.optionsFunc=function(e){return e&&d3.map(e).forEach(function(e,n){t.utils.isFunction(this[e])&&this[e](n)}.bind(this)),this},t.utils.calcTicksX=function(e,n){var r=1,i=0;for(i;i<n.length;i+=1){var o=n[i]&&n[i].values?n[i].values.length:0;r=o>r?o:r}return t.log("Requested number of ticks: ",e),t.log("Calculated max values to be: ",r),e=e>r?e=r-1:e,e=e<1?1:e,e=Math.floor(e),t.log("Calculating tick count as: ",e),e},t.utils.calcTicksY=function(e,n){return t.utils.calcTicksX(e,n)},t.utils.initOption=function(t,e){t._calls&&t._calls[e]?t[e]=t._calls[e]:(t[e]=function(n){return arguments.length?(t._overrides[e]=!0,t._options[e]=n,t):t._options[e]},t["_"+e]=function(n){return arguments.length?(t._overrides[e]||(t._options[e]=n),t):t._options[e]})},t.utils.initOptions=function(e){e._overrides=e._overrides||{};var n=Object.getOwnPropertyNames(e._options||{}),r=Object.getOwnPropertyNames(e._calls||{});n=n.concat(r);for(var i in n)t.utils.initOption(e,n[i])},t.utils.inheritOptionsD3=function(t,e,n){t._d3options=n.concat(t._d3options||[]),n.unshift(e),n.unshift(t),d3.rebind.apply(this,n)},t.utils.arrayUnique=function(t){return t.sort().filter(function(e,n){return!n||e!=t[n-1]})},t.utils.symbolMap=d3.map(),t.utils.symbol=function(){function e(e,i){var o=n.call(this,e,i),a=r.call(this,e,i);return d3.svg.symbolTypes.indexOf(o)!==-1?d3.svg.symbol().type(o).size(a)():t.utils.symbolMap.get(o)(a)}var n,r=64;return e.type=function(t){return arguments.length?(n=d3.functor(t),e):n},e.size=function(t){return arguments.length?(r=d3.functor(t),e):r},e},t.utils.inheritOptions=function(e,n){var r=Object.getOwnPropertyNames(n._options||{}),i=Object.getOwnPropertyNames(n._calls||{}),o=n._inherited||[],a=n._d3options||[],s=r.concat(i).concat(o).concat(a);s.unshift(n),s.unshift(e),d3.rebind.apply(this,s),e._inherited=t.utils.arrayUnique(r.concat(i).concat(o).concat(r).concat(e._inherited||[])),e._d3options=t.utils.arrayUnique(a.concat(e._d3options||[]))},t.utils.initSVG=function(t){t.classed({"nvd3-svg":!0})},t.utils.sanitizeHeight=function(t,e){return t||parseInt(e.style("height"),10)||400},t.utils.sanitizeWidth=function(t,e){return t||parseInt(e.style("width"),10)||960},t.utils.availableHeight=function(e,n,r){return Math.max(0,t.utils.sanitizeHeight(e,n)-r.top-r.bottom)},t.utils.availableWidth=function(e,n,r){return Math.max(0,t.utils.sanitizeWidth(e,n)-r.left-r.right)},t.utils.noData=function(e,n){var r=e.options(),i=r.margin(),o=r.noData(),a=null==o?["No Data Available."]:[o],s=t.utils.availableHeight(null,n,i),l=t.utils.availableWidth(null,n,i),u=i.left+l/2,c=i.top+s/2;n.selectAll("g").remove();var d=n.selectAll(".nv-noData").data(a);d.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),d.attr("x",u).attr("y",c).text(function(t){return t})},t.utils.wrapTicks=function(t,e){t.each(function(){for(var t,n=d3.select(this),r=n.text().split(/\s+/).reverse(),i=[],o=0,a=1.1,s=n.attr("y"),l=parseFloat(n.attr("dy")),u=n.text(null).append("tspan").attr("x",0).attr("y",s).attr("dy",l+"em");t=r.pop();)i.push(t),u.text(i.join(" ")),u.node().getComputedTextLength()>e&&(i.pop(),u.text(i.join(" ")),i=[t],u=n.append("tspan").attr("x",0).attr("y",s).attr("dy",++o*a+l+"em").text(t))})},t.utils.arrayEquals=function(e,n){if(e===n)return!0;if(!e||!n)return!1;if(e.length!=n.length)return!1;for(var r=0,i=e.length;r<i;r++)if(e[r]instanceof Array&&n[r]instanceof Array){if(!t.arrayEquals(e[r],n[r]))return!1}else if(e[r]!=n[r])return!1;return!0},t.models.axis=function(){"use strict";function e(a){return b.reset(),a.each(function(e){var a=d3.select(this);t.utils.initSVG(a);var v=a.selectAll("g.nv-wrap.nv-axis").data([e]),m=v.enter().append("g").attr("class","nvd3 nv-wrap nv-axis"),x=(m.append("g"),v.select("g"));null!==p?n.ticks(p):"top"!=n.orient()&&"bottom"!=n.orient()||n.ticks(Math.abs(r.range()[1]-r.range()[0])/100),x.watchTransition(b,"axis").call(n),y=y||n.scale();var _=n.tickFormat();null==_&&(_=y.tickFormat());var w=x.selectAll("text.nv-axislabel").data([s||null]);w.exit().remove(),void 0!==g&&x.selectAll("g").select("text").style("font-size",g);var k,M,C;switch(n.orient()){case"top":w.enter().append("text").attr("class","nv-axislabel"),C=0,1===r.range().length?C=h?2*r.range()[0]+r.rangeBand():0:2===r.range().length?C=h?r.range()[0]+r.range()[1]+r.rangeBand():r.range()[1]:r.range().length>2&&(C=r.range()[r.range().length-1]+(r.range()[1]-r.range()[0])),w.attr("text-anchor","middle").attr("y",0).attr("x",C/2),l&&(M=v.selectAll("g.nv-axisMaxMin").data(r.domain()),M.enter().append("g").attr("class",function(t,e){return["nv-axisMaxMin","nv-axisMaxMin-x",0==e?"nv-axisMin-x":"nv-axisMax-x"].join(" ")}).append("text"),M.exit().remove(),M.attr("transform",function(e,n){return"translate("+t.utils.NaNtoZero(r(e))+",0)"}).select("text").attr("dy","-0.5em").attr("y",-n.tickPadding()).attr("text-anchor","middle").text(function(t,e){var n=_(t);return(""+n).match("NaN")?"":n}),M.watchTransition(b,"min-max top").attr("transform",function(e,n){return"translate("+t.utils.NaNtoZero(r.range()[n])+",0)"}));break;case"bottom":k=f+36;var S=30,L=0,A=x.selectAll("g").select("text"),E="";if(u%360){A.attr("transform",""),A.each(function(t,e){var n=this.getBoundingClientRect(),r=n.width;L=n.height,r>S&&(S=r)}),E="rotate("+u+" 0,"+(L/2+n.tickPadding())+")";var T=Math.abs(Math.sin(u*Math.PI/180));k=(T?T*S:S)+30,A.attr("transform",E).style("text-anchor",u%360>0?"start":"end")}else d?A.attr("transform",function(t,e){return"translate(0,"+(e%2==0?"0":"12")+")"}):A.attr("transform","translate(0,0)");w.enter().append("text").attr("class","nv-axislabel"),C=0,1===r.range().length?C=h?2*r.range()[0]+r.rangeBand():0:2===r.range().length?C=h?r.range()[0]+r.range()[1]+r.rangeBand():r.range()[1]:r.range().length>2&&(C=r.range()[r.range().length-1]+(r.range()[1]-r.range()[0])),w.attr("text-anchor","middle").attr("y",k).attr("x",C/2),l&&(M=v.selectAll("g.nv-axisMaxMin").data([r.domain()[0],r.domain()[r.domain().length-1]]),M.enter().append("g").attr("class",function(t,e){return["nv-axisMaxMin","nv-axisMaxMin-x",0==e?"nv-axisMin-x":"nv-axisMax-x"].join(" ")}).append("text"),M.exit().remove(),M.attr("transform",function(e,n){return"translate("+t.utils.NaNtoZero(r(e)+(h?r.rangeBand()/2:0))+",0)"}).select("text").attr("dy",".71em").attr("y",n.tickPadding()).attr("transform",E).style("text-anchor",u?u%360>0?"start":"end":"middle").text(function(t,e){var n=_(t);return(""+n).match("NaN")?"":n}),M.watchTransition(b,"min-max bottom").attr("transform",function(e,n){return"translate("+t.utils.NaNtoZero(r(e)+(h?r.rangeBand()/2:0))+",0)"}));break;case"right":w.enter().append("text").attr("class","nv-axislabel"),w.style("text-anchor",c?"middle":"begin").attr("transform",c?"rotate(90)":"").attr("y",c?-Math.max(i.right,o)+12-(f||0):-10).attr("x",c?d3.max(r.range())/2:n.tickPadding()),l&&(M=v.selectAll("g.nv-axisMaxMin").data(r.domain()),M.enter().append("g").attr("class",function(t,e){return["nv-axisMaxMin","nv-axisMaxMin-y",0==e?"nv-axisMin-y":"nv-axisMax-y"].join(" ")}).append("text").style("opacity",0),M.exit().remove(),M.attr("transform",function(e,n){return"translate(0,"+t.utils.NaNtoZero(r(e))+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",n.tickPadding()).style("text-anchor","start").text(function(t,e){var n=_(t);return(""+n).match("NaN")?"":n}),M.watchTransition(b,"min-max right").attr("transform",function(e,n){return"translate(0,"+t.utils.NaNtoZero(r.range()[n])+")"}).select("text").style("opacity",1));break;case"left":w.enter().append("text").attr("class","nv-axislabel"),w.style("text-anchor",c?"middle":"end").attr("transform",c?"rotate(-90)":"").attr("y",c?-Math.max(i.left,o)+25-(f||0):-10).attr("x",c?-d3.max(r.range())/2:-n.tickPadding()),l&&(M=v.selectAll("g.nv-axisMaxMin").data(r.domain()),M.enter().append("g").attr("class",function(t,e){return["nv-axisMaxMin","nv-axisMaxMin-y",0==e?"nv-axisMin-y":"nv-axisMax-y"].join(" ")}).append("text").style("opacity",0),M.exit().remove(),M.attr("transform",function(e,n){return"translate(0,"+t.utils.NaNtoZero(y(e))+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-n.tickPadding()).attr("text-anchor","end").text(function(t,e){var n=_(t);return(""+n).match("NaN")?"":n}),M.watchTransition(b,"min-max right").attr("transform",function(e,n){return"translate(0,"+t.utils.NaNtoZero(r.range()[n])+")"}).select("text").style("opacity",1))}if(w.text(function(t){return t}),!l||"left"!==n.orient()&&"right"!==n.orient()||(x.selectAll("g").each(function(t,e){d3.select(this).select("text").attr("opacity",1),(r(t)<r.range()[1]+10||r(t)>r.range()[0]-10)&&((t>1e-10||t<-1e-10)&&d3.select(this).attr("opacity",0),d3.select(this).select("text").attr("opacity",0))}),r.domain()[0]==r.domain()[1]&&0==r.domain()[0]&&v.selectAll("g.nv-axisMaxMin").style("opacity",function(t,e){return e?0:1})),l&&("top"===n.orient()||"bottom"===n.orient())){var P=[];v.selectAll("g.nv-axisMaxMin").each(function(t,e){try{e?P.push(r(t)-this.getBoundingClientRect().width-4):P.push(r(t)+this.getBoundingClientRect().width+4)}catch(n){e?P.push(r(t)-4):P.push(r(t)+4)}}),x.selectAll("g").each(function(t,e){(r(t)<P[0]||r(t)>P[1])&&(t>1e-10||t<-1e-10?d3.select(this).remove():d3.select(this).select("text").remove())})}x.selectAll(".tick").filter(function(t){return!parseFloat(Math.round(1e5*t)/1e6)&&void 0!==t}).classed("zero",!0),y=r.copy()}),b.renderEnd("axis immediate"),e}var n=d3.svg.axis(),r=d3.scale.linear(),i={top:0,right:0,bottom:0,left:0},o=75,a=60,s=null,l=!0,u=0,c=!0,d=!1,h=!1,p=null,f=0,g=void 0,v=250,m=d3.dispatch("renderEnd");n.scale(r).orient("bottom").tickFormat(function(t){return t});var y,b=t.utils.renderWatch(m,v);return e.axis=n,e.dispatch=m,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{axisLabelDistance:{get:function(){return f},set:function(t){f=t}},staggerLabels:{get:function(){return d},set:function(t){d=t}},rotateLabels:{get:function(){return u},set:function(t){u=t}},rotateYLabel:{get:function(){return c},set:function(t){c=t}},showMaxMin:{get:function(){return l},set:function(t){l=t}},axisLabel:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return a},set:function(t){a=t}},ticks:{get:function(){return p},set:function(t){p=t}},width:{get:function(){return o},set:function(t){o=t}},fontSize:{get:function(){return g},set:function(t){g=t}},margin:{get:function(){return i},set:function(t){i.top=void 0!==t.top?t.top:i.top,i.right=void 0!==t.right?t.right:i.right,i.bottom=void 0!==t.bottom?t.bottom:i.bottom,i.left=void 0!==t.left?t.left:i.left}},duration:{get:function(){return v},set:function(t){v=t,b.reset(v)}},scale:{get:function(){return r},set:function(i){r=i,n.scale(r),h="function"==typeof r.rangeBands,t.utils.inheritOptionsD3(e,r,["domain","range","rangeBand","rangeBands"])}}}),t.utils.initOptions(e),t.utils.inheritOptionsD3(e,n,["orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"]),t.utils.inheritOptionsD3(e,r,["domain","range","rangeBand","rangeBands"]),e},t.models.boxPlot=function(){"use strict";function e(d){return T.reset(),d.each(function(e){var d=u-l.left-l.right,P=c-l.top-l.bottom;S=d3.select(this),t.utils.initSVG(S),h.domain(n||e.map(function(t,e){return f(t,e)})).rangeBands(r||[0,d],.1);var D=[];if(!i){var O,N,I=[];e.forEach(function(t,e){var n=g(t),r=m(t),i=y(t),o=b(t),a=_(t);a&&a.forEach(function(t,e){I.push(w(t,e,void 0))}),i&&I.push(i),n&&I.push(n),r&&I.push(r),o&&I.push(o)}),O=d3.min(I),N=d3.max(I),D=[O,N]}p.domain(i||D),p.range(o||[P,0]),a=a||h,s=s||p.copy().range([p(0),p(0)]);var z=S.selectAll("g.nv-wrap").data([e]);z.enter().append("g").attr("class","nvd3 nv-wrap");z.attr("transform","translate("+l.left+","+l.top+")");var G=z.selectAll(".nv-boxplot").data(function(t){return t}),W=G.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);G.attr("class","nv-boxplot").attr("transform",function(t,e,n){return"translate("+(h(f(t,e))+.05*h.rangeBand())+", 0)"}).classed("hover",function(t){return t.hover}),G.watchTransition(T,"nv-boxplot: boxplots").style("stroke-opacity",1).style("fill-opacity",.75).delay(function(t,n){return n*A/e.length}).attr("transform",function(t,e){return"translate("+(h(f(t,e))+.05*h.rangeBand())+", 0)"}),G.exit().remove(),W.each(function(t,e){var n=d3.select(this);[y,b].forEach(function(r){if(void 0!==r(t)&&null!==r(t)){var i=r===y?"low":"high";n.append("line").style("stroke",x(t)||C(t,e)).attr("class","nv-boxplot-whisker nv-boxplot-"+i),n.append("line").style("stroke",x(t)||C(t,e)).attr("class","nv-boxplot-tick nv-boxplot-"+i)}})});var F=function(){return null===E?.9*h.rangeBand():Math.min(75,.9*h.rangeBand())},R=function(){return.45*h.rangeBand()-F()/2},B=function(){return.45*h.rangeBand()+F()/2};[y,b].forEach(function(t){var e=t===y?"low":"high",n=t===y?g:m;G.select("line.nv-boxplot-whisker.nv-boxplot-"+e).watchTransition(T,"nv-boxplot: boxplots").attr("x1",.45*h.rangeBand()).attr("y1",function(e,n){return p(t(e))}).attr("x2",.45*h.rangeBand()).attr("y2",function(t,e){return p(n(t))}),G.select("line.nv-boxplot-tick.nv-boxplot-"+e).watchTransition(T,"nv-boxplot: boxplots").attr("x1",R).attr("y1",function(e,n){return p(t(e))}).attr("x2",B).attr("y2",function(e,n){return p(t(e))})}),[y,b].forEach(function(t){var e=t===y?"low":"high";W.selectAll(".nv-boxplot-"+e).on("mouseover",function(e,n,r){d3.select(this).classed("hover",!0),L.elementMouseover({series:{key:t(e),color:x(e)||C(e,r)},e:d3.event})}).on("mouseout",function(e,n,r){d3.select(this).classed("hover",!1),L.elementMouseout({series:{key:t(e),color:x(e)||C(e,r)},e:d3.event})}).on("mousemove",function(t,e){L.elementMousemove({e:d3.event})})}),W.append("rect").attr("class","nv-boxplot-box").on("mouseover",function(t,e){d3.select(this).classed("hover",!0),L.elementMouseover({key:f(t),value:f(t),series:[{key:"Q3",value:m(t),color:x(t)||C(t,e)},{key:"Q2",value:v(t),color:x(t)||C(t,e)},{key:"Q1",value:g(t),color:x(t)||C(t,e)}],data:t,index:e,e:d3.event})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1),L.elementMouseout({key:f(t),value:f(t),series:[{key:"Q3",value:m(t),color:x(t)||C(t,e)},{key:"Q2",value:v(t),color:x(t)||C(t,e)},{key:"Q1",value:g(t),color:x(t)||C(t,e)}],data:t,index:e,e:d3.event})}).on("mousemove",function(t,e){L.elementMousemove({e:d3.event})}),G.select("rect.nv-boxplot-box").watchTransition(T,"nv-boxplot: boxes").attr("y",function(t,e){
return p(m(t))}).attr("width",F).attr("x",R).attr("height",function(t,e){return Math.abs(p(m(t))-p(g(t)))||1}).style("fill",function(t,e){return x(t)||C(t,e)}).style("stroke",function(t,e){return x(t)||C(t,e)}),W.append("line").attr("class","nv-boxplot-median"),G.select("line.nv-boxplot-median").watchTransition(T,"nv-boxplot: boxplots line").attr("x1",R).attr("y1",function(t,e){return p(v(t))}).attr("x2",B).attr("y2",function(t,e){return p(v(t))});var H=G.selectAll(".nv-boxplot-outlier").data(function(t){return _(t)||[]});H.enter().append("circle").style("fill",function(t,e,n){return M(t,e,n)||C(t,n)}).style("stroke",function(t,e,n){return M(t,e,n)||C(t,n)}).style("z-index",9e3).on("mouseover",function(t,e,n){d3.select(this).classed("hover",!0),L.elementMouseover({series:{key:k(t,e,n),color:M(t,e,n)||C(t,n)},e:d3.event})}).on("mouseout",function(t,e,n){d3.select(this).classed("hover",!1),L.elementMouseout({series:{key:k(t,e,n),color:M(t,e,n)||C(t,n)},e:d3.event})}).on("mousemove",function(t,e){L.elementMousemove({e:d3.event})}),H.attr("class","nv-boxplot-outlier"),H.watchTransition(T,"nv-boxplot: nv-boxplot-outlier").attr("cx",.45*h.rangeBand()).attr("cy",function(t,e,n){return p(w(t,e,n))}).attr("r","3"),H.exit().remove(),a=h.copy(),s=p.copy()}),T.renderEnd("nv-boxplot immediate"),e}var n,r,i,o,a,s,l={top:0,right:0,bottom:0,left:0},u=960,c=500,d=Math.floor(1e4*Math.random()),h=d3.scale.ordinal(),p=d3.scale.linear(),f=function(t){return t.label},g=function(t){return t.values.Q1},v=function(t){return t.values.Q2},m=function(t){return t.values.Q3},y=function(t){return t.values.whisker_low},b=function(t){return t.values.whisker_high},x=function(t){return t.color},_=function(t){return t.values.outliers},w=function(t,e,n){return t},k=function(t,e,n){return t},M=function(t,e,n){},C=t.utils.defaultColor(),S=null,L=d3.dispatch("elementMouseover","elementMouseout","elementMousemove","renderEnd"),A=250,E=null,T=t.utils.renderWatch(L,A);return e.dispatch=L,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return u},set:function(t){u=t}},height:{get:function(){return c},set:function(t){c=t}},maxBoxWidth:{get:function(){return E},set:function(t){E=t}},x:{get:function(){return f},set:function(t){f=t}},q1:{get:function(){return g},set:function(t){g=t}},q2:{get:function(){return v},set:function(t){v=t}},q3:{get:function(){return m},set:function(t){m=t}},wl:{get:function(){return y},set:function(t){y=t}},wh:{get:function(){return b},set:function(t){b=t}},itemColor:{get:function(){return x},set:function(t){x=t}},outliers:{get:function(){return _},set:function(t){_=t}},outlierValue:{get:function(){return w},set:function(t){w=t}},outlierLabel:{get:function(){return k},set:function(t){k=t}},outlierColor:{get:function(){return M},set:function(t){M=t}},xScale:{get:function(){return h},set:function(t){h=t}},yScale:{get:function(){return p},set:function(t){p=t}},xDomain:{get:function(){return n},set:function(t){n=t}},yDomain:{get:function(){return i},set:function(t){i=t}},xRange:{get:function(){return r},set:function(t){r=t}},yRange:{get:function(){return o},set:function(t){o=t}},id:{get:function(){return d},set:function(t){d=t}},y:{get:function(){return console.warn("BoxPlot 'y' chart option is deprecated. Please use model overrides instead."),{}},set:function(t){console.warn("BoxPlot 'y' chart option is deprecated. Please use model overrides instead.")}},margin:{get:function(){return l},set:function(t){l.top=void 0!==t.top?t.top:l.top,l.right=void 0!==t.right?t.right:l.right,l.bottom=void 0!==t.bottom?t.bottom:l.bottom,l.left=void 0!==t.left?t.left:l.left}},color:{get:function(){return C},set:function(e){C=t.utils.getColor(e)}},duration:{get:function(){return A},set:function(t){A=t,T.reset(A)}}}),t.utils.initOptions(e),e},t.models.boxPlotChart=function(){"use strict";function e(c){return b.reset(),b.models(i),d&&b.models(o),h&&b.models(a),c.each(function(c){var g=d3.select(this);t.utils.initSVG(g);var b=(l||parseInt(g.style("width"))||960)-s.left-s.right,x=(u||parseInt(g.style("height"))||400)-s.top-s.bottom;if(e.update=function(){m.beforeUpdate(),g.transition().duration(y).call(e)},e.container=this,!c||!c.length){var _=g.selectAll(".nv-noData").data([v]);return _.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),_.attr("x",s.left+b/2).attr("y",s.top+x/2).text(function(t){return t}),e}g.selectAll(".nv-noData").remove(),n=i.xScale(),r=i.yScale().clamp(!0);var w=g.selectAll("g.nv-wrap.nv-boxPlotWithAxes").data([c]),k=w.enter().append("g").attr("class","nvd3 nv-wrap nv-boxPlotWithAxes").append("g"),M=k.append("defs"),C=w.select("g");k.append("g").attr("class","nv-x nv-axis"),k.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),k.append("g").attr("class","nv-barsWrap"),C.attr("transform","translate("+s.left+","+s.top+")"),p&&C.select(".nv-y.nv-axis").attr("transform","translate("+b+",0)"),i.width(b).height(x);var S=C.select(".nv-barsWrap").datum(c.filter(function(t){return!t.disabled}));if(S.transition().call(i),M.append("clipPath").attr("id","nv-x-label-clip-"+i.id()).append("rect"),C.select("#nv-x-label-clip-"+i.id()+" rect").attr("width",n.rangeBand()*(f?2:1)).attr("height",16).attr("x",-n.rangeBand()/(f?1:2)),d){o.scale(n).ticks(t.utils.calcTicksX(b/100,c)).tickSize(-x,0),C.select(".nv-x.nv-axis").attr("transform","translate(0,"+r.range()[0]+")"),C.select(".nv-x.nv-axis").call(o);var L=C.select(".nv-x.nv-axis").selectAll("g");f&&L.selectAll("text").attr("transform",function(t,e,n){return"translate(0,"+(n%2===0?"5":"17")+")"})}h&&(a.scale(r).ticks(Math.floor(x/36)).tickSize(-b,0),C.select(".nv-y.nv-axis").call(a)),C.select(".nv-zeroLine line").attr("x1",0).attr("x2",b).attr("y1",r(0)).attr("y2",r(0))}),b.renderEnd("nv-boxplot chart immediate"),e}var n,r,i=t.models.boxPlot(),o=t.models.axis(),a=t.models.axis(),s={top:15,right:10,bottom:50,left:60},l=null,u=null,c=t.utils.getColor(),d=!0,h=!0,p=!1,f=!1,g=t.models.tooltip(),v="No Data Available.",m=d3.dispatch("beforeUpdate","renderEnd"),y=250;o.orient("bottom").showMaxMin(!1).tickFormat(function(t){return t}),a.orient(p?"right":"left").tickFormat(d3.format(",.1f")),g.duration(0);var b=t.utils.renderWatch(m,y);return i.dispatch.on("elementMouseover.tooltip",function(t){g.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){g.data(t).hidden(!0)}),i.dispatch.on("elementMousemove.tooltip",function(t){g()}),e.dispatch=m,e.boxplot=i,e.xAxis=o,e.yAxis=a,e.tooltip=g,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return l},set:function(t){l=t}},height:{get:function(){return u},set:function(t){u=t}},staggerLabels:{get:function(){return f},set:function(t){f=t}},showXAxis:{get:function(){return d},set:function(t){d=t}},showYAxis:{get:function(){return h},set:function(t){h=t}},tooltipContent:{get:function(){return g},set:function(t){g=t}},noData:{get:function(){return v},set:function(t){v=t}},margin:{get:function(){return s},set:function(t){s.top=void 0!==t.top?t.top:s.top,s.right=void 0!==t.right?t.right:s.right,s.bottom=void 0!==t.bottom?t.bottom:s.bottom,s.left=void 0!==t.left?t.left:s.left}},duration:{get:function(){return y},set:function(t){y=t,b.reset(y),i.duration(y),o.duration(y),a.duration(y)}},color:{get:function(){return c},set:function(e){c=t.utils.getColor(e),i.color(c)}},rightAlignYAxis:{get:function(){return p},set:function(t){p=t,a.orient(t?"right":"left")}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.bullet=function(){"use strict";function e(t,e){var n=t.slice();t.sort(function(t,r){var i=n.indexOf(t),o=n.indexOf(r);return d3.descending(e[i],e[o])})}function n(i){return i.each(function(n,i){var y=g-r.left-r.right,M=v-r.top-r.bottom;m=d3.select(this),t.utils.initSVG(m);var C=a.call(this,n,i).slice(),S=s.call(this,n,i).slice(),L=l.call(this,n,i).slice(),A=u.call(this,n,i).slice(),E=c.call(this,n,i).slice(),T=d.call(this,n,i).slice(),P=h.call(this,n,i).slice(),D=p.call(this,n,i).slice();e(E,C),e(T,S),e(P,L),e(D,A),C.sort(d3.descending),S.sort(d3.descending),L.sort(d3.descending),A.sort(d3.descending);var O=d3.scale.linear().domain(d3.extent(d3.merge([f,C]))).range(o?[y,0]:[0,y]);this.__chart__||d3.scale.linear().domain([0,1/0]).range(O.range());this.__chart__=O;for(var N=(d3.min(C),d3.max(C),C[1],m.selectAll("g.nv-wrap.nv-bullet").data([n])),I=N.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet"),z=I.append("g"),G=N.select("g"),i=0,W=C.length;i<W;i++){var F="nv-range nv-range"+i;i<=2&&(F=F+" nv-range"+w[i]),z.append("rect").attr("class",F)}z.append("rect").attr("class","nv-measure"),N.attr("transform","translate("+r.left+","+r.top+")");for(var R=function(t){return Math.abs(O(t)-O(0))},B=function(t){return O(t<0?t:0)},i=0,W=C.length;i<W;i++){var H=C[i];G.select("rect.nv-range"+i).datum(H).attr("height",M).transition().duration(k).attr("width",R(H)).attr("x",B(H))}G.select("rect.nv-measure").style("fill",b).attr("height",M/3).attr("y",M/3).on("mouseover",function(){x.elementMouseover({value:A[0],label:D[0]||"Current",color:d3.select(this).style("fill")})}).on("mousemove",function(){x.elementMousemove({value:A[0],label:D[0]||"Current",color:d3.select(this).style("fill")})}).on("mouseout",function(){x.elementMouseout({value:A[0],label:D[0]||"Current",color:d3.select(this).style("fill")})}).transition().duration(k).attr("width",A<0?O(0)-O(A[0]):O(A[0])-O(0)).attr("x",B(A));var j=M/6,V=S.map(function(t,e){return{value:t,label:T[e]}});z.selectAll("path.nv-markerTriangle").data(V).enter().append("path").attr("class","nv-markerTriangle").attr("d","M0,"+j+"L"+j+","+-j+" "+-j+","+-j+"Z").on("mouseover",function(t){x.elementMouseover({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill"),pos:[O(t.value),M/2]})}).on("mousemove",function(t){x.elementMousemove({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){x.elementMouseout({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill")})}),G.selectAll("path.nv-markerTriangle").data(V).transition().duration(k).attr("transform",function(t){return"translate("+O(t.value)+","+M/2+")"});var $=L.map(function(t,e){return{value:t,label:P[e]}});z.selectAll("line.nv-markerLine").data($).enter().append("line").attr("cursor","").attr("class","nv-markerLine").attr("x1",function(t){return O(t.value)}).attr("y1","2").attr("x2",function(t){return O(t.value)}).attr("y2",M-2).on("mouseover",function(t){x.elementMouseover({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill"),pos:[O(t.value),M/2]})}).on("mousemove",function(t){x.elementMousemove({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){x.elementMouseout({value:t.value,label:t.label||"Previous",color:d3.select(this).style("fill")})}),G.selectAll("line.nv-markerLine").data($).transition().duration(k).attr("x1",function(t){return O(t.value)}).attr("x2",function(t){return O(t.value)}),N.selectAll(".nv-range").on("mouseover",function(t,e){var n=E[e]||_[e];x.elementMouseover({value:t,label:n,color:d3.select(this).style("fill")})}).on("mousemove",function(){x.elementMousemove({value:A[0],label:D[0]||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){var n=E[e]||_[e];x.elementMouseout({value:t,label:n,color:d3.select(this).style("fill")})})}),n}var r={top:0,right:0,bottom:0,left:0},i="left",o=!1,a=function(t){return t.ranges},s=function(t){return t.markers?t.markers:[]},l=function(t){return t.markerLines?t.markerLines:[0]},u=function(t){return t.measures},c=function(t){return t.rangeLabels?t.rangeLabels:[]},d=function(t){return t.markerLabels?t.markerLabels:[]},h=function(t){return t.markerLineLabels?t.markerLineLabels:[]},p=function(t){return t.measureLabels?t.measureLabels:[]},f=[0],g=380,v=30,m=null,y=null,b=t.utils.getColor(["#1f77b4"]),x=d3.dispatch("elementMouseover","elementMouseout","elementMousemove"),_=["Maximum","Mean","Minimum"],w=["Max","Avg","Min"],k=1e3;return n.dispatch=x,n.options=t.utils.optionsFunc.bind(n),n._options=Object.create({},{ranges:{get:function(){return a},set:function(t){a=t}},markers:{get:function(){return s},set:function(t){s=t}},measures:{get:function(){return u},set:function(t){u=t}},forceX:{get:function(){return f},set:function(t){f=t}},width:{get:function(){return g},set:function(t){g=t}},height:{get:function(){return v},set:function(t){v=t}},tickFormat:{get:function(){return y},set:function(t){y=t}},duration:{get:function(){return k},set:function(t){k=t}},margin:{get:function(){return r},set:function(t){r.top=void 0!==t.top?t.top:r.top,r.right=void 0!==t.right?t.right:r.right,r.bottom=void 0!==t.bottom?t.bottom:r.bottom,r.left=void 0!==t.left?t.left:r.left}},orient:{get:function(){return i},set:function(t){i=t,o="right"==i||"bottom"==i}},color:{get:function(){return b},set:function(e){b=t.utils.getColor(e)}}}),t.utils.initOptions(n),n},t.models.bulletChart=function(){"use strict";function e(r){return r.each(function(i,f){var g=d3.select(this);t.utils.initSVG(g);var v=t.utils.availableWidth(c,g,a),m=d-a.top-a.bottom;if(e.update=function(){e(r)},e.container=this,!i||!s.call(this,i,f))return t.utils.noData(e,g),e;g.selectAll(".nv-noData").remove();var y=s.call(this,i,f).slice().sort(d3.descending),b=l.call(this,i,f).slice().sort(d3.descending),x=u.call(this,i,f).slice().sort(d3.descending),_=g.selectAll("g.nv-wrap.nv-bulletChart").data([i]),w=_.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart"),k=w.append("g"),M=_.select("g");k.append("g").attr("class","nv-bulletWrap"),k.append("g").attr("class","nv-titles"),_.attr("transform","translate("+a.left+","+a.top+")");var C=d3.scale.linear().domain([0,Math.max(y[0],b[0]||0,x[0])]).range(o?[v,0]:[0,v]),S=this.__chart__||d3.scale.linear().domain([0,1/0]).range(C.range());this.__chart__=C;var L=k.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(d-a.top-a.bottom)/2+")");L.append("text").attr("class","nv-title").text(function(t){return t.title}),L.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(t){return t.subtitle}),n.width(v).height(m);var A=M.select(".nv-bulletWrap");d3.transition(A).call(n);var E=h||C.tickFormat(v/100),T=M.selectAll("g.nv-tick").data(C.ticks(p?p:v/50),function(t){return this.textContent||E(t)}),P=T.enter().append("g").attr("class","nv-tick").attr("transform",function(t){return"translate("+S(t)+",0)"}).style("opacity",1e-6);P.append("line").attr("y1",m).attr("y2",7*m/6),P.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*m/6).text(E);var D=d3.transition(T).transition().duration(n.duration()).attr("transform",function(t){return"translate("+C(t)+",0)"}).style("opacity",1);D.select("line").attr("y1",m).attr("y2",7*m/6),D.select("text").attr("y",7*m/6),d3.transition(T.exit()).transition().duration(n.duration()).attr("transform",function(t){return"translate("+C(t)+",0)"}).style("opacity",1e-6).remove()}),d3.timer.flush(),e}var n=t.models.bullet(),r=t.models.tooltip(),i="left",o=!1,a={top:5,right:40,bottom:20,left:120},s=function(t){return t.ranges},l=function(t){return t.markers?t.markers:[]},u=function(t){return t.measures},c=null,d=55,h=null,p=null,f=null,g=d3.dispatch();return r.duration(0).headerEnabled(!1),n.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:t.label,value:t.value,color:t.color},r.data(t).hidden(!1)}),n.dispatch.on("elementMouseout.tooltip",function(t){r.hidden(!0)}),n.dispatch.on("elementMousemove.tooltip",function(t){r()}),e.bullet=n,e.dispatch=g,e.tooltip=r,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{ranges:{get:function(){return s},set:function(t){s=t}},markers:{get:function(){return l},set:function(t){l=t}},measures:{get:function(){return u},set:function(t){u=t}},width:{get:function(){return c},set:function(t){c=t}},height:{get:function(){return d},set:function(t){d=t}},tickFormat:{get:function(){return h},set:function(t){h=t}},ticks:{get:function(){return p},set:function(t){p=t}},noData:{get:function(){return f},set:function(t){f=t}},margin:{get:function(){return a},set:function(t){a.top=void 0!==t.top?t.top:a.top,a.right=void 0!==t.right?t.right:a.right,a.bottom=void 0!==t.bottom?t.bottom:a.bottom,a.left=void 0!==t.left?t.left:a.left}},orient:{get:function(){return i},set:function(t){i=t,o="right"==i||"bottom"==i}}}),t.utils.inheritOptions(e,n),t.utils.initOptions(e),e},t.models.candlestickBar=function(){"use strict";function e(k){return k.each(function(e){n=d3.select(this);var k=t.utils.availableWidth(l,n,s),M=t.utils.availableHeight(u,n,s);t.utils.initSVG(n);var S=k/e[0].values.length*.45;d.domain(r||d3.extent(e[0].values.map(p).concat(b))),_?d.range(o||[.5*k/e[0].values.length,k*(e[0].values.length-.5)/e[0].values.length]):d.range(o||[5+S/2,k-S/2-5]),h.domain(i||[d3.min(e[0].values.map(y).concat(x)),d3.max(e[0].values.map(m).concat(x))]).range(a||[M,0]),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]-.01*d.domain()[0],d.domain()[1]+.01*d.domain()[1]]):d.domain([-1,1])),h.domain()[0]===h.domain()[1]&&(h.domain()[0]?h.domain([h.domain()[0]+.01*h.domain()[0],h.domain()[1]-.01*h.domain()[1]]):h.domain([-1,1]));var L=d3.select(this).selectAll("g.nv-wrap.nv-candlestickBar").data([e[0].values]),A=L.enter().append("g").attr("class","nvd3 nv-wrap nv-candlestickBar"),E=A.append("defs"),T=A.append("g"),P=L.select("g");T.append("g").attr("class","nv-ticks"),L.attr("transform","translate("+s.left+","+s.top+")"),n.on("click",function(t,e){C.chartClick({data:t,index:e,pos:d3.event,id:c})}),E.append("clipPath").attr("id","nv-chart-clip-path-"+c).append("rect"),L.select("#nv-chart-clip-path-"+c+" rect").attr("width",k).attr("height",M),P.attr("clip-path",w?"url(#nv-chart-clip-path-"+c+")":"");var D=L.select(".nv-ticks").selectAll(".nv-tick").data(function(t){return t});D.exit().remove();var O=D.enter().append("g");D.attr("class",function(t,e,n){return(g(t,e)>v(t,e)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+n+"-"+e});O.append("line").attr("class","nv-candlestick-lines").attr("transform",function(t,e){return"translate("+d(p(t,e))+",0)"}).attr("x1",0).attr("y1",function(t,e){return h(m(t,e))}).attr("x2",0).attr("y2",function(t,e){return h(y(t,e))}),O.append("rect").attr("class","nv-candlestick-rects nv-bars").attr("transform",function(t,e){return"translate("+(d(p(t,e))-S/2)+","+(h(f(t,e))-(g(t,e)>v(t,e)?h(v(t,e))-h(g(t,e)):0))+")"}).attr("x",0).attr("y",0).attr("width",S).attr("height",function(t,e){var n=g(t,e),r=v(t,e);return n>r?h(r)-h(n):h(n)-h(r)});D.select(".nv-candlestick-lines").transition().attr("transform",function(t,e){return"translate("+d(p(t,e))+",0)"}).attr("x1",0).attr("y1",function(t,e){return h(m(t,e))}).attr("x2",0).attr("y2",function(t,e){return h(y(t,e))}),D.select(".nv-candlestick-rects").transition().attr("transform",function(t,e){return"translate("+(d(p(t,e))-S/2)+","+(h(f(t,e))-(g(t,e)>v(t,e)?h(v(t,e))-h(g(t,e)):0))+")"}).attr("x",0).attr("y",0).attr("width",S).attr("height",function(t,e){var n=g(t,e),r=v(t,e);return n>r?h(r)-h(n):h(n)-h(r)})}),e}var n,r,i,o,a,s={top:0,right:0,bottom:0,left:0},l=null,u=null,c=Math.floor(1e4*Math.random()),d=d3.scale.linear(),h=d3.scale.linear(),p=function(t){return t.x},f=function(t){return t.y},g=function(t){return t.open},v=function(t){return t.close},m=function(t){return t.high},y=function(t){return t.low},b=[],x=[],_=!1,w=!0,k=t.utils.defaultColor(),M=!1,C=d3.dispatch("stateChange","changeState","renderEnd","chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");return e.highlightPoint=function(t,r){e.clearHighlights(),n.select(".nv-candlestickBar .nv-tick-0-"+t).classed("hover",r)},e.clearHighlights=function(){n.select(".nv-candlestickBar .nv-tick.hover").classed("hover",!1)},e.dispatch=C,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return l},set:function(t){l=t}},height:{get:function(){return u},set:function(t){u=t}},xScale:{get:function(){return d},set:function(t){d=t}},yScale:{get:function(){return h},set:function(t){h=t}},xDomain:{get:function(){return r},set:function(t){r=t}},yDomain:{get:function(){return i},set:function(t){i=t}},xRange:{get:function(){return o},set:function(t){o=t}},yRange:{get:function(){return a},set:function(t){a=t}},forceX:{get:function(){return b},set:function(t){b=t}},forceY:{get:function(){return x},set:function(t){x=t}},padData:{get:function(){return _},set:function(t){_=t}},clipEdge:{get:function(){return w},set:function(t){w=t}},id:{get:function(){return c},set:function(t){c=t}},interactive:{get:function(){return M},set:function(t){M=t}},x:{get:function(){return p},set:function(t){p=t}},y:{get:function(){return f},set:function(t){f=t}},open:{get:function(){return g()},set:function(t){g=t}},close:{get:function(){return v()},set:function(t){v=t}},high:{get:function(){return m},set:function(t){m=t}},low:{get:function(){return y},set:function(t){y=t}},margin:{get:function(){return s},set:function(t){s.top=void 0!=t.top?t.top:s.top,s.right=void 0!=t.right?t.right:s.right,s.bottom=void 0!=t.bottom?t.bottom:s.bottom,s.left=void 0!=t.left?t.left:s.left}},color:{get:function(){return k},set:function(e){k=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.cumulativeLineChart=function(){"use strict";function e(d){return N.reset(),N.models(o),y&&N.models(a),b&&N.models(s),d.each(function(d){function L(t,n){d3.select(e.container).style("cursor","ew-resize")}function P(t,e){O.x=d3.event.x,O.i=Math.round(D.invert(O.x)),G()}function N(t,n){d3.select(e.container).style("cursor","auto"),C.index=O.i,E.stateChange(C)}function G(){et.data([O]);var t=e.duration();e.duration(0),e.update(),e.duration(t)}var W=d3.select(this);t.utils.initSVG(W),W.classed("nv-chart-"+M,!0);var F=t.utils.availableWidth(g,W,h),R=t.utils.availableHeight(v,W,h);if(e.update=function(){0===T?W.call(e):W.transition().duration(T).call(e)},e.container=this,C.setter(z(d),e.update).getter(I(d)).update(),C.disabled=d.map(function(t){return!!t.disabled}),!S){var B;S={};for(B in C)C[B]instanceof Array?S[B]=C[B].slice(0):S[B]=C[B]}var H=d3.behavior.drag().on("dragstart",L).on("drag",P).on("dragend",N);if(!(d&&d.length&&d.filter(function(t){return t.values.length}).length))return t.utils.noData(e,W),e;if(W.selectAll(".nv-noData").remove(),r=o.xScale(),i=o.yScale(),k)o.yDomain(null);else{var j=d.filter(function(t){return!t.disabled}).map(function(t,e){var n=d3.extent(t.values,o.y());return n[0]<-.95&&(n[0]=-.95),[(n[0]-n[1])/(1+n[1]),(n[1]-n[0])/(1+n[0])]}),V=[d3.min(j,function(t){return t[0]}),d3.max(j,function(t){return t[1]})];o.yDomain(V)}D.domain([0,d[0].values.length-1]).range([0,F]).clamp(!0);var d=n(O.i,d),$=w?"none":"all",q=W.selectAll("g.nv-wrap.nv-cumulativeLine").data([d]),U=q.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g"),X=q.select("g");if(U.append("g").attr("class","nv-interactive"),U.append("g").attr("class","nv-x nv-axis").style("pointer-events","none"),U.append("g").attr("class","nv-y nv-axis"),U.append("g").attr("class","nv-background"),U.append("g").attr("class","nv-linesWrap").style("pointer-events",$),U.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none"),U.append("g").attr("class","nv-legendWrap"),U.append("g").attr("class","nv-controlsWrap"),m?(l.width(F),X.select(".nv-legendWrap").datum(d).call(l),p||l.height()===h.top||(h.top=l.height(),R=t.utils.availableHeight(v,W,h)),X.select(".nv-legendWrap").attr("transform","translate(0,"+-h.top+")")):X.select(".nv-legendWrap").selectAll("*").remove(),_){var Y=[{key:"Re-scale y-axis",disabled:!k}];u.width(140).color(["#444","#444","#444"]).rightAlign(!1).margin({top:5,right:0,bottom:5,left:20}),X.select(".nv-controlsWrap").datum(Y).attr("transform","translate(0,"+-h.top+")").call(u)}else X.select(".nv-controlsWrap").selectAll("*").remove();q.attr("transform","translate("+h.left+","+h.top+")"),x&&X.select(".nv-y.nv-axis").attr("transform","translate("+F+",0)");var K=d.filter(function(t){return t.tempDisabled});q.select(".tempDisabled").remove(),K.length&&q.append("text").attr("class","tempDisabled").attr("x",F/2).attr("y","-.71em").style("text-anchor","end").text(K.map(function(t){return t.key}).join(", ")+" values cannot be calculated for this time period."),w&&(c.width(F).height(R).margin({left:h.left,top:h.top}).svgContainer(W).xScale(r),q.select(".nv-interactive").call(c)),U.select(".nv-background").append("rect"),X.select(".nv-background rect").attr("width",F).attr("height",R),o.y(function(t){return t.display.y}).width(F).height(R).color(d.map(function(t,e){return t.color||f(t,e)}).filter(function(t,e){return!d[e].disabled&&!d[e].tempDisabled}));var Z=X.select(".nv-linesWrap").datum(d.filter(function(t){return!t.disabled&&!t.tempDisabled}));Z.call(o),d.forEach(function(t,e){t.seriesIndex=e});var Q=d.filter(function(t){return!t.disabled&&!!A(t)}),J=X.select(".nv-avgLinesWrap").selectAll("line").data(Q,function(t){return t.key}),tt=function(t){var e=i(A(t));return e<0?0:e>R?R:e};J.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(t,e){return o.color()(t,t.seriesIndex)}).attr("x1",0).attr("x2",F).attr("y1",tt).attr("y2",tt),J.style("stroke-opacity",function(t){var e=i(A(t));return e<0||e>R?0:1}).attr("x1",0).attr("x2",F).attr("y1",tt).attr("y2",tt),J.exit().remove();var et=Z.selectAll(".nv-indexLine").data([O]);et.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",.5).style("pointer-events","all").call(H),et.attr("transform",function(t){return"translate("+D(t.i)+",0)"}).attr("height",R),y&&(a.scale(r)._ticks(t.utils.calcTicksX(F/70,d)).tickSize(-R,0),X.select(".nv-x.nv-axis").attr("transform","translate(0,"+i.range()[0]+")"),X.select(".nv-x.nv-axis").call(a)),b&&(s.scale(i)._ticks(t.utils.calcTicksY(R/36,d)).tickSize(-F,0),X.select(".nv-y.nv-axis").call(s)),X.select(".nv-background rect").on("click",function(){O.x=d3.mouse(this)[0],O.i=Math.round(D.invert(O.x)),C.index=O.i,E.stateChange(C),G()}),o.dispatch.on("elementClick",function(t){O.i=t.pointIndex,O.x=D(O.i),C.index=O.i,E.stateChange(C),G()}),u.dispatch.on("legendClick",function(t,n){t.disabled=!t.disabled,k=!t.disabled,C.rescaleY=k,E.stateChange(C),e.update()}),l.dispatch.on("stateChange",function(t){for(var n in t)C[n]=t[n];E.stateChange(C),e.update()}),c.dispatch.on("elementMousemove",function(n){o.clearHighlights();var r,i,l,u=[];if(d.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(a,s){i=t.interactiveBisect(a.values,n.pointXValue,e.x()),o.highlightPoint(s,i,!0);var c=a.values[i];"undefined"!=typeof c&&("undefined"==typeof r&&(r=c),"undefined"==typeof l&&(l=e.xScale()(e.x()(c,i))),u.push({key:a.key,value:e.y()(c,i),color:f(a,a.seriesIndex)}))}),u.length>2){var h=e.yScale().invert(n.mouseY),p=Math.abs(e.yScale().domain()[0]-e.yScale().domain()[1]),g=.03*p,v=t.nearestValueIndex(u.map(function(t){return t.value}),h,g);null!==v&&(u[v].highlight=!0)}var m=a.tickFormat()(e.x()(r,i),i);c.tooltip.valueFormatter(function(t,e){return s.tickFormat()(t)}).data({value:m,series:u})(),c.renderGuideLine(l)}),c.dispatch.on("elementMouseout",function(t){o.clearHighlights()}),E.on("changeState",function(t){"undefined"!=typeof t.disabled&&(d.forEach(function(e,n){e.disabled=t.disabled[n]}),C.disabled=t.disabled),"undefined"!=typeof t.index&&(O.i=t.index,O.x=D(O.i),C.index=t.index,et.data([O])),"undefined"!=typeof t.rescaleY&&(k=t.rescaleY),e.update()})}),N.renderEnd("cumulativeLineChart immediate"),e}function n(t,e){return G||(G=o.y()),e.map(function(e,n){if(!e.values)return e;var r=e.values[t];if(null==r)return e;var i=G(r,t);return i<-.95&&!P?(e.tempDisabled=!0,e):(e.tempDisabled=!1,e.values=e.values.map(function(t,e){return t.display={y:(G(t,e)-i)/(1+i)},t}),e)})}var r,i,o=t.models.line(),a=t.models.axis(),s=t.models.axis(),l=t.models.legend(),u=t.models.legend(),c=t.interactiveGuideline(),d=t.models.tooltip(),h={top:30,right:30,bottom:50,left:60},p=null,f=t.utils.defaultColor(),g=null,v=null,m=!0,y=!0,b=!0,x=!1,_=!0,w=!1,k=!0,M=o.id(),C=t.utils.state(),S=null,L=null,A=function(t){return t.average},E=d3.dispatch("stateChange","changeState","renderEnd"),T=250,P=!1;C.index=0,C.rescaleY=k,a.orient("bottom").tickPadding(7),s.orient(x?"right":"left"),d.valueFormatter(function(t,e){return s.tickFormat()(t,e)}).headerFormatter(function(t,e){return a.tickFormat()(t,e)}),u.updateState(!1);var D=d3.scale.linear(),O={i:0,x:0},N=t.utils.renderWatch(E,T),I=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),index:O.i,rescaleY:k}}},z=function(t){return function(e){void 0!==e.index&&(O.i=e.index),void 0!==e.rescaleY&&(k=e.rescaleY),void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};o.dispatch.on("elementMouseover.tooltip",function(t){var n={x:e.x()(t.point),y:e.y()(t.point),color:t.point.color};t.point=n,d.data(t).hidden(!1)}),o.dispatch.on("elementMouseout.tooltip",function(t){d.hidden(!0)});var G=null;return e.dispatch=E,e.lines=o,e.legend=l,e.controls=u,e.xAxis=a,e.yAxis=s,e.interactiveLayer=c,e.state=C,e.tooltip=d,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return g},set:function(t){g=t}},height:{get:function(){return v},set:function(t){v=t}},rescaleY:{get:function(){return k},set:function(t){k=t}},showControls:{get:function(){return _},set:function(t){_=t}},showLegend:{get:function(){return m},set:function(t){m=t}},average:{get:function(){return A},set:function(t){A=t}},defaultState:{get:function(){return S},set:function(t){S=t}},noData:{get:function(){return L},set:function(t){L=t}},showXAxis:{get:function(){return y},set:function(t){y=t}},showYAxis:{get:function(){return b},set:function(t){b=t}},noErrorCheck:{get:function(){return P},set:function(t){P=t}},margin:{get:function(){return h},set:function(t){void 0!==t.top&&(h.top=t.top,p=t.top),h.right=void 0!==t.right?t.right:h.right,h.bottom=void 0!==t.bottom?t.bottom:h.bottom,h.left=void 0!==t.left?t.left:h.left}},color:{get:function(){return f},set:function(e){f=t.utils.getColor(e),l.color(f)}},useInteractiveGuideline:{get:function(){return w},set:function(t){w=t,t===!0&&(e.interactive(!1),e.useVoronoi(!1))}},rightAlignYAxis:{get:function(){return x},set:function(t){x=t,s.orient(t?"right":"left")}},duration:{get:function(){return T},set:function(t){T=t,o.duration(T),a.duration(T),s.duration(T),N.reset(T)}}}),t.utils.inheritOptions(e,o),t.utils.initOptions(e),e},t.models.discreteBar=function(){"use strict";function e(h){return M.reset(),h.each(function(e){var h=c-u.left-u.right,k=d-u.top-u.bottom;n=d3.select(this),t.utils.initSVG(n),e.forEach(function(t,e){t.values.forEach(function(t){t.series=e})});var C=r&&i?[]:e.map(function(t){return t.values.map(function(t,e){return{x:g(t,e),y:v(t,e),y0:t.y0}})});p.domain(r||d3.merge(C).map(function(t){return t.x})).rangeBands(o||[0,h],.1),f.domain(i||d3.extent(d3.merge(C).map(function(t){return t.y}).concat(m))),b?f.range(a||[k-(f.domain()[0]<0?12:0),f.domain()[1]>0?12:0]):f.range(a||[k,0]),s=s||p,l=l||f.copy().range([f(0),f(0)]);var S=n.selectAll("g.nv-wrap.nv-discretebar").data([e]),L=S.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar"),A=L.append("g");S.select("g");A.append("g").attr("class","nv-groups"),S.attr("transform","translate("+u.left+","+u.top+")");var E=S.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t){return t.key});E.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),E.exit().watchTransition(M,"discreteBar: exit groups").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),E.attr("class",function(t,e){return"nv-group nv-series-"+e}).classed("hover",function(t){return t.hover}),E.watchTransition(M,"discreteBar: groups").style("stroke-opacity",1).style("fill-opacity",.75);
var T=E.selectAll("g.nv-bar").data(function(t){return t.values});T.exit().remove();var P=T.enter().append("g").attr("transform",function(t,e,n){return"translate("+(p(g(t,e))+.05*p.rangeBand())+", "+f(0)+")"}).on("mouseover",function(t,e){d3.select(this).classed("hover",!0),_.elementMouseover({data:t,index:e,color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1),_.elementMouseout({data:t,index:e,color:d3.select(this).style("fill")})}).on("mousemove",function(t,e){_.elementMousemove({data:t,index:e,color:d3.select(this).style("fill")})}).on("click",function(t,e){var n=this;_.elementClick({data:t,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n}),d3.event.stopPropagation()}).on("dblclick",function(t,e){_.elementDblClick({data:t,index:e,color:d3.select(this).style("fill")}),d3.event.stopPropagation()});P.append("rect").attr("height",0).attr("width",.9*p.rangeBand()/e.length),b?(P.append("text").attr("text-anchor","middle"),T.select("text").text(function(t,e){return x(v(t,e))}).watchTransition(M,"discreteBar: bars text").attr("x",.9*p.rangeBand()/2).attr("y",function(t,e){return v(t,e)<0?f(v(t,e))-f(0)+12:-4})):T.selectAll("text").remove(),T.attr("class",function(t,e){return v(t,e)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(t,e){return t.color||y(t,e)}).style("stroke",function(t,e){return t.color||y(t,e)}).select("rect").attr("class",w).watchTransition(M,"discreteBar: bars rect").attr("width",.9*p.rangeBand()/e.length),T.watchTransition(M,"discreteBar: bars").attr("transform",function(t,e){var n=p(g(t,e))+.05*p.rangeBand(),r=v(t,e)<0?f(0):f(0)-f(v(t,e))<1?f(0)-1:f(v(t,e));return"translate("+n+", "+r+")"}).select("rect").attr("height",function(t,e){return Math.max(Math.abs(f(v(t,e))-f(0)),1)}),s=p.copy(),l=f.copy()}),M.renderEnd("discreteBar immediate"),e}var n,r,i,o,a,s,l,u={top:0,right:0,bottom:0,left:0},c=960,d=500,h=Math.floor(1e4*Math.random()),p=d3.scale.ordinal(),f=d3.scale.linear(),g=function(t){return t.x},v=function(t){return t.y},m=[0],y=t.utils.defaultColor(),b=!1,x=d3.format(",.2f"),_=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),w="discreteBar",k=250,M=t.utils.renderWatch(_,k);return e.dispatch=_,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return c},set:function(t){c=t}},height:{get:function(){return d},set:function(t){d=t}},forceY:{get:function(){return m},set:function(t){m=t}},showValues:{get:function(){return b},set:function(t){b=t}},x:{get:function(){return g},set:function(t){g=t}},y:{get:function(){return v},set:function(t){v=t}},xScale:{get:function(){return p},set:function(t){p=t}},yScale:{get:function(){return f},set:function(t){f=t}},xDomain:{get:function(){return r},set:function(t){r=t}},yDomain:{get:function(){return i},set:function(t){i=t}},xRange:{get:function(){return o},set:function(t){o=t}},yRange:{get:function(){return a},set:function(t){a=t}},valueFormat:{get:function(){return x},set:function(t){x=t}},id:{get:function(){return h},set:function(t){h=t}},rectClass:{get:function(){return w},set:function(t){w=t}},margin:{get:function(){return u},set:function(t){u.top=void 0!==t.top?t.top:u.top,u.right=void 0!==t.right?t.right:u.right,u.bottom=void 0!==t.bottom?t.bottom:u.bottom,u.left=void 0!==t.left?t.left:u.left}},color:{get:function(){return y},set:function(e){y=t.utils.getColor(e)}},duration:{get:function(){return k},set:function(t){k=t,M.reset(k)}}}),t.utils.initOptions(e),e},t.models.discreteBarChart=function(){"use strict";function e(l){return M.reset(),M.models(i),g&&M.models(o),v&&M.models(a),l.each(function(l){var p=d3.select(this);t.utils.initSVG(p);var _=t.utils.availableWidth(d,p,u),M=t.utils.availableHeight(h,p,u);if(e.update=function(){w.beforeUpdate(),p.transition().duration(k).call(e)},e.container=this,!(l&&l.length&&l.filter(function(t){return t.values.length}).length))return t.utils.noData(e,p),e;p.selectAll(".nv-noData").remove(),n=i.xScale(),r=i.yScale().clamp(!0);var C=p.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([l]),S=C.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g"),L=S.append("defs"),A=C.select("g");S.append("g").attr("class","nv-x nv-axis"),S.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),S.append("g").attr("class","nv-barsWrap"),S.append("g").attr("class","nv-legendWrap"),A.attr("transform","translate("+u.left+","+u.top+")"),f?(s.width(_),A.select(".nv-legendWrap").datum(l).call(s),c||s.height()===u.top||(u.top=s.height(),M=t.utils.availableHeight(h,p,u)),C.select(".nv-legendWrap").attr("transform","translate(0,"+-u.top+")")):A.select(".nv-legendWrap").selectAll("*").remove(),m&&A.select(".nv-y.nv-axis").attr("transform","translate("+_+",0)"),i.width(_).height(M);var E=A.select(".nv-barsWrap").datum(l.filter(function(t){return!t.disabled}));if(E.transition().call(i),L.append("clipPath").attr("id","nv-x-label-clip-"+i.id()).append("rect"),A.select("#nv-x-label-clip-"+i.id()+" rect").attr("width",n.rangeBand()*(y?2:1)).attr("height",16).attr("x",-n.rangeBand()/(y?1:2)),g){o.scale(n)._ticks(t.utils.calcTicksX(_/100,l)).tickSize(-M,0),A.select(".nv-x.nv-axis").attr("transform","translate(0,"+(r.range()[0]+(i.showValues()&&r.domain()[0]<0?16:0))+")"),A.select(".nv-x.nv-axis").call(o);var T=A.select(".nv-x.nv-axis").selectAll("g");y&&T.selectAll("text").attr("transform",function(t,e,n){return"translate(0,"+(n%2==0?"5":"17")+")"}),x&&T.selectAll(".tick text").attr("transform","rotate("+x+" 0,0)").style("text-anchor",x>0?"start":"end"),b&&A.selectAll(".tick text").call(t.utils.wrapTicks,e.xAxis.rangeBand())}v&&(a.scale(r)._ticks(t.utils.calcTicksY(M/36,l)).tickSize(-_,0),A.select(".nv-y.nv-axis").call(a)),A.select(".nv-zeroLine line").attr("x1",0).attr("x2",m?-_:_).attr("y1",r(0)).attr("y2",r(0))}),M.renderEnd("discreteBar chart immediate"),e}var n,r,i=t.models.discreteBar(),o=t.models.axis(),a=t.models.axis(),s=t.models.legend(),l=t.models.tooltip(),u={top:15,right:10,bottom:50,left:60},c=null,d=null,h=null,p=t.utils.getColor(),f=!1,g=!0,v=!0,m=!1,y=!1,b=!1,x=0,_=null,w=d3.dispatch("beforeUpdate","renderEnd"),k=250;o.orient("bottom").showMaxMin(!1).tickFormat(function(t){return t}),a.orient(m?"right":"left").tickFormat(d3.format(",.1f")),l.duration(0).headerEnabled(!1).valueFormatter(function(t,e){return a.tickFormat()(t,e)}).keyFormatter(function(t,e){return o.tickFormat()(t,e)});var M=t.utils.renderWatch(w,k);return i.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:e.x()(t.data),value:e.y()(t.data),color:t.color},l.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){l.hidden(!0)}),i.dispatch.on("elementMousemove.tooltip",function(t){l()}),e.dispatch=w,e.discretebar=i,e.legend=s,e.xAxis=o,e.yAxis=a,e.tooltip=l,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return d},set:function(t){d=t}},height:{get:function(){return h},set:function(t){h=t}},showLegend:{get:function(){return f},set:function(t){f=t}},staggerLabels:{get:function(){return y},set:function(t){y=t}},rotateLabels:{get:function(){return x},set:function(t){x=t}},wrapLabels:{get:function(){return b},set:function(t){b=!!t}},showXAxis:{get:function(){return g},set:function(t){g=t}},showYAxis:{get:function(){return v},set:function(t){v=t}},noData:{get:function(){return _},set:function(t){_=t}},margin:{get:function(){return u},set:function(t){void 0!==t.top&&(u.top=t.top,c=t.top),u.right=void 0!==t.right?t.right:u.right,u.bottom=void 0!==t.bottom?t.bottom:u.bottom,u.left=void 0!==t.left?t.left:u.left}},duration:{get:function(){return k},set:function(t){k=t,M.reset(k),i.duration(k),o.duration(k),a.duration(k)}},color:{get:function(){return p},set:function(e){p=t.utils.getColor(e),i.color(p),s.color(p)}},rightAlignYAxis:{get:function(){return m},set:function(t){m=t,a.orient(t?"right":"left")}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.distribution=function(){"use strict";function e(c){return h.reset(),c.each(function(e){var c=(i-("x"===a?r.left+r.right:r.top+r.bottom),"x"==a?"y":"x"),d=d3.select(this);t.utils.initSVG(d),n=n||u;var p=d.selectAll("g.nv-distribution").data([e]),f=p.enter().append("g").attr("class","nvd3 nv-distribution"),g=(f.append("g"),p.select("g"));p.attr("transform","translate("+r.left+","+r.top+")");var v=g.selectAll("g.nv-dist").data(function(t){return t},function(t){return t.key});v.enter().append("g"),v.attr("class",function(t,e){return"nv-dist nv-series-"+e}).style("stroke",function(t,e){return l(t,e)});var m=v.selectAll("line.nv-dist"+a).data(function(t){return t.values});m.enter().append("line").attr(a+"1",function(t,e){return n(s(t,e))}).attr(a+"2",function(t,e){return n(s(t,e))}),h.transition(v.exit().selectAll("line.nv-dist"+a),"dist exit").attr(a+"1",function(t,e){return u(s(t,e))}).attr(a+"2",function(t,e){return u(s(t,e))}).style("stroke-opacity",0).remove(),m.attr("class",function(t,e){return"nv-dist"+a+" nv-dist"+a+"-"+e}).attr(c+"1",0).attr(c+"2",o),h.transition(m,"dist").attr(a+"1",function(t,e){return u(s(t,e))}).attr(a+"2",function(t,e){return u(s(t,e))}),n=u.copy()}),h.renderEnd("distribution immediate"),e}var n,r={top:0,right:0,bottom:0,left:0},i=400,o=8,a="x",s=function(t){return t[a]},l=t.utils.defaultColor(),u=d3.scale.linear(),c=250,d=d3.dispatch("renderEnd"),h=t.utils.renderWatch(d,c);return e.options=t.utils.optionsFunc.bind(e),e.dispatch=d,e.margin=function(t){return arguments.length?(r.top="undefined"!=typeof t.top?t.top:r.top,r.right="undefined"!=typeof t.right?t.right:r.right,r.bottom="undefined"!=typeof t.bottom?t.bottom:r.bottom,r.left="undefined"!=typeof t.left?t.left:r.left,e):r},e.width=function(t){return arguments.length?(i=t,e):i},e.axis=function(t){return arguments.length?(a=t,e):a},e.size=function(t){return arguments.length?(o=t,e):o},e.getData=function(t){return arguments.length?(s=d3.functor(t),e):s},e.scale=function(t){return arguments.length?(u=t,e):u},e.color=function(n){return arguments.length?(l=t.utils.getColor(n),e):l},e.duration=function(t){return arguments.length?(c=t,h.reset(c),e):c},e},t.models.focus=function(e){"use strict";function n(x){return b.reset(),b.models(e),h&&b.models(o),p&&b.models(a),x.each(function(b){function x(t){var e=+("e"==t),n=e?1:-1,r=C/3;return"M"+.5*n+","+r+"A6,6 0 0 "+e+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}function _(){s.empty()||s.extent(g),T.data([s.empty()?r.domain():g]).each(function(t,e){var n=r(t[0])-r.range()[0],i=M-r(t[1]);d3.select(this).select(".left").attr("width",n<0?0:n),d3.select(this).select(".right").attr("x",r(t[1])).attr("width",i<0?0:i)})}function w(t){g=s.empty()?null:s.extent();var e=s.empty()?r.domain():s.extent();m.brush({extent:e,brush:s}),_(),t&&m.onBrush(e)}var k=d3.select(this);t.utils.initSVG(k);var M=t.utils.availableWidth(c,k,l),C=d-l.top-l.bottom;n.update=function(){0===v?k.call(n):k.transition().duration(v).call(n)},n.container=this,r=e.xScale(),i=e.yScale();var S=k.selectAll("g.nv-focus").data([b]),L=S.enter().append("g").attr("class","nvd3 nv-focus").append("g"),A=S.select("g");S.attr("transform","translate("+l.left+","+l.top+")"),L.append("g").attr("class","nv-background").append("rect"),L.append("g").attr("class","nv-x nv-axis"),L.append("g").attr("class","nv-y nv-axis"),L.append("g").attr("class","nv-contentWrap"),L.append("g").attr("class","nv-brushBackground"),L.append("g").attr("class","nv-x nv-brush"),f&&A.select(".nv-y.nv-axis").attr("transform","translate("+M+",0)"),A.select(".nv-background rect").attr("width",M).attr("height",C),e.width(M).height(C).color(b.map(function(t,e){return t.color||u(t,e)}).filter(function(t,e){return!b[e].disabled}));var E=A.select(".nv-contentWrap").datum(b.filter(function(t){return!t.disabled}));d3.transition(E).call(e),s.x(r).on("brush",function(){w(y)}),s.on("brushend",function(){y||m.onBrush(s.empty()?r.domain():s.extent())}),g&&s.extent(g);var T=A.select(".nv-brushBackground").selectAll("g").data([g||s.extent()]),P=T.enter().append("g");P.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",C),P.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",C);var D=A.select(".nv-x.nv-brush").call(s);D.selectAll("rect").attr("height",C),D.selectAll(".resize").append("path").attr("d",x),w(!0),A.select(".nv-background rect").attr("width",M).attr("height",C),h&&(o.scale(r)._ticks(t.utils.calcTicksX(M/100,b)).tickSize(-C,0),A.select(".nv-x.nv-axis").attr("transform","translate(0,"+i.range()[0]+")"),d3.transition(A.select(".nv-x.nv-axis")).call(o)),p&&(a.scale(i)._ticks(t.utils.calcTicksY(C/36,b)).tickSize(-M,0),d3.transition(A.select(".nv-y.nv-axis")).call(a)),A.select(".nv-x.nv-axis").attr("transform","translate(0,"+i.range()[0]+")")}),b.renderEnd("focus immediate"),n}var r,i,e=e||t.models.line(),o=t.models.axis(),a=t.models.axis(),s=d3.svg.brush(),l={top:10,right:0,bottom:30,left:0},u=t.utils.defaultColor(),c=null,d=70,h=!0,p=!1,f=!1,g=null,v=250,m=d3.dispatch("brush","onBrush","renderEnd"),y=!0;e.interactive(!1),e.pointActive(function(t){return!1});var b=t.utils.renderWatch(m,v);return n.dispatch=m,n.content=e,n.brush=s,n.xAxis=o,n.yAxis=a,n.options=t.utils.optionsFunc.bind(n),n._options=Object.create({},{width:{get:function(){return c},set:function(t){c=t}},height:{get:function(){return d},set:function(t){d=t}},showXAxis:{get:function(){return h},set:function(t){h=t}},showYAxis:{get:function(){return p},set:function(t){p=t}},brushExtent:{get:function(){return g},set:function(t){g=t}},syncBrushing:{get:function(){return y},set:function(t){y=t}},margin:{get:function(){return l},set:function(t){l.top=void 0!==t.top?t.top:l.top,l.right=void 0!==t.right?t.right:l.right,l.bottom=void 0!==t.bottom?t.bottom:l.bottom,l.left=void 0!==t.left?t.left:l.left}},duration:{get:function(){return v},set:function(t){v=t,b.reset(v),e.duration(v),o.duration(v),a.duration(v)}},color:{get:function(){return u},set:function(n){u=t.utils.getColor(n),e.color(u)}},interpolate:{get:function(){return e.interpolate()},set:function(t){e.interpolate(t)}},xTickFormat:{get:function(){return o.tickFormat()},set:function(t){o.tickFormat(t)}},yTickFormat:{get:function(){return a.tickFormat()},set:function(t){a.tickFormat(t)}},x:{get:function(){return e.x()},set:function(t){e.x(t)}},y:{get:function(){return e.y()},set:function(t){e.y(t)}},rightAlignYAxis:{get:function(){return f},set:function(t){f=t,a.orient(f?"right":"left")}}}),t.utils.inheritOptions(n,e),t.utils.initOptions(n),n},t.models.forceDirectedGraph=function(){"use strict";function e(a){return x.reset(),a.each(function(a){o=d3.select(this),t.utils.initSVG(o);var u=t.utils.availableWidth(r,o,n),x=t.utils.availableHeight(i,o,n);if(o.attr("width",u).attr("height",x),!(a&&a.links&&a.nodes))return t.utils.noData(e,o),e;o.selectAll(".nv-noData").remove(),o.selectAll("*").remove();var _=new Set;a.nodes.forEach(function(t){var e=Object.keys(t);e.forEach(function(t){_.add(t)})});var w=d3.layout.force().nodes(a.nodes).links(a.links).size([u,x]).linkStrength(c).friction(d).linkDistance(h).charge(p).gravity(f).theta(g).alpha(v).start(),k=o.selectAll(".link").data(a.links).enter().append("line").attr("class","nv-force-link").style("stroke-width",function(t){return Math.sqrt(t.value)}),M=o.selectAll(".node").data(a.nodes).enter().append("g").attr("class","nv-force-node").call(w.drag);M.append("circle").attr("r",m).style("fill",function(t){return s(t)}).on("mouseover",function(t){o.select(".nv-series-"+t.seriesIndex+" .nv-distx-"+t.pointIndex).attr("y1",t.py),o.select(".nv-series-"+t.seriesIndex+" .nv-disty-"+t.pointIndex).attr("x2",t.px);var e=s(t);t.series=[],_.forEach(function(n){t.series.push({color:e,key:n,value:t[n]})}),l.data(t).hidden(!1)}).on("mouseout",function(t){l.hidden(!0)}),l.headerFormatter(function(t){return"Node"}),b(k),y(M),w.on("tick",function(){k.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),M.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})})}),e}var n={top:2,right:0,bottom:2,left:0},r=400,i=32,o=null,a=d3.dispatch("renderEnd"),s=t.utils.getColor(["#000"]),l=t.models.tooltip(),u=null,c=.1,d=.9,h=30,p=-120,f=.1,g=.8,v=.1,m=5,y=function(t){},b=function(t){},x=t.utils.renderWatch(a);return e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return r},set:function(t){r=t}},height:{get:function(){return i},set:function(t){i=t}},linkStrength:{get:function(){return c},set:function(t){c=t}},friction:{get:function(){return d},set:function(t){d=t}},linkDist:{get:function(){return h},set:function(t){h=t}},charge:{get:function(){return p},set:function(t){p=t}},gravity:{get:function(){return f},set:function(t){f=t}},theta:{get:function(){return g},set:function(t){g=t}},alpha:{get:function(){return v},set:function(t){v=t}},radius:{get:function(){return m},set:function(t){m=t}},x:{get:function(){return getX},set:function(t){getX=d3.functor(t)}},y:{get:function(){return getY},set:function(t){getY=d3.functor(t)}},margin:{get:function(){return n},set:function(t){n.top=void 0!==t.top?t.top:n.top,n.right=void 0!==t.right?t.right:n.right,n.bottom=void 0!==t.bottom?t.bottom:n.bottom,n.left=void 0!==t.left?t.left:n.left}},color:{get:function(){return s},set:function(e){s=t.utils.getColor(e)}},noData:{get:function(){return u},set:function(t){u=t}},nodeExtras:{get:function(){return y},set:function(t){y=t}},linkExtras:{get:function(){return b},set:function(t){b=t}}}),e.dispatch=a,e.tooltip=l,t.utils.initOptions(e),e},t.models.furiousLegend=function(){"use strict";function e(m){function y(t,e){return"furious"!=v?"#000":f?t.disengaged?s(t,e):"#fff":f?void 0:t.disabled?s(t,e):"#fff"}function b(t,e){return f&&"furious"==v?t.disengaged?"#fff":s(t,e):t.disabled?"#fff":s(t,e)}return m.each(function(e){var m=r-n.left-n.right,x=d3.select(this);t.utils.initSVG(x);var _=x.selectAll("g.nv-legend").data([e]),w=(_.enter().append("g").attr("class","nvd3 nv-legend").append("g"),_.select("g"));_.attr("transform","translate("+n.left+","+n.top+")");var k,M=w.selectAll(".nv-series").data(function(t){return"furious"!=v?t:t.filter(function(t){return!!f||!t.disengaged})}),C=M.enter().append("g").attr("class","nv-series");if("classic"==v)C.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),k=M.select("circle");else if("furious"==v){C.append("rect").style("stroke-width",2).attr("class","nv-legend-symbol").attr("rx",3).attr("ry",3),k=M.select("rect"),C.append("g").attr("class","nv-check-box").property("innerHTML",'<path d="M0.5,5 L22.5,5 L22.5,26.5 L0.5,26.5 L0.5,5 Z" class="nv-box"></path><path d="M5.5,12.8618467 L11.9185089,19.2803556 L31,0.198864511" class="nv-check"></path>').attr("transform","translate(-10,-8)scale(0.5)");var S=M.select(".nv-check-box");S.each(function(t,e){d3.select(this).selectAll("path").attr("stroke",y(t,e))})}C.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");var L=M.select("text.nv-legend-text");M.on("mouseover",function(t,e){g.legendMouseover(t,e)}).on("mouseout",function(t,e){g.legendMouseout(t,e)}).on("click",function(t,e){g.legendClick(t,e);var n=M.data();if(h){if("classic"==v)p?(n.forEach(function(t){t.disabled=!0}),t.disabled=!1):(t.disabled=!t.disabled,n.every(function(t){return t.disabled})&&n.forEach(function(t){t.disabled=!1}));else if("furious"==v)if(f)t.disengaged=!t.disengaged,t.userDisabled=void 0==t.userDisabled?!!t.disabled:t.userDisabled,t.disabled=t.disengaged||t.userDisabled;else if(!f){t.disabled=!t.disabled,t.userDisabled=t.disabled;var r=n.filter(function(t){return!t.disengaged});r.every(function(t){return t.userDisabled})&&n.forEach(function(t){t.disabled=t.userDisabled=!1})}g.stateChange({disabled:n.map(function(t){return!!t.disabled}),disengaged:n.map(function(t){return!!t.disengaged})})}}).on("dblclick",function(t,e){if(("furious"!=v||!f)&&(g.legendDblclick(t,e),h)){var n=M.data();n.forEach(function(t){t.disabled=!0,"furious"==v&&(t.userDisabled=t.disabled)}),t.disabled=!1,"furious"==v&&(t.userDisabled=t.disabled),g.stateChange({disabled:n.map(function(t){return!!t.disabled})})}}),M.classed("nv-disabled",function(t){return t.userDisabled}),M.exit().remove(),L.attr("fill",y).text(function(t){return a(o(t))});var A;switch(v){case"furious":A=23;break;case"classic":A=20}if(u){var E=[];M.each(function(e,n){var r;if(a(o(e))&&a(o(e)).length>l){var i=a(o(e)).substring(0,l);r=d3.select(this).select("text").text(i+"..."),d3.select(this).append("svg:title").text(a(o(e)))}else r=d3.select(this).select("text");var s;try{if(s=r.node().getComputedTextLength(),s<=0)throw Error()}catch(e){s=t.utils.calcApproxTextWidth(r)}E.push(s+c)});for(var T=0,P=0,D=[];P<m&&T<E.length;)D[T]=E[T],P+=E[T++];for(0===T&&(T=1);P>m&&T>1;){D=[],T--;for(var O=0;O<E.length;O++)E[O]>(D[O%T]||0)&&(D[O%T]=E[O]);P=D.reduce(function(t,e,n,r){return t+e})}for(var N=[],I=0,z=0;I<T;I++)N[I]=z,z+=D[I];M.attr("transform",function(t,e){return"translate("+N[e%T]+","+(5+Math.floor(e/T)*A)+")"}),d?w.attr("transform","translate("+(r-n.right-P)+","+n.top+")"):w.attr("transform","translate(0,"+n.top+")"),i=n.top+n.bottom+Math.ceil(E.length/T)*A}else{var G,W=5,F=5,R=0;M.attr("transform",function(t,e){var i=d3.select(this).select("text").node().getComputedTextLength()+c;return G=F,r<n.left+n.right+G+i&&(F=G=5,W+=A),F+=i,F>R&&(R=F),"translate("+G+","+W+")"}),w.attr("transform","translate("+(r-n.right-R)+","+n.top+")"),i=n.top+n.bottom+W+15}"furious"==v&&k.attr("width",function(t,e){return L[0][e].getComputedTextLength()+27}).attr("height",18).attr("y",-9).attr("x",-15),k.style("fill",b).style("stroke",function(t,e){return t.color||s(t,e)})}),e}var n={top:5,right:0,bottom:5,left:0},r=400,i=20,o=function(t){return t.key},a=function(t){return t},s=t.utils.getColor(),l=20,u=!0,c=28,d=!0,h=!0,p=!1,f=!1,g=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange"),v="classic";return e.dispatch=g,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return r},set:function(t){r=t}},height:{get:function(){return i},set:function(t){i=t}},key:{get:function(){return o},set:function(t){o=t}},keyFormatter:{get:function(){return a},set:function(t){a=t}},align:{get:function(){return u},set:function(t){u=t}},rightAlign:{get:function(){return d},set:function(t){d=t}},maxKeyLength:{get:function(){return l},set:function(t){l=t}},padding:{get:function(){return c},set:function(t){c=t}},updateState:{get:function(){return h},set:function(t){h=t}},radioButtonMode:{get:function(){return p},set:function(t){p=t}},expanded:{get:function(){return f},set:function(t){f=t}},vers:{get:function(){return v},set:function(t){v=t}},margin:{get:function(){return n},set:function(t){n.top=void 0!==t.top?t.top:n.top,n.right=void 0!==t.right?t.right:n.right,n.bottom=void 0!==t.bottom?t.bottom:n.bottom,n.left=void 0!==t.left?t.left:n.left}},color:{get:function(){return s},set:function(e){s=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.historicalBar=function(){"use strict";function e(k){return k.each(function(e){w.reset(),c=d3.select(this);var k=t.utils.availableWidth(s,c,a),M=t.utils.availableHeight(l,c,a);t.utils.initSVG(c),d.domain(n||d3.extent(e[0].values.map(p).concat(g))),m?d.range(i||[.5*k/e[0].values.length,k*(e[0].values.length-.5)/e[0].values.length]):d.range(i||[0,k]),h.domain(r||d3.extent(e[0].values.map(f).concat(v))).range(o||[M,0]),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]-.01*d.domain()[0],d.domain()[1]+.01*d.domain()[1]]):d.domain([-1,1])),h.domain()[0]===h.domain()[1]&&(h.domain()[0]?h.domain([h.domain()[0]+.01*h.domain()[0],h.domain()[1]-.01*h.domain()[1]]):h.domain([-1,1]));var C=c.selectAll("g.nv-wrap.nv-historicalBar-"+u).data([e[0].values]),S=C.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBar-"+u),L=S.append("defs"),A=S.append("g"),E=C.select("g");A.append("g").attr("class","nv-bars"),C.attr("transform","translate("+a.left+","+a.top+")"),c.on("click",function(t,e){x.chartClick({data:t,index:e,pos:d3.event,id:u})}),L.append("clipPath").attr("id","nv-chart-clip-path-"+u).append("rect"),C.select("#nv-chart-clip-path-"+u+" rect").attr("width",k).attr("height",M),E.attr("clip-path",y?"url(#nv-chart-clip-path-"+u+")":"");var T=C.select(".nv-bars").selectAll(".nv-bar").data(function(t){return t},function(t,e){return p(t,e)});T.exit().remove(),T.enter().append("rect").attr("x",0).attr("y",function(e,n){return t.utils.NaNtoZero(h(Math.max(0,f(e,n))))}).attr("height",function(e,n){return t.utils.NaNtoZero(Math.abs(h(f(e,n))-h(0)))}).attr("transform",function(t,n){return"translate("+(d(p(t,n))-k/e[0].values.length*.45)+",0)"}).on("mouseover",function(t,e){_&&(d3.select(this).classed("hover",!0),x.elementMouseover({data:t,index:e,color:d3.select(this).style("fill")}))}).on("mouseout",function(t,e){_&&(d3.select(this).classed("hover",!1),x.elementMouseout({data:t,index:e,color:d3.select(this).style("fill")}))}).on("mousemove",function(t,e){_&&x.elementMousemove({data:t,index:e,color:d3.select(this).style("fill")})}).on("click",function(t,e){if(_){var n=this;x.elementClick({data:t,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n}),d3.event.stopPropagation()}}).on("dblclick",function(t,e){_&&(x.elementDblClick({data:t,index:e,color:d3.select(this).style("fill")}),d3.event.stopPropagation())}),T.attr("fill",function(t,e){return b(t,e)}).attr("class",function(t,e,n){return(f(t,e)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+n+"-"+e}).watchTransition(w,"bars").attr("transform",function(t,n){return"translate("+(d(p(t,n))-k/e[0].values.length*.45)+",0)"}).attr("width",k/e[0].values.length*.9),T.watchTransition(w,"bars").attr("y",function(e,n){var r=f(e,n)<0?h(0):h(0)-h(f(e,n))<1?h(0)-1:h(f(e,n));return t.utils.NaNtoZero(r)}).attr("height",function(e,n){return t.utils.NaNtoZero(Math.max(Math.abs(h(f(e,n))-h(0)),1))})}),w.renderEnd("historicalBar immediate"),e}var n,r,i,o,a={top:0,right:0,bottom:0,left:0},s=null,l=null,u=Math.floor(1e4*Math.random()),c=null,d=d3.scale.linear(),h=d3.scale.linear(),p=function(t){return t.x},f=function(t){return t.y},g=[],v=[0],m=!1,y=!0,b=t.utils.defaultColor(),x=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),_=!0,w=t.utils.renderWatch(x,0);return e.highlightPoint=function(t,e){c.select(".nv-bars .nv-bar-0-"+t).classed("hover",e)},e.clearHighlights=function(){c.select(".nv-bars .nv-bar.hover").classed("hover",!1)},e.dispatch=x,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},forceX:{get:function(){return g},set:function(t){g=t}},forceY:{get:function(){return v},set:function(t){v=t}},padData:{get:function(){return m},set:function(t){m=t}},x:{get:function(){return p},set:function(t){p=t}},y:{get:function(){return f},set:function(t){f=t}},xScale:{get:function(){return d},set:function(t){d=t}},yScale:{get:function(){return h},set:function(t){h=t}},xDomain:{get:function(){return n},set:function(t){n=t}},yDomain:{get:function(){return r},set:function(t){r=t}},xRange:{get:function(){return i},set:function(t){i=t}},yRange:{get:function(){return o},set:function(t){o=t}},clipEdge:{get:function(){return y},set:function(t){y=t}},id:{get:function(){return u},set:function(t){u=t}},interactive:{get:function(){return _},set:function(t){_=t}},margin:{get:function(){return a},set:function(t){a.top=void 0!==t.top?t.top:a.top,a.right=void 0!==t.right?t.right:a.right,a.bottom=void 0!==t.bottom?t.bottom:a.bottom,a.left=void 0!==t.left?t.left:a.left}},color:{get:function(){return b},set:function(e){b=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.historicalBarChart=function(e){"use strict";function n(e){return e.each(function(c){S.reset(),S.models(o),m&&S.models(a),y&&S.models(s);var k=d3.select(this);t.utils.initSVG(k);var L=t.utils.availableWidth(f,k,d),A=t.utils.availableHeight(g,k,d);if(n.update=function(){k.transition().duration(C).call(n)},n.container=this,_.disabled=c.map(function(t){return!!t.disabled}),!w){var E;w={};for(E in _)_[E]instanceof Array?w[E]=_[E].slice(0):w[E]=_[E]}if(!(c&&c.length&&c.filter(function(t){return t.values.length}).length))return t.utils.noData(n,k),n;k.selectAll(".nv-noData").remove(),r=o.xScale(),i=o.yScale();var T=k.selectAll("g.nv-wrap.nv-historicalBarChart").data([c]),P=T.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g"),D=T.select("g");P.append("g").attr("class","nv-x nv-axis"),P.append("g").attr("class","nv-y nv-axis"),P.append("g").attr("class","nv-barsWrap"),P.append("g").attr("class","nv-legendWrap"),P.append("g").attr("class","nv-interactive"),v?(l.width(L),D.select(".nv-legendWrap").datum(c).call(l),h||l.height()===d.top||(d.top=l.height(),A=t.utils.availableHeight(g,k,d)),T.select(".nv-legendWrap").attr("transform","translate(0,"+-d.top+")")):D.select(".nv-legendWrap").selectAll("*").remove(),T.attr("transform","translate("+d.left+","+d.top+")"),b&&D.select(".nv-y.nv-axis").attr("transform","translate("+L+",0)"),x&&(u.width(L).height(A).margin({left:d.left,top:d.top}).svgContainer(k).xScale(r),T.select(".nv-interactive").call(u)),o.width(L).height(A).color(c.map(function(t,e){return t.color||p(t,e)}).filter(function(t,e){return!c[e].disabled}));var O=D.select(".nv-barsWrap").datum(c.filter(function(t){return!t.disabled}));O.transition().call(o),m&&(a.scale(r)._ticks(t.utils.calcTicksX(L/100,c)).tickSize(-A,0),D.select(".nv-x.nv-axis").attr("transform","translate(0,"+i.range()[0]+")"),D.select(".nv-x.nv-axis").transition().call(a)),y&&(s.scale(i)._ticks(t.utils.calcTicksY(A/36,c)).tickSize(-L,0),D.select(".nv-y.nv-axis").transition().call(s)),u.dispatch.on("elementMousemove",function(e){o.clearHighlights();var r,i,l,d=[];c.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(a,s){i=t.interactiveBisect(a.values,e.pointXValue,n.x()),o.highlightPoint(i,!0);var u=a.values[i];void 0!==u&&(void 0===r&&(r=u),void 0===l&&(l=n.xScale()(n.x()(u,i))),d.push({key:a.key,value:n.y()(u,i),color:p(a,a.seriesIndex),data:a.values[i]}))});var h=a.tickFormat()(n.x()(r,i));u.tooltip.valueFormatter(function(t,e){return s.tickFormat()(t)}).data({value:h,index:i,series:d})(),u.renderGuideLine(l)}),u.dispatch.on("elementMouseout",function(t){M.tooltipHide(),o.clearHighlights()}),l.dispatch.on("legendClick",function(t,r){t.disabled=!t.disabled,c.filter(function(t){return!t.disabled}).length||c.map(function(t){return t.disabled=!1,T.selectAll(".nv-series").classed("disabled",!1),t}),_.disabled=c.map(function(t){return!!t.disabled}),M.stateChange(_),e.transition().call(n)}),l.dispatch.on("legendDblclick",function(t){c.forEach(function(t){t.disabled=!0}),t.disabled=!1,_.disabled=c.map(function(t){return!!t.disabled}),M.stateChange(_),n.update()}),M.on("changeState",function(t){"undefined"!=typeof t.disabled&&(c.forEach(function(e,n){e.disabled=t.disabled[n]}),_.disabled=t.disabled),n.update()})}),S.renderEnd("historicalBarChart immediate"),n}var r,i,o=e||t.models.historicalBar(),a=t.models.axis(),s=t.models.axis(),l=t.models.legend(),u=t.interactiveGuideline(),c=t.models.tooltip(),d={top:30,right:90,bottom:50,left:90},h=null,p=t.utils.defaultColor(),f=null,g=null,v=!1,m=!0,y=!0,b=!1,x=!1,_={},w=null,k=null,M=d3.dispatch("tooltipHide","stateChange","changeState","renderEnd"),C=250;a.orient("bottom").tickPadding(7),s.orient(b?"right":"left"),c.duration(0).headerEnabled(!1).valueFormatter(function(t,e){return s.tickFormat()(t,e)}).headerFormatter(function(t,e){return a.tickFormat()(t,e);
});var S=t.utils.renderWatch(M,0);return o.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:n.x()(t.data),value:n.y()(t.data),color:t.color},c.data(t).hidden(!1)}),o.dispatch.on("elementMouseout.tooltip",function(t){c.hidden(!0)}),o.dispatch.on("elementMousemove.tooltip",function(t){c()}),n.dispatch=M,n.bars=o,n.legend=l,n.xAxis=a,n.yAxis=s,n.interactiveLayer=u,n.tooltip=c,n.options=t.utils.optionsFunc.bind(n),n._options=Object.create({},{width:{get:function(){return f},set:function(t){f=t}},height:{get:function(){return g},set:function(t){g=t}},showLegend:{get:function(){return v},set:function(t){v=t}},showXAxis:{get:function(){return m},set:function(t){m=t}},showYAxis:{get:function(){return y},set:function(t){y=t}},defaultState:{get:function(){return w},set:function(t){w=t}},noData:{get:function(){return k},set:function(t){k=t}},margin:{get:function(){return d},set:function(t){void 0!==t.top&&(d.top=t.top,h=t.top),d.right=void 0!==t.right?t.right:d.right,d.bottom=void 0!==t.bottom?t.bottom:d.bottom,d.left=void 0!==t.left?t.left:d.left}},color:{get:function(){return p},set:function(e){p=t.utils.getColor(e),l.color(p),o.color(p)}},duration:{get:function(){return C},set:function(t){C=t,S.reset(C),s.duration(C),a.duration(C)}},rightAlignYAxis:{get:function(){return b},set:function(t){b=t,s.orient(t?"right":"left")}},useInteractiveGuideline:{get:function(){return x},set:function(t){x=t,t===!0&&n.interactive(!1)}}}),t.utils.inheritOptions(n,o),t.utils.initOptions(n),n},t.models.ohlcBarChart=function(){var e=t.models.historicalBarChart(t.models.ohlcBar());return e.useInteractiveGuideline(!0),e.interactiveLayer.tooltip.contentGenerator(function(t){var n=t.series[0].data,r=n.open<n.close?"2ca02c":"d62728";return'<h3 style="color: #'+r+'">'+t.value+"</h3><table><tr><td>open:</td><td>"+e.yAxis.tickFormat()(n.open)+"</td></tr><tr><td>close:</td><td>"+e.yAxis.tickFormat()(n.close)+"</td></tr><tr><td>high</td><td>"+e.yAxis.tickFormat()(n.high)+"</td></tr><tr><td>low:</td><td>"+e.yAxis.tickFormat()(n.low)+"</td></tr></table>"}),e},t.models.candlestickBarChart=function(){var e=t.models.historicalBarChart(t.models.candlestickBar());return e.useInteractiveGuideline(!0),e.interactiveLayer.tooltip.contentGenerator(function(t){var n=t.series[0].data,r=n.open<n.close?"2ca02c":"d62728";return'<h3 style="color: #'+r+'">'+t.value+"</h3><table><tr><td>open:</td><td>"+e.yAxis.tickFormat()(n.open)+"</td></tr><tr><td>close:</td><td>"+e.yAxis.tickFormat()(n.close)+"</td></tr><tr><td>high</td><td>"+e.yAxis.tickFormat()(n.high)+"</td></tr><tr><td>low:</td><td>"+e.yAxis.tickFormat()(n.low)+"</td></tr></table>"}),e},t.models.legend=function(){"use strict";function e(m){function y(t,e){return"furious"!=v?"#000":f?t.disengaged?"#000":"#fff":f?void 0:(t.color||(t.color=s(t,e)),t.disabled?t.color:"#fff")}function b(t,e){return f&&"furious"==v&&t.disengaged?"#eee":t.color||s(t,e)}function x(t,e){return f&&"furious"==v?1:t.disabled?0:1}return m.each(function(e){var s=r-n.left-n.right,m=d3.select(this);t.utils.initSVG(m);var _=m.selectAll("g.nv-legend").data([e]),w=_.enter().append("g").attr("class","nvd3 nv-legend").append("g"),k=_.select("g");d?_.attr("transform","translate("+-n.right+","+n.top+")"):_.attr("transform","translate("+n.left+","+n.top+")");var M,C,S=k.selectAll(".nv-series").data(function(t){return"furious"!=v?t:t.filter(function(t){return!!f||!t.disengaged})}),L=S.enter().append("g").attr("class","nv-series");switch(v){case"furious":C=23;break;case"classic":C=20}if("classic"==v)L.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),M=S.select(".nv-legend-symbol");else if("furious"==v){L.append("rect").style("stroke-width",2).attr("class","nv-legend-symbol").attr("rx",3).attr("ry",3),M=S.select(".nv-legend-symbol"),L.append("g").attr("class","nv-check-box").property("innerHTML",'<path d="M0.5,5 L22.5,5 L22.5,26.5 L0.5,26.5 L0.5,5 Z" class="nv-box"></path><path d="M5.5,12.8618467 L11.9185089,19.2803556 L31,0.198864511" class="nv-check"></path>').attr("transform","translate(-10,-8)scale(0.5)");var A=S.select(".nv-check-box");A.each(function(t,e){d3.select(this).selectAll("path").attr("stroke",y(t,e))})}L.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");var E=S.select("text.nv-legend-text");S.on("mouseover",function(t,e){g.legendMouseover(t,e)}).on("mouseout",function(t,e){g.legendMouseout(t,e)}).on("click",function(t,e){g.legendClick(t,e);var n=S.data();if(h){if("classic"==v)p?(n.forEach(function(t){t.disabled=!0}),t.disabled=!1):(t.disabled=!t.disabled,n.every(function(t){return t.disabled})&&n.forEach(function(t){t.disabled=!1}));else if("furious"==v)if(f)t.disengaged=!t.disengaged,t.userDisabled=void 0==t.userDisabled?!!t.disabled:t.userDisabled,t.disabled=t.disengaged||t.userDisabled;else if(!f){t.disabled=!t.disabled,t.userDisabled=t.disabled;var r=n.filter(function(t){return!t.disengaged});r.every(function(t){return t.userDisabled})&&n.forEach(function(t){t.disabled=t.userDisabled=!1})}g.stateChange({disabled:n.map(function(t){return!!t.disabled}),disengaged:n.map(function(t){return!!t.disengaged})})}}).on("dblclick",function(t,e){if(("furious"!=v||!f)&&(g.legendDblclick(t,e),h)){var n=S.data();n.forEach(function(t){t.disabled=!0,"furious"==v&&(t.userDisabled=t.disabled)}),t.disabled=!1,"furious"==v&&(t.userDisabled=t.disabled),g.stateChange({disabled:n.map(function(t){return!!t.disabled})})}}),S.classed("nv-disabled",function(t){return t.userDisabled}),S.exit().remove(),E.attr("fill",y).text(function(t){return a(o(t))});var T=0;if(u){var P=[];S.each(function(e,n){var r;if(a(o(e))&&a(o(e)).length>l){var i=a(o(e)).substring(0,l);r=d3.select(this).select("text").text(i+"..."),d3.select(this).append("svg:title").text(a(o(e)))}else r=d3.select(this).select("text");var s;try{if(s=r.node().getComputedTextLength(),s<=0)throw Error()}catch(e){s=t.utils.calcApproxTextWidth(r)}P.push(s+c)});var D=0,O=[];for(T=0;T<s&&D<P.length;)O[D]=P[D],T+=P[D++];for(0===D&&(D=1);T>s&&D>1;){O=[],D--;for(var N=0;N<P.length;N++)P[N]>(O[N%D]||0)&&(O[N%D]=P[N]);T=O.reduce(function(t,e,n,r){return t+e})}for(var I=[],z=0,G=0;z<D;z++)I[z]=G,G+=O[z];S.attr("transform",function(t,e){return"translate("+I[e%D]+","+(5+Math.floor(e/D)*C)+")"}),d?k.attr("transform","translate("+(r-n.right-T)+","+n.top+")"):k.attr("transform","translate(0,"+n.top+")"),i=n.top+n.bottom+Math.ceil(P.length/D)*C}else{var W,F=5,R=5,B=0;S.attr("transform",function(t,e){var i=d3.select(this).select("text").node().getComputedTextLength()+c;return W=R,r<n.left+n.right+W+i&&(R=W=5,F+=C),R+=i,R>B&&(B=R),T<W+B&&(T=W+B),"translate("+W+","+F+")"}),k.attr("transform","translate("+(r-n.right-B)+","+n.top+")"),i=n.top+n.bottom+F+15}if("furious"==v){M.attr("width",function(t,e){return E[0][e].getComputedTextLength()+27}).attr("height",18).attr("y",-9).attr("x",-15),w.insert("rect",":first-child").attr("class","nv-legend-bg").attr("fill","#eee").attr("opacity",0);var H=k.select(".nv-legend-bg");H.transition().duration(300).attr("x",-C).attr("width",T+C-12).attr("height",i+10).attr("y",-n.top-10).attr("opacity",f?1:0)}M.style("fill",b).style("fill-opacity",x).style("stroke",b)}),e}var n={top:5,right:0,bottom:5,left:0},r=400,i=20,o=function(t){return t.key},a=function(t){return t},s=t.utils.getColor(),l=20,u=!0,c=32,d=!0,h=!0,p=!1,f=!1,g=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange"),v="classic";return e.dispatch=g,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return r},set:function(t){r=t}},height:{get:function(){return i},set:function(t){i=t}},key:{get:function(){return o},set:function(t){o=t}},keyFormatter:{get:function(){return a},set:function(t){a=t}},align:{get:function(){return u},set:function(t){u=t}},maxKeyLength:{get:function(){return l},set:function(t){l=t}},rightAlign:{get:function(){return d},set:function(t){d=t}},padding:{get:function(){return c},set:function(t){c=t}},updateState:{get:function(){return h},set:function(t){h=t}},radioButtonMode:{get:function(){return p},set:function(t){p=t}},expanded:{get:function(){return f},set:function(t){f=t}},vers:{get:function(){return v},set:function(t){v=t}},margin:{get:function(){return n},set:function(t){n.top=void 0!==t.top?t.top:n.top,n.right=void 0!==t.right?t.right:n.right,n.bottom=void 0!==t.bottom?t.bottom:n.bottom,n.left=void 0!==t.left?t.left:n.left}},color:{get:function(){return s},set:function(e){s=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.line=function(){"use strict";function e(m){return _.reset(),_.models(i),m.each(function(e){l=d3.select(this);var m=t.utils.availableWidth(a,l,o),y=t.utils.availableHeight(s,l,o);t.utils.initSVG(l),n=i.xScale(),r=i.yScale(),b=b||n,x=x||r;var w=l.selectAll("g.nv-wrap.nv-line").data([e]),k=w.enter().append("g").attr("class","nvd3 nv-wrap nv-line"),M=k.append("defs"),C=k.append("g"),S=w.select("g");C.append("g").attr("class","nv-groups"),C.append("g").attr("class","nv-scatterWrap"),w.attr("transform","translate("+o.left+","+o.top+")"),i.width(m).height(y);var L=w.select(".nv-scatterWrap");L.call(i),M.append("clipPath").attr("id","nv-edge-clip-"+i.id()).append("rect"),w.select("#nv-edge-clip-"+i.id()+" rect").attr("width",m).attr("height",y>0?y:0),S.attr("clip-path",g?"url(#nv-edge-clip-"+i.id()+")":""),L.attr("clip-path",g?"url(#nv-edge-clip-"+i.id()+")":"");var A=w.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t){return t.key});A.enter().append("g").style("stroke-opacity",1e-6).style("stroke-width",function(t){return t.strokeWidth||u}).style("fill-opacity",1e-6),A.exit().remove(),A.attr("class",function(t,e){return(t.classed||"")+" nv-group nv-series-"+e}).classed("hover",function(t){return t.hover}).style("fill",function(t,e){return c(t,e)}).style("stroke",function(t,e){return c(t,e)}),A.watchTransition(_,"line: groups").style("stroke-opacity",1).style("fill-opacity",function(t){return t.fillOpacity||.5});var E=A.selectAll("path.nv-area").data(function(t){return f(t)?[t]:[]});E.enter().append("path").attr("class","nv-area").attr("d",function(e){return d3.svg.area().interpolate(v).defined(p).x(function(e,n){return t.utils.NaNtoZero(b(d(e,n)))}).y0(function(e,n){return t.utils.NaNtoZero(x(h(e,n)))}).y1(function(t,e){return x(r.domain()[0]<=0?r.domain()[1]>=0?0:r.domain()[1]:r.domain()[0])}).apply(this,[e.values])}),A.exit().selectAll("path.nv-area").remove(),E.watchTransition(_,"line: areaPaths").attr("d",function(e){return d3.svg.area().interpolate(v).defined(p).x(function(e,r){return t.utils.NaNtoZero(n(d(e,r)))}).y0(function(e,n){return t.utils.NaNtoZero(r(h(e,n)))}).y1(function(t,e){return r(r.domain()[0]<=0?r.domain()[1]>=0?0:r.domain()[1]:r.domain()[0])}).apply(this,[e.values])});var T=A.selectAll("path.nv-line").data(function(t){return[t.values]});T.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(v).defined(p).x(function(e,n){return t.utils.NaNtoZero(b(d(e,n)))}).y(function(e,n){return t.utils.NaNtoZero(x(h(e,n)))})),T.watchTransition(_,"line: linePaths").attr("d",d3.svg.line().interpolate(v).defined(p).x(function(e,r){return t.utils.NaNtoZero(n(d(e,r)))}).y(function(e,n){return t.utils.NaNtoZero(r(h(e,n)))})),b=n.copy(),x=r.copy()}),_.renderEnd("line immediate"),e}var n,r,i=t.models.scatter(),o={top:0,right:0,bottom:0,left:0},a=960,s=500,l=null,u=1.5,c=t.utils.defaultColor(),d=function(t){return t.x},h=function(t){return t.y},p=function(t,e){return!isNaN(h(t,e))&&null!==h(t,e)},f=function(t){return t.area},g=!1,v="linear",m=250,y=d3.dispatch("elementClick","elementMouseover","elementMouseout","renderEnd");i.pointSize(16).pointDomain([16,256]);var b,x,_=t.utils.renderWatch(y,m);return e.dispatch=y,e.scatter=i,i.dispatch.on("elementClick",function(){y.elementClick.apply(this,arguments)}),i.dispatch.on("elementMouseover",function(){y.elementMouseover.apply(this,arguments)}),i.dispatch.on("elementMouseout",function(){y.elementMouseout.apply(this,arguments)}),e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return a},set:function(t){a=t}},height:{get:function(){return s},set:function(t){s=t}},defined:{get:function(){return p},set:function(t){p=t}},interpolate:{get:function(){return v},set:function(t){v=t}},clipEdge:{get:function(){return g},set:function(t){g=t}},margin:{get:function(){return o},set:function(t){o.top=void 0!==t.top?t.top:o.top,o.right=void 0!==t.right?t.right:o.right,o.bottom=void 0!==t.bottom?t.bottom:o.bottom,o.left=void 0!==t.left?t.left:o.left}},duration:{get:function(){return m},set:function(t){m=t,_.reset(m),i.duration(m)}},isArea:{get:function(){return f},set:function(t){f=d3.functor(t)}},x:{get:function(){return d},set:function(t){d=t,i.x(t)}},y:{get:function(){return h},set:function(t){h=t,i.y(t)}},color:{get:function(){return c},set:function(e){c=t.utils.getColor(e),i.color(c)}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.lineChart=function(){"use strict";function e(u){return A.reset(),A.models(i),y&&A.models(o),b&&A.models(a),u.each(function(u){function C(){y&&W.select(".nv-focus .nv-x.nv-axis").transition().duration(L).call(o)}function A(){b&&W.select(".nv-focus .nv-y.nv-axis").transition().duration(L).call(a)}function P(t){var e=W.select(".nv-focus .nv-linesWrap").datum(u.filter(function(t){return!t.disabled}).map(function(e,n){return{key:e.key,area:e.area,classed:e.classed,values:e.values.filter(function(e,n){return i.x()(e,n)>=t[0]&&i.x()(e,n)<=t[1]}),disableTooltip:e.disableTooltip}}));e.transition().duration(L).call(i),C(),A()}var D=d3.select(this);t.utils.initSVG(D);var O=t.utils.availableWidth(f,D,d),N=t.utils.availableHeight(g,D,d)-(w?c.height():0);if(e.update=function(){0===L?D.call(e):D.transition().duration(L).call(e)},e.container=this,k.setter(T(u),e.update).getter(E(u)).update(),k.disabled=u.map(function(t){return!!t.disabled}),!M){var I;M={};for(I in k)k[I]instanceof Array?M[I]=k[I].slice(0):M[I]=k[I]}if(!(u&&u.length&&u.filter(function(t){return t.values.length}).length))return t.utils.noData(e,D),e;D.selectAll(".nv-noData").remove(),c.dispatch.on("onBrush",function(t){P(t)}),n=i.xScale(),r=i.yScale();var z=D.selectAll("g.nv-wrap.nv-lineChart").data([u]),G=z.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g"),W=z.select("g");G.append("g").attr("class","nv-legendWrap");var F=G.append("g").attr("class","nv-focus");F.append("g").attr("class","nv-background").append("rect"),F.append("g").attr("class","nv-x nv-axis"),F.append("g").attr("class","nv-y nv-axis"),F.append("g").attr("class","nv-linesWrap"),F.append("g").attr("class","nv-interactive");G.append("g").attr("class","nv-focusWrap");v?(s.width(O),W.select(".nv-legendWrap").datum(u).call(s),"bottom"===m?z.select(".nv-legendWrap").attr("transform","translate(0,"+N+")"):"top"===m&&(h||s.height()===d.top||(d.top=s.height(),N=t.utils.availableHeight(g,D,d)-(w?c.height():0)),z.select(".nv-legendWrap").attr("transform","translate(0,"+-d.top+")"))):W.select(".nv-legendWrap").selectAll("*").remove(),z.attr("transform","translate("+d.left+","+d.top+")"),x&&W.select(".nv-y.nv-axis").attr("transform","translate("+O+",0)"),_&&(l.width(O).height(N).margin({left:d.left,top:d.top}).svgContainer(D).xScale(n),z.select(".nv-interactive").call(l)),W.select(".nv-focus .nv-background rect").attr("width",O).attr("height",N),i.width(O).height(N).color(u.map(function(t,e){return t.color||p(t,e)}).filter(function(t,e){return!u[e].disabled}));var R=W.select(".nv-linesWrap").datum(u.filter(function(t){return!t.disabled}));if(y&&o.scale(n)._ticks(t.utils.calcTicksX(O/100,u)).tickSize(-N,0),b&&a.scale(r)._ticks(t.utils.calcTicksY(N/36,u)).tickSize(-O,0),W.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+N+")"),w){c.width(O),W.select(".nv-focusWrap").attr("transform","translate(0,"+(N+d.bottom+c.margin().top)+")").datum(u.filter(function(t){return!t.disabled})).call(c);var B=c.brush.empty()?c.xDomain():c.brush.extent();null!==B&&P(B)}else R.call(i),C(),A();s.dispatch.on("stateChange",function(t){for(var n in t)k[n]=t[n];S.stateChange(k),e.update()}),l.dispatch.on("elementMousemove",function(r){i.clearHighlights();var o,s,d,h=[];if(u.filter(function(t,e){return t.seriesIndex=e,!t.disabled&&!t.disableTooltip}).forEach(function(a,l){var u=w?c.brush.empty()?c.xScale().domain():c.brush.extent():n.domain(),f=a.values.filter(function(t,e){return u[0]<=u[1]?i.x()(t,e)>=u[0]&&i.x()(t,e)<=u[1]:i.x()(t,e)>=u[1]&&i.x()(t,e)<=u[0]});s=t.interactiveBisect(f,r.pointXValue,i.x());var g=f[s],v=e.y()(g,s);null!==v&&i.highlightPoint(l,s,!0),void 0!==g&&(void 0===o&&(o=g),void 0===d&&(d=e.xScale()(e.x()(g,s))),h.push({key:a.key,value:v,color:p(a,a.seriesIndex),data:g}))}),h.length>2){var f=e.yScale().invert(r.mouseY),g=Math.abs(e.yScale().domain()[0]-e.yScale().domain()[1]),v=.03*g,m=t.nearestValueIndex(h.map(function(t){return t.value}),f,v);null!==m&&(h[m].highlight=!0)}var y=function(t,e){return null==t?"N/A":a.tickFormat()(t)};l.tooltip.valueFormatter(l.tooltip.valueFormatter()||y).data({value:e.x()(o,s),index:s,series:h})(),l.renderGuideLine(d)}),l.dispatch.on("elementClick",function(n){var r,o=[];u.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(i){var a=t.interactiveBisect(i.values,n.pointXValue,e.x()),s=i.values[a];if("undefined"!=typeof s){"undefined"==typeof r&&(r=e.xScale()(e.x()(s,a)));var l=e.yScale()(e.y()(s,a));o.push({point:s,pointIndex:a,pos:[r,l],seriesIndex:i.seriesIndex,series:i})}}),i.dispatch.elementClick(o)}),l.dispatch.on("elementMouseout",function(t){i.clearHighlights()}),S.on("changeState",function(t){"undefined"!=typeof t.disabled&&u.length===t.disabled.length&&(u.forEach(function(e,n){e.disabled=t.disabled[n]}),k.disabled=t.disabled),e.update()})}),A.renderEnd("lineChart immediate"),e}var n,r,i=t.models.line(),o=t.models.axis(),a=t.models.axis(),s=t.models.legend(),l=t.interactiveGuideline(),u=t.models.tooltip(),c=t.models.focus(t.models.line()),d={top:30,right:20,bottom:50,left:60},h=null,p=t.utils.defaultColor(),f=null,g=null,v=!0,m="top",y=!0,b=!0,x=!1,_=!1,w=!1,k=t.utils.state(),M=null,C=null,S=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd"),L=250;o.orient("bottom").tickPadding(7),a.orient(x?"right":"left"),i.clipEdge(!0).duration(0),u.valueFormatter(function(t,e){return a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),l.tooltip.valueFormatter(function(t,e){return a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)});var A=t.utils.renderWatch(S,L),E=function(t){return function(){return{active:t.map(function(t){return!t.disabled})}}},T=function(t){return function(e){void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};return i.dispatch.on("elementMouseover.tooltip",function(t){t.series.disableTooltip||u.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){u.hidden(!0)}),e.dispatch=S,e.lines=i,e.legend=s,e.focus=c,e.xAxis=o,e.x2Axis=c.xAxis,e.yAxis=a,e.y2Axis=c.yAxis,e.interactiveLayer=l,e.tooltip=u,e.state=k,e.dispatch=S,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return f},set:function(t){f=t}},height:{get:function(){return g},set:function(t){g=t}},showLegend:{get:function(){return v},set:function(t){v=t}},legendPosition:{get:function(){return m},set:function(t){m=t}},showXAxis:{get:function(){return y},set:function(t){y=t}},showYAxis:{get:function(){return b},set:function(t){b=t}},defaultState:{get:function(){return M},set:function(t){M=t}},noData:{get:function(){return C},set:function(t){C=t}},focusEnable:{get:function(){return w},set:function(t){w=t}},focusHeight:{get:function(){return c.height()},set:function(t){c.height(t)}},focusShowAxisX:{get:function(){return c.showXAxis()},set:function(t){c.showXAxis(t)}},focusShowAxisY:{get:function(){return c.showYAxis()},set:function(t){c.showYAxis(t)}},brushExtent:{get:function(){return c.brushExtent()},set:function(t){c.brushExtent(t)}},focusMargin:{get:function(){return c.margin},set:function(t){void 0!==t.top&&(d.top=t.top,h=t.top),c.margin.right=void 0!==t.right?t.right:c.margin.right,c.margin.bottom=void 0!==t.bottom?t.bottom:c.margin.bottom,c.margin.left=void 0!==t.left?t.left:c.margin.left}},margin:{get:function(){return d},set:function(t){d.top=void 0!==t.top?t.top:d.top,d.right=void 0!==t.right?t.right:d.right,d.bottom=void 0!==t.bottom?t.bottom:d.bottom,d.left=void 0!==t.left?t.left:d.left}},duration:{get:function(){return L},set:function(t){L=t,A.reset(L),i.duration(L),c.duration(L),o.duration(L),a.duration(L)}},color:{get:function(){return p},set:function(e){p=t.utils.getColor(e),s.color(p),i.color(p),c.color(p)}},interpolate:{get:function(){return i.interpolate()},set:function(t){i.interpolate(t),c.interpolate(t)}},xTickFormat:{get:function(){return o.tickFormat()},set:function(t){o.tickFormat(t),c.xTickFormat(t)}},yTickFormat:{get:function(){return a.tickFormat()},set:function(t){a.tickFormat(t),c.yTickFormat(t)}},x:{get:function(){return i.x()},set:function(t){i.x(t),c.x(t)}},y:{get:function(){return i.y()},set:function(t){i.y(t),c.y(t)}},rightAlignYAxis:{get:function(){return x},set:function(t){x=t,a.orient(x?"right":"left")}},useInteractiveGuideline:{get:function(){return _},set:function(t){_=t,_&&(i.interactive(!1),i.useVoronoi(!1))}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.lineWithFocusChart=function(){return t.models.lineChart().margin({bottom:30}).focusEnable(!0)},t.models.linePlusBarChart=function(){"use strict";function e(_){return _.each(function(_){function z(t){var e=+("e"==t),n=e?1:-1,r=Q/3;return"M"+.5*n+","+r+"A6,6 0 0 "+e+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}function V(){x.empty()||x.extent(I),pt.data([x.empty()?i.domain():I]).each(function(t,e){var n=i(t[0])-i.range()[0],r=i.range()[1]-i(t[1]);d3.select(this).select(".left").attr("width",n<0?0:n),d3.select(this).select(".right").attr("x",i(t[1])).attr("width",r<0?0:r)})}function $(){I=x.empty()?null:x.extent(),n=x.empty()?i.domain():x.extent(),G.brush({extent:n,brush:x}),V(),d.width(K).height(Z).color(_.map(function(t,e){return t.color||E(t,e)}).filter(function(t,e){return!_[e].disabled&&_[e].bar})),u.width(K).height(Z).color(_.map(function(t,e){return t.color||E(t,e)}).filter(function(t,e){return!_[e].disabled&&!_[e].bar}));var e=at.select(".nv-focus .nv-barsWrap").datum(tt.length?tt.map(function(t,e){return{key:t.key,values:t.values.filter(function(t,e){return d.x()(t,e)>=n[0]&&d.x()(t,e)<=n[1]})}}):[{values:[]}]),s=at.select(".nv-focus .nv-linesWrap").datum(X(et)?[{values:[]}]:et.filter(function(t){return!t.disabled}).map(function(t,e){return{area:t.area,fillOpacity:t.fillOpacity,strokeWidth:t.strokeWidth,key:t.key,values:t.values.filter(function(t,e){return u.x()(t,e)>=n[0]&&u.x()(t,e)<=n[1]})}}));r=tt.length&&!j?d.xScale():u.xScale(),p.scale(r)._ticks(t.utils.calcTicksX(K/100,_)).tickSize(-Z,0),p.domain([Math.ceil(n[0]),Math.floor(n[1])]),at.select(".nv-x.nv-axis").transition().duration(W).call(p),e.transition().duration(W).call(d),s.transition().duration(W).call(u),at.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+o.range()[0]+")"),g.scale(o)._ticks(t.utils.calcTicksY(Z/36,_)).tickSize(-K,0),v.scale(a)._ticks(t.utils.calcTicksY(Z/36,_)),j?v.tickSize(et.length?0:-K,0):v.tickSize(tt.length?0:-K,0);var l=tt.length?1:0,c=et.length&&!X(et)?1:0,h=j?c:l,f=j?l:c;at.select(".nv-focus .nv-y1.nv-axis").style("opacity",h),at.select(".nv-focus .nv-y2.nv-axis").style("opacity",f).attr("transform","translate("+r.range()[1]+",0)"),at.select(".nv-focus .nv-y1.nv-axis").transition().duration(W).call(g),at.select(".nv-focus .nv-y2.nv-axis").transition().duration(W).call(v)}var Y=d3.select(this);t.utils.initSVG(Y);var K=t.utils.availableWidth(C,Y,w),Z=t.utils.availableHeight(S,Y,w)-(P?N:0),Q=N-M.top-M.bottom;if(e.update=function(){Y.transition().duration(W).call(e)},e.container=this,F.setter(U(_),e.update).getter(q(_)).update(),F.disabled=_.map(function(t){return!!t.disabled}),!R){var J;R={};for(J in F)F[J]instanceof Array?R[J]=F[J].slice(0):R[J]=F[J]}if(!(_&&_.length&&_.filter(function(t){return t.values.length}).length))return t.utils.noData(e,Y),e;Y.selectAll(".nv-noData").remove();var tt=_.filter(function(t){return!t.disabled&&t.bar}),et=_.filter(function(t){return!t.bar});r=tt.length&&!j?d.xScale():u.xScale(),i=f.scale(),o=j?u.yScale():d.yScale(),a=j?d.yScale():u.yScale(),s=j?c.yScale():h.yScale(),l=j?h.yScale():c.yScale();var nt=_.filter(function(t){return!t.disabled&&(j?!t.bar:t.bar)}).map(function(t){return t.values.map(function(t,e){return{x:L(t,e),y:A(t,e)}})}),rt=_.filter(function(t){return!t.disabled&&(j?t.bar:!t.bar)}).map(function(t){return t.values.map(function(t,e){return{x:L(t,e),y:A(t,e)}})});r.range([0,K]),i.domain(d3.extent(d3.merge(nt.concat(rt)),function(t){return t.x})).range([0,K]);var it=Y.selectAll("g.nv-wrap.nv-linePlusBar").data([_]),ot=it.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g"),at=it.select("g");ot.append("g").attr("class","nv-legendWrap");var st=ot.append("g").attr("class","nv-focus");st.append("g").attr("class","nv-x nv-axis"),st.append("g").attr("class","nv-y1 nv-axis"),st.append("g").attr("class","nv-y2 nv-axis"),st.append("g").attr("class","nv-barsWrap"),st.append("g").attr("class","nv-linesWrap");var lt=ot.append("g").attr("class","nv-context");if(lt.append("g").attr("class","nv-x nv-axis"),lt.append("g").attr("class","nv-y1 nv-axis"),lt.append("g").attr("class","nv-y2 nv-axis"),lt.append("g").attr("class","nv-barsWrap"),lt.append("g").attr("class","nv-linesWrap"),lt.append("g").attr("class","nv-brushBackground"),lt.append("g").attr("class","nv-x nv-brush"),T){var ut=b.align()?K/2:K,ct=b.align()?ut:0;b.width(ut),at.select(".nv-legendWrap").datum(_.map(function(t){return t.originalKey=void 0===t.originalKey?t.key:t.originalKey,j?t.key=t.originalKey+(t.bar?H:B):t.key=t.originalKey+(t.bar?B:H),t})).call(b),k||b.height()===w.top||(w.top=b.height(),Z=t.utils.availableHeight(S,Y,w)-N),at.select(".nv-legendWrap").attr("transform","translate("+ct+","+-w.top+")")}else at.select(".nv-legendWrap").selectAll("*").remove();it.attr("transform","translate("+w.left+","+w.top+")"),at.select(".nv-context").style("display",P?"initial":"none"),h.width(K).height(Q).color(_.map(function(t,e){return t.color||E(t,e)}).filter(function(t,e){return!_[e].disabled&&_[e].bar})),c.width(K).height(Q).color(_.map(function(t,e){return t.color||E(t,e)}).filter(function(t,e){return!_[e].disabled&&!_[e].bar}));var dt=at.select(".nv-context .nv-barsWrap").datum(tt.length?tt:[{values:[]}]),ht=at.select(".nv-context .nv-linesWrap").datum(X(et)?[{values:[]}]:et.filter(function(t){return!t.disabled}));at.select(".nv-context").attr("transform","translate(0,"+(Z+w.bottom+M.top)+")"),dt.transition().call(h),ht.transition().call(c),O&&(f._ticks(t.utils.calcTicksX(K/100,_)).tickSize(-Q,0),at.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+s.range()[0]+")"),at.select(".nv-context .nv-x.nv-axis").transition().call(f)),D&&(m.scale(s)._ticks(Q/36).tickSize(-K,0),y.scale(l)._ticks(Q/36).tickSize(tt.length?0:-K,0),at.select(".nv-context .nv-y3.nv-axis").style("opacity",tt.length?1:0).attr("transform","translate(0,"+i.range()[0]+")"),at.select(".nv-context .nv-y2.nv-axis").style("opacity",et.length?1:0).attr("transform","translate("+i.range()[1]+",0)"),at.select(".nv-context .nv-y1.nv-axis").transition().call(m),at.select(".nv-context .nv-y2.nv-axis").transition().call(y)),x.x(i).on("brush",$),I&&x.extent(I);var pt=at.select(".nv-brushBackground").selectAll("g").data([I||x.extent()]),ft=pt.enter().append("g");ft.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",Q),ft.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",Q);var gt=at.select(".nv-x.nv-brush").call(x);gt.selectAll("rect").attr("height",Q),gt.selectAll(".resize").append("path").attr("d",z),b.dispatch.on("stateChange",function(t){for(var n in t)F[n]=t[n];G.stateChange(F),e.update()}),G.on("changeState",function(t){"undefined"!=typeof t.disabled&&(_.forEach(function(e,n){e.disabled=t.disabled[n]}),F.disabled=t.disabled),e.update()}),$()}),e}var n,r,i,o,a,s,l,u=t.models.line(),c=t.models.line(),d=t.models.historicalBar(),h=t.models.historicalBar(),p=t.models.axis(),f=t.models.axis(),g=t.models.axis(),v=t.models.axis(),m=t.models.axis(),y=t.models.axis(),b=t.models.legend(),x=d3.svg.brush(),_=t.models.tooltip(),w={top:30,right:30,bottom:30,left:60},k=null,M={top:0,right:30,bottom:20,left:60},C=null,S=null,L=function(t){return t.x},A=function(t){return t.y},E=t.utils.defaultColor(),T=!0,P=!0,D=!1,O=!0,N=50,I=null,z=null,G=d3.dispatch("brush","stateChange","changeState"),W=0,F=t.utils.state(),R=null,B=" (left axis)",H=" (right axis)",j=!1;u.clipEdge(!0),c.interactive(!1),c.pointActive(function(t){return!1}),p.orient("bottom").tickPadding(5),g.orient("left"),v.orient("right"),f.orient("bottom").tickPadding(5),m.orient("left"),y.orient("right"),_.headerEnabled(!0).headerFormatter(function(t,e){return p.tickFormat()(t,e)});var V=function(){return j?{main:v,focus:y}:{main:g,focus:m}},$=function(){return j?{main:g,focus:m}:{main:v,focus:y}},q=function(t){return function(){return{active:t.map(function(t){return!t.disabled})}}},U=function(t){return function(e){void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}},X=function(t){return t.every(function(t){return t.disabled})};return u.dispatch.on("elementMouseover.tooltip",function(t){_.duration(100).valueFormatter(function(t,e){return $().main.tickFormat()(t,e)}).data(t).hidden(!1)}),u.dispatch.on("elementMouseout.tooltip",function(t){_.hidden(!0)}),d.dispatch.on("elementMouseover.tooltip",function(t){t.value=e.x()(t.data),t.series={value:e.y()(t.data),color:t.color},_.duration(0).valueFormatter(function(t,e){return V().main.tickFormat()(t,e)}).data(t).hidden(!1)}),d.dispatch.on("elementMouseout.tooltip",function(t){_.hidden(!0)}),d.dispatch.on("elementMousemove.tooltip",function(t){_()}),e.dispatch=G,e.legend=b,e.lines=u,e.lines2=c,e.bars=d,e.bars2=h,e.xAxis=p,e.x2Axis=f,e.y1Axis=g,e.y2Axis=v,e.y3Axis=m,e.y4Axis=y,e.tooltip=_,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return C},set:function(t){C=t}},height:{get:function(){return S},set:function(t){S=t}},showLegend:{get:function(){return T},set:function(t){T=t}},brushExtent:{get:function(){return I},set:function(t){I=t}},noData:{get:function(){return z},set:function(t){z=t}},focusEnable:{get:function(){return P},set:function(t){P=t}},focusHeight:{get:function(){return N},set:function(t){N=t}},focusShowAxisX:{get:function(){return O},set:function(t){O=t}},focusShowAxisY:{get:function(){return D},set:function(t){D=t}},legendLeftAxisHint:{get:function(){return B},set:function(t){B=t}},legendRightAxisHint:{get:function(){return H},set:function(t){H=t}},margin:{get:function(){return w},set:function(t){void 0!==t.top&&(w.top=t.top,k=t.top),w.right=void 0!==t.right?t.right:w.right,w.bottom=void 0!==t.bottom?t.bottom:w.bottom,w.left=void 0!==t.left?t.left:w.left}},focusMargin:{get:function(){return M},set:function(t){M.top=void 0!==t.top?t.top:M.top,M.right=void 0!==t.right?t.right:M.right,M.bottom=void 0!==t.bottom?t.bottom:M.bottom,M.left=void 0!==t.left?t.left:M.left}},duration:{get:function(){return W},set:function(t){W=t}},color:{get:function(){return E},set:function(e){E=t.utils.getColor(e),b.color(E)}},x:{get:function(){return L},set:function(t){L=t,u.x(t),c.x(t),d.x(t),h.x(t)}},y:{get:function(){return A},set:function(t){A=t,u.y(t),c.y(t),d.y(t),h.y(t)}},switchYAxisOrder:{get:function(){return j},set:function(t){if(j!==t){var e=g;g=v,v=e;var n=m;m=y,y=n}j=t,g.orient("left"),v.orient("right"),m.orient("left"),
y.orient("right")}}}),t.utils.inheritOptions(e,u),t.utils.initOptions(e),e},t.models.multiBar=function(){"use strict";function e(P){return E.reset(),P.each(function(e){var P=c-u.left-u.right,D=d-u.top-u.bottom;g=d3.select(this),t.utils.initSVG(g);var O=0;if(k&&e.length&&(k=[{values:e[0].values.map(function(t){return{x:t.x,y:0,series:t.series,size:.01}})}]),x){var N=d3.layout.stack().offset(_).values(function(t){return t.values}).y(m)(!e.length&&k?k:e);N.forEach(function(t,n){t.nonStackable?(e[n].nonStackableSeries=O++,N[n]=e[n]):n>0&&N[n-1].nonStackable&&N[n].values.map(function(t,e){t.y0-=N[n-1].values[e].y,t.y1=t.y0+t.y})}),e=N}e.forEach(function(t,e){t.values.forEach(function(n){n.series=e,n.key=t.key})}),x&&e.length>0&&e[0].values.map(function(t,n){var r=0,i=0;e.map(function(t,o){if(!e[o].nonStackable){var a=t.values[n];a.size=Math.abs(a.y),a.y<0?(a.y1=i,i-=a.size):(a.y1=a.size+r,r+=a.size)}})});var I=r&&i?[]:e.map(function(t,e){return t.values.map(function(t,n){return{x:v(t,n),y:m(t,n),y0:t.y0,y1:t.y1,idx:e}})});h.domain(r||d3.merge(I).map(function(t){return t.x})).rangeBands(o||[0,P],S),p.domain(i||d3.extent(d3.merge(I).map(function(t){var n=t.y;return x&&!e[t.idx].nonStackable&&(n=t.y>0?t.y1:t.y1+t.y),n}).concat(y))).range(a||[D,0]),h.domain()[0]===h.domain()[1]&&(h.domain()[0]?h.domain([h.domain()[0]-.01*h.domain()[0],h.domain()[1]+.01*h.domain()[1]]):h.domain([-1,1])),p.domain()[0]===p.domain()[1]&&(p.domain()[0]?p.domain([p.domain()[0]+.01*p.domain()[0],p.domain()[1]-.01*p.domain()[1]]):p.domain([-1,1])),s=s||h,l=l||p;var z=g.selectAll("g.nv-wrap.nv-multibar").data([e]),G=z.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar"),W=G.append("defs"),F=G.append("g"),R=z.select("g");F.append("g").attr("class","nv-groups"),z.attr("transform","translate("+u.left+","+u.top+")"),W.append("clipPath").attr("id","nv-edge-clip-"+f).append("rect"),z.select("#nv-edge-clip-"+f+" rect").attr("width",P).attr("height",D),R.attr("clip-path",b?"url(#nv-edge-clip-"+f+")":"");var B=z.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t,e){return e});B.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);var H=E.transition(B.exit().selectAll("rect.nv-bar"),"multibarExit",Math.min(100,C)).attr("y",function(t,n,r){var i=l(0)||0;return x&&e[t.series]&&!e[t.series].nonStackable&&(i=l(t.y0)),i}).attr("height",0).remove();H.delay&&H.delay(function(t,e){var n=e*(C/(T+1))-e;return n}),B.attr("class",function(t,e){return"nv-group nv-series-"+e}).classed("hover",function(t){return t.hover}).style("fill",function(t,e){return w(t,e)}).style("stroke",function(t,e){return w(t,e)}),B.style("stroke-opacity",1).style("fill-opacity",L);var j=B.selectAll("rect.nv-bar").data(function(t){return k&&!e.length?k.values:t.values});j.exit().remove();j.enter().append("rect").attr("class",function(t,e){return m(t,e)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(t,n,r){return x&&!e[r].nonStackable?0:r*h.rangeBand()/e.length}).attr("y",function(t,n,r){return l(x&&!e[r].nonStackable?t.y0:0)||0}).attr("height",0).attr("width",function(t,n,r){return h.rangeBand()/(x&&!e[r].nonStackable?1:e.length)}).attr("transform",function(t,e){return"translate("+h(v(t,e))+",0)"});j.style("fill",function(t,e,n){return w(t,n,e)}).style("stroke",function(t,e,n){return w(t,n,e)}).on("mouseover",function(t,e){d3.select(this).classed("hover",!0),A.elementMouseover({data:t,index:e,color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1),A.elementMouseout({data:t,index:e,color:d3.select(this).style("fill")})}).on("mousemove",function(t,e){A.elementMousemove({data:t,index:e,color:d3.select(this).style("fill")})}).on("click",function(t,e){var n=this;A.elementClick({data:t,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n}),d3.event.stopPropagation()}).on("dblclick",function(t,e){A.elementDblClick({data:t,index:e,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),j.attr("class",function(t,e){return m(t,e)<0?"nv-bar negative":"nv-bar positive"}).attr("transform",function(t,e){return"translate("+h(v(t,e))+",0)"}),M&&(n||(n=e.map(function(){return!0})),j.style("fill",function(t,e,r){return d3.rgb(M(t,e)).darker(n.map(function(t,e){return e}).filter(function(t,e){return!n[e]})[r]).toString()}).style("stroke",function(t,e,r){return d3.rgb(M(t,e)).darker(n.map(function(t,e){return e}).filter(function(t,e){return!n[e]})[r]).toString()}));var V=j.watchTransition(E,"multibar",Math.min(250,C)).delay(function(t,n){return n*C/e[0].values.length});x?V.attr("y",function(t,n,r){var i=0;return i=e[r].nonStackable?m(t,n)<0?p(0):p(0)-p(m(t,n))<-1?p(0)-1:p(m(t,n))||0:p(t.y1)}).attr("height",function(t,n,r){return e[r].nonStackable?Math.max(Math.abs(p(m(t,n))-p(0)),0)||0:Math.max(Math.abs(p(t.y+t.y0)-p(t.y0)),0)}).attr("x",function(t,n,r){var i=0;return e[r].nonStackable&&(i=t.series*h.rangeBand()/e.length,e.length!==O&&(i=e[r].nonStackableSeries*h.rangeBand()/(2*O))),i}).attr("width",function(t,n,r){if(e[r].nonStackable){var i=h.rangeBand()/O;return e.length!==O&&(i=h.rangeBand()/(2*O)),i}return h.rangeBand()}):V.attr("x",function(t,n){return t.series*h.rangeBand()/e.length}).attr("width",h.rangeBand()/e.length).attr("y",function(t,e){return m(t,e)<0?p(0):p(0)-p(m(t,e))<1?p(0)-1:p(m(t,e))||0}).attr("height",function(t,e){return Math.max(Math.abs(p(m(t,e))-p(0)),1)||0}),s=h.copy(),l=p.copy(),e[0]&&e[0].values&&(T=e[0].values.length)}),E.renderEnd("multibar immediate"),e}var n,r,i,o,a,s,l,u={top:0,right:0,bottom:0,left:0},c=960,d=500,h=d3.scale.ordinal(),p=d3.scale.linear(),f=Math.floor(1e4*Math.random()),g=null,v=function(t){return t.x},m=function(t){return t.y},y=[0],b=!0,x=!1,_="zero",w=t.utils.defaultColor(),k=!1,M=null,C=500,S=.1,L=.75,A=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),E=t.utils.renderWatch(A,C),T=0;return e.dispatch=A,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return c},set:function(t){c=t}},height:{get:function(){return d},set:function(t){d=t}},x:{get:function(){return v},set:function(t){v=t}},y:{get:function(){return m},set:function(t){m=t}},xScale:{get:function(){return h},set:function(t){h=t}},yScale:{get:function(){return p},set:function(t){p=t}},xDomain:{get:function(){return r},set:function(t){r=t}},yDomain:{get:function(){return i},set:function(t){i=t}},xRange:{get:function(){return o},set:function(t){o=t}},yRange:{get:function(){return a},set:function(t){a=t}},forceY:{get:function(){return y},set:function(t){y=t}},stacked:{get:function(){return x},set:function(t){x=t}},stackOffset:{get:function(){return _},set:function(t){_=t}},clipEdge:{get:function(){return b},set:function(t){b=t}},disabled:{get:function(){return n},set:function(t){n=t}},id:{get:function(){return f},set:function(t){f=t}},hideable:{get:function(){return k},set:function(t){k=t}},groupSpacing:{get:function(){return S},set:function(t){S=t}},fillOpacity:{get:function(){return L},set:function(t){L=t}},margin:{get:function(){return u},set:function(t){u.top=void 0!==t.top?t.top:u.top,u.right=void 0!==t.right?t.right:u.right,u.bottom=void 0!==t.bottom?t.bottom:u.bottom,u.left=void 0!==t.left?t.left:u.left}},duration:{get:function(){return C},set:function(t){C=t,E.reset(C)}},color:{get:function(){return w},set:function(e){w=t.utils.getColor(e)}},barColor:{get:function(){return M},set:function(e){M=e?t.utils.getColor(e):null}}}),t.utils.initOptions(e),e},t.models.multiBarChart=function(){"use strict";function e(A){return O.reset(),O.models(i),b&&O.models(o),x&&O.models(a),A.each(function(A){var O=d3.select(this);t.utils.initSVG(O);var G=t.utils.availableWidth(p,O,d),W=t.utils.availableHeight(f,O,d);if(e.update=function(){0===P?O.call(e):O.transition().duration(P).call(e)},e.container=this,S.setter(z(A),e.update).getter(I(A)).update(),S.disabled=A.map(function(t){return!!t.disabled}),!L){var F;L={};for(F in S)S[F]instanceof Array?L[F]=S[F].slice(0):L[F]=S[F]}if(!(A&&A.length&&A.filter(function(t){return t.values.length}).length))return t.utils.noData(e,O),e;O.selectAll(".nv-noData").remove(),n=i.xScale(),r=i.yScale();var R=O.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([A]),B=R.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),H=R.select("g");if(B.append("g").attr("class","nv-x nv-axis"),B.append("g").attr("class","nv-y nv-axis"),B.append("g").attr("class","nv-barsWrap"),B.append("g").attr("class","nv-legendWrap"),B.append("g").attr("class","nv-controlsWrap"),B.append("g").attr("class","nv-interactive"),y?(l.width(G-T()),H.select(".nv-legendWrap").datum(A).call(l),h||l.height()===d.top||(d.top=l.height(),W=t.utils.availableHeight(f,O,d)),H.select(".nv-legendWrap").attr("transform","translate("+T()+","+-d.top+")")):H.select(".nv-legendWrap").selectAll("*").remove(),v){var j=[{key:m.grouped||"Grouped",disabled:i.stacked()},{key:m.stacked||"Stacked",disabled:!i.stacked()}];u.width(T()).color(["#444","#444","#444"]),H.select(".nv-controlsWrap").datum(j).attr("transform","translate(0,"+-d.top+")").call(u)}else H.select(".nv-controlsWrap").selectAll("*").remove();R.attr("transform","translate("+d.left+","+d.top+")"),_&&H.select(".nv-y.nv-axis").attr("transform","translate("+G+",0)"),i.disabled(A.map(function(t){return t.disabled})).width(G).height(W).color(A.map(function(t,e){return t.color||g(t,e)}).filter(function(t,e){return!A[e].disabled}));var V=H.select(".nv-barsWrap").datum(A.filter(function(t){return!t.disabled}));if(V.call(i),b){o.scale(n)._ticks(t.utils.calcTicksX(G/100,A)).tickSize(-W,0),H.select(".nv-x.nv-axis").attr("transform","translate(0,"+r.range()[0]+")"),H.select(".nv-x.nv-axis").call(o);var $=H.select(".nv-x.nv-axis > g").selectAll("g");if($.selectAll("line, text").style("opacity",1),k){var q=function(t,e){return"translate("+t+","+e+")"},U=5,X=17;$.selectAll("text").attr("transform",function(t,e,n){return q(0,n%2==0?U:X)});var Y=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;H.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(t,e){return q(0,0===e||Y%2!==0?X:U)})}M&&H.selectAll(".tick text").call(t.utils.wrapTicks,e.xAxis.rangeBand()),w&&$.filter(function(t,e){return e%Math.ceil(A[0].values.length/(G/100))!==0}).selectAll("text, line").style("opacity",0),C&&$.selectAll(".tick text").attr("transform","rotate("+C+" 0,0)").style("text-anchor",C>0?"start":"end"),H.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}x&&(a.scale(r)._ticks(t.utils.calcTicksY(W/36,A)).tickSize(-G,0),H.select(".nv-y.nv-axis").call(a)),D&&(s.width(G).height(W).margin({left:d.left,top:d.top}).svgContainer(O).xScale(n),R.select(".nv-interactive").call(s)),l.dispatch.on("stateChange",function(t){for(var n in t)S[n]=t[n];E.stateChange(S),e.update()}),u.dispatch.on("legendClick",function(t,n){if(t.disabled){switch(j=j.map(function(t){return t.disabled=!0,t}),t.disabled=!1,t.key){case"Grouped":case m.grouped:i.stacked(!1);break;case"Stacked":case m.stacked:i.stacked(!0)}S.stacked=i.stacked(),E.stateChange(S),e.update()}}),E.on("changeState",function(t){"undefined"!=typeof t.disabled&&(A.forEach(function(e,n){e.disabled=t.disabled[n]}),S.disabled=t.disabled),"undefined"!=typeof t.stacked&&(i.stacked(t.stacked),S.stacked=t.stacked,N=t.stacked),e.update()}),D?(s.dispatch.on("elementMousemove",function(t){if(void 0!=t.pointXValue){var r,i,o,a,l=[];A.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(s,u){i=n.domain().indexOf(t.pointXValue);var c=s.values[i];void 0!==c&&(a=c.x,void 0===r&&(r=c),void 0===o&&(o=t.mouseX),l.push({key:s.key,value:e.y()(c,i),color:g(s,s.seriesIndex),data:s.values[i]}))}),s.tooltip.data({value:a,index:i,series:l})(),s.renderGuideLine(o)}}),s.dispatch.on("elementMouseout",function(t){s.tooltip.hidden(!0)})):(i.dispatch.on("elementMouseover.tooltip",function(t){t.value=e.x()(t.data),t.series={key:t.data.key,value:e.y()(t.data),color:t.color},c.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){c.hidden(!0)}),i.dispatch.on("elementMousemove.tooltip",function(t){c()}))}),O.renderEnd("multibarchart immediate"),e}var n,r,i=t.models.multiBar(),o=t.models.axis(),a=t.models.axis(),s=t.interactiveGuideline(),l=t.models.legend(),u=t.models.legend(),c=t.models.tooltip(),d={top:30,right:20,bottom:50,left:60},h=null,p=null,f=null,g=t.utils.defaultColor(),v=!0,m={},y=!0,b=!0,x=!0,_=!1,w=!0,k=!1,M=!1,C=0,S=t.utils.state(),L=null,A=null,E=d3.dispatch("stateChange","changeState","renderEnd"),T=function(){return v?180:0},P=250,D=!1;S.stacked=!1,i.stacked(!1),o.orient("bottom").tickPadding(7).showMaxMin(!1).tickFormat(function(t){return t}),a.orient(_?"right":"left").tickFormat(d3.format(",.1f")),c.duration(0).valueFormatter(function(t,e){return a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),s.tooltip.valueFormatter(function(t,e){return null==t?"N/A":a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),s.tooltip.valueFormatter(function(t,e){return null==t?"N/A":a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),s.tooltip.duration(0).valueFormatter(function(t,e){return a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),u.updateState(!1);var O=t.utils.renderWatch(E),N=!1,I=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),stacked:N}}},z=function(t){return function(e){void 0!==e.stacked&&(N=e.stacked),void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};return e.dispatch=E,e.multibar=i,e.legend=l,e.controls=u,e.xAxis=o,e.yAxis=a,e.state=S,e.tooltip=c,e.interactiveLayer=s,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return p},set:function(t){p=t}},height:{get:function(){return f},set:function(t){f=t}},showLegend:{get:function(){return y},set:function(t){y=t}},showControls:{get:function(){return v},set:function(t){v=t}},controlLabels:{get:function(){return m},set:function(t){m=t}},showXAxis:{get:function(){return b},set:function(t){b=t}},showYAxis:{get:function(){return x},set:function(t){x=t}},defaultState:{get:function(){return L},set:function(t){L=t}},noData:{get:function(){return A},set:function(t){A=t}},reduceXTicks:{get:function(){return w},set:function(t){w=t}},rotateLabels:{get:function(){return C},set:function(t){C=t}},staggerLabels:{get:function(){return k},set:function(t){k=t}},wrapLabels:{get:function(){return M},set:function(t){M=!!t}},margin:{get:function(){return d},set:function(t){void 0!==t.top&&(d.top=t.top,h=t.top),d.right=void 0!==t.right?t.right:d.right,d.bottom=void 0!==t.bottom?t.bottom:d.bottom,d.left=void 0!==t.left?t.left:d.left}},duration:{get:function(){return P},set:function(t){P=t,i.duration(P),o.duration(P),a.duration(P),O.reset(P)}},color:{get:function(){return g},set:function(e){g=t.utils.getColor(e),l.color(g)}},rightAlignYAxis:{get:function(){return _},set:function(t){_=t,a.orient(_?"right":"left")}},useInteractiveGuideline:{get:function(){return D},set:function(t){D=t}},barColor:{get:function(){return i.barColor},set:function(t){i.barColor(t),l.color(function(t,e){return d3.rgb("#ccc").darker(1.5*e).toString()})}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.multiBarHorizontal=function(){"use strict";function e(h){return P.reset(),h.each(function(e){var h=c-u.left-u.right,E=d-u.top-u.bottom;p=d3.select(this),t.utils.initSVG(p),w&&(e=d3.layout.stack().offset("zero").values(function(t){return t.values}).y(m)(e)),e.forEach(function(t,e){t.values.forEach(function(n){n.series=e,n.key=t.key})}),w&&e[0].values.map(function(t,n){var r=0,i=0;e.map(function(t){var e=t.values[n];e.size=Math.abs(e.y),e.y<0?(e.y1=i-e.size,i-=e.size):(e.y1=r,r+=e.size)})});var D=r&&i?[]:e.map(function(t){return t.values.map(function(t,e){return{x:v(t,e),y:m(t,e),y0:t.y0,y1:t.y1}})});f.domain(r||d3.merge(D).map(function(t){return t.x})).rangeBands(o||[0,E],S),g.domain(i||d3.extent(d3.merge(D).map(function(t){return w?t.y>0?t.y1+t.y:t.y1:t.y}).concat(b))),k&&!w?g.range(a||[g.domain()[0]<0?C:0,h-(g.domain()[1]>0?C:0)]):g.range(a||[0,h]),s=s||f,l=l||d3.scale.linear().domain(g.domain()).range([g(0),g(0)]);var O=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([e]),N=O.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal"),I=(N.append("defs"),N.append("g"));O.select("g");I.append("g").attr("class","nv-groups"),O.attr("transform","translate("+u.left+","+u.top+")");var z=O.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t,e){return e});z.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),z.exit().watchTransition(P,"multibarhorizontal: exit groups").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),z.attr("class",function(t,e){return"nv-group nv-series-"+e}).classed("hover",function(t){return t.hover}).style("fill",function(t,e){return x(t,e)}).style("stroke",function(t,e){return x(t,e)}),z.watchTransition(P,"multibarhorizontal: groups").style("stroke-opacity",1).style("fill-opacity",L);var G=z.selectAll("g.nv-bar").data(function(t){return t.values});G.exit().remove();var W=G.enter().append("g").attr("transform",function(t,n,r){return"translate("+l(w?t.y0:0)+","+(w?0:r*f.rangeBand()/e.length+f(v(t,n)))+")"});W.append("rect").attr("width",0).attr("height",f.rangeBand()/(w?1:e.length)),G.on("mouseover",function(t,e){d3.select(this).classed("hover",!0),T.elementMouseover({data:t,index:e,color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1),T.elementMouseout({data:t,index:e,color:d3.select(this).style("fill")})}).on("mouseout",function(t,e){T.elementMouseout({data:t,index:e,color:d3.select(this).style("fill")})}).on("mousemove",function(t,e){T.elementMousemove({data:t,index:e,color:d3.select(this).style("fill")})}).on("click",function(t,e){var n=this;T.elementClick({data:t,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n}),d3.event.stopPropagation()}).on("dblclick",function(t,e){T.elementDblClick({data:t,index:e,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),y(e[0],0)&&(W.append("polyline"),G.select("polyline").attr("fill","none").attr("points",function(t,n){var r=y(t,n),i=.8*f.rangeBand()/(2*(w?1:e.length));r=r.length?r:[-Math.abs(r),Math.abs(r)],r=r.map(function(t){return g(t)-g(0)});var o=[[r[0],-i],[r[0],i],[r[0],0],[r[1],0],[r[1],-i],[r[1],i]];return o.map(function(t){return t.join(",")}).join(" ")}).attr("transform",function(t,n){var r=f.rangeBand()/(2*(w?1:e.length));return"translate("+(m(t,n)<0?0:g(m(t,n))-g(0))+", "+r+")"})),W.append("text"),k&&!w?(G.select("text").attr("text-anchor",function(t,e){return m(t,e)<0?"end":"start"}).attr("y",f.rangeBand()/(2*e.length)).attr("dy",".32em").text(function(t,e){var n=A(m(t,e)),r=y(t,e);return void 0===r?n:r.length?n+"+"+A(Math.abs(r[1]))+"-"+A(Math.abs(r[0])):n+""+A(Math.abs(r))}),G.watchTransition(P,"multibarhorizontal: bars").select("text").attr("x",function(t,e){return m(t,e)<0?-4:g(m(t,e))-g(0)+4})):G.selectAll("text").text(""),M&&!w?(W.append("text").classed("nv-bar-label",!0),G.select("text.nv-bar-label").attr("text-anchor",function(t,e){return m(t,e)<0?"start":"end"}).attr("y",f.rangeBand()/(2*e.length)).attr("dy",".32em").text(function(t,e){return v(t,e)}),G.watchTransition(P,"multibarhorizontal: bars").select("text.nv-bar-label").attr("x",function(t,e){return m(t,e)<0?g(0)-g(m(t,e))+4:-4})):G.selectAll("text.nv-bar-label").text(""),G.attr("class",function(t,e){return m(t,e)<0?"nv-bar negative":"nv-bar positive"}),_&&(n||(n=e.map(function(){return!0})),G.style("fill",function(t,e,r){return d3.rgb(_(t,e)).darker(n.map(function(t,e){return e}).filter(function(t,e){return!n[e]})[r]).toString()}).style("stroke",function(t,e,r){return d3.rgb(_(t,e)).darker(n.map(function(t,e){return e}).filter(function(t,e){return!n[e]})[r]).toString()})),w?G.watchTransition(P,"multibarhorizontal: bars").attr("transform",function(t,e){return"translate("+g(t.y1)+","+f(v(t,e))+")"}).select("rect").attr("width",function(t,e){return Math.abs(g(m(t,e)+t.y0)-g(t.y0))||0}).attr("height",f.rangeBand()):G.watchTransition(P,"multibarhorizontal: bars").attr("transform",function(t,n){return"translate("+g(m(t,n)<0?m(t,n):0)+","+(t.series*f.rangeBand()/e.length+f(v(t,n)))+")"}).select("rect").attr("height",f.rangeBand()/e.length).attr("width",function(t,e){return Math.max(Math.abs(g(m(t,e))-g(0)),1)||0}),s=f.copy(),l=g.copy()}),P.renderEnd("multibarHorizontal immediate"),e}var n,r,i,o,a,s,l,u={top:0,right:0,bottom:0,left:0},c=960,d=500,h=Math.floor(1e4*Math.random()),p=null,f=d3.scale.ordinal(),g=d3.scale.linear(),v=function(t){return t.x},m=function(t){return t.y},y=function(t){return t.yErr},b=[0],x=t.utils.defaultColor(),_=null,w=!1,k=!1,M=!1,C=60,S=.1,L=.75,A=d3.format(",.2f"),E=250,T=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),P=t.utils.renderWatch(T,E);return e.dispatch=T,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return c},set:function(t){c=t}},height:{get:function(){return d},set:function(t){d=t}},x:{get:function(){return v},set:function(t){v=t}},y:{get:function(){return m},set:function(t){m=t}},yErr:{get:function(){return y},set:function(t){y=t}},xScale:{get:function(){return f},set:function(t){f=t}},yScale:{get:function(){return g},set:function(t){g=t}},xDomain:{get:function(){return r},set:function(t){r=t}},yDomain:{get:function(){return i},set:function(t){i=t}},xRange:{get:function(){return o},set:function(t){o=t}},yRange:{get:function(){return a},set:function(t){a=t}},forceY:{get:function(){return b},set:function(t){b=t}},stacked:{get:function(){return w},set:function(t){w=t}},showValues:{get:function(){return k},set:function(t){k=t}},disabled:{get:function(){return n},set:function(t){n=t}},id:{get:function(){return h},set:function(t){h=t}},valueFormat:{get:function(){return A},set:function(t){A=t}},valuePadding:{get:function(){return C},set:function(t){C=t}},groupSpacing:{get:function(){return S},set:function(t){S=t}},fillOpacity:{get:function(){return L},set:function(t){L=t}},margin:{get:function(){return u},set:function(t){u.top=void 0!==t.top?t.top:u.top,u.right=void 0!==t.right?t.right:u.right,u.bottom=void 0!==t.bottom?t.bottom:u.bottom,u.left=void 0!==t.left?t.left:u.left}},duration:{get:function(){return E},set:function(t){E=t,P.reset(E)}},color:{get:function(){return x},set:function(e){x=t.utils.getColor(e)}},barColor:{get:function(){return _},set:function(e){_=e?t.utils.getColor(e):null}}}),t.utils.initOptions(e),e},t.models.multiBarHorizontalChart=function(){"use strict";function e(u){return E.reset(),E.models(i),y&&E.models(o),b&&E.models(a),u.each(function(u){var k=d3.select(this);t.utils.initSVG(k);var E=t.utils.availableWidth(h,k,c),T=t.utils.availableHeight(p,k,c);if(e.update=function(){k.transition().duration(S).call(e)},e.container=this,x=i.stacked(),_.setter(A(u),e.update).getter(L(u)).update(),_.disabled=u.map(function(t){return!!t.disabled}),!w){var P;w={};for(P in _)_[P]instanceof Array?w[P]=_[P].slice(0):w[P]=_[P]}if(!(u&&u.length&&u.filter(function(t){return t.values.length}).length))return t.utils.noData(e,k),e;k.selectAll(".nv-noData").remove(),n=i.xScale(),r=i.yScale().clamp(!0);var D=k.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([u]),O=D.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g"),N=D.select("g");if(O.append("g").attr("class","nv-x nv-axis"),O.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),O.append("g").attr("class","nv-barsWrap"),O.append("g").attr("class","nv-legendWrap"),O.append("g").attr("class","nv-controlsWrap"),m?(s.width(E-C()),N.select(".nv-legendWrap").datum(u).call(s),d||s.height()===c.top||(c.top=s.height(),T=t.utils.availableHeight(p,k,c)),N.select(".nv-legendWrap").attr("transform","translate("+C()+","+-c.top+")")):N.select(".nv-legendWrap").selectAll("*").remove(),g){var I=[{key:v.grouped||"Grouped",disabled:i.stacked()},{key:v.stacked||"Stacked",disabled:!i.stacked()}];l.width(C()).color(["#444","#444","#444"]),N.select(".nv-controlsWrap").datum(I).attr("transform","translate(0,"+-c.top+")").call(l)}else N.select(".nv-controlsWrap").selectAll("*").remove();D.attr("transform","translate("+c.left+","+c.top+")"),i.disabled(u.map(function(t){return t.disabled})).width(E).height(T).color(u.map(function(t,e){return t.color||f(t,e)}).filter(function(t,e){return!u[e].disabled}));var z=N.select(".nv-barsWrap").datum(u.filter(function(t){return!t.disabled}));if(z.transition().call(i),y){o.scale(n)._ticks(t.utils.calcTicksY(T/24,u)).tickSize(-E,0),N.select(".nv-x.nv-axis").call(o);var G=N.select(".nv-x.nv-axis").selectAll("g");G.selectAll("line, text")}b&&(a.scale(r)._ticks(t.utils.calcTicksX(E/100,u)).tickSize(-T,0),N.select(".nv-y.nv-axis").attr("transform","translate(0,"+T+")"),N.select(".nv-y.nv-axis").call(a)),N.select(".nv-zeroLine line").attr("x1",r(0)).attr("x2",r(0)).attr("y1",0).attr("y2",-T),s.dispatch.on("stateChange",function(t){for(var n in t)_[n]=t[n];M.stateChange(_),e.update()}),l.dispatch.on("legendClick",function(t,n){if(t.disabled){switch(I=I.map(function(t){return t.disabled=!0,t}),t.disabled=!1,t.key){case"Grouped":case v.grouped:i.stacked(!1);break;case"Stacked":case v.stacked:i.stacked(!0)}_.stacked=i.stacked(),M.stateChange(_),x=i.stacked(),e.update()}}),M.on("changeState",function(t){"undefined"!=typeof t.disabled&&(u.forEach(function(e,n){e.disabled=t.disabled[n]}),_.disabled=t.disabled),"undefined"!=typeof t.stacked&&(i.stacked(t.stacked),_.stacked=t.stacked,x=t.stacked),e.update()})}),E.renderEnd("multibar horizontal chart immediate"),e}var n,r,i=t.models.multiBarHorizontal(),o=t.models.axis(),a=t.models.axis(),s=t.models.legend().height(30),l=t.models.legend().height(30),u=t.models.tooltip(),c={top:30,right:20,bottom:50,left:60},d=null,h=null,p=null,f=t.utils.defaultColor(),g=!0,v={},m=!0,y=!0,b=!0,x=!1,_=t.utils.state(),w=null,k=null,M=d3.dispatch("stateChange","changeState","renderEnd"),C=function(){return g?180:0},S=250;_.stacked=!1,i.stacked(x),o.orient("left").tickPadding(5).showMaxMin(!1).tickFormat(function(t){return t}),a.orient("bottom").tickFormat(d3.format(",.1f")),u.duration(0).valueFormatter(function(t,e){return a.tickFormat()(t,e)}).headerFormatter(function(t,e){return o.tickFormat()(t,e)}),l.updateState(!1);var L=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),stacked:x}}},A=function(t){return function(e){void 0!==e.stacked&&(x=e.stacked),void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}},E=t.utils.renderWatch(M,S);return i.dispatch.on("elementMouseover.tooltip",function(t){t.value=e.x()(t.data),t.series={key:t.data.key,value:e.y()(t.data),color:t.color},u.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){u.hidden(!0)}),i.dispatch.on("elementMousemove.tooltip",function(t){u()}),e.dispatch=M,e.multibar=i,e.legend=s,e.controls=l,e.xAxis=o,e.yAxis=a,e.state=_,e.tooltip=u,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return h},set:function(t){h=t}},height:{get:function(){return p},set:function(t){p=t}},showLegend:{get:function(){return m},set:function(t){m=t}},showControls:{get:function(){return g},set:function(t){g=t}},controlLabels:{get:function(){return v},set:function(t){v=t}},showXAxis:{get:function(){return y},set:function(t){y=t}},showYAxis:{get:function(){return b},set:function(t){b=t}},defaultState:{get:function(){return w},set:function(t){w=t}},noData:{get:function(){return k},set:function(t){k=t}},margin:{get:function(){return c},set:function(t){void 0!==t.top&&(c.top=t.top,d=t.top),c.right=void 0!==t.right?t.right:c.right,c.bottom=void 0!==t.bottom?t.bottom:c.bottom,c.left=void 0!==t.left?t.left:c.left}},duration:{get:function(){return S},set:function(t){S=t,E.reset(S),i.duration(S),o.duration(S),a.duration(S)}},color:{get:function(){return f},set:function(e){f=t.utils.getColor(e),s.color(f)}},barColor:{get:function(){return i.barColor},set:function(t){i.barColor(t),s.color(function(t,e){return d3.rgb("#ccc").darker(1.5*e).toString()})}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.multiChart=function(){"use strict";function e(c){return c.each(function(c){function f(t){var e=2===c[t.seriesIndex].yAxis?D:P;t.value=t.point.x,t.series={value:t.point.y,color:t.point.color,key:t.series.key},N.duration(0).headerFormatter(function(t,e){return T.tickFormat()(t,e)}).valueFormatter(function(t,n){return e.tickFormat()(t,n)}).data(t).hidden(!1)}function y(t){var e=2===c[t.seriesIndex].yAxis?D:P;t.value=t.point.x,t.series={value:t.point.y,color:t.point.color,key:t.series.key},N.duration(100).headerFormatter(function(t,e){return T.tickFormat()(t,e)}).valueFormatter(function(t,n){return e.tickFormat()(t,n)}).data(t).hidden(!1)}function I(t){var e=2===c[t.seriesIndex].yAxis?D:P;t.point.x=A.x()(t.point),t.point.y=A.y()(t.point),N.duration(0).headerFormatter(function(t,e){return T.tickFormat()(t,e)}).valueFormatter(function(t,n){return e.tickFormat()(t,n)}).data(t).hidden(!1)}function G(t){var e=2===c[t.data.series].yAxis?D:P;t.value=S.x()(t.data),t.series={value:S.y()(t.data),color:t.color,key:t.data.key},N.duration(0).headerFormatter(function(t,e){return T.tickFormat()(t,e)}).valueFormatter(function(t,n){return e.tickFormat()(t,n)}).data(t).hidden(!1)}function W(){for(var t=0,e=z.length;t<e;t++){var n=z[t];try{n.clearHighlights()}catch(t){}}}function F(t,e,n){for(var r=0,i=z.length;r<i;r++){var o=z[r];try{o.highlightPoint(t,e,n)}catch(t){}}}var R=d3.select(this);t.utils.initSVG(R),e.update=function(){R.transition().call(e)},e.container=this;var B=t.utils.availableWidth(s,R,i),H=t.utils.availableHeight(l,R,i),j=c.filter(function(t){return"line"==t.type&&1==t.yAxis}),V=c.filter(function(t){return"line"==t.type&&2==t.yAxis}),$=c.filter(function(t){return"scatter"==t.type&&1==t.yAxis}),q=c.filter(function(t){return"scatter"==t.type&&2==t.yAxis}),U=c.filter(function(t){return"bar"==t.type&&1==t.yAxis}),X=c.filter(function(t){return"bar"==t.type&&2==t.yAxis}),Y=c.filter(function(t){return"area"==t.type&&1==t.yAxis}),K=c.filter(function(t){return"area"==t.type&&2==t.yAxis});if(!(c&&c.length&&c.filter(function(t){return t.values.length}).length))return t.utils.noData(e,R),e;R.selectAll(".nv-noData").remove();var Z=c.filter(function(t){return!t.disabled&&1==t.yAxis}).map(function(t){return t.values.map(function(t,e){return{x:d(t),y:h(t)}})}),Q=c.filter(function(t){return!t.disabled&&2==t.yAxis}).map(function(t){return t.values.map(function(t,e){return{x:d(t),y:h(t)}})});b.domain(d3.extent(d3.merge(Z.concat(Q)),function(t){return t.x})).range([0,B]);var J=R.selectAll("g.wrap.multiChart").data([c]),tt=J.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");tt.append("g").attr("class","nv-x nv-axis"),tt.append("g").attr("class","nv-y1 nv-axis"),tt.append("g").attr("class","nv-y2 nv-axis"),tt.append("g").attr("class","stack1Wrap"),tt.append("g").attr("class","stack2Wrap"),tt.append("g").attr("class","bars1Wrap"),tt.append("g").attr("class","bars2Wrap"),tt.append("g").attr("class","scatters1Wrap"),tt.append("g").attr("class","scatters2Wrap"),tt.append("g").attr("class","lines1Wrap"),tt.append("g").attr("class","lines2Wrap"),tt.append("g").attr("class","legendWrap"),tt.append("g").attr("class","nv-interactive");var et=J.select("g"),nt=c.map(function(t,e){return c[e].color||a(t,e)});if(u){var rt=O.align()?B/2:B,it=O.align()?rt:0;O.width(rt),O.color(nt),et.select(".legendWrap").datum(c.map(function(t){return t.originalKey=void 0===t.originalKey?t.key:t.originalKey,t.key=t.originalKey+(1==t.yAxis?"":m),t})).call(O),
o||O.height()===i.top||(i.top=O.height(),H=t.utils.availableHeight(l,R,i)),et.select(".legendWrap").attr("transform","translate("+it+","+-i.top+")")}else et.select(".legendWrap").selectAll("*").remove();w.width(B).height(H).interpolate(p).color(nt.filter(function(t,e){return!c[e].disabled&&1==c[e].yAxis&&"line"==c[e].type})),k.width(B).height(H).interpolate(p).color(nt.filter(function(t,e){return!c[e].disabled&&2==c[e].yAxis&&"line"==c[e].type})),M.width(B).height(H).color(nt.filter(function(t,e){return!c[e].disabled&&1==c[e].yAxis&&"scatter"==c[e].type})),C.width(B).height(H).color(nt.filter(function(t,e){return!c[e].disabled&&2==c[e].yAxis&&"scatter"==c[e].type})),S.width(B).height(H).color(nt.filter(function(t,e){return!c[e].disabled&&1==c[e].yAxis&&"bar"==c[e].type})),L.width(B).height(H).color(nt.filter(function(t,e){return!c[e].disabled&&2==c[e].yAxis&&"bar"==c[e].type})),A.width(B).height(H).interpolate(p).color(nt.filter(function(t,e){return!c[e].disabled&&1==c[e].yAxis&&"area"==c[e].type})),E.width(B).height(H).interpolate(p).color(nt.filter(function(t,e){return!c[e].disabled&&2==c[e].yAxis&&"area"==c[e].type})),et.attr("transform","translate("+i.left+","+i.top+")");var ot=et.select(".lines1Wrap").datum(j.filter(function(t){return!t.disabled})),at=et.select(".scatters1Wrap").datum($.filter(function(t){return!t.disabled})),st=et.select(".bars1Wrap").datum(U.filter(function(t){return!t.disabled})),lt=et.select(".stack1Wrap").datum(Y.filter(function(t){return!t.disabled})),ut=et.select(".lines2Wrap").datum(V.filter(function(t){return!t.disabled})),ct=et.select(".scatters2Wrap").datum(q.filter(function(t){return!t.disabled})),dt=et.select(".bars2Wrap").datum(X.filter(function(t){return!t.disabled})),ht=et.select(".stack2Wrap").datum(K.filter(function(t){return!t.disabled})),pt=Y.length?Y.map(function(t){return t.values}).reduce(function(t,e){return t.map(function(t,n){return{x:t.x,y:t.y+e[n].y}})}).concat([{x:0,y:0}]):[],ft=K.length?K.map(function(t){return t.values}).reduce(function(t,e){return t.map(function(t,n){return{x:t.x,y:t.y+e[n].y}})}).concat([{x:0,y:0}]):[];x.domain(n||d3.extent(d3.merge(Z).concat(pt),function(t){return t.y})).range([0,H]),_.domain(r||d3.extent(d3.merge(Q).concat(ft),function(t){return t.y})).range([0,H]),w.yDomain(x.domain()),M.yDomain(x.domain()),S.yDomain(x.domain()),A.yDomain(x.domain()),k.yDomain(_.domain()),C.yDomain(_.domain()),L.yDomain(_.domain()),E.yDomain(_.domain()),Y.length&&d3.transition(lt).call(A),K.length&&d3.transition(ht).call(E),U.length&&d3.transition(st).call(S),X.length&&d3.transition(dt).call(L),j.length&&d3.transition(ot).call(w),V.length&&d3.transition(ut).call(k),$.length&&d3.transition(at).call(M),q.length&&d3.transition(ct).call(C),T._ticks(t.utils.calcTicksX(B/100,c)).tickSize(-H,0),et.select(".nv-x.nv-axis").attr("transform","translate(0,"+H+")"),d3.transition(et.select(".nv-x.nv-axis")).call(T),P._ticks(t.utils.calcTicksY(H/36,c)).tickSize(-B,0),d3.transition(et.select(".nv-y1.nv-axis")).call(P),D._ticks(t.utils.calcTicksY(H/36,c)).tickSize(-B,0),d3.transition(et.select(".nv-y2.nv-axis")).call(D),et.select(".nv-y1.nv-axis").classed("nv-disabled",!Z.length).attr("transform","translate("+b.range()[0]+",0)"),et.select(".nv-y2.nv-axis").classed("nv-disabled",!Q.length).attr("transform","translate("+b.range()[1]+",0)"),O.dispatch.on("stateChange",function(t){e.update()}),v&&(g.width(B).height(H).margin({left:i.left,top:i.top}).svgContainer(R).xScale(b),J.select(".nv-interactive").call(g)),v?(g.dispatch.on("elementMousemove",function(n){W();var r,i,o,s=[];c.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(l,u){var c=b.domain(),d=l.values.filter(function(t,n){return e.x()(t,n)>=c[0]&&e.x()(t,n)<=c[1]});i=t.interactiveBisect(d,n.pointXValue,e.x());var h=d[i],p=e.y()(h,i);null!==p&&F(u,i,!0),void 0!==h&&(void 0===r&&(r=h),void 0===o&&(o=b(e.x()(h,i))),s.push({key:l.key,value:p,color:a(l,l.seriesIndex),data:h,yAxis:2==l.yAxis?D:P}))});var l=function(t,e){var n=s[e].yAxis;return null==t?"N/A":n.tickFormat()(t)};g.tooltip.headerFormatter(function(t,e){return T.tickFormat()(t,e)}).valueFormatter(g.tooltip.valueFormatter()||l).data({value:e.x()(r,i),index:i,series:s})(),g.renderGuideLine(o)}),g.dispatch.on("elementMouseout",function(t){W()})):(w.dispatch.on("elementMouseover.tooltip",f),k.dispatch.on("elementMouseover.tooltip",f),w.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),k.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),M.dispatch.on("elementMouseover.tooltip",y),C.dispatch.on("elementMouseover.tooltip",y),M.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),C.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),A.dispatch.on("elementMouseover.tooltip",I),E.dispatch.on("elementMouseover.tooltip",I),A.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),E.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),S.dispatch.on("elementMouseover.tooltip",G),L.dispatch.on("elementMouseover.tooltip",G),S.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),L.dispatch.on("elementMouseout.tooltip",function(t){N.hidden(!0)}),S.dispatch.on("elementMousemove.tooltip",function(t){N()}),L.dispatch.on("elementMousemove.tooltip",function(t){N()}))}),e}var n,r,i={top:30,right:20,bottom:50,left:60},o=null,a=t.utils.defaultColor(),s=null,l=null,u=!0,c=null,d=function(t){return t.x},h=function(t){return t.y},p="linear",f=!0,g=t.interactiveGuideline(),v=!1,m=" (right axis)",y=250,b=d3.scale.linear(),x=d3.scale.linear(),_=d3.scale.linear(),w=t.models.line().yScale(x).duration(y),k=t.models.line().yScale(_).duration(y),M=t.models.scatter().yScale(x).duration(y),C=t.models.scatter().yScale(_).duration(y),S=t.models.multiBar().stacked(!1).yScale(x).duration(y),L=t.models.multiBar().stacked(!1).yScale(_).duration(y),A=t.models.stackedArea().yScale(x).duration(y),E=t.models.stackedArea().yScale(_).duration(y),T=t.models.axis().scale(b).orient("bottom").tickPadding(5).duration(y),P=t.models.axis().scale(x).orient("left").duration(y),D=t.models.axis().scale(_).orient("right").duration(y),O=t.models.legend().height(30),N=t.models.tooltip(),I=d3.dispatch(),z=[w,k,M,C,S,L,A,E];return e.dispatch=I,e.legend=O,e.lines1=w,e.lines2=k,e.scatters1=M,e.scatters2=C,e.bars1=S,e.bars2=L,e.stack1=A,e.stack2=E,e.xAxis=T,e.yAxis1=P,e.yAxis2=D,e.tooltip=N,e.interactiveLayer=g,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},showLegend:{get:function(){return u},set:function(t){u=t}},yDomain1:{get:function(){return n},set:function(t){n=t}},yDomain2:{get:function(){return r},set:function(t){r=t}},noData:{get:function(){return c},set:function(t){c=t}},interpolate:{get:function(){return p},set:function(t){p=t}},legendRightAxisHint:{get:function(){return m},set:function(t){m=t}},margin:{get:function(){return i},set:function(t){void 0!==t.top&&(i.top=t.top,o=t.top),i.right=void 0!==t.right?t.right:i.right,i.bottom=void 0!==t.bottom?t.bottom:i.bottom,i.left=void 0!==t.left?t.left:i.left}},color:{get:function(){return a},set:function(e){a=t.utils.getColor(e)}},x:{get:function(){return d},set:function(t){d=t,w.x(t),k.x(t),M.x(t),C.x(t),S.x(t),L.x(t),A.x(t),E.x(t)}},y:{get:function(){return h},set:function(t){h=t,w.y(t),k.y(t),M.y(t),C.y(t),A.y(t),E.y(t),S.y(t),L.y(t)}},useVoronoi:{get:function(){return f},set:function(t){f=t,w.useVoronoi(t),k.useVoronoi(t),A.useVoronoi(t),E.useVoronoi(t)}},useInteractiveGuideline:{get:function(){return v},set:function(t){v=t,v&&(w.interactive(!1),w.useVoronoi(!1),k.interactive(!1),k.useVoronoi(!1),A.interactive(!1),A.useVoronoi(!1),E.interactive(!1),E.useVoronoi(!1),M.interactive(!1),C.interactive(!1))}},duration:{get:function(){return y},set:function(t){y=t,[w,k,A,E,M,C,T,P,D].forEach(function(t){t.duration(y)})}}}),t.utils.initOptions(e),e},t.models.ohlcBar=function(){"use strict";function e(M){return M.each(function(e){c=d3.select(this);var M=t.utils.availableWidth(s,c,a),S=t.utils.availableHeight(l,c,a);t.utils.initSVG(c);var L=M/e[0].values.length*.9;d.domain(n||d3.extent(e[0].values.map(p).concat(b))),_?d.range(i||[.5*M/e[0].values.length,M*(e[0].values.length-.5)/e[0].values.length]):d.range(i||[5+L/2,M-L/2-5]),h.domain(r||[d3.min(e[0].values.map(y).concat(x)),d3.max(e[0].values.map(m).concat(x))]).range(o||[S,0]),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]-.01*d.domain()[0],d.domain()[1]+.01*d.domain()[1]]):d.domain([-1,1])),h.domain()[0]===h.domain()[1]&&(h.domain()[0]?h.domain([h.domain()[0]+.01*h.domain()[0],h.domain()[1]-.01*h.domain()[1]]):h.domain([-1,1]));var A=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([e[0].values]),E=A.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar"),T=E.append("defs"),P=E.append("g"),D=A.select("g");P.append("g").attr("class","nv-ticks"),A.attr("transform","translate("+a.left+","+a.top+")"),c.on("click",function(t,e){C.chartClick({data:t,index:e,pos:d3.event,id:u})}),T.append("clipPath").attr("id","nv-chart-clip-path-"+u).append("rect"),A.select("#nv-chart-clip-path-"+u+" rect").attr("width",M).attr("height",S),D.attr("clip-path",w?"url(#nv-chart-clip-path-"+u+")":"");var O=A.select(".nv-ticks").selectAll(".nv-tick").data(function(t){return t});O.exit().remove(),O.enter().append("path").attr("class",function(t,e,n){return(g(t,e)>v(t,e)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+n+"-"+e}).attr("d",function(t,e){return"m0,0l0,"+(h(g(t,e))-h(m(t,e)))+"l"+-L/2+",0l"+L/2+",0l0,"+(h(y(t,e))-h(g(t,e)))+"l0,"+(h(v(t,e))-h(y(t,e)))+"l"+L/2+",0l"+-L/2+",0z"}).attr("transform",function(t,e){return"translate("+d(p(t,e))+","+h(m(t,e))+")"}).attr("fill",function(t,e){return k[0]}).attr("stroke",function(t,e){return k[0]}).attr("x",0).attr("y",function(t,e){return h(Math.max(0,f(t,e)))}).attr("height",function(t,e){return Math.abs(h(f(t,e))-h(0))}),O.attr("class",function(t,e,n){return(g(t,e)>v(t,e)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+n+"-"+e}),d3.transition(O).attr("transform",function(t,e){return"translate("+d(p(t,e))+","+h(m(t,e))+")"}).attr("d",function(t,n){var r=M/e[0].values.length*.9;return"m0,0l0,"+(h(g(t,n))-h(m(t,n)))+"l"+-r/2+",0l"+r/2+",0l0,"+(h(y(t,n))-h(g(t,n)))+"l0,"+(h(v(t,n))-h(y(t,n)))+"l"+r/2+",0l"+-r/2+",0z"})}),e}var n,r,i,o,a={top:0,right:0,bottom:0,left:0},s=null,l=null,u=Math.floor(1e4*Math.random()),c=null,d=d3.scale.linear(),h=d3.scale.linear(),p=function(t){return t.x},f=function(t){return t.y},g=function(t){return t.open},v=function(t){return t.close},m=function(t){return t.high},y=function(t){return t.low},b=[],x=[],_=!1,w=!0,k=t.utils.defaultColor(),M=!1,C=d3.dispatch("stateChange","changeState","renderEnd","chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");return e.highlightPoint=function(t,n){e.clearHighlights(),c.select(".nv-ohlcBar .nv-tick-0-"+t).classed("hover",n)},e.clearHighlights=function(){c.select(".nv-ohlcBar .nv-tick.hover").classed("hover",!1)},e.dispatch=C,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},xScale:{get:function(){return d},set:function(t){d=t}},yScale:{get:function(){return h},set:function(t){h=t}},xDomain:{get:function(){return n},set:function(t){n=t}},yDomain:{get:function(){return r},set:function(t){r=t}},xRange:{get:function(){return i},set:function(t){i=t}},yRange:{get:function(){return o},set:function(t){o=t}},forceX:{get:function(){return b},set:function(t){b=t}},forceY:{get:function(){return x},set:function(t){x=t}},padData:{get:function(){return _},set:function(t){_=t}},clipEdge:{get:function(){return w},set:function(t){w=t}},id:{get:function(){return u},set:function(t){u=t}},interactive:{get:function(){return M},set:function(t){M=t}},x:{get:function(){return p},set:function(t){p=t}},y:{get:function(){return f},set:function(t){f=t}},open:{get:function(){return g()},set:function(t){g=t}},close:{get:function(){return v()},set:function(t){v=t}},high:{get:function(){return m},set:function(t){m=t}},low:{get:function(){return y},set:function(t){y=t}},margin:{get:function(){return a},set:function(t){a.top=void 0!=t.top?t.top:a.top,a.right=void 0!=t.right?t.right:a.right,a.bottom=void 0!=t.bottom?t.bottom:a.bottom,a.left=void 0!=t.left?t.left:a.left}},color:{get:function(){return k},set:function(e){k=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.parallelCoordinates=function(){"use strict";function e(L){return S.reset(),L.each(function(e){function S(t){return k(f.map(function(e){if(isNaN(t.values[e.key])||isNaN(parseFloat(t.values[e.key]))||R){var n=d[e.key].domain(),r=d[e.key].range(),i=n[0]-(n[1]-n[0])/9;if(_.indexOf(e.key)<0){var o=d3.scale.linear().domain([i,n[1]]).range([u-12,r[1]]);d[e.key].brush.y(o),_.push(e.key)}if(isNaN(t.values[e.key])||isNaN(parseFloat(t.values[e.key])))return[c(e.key),d[e.key](i)]}return void 0!==q&&(_.length>0||R?(q.style("display","inline"),U.style("display","inline")):(q.style("display","none"),U.style("display","none"))),[c(e.key),d[e.key](t.values[e.key])]}))}function L(t){y.forEach(function(e){var n=d[e.dimension].brush.y().domain();e.hasOnlyNaN&&(e.extent[1]=(d[e.dimension].domain()[1]-n[0])*(e.extent[1]-e.extent[0])/(F[e.dimension]-e.extent[0])+n[0]),e.hasNaN&&(e.extent[0]=n[0]),t&&d[e.dimension].brush.extent(e.extent)}),i.select(".nv-brushBackground").each(function(t){d3.select(this).call(d[t.key].brush)}).selectAll("rect").attr("x",-8).attr("width",16),P()}function A(){v===!1&&(v=!0,L(!0))}function E(){Q=g.filter(function(t){return!d[t].brush.empty()}),J=Q.map(function(t){return d[t].brush.extent()}),y=[],Q.forEach(function(t,e){y[e]={dimension:t,extent:J[e],hasNaN:!1,hasOnlyNaN:!1}}),b=[],n.style("display",function(t){var e=Q.every(function(e,n){return!(!isNaN(t.values[e])&&!isNaN(parseFloat(t.values[e]))||J[n][0]!=d[e].brush.y().domain()[0])||J[n][0]<=t.values[e]&&t.values[e]<=J[n][1]&&!isNaN(parseFloat(t.values[e]))});return e&&b.push(t),e?null:"none"}),P(),C.brush({filters:y,active:b})}function T(){var t=Q.length>0;y.forEach(function(t){t.extent[0]===d[t.dimension].brush.y().domain()[0]&&_.indexOf(t.dimension)>=0&&(t.hasNaN=!0),t.extent[1]<d[t.dimension].domain()[0]&&(t.hasOnlyNaN=!0)}),C.brushEnd(b,t)}function P(){i.select(".nv-axis").each(function(t,e){var n=y.filter(function(e){return e.dimension==t.key});B[t.key]=d[t.key].domain(),0!=n.length&&v&&(B[t.key]=[],n[0].extent[1]>d[t.key].domain()[0]&&(B[t.key]=[n[0].extent[1]]),n[0].extent[0]>=d[t.key].domain()[0]&&B[t.key].push(n[0].extent[0])),d3.select(this).call(M.scale(d[t.key]).tickFormat(t.format).tickValues(B[t.key]))})}function D(t){x[t.key]=this.parentNode.__origin__=c(t.key),r.attr("visibility","hidden")}function O(t){x[t.key]=Math.min(l,Math.max(0,this.parentNode.__origin__+=d3.event.x)),n.attr("d",S),f.sort(function(t,e){return I(t.key)-I(e.key)}),f.forEach(function(t,e){return t.currentPosition=e}),c.domain(f.map(function(t){return t.key})),i.attr("transform",function(t){return"translate("+I(t.key)+")"})}function N(t,e){delete this.parentNode.__origin__,delete x[t.key],d3.select(this.parentNode).attr("transform","translate("+c(t.key)+")"),n.attr("d",S),r.attr("d",S).attr("visibility",null),C.dimensionsOrder(f)}function I(t){var e=x[t];return null==e?c(t):e}var z=d3.select(this);if(l=t.utils.availableWidth(a,z,o),u=t.utils.availableHeight(s,z,o),t.utils.initSVG(z),void 0===e[0].values){var G=[];e.forEach(function(t){var e={},n=Object.keys(t);n.forEach(function(n){"name"!==n&&(e[n]=t[n])}),G.push({key:t.name,values:e})}),e=G}var W=e.map(function(t){return t.values});0===b.length&&(b=e),g=p.sort(function(t,e){return t.currentPosition-e.currentPosition}).map(function(t){return t.key}),f=p.filter(function(t){return!t.disabled}),c.rangePoints([0,l],1).domain(f.map(function(t){return t.key}));var F={},R=!1,B=[];g.forEach(function(t){var e=d3.extent(W,function(e){return+e[t]}),n=e[0],r=e[1],i=!1;(isNaN(n)||isNaN(r))&&(i=!0,n=0,r=0),n===r&&(n-=1,r+=1);var o=y.filter(function(e){return e.dimension==t});0!==o.length&&(i?(n=d[t].domain()[0],r=d[t].domain()[1]):!o[0].hasOnlyNaN&&v?(n=n>o[0].extent[0]?o[0].extent[0]:n,r=r<o[0].extent[1]?o[0].extent[1]:r):o[0].hasNaN&&(r=r<o[0].extent[1]?o[0].extent[1]:r,F[t]=d[t].domain()[1],R=!0)),d[t]=d3.scale.linear().domain([n,r]).range([.9*(u-12),0]),_=[],d[t].brush=d3.svg.brush().y(d[t]).on("brushstart",A).on("brush",E).on("brushend",T)});var H=z.selectAll("g.nv-wrap.nv-parallelCoordinates").data([e]),j=H.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinates"),V=j.append("g"),$=H.select("g");V.append("g").attr("class","nv-parallelCoordinates background"),V.append("g").attr("class","nv-parallelCoordinates foreground"),V.append("g").attr("class","nv-parallelCoordinates missingValuesline"),H.attr("transform","translate("+o.left+","+o.top+")"),k.interpolate("cardinal").tension(w),M.orient("left");var q,U,X=d3.behavior.drag().on("dragstart",D).on("drag",O).on("dragend",N),Y=c.range()[1]-c.range()[0];if(Y=isNaN(Y)?c.range()[0]:Y,!isNaN(Y)){var K=[0+Y/2,u-12,l-Y/2,u-12];q=H.select(".missingValuesline").selectAll("line").data([K]),q.enter().append("line"),q.exit().remove(),q.attr("x1",function(t){return t[0]}).attr("y1",function(t){return t[1]}).attr("x2",function(t){return t[2]}).attr("y2",function(t){return t[3]}),U=H.select(".missingValuesline").selectAll("text").data([h]),U.append("text").data([h]),U.enter().append("text"),U.exit().remove(),U.attr("y",u).attr("x",l-92-Y/2).text(function(t){return t})}r=H.select(".background").selectAll("path").data(e),r.enter().append("path"),r.exit().remove(),r.attr("d",S),n=H.select(".foreground").selectAll("path").data(e),n.enter().append("path"),n.exit().remove(),n.attr("d",S).style("stroke-width",function(t,e){return isNaN(t.strokeWidth)&&(t.strokeWidth=1),t.strokeWidth}).attr("stroke",function(t,e){return t.color||m(t,e)}),n.on("mouseover",function(t,e){d3.select(this).classed("hover",!0).style("stroke-width",t.strokeWidth+2+"px").style("stroke-opacity",1),C.elementMouseover({label:t.name,color:t.color||m(t,e),values:t.values,dimensions:f})}),n.on("mouseout",function(t,e){d3.select(this).classed("hover",!1).style("stroke-width",t.strokeWidth+"px").style("stroke-opacity",.7),C.elementMouseout({label:t.name,index:e})}),n.on("mousemove",function(t,e){C.elementMousemove()}),n.on("click",function(t){C.elementClick({id:t.id})}),i=$.selectAll(".dimension").data(f);var Z=i.enter().append("g").attr("class","nv-parallelCoordinates dimension");i.attr("transform",function(t){return"translate("+c(t.key)+",0)"}),Z.append("g").attr("class","nv-axis"),Z.append("text").attr("class","nv-label").style("cursor","move").attr("dy","-1em").attr("text-anchor","middle").on("mouseover",function(t,e){C.elementMouseover({label:t.tooltip||t.key,color:t.color})}).on("mouseout",function(t,e){C.elementMouseout({label:t.tooltip})}).on("mousemove",function(t,e){C.elementMousemove()}).call(X),Z.append("g").attr("class","nv-brushBackground"),i.exit().remove(),i.select(".nv-label").text(function(t){return t.key}),L(v);var Q=g.filter(function(t){return!d[t].brush.empty()}),J=Q.map(function(t){return d[t].brush.extent()}),tt=b.slice(0);b=[],n.style("display",function(t){var e=Q.every(function(e,n){return!(!isNaN(t.values[e])&&!isNaN(parseFloat(t.values[e]))||J[n][0]!=d[e].brush.y().domain()[0])||J[n][0]<=t.values[e]&&t.values[e]<=J[n][1]&&!isNaN(parseFloat(t.values[e]))});return e&&b.push(t),e?null:"none"}),(y.length>0||!t.utils.arrayEquals(b,tt))&&C.activeChanged(b)}),e}var n,r,i,o={top:30,right:0,bottom:10,left:0},a=null,s=null,l=null,u=null,c=d3.scale.ordinal(),d={},h="undefined values",p=[],f=[],g=[],v=!0,m=t.utils.defaultColor(),y=[],b=[],x=[],_=[],w=1,k=d3.svg.line(),M=d3.svg.axis(),C=d3.dispatch("brushstart","brush","brushEnd","dimensionsOrder","stateChange","elementClick","elementMouseover","elementMouseout","elementMousemove","renderEnd","activeChanged"),S=t.utils.renderWatch(C);return e.dispatch=C,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return a},set:function(t){a=t}},height:{get:function(){return s},set:function(t){s=t}},dimensionData:{get:function(){return p},set:function(t){p=t}},displayBrush:{get:function(){return v},set:function(t){v=t}},filters:{get:function(){return y},set:function(t){y=t}},active:{get:function(){return b},set:function(t){b=t}},lineTension:{get:function(){return w},set:function(t){w=t}},undefinedValuesLabel:{get:function(){return h},set:function(t){h=t}},dimensions:{get:function(){return p.map(function(t){return t.key})},set:function(e){t.deprecated("dimensions","use dimensionData instead"),0===p.length?e.forEach(function(t){p.push({key:t})}):e.forEach(function(t,e){p[e].key=t})}},dimensionNames:{get:function(){return p.map(function(t){return t.key})},set:function(e){t.deprecated("dimensionNames","use dimensionData instead"),g=[],0===p.length?e.forEach(function(t){p.push({key:t})}):e.forEach(function(t,e){p[e].key=t})}},dimensionFormats:{get:function(){return p.map(function(t){return t.format})},set:function(e){t.deprecated("dimensionFormats","use dimensionData instead"),0===p.length?e.forEach(function(t){p.push({format:t})}):e.forEach(function(t,e){p[e].format=t})}},margin:{get:function(){return o},set:function(t){o.top=void 0!==t.top?t.top:o.top,o.right=void 0!==t.right?t.right:o.right,o.bottom=void 0!==t.bottom?t.bottom:o.bottom,o.left=void 0!==t.left?t.left:o.left}},color:{get:function(){return m},set:function(e){m=t.utils.getColor(e)}}}),t.utils.initOptions(e),e},t.models.parallelCoordinatesChart=function(){"use strict";function e(i){return y.reset(),y.models(n),i.each(function(i){var c=d3.select(this);t.utils.initSVG(c);var g=t.utils.availableWidth(s,c,o),v=t.utils.availableHeight(l,c,o);if(e.update=function(){c.call(e)},e.container=this,d.setter(x(h),e.update).getter(b(h)).update(),d.disabled=h.map(function(t){return!!t.disabled}),h=h.map(function(t){return t.disabled=!!t.disabled,t}),h.forEach(function(t,e){t.originalPosition=isNaN(t.originalPosition)?e:t.originalPosition,t.currentPosition=isNaN(t.currentPosition)?e:t.currentPosition}),!f){var y;f={};for(y in d)d[y]instanceof Array?f[y]=d[y].slice(0):f[y]=d[y]}if(!i||!i.length)return t.utils.noData(e,c),e;c.selectAll(".nv-noData").remove();var _=c.selectAll("g.nv-wrap.nv-parallelCoordinatesChart").data([i]),w=_.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinatesChart").append("g"),k=_.select("g");w.append("g").attr("class","nv-parallelCoordinatesWrap"),w.append("g").attr("class","nv-legendWrap"),k.select("rect").attr("width",g).attr("height",v>0?v:0),u?(r.width(g).color(function(t){return"rgb(188,190,192)"}),k.select(".nv-legendWrap").datum(h.sort(function(t,e){return t.originalPosition-e.originalPosition})).call(r),a||r.height()===o.top||(o.top=r.height(),v=t.utils.availableHeight(l,c,o)),_.select(".nv-legendWrap").attr("transform","translate( 0 ,"+-o.top+")")):k.select(".nv-legendWrap").selectAll("*").remove(),_.attr("transform","translate("+o.left+","+o.top+")"),n.width(g).height(v).dimensionData(h).displayBrush(p);var M=k.select(".nv-parallelCoordinatesWrap ").datum(i);M.transition().call(n),n.dispatch.on("brushEnd",function(t,e){e?(p=!0,m.brushEnd(t)):p=!1}),r.dispatch.on("stateChange",function(t){for(var n in t)d[n]=t[n];m.stateChange(d),e.update()}),n.dispatch.on("dimensionsOrder",function(t){h.sort(function(t,e){return t.currentPosition-e.currentPosition});var e=!1;h.forEach(function(t,n){t.currentPosition=n,t.currentPosition!==t.originalPosition&&(e=!0)}),m.dimensionsOrder(h,e)}),m.on("changeState",function(t){"undefined"!=typeof t.disabled&&(h.forEach(function(e,n){e.disabled=t.disabled[n]}),d.disabled=t.disabled),e.update()})}),y.renderEnd("parraleleCoordinateChart immediate"),e}var n=t.models.parallelCoordinates(),r=t.models.legend(),i=t.models.tooltip(),o=(t.models.tooltip(),{top:0,right:0,bottom:0,left:0}),a=null,s=null,l=null,u=!0,c=t.utils.defaultColor(),d=t.utils.state(),h=[],p=!0,f=null,g=null,v="undefined",m=d3.dispatch("dimensionsOrder","brushEnd","stateChange","changeState","renderEnd"),y=t.utils.renderWatch(m),b=function(t){return function(){return{active:t.map(function(t){return!t.disabled})}}},x=function(t){return function(e){void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};return i.contentGenerator(function(t){var e='<table><thead><tr><td class="legend-color-guide"><div style="background-color:'+t.color+'"></div></td><td><strong>'+t.key+"</strong></td></tr></thead>";return 0!==t.series.length&&(e+='<tbody><tr><td height ="10px"></td></tr>',t.series.forEach(function(t){e=e+'<tr><td class="legend-color-guide"><div style="background-color:'+t.color+'"></div></td><td class="key">'+t.key+'</td><td class="value">'+t.value+"</td></tr>"}),e+="</tbody>"),e+="</table>"}),n.dispatch.on("elementMouseover.tooltip",function(t){var e={key:t.label,color:t.color,series:[]};t.values&&(Object.keys(t.values).forEach(function(n){var r=t.dimensions.filter(function(t){return t.key===n})[0];if(r){var i;i=isNaN(t.values[n])||isNaN(parseFloat(t.values[n]))?v:r.format(t.values[n]),e.series.push({idx:r.currentPosition,key:n,value:i,color:r.color})}}),e.series.sort(function(t,e){return t.idx-e.idx})),i.data(e).hidden(!1)}),n.dispatch.on("elementMouseout.tooltip",function(t){i.hidden(!0)}),n.dispatch.on("elementMousemove.tooltip",function(){i()}),e.dispatch=m,e.parallelCoordinates=n,e.legend=r,e.tooltip=i,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},showLegend:{get:function(){return u},set:function(t){u=t}},defaultState:{get:function(){return f},set:function(t){f=t}},dimensionData:{get:function(){return h},set:function(t){h=t}},displayBrush:{get:function(){return p},set:function(t){p=t}},noData:{get:function(){return g},set:function(t){g=t}},nanValue:{get:function(){return v},set:function(t){v=t}},margin:{get:function(){return o},set:function(t){void 0!==t.top&&(o.top=t.top,a=t.top),o.right=void 0!==t.right?t.right:o.right,o.bottom=void 0!==t.bottom?t.bottom:o.bottom,o.left=void 0!==t.left?t.left:o.left}},color:{get:function(){return c},set:function(e){c=t.utils.getColor(e),r.color(c),n.color(c)}}}),t.utils.inheritOptions(e,n),t.utils.initOptions(e),e},t.models.pie=function(){"use strict";function e(P){return T.reset(),P.each(function(e){function P(t,e){t.endAngle=isNaN(t.endAngle)?0:t.endAngle,t.startAngle=isNaN(t.startAngle)?0:t.startAngle,g||(t.innerRadius=0);var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){return A[e](n(t))}}var D=r-n.left-n.right,O=i-n.top-n.bottom,N=Math.min(D,O)/2,I=[],z=[];if(l=d3.select(this),0===S.length)for(var G=N-N/5,W=M*N,F=0;F<e[0].length;F++)I.push(G),z.push(W);else m?(I=S.map(function(t){return(t.outer-t.outer/5)*N}),z=S.map(function(t){return(t.inner-t.inner/5)*N}),M=d3.min(S.map(function(t){return t.inner-t.inner/5}))):(I=S.map(function(t){return t.outer*N}),z=S.map(function(t){return t.inner*N}),M=d3.min(S.map(function(t){return t.inner})));t.utils.initSVG(l);var R=l.selectAll(".nv-wrap.nv-pie").data(e),B=R.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+s),H=B.append("g"),j=R.select("g"),V=H.append("g").attr("class","nv-pie");H.append("g").attr("class","nv-pieLabels"),R.attr("transform","translate("+n.left+","+n.top+")"),j.select(".nv-pie").attr("transform","translate("+D/2+","+O/2+")"),j.select(".nv-pieLabels").attr("transform","translate("+D/2+","+O/2+")"),l.on("click",function(t,e){L.chartClick({data:t,index:e,pos:d3.event,id:s})}),A=[],E=[];for(var F=0;F<e[0].length;F++){var $=d3.svg.arc().outerRadius(I[F]),q=d3.svg.arc().outerRadius(I[F]+5);x!==!1&&($.startAngle(x),q.startAngle(x)),w!==!1&&($.endAngle(w),q.endAngle(w)),g&&($.innerRadius(z[F]),q.innerRadius(z[F])),$.cornerRadius&&k&&($.cornerRadius(k),q.cornerRadius(k)),A.push($),E.push(q)}var U=d3.layout.pie().sort(null).value(function(t){return t.disabled?0:a(t)});U.padAngle&&_&&U.padAngle(_),g&&v&&(V.append("text").attr("class","nv-pie-title"),R.select(".nv-pie-title").style("text-anchor","middle").text(function(t){return v}).style("font-size",Math.min(D,O)*M*2/(v.length+2)+"px").attr("dy","0.35em").attr("transform",function(t,e){return"translate(0, "+y+")"}));var X=R.select(".nv-pie").selectAll(".nv-slice").data(U),Y=R.select(".nv-pieLabels").selectAll(".nv-label").data(U);X.exit().remove(),Y.exit().remove();var K=X.enter().append("g");K.attr("class","nv-slice"),K.on("mouseover",function(t,e){d3.select(this).classed("hover",!0),m&&d3.select(this).select("path").transition().duration(70).attr("d",E[e]),L.elementMouseover({data:t.data,index:e,color:d3.select(this).style("fill"),percent:(t.endAngle-t.startAngle)/(2*Math.PI)})}),K.on("mouseout",function(t,e){d3.select(this).classed("hover",!1),m&&d3.select(this).select("path").transition().duration(50).attr("d",A[e]),L.elementMouseout({data:t.data,index:e})}),K.on("mousemove",function(t,e){L.elementMousemove({data:t.data,index:e})}),K.on("click",function(t,e){var n=this;L.elementClick({data:t.data,index:e,color:d3.select(this).style("fill"),event:d3.event,element:n})}),K.on("dblclick",function(t,e){L.elementDblClick({data:t.data,index:e,color:d3.select(this).style("fill")})}),X.attr("fill",function(t,e){return u(t.data,e)}),X.attr("stroke",function(t,e){return u(t.data,e)});K.append("path").each(function(t){this._current=t});if(X.select("path").transition().duration(C).attr("d",function(t,e){return A[e](t)}).attrTween("d",P),d){for(var Z=[],F=0;F<e[0].length;F++)Z.push(A[F]),h?g&&(Z[F]=d3.svg.arc().outerRadius(A[F].outerRadius()),x!==!1&&Z[F].startAngle(x),w!==!1&&Z[F].endAngle(w)):g||Z[F].innerRadius(0);Y.enter().append("g").classed("nv-label",!0).each(function(t,e){var n=d3.select(this);n.attr("transform",function(t,e){if(b){t.outerRadius=I[e]+10,t.innerRadius=I[e]+15;var n=(t.startAngle+t.endAngle)/2*(180/Math.PI);return(t.startAngle+t.endAngle)/2<Math.PI?n-=90:n+=90,"translate("+Z[e].centroid(t)+") rotate("+n+")"}return t.outerRadius=N+10,t.innerRadius=N+15,"translate("+Z[e].centroid(t)+")"}),n.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3),n.append("text").style("text-anchor",b?(t.startAngle+t.endAngle)/2<Math.PI?"start":"end":"middle").style("fill","#000")});var Q={},J=14,tt=140,et=function(t){return Math.floor(t[0]/tt)*tt+","+Math.floor(t[1]/J)*J},nt=function(t){return(t.endAngle-t.startAngle)/(2*Math.PI)};Y.watchTransition(T,"pie labels").attr("transform",function(t,e){if(b){t.outerRadius=I[e]+10,t.innerRadius=I[e]+15;var n=(t.startAngle+t.endAngle)/2*(180/Math.PI);return(t.startAngle+t.endAngle)/2<Math.PI?n-=90:n+=90,"translate("+Z[e].centroid(t)+") rotate("+n+")"}t.outerRadius=N+10,t.innerRadius=N+15;var r=Z[e].centroid(t),i=nt(t);if(t.value&&i>=f){var o=et(r);Q[o]&&(r[1]-=J),Q[et(r)]=!0}return"translate("+r+")"}),Y.select(".nv-label text").style("text-anchor",function(t,e){return b?(t.startAngle+t.endAngle)/2<Math.PI?"start":"end":"middle"}).text(function(t,e){var n=nt(t),r="";if(!t.value||n<f)return"";if("function"==typeof p)r=p(t,e,{key:o(t.data),value:a(t.data),percent:c(n)});else switch(p){case"key":r=o(t.data);break;case"value":r=c(a(t.data));break;case"percent":r=d3.format("%")(n)}return r})}}),T.renderEnd("pie immediate"),e}var n={top:0,right:0,bottom:0,left:0},r=500,i=500,o=function(t){return t.x},a=function(t){return t.y},s=Math.floor(1e4*Math.random()),l=null,u=t.utils.defaultColor(),c=d3.format(",.2f"),d=!0,h=!1,p="key",f=.02,g=!1,v=!1,m=!0,y=0,b=!1,x=!1,_=!1,w=!1,k=0,M=.5,C=250,S=[],L=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),A=[],E=[],T=t.utils.renderWatch(L);return e.dispatch=L,e.options=t.utils.optionsFunc.bind(e),
e._options=Object.create({},{arcsRadius:{get:function(){return S},set:function(t){S=t}},width:{get:function(){return r},set:function(t){r=t}},height:{get:function(){return i},set:function(t){i=t}},showLabels:{get:function(){return d},set:function(t){d=t}},title:{get:function(){return v},set:function(t){v=t}},titleOffset:{get:function(){return y},set:function(t){y=t}},labelThreshold:{get:function(){return f},set:function(t){f=t}},valueFormat:{get:function(){return c},set:function(t){c=t}},x:{get:function(){return o},set:function(t){o=t}},id:{get:function(){return s},set:function(t){s=t}},endAngle:{get:function(){return w},set:function(t){w=t}},startAngle:{get:function(){return x},set:function(t){x=t}},padAngle:{get:function(){return _},set:function(t){_=t}},cornerRadius:{get:function(){return k},set:function(t){k=t}},donutRatio:{get:function(){return M},set:function(t){M=t}},labelsOutside:{get:function(){return h},set:function(t){h=t}},labelSunbeamLayout:{get:function(){return b},set:function(t){b=t}},donut:{get:function(){return g},set:function(t){g=t}},growOnHover:{get:function(){return m},set:function(t){m=t}},pieLabelsOutside:{get:function(){return h},set:function(e){h=e,t.deprecated("pieLabelsOutside","use labelsOutside instead")}},donutLabelsOutside:{get:function(){return h},set:function(e){h=e,t.deprecated("donutLabelsOutside","use labelsOutside instead")}},labelFormat:{get:function(){return c},set:function(e){c=e,t.deprecated("labelFormat","use valueFormat instead")}},margin:{get:function(){return n},set:function(t){n.top="undefined"!=typeof t.top?t.top:n.top,n.right="undefined"!=typeof t.right?t.right:n.right,n.bottom="undefined"!=typeof t.bottom?t.bottom:n.bottom,n.left="undefined"!=typeof t.left?t.left:n.left}},duration:{get:function(){return C},set:function(t){C=t,T.reset(C)}},y:{get:function(){return a},set:function(t){a=d3.functor(t)}},color:{get:function(){return u},set:function(e){u=t.utils.getColor(e)}},labelType:{get:function(){return p},set:function(t){p=t||"key"}}}),t.utils.initOptions(e),e},t.models.pieChart=function(){"use strict";function e(i){return y.reset(),y.models(n),i.each(function(i){var u=d3.select(this);t.utils.initSVG(u);var h=t.utils.availableWidth(s,u,o),g=t.utils.availableHeight(l,u,o);if(e.update=function(){u.transition().call(e)},e.container=this,p.setter(x(i),e.update).getter(b(i)).update(),p.disabled=i.map(function(t){return!!t.disabled}),!f){var v;f={};for(v in p)p[v]instanceof Array?f[v]=p[v].slice(0):f[v]=p[v]}if(!i||!i.length)return t.utils.noData(e,u),e;u.selectAll(".nv-noData").remove();var y=u.selectAll("g.nv-wrap.nv-pieChart").data([i]),_=y.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g"),w=y.select("g");if(_.append("g").attr("class","nv-pieWrap"),_.append("g").attr("class","nv-legendWrap"),c){if("top"===d)r.width(h).key(n.x()),y.select(".nv-legendWrap").datum(i).call(r),a||r.height()===o.top||(o.top=r.height(),g=t.utils.availableHeight(l,u,o)),y.select(".nv-legendWrap").attr("transform","translate(0,"+-o.top+")");else if("right"===d){var k=t.models.legend().width();h/2<k&&(k=h/2),r.height(g).key(n.x()),r.width(k),h-=r.width(),y.select(".nv-legendWrap").datum(i).call(r).attr("transform","translate("+h+",0)")}}else w.select(".nv-legendWrap").selectAll("*").remove();y.attr("transform","translate("+o.left+","+o.top+")"),n.width(h).height(g);var M=w.select(".nv-pieWrap").datum([i]);d3.transition(M).call(n),r.dispatch.on("stateChange",function(t){for(var n in t)p[n]=t[n];m.stateChange(p),e.update()}),m.on("changeState",function(t){"undefined"!=typeof t.disabled&&(i.forEach(function(e,n){e.disabled=t.disabled[n]}),p.disabled=t.disabled),e.update()})}),y.renderEnd("pieChart immediate"),e}var n=t.models.pie(),r=t.models.legend(),i=t.models.tooltip(),o={top:30,right:20,bottom:20,left:20},a=null,s=null,l=null,u=!1,c=!0,d="top",h=t.utils.defaultColor(),p=t.utils.state(),f=null,g=null,v=250,m=d3.dispatch("stateChange","changeState","renderEnd");i.duration(0).headerEnabled(!1).valueFormatter(function(t,e){return n.valueFormat()(t,e)});var y=t.utils.renderWatch(m),b=function(t){return function(){return{active:t.map(function(t){return!t.disabled})}}},x=function(t){return function(e){void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};return n.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:e.x()(t.data),value:e.y()(t.data),color:t.color,percent:t.percent},u||(delete t.percent,delete t.series.percent),i.data(t).hidden(!1)}),n.dispatch.on("elementMouseout.tooltip",function(t){i.hidden(!0)}),n.dispatch.on("elementMousemove.tooltip",function(t){i()}),e.legend=r,e.dispatch=m,e.pie=n,e.tooltip=i,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},noData:{get:function(){return g},set:function(t){g=t}},showTooltipPercent:{get:function(){return u},set:function(t){u=t}},showLegend:{get:function(){return c},set:function(t){c=t}},legendPosition:{get:function(){return d},set:function(t){d=t}},defaultState:{get:function(){return f},set:function(t){f=t}},color:{get:function(){return h},set:function(t){h=t,r.color(h),n.color(h)}},duration:{get:function(){return v},set:function(t){v=t,y.reset(v),n.duration(v)}},margin:{get:function(){return o},set:function(t){void 0!==t.top&&(o.top=t.top,a=t.top),o.right=void 0!==t.right?t.right:o.right,o.bottom=void 0!==t.bottom?t.bottom:o.bottom,o.left=void 0!==t.left?t.left:o.left}}}),t.utils.inheritOptions(e,n),t.utils.initOptions(e),e},t.models.sankey=function(){"use strict";function e(){p.forEach(function(t){t.sourceLinks=[],t.targetLinks=[]}),f.forEach(function(t){var e=t.source,n=t.target;"number"==typeof e&&(e=t.source=p[t.source]),"number"==typeof n&&(n=t.target=p[t.target]),e.sourceLinks.push(t),n.targetLinks.push(t)})}function n(){p.forEach(function(t){t.value=Math.max(d3.sum(t.sourceLinks,l),d3.sum(t.targetLinks,l))})}function r(){for(var t,e=p,n=0;e.length&&n<p.length;)t=[],e.forEach(function(e){e.x=n,e.dx=c,e.sourceLinks.forEach(function(e){t.indexOf(e.target)<0&&t.push(e.target)})}),e=t,++n;g&&i(n),o((h[0]-c)/(n-1))}function i(t){p.forEach(function(e){e.sourceLinks.length||(e.x=t-1)})}function o(t){p.forEach(function(e){e.x*=t})}function a(t){function e(){var t=d3.min(a,function(t){return(h[1]-(t.length-1)*d)/d3.sum(t,l)});a.forEach(function(e){e.forEach(function(e,n){e.y=n,e.dy=e.value*t})}),f.forEach(function(e){e.dy=e.value*t})}function n(t){function e(t){return(t.source.y+t.sy+t.dy/2)*t.value}a.forEach(function(n,r){n.forEach(function(n){if(n.targetLinks.length){var r=d3.sum(n.targetLinks,e)/d3.sum(n.targetLinks,l);n.y+=(r-b(n))*t}})})}function r(t){function e(t){return(t.target.y+t.ty+t.dy/2)*t.value}a.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var r=d3.sum(n.sourceLinks,e)/d3.sum(n.sourceLinks,l);n.y+=(r-b(n))*t}})})}function i(){a.forEach(function(t){var e,n,r,i=0,a=t.length;for(t.sort(o),r=0;r<a;++r)e=t[r],n=i-e.y,n>0&&(e.y+=n),i=e.y+e.dy+d;if(n=i-d-h[1],n>0)for(i=e.y-=n,r=a-2;r>=0;--r)e=t[r],n=e.y+e.dy+d-i,n>0&&(e.y-=n),i=e.y})}function o(t,e){return t.y-e.y}var a=d3.nest().key(function(t){return t.x}).sortKeys(d3.ascending).entries(p).map(function(t){return t.values});e(),i(),s();for(var u=1;t>0;--t)r(u*=.99),i(),s(),n(u),i(),s()}function s(){function t(t,e){return t.source.y-e.source.y}function e(t,e){return t.target.y-e.target.y}p.forEach(function(n){n.sourceLinks.sort(e),n.targetLinks.sort(t)}),p.forEach(function(t){var e=0,n=0;t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy})})}function l(t){return t.value}var u={},c=24,d=8,h=[1,1],p=[],f=[],g=!0,v=function(t){e(),n(),r(),a(t)},m=function(){s()},y=function(){function t(t){var n=t.source.x+t.source.dx,r=t.target.x,i=d3.interpolateNumber(n,r),o=i(e),a=i(1-e),s=t.source.y+t.sy+t.dy/2,l=t.target.y+t.ty+t.dy/2,u="M"+n+","+s+"C"+o+","+s+" "+a+","+l+" "+r+","+l;return u}var e=.5;return t.curvature=function(n){return arguments.length?(e=+n,t):e},t},b=function(t){return t.y+t.dy/2};return u.options=t.utils.optionsFunc.bind(u),u._options=Object.create({},{nodeWidth:{get:function(){return c},set:function(t){c=+t}},nodePadding:{get:function(){return d},set:function(t){d=t}},nodes:{get:function(){return p},set:function(t){p=t}},links:{get:function(){return f},set:function(t){f=t}},size:{get:function(){return h},set:function(t){h=t}},sinksRight:{get:function(){return g},set:function(t){g=t}},layout:{get:function(){v(32)},set:function(t){v(t)}},relayout:{get:function(){m()},set:function(t){}},center:{get:function(){return b()},set:function(t){"function"==typeof t&&(b=t)}},link:{get:function(){return y()},set:function(t){return"function"==typeof t&&(y=t),y()}}}),t.utils.initOptions(u),u},t.models.sankeyChart=function(){"use strict";function e(t){return t.each(function(e){function n(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(o-t.dy,d3.event.y)))+")"),r.relayout(),b.attr("d",y)}var l={nodes:[{node:1,name:"Test 1"},{node:2,name:"Test 2"},{node:3,name:"Test 3"},{node:4,name:"Test 4"},{node:5,name:"Test 5"},{node:6,name:"Test 6"}],links:[{source:0,target:1,value:2295},{source:0,target:5,value:1199},{source:1,target:2,value:1119},{source:1,target:5,value:1176},{source:2,target:3,value:487},{source:2,target:5,value:632},{source:3,target:4,value:301},{source:3,target:5,value:186}]},c=!1,d=!1;if(("object"==typeof e.nodes&&e.nodes.length)>=0&&("object"==typeof e.links&&e.links.length)>=0&&(c=!0),e.nodes&&e.nodes.length>0&&e.links&&e.links.length>0&&(d=!0),!c)return console.error("NVD3 Sankey chart error:","invalid data format for",e),console.info("Valid data format is: ",l,JSON.stringify(l)),m(t,"Error loading chart, data is invalid"),!1;if(!d)return m(t,"No data available"),!1;var h=t.append("svg").attr("width",i).attr("height",o).append("g").attr("class","nvd3 nv-wrap nv-sankeyChart");r.nodeWidth(a).nodePadding(s).size([i,o]);var y=r.link();r.nodes(e.nodes).links(e.links).layout(32).center(u);var b=h.append("g").selectAll(".link").data(e.links).enter().append("path").attr("class","link").attr("d",y).style("stroke-width",function(t){return Math.max(1,t.dy)}).sort(function(t,e){return e.dy-t.dy});b.append("title").text(p);var x=h.append("g").selectAll(".node").data(e.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.behavior.drag().origin(function(t){return t}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",n));x.append("rect").attr("height",function(t){return t.dy}).attr("width",r.nodeWidth()).style("fill",f).style("stroke",g).append("title").text(v),x.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){return t.name}).filter(function(t){return t.x<i/2}).attr("x",6+r.nodeWidth()).attr("text-anchor","start")}),e}var n={top:5,right:0,bottom:5,left:0},r=t.models.sankey(),i=600,o=400,a=36,s=40,l="units",u=void 0,c=d3.format(",.0f"),d=function(t){return c(t)+" "+l},h=d3.scale.category20(),p=function(t){return t.source.name+"  "+t.target.name+"\n"+d(t.value)},f=function(t){return t.color=h(t.name.replace(/ .*/,""))},g=function(t){return d3.rgb(t.color).darker(2)},v=function(t){return t.name+"\n"+d(t.value)},m=function(t,e){t.append("text").attr("x",0).attr("y",0).attr("class","nvd3-sankey-chart-error").attr("text-anchor","middle").text(e)};return e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{units:{get:function(){return l},set:function(t){l=t}},width:{get:function(){return i},set:function(t){i=t}},height:{get:function(){return o},set:function(t){o=t}},format:{get:function(){return d},set:function(t){d=t}},linkTitle:{get:function(){return p},set:function(t){p=t}},nodeWidth:{get:function(){return a},set:function(t){a=t}},nodePadding:{get:function(){return s},set:function(t){s=t}},center:{get:function(){return u},set:function(t){u=t}},margin:{get:function(){return n},set:function(t){n.top=void 0!==t.top?t.top:n.top,n.right=void 0!==t.right?t.right:n.right,n.bottom=void 0!==t.bottom?t.bottom:n.bottom,n.left=void 0!==t.left?t.left:n.left}},nodeStyle:{get:function(){return{}},set:function(t){f=void 0!==t.fillColor?t.fillColor:f,g=void 0!==t.strokeColor?t.strokeColor:g,v=void 0!==t.title?t.title:v}}}),t.utils.initOptions(e),e},t.models.scatter=function(){"use strict";function e(t){var e,n;return e=t[0].series+":"+t[1],n=Z[e]=Z[e]||{}}function n(t){var e;e=t[0].series+":"+t[1],delete Z[e]}function r(t){var n,r,i,o=e(t),a=!1;for(n=1;n<arguments.length;n+=2)r=arguments[n],i=arguments[n+1](t[0],t[1]),o[r]===i&&o.hasOwnProperty(r)||(o[r]=i,a=!0);return a}function i(e){return Y.reset(),e.each(function(e){function $(){if(X=!1,!A)return!1;if(V===!0){var n=d3.merge(e.map(function(e,n){return e.values.map(function(e,r){var i=_(e,r),o=w(e,r);return[t.utils.NaNtoZero(y(i))+1e-4*Math.random(),t.utils.NaNtoZero(b(o))+1e-4*Math.random(),n,r,e]}).filter(function(t,e){return E(t[4],e)})}));if(0==n.length)return!1;n.length<3&&(n.push([y.range()[0]-20,b.range()[0]-20,null,null]),n.push([y.range()[1]+20,b.range()[1]+20,null,null]),n.push([y.range()[0]-20,b.range()[0]+20,null,null]),n.push([y.range()[1]+20,b.range()[1]-20,null,null]));var r=d3.geom.polygon([[-10,-10],[-10,p+10],[h+10,p+10],[h+10,-10]]),i=d3.geom.voronoi(n).map(function(t,e){return{data:r.clip(t),series:n[e][2],point:n[e][3]}});it.select(".nv-point-paths").selectAll("path").remove();var o=it.select(".nv-point-paths").selectAll("path").data(i),a=o.enter().append("svg:path").attr("d",function(t){return t&&t.data&&0!==t.data.length?"M"+t.data.join(",")+"Z":"M 0 0"}).attr("id",function(t,e){return"nv-path-"+e}).attr("clip-path",function(t,e){return"url(#nv-clip-"+v+"-"+e+")"});if(N&&a.style("fill",d3.rgb(230,230,230)).style("fill-opacity",.4).style("stroke-opacity",1).style("stroke",d3.rgb(200,200,200)),O){it.select(".nv-point-clips").selectAll("*").remove();var s=it.select(".nv-point-clips").selectAll("clipPath").data(n);s.enter().append("svg:clipPath").attr("id",function(t,e){return"nv-clip-"+v+"-"+e}).append("svg:circle").attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",I)}var l=function(t,n,r){if(X)return 0;var i=e[n.series];if(void 0!==i){var o=i.values[n.point];o.color=f(i,n.series),o.x=_(o),o.y=w(o);var a=m.node().getBoundingClientRect(),s=window.pageYOffset||document.documentElement.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft,u={left:y(_(o,n.point))+a.left+l+d.left+10,top:b(w(o,n.point))+a.top+s+d.top+10};r({point:o,series:i,pos:u,relativePos:[y(_(o,n.point))+d.left,b(w(o,n.point))+d.top],seriesIndex:n.series,pointIndex:n.point,event:d3.event,element:t})}};o.on("click",function(t){l(this,t,j.elementClick)}).on("dblclick",function(t){l(this,t,j.elementDblClick)}).on("mouseover",function(t){l(this,t,j.elementMouseover)}).on("mouseout",function(t,e){l(this,t,j.elementMouseout)})}else it.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(t,n){if(X||!e[t.series])return 0;var r=e[t.series],i=r.values[n],o=this;j.elementClick({point:i,series:r,pos:[y(_(i,n))+d.left,b(w(i,n))+d.top],relativePos:[y(_(i,n))+d.left,b(w(i,n))+d.top],seriesIndex:t.series,pointIndex:n,event:d3.event,element:o})}).on("dblclick",function(t,n){if(X||!e[t.series])return 0;var r=e[t.series],i=r.values[n];j.elementDblClick({point:i,series:r,pos:[y(_(i,n))+d.left,b(w(i,n))+d.top],relativePos:[y(_(i,n))+d.left,b(w(i,n))+d.top],seriesIndex:t.series,pointIndex:n})}).on("mouseover",function(t,n){if(X||!e[t.series])return 0;var r=e[t.series],i=r.values[n];j.elementMouseover({point:i,series:r,pos:[y(_(i,n))+d.left,b(w(i,n))+d.top],relativePos:[y(_(i,n))+d.left,b(w(i,n))+d.top],seriesIndex:t.series,pointIndex:n,color:f(t,n)})}).on("mouseout",function(t,n){if(X||!e[t.series])return 0;var r=e[t.series],i=r.values[n];j.elementMouseout({point:i,series:r,pos:[y(_(i,n))+d.left,b(w(i,n))+d.top],relativePos:[y(_(i,n))+d.left,b(w(i,n))+d.top],seriesIndex:t.series,pointIndex:n,color:f(t,n)})})}m=d3.select(this);var Z=t.utils.availableWidth(h,m,d),Q=t.utils.availableHeight(p,m,d);t.utils.initSVG(m),e.forEach(function(t,e){t.values.forEach(function(t){t.series=e})});var J=i.yScale().name===d3.scale.log().name,tt=z&&G&&R?[]:d3.merge(e.map(function(t){return t.values.map(function(t,e){return{x:_(t,e),y:w(t,e),size:k(t,e)}})}));if(y.domain(z||d3.extent(tt.map(function(t){return t.x}).concat(C))),T&&e[0]?y.range(W||[(Z*P+Z)/(2*e[0].values.length),Z-Z*(1+P)/(2*e[0].values.length)]):y.range(W||[0,Z]),J){var et=d3.min(tt.map(function(t){if(0!==t.y)return t.y}));b.clamp(!0).domain(G||d3.extent(tt.map(function(t){return 0!==t.y?t.y:.1*et}).concat(S))).range(F||[Q,0])}else b.domain(G||d3.extent(tt.map(function(t){return t.y}).concat(S))).range(F||[Q,0]);x.domain(R||d3.extent(tt.map(function(t){return t.size}).concat(L))).range(B||K),H=y.domain()[0]===y.domain()[1]||b.domain()[0]===b.domain()[1],y.domain()[0]===y.domain()[1]&&(y.domain()[0]?y.domain([y.domain()[0]-.01*y.domain()[0],y.domain()[1]+.01*y.domain()[1]]):y.domain([-1,1])),b.domain()[0]===b.domain()[1]&&(b.domain()[0]?b.domain([b.domain()[0]-.01*b.domain()[0],b.domain()[1]+.01*b.domain()[1]]):b.domain([-1,1])),isNaN(y.domain()[0])&&y.domain([-1,1]),isNaN(b.domain()[0])&&b.domain([-1,1]),o=o||y,a=a||b,s=s||x;var nt=y(1)!==o(1)||b(1)!==a(1)||x(1)!==s(1);l=l||h,u=u||p;var rt=l!==h||u!==p,it=m.selectAll("g.nv-wrap.nv-scatter").data([e]),ot=it.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+v),at=ot.append("defs"),st=ot.append("g"),lt=it.select("g");it.classed("nv-single-point",H),st.append("g").attr("class","nv-groups"),st.append("g").attr("class","nv-point-paths"),ot.append("g").attr("class","nv-point-clips"),it.attr("transform","translate("+d.left+","+d.top+")"),at.append("clipPath").attr("id","nv-edge-clip-"+v).append("rect").attr("transform","translate( -10, -10)"),it.select("#nv-edge-clip-"+v+" rect").attr("width",Z+20).attr("height",Q>0?Q+20:0),lt.attr("clip-path",D?"url(#nv-edge-clip-"+v+")":""),X=!0;var ut=it.select(".nv-groups").selectAll(".nv-group").data(function(t){return t},function(t){return t.key});ut.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),ut.exit().remove(),ut.attr("class",function(t,e){return(t.classed||"")+" nv-group nv-series-"+e}).classed("nv-noninteractive",!A).classed("hover",function(t){return t.hover}),ut.watchTransition(Y,"scatter: groups").style("fill",function(t,e){return f(t,e)}).style("stroke",function(t,e){return t.pointBorderColor||g||f(t,e)}).style("stroke-opacity",1).style("fill-opacity",.5);var ct=ut.selectAll("path.nv-point").data(function(t){return t.values.map(function(t,e){return[t,e]}).filter(function(t,e){return E(t[0],e)})});if(ct.enter().append("path").attr("class",function(t){return"nv-point nv-point-"+t[1]}).style("fill",function(t){return t.color}).style("stroke",function(t){return t.color}).attr("transform",function(e){return"translate("+t.utils.NaNtoZero(o(_(e[0],e[1])))+","+t.utils.NaNtoZero(a(w(e[0],e[1])))+")"}).attr("d",t.utils.symbol().type(function(t){return M(t[0])}).size(function(t){return x(k(t[0],t[1]))})),ct.exit().each(n).remove(),ut.exit().selectAll("path.nv-point").watchTransition(Y,"scatter exit").attr("transform",function(e){return"translate("+t.utils.NaNtoZero(y(_(e[0],e[1])))+","+t.utils.NaNtoZero(b(w(e[0],e[1])))+")"}).remove(),ct.filter(function(t){return nt||rt||r(t,"x",_,"y",w)}).watchTransition(Y,"scatter points").attr("transform",function(e){return"translate("+t.utils.NaNtoZero(y(_(e[0],e[1])))+","+t.utils.NaNtoZero(b(w(e[0],e[1])))+")"}),ct.filter(function(t){return nt||rt||r(t,"shape",M,"size",k)}).watchTransition(Y,"scatter points").attr("d",t.utils.symbol().type(function(t){return M(t[0])}).size(function(t){return x(k(t[0],t[1]))})),U){var dt=ut.selectAll(".nv-label").data(function(t){return t.values.map(function(t,e){return[t,e]}).filter(function(t,e){return E(t[0],e)})});dt.enter().append("text").style("fill",function(t,e){return t.color}).style("stroke-opacity",0).style("fill-opacity",1).attr("transform",function(e){var n=t.utils.NaNtoZero(o(_(e[0],e[1])))+Math.sqrt(x(k(e[0],e[1]))/Math.PI)+2;return"translate("+n+","+t.utils.NaNtoZero(a(w(e[0],e[1])))+")"}).text(function(t,e){return t[0].label}),dt.exit().remove(),ut.exit().selectAll("path.nv-label").watchTransition(Y,"scatter exit").attr("transform",function(e){var n=t.utils.NaNtoZero(y(_(e[0],e[1])))+Math.sqrt(x(k(e[0],e[1]))/Math.PI)+2;return"translate("+n+","+t.utils.NaNtoZero(b(w(e[0],e[1])))+")"}).remove(),dt.each(function(t){d3.select(this).classed("nv-label",!0).classed("nv-label-"+t[1],!1).classed("hover",!1)}),dt.watchTransition(Y,"scatter labels").attr("transform",function(e){var n=t.utils.NaNtoZero(y(_(e[0],e[1])))+Math.sqrt(x(k(e[0],e[1]))/Math.PI)+2;return"translate("+n+","+t.utils.NaNtoZero(b(w(e[0],e[1])))+")"})}q?(clearTimeout(c),c=setTimeout($,q)):$(),o=y.copy(),a=b.copy(),s=x.copy(),l=h,u=p}),Y.renderEnd("scatter immediate"),i}var o,a,s,l,u,c,d={top:0,right:0,bottom:0,left:0},h=null,p=null,f=t.utils.defaultColor(),g=null,v=Math.floor(1e5*Math.random()),m=null,y=d3.scale.linear(),b=d3.scale.linear(),x=d3.scale.linear(),_=function(t){return t.x},w=function(t){return t.y},k=function(t){return t.size||1},M=function(t){return t.shape||"circle"},C=[],S=[],L=[],A=!0,E=function(t){return!t.notActive},T=!1,P=.1,D=!1,O=!0,N=!1,I=function(){return 25},z=null,G=null,W=null,F=null,R=null,B=null,H=!1,j=d3.dispatch("elementClick","elementDblClick","elementMouseover","elementMouseout","renderEnd"),V=!0,$=250,q=300,U=!1,X=!1,Y=t.utils.renderWatch(j,$),K=[16,256],Z={};return i.dispatch=j,i.options=t.utils.optionsFunc.bind(i),i._calls=new function(){this.clearHighlights=function(){return t.dom.write(function(){m.selectAll(".nv-point.hover").classed("hover",!1)}),null},this.highlightPoint=function(e,n,r){t.dom.write(function(){m.select(".nv-groups").selectAll(".nv-series-"+e).selectAll(".nv-point-"+n).classed("hover",r)})}},j.on("elementMouseover.point",function(t){A&&i._calls.highlightPoint(t.seriesIndex,t.pointIndex,!0)}),j.on("elementMouseout.point",function(t){A&&i._calls.highlightPoint(t.seriesIndex,t.pointIndex,!1)}),i._options=Object.create({},{width:{get:function(){return h},set:function(t){h=t}},height:{get:function(){return p},set:function(t){p=t}},xScale:{get:function(){return y},set:function(t){y=t}},yScale:{get:function(){return b},set:function(t){b=t}},pointScale:{get:function(){return x},set:function(t){x=t}},xDomain:{get:function(){return z},set:function(t){z=t}},yDomain:{get:function(){return G},set:function(t){G=t}},pointDomain:{get:function(){return R},set:function(t){R=t}},xRange:{get:function(){return W},set:function(t){W=t}},yRange:{get:function(){return F},set:function(t){F=t}},pointRange:{get:function(){return B},set:function(t){B=t}},forceX:{get:function(){return C},set:function(t){C=t}},forceY:{get:function(){return S},set:function(t){S=t}},forcePoint:{get:function(){return L},set:function(t){L=t}},interactive:{get:function(){return A},set:function(t){A=t}},pointActive:{get:function(){return E},set:function(t){E=t}},padDataOuter:{get:function(){return P},set:function(t){P=t}},padData:{get:function(){return T},set:function(t){T=t}},clipEdge:{get:function(){return D},set:function(t){D=t}},clipVoronoi:{get:function(){return O},set:function(t){O=t}},clipRadius:{get:function(){return I},set:function(t){I=t}},showVoronoi:{get:function(){return N},set:function(t){N=t}},id:{get:function(){return v},set:function(t){v=t}},interactiveUpdateDelay:{get:function(){return q},set:function(t){q=t}},showLabels:{get:function(){return U},set:function(t){U=t}},pointBorderColor:{get:function(){return g},set:function(t){g=t}},x:{get:function(){return _},set:function(t){_=d3.functor(t)}},y:{get:function(){return w},set:function(t){w=d3.functor(t)}},pointSize:{get:function(){return k},set:function(t){k=d3.functor(t)}},pointShape:{get:function(){return M},set:function(t){M=d3.functor(t)}},margin:{get:function(){return d},set:function(t){d.top=void 0!==t.top?t.top:d.top,d.right=void 0!==t.right?t.right:d.right,d.bottom=void 0!==t.bottom?t.bottom:d.bottom,d.left=void 0!==t.left?t.left:d.left}},duration:{get:function(){return $},set:function(t){$=t,Y.reset($)}},color:{get:function(){return f},set:function(e){f=t.utils.getColor(e)}},useVoronoi:{get:function(){return V},set:function(t){V=t,V===!1&&(O=!1)}}}),t.utils.initOptions(i),i},t.models.scatterChart=function(){"use strict";function e(S){return P.reset(),P.models(n),x&&P.models(r),_&&P.models(i),m&&P.models(a),y&&P.models(s),S.each(function(S){p=d3.select(this),t.utils.initSVG(p);var N=t.utils.availableWidth(d,p,u),I=t.utils.availableHeight(h,p,u);if(e.update=function(){0===L?p.call(e):p.transition().duration(L).call(e)},e.container=this,k.setter(O(S),e.update).getter(D(S)).update(),k.disabled=S.map(function(t){return!!t.disabled}),!M){var z;M={};for(z in k)k[z]instanceof Array?M[z]=k[z].slice(0):M[z]=k[z]}if(!(S&&S.length&&S.filter(function(t){return t.values.length}).length))return t.utils.noData(e,p),P.renderEnd("scatter immediate"),e;p.selectAll(".nv-noData").remove(),g=n.xScale(),v=n.yScale();var G=p.selectAll("g.nv-wrap.nv-scatterChart").data([S]),W=G.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+n.id()),F=W.append("g"),R=G.select("g");if(F.append("rect").attr("class","nvd3 nv-background").style("pointer-events","none"),F.append("g").attr("class","nv-x nv-axis"),F.append("g").attr("class","nv-y nv-axis"),F.append("g").attr("class","nv-scatterWrap"),F.append("g").attr("class","nv-regressionLinesWrap"),F.append("g").attr("class","nv-distWrap"),F.append("g").attr("class","nv-legendWrap"),w&&R.select(".nv-y.nv-axis").attr("transform","translate("+N+",0)"),b){var B=N;o.width(B),G.select(".nv-legendWrap").datum(S).call(o),c||o.height()===u.top||(u.top=o.height(),I=t.utils.availableHeight(h,p,u)),G.select(".nv-legendWrap").attr("transform","translate(0,"+-u.top+")")}else R.select(".nv-legendWrap").selectAll("*").remove();G.attr("transform","translate("+u.left+","+u.top+")"),n.width(N).height(I).color(S.map(function(t,e){return t.color=t.color||f(t,e),t.color}).filter(function(t,e){return!S[e].disabled})).showLabels(A),G.select(".nv-scatterWrap").datum(S.filter(function(t){return!t.disabled})).call(n),G.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+n.id()+")");var H=G.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(t){return t});H.enter().append("g").attr("class","nv-regLines");var j=H.selectAll(".nv-regLine").data(function(t){return[t]});j.enter().append("line").attr("class","nv-regLine").style("stroke-opacity",0),j.filter(function(t){return t.intercept&&t.slope}).watchTransition(P,"scatterPlusLineChart: regline").attr("x1",g.range()[0]).attr("x2",g.range()[1]).attr("y1",function(t,e){return v(g.domain()[0]*t.slope+t.intercept)}).attr("y2",function(t,e){return v(g.domain()[1]*t.slope+t.intercept)}).style("stroke",function(t,e,n){return f(t,n)}).style("stroke-opacity",function(t,e){return t.disabled||"undefined"==typeof t.slope||"undefined"==typeof t.intercept?0:1}),x&&(r.scale(g)._ticks(t.utils.calcTicksX(N/100,S)).tickSize(-I,0),R.select(".nv-x.nv-axis").attr("transform","translate(0,"+v.range()[0]+")").call(r)),_&&(i.scale(v)._ticks(t.utils.calcTicksY(I/36,S)).tickSize(-N,0),R.select(".nv-y.nv-axis").call(i)),m&&(a.getData(n.x()).scale(g).width(N).color(S.map(function(t,e){return t.color||f(t,e)}).filter(function(t,e){return!S[e].disabled})),F.select(".nv-distWrap").append("g").attr("class","nv-distributionX"),R.select(".nv-distributionX").attr("transform","translate(0,"+v.range()[0]+")").datum(S.filter(function(t){return!t.disabled})).call(a)),y&&(s.getData(n.y()).scale(v).width(I).color(S.map(function(t,e){return t.color||f(t,e)}).filter(function(t,e){return!S[e].disabled})),F.select(".nv-distWrap").append("g").attr("class","nv-distributionY"),R.select(".nv-distributionY").attr("transform","translate("+(w?N:-s.size())+",0)").datum(S.filter(function(t){return!t.disabled})).call(s)),o.dispatch.on("stateChange",function(t){for(var n in t)k[n]=t[n];C.stateChange(k),e.update()}),C.on("changeState",function(t){"undefined"!=typeof t.disabled&&(S.forEach(function(e,n){e.disabled=t.disabled[n]}),k.disabled=t.disabled),e.update()}),n.dispatch.on("elementMouseout.tooltip",function(t){l.hidden(!0),p.select(".nv-chart-"+n.id()+" .nv-series-"+t.seriesIndex+" .nv-distx-"+t.pointIndex).attr("y1",0),p.select(".nv-chart-"+n.id()+" .nv-series-"+t.seriesIndex+" .nv-disty-"+t.pointIndex).attr("x2",s.size())}),n.dispatch.on("elementMouseover.tooltip",function(t){p.select(".nv-series-"+t.seriesIndex+" .nv-distx-"+t.pointIndex).attr("y1",t.relativePos[1]-I),p.select(".nv-series-"+t.seriesIndex+" .nv-disty-"+t.pointIndex).attr("x2",t.relativePos[0]+a.size()),l.data(t).hidden(!1)}),E=g.copy(),T=v.copy()}),P.renderEnd("scatter with line immediate"),e}var n=t.models.scatter(),r=t.models.axis(),i=t.models.axis(),o=t.models.legend(),a=t.models.distribution(),s=t.models.distribution(),l=t.models.tooltip(),u={top:30,right:20,bottom:50,left:75},c=null,d=null,h=null,p=null,f=t.utils.defaultColor(),g=n.xScale(),v=n.yScale(),m=!1,y=!1,b=!0,x=!0,_=!0,w=!1,k=t.utils.state(),M=null,C=d3.dispatch("stateChange","changeState","renderEnd"),S=null,L=250,A=!1;n.xScale(g).yScale(v),r.orient("bottom").tickPadding(10),i.orient(w?"right":"left").tickPadding(10),a.axis("x"),s.axis("y"),l.headerFormatter(function(t,e){return r.tickFormat()(t,e)}).valueFormatter(function(t,e){return i.tickFormat()(t,e)});var E,T,P=t.utils.renderWatch(C,L),D=function(t){return function(){return{active:t.map(function(t){return!t.disabled})}}},O=function(t){return function(e){void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}};return e.dispatch=C,e.scatter=n,e.legend=o,e.xAxis=r,e.yAxis=i,e.distX=a,e.distY=s,e.tooltip=l,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return d},set:function(t){d=t}},height:{get:function(){return h},set:function(t){h=t}},container:{get:function(){return p},set:function(t){p=t}},showDistX:{get:function(){return m},set:function(t){m=t}},showDistY:{get:function(){return y},set:function(t){y=t}},showLegend:{get:function(){return b},set:function(t){b=t}},showXAxis:{get:function(){return x},set:function(t){x=t}},showYAxis:{get:function(){return _},set:function(t){_=t}},defaultState:{get:function(){return M},set:function(t){M=t}},noData:{get:function(){return S},set:function(t){S=t}},duration:{get:function(){return L},set:function(t){L=t}},showLabels:{get:function(){return A},set:function(t){A=t}},margin:{get:function(){return u},set:function(t){void 0!==t.top&&(u.top=t.top,c=t.top),u.right=void 0!==t.right?t.right:u.right,u.bottom=void 0!==t.bottom?t.bottom:u.bottom,u.left=void 0!==t.left?t.left:u.left}},rightAlignYAxis:{get:function(){return w},set:function(t){w=t,i.orient(t?"right":"left")}},color:{get:function(){return f},set:function(e){f=t.utils.getColor(e),o.color(f),a.color(f),s.color(f)}}}),t.utils.inheritOptions(e,n),t.utils.initOptions(e),e},t.models.sparkline=function(){"use strict";function e(c){return b.reset(),c.each(function(e){var c=s-a.left-a.right,y=l-a.top-a.bottom;u=d3.select(this),t.utils.initSVG(u),d.domain(n||d3.extent(e,p)).range(i||[0,c]),h.domain(r||d3.extent(e,f)).range(o||[y,0]);var b=u.selectAll("g.nv-wrap.nv-sparkline").data([e]),x=b.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");x.append("g"),b.select("g");b.attr("transform","translate("+a.left+","+a.top+")");var _=b.selectAll("path").data(function(t){return[t]});_.enter().append("path"),_.exit().remove(),_.style("stroke",function(t,e){return t.color||g(t,e)}).attr("d",d3.svg.line().x(function(t,e){return d(p(t,e));
}).y(function(t,e){return h(f(t,e))}));var w=b.selectAll("circle.nv-point").data(function(t){function e(e){if(e!=-1){var n=t[e];return n.pointIndex=e,n}return null}var n=t.map(function(t,e){return f(t,e)}),r=e(n.lastIndexOf(h.domain()[1])),i=e(n.indexOf(h.domain()[0])),o=e(n.length-1);return[v?i:null,v?r:null,m?o:null].filter(function(t){return null!=t})});w.enter().append("circle"),w.exit().remove(),w.attr("cx",function(t,e){return d(p(t,t.pointIndex))}).attr("cy",function(t,e){return h(f(t,t.pointIndex))}).attr("r",2).attr("class",function(t,e){return p(t,t.pointIndex)==d.domain()[1]?"nv-point nv-currentValue":f(t,t.pointIndex)==h.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})}),b.renderEnd("sparkline immediate"),e}var n,r,i,o,a={top:2,right:0,bottom:2,left:0},s=400,l=32,u=null,c=!0,d=d3.scale.linear(),h=d3.scale.linear(),p=function(t){return t.x},f=function(t){return t.y},g=t.utils.getColor(["#000"]),v=!0,m=!0,y=d3.dispatch("renderEnd"),b=t.utils.renderWatch(y);return e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return s},set:function(t){s=t}},height:{get:function(){return l},set:function(t){l=t}},xDomain:{get:function(){return n},set:function(t){n=t}},yDomain:{get:function(){return r},set:function(t){r=t}},xRange:{get:function(){return i},set:function(t){i=t}},yRange:{get:function(){return o},set:function(t){o=t}},xScale:{get:function(){return d},set:function(t){d=t}},yScale:{get:function(){return h},set:function(t){h=t}},animate:{get:function(){return c},set:function(t){c=t}},showMinMaxPoints:{get:function(){return v},set:function(t){v=t}},showCurrentPoint:{get:function(){return m},set:function(t){m=t}},x:{get:function(){return p},set:function(t){p=d3.functor(t)}},y:{get:function(){return f},set:function(t){f=d3.functor(t)}},margin:{get:function(){return a},set:function(t){a.top=void 0!==t.top?t.top:a.top,a.right=void 0!==t.right?t.right:a.right,a.bottom=void 0!==t.bottom?t.bottom:a.bottom,a.left=void 0!==t.left?t.left:a.left}},color:{get:function(){return g},set:function(e){g=t.utils.getColor(e)}}}),e.dispatch=y,t.utils.initOptions(e),e},t.models.sparklinePlus=function(){"use strict";function e(g){return m.reset(),m.models(i),g.each(function(g){function v(){if(!u){var t=C.selectAll(".nv-hoverValue").data(l),e=t.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);t.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove(),t.attr("transform",function(t){return"translate("+n(i.x()(g[t],t))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1),l.length&&(e.append("line").attr("x1",0).attr("y1",-o.top).attr("x2",0).attr("y2",x),e.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-o.top).attr("text-anchor","end").attr("dy",".9em"),C.select(".nv-hoverValue .nv-xValue").text(c(i.x()(g[l[0]],l[0]))),e.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-o.top).attr("text-anchor","start").attr("dy",".9em"),C.select(".nv-hoverValue .nv-yValue").text(d(i.y()(g[l[0]],l[0]))))}}function m(){function t(t,e){for(var n=Math.abs(i.x()(t[0],0)-e),r=0,o=0;o<t.length;o++)Math.abs(i.x()(t[o],o)-e)<n&&(n=Math.abs(i.x()(t[o],o)-e),r=o);return r}if(!u){var e=d3.mouse(this)[0]-o.left;l=[t(g,Math.round(n.invert(e)))],v()}}var y=d3.select(this);t.utils.initSVG(y);var b=t.utils.availableWidth(a,y,o),x=t.utils.availableHeight(s,y,o);if(e.update=function(){y.call(e)},e.container=this,!g||!g.length)return t.utils.noData(e,y),e;y.selectAll(".nv-noData").remove();var _=i.y()(g[g.length-1],g.length-1);n=i.xScale(),r=i.yScale();var w=y.selectAll("g.nv-wrap.nv-sparklineplus").data([g]),k=w.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus"),M=k.append("g"),C=w.select("g");M.append("g").attr("class","nv-sparklineWrap"),M.append("g").attr("class","nv-valueWrap"),M.append("g").attr("class","nv-hoverArea"),w.attr("transform","translate("+o.left+","+o.top+")");var S=C.select(".nv-sparklineWrap");if(i.width(b).height(x),S.call(i),h){var L=C.select(".nv-valueWrap"),A=L.selectAll(".nv-currentValue").data([_]);A.enter().append("text").attr("class","nv-currentValue").attr("dx",f?-8:8).attr("dy",".9em").style("text-anchor",f?"end":"start"),A.attr("x",b+(f?o.right:0)).attr("y",p?function(t){return r(t)}:0).style("fill",i.color()(g[g.length-1],g.length-1)).text(d(_))}M.select(".nv-hoverArea").append("rect").on("mousemove",m).on("click",function(){u=!u}).on("mouseout",function(){l=[],v()}),C.select(".nv-hoverArea rect").attr("transform",function(t){return"translate("+-o.left+","+-o.top+")"}).attr("width",b+o.left+o.right).attr("height",x+o.top)}),m.renderEnd("sparklinePlus immediate"),e}var n,r,i=t.models.sparkline(),o={top:15,right:100,bottom:10,left:50},a=null,s=null,l=[],u=!1,c=d3.format(",r"),d=d3.format(",.2f"),h=!0,p=!0,f=!1,g=null,v=d3.dispatch("renderEnd"),m=t.utils.renderWatch(v);return e.dispatch=v,e.sparkline=i,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return a},set:function(t){a=t}},height:{get:function(){return s},set:function(t){s=t}},xTickFormat:{get:function(){return c},set:function(t){c=t}},yTickFormat:{get:function(){return d},set:function(t){d=t}},showLastValue:{get:function(){return h},set:function(t){h=t}},alignValue:{get:function(){return p},set:function(t){p=t}},rightAlignValue:{get:function(){return f},set:function(t){f=t}},noData:{get:function(){return g},set:function(t){g=t}},margin:{get:function(){return o},set:function(t){o.top=void 0!==t.top?t.top:o.top,o.right=void 0!==t.right?t.right:o.right,o.bottom=void 0!==t.bottom?t.bottom:o.bottom,o.left=void 0!==t.left?t.left:o.left}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.stackedArea=function(){"use strict";function e(p){return _.reset(),_.models(y),p.each(function(p){var b=o-i.left-i.right,w=a-i.top-i.bottom;u=d3.select(this),t.utils.initSVG(u),n=y.xScale(),r=y.yScale();var k=p;p.forEach(function(t,e){t.seriesIndex=e,t.values=t.values.map(function(t,n){return t.index=n,t.seriesIndex=e,t})});var M=p.filter(function(t){return!t.disabled});p=d3.layout.stack().order(g).offset(f).values(function(t){return t.values}).x(c).y(d).out(function(t,e,n){t.display={y:n,y0:e}})(M);var C=u.selectAll("g.nv-wrap.nv-stackedarea").data([p]),S=C.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea"),L=S.append("defs"),A=S.append("g"),E=C.select("g");A.append("g").attr("class","nv-areaWrap"),A.append("g").attr("class","nv-scatterWrap"),C.attr("transform","translate("+i.left+","+i.top+")"),0==y.forceY().length&&y.forceY().push(0),y.width(b).height(w).x(c).y(function(t){if(void 0!==t.display)return t.display.y+t.display.y0}).color(p.map(function(t,e){return t.color=t.color||s(t,t.seriesIndex),t.color}));var T=E.select(".nv-scatterWrap").datum(p);T.call(y),L.append("clipPath").attr("id","nv-edge-clip-"+l).append("rect"),C.select("#nv-edge-clip-"+l+" rect").attr("width",b).attr("height",w),E.attr("clip-path",m?"url(#nv-edge-clip-"+l+")":"");var P=d3.svg.area().defined(h).x(function(t,e){return n(c(t,e))}).y0(function(t){return r(t.display.y0)}).y1(function(t){return r(t.display.y+t.display.y0)}).interpolate(v),D=d3.svg.area().defined(h).x(function(t,e){return n(c(t,e))}).y0(function(t){return r(t.display.y0)}).y1(function(t){return r(t.display.y0)}),O=E.select(".nv-areaWrap").selectAll("path.nv-area").data(function(t){return t});O.enter().append("path").attr("class",function(t,e){return"nv-area nv-area-"+e}).attr("d",function(t,e){return D(t.values,t.seriesIndex)}).on("mouseover",function(t,e){d3.select(this).classed("hover",!0),x.areaMouseover({point:t,series:t.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t.seriesIndex})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1),x.areaMouseout({point:t,series:t.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t.seriesIndex})}).on("click",function(t,e){d3.select(this).classed("hover",!1),x.areaClick({point:t,series:t.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t.seriesIndex})}),O.exit().remove(),O.style("fill",function(t,e){return t.color||s(t,t.seriesIndex)}).style("stroke",function(t,e){return t.color||s(t,t.seriesIndex)}),O.watchTransition(_,"stackedArea path").attr("d",function(t,e){return P(t.values,e)}),y.dispatch.on("elementMouseover.area",function(t){E.select(".nv-chart-"+l+" .nv-area-"+t.seriesIndex).classed("hover",!0)}),y.dispatch.on("elementMouseout.area",function(t){E.select(".nv-chart-"+l+" .nv-area-"+t.seriesIndex).classed("hover",!1)}),e.d3_stackedOffset_stackPercent=function(t){var e,n,r,i=t.length,o=t[0].length,a=[];for(n=0;n<o;++n){for(e=0,r=0;e<k.length;e++)r+=d(k[e].values[n]);if(r)for(e=0;e<i;e++)t[e][n][1]/=r;else for(e=0;e<i;e++)t[e][n][1]=0}for(n=0;n<o;++n)a[n]=0;return a}}),_.renderEnd("stackedArea immediate"),e}var n,r,i={top:0,right:0,bottom:0,left:0},o=960,a=500,s=t.utils.defaultColor(),l=Math.floor(1e5*Math.random()),u=null,c=function(t){return t.x},d=function(t){return t.y},h=function(t,e){return!isNaN(d(t,e))&&null!==d(t,e)},p="stack",f="zero",g="default",v="linear",m=!1,y=t.models.scatter(),b=250,x=d3.dispatch("areaClick","areaMouseover","areaMouseout","renderEnd","elementClick","elementMouseover","elementMouseout");y.pointSize(2.2).pointDomain([2.2,2.2]);var _=t.utils.renderWatch(x,b);return e.dispatch=x,e.scatter=y,y.dispatch.on("elementClick",function(){x.elementClick.apply(this,arguments)}),y.dispatch.on("elementMouseover",function(){x.elementMouseover.apply(this,arguments)}),y.dispatch.on("elementMouseout",function(){x.elementMouseout.apply(this,arguments)}),e.interpolate=function(t){return arguments.length?(v=t,e):v},e.duration=function(t){return arguments.length?(b=t,_.reset(b),y.duration(b),e):b},e.dispatch=x,e.scatter=y,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return o},set:function(t){o=t}},height:{get:function(){return a},set:function(t){a=t}},defined:{get:function(){return h},set:function(t){h=t}},clipEdge:{get:function(){return m},set:function(t){m=t}},offset:{get:function(){return f},set:function(t){f=t}},order:{get:function(){return g},set:function(t){g=t}},interpolate:{get:function(){return v},set:function(t){v=t}},x:{get:function(){return c},set:function(t){c=d3.functor(t)}},y:{get:function(){return d},set:function(t){d=d3.functor(t)}},margin:{get:function(){return i},set:function(t){i.top=void 0!==t.top?t.top:i.top,i.right=void 0!==t.right?t.right:i.right,i.bottom=void 0!==t.bottom?t.bottom:i.bottom,i.left=void 0!==t.left?t.left:i.left}},color:{get:function(){return s},set:function(e){s=t.utils.getColor(e)}},style:{get:function(){return p},set:function(t){switch(p=t){case"stack":e.offset("zero"),e.order("default");break;case"stream":e.offset("wiggle"),e.order("inside-out");break;case"stream-center":e.offset("silhouette"),e.order("inside-out");break;case"expand":e.offset("expand"),e.order("default");break;case"stack_percent":e.offset(e.d3_stackedOffset_stackPercent),e.order("default")}}},duration:{get:function(){return b},set:function(t){b=t,_.reset(b),y.duration(b)}}}),t.utils.inheritOptions(e,y),t.utils.initOptions(e),e},t.models.stackedAreaChart=function(){"use strict";function e(c){return G.reset(),G.models(i),x&&G.models(o),_&&G.models(a),c.each(function(c){function E(){x&&Y.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+$+")").transition().duration(N).call(o)}function G(){if(_){if("expand"===i.style()||"stack_percent"===i.style()){var t=a.tickFormat();I&&t===B||(I=t),a.tickFormat(B)}else I&&(a.tickFormat(I),I=null);Y.select(".nv-focus .nv-y.nv-axis").transition().duration(0).call(a)}}function H(t){var e=Y.select(".nv-focus .nv-stackedWrap").datum(c.filter(function(t){return!t.disabled}).map(function(e,n){return{key:e.key,area:e.area,classed:e.classed,values:e.values.filter(function(e,n){return i.x()(e,n)>=t[0]&&i.x()(e,n)<=t[1]}),disableTooltip:e.disableTooltip}}));e.transition().duration(N).call(i),E(),G()}var j=d3.select(this);t.utils.initSVG(j);var V=t.utils.availableWidth(f,j,h),$=t.utils.availableHeight(g,j,h)-(k?d.height():0);if(e.update=function(){j.transition().duration(N).call(e)},e.container=this,L.setter(R(c),e.update).getter(F(c)).update(),L.disabled=c.map(function(t){return!!t.disabled}),!A){var q;A={};for(q in L)L[q]instanceof Array?A[q]=L[q].slice(0):A[q]=L[q]}if(!(c&&c.length&&c.filter(function(t){return t.values.length}).length))return t.utils.noData(e,j),e;j.selectAll(".nv-noData").remove(),n=i.xScale(),r=i.yScale();var U=j.selectAll("g.nv-wrap.nv-stackedAreaChart").data([c]),X=U.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g"),Y=U.select("g");X.append("g").attr("class","nv-legendWrap"),X.append("g").attr("class","nv-controlsWrap");var K=X.append("g").attr("class","nv-focus");K.append("g").attr("class","nv-background").append("rect"),K.append("g").attr("class","nv-x nv-axis"),K.append("g").attr("class","nv-y nv-axis"),K.append("g").attr("class","nv-stackedWrap"),K.append("g").attr("class","nv-interactive");X.append("g").attr("class","nv-focusWrap");if(y){var Z=m&&"top"===b?V-P:V;if(s.width(Z),Y.select(".nv-legendWrap").datum(c).call(s),"bottom"===b){var Q=(x?12:0)+10;h.bottom=Math.max(s.height()+Q,h.bottom),$=t.utils.availableHeight(g,j,h)-(k?d.height():0);var J=$+Q;Y.select(".nv-legendWrap").attr("transform","translate(0,"+J+")")}else"top"===b&&(p||h.top==s.height()||(h.top=s.height(),$=t.utils.availableHeight(g,j,h)-(k?d.height():0)),Y.select(".nv-legendWrap").attr("transform","translate("+(V-Z)+","+-h.top+")"))}else Y.select(".nv-legendWrap").selectAll("*").remove();if(m){var tt=[{key:O.stacked||"Stacked",metaKey:"Stacked",disabled:"stack"!=i.style(),style:"stack"},{key:O.stream||"Stream",metaKey:"Stream",disabled:"stream"!=i.style(),style:"stream"},{key:O.expanded||"Expanded",metaKey:"Expanded",disabled:"expand"!=i.style(),style:"expand"},{key:O.stack_percent||"Stack %",metaKey:"Stack_Percent",disabled:"stack_percent"!=i.style(),style:"stack_percent"}];P=D.length/3*260,tt=tt.filter(function(t){return D.indexOf(t.metaKey)!==-1}),l.width(P).color(["#444","#444","#444"]),Y.select(".nv-controlsWrap").datum(tt).call(l);var et=Math.max(l.height(),y&&"top"===b?s.height():0);h.top!=et&&(h.top=et,$=t.utils.availableHeight(g,j,h)-(k?d.height():0)),Y.select(".nv-controlsWrap").attr("transform","translate(0,"+-h.top+")")}else Y.select(".nv-controlsWrap").selectAll("*").remove();U.attr("transform","translate("+h.left+","+h.top+")"),w&&Y.select(".nv-y.nv-axis").attr("transform","translate("+V+",0)"),M&&(u.width(V).height($).margin({left:h.left,top:h.top}).svgContainer(j).xScale(n),U.select(".nv-interactive").call(u)),Y.select(".nv-focus .nv-background rect").attr("width",V).attr("height",$),i.width(V).height($).color(c.map(function(t,e){return t.color||v(t,e)}).filter(function(t,e){return!c[e].disabled}));var nt=Y.select(".nv-focus .nv-stackedWrap").datum(c.filter(function(t){return!t.disabled}));if(x&&o.scale(n)._ticks(t.utils.calcTicksX(V/100,c)).tickSize(-$,0),_){var rt;rt="wiggle"===i.offset()?0:t.utils.calcTicksY($/36,c),a.scale(r)._ticks(rt).tickSize(-V,0)}if(k){d.width(V),Y.select(".nv-focusWrap").attr("transform","translate(0,"+($+h.bottom+d.margin().top)+")").datum(c.filter(function(t){return!t.disabled})).call(d);var it=d.brush.empty()?d.xDomain():d.brush.extent();null!==it&&H(it)}else nt.transition().call(i),E(),G();i.dispatch.on("areaClick.toggle",function(t){1===c.filter(function(t){return!t.disabled}).length?c.forEach(function(t){t.disabled=!1}):c.forEach(function(e,n){e.disabled=n!=t.seriesIndex}),L.disabled=c.map(function(t){return!!t.disabled}),T.stateChange(L),e.update()}),s.dispatch.on("stateChange",function(t){for(var n in t)L[n]=t[n];T.stateChange(L),e.update()}),l.dispatch.on("legendClick",function(t,n){t.disabled&&(tt=tt.map(function(t){return t.disabled=!0,t}),t.disabled=!1,i.style(t.style),L.style=i.style(),T.stateChange(L),e.update())}),u.dispatch.on("elementMousemove",function(n){i.clearHighlights();var r,o,a,s=[],l=0,d=!0;if(c.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(u,c){o=t.interactiveBisect(u.values,n.pointXValue,e.x());var h=u.values[o],p=e.y()(h,o);if(null!=p&&i.highlightPoint(c,o,!0),"undefined"!=typeof h){"undefined"==typeof r&&(r=h),"undefined"==typeof a&&(a=e.xScale()(e.x()(h,o)));var f="expand"==i.style()?h.display.y:e.y()(h,o);s.push({key:u.key,value:f,color:v(u,u.seriesIndex),point:h}),C&&"expand"!=i.style()&&null!=f&&(l+=f,d=!1)}}),s.reverse(),s.length>2){var h=e.yScale().invert(n.mouseY),p=null;s.forEach(function(t,e){h=Math.abs(h);var n=Math.abs(t.point.display.y0),r=Math.abs(t.point.display.y);if(h>=n&&h<=r+n)return void(p=e)}),null!=p&&(s[p].highlight=!0)}C&&"expand"!=i.style()&&s.length>=2&&!d&&s.push({key:S,value:l,total:!0});var f=e.x()(r,o),g=u.tooltip.valueFormatter();"expand"===i.style()||"stack_percent"===i.style()?(z||(z=g),g=d3.format(".1%")):z&&(g=z,z=null),u.tooltip.valueFormatter(g).data({value:f,series:s})(),u.renderGuideLine(a)}),u.dispatch.on("elementMouseout",function(t){i.clearHighlights()}),d.dispatch.on("onBrush",function(t){H(t)}),T.on("changeState",function(t){"undefined"!=typeof t.disabled&&c.length===t.disabled.length&&(c.forEach(function(e,n){e.disabled=t.disabled[n]}),L.disabled=t.disabled),"undefined"!=typeof t.style&&(i.style(t.style),W=t.style),e.update()})}),G.renderEnd("stacked Area chart immediate"),e}var n,r,i=t.models.stackedArea(),o=t.models.axis(),a=t.models.axis(),s=t.models.legend(),l=t.models.legend(),u=t.interactiveGuideline(),c=t.models.tooltip(),d=t.models.focus(t.models.stackedArea()),h={top:10,right:25,bottom:50,left:60},p=null,f=null,g=null,v=t.utils.defaultColor(),m=!0,y=!0,b="top",x=!0,_=!0,w=!1,k=!1,M=!1,C=!0,S="TOTAL",L=t.utils.state(),A=null,E=null,T=d3.dispatch("stateChange","changeState","renderEnd"),P=250,D=["Stacked","Stream","Expanded"],O={},N=250;L.style=i.style(),o.orient("bottom").tickPadding(7),a.orient(w?"right":"left"),c.headerFormatter(function(t,e){return o.tickFormat()(t,e)}).valueFormatter(function(t,e){return a.tickFormat()(t,e)}),u.tooltip.headerFormatter(function(t,e){return o.tickFormat()(t,e)}).valueFormatter(function(t,e){return null==t?"N/A":a.tickFormat()(t,e)});var I=null,z=null;l.updateState(!1);var G=t.utils.renderWatch(T),W=i.style(),F=function(t){return function(){return{active:t.map(function(t){return!t.disabled}),style:i.style()}}},R=function(t){return function(e){void 0!==e.style&&(W=e.style),void 0!==e.active&&t.forEach(function(t,n){t.disabled=!e.active[n]})}},B=d3.format("%");return i.dispatch.on("elementMouseover.tooltip",function(t){t.point.x=i.x()(t.point),t.point.y=i.y()(t.point),c.data(t).hidden(!1)}),i.dispatch.on("elementMouseout.tooltip",function(t){c.hidden(!0)}),e.dispatch=T,e.stacked=i,e.legend=s,e.controls=l,e.xAxis=o,e.x2Axis=d.xAxis,e.yAxis=a,e.y2Axis=d.yAxis,e.interactiveLayer=u,e.tooltip=c,e.focus=d,e.dispatch=T,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return f},set:function(t){f=t}},height:{get:function(){return g},set:function(t){g=t}},showLegend:{get:function(){return y},set:function(t){y=t}},legendPosition:{get:function(){return b},set:function(t){b=t}},showXAxis:{get:function(){return x},set:function(t){x=t}},showYAxis:{get:function(){return _},set:function(t){_=t}},defaultState:{get:function(){return A},set:function(t){A=t}},noData:{get:function(){return E},set:function(t){E=t}},showControls:{get:function(){return m},set:function(t){m=t}},controlLabels:{get:function(){return O},set:function(t){O=t}},controlOptions:{get:function(){return D},set:function(t){D=t}},showTotalInTooltip:{get:function(){return C},set:function(t){C=t}},totalLabel:{get:function(){return S},set:function(t){S=t}},focusEnable:{get:function(){return k},set:function(t){k=t}},focusHeight:{get:function(){return d.height()},set:function(t){d.height(t)}},brushExtent:{get:function(){return d.brushExtent()},set:function(t){d.brushExtent(t)}},margin:{get:function(){return h},set:function(t){void 0!==t.top&&(h.top=t.top,p=t.top),h.right=void 0!==t.right?t.right:h.right,h.bottom=void 0!==t.bottom?t.bottom:h.bottom,h.left=void 0!==t.left?t.left:h.left}},focusMargin:{get:function(){return d.margin},set:function(t){d.margin.top=void 0!==t.top?t.top:d.margin.top,d.margin.right=void 0!==t.right?t.right:d.margin.right,d.margin.bottom=void 0!==t.bottom?t.bottom:d.margin.bottom,d.margin.left=void 0!==t.left?t.left:d.margin.left}},duration:{get:function(){return N},set:function(t){N=t,G.reset(N),i.duration(N),o.duration(N),a.duration(N)}},color:{get:function(){return v},set:function(e){v=t.utils.getColor(e),s.color(v),i.color(v),d.color(v)}},x:{get:function(){return i.x()},set:function(t){i.x(t),d.x(t)}},y:{get:function(){return i.y()},set:function(t){i.y(t),d.y(t)}},rightAlignYAxis:{get:function(){return w},set:function(t){w=t,a.orient(w?"right":"left")}},useInteractiveGuideline:{get:function(){return M},set:function(t){M=!!t,e.interactive(!t),e.useVoronoi(!t),i.scatter.interactive(!t)}}}),t.utils.inheritOptions(e,i),t.utils.initOptions(e),e},t.models.stackedAreaWithFocusChart=function(){return t.models.stackedAreaChart().margin({bottom:30}).focusEnable(!0)},t.models.sunburst=function(){"use strict";function e(t){var e=n(t);return e>90?180:0}function n(t){var e=Math.max(0,Math.min(2*Math.PI,P(t.x))),n=Math.max(0,Math.min(2*Math.PI,P(t.x+t.dx))),r=(e+n)/2*(180/Math.PI)-90;return r}function r(t){var e=Math.max(0,Math.min(2*Math.PI,P(t.x))),n=Math.max(0,Math.min(2*Math.PI,P(t.x+t.dx)));return(n-e)/(2*Math.PI)}function i(t){var e=Math.max(0,Math.min(2*Math.PI,P(t.x))),n=Math.max(0,Math.min(2*Math.PI,P(t.x+t.dx))),r=n-e;return r>C}function o(t,e){var n=d3.interpolate(P.domain(),[d.x,d.x+d.dx]),r=d3.interpolate(D.domain(),[d.y,1]),i=d3.interpolate(D.range(),[d.y?20:0,f]);return 0===e?function(){return I(t)}:function(e){return P.domain(n(e)),D.domain(r(e)).range(i(e)),I(t)}}function a(t){var e=d3.interpolate({x:t.x0,dx:t.dx0,y:t.y0,dy:t.dy0},t);return function(n){var r=e(n);return t.x0=r.x,t.dx0=r.dx,t.y0=r.y,t.dy0=r.dy,I(r)}}function s(t){var e=L(t);N[e]||(N[e]={});var n=N[e];n.dx=t.dx,n.x=t.x,n.dy=t.dy,n.y=t.y}function l(t){t.forEach(function(t){var e=L(t),n=N[e];n?(t.dx0=n.dx,t.x0=n.x,t.dy0=n.dy,t.y0=n.y):(t.dx0=t.dx,t.x0=t.x,t.dy0=t.dy,t.y0=t.y),s(t)})}function u(t){var r=_.selectAll("text"),a=_.selectAll("path");r.transition().attr("opacity",0),d=t,a.transition().duration(E).attrTween("d",o).each("end",function(r){if(r.x>=t.x&&r.x<t.x+t.dx&&r.depth>=t.depth){var o=d3.select(this.parentNode),a=o.select("text");a.transition().duration(E).text(function(t){return M(t)}).attr("opacity",function(t){return i(t)?1:0}).attr("transform",function(){var i=this.getBBox().width;if(0===r.depth)return"translate("+i/2*-1+",0)";if(r.depth===t.depth)return"translate("+(D(r.y)+5)+",0)";var o=n(r),a=e(r);return 0===a?"rotate("+o+")translate("+(D(r.y)+5)+",0)":"rotate("+o+")translate("+(D(r.y)+i+5)+",0)rotate("+a+")"})}})}function c(o){return z.reset(),o.each(function(o){_=d3.select(this),h=t.utils.availableWidth(v,_,g),p=t.utils.availableHeight(m,_,g),f=Math.min(h,p)/2,D.range([0,f]);var s=_.select("g.nvd3.nv-wrap.nv-sunburst");s[0][0]?s.attr("transform","translate("+(h/2+g.left+g.right)+","+(p/2+g.top+g.bottom)+")"):s=_.append("g").attr("class","nvd3 nv-wrap nv-sunburst nv-chart-"+x).attr("transform","translate("+(h/2+g.left+g.right)+","+(p/2+g.top+g.bottom)+")"),_.on("click",function(t,e){T.chartClick({data:t,index:e,pos:d3.event,id:x})}),O.value(b[y]||b.count);var c=O.nodes(o[0]).reverse();l(c);var d=s.selectAll(".arc-container").data(c,L),C=d.enter().append("g").attr("class","arc-container");C.append("path").attr("d",I).style("fill",function(t){return t.color?t.color:w(A?(t.children?t:t.parent).name:t.name)}).style("stroke","#FFF").on("click",function(t,e){u(t),T.elementClick({data:t,index:e})}).on("mouseover",function(t,e){d3.select(this).classed("hover",!0).style("opacity",.8),T.elementMouseover({data:t,color:d3.select(this).style("fill"),percent:r(t)})}).on("mouseout",function(t,e){d3.select(this).classed("hover",!1).style("opacity",1),T.elementMouseout({data:t})}).on("mousemove",function(t,e){T.elementMousemove({data:t})}),d.each(function(t){d3.select(this).select("path").transition().duration(E).attrTween("d",a)}),k&&(d.selectAll("text").remove(),d.append("text").text(function(t){return M(t)}).transition().duration(E).attr("opacity",function(t){return i(t)?1:0}).attr("transform",function(t){var r=this.getBBox().width;if(0===t.depth)return"rotate(0)translate("+r/2*-1+",0)";var i=n(t),o=e(t);return 0===o?"rotate("+i+")translate("+(D(t.y)+5)+",0)":"rotate("+i+")translate("+(D(t.y)+r+5)+",0)rotate("+o+")"})),u(c[c.length-1]),d.exit().transition().duration(E).attr("opacity",0).each("end",function(t){var e=L(t);N[e]=void 0}).remove()}),z.renderEnd("sunburst immediate"),c}var d,h,p,f,g={top:0,right:0,bottom:0,left:0},v=600,m=600,y="count",b={count:function(t){return 1},value:function(t){return t.value||t.size},size:function(t){return t.value||t.size}},x=Math.floor(1e4*Math.random()),_=null,w=t.utils.defaultColor(),k=!1,M=function(t){return"count"===y?t.name+" #"+t.value:t.name+" "+(t.value||t.size)},C=.02,S=function(t,e){return t.name>e.name},L=function(t,e){return t.name},A=!0,E=500,T=d3.dispatch("chartClick","elementClick","elementDblClick","elementMousemove","elementMouseover","elementMouseout","renderEnd"),P=d3.scale.linear().range([0,2*Math.PI]),D=d3.scale.sqrt(),O=d3.layout.partition().sort(S),N={},I=d3.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,P(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,P(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,D(t.y))}).outerRadius(function(t){return Math.max(0,D(t.y+t.dy))}),z=t.utils.renderWatch(T);return c.dispatch=T,c.options=t.utils.optionsFunc.bind(c),c._options=Object.create({},{width:{get:function(){return v},set:function(t){v=t}},height:{get:function(){return m},set:function(t){m=t}},mode:{get:function(){return y},set:function(t){y=t}},id:{get:function(){return x},set:function(t){x=t}},duration:{get:function(){return E},set:function(t){E=t}},groupColorByParent:{get:function(){return A},set:function(t){A=!!t}},showLabels:{get:function(){return k},set:function(t){k=!!t}},labelFormat:{get:function(){return M},set:function(t){M=t}},labelThreshold:{get:function(){return C},set:function(t){C=t}},sort:{get:function(){return S},set:function(t){S=t}},key:{get:function(){return L},set:function(t){L=t}},margin:{get:function(){return g},set:function(t){g.top=void 0!=t.top?t.top:g.top,g.right=void 0!=t.right?t.right:g.right,g.bottom=void 0!=t.bottom?t.bottom:g.bottom,g.left=void 0!=t.left?t.left:g.left}},color:{get:function(){return w},set:function(e){w=t.utils.getColor(e)}}}),t.utils.initOptions(c),c},t.models.sunburstChart=function(){"use strict";function e(r){return p.reset(),p.models(n),r.each(function(r){var s=d3.select(this);t.utils.initSVG(s);var l=t.utils.availableWidth(o,s,i),u=t.utils.availableHeight(a,s,i);return e.update=function(){0===d?s.call(e):s.transition().duration(d).call(e)},e.container=s,r&&r.length?(s.selectAll(".nv-noData").remove(),n.width(l).height(u).margin(i),void s.call(n)):(t.utils.noData(e,s),e)}),p.renderEnd("sunburstChart immediate"),e}var n=t.models.sunburst(),r=t.models.tooltip(),i={top:30,right:20,bottom:20,left:20},o=null,a=null,s=t.utils.defaultColor(),l=!1,u=(Math.round(1e5*Math.random()),null),c=null,d=250,h=d3.dispatch("stateChange","changeState","renderEnd"),p=t.utils.renderWatch(h);return r.duration(0).headerEnabled(!1).valueFormatter(function(t){return t}),n.dispatch.on("elementMouseover.tooltip",function(t){t.series={key:t.data.name,value:t.data.value||t.data.size,color:t.color,percent:t.percent},l||(delete t.percent,delete t.series.percent),r.data(t).hidden(!1)}),n.dispatch.on("elementMouseout.tooltip",function(t){r.hidden(!0)}),n.dispatch.on("elementMousemove.tooltip",function(t){r()}),e.dispatch=h,e.sunburst=n,e.tooltip=r,e.options=t.utils.optionsFunc.bind(e),e._options=Object.create({},{noData:{get:function(){return c},set:function(t){c=t}},defaultState:{get:function(){return u},set:function(t){u=t}},showTooltipPercent:{get:function(){return l},set:function(t){l=t}},color:{get:function(){return s},set:function(t){s=t,n.color(s)}},duration:{get:function(){return d},set:function(t){d=t,p.reset(d),n.duration(d)}},margin:{get:function(){return i},set:function(t){i.top=void 0!==t.top?t.top:i.top,i.right=void 0!==t.right?t.right:i.right,i.bottom=void 0!==t.bottom?t.bottom:i.bottom,i.left=void 0!==t.left?t.left:i.left,n.margin(i)}}}),t.utils.inheritOptions(e,n),t.utils.initOptions(e),e},t.version="1.8.5"}(),function(t){"use strict";function e(){}function n(t){if(!t||"object"!=typeof t)return!1;var e=M(t)||vt;return/object|function/.test(typeof e.Element)?t instanceof e.Element:1===t.nodeType&&"string"==typeof t.nodeName}function r(t){return t===vt||!(!t||!t.Window)&&t instanceof t.Window}function i(t){return!!t&&t instanceof yt}function o(t){return a(t)&&void 0!==typeof t.length&&s(t.splice)}function a(t){return!!t&&"object"==typeof t}function s(t){return"function"==typeof t}function l(t){return"number"==typeof t}function u(t){return"boolean"==typeof t}function c(t){return"string"==typeof t}function d(t){return!!c(t)&&(mt.querySelector(t),!0)}function h(t,e){for(var n in e)t[n]=e[n];return t}function p(t,e){for(var n in e){var r=!1;for(var i in Kt)if(0===n.indexOf(i)&&Kt[i].test(n)){r=!0;break}r||(t[n]=e[n])}return t}function f(t,e){t.page=t.page||{},t.page.x=e.page.x,t.page.y=e.page.y,t.client=t.client||{},t.client.x=e.client.x,t.client.y=e.client.y,t.timeStamp=e.timeStamp}function g(t,e,n){var r=e.length>1?A(e):e[0];b(r,Ct,n),t.page.x=Ct.x,t.page.y=Ct.y,x(r,Ct,n),t.client.x=Ct.x,t.client.y=Ct.y,t.timeStamp=(new Date).getTime()}function v(t,e,n){t.page.x=n.page.x-e.page.x,t.page.y=n.page.y-e.page.y,t.client.x=n.client.x-e.client.x,t.client.y=n.client.y-e.client.y,t.timeStamp=(new Date).getTime()-e.timeStamp;var r=Math.max(t.timeStamp/1e3,.001);t.page.speed=Mt(t.page.x,t.page.y)/r,t.page.vx=t.page.x/r,t.page.vy=t.page.y/r,t.client.speed=Mt(t.client.x,t.page.y)/r,t.client.vx=t.client.x/r,t.client.vy=t.client.y/r}function m(t){return t instanceof vt.Event||Ot&&vt.Touch&&t instanceof vt.Touch}function y(t,e,n){return n=n||{},t=t||"page",n.x=e[t+"X"],n.y=e[t+"Y"],n}function b(t,e){return e=e||{},Vt&&m(t)?(y("screen",t,e),e.x+=vt.scrollX,e.y+=vt.scrollY):y("page",t,e),e}function x(t,e){return e=e||{},Vt&&m(t)?y("screen",t,e):y("client",t,e),e}function _(t){return t=t||vt,{x:t.scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}}function w(t){return l(t.pointerId)?t.pointerId:t.identifier}function k(t){return t instanceof _t?t.correspondingUseElement:t}function M(t){if(r(t))return t;var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||vt}function C(t){var e=t instanceof bt?t.getBoundingClientRect():t.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}function S(t){var e=C(t);if(!$t&&e){var n=_(M(t));e.left+=n.x,e.right+=n.x,e.top+=n.y,e.bottom+=n.y}return e}function L(t){var e=[];return o(t)?(e[0]=t[0],e[1]=t[1]):"touchend"===t.type?1===t.touches.length?(e[0]=t.touches[0],e[1]=t.changedTouches[0]):0===t.touches.length&&(e[0]=t.changedTouches[0],e[1]=t.changedTouches[1]):(e[0]=t.touches[0],e[1]=t.touches[1]),e}function A(t){for(var e,n={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},r=0;r<t.length;r++)for(e in n)n[e]+=t[r][e];for(e in n)n[e]/=t.length;return n}function E(t){if(t.length||t.touches&&t.touches.length>1){var e=L(t),n=Math.min(e[0].pageX,e[1].pageX),r=Math.min(e[0].pageY,e[1].pageY),i=Math.max(e[0].pageX,e[1].pageX),o=Math.max(e[0].pageY,e[1].pageY);return{x:n,y:r,left:n,top:r,width:i-n,height:o-r}}}function T(t,e){
e=e||Pt.deltaSource;var n=e+"X",r=e+"Y",i=L(t),o=i[0][n]-i[1][n],a=i[0][r]-i[1][r];return Mt(o,a)}function P(t,e,n){n=n||Pt.deltaSource;var r=n+"X",i=n+"Y",o=L(t),a=o[0][r]-o[1][r],s=o[0][i]-o[1][i],u=180*Math.atan(s/a)/Math.PI;if(l(e)){var c=u-e,d=c%360;d>315?u-=360+u/360|0:d>135?u-=180+u/360|0:d<-315?u+=360+u/360|0:d<-135&&(u+=180+u/360|0)}return u}function D(t,e){var r=t?t.options.origin:Pt.origin;return"parent"===r?r=W(e):"self"===r?r=t.getRect(e):d(r)&&(r=G(e,r)||{x:0,y:0}),s(r)&&(r=r(t&&e)),n(r)&&(r=S(r)),r.x="x"in r?r.x:r.left,r.y="y"in r?r.y:r.top,r}function O(t,e,n,r){var i=1-t;return i*i*e+2*i*t*n+t*t*r}function N(t,e,n,r,i,o,a){return{x:O(a,t,n,i),y:O(a,e,r,o)}}function I(t,e,n,r){return t/=r,-n*t*(t-2)+e}function z(t,e){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function G(t,e){for(var r=W(t);n(r);){if(ht(r,e))return r;r=W(r)}return null}function W(t){var e=t.parentNode;if(i(e)){for(;(e=e.host)&&i(e););return e}return e}function F(t,e){return t._context===e.ownerDocument||z(t._context,e)}function R(t,e,r){var i=t.options.ignoreFrom;return!(!i||!n(r))&&(c(i)?pt(r,i,e):!!n(i)&&z(i,r))}function B(t,e,r){var i=t.options.allowFrom;return!i||!!n(r)&&(c(i)?pt(r,i,e):!!n(i)&&z(i,r))}function H(t,e){if(!e)return!1;var n=e.options.drag.axis;return"xy"===t||"xy"===n||n===t}function j(t,e){var n=t.options;return/^resize/.test(e)&&(e="resize"),n[e].snap&&n[e].snap.enabled}function V(t,e){var n=t.options;return/^resize/.test(e)&&(e="resize"),n[e].restrict&&n[e].restrict.enabled}function $(t,e){var n=t.options;return/^resize/.test(e)&&(e="resize"),n[e].autoScroll&&n[e].autoScroll.enabled}function q(t,e,n){for(var r=t.options,i=r[n.name].max,o=r[n.name].maxPerElement,a=0,s=0,l=0,u=0,c=At.length;u<c;u++){var d=At[u],h=d.prepared.name,p=d.interacting();if(p){if(a++,a>=Wt)return!1;if(d.target===t){if(s+=h===n.name|0,s>=i)return!1;if(d.element===e&&(l++,h!==n.name||l>=o))return!1}}}return Wt>0}function U(t){var e,n,r,i,o,a=t[0],s=a?0:-1,l=[],u=[];for(i=1;i<t.length;i++)if(e=t[i],e&&e!==a)if(a){if(e.parentNode!==e.ownerDocument)if(a.parentNode!==e.ownerDocument){if(!l.length)for(n=a;n.parentNode&&n.parentNode!==n.ownerDocument;)l.unshift(n),n=n.parentNode;if(a instanceof wt&&e instanceof bt&&!(e instanceof xt)){if(e===a.parentNode)continue;n=e.ownerSVGElement}else n=e;for(u=[];n.parentNode!==n.ownerDocument;)u.unshift(n),n=n.parentNode;for(o=0;u[o]&&u[o]===l[o];)o++;var c=[u[o-1],u[o],l[o]];for(r=c[0].lastChild;r;){if(r===c[1]){a=e,s=i,l=[];break}if(r===c[2])break;r=r.previousSibling}}else a=e,s=i}else a=e,s=i;return s}function X(){if(this.target=null,this.element=null,this.dropTarget=null,this.dropElement=null,this.prevDropTarget=null,this.prevDropElement=null,this.prepared={name:null,axis:null,edges:null},this.matches=[],this.matchElements=[],this.inertiaStatus={active:!1,smoothEnd:!1,ending:!1,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,resumeDx:0,resumeDy:0,lambda_v0:0,one_ve_v0:0,i:null},s(Function.prototype.bind))this.boundInertiaFrame=this.inertiaFrame.bind(this),this.boundSmoothEndFrame=this.smoothEndFrame.bind(this);else{var t=this;this.boundInertiaFrame=function(){return t.inertiaFrame()},this.boundSmoothEndFrame=function(){return t.smoothEndFrame()}}this.activeDrops={dropzones:[],elements:[],rects:[]},this.pointers=[],this.pointerIds=[],this.downTargets=[],this.downTimes=[],this.holdTimers=[],this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0},this.downEvent=null,this.downPointer={},this._eventTarget=null,this._curEventTarget=null,this.prevEvent=null,this.tapTime=0,this.prevTap=null,this.startOffset={left:0,right:0,top:0,bottom:0},this.restrictOffset={left:0,right:0,top:0,bottom:0},this.snapOffsets=[],this.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0},this.snapStatus={x:0,y:0,dx:0,dy:0,realX:0,realY:0,snappedX:0,snappedY:0,targets:[],locked:!1,changed:!1},this.restrictStatus={dx:0,dy:0,restrictedX:0,restrictedY:0,snap:null,restricted:!1,changed:!1},this.restrictStatus.snap=this.snapStatus,this.pointerIsDown=!1,this.pointerWasMoved=!1,this.gesturing=!1,this.dragging=!1,this.resizing=!1,this.resizeAxes="xy",this.mouse=!1,At.push(this)}function Y(t,e,n){var r,i=0,o=At.length,a=/mouse/i.test(t.pointerType||e)||4===t.pointerType,s=w(t);if(/down|start/i.test(e))for(i=0;i<o;i++){r=At[i];var l=n;if(r.inertiaStatus.active&&r.target.options[r.prepared.name].inertia.allowResume&&r.mouse===a)for(;l;){if(l===r.element)return r;l=W(l)}}if(a||!Ot&&!Nt){for(i=0;i<o;i++)if(At[i].mouse&&!At[i].inertiaStatus.active)return At[i];for(i=0;i<o;i++)if(At[i].mouse&&(!/down/.test(e)||!At[i].inertiaStatus.active))return r;return r=new X,r.mouse=!0,r}for(i=0;i<o;i++)if(dt(At[i].pointerIds,s))return At[i];if(/up|end|out/i.test(e))return null;for(i=0;i<o;i++)if(r=At[i],(!r.prepared.name||r.target.options.gesture.enabled)&&!r.interacting()&&(a||!r.mouse))return r;return new X}function K(t){return function(e){var n,r,i=k(e.path?e.path[0]:e.target),o=k(e.currentTarget);if(Ot&&/touch/.test(e.type))for(Gt=(new Date).getTime(),r=0;r<e.changedTouches.length;r++){var a=e.changedTouches[r];n=Y(a,e.type,i),n&&(n._updateEventTargets(i,o),n[t](a,e,i,o))}else{if(!Nt&&/mouse/.test(e.type)){for(r=0;r<At.length;r++)if(!At[r].mouse&&At[r].pointerIsDown)return;if((new Date).getTime()-Gt<500)return}if(n=Y(e,e.type,i),!n)return;n._updateEventTargets(i,o),n[t](e,e,i,o)}}}function Z(t,e,n,r,i,o){var a,s,l=t.target,u=t.snapStatus,c=t.restrictStatus,d=t.pointers,p=(l&&l.options||Pt).deltaSource,f=p+"X",g=p+"Y",v=l?l.options:Pt,m=D(l,i),y="start"===r,b="end"===r,x=y?t.startCoords:t.curCoords;i=i||t.element,s=h({},x.page),a=h({},x.client),s.x-=m.x,s.y-=m.y,a.x-=m.x,a.y-=m.y;var _=v[n].snap&&v[n].snap.relativePoints;!j(l,n)||y&&_&&_.length||(this.snap={range:u.range,locked:u.locked,x:u.snappedX,y:u.snappedY,realX:u.realX,realY:u.realY,dx:u.dx,dy:u.dy},u.locked&&(s.x+=u.dx,s.y+=u.dy,a.x+=u.dx,a.y+=u.dy)),!V(l,n)||y&&v[n].restrict.elementRect||!c.restricted||(s.x+=c.dx,s.y+=c.dy,a.x+=c.dx,a.y+=c.dy,this.restrict={dx:c.dx,dy:c.dy}),this.pageX=s.x,this.pageY=s.y,this.clientX=a.x,this.clientY=a.y,this.x0=t.startCoords.page.x-m.x,this.y0=t.startCoords.page.y-m.y,this.clientX0=t.startCoords.client.x-m.x,this.clientY0=t.startCoords.client.y-m.y,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.button=e.button,this.buttons=e.buttons,this.target=i,this.t0=t.downTimes[0],this.type=n+(r||""),this.interaction=t,this.interactable=l;var w=t.inertiaStatus;if(w.active&&(this.detail="inertia"),o&&(this.relatedTarget=o),b?"client"===p?(this.dx=a.x-t.startCoords.client.x,this.dy=a.y-t.startCoords.client.y):(this.dx=s.x-t.startCoords.page.x,this.dy=s.y-t.startCoords.page.y):y?(this.dx=0,this.dy=0):"inertiastart"===r?(this.dx=t.prevEvent.dx,this.dy=t.prevEvent.dy):"client"===p?(this.dx=a.x-t.prevEvent.clientX,this.dy=a.y-t.prevEvent.clientY):(this.dx=s.x-t.prevEvent.pageX,this.dy=s.y-t.prevEvent.pageY),t.prevEvent&&"inertia"===t.prevEvent.detail&&!w.active&&v[n].inertia&&v[n].inertia.zeroResumeDelta&&(w.resumeDx+=this.dx,w.resumeDy+=this.dy,this.dx=this.dy=0),"resize"===n&&t.resizeAxes?v.resize.square?("y"===t.resizeAxes?this.dx=this.dy:this.dy=this.dx,this.axes="xy"):(this.axes=t.resizeAxes,"x"===t.resizeAxes?this.dy=0:"y"===t.resizeAxes&&(this.dx=0)):"gesture"===n&&(this.touches=[d[0],d[1]],y?(this.distance=T(d,p),this.box=E(d),this.scale=1,this.ds=0,this.angle=P(d,void 0,p),this.da=0):b||e instanceof Z?(this.distance=t.prevEvent.distance,this.box=t.prevEvent.box,this.scale=t.prevEvent.scale,this.ds=this.scale-1,this.angle=t.prevEvent.angle,this.da=this.angle-t.gesture.startAngle):(this.distance=T(d,p),this.box=E(d),this.scale=this.distance/t.gesture.startDistance,this.angle=P(d,t.gesture.prevAngle,p),this.ds=this.scale-t.gesture.prevScale,this.da=this.angle-t.gesture.prevAngle)),y)this.timeStamp=t.downTimes[0],this.dt=0,this.duration=0,this.speed=0,this.velocityX=0,this.velocityY=0;else if("inertiastart"===r)this.timeStamp=t.prevEvent.timeStamp,this.dt=t.prevEvent.dt,this.duration=t.prevEvent.duration,this.speed=t.prevEvent.speed,this.velocityX=t.prevEvent.velocityX,this.velocityY=t.prevEvent.velocityY;else if(this.timeStamp=(new Date).getTime(),this.dt=this.timeStamp-t.prevEvent.timeStamp,this.duration=this.timeStamp-t.downTimes[0],e instanceof Z){var k=this[f]-t.prevEvent[f],M=this[g]-t.prevEvent[g],C=this.dt/1e3;this.speed=Mt(k,M)/C,this.velocityX=k/C,this.velocityY=M/C}else this.speed=t.pointerDelta[p].speed,this.velocityX=t.pointerDelta[p].vx,this.velocityY=t.pointerDelta[p].vy;if((b||"inertiastart"===r)&&t.prevEvent.speed>600&&this.timeStamp-t.prevEvent.timeStamp<150){var S=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI,L=22.5;S<0&&(S+=360);var A=135-L<=S&&S<225+L,O=225-L<=S&&S<315+L,N=!A&&(315-L<=S||S<45+L),I=!O&&45-L<=S&&S<135+L;this.swipe={up:O,down:I,left:A,right:N,angle:S,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}}function Q(){this.originalEvent.preventDefault()}function J(t){var e="";if("drag"===t.name&&(e=Ft.drag),"resize"===t.name)if(t.axis)e=Ft[t.name+t.axis];else if(t.edges){for(var n="resize",r=["top","bottom","left","right"],i=0;i<4;i++)t.edges[r[i]]&&(n+=r[i]);e=Ft[n]}return e}function tt(t,e,r,i,o,a,s){if(!e)return!1;if(e===!0){var u=l(a.width)?a.width:a.right-a.left,c=l(a.height)?a.height:a.bottom-a.top;if(u<0&&("left"===t?t="right":"right"===t&&(t="left")),c<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t)return r.x<(u>=0?a.left:a.right)+s;if("top"===t)return r.y<(c>=0?a.top:a.bottom)+s;if("right"===t)return r.x>(u>=0?a.right:a.left)-s;if("bottom"===t)return r.y>(c>=0?a.bottom:a.top)-s}return!!n(i)&&(n(e)?e===i:pt(i,e,o))}function et(t,e,n){var r,i=this.getRect(n),o=!1,s=null,l=null,u=h({},e.curCoords.page),c=this.options;if(!i)return null;if(Rt.resize&&c.resize.enabled){var d=c.resize;if(r={left:!1,right:!1,top:!1,bottom:!1},a(d.edges)){for(var p in r)r[p]=tt(p,d.edges[p],u,e._eventTarget,n,i,d.margin||It);r.left=r.left&&!r.right,r.top=r.top&&!r.bottom,o=r.left||r.right||r.top||r.bottom}else{var f="y"!==c.resize.axis&&u.x>i.right-It,g="x"!==c.resize.axis&&u.y>i.bottom-It;o=f||g,l=(f?"x":"")+(g?"y":"")}}return s=o?"resize":Rt.drag&&c.drag.enabled?"drag":null,Rt.gesture&&e.pointerIds.length>=2&&!e.dragging&&!e.resizing&&(s="gesture"),s?{name:s,axis:l,edges:r}:null}function nt(t,e){if(!a(t))return null;var n=t.name,r=e.options;return("resize"===n&&r.resize.enabled||"drag"===n&&r.drag.enabled||"gesture"===n&&r.gesture.enabled)&&Rt[n]?("resize"!==n&&"resizeyx"!==n||(n="resizexy"),t):null}function rt(t,e){var r={},i=Tt[t.type],o=k(t.path?t.path[0]:t.target),a=o;e=!!e;for(var s in t)r[s]=t[s];for(r.originalEvent=t,r.preventDefault=Q;n(a);){for(var l=0;l<i.selectors.length;l++){var u=i.selectors[l],c=i.contexts[l];if(ht(a,u)&&z(c,o)&&z(c,a)){var d=i.listeners[l];r.currentTarget=a;for(var h=0;h<d.length;h++)d[h][1]===e&&d[h][0](r)}}a=W(a)}}function it(t){return rt.call(this,t,!0)}function ot(t,e){return Lt.get(t,e)||new at(t,e)}function at(t,e){this._element=t,this._iEvents=this._iEvents||{};var r;if(d(t)){this.selector=t;var i=e&&e.context;r=i?M(i):vt,i&&(r.Node?i instanceof r.Node:n(i)||i===r.document)&&(this._context=i)}else r=M(t),n(t,r)&&(Nt?(Yt.add(this._element,ft.down,Zt.pointerDown),Yt.add(this._element,ft.move,Zt.pointerHover)):(Yt.add(this._element,"mousedown",Zt.pointerDown),Yt.add(this._element,"mousemove",Zt.pointerHover),Yt.add(this._element,"touchstart",Zt.pointerDown),Yt.add(this._element,"touchmove",Zt.pointerHover)));this._doc=r.document,dt(St,this._doc)||ut(this._doc),Lt.push(this),this.set(e)}function st(t,e){var n=!1;return function(){return n||(vt.console.warn(e),n=!0),t.apply(this,arguments)}}function lt(t){for(var e=0;e<At.length;e++)At[e].pointerEnd(t,t)}function ut(t){if(!dt(St,t)){var e=t.defaultView||t.parentWindow;for(var n in Tt)Yt.add(t,n,rt),Yt.add(t,n,it,!0);Nt?(ft=kt===e.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"},Yt.add(t,ft.down,Zt.selectorDown),Yt.add(t,ft.move,Zt.pointerMove),Yt.add(t,ft.over,Zt.pointerOver),Yt.add(t,ft.out,Zt.pointerOut),Yt.add(t,ft.up,Zt.pointerUp),Yt.add(t,ft.cancel,Zt.pointerCancel),Yt.add(t,ft.move,Zt.autoScrollMove)):(Yt.add(t,"mousedown",Zt.selectorDown),Yt.add(t,"mousemove",Zt.pointerMove),Yt.add(t,"mouseup",Zt.pointerUp),Yt.add(t,"mouseover",Zt.pointerOver),Yt.add(t,"mouseout",Zt.pointerOut),Yt.add(t,"touchstart",Zt.selectorDown),Yt.add(t,"touchmove",Zt.pointerMove),Yt.add(t,"touchend",Zt.pointerUp),Yt.add(t,"touchcancel",Zt.pointerCancel),Yt.add(t,"mousemove",Zt.autoScrollMove),Yt.add(t,"touchmove",Zt.autoScrollMove)),Yt.add(e,"blur",lt);try{if(e.frameElement){var r=e.frameElement.ownerDocument,i=r.defaultView;Yt.add(r,"mouseup",Zt.pointerEnd),Yt.add(r,"touchend",Zt.pointerEnd),Yt.add(r,"touchcancel",Zt.pointerEnd),Yt.add(r,"pointerup",Zt.pointerEnd),Yt.add(r,"MSPointerUp",Zt.pointerEnd),Yt.add(i,"blur",lt)}}catch(t){ot.windowParentError=t}Yt.add(t,"dragstart",function(t){for(var e=0;e<At.length;e++){var n=At[e];if(n.element&&(n.element===t.target||z(n.element,t.target)))return void n.checkAndPreventDefault(t,n.target,n.element)}}),Yt.useAttachEvent&&(Yt.add(t,"selectstart",function(t){var e=At[0];e.currentAction()&&e.checkAndPreventDefault(t)}),Yt.add(t,"dblclick",K("ie8Dblclick"))),St.push(t)}}function ct(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function dt(t,e){return ct(t,e)!==-1}function ht(e,n,r){return gt?gt(e,n,r):(vt!==t&&(n=n.replace(/\/deep\//g," ")),e[qt](n))}function pt(t,e,r){for(;n(t);){if(ht(t,e))return!0;if(t=W(t),t===r)return ht(t,e)}return!1}if(t){var ft,gt,vt=function(){var e=t.document.createTextNode("");return e.ownerDocument!==t.document&&"function"==typeof t.wrap&&t.wrap(e)===e?t.wrap(t):t}(),mt=vt.document,yt=vt.DocumentFragment||e,bt=vt.SVGElement||e,xt=vt.SVGSVGElement||e,_t=vt.SVGElementInstance||e,wt=vt.HTMLElement||vt.Element,kt=vt.PointerEvent||vt.MSPointerEvent,Mt=Math.hypot||function(t,e){return Math.sqrt(t*t+e*e)},Ct={},St=[],Lt=[],At=[],Et=!1,Tt={},Pt={base:{accept:null,actionChecker:null,styleCursor:!0,preventDefault:"auto",origin:{x:0,y:0},deltaSource:"page",allowFrom:null,ignoreFrom:null,_context:mt,dropChecker:null},drag:{enabled:!1,manualStart:!0,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,axis:"xy"},drop:{enabled:!1,accept:null,overlap:"pointer"},resize:{enabled:!1,manualStart:!1,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},gesture:{manualStart:!1,enabled:!1,max:1/0,maxPerElement:1,restrict:null},perAction:{manualStart:!1,max:1/0,maxPerElement:1,snap:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null,relativePoints:null},restrict:{enabled:!1,endOnly:!1},autoScroll:{enabled:!1,container:null,margin:60,speed:300},inertia:{enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,zeroResumeDelta:!0,smoothEndDuration:300}},_holdDuration:600},Dt={interaction:null,i:null,x:0,y:0,scroll:function(){var t,e,n,i,o=Dt.interaction.target.options[Dt.interaction.prepared.name].autoScroll,a=o.container||M(Dt.interaction.element),s=(new Date).getTime(),l=(s-Dt.prevTimeX)/1e3,u=(s-Dt.prevTimeY)/1e3;o.velocity?(t=o.velocity.x,e=o.velocity.y):t=e=o.speed,n=t*l,i=e*u,(n>=1||i>=1)&&(r(a)?a.scrollBy(Dt.x*n,Dt.y*i):a&&(a.scrollLeft+=Dt.x*n,a.scrollTop+=Dt.y*i),n>=1&&(Dt.prevTimeX=s),i>=1&&(Dt.prevTimeY=s)),Dt.isScrolling&&(Xt(Dt.i),Dt.i=Ut(Dt.scroll))},isScrolling:!1,prevTimeX:0,prevTimeY:0,start:function(t){Dt.isScrolling=!0,Xt(Dt.i),Dt.interaction=t,Dt.prevTimeX=(new Date).getTime(),Dt.prevTimeY=(new Date).getTime(),Dt.i=Ut(Dt.scroll)},stop:function(){Dt.isScrolling=!1,Xt(Dt.i)}},Ot="ontouchstart"in vt||vt.DocumentTouch&&mt instanceof vt.DocumentTouch,Nt=kt&&!/Chrome/.test(navigator.userAgent),It=Ot||Nt?20:10,zt=1,Gt=0,Wt=1/0,Ft=mt.all&&!vt.atob?{drag:"move",resizex:"e-resize",resizey:"s-resize",resizexy:"se-resize",resizetop:"n-resize",resizeleft:"w-resize",resizebottom:"s-resize",resizeright:"e-resize",resizetopleft:"se-resize",resizebottomright:"se-resize",resizetopright:"ne-resize",resizebottomleft:"ne-resize",gesture:""}:{drag:"move",resizex:"ew-resize",resizey:"ns-resize",resizexy:"nwse-resize",resizetop:"ns-resize",resizeleft:"ew-resize",resizebottom:"ns-resize",resizeright:"ew-resize",resizetopleft:"nwse-resize",resizebottomright:"nwse-resize",resizetopright:"nesw-resize",resizebottomleft:"nesw-resize",gesture:""},Rt={drag:!0,resize:!0,gesture:!0},Bt="onmousewheel"in mt?"mousewheel":"wheel",Ht=["dragstart","dragmove","draginertiastart","dragend","dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop","resizestart","resizemove","resizeinertiastart","resizeend","gesturestart","gesturemove","gestureinertiastart","gestureend","down","move","up","cancel","tap","doubletap","hold"],jt={},Vt="Opera"==navigator.appName&&Ot&&navigator.userAgent.match("Presto"),$t=/iP(hone|od|ad)/.test(navigator.platform)&&/OS 7[^\d]/.test(navigator.appVersion),qt="matches"in Element.prototype?"matches":"webkitMatchesSelector"in Element.prototype?"webkitMatchesSelector":"mozMatchesSelector"in Element.prototype?"mozMatchesSelector":"oMatchesSelector"in Element.prototype?"oMatchesSelector":"msMatchesSelector",Ut=t.requestAnimationFrame,Xt=t.cancelAnimationFrame,Yt=function(){function t(t,e,s,h){var p=ct(u,t),f=c[p];if(f||(f={events:{},typeCount:0},p=u.push(t)-1,c.push(f),d.push(o?{supplied:[],wrapped:[],useCount:[]}:null)),f.events[e]||(f.events[e]=[],f.typeCount++),!dt(f.events[e],s)){var g;if(o){var v=d[p],m=ct(v.supplied,s),y=v.wrapped[m]||function(e){e.immediatePropagationStopped||(e.target=e.srcElement,e.currentTarget=t,e.preventDefault=e.preventDefault||n,e.stopPropagation=e.stopPropagation||r,e.stopImmediatePropagation=e.stopImmediatePropagation||i,/mouse|click/.test(e.type)&&(e.pageX=e.clientX+M(t).document.documentElement.scrollLeft,e.pageY=e.clientY+M(t).document.documentElement.scrollTop),s(e))};g=t[a](l+e,y,Boolean(h)),m===-1?(v.supplied.push(s),v.wrapped.push(y),v.useCount.push(1)):v.useCount[m]++}else g=t[a](e,s,h||!1);return f.events[e].push(s),g}}function e(t,n,r,i){var a,h,p,f=ct(u,t),g=c[f],v=r;if(g&&g.events)if(o&&(h=d[f],p=ct(h.supplied,r),v=h.wrapped[p]),"all"!==n){if(g.events[n]){var m=g.events[n].length;if("all"===r){for(a=0;a<m;a++)e(t,n,g.events[n][a],Boolean(i));return}for(a=0;a<m;a++)if(g.events[n][a]===r){t[s](l+n,v,i||!1),g.events[n].splice(a,1),o&&h&&(h.useCount[p]--,0===h.useCount[p]&&(h.supplied.splice(p,1),h.wrapped.splice(p,1),h.useCount.splice(p,1)));break}g.events[n]&&0===g.events[n].length&&(g.events[n]=null,g.typeCount--)}g.typeCount||(c.splice(f,1),u.splice(f,1),d.splice(f,1))}else for(n in g.events)g.events.hasOwnProperty(n)&&e(t,n,"all")}function n(){this.returnValue=!1}function r(){this.cancelBubble=!0}function i(){this.cancelBubble=!0,this.immediatePropagationStopped=!0}var o="attachEvent"in vt&&!("addEventListener"in vt),a=o?"attachEvent":"addEventListener",s=o?"detachEvent":"removeEventListener",l=o?"on":"",u=[],c=[],d=[];return{add:t,remove:e,useAttachEvent:o,_elements:u,_targets:c,_attachedListeners:d}}(),Kt={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};X.prototype={getPageXY:function(t,e){return b(t,e,this)},getClientXY:function(t,e){return x(t,e,this)},setEventXY:function(t,e){return g(t,e,this)},pointerOver:function(t,e,n){function r(t,e){t&&F(t,n)&&!R(t,n,n)&&B(t,n,n)&&ht(n,e)&&(i.push(t),o.push(n))}if(!this.prepared.name&&this.mouse){var i=[],o=[],a=this.element;this.addPointer(t),!this.target||!R(this.target,this.element,n)&&B(this.target,this.element,n)||(this.target=null,this.element=null,this.matches=[],this.matchElements=[]);var s=Lt.get(n),l=s&&!R(s,n,n)&&B(s,n,n)&&nt(s.getAction(t,e,this,n),s);l&&!q(s,n,l)&&(l=null),l?(this.target=s,this.element=n,this.matches=[],this.matchElements=[]):(Lt.forEachSelector(r),this.validateSelector(t,e,i,o)?(this.matches=i,this.matchElements=o,this.pointerHover(t,e,this.matches,this.matchElements),Yt.add(n,Nt?ft.move:"mousemove",Zt.pointerHover)):this.target&&(z(a,n)?(this.pointerHover(t,e,this.matches,this.matchElements),Yt.add(this.element,Nt?ft.move:"mousemove",Zt.pointerHover)):(this.target=null,this.element=null,this.matches=[],this.matchElements=[])))}},pointerHover:function(t,e,n,r,i,o){var a=this.target;if(!this.prepared.name&&this.mouse){var s;this.setEventXY(this.curCoords,[t]),i?s=this.validateSelector(t,e,i,o):a&&(s=nt(a.getAction(this.pointers[0],e,this,this.element),this.target)),a&&a.options.styleCursor&&(s?a._doc.documentElement.style.cursor=J(s):a._doc.documentElement.style.cursor="")}else this.prepared.name&&this.checkAndPreventDefault(e,a,this.element)},pointerOut:function(t,e,n){this.prepared.name||(Lt.get(n)||Yt.remove(n,Nt?ft.move:"mousemove",Zt.pointerHover),this.target&&this.target.options.styleCursor&&!this.interacting()&&(this.target._doc.documentElement.style.cursor=""))},selectorDown:function(t,e,r,i){function o(t,e,n){var i=gt?n.querySelectorAll(e):void 0;F(t,u)&&!R(t,u,r)&&B(t,u,r)&&ht(u,e,i)&&(s.matches.push(t),s.matchElements.push(u))}var a,s=this,l=Yt.useAttachEvent?h({},e):e,u=r,c=this.addPointer(t);if(this.holdTimers[c]=setTimeout(function(){s.pointerHold(Yt.useAttachEvent?l:t,l,r,i)},Pt._holdDuration),this.pointerIsDown=!0,this.inertiaStatus.active&&this.target.selector)for(;n(u);){if(u===this.element&&nt(this.target.getAction(t,e,this,this.element),this.target).name===this.prepared.name)return Xt(this.inertiaStatus.i),this.inertiaStatus.active=!1,void this.collectEventTargets(t,e,r,"down");u=W(u)}if(this.interacting())return void this.collectEventTargets(t,e,r,"down");for(this.setEventXY(this.curCoords,[t]),this.downEvent=e;n(u)&&!a;)this.matches=[],this.matchElements=[],Lt.forEachSelector(o),a=this.validateSelector(t,e,this.matches,this.matchElements),u=W(u);return a?(this.prepared.name=a.name,this.prepared.axis=a.axis,this.prepared.edges=a.edges,this.collectEventTargets(t,e,r,"down"),this.pointerDown(t,e,r,i,a)):(this.downTimes[c]=(new Date).getTime(),this.downTargets[c]=r,p(this.downPointer,t),f(this.prevCoords,this.curCoords),this.pointerWasMoved=!1,void this.collectEventTargets(t,e,r,"down"))},pointerDown:function(t,e,n,r,i){if(!i&&!this.inertiaStatus.active&&this.pointerWasMoved&&this.prepared.name)return void this.checkAndPreventDefault(e,this.target,this.element);this.pointerIsDown=!0,this.downEvent=e;var o,a=this.addPointer(t);if(this.pointerIds.length>1&&this.target._element===this.element){var s=nt(i||this.target.getAction(t,e,this,this.element),this.target);q(this.target,this.element,s)&&(o=s),this.prepared.name=null}else if(!this.prepared.name){var l=Lt.get(r);l&&!R(l,r,n)&&B(l,r,n)&&(o=nt(i||l.getAction(t,e,this,r),l,n))&&q(l,r,o)&&(this.target=l,this.element=r)}var u=this.target,c=u&&u.options;if(!u||!i&&this.prepared.name)this.inertiaStatus.active&&r===this.element&&nt(u.getAction(t,e,this,this.element),u).name===this.prepared.name&&(Xt(this.inertiaStatus.i),this.inertiaStatus.active=!1,this.checkAndPreventDefault(e,u,this.element));else{if(o=o||nt(i||u.getAction(t,e,this,r),u,this.element),this.setEventXY(this.startCoords,this.pointers),!o)return;c.styleCursor&&(u._doc.documentElement.style.cursor=J(o)),this.resizeAxes="resize"===o.name?o.axis:null,"gesture"===o&&this.pointerIds.length<2&&(o=null),this.prepared.name=o.name,this.prepared.axis=o.axis,this.prepared.edges=o.edges,this.snapStatus.snappedX=this.snapStatus.snappedY=this.restrictStatus.restrictedX=this.restrictStatus.restrictedY=NaN,this.downTimes[a]=(new Date).getTime(),this.downTargets[a]=n,p(this.downPointer,t),f(this.prevCoords,this.startCoords),this.pointerWasMoved=!1,this.checkAndPreventDefault(e,u,this.element)}},setModifications:function(t,e){var n=this.target,r=!0,i=j(n,this.prepared.name)&&(!n.options[this.prepared.name].snap.endOnly||e),o=V(n,this.prepared.name)&&(!n.options[this.prepared.name].restrict.endOnly||e);return i?this.setSnapping(t):this.snapStatus.locked=!1,o?this.setRestriction(t):this.restrictStatus.restricted=!1,i&&this.snapStatus.locked&&!this.snapStatus.changed?r=o&&this.restrictStatus.restricted&&this.restrictStatus.changed:o&&this.restrictStatus.restricted&&!this.restrictStatus.changed&&(r=!1),r},setStartOffsets:function(t,e,n){var r,i,o=e.getRect(n),a=D(e,n),s=e.options[this.prepared.name].snap,l=e.options[this.prepared.name].restrict;o?(this.startOffset.left=this.startCoords.page.x-o.left,this.startOffset.top=this.startCoords.page.y-o.top,this.startOffset.right=o.right-this.startCoords.page.x,this.startOffset.bottom=o.bottom-this.startCoords.page.y,r="width"in o?o.width:o.right-o.left,i="height"in o?o.height:o.bottom-o.top):this.startOffset.left=this.startOffset.top=this.startOffset.right=this.startOffset.bottom=0,this.snapOffsets.splice(0);var u=s&&"startCoords"===s.offset?{x:this.startCoords.page.x-a.x,y:this.startCoords.page.y-a.y}:s&&s.offset||{x:0,y:0};if(o&&s&&s.relativePoints&&s.relativePoints.length)for(var c=0;c<s.relativePoints.length;c++)this.snapOffsets.push({x:this.startOffset.left-r*s.relativePoints[c].x+u.x,y:this.startOffset.top-i*s.relativePoints[c].y+u.y});else this.snapOffsets.push(u);o&&l.elementRect?(this.restrictOffset.left=this.startOffset.left-r*l.elementRect.left,this.restrictOffset.top=this.startOffset.top-i*l.elementRect.top,this.restrictOffset.right=this.startOffset.right-r*(1-l.elementRect.right),this.restrictOffset.bottom=this.startOffset.bottom-i*(1-l.elementRect.bottom)):this.restrictOffset.left=this.restrictOffset.top=this.restrictOffset.right=this.restrictOffset.bottom=0},start:function(t,e,n){this.interacting()||!this.pointerIsDown||this.pointerIds.length<("gesture"===t.name?2:1)||(ct(At,this)===-1&&At.push(this),this.prepared.name||this.setEventXY(this.startCoords,this.pointers),this.prepared.name=t.name,this.prepared.axis=t.axis,this.prepared.edges=t.edges,this.target=e,this.element=n,this.setStartOffsets(t.name,e,n),this.setModifications(this.startCoords.page),this.prevEvent=this[this.prepared.name+"Start"](this.downEvent))},pointerMove:function(t,e,r,i,o){if(this.inertiaStatus.active){var a=this.inertiaStatus.upCoords.page,s=this.inertiaStatus.upCoords.client,l={pageX:a.x+this.inertiaStatus.sx,pageY:a.y+this.inertiaStatus.sy,clientX:s.x+this.inertiaStatus.sx,clientY:s.y+this.inertiaStatus.sy};this.setEventXY(this.curCoords,[l])}else this.recordPointer(t),this.setEventXY(this.curCoords,this.pointers);var u,c,d=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y,h=this.mouse?0:ct(this.pointerIds,w(t));if(this.pointerIsDown&&!this.pointerWasMoved&&(u=this.curCoords.client.x-this.startCoords.client.x,c=this.curCoords.client.y-this.startCoords.client.y,this.pointerWasMoved=Mt(u,c)>zt),d||this.pointerIsDown&&!this.pointerWasMoved||(this.pointerIsDown&&clearTimeout(this.holdTimers[h]),this.collectEventTargets(t,e,r,"move")),this.pointerIsDown){if(d&&this.pointerWasMoved&&!o)return void this.checkAndPreventDefault(e,this.target,this.element);if(v(this.pointerDelta,this.prevCoords,this.curCoords),this.prepared.name){if(this.pointerWasMoved&&(!this.inertiaStatus.active||t instanceof Z&&/inertiastart/.test(t.type))){if(!this.interacting()&&(v(this.pointerDelta,this.prevCoords,this.curCoords),"drag"===this.prepared.name)){var p=Math.abs(u),g=Math.abs(c),m=this.target.options.drag.axis,y=p>g?"x":p<g?"y":"xy";if("xy"!==y&&"xy"!==m&&m!==y){this.prepared.name=null;for(var b=r;n(b);){var x=Lt.get(b);if(x&&x!==this.target&&!x.options.drag.manualStart&&"drag"===x.getAction(this.downPointer,this.downEvent,this,b).name&&H(y,x)){this.prepared.name="drag",this.target=x,this.element=b;break}b=W(b)}if(!this.prepared.name){var _=this,k=function(t,e,n){var i=gt?n.querySelectorAll(e):void 0;if(t!==_.target)return F(t,r)&&!t.options.drag.manualStart&&!R(t,b,r)&&B(t,b,r)&&ht(b,e,i)&&"drag"===t.getAction(_.downPointer,_.downEvent,_,b).name&&H(y,t)&&q(t,b,"drag")?t:void 0};for(b=r;n(b);){var M=Lt.forEachSelector(k);if(M){this.prepared.name="drag",this.target=M,this.element=b;break}b=W(b)}}}}var C=!!this.prepared.name&&!this.interacting();if(C&&(this.target.options[this.prepared.name].manualStart||!q(this.target,this.element,this.prepared)))return void this.stop(e);if(this.prepared.name&&this.target){C&&this.start(this.prepared,this.target,this.element);var S=this.setModifications(this.curCoords.page,o);(S||C)&&(this.prevEvent=this[this.prepared.name+"Move"](e)),this.checkAndPreventDefault(e,this.target,this.element)}}f(this.prevCoords,this.curCoords),(this.dragging||this.resizing)&&this.autoScrollMove(t)}}},dragStart:function(t){var e=new Z(this,t,"drag","start",this.element);this.dragging=!0,this.target.fire(e),this.activeDrops.dropzones=[],this.activeDrops.elements=[],this.activeDrops.rects=[],this.dynamicDrop||this.setActiveDrops(this.element);var n=this.getDropEvents(t,e);return n.activate&&this.fireActiveDrops(n.activate),e},dragMove:function(t){var e=this.target,n=new Z(this,t,"drag","move",this.element),r=this.element,i=this.getDrop(n,t,r);this.dropTarget=i.dropzone,this.dropElement=i.element;var o=this.getDropEvents(t,n);return e.fire(n),o.leave&&this.prevDropTarget.fire(o.leave),o.enter&&this.dropTarget.fire(o.enter),o.move&&this.dropTarget.fire(o.move),this.prevDropTarget=this.dropTarget,this.prevDropElement=this.dropElement,n},resizeStart:function(t){var e=new Z(this,t,"resize","start",this.element);if(this.prepared.edges){var n=this.target.getRect(this.element);if(this.target.options.resize.square||this.target.options.resize.preserveAspectRatio){var r=h({},this.prepared.edges);r.top=r.top||r.left&&!r.bottom,r.left=r.left||r.top&&!r.right,r.bottom=r.bottom||r.right&&!r.top,r.right=r.right||r.bottom&&!r.left,this.prepared._linkedEdges=r}else this.prepared._linkedEdges=null;this.target.options.resize.preserveAspectRatio&&(this.resizeStartAspectRatio=n.width/n.height),this.resizeRects={start:n,current:h({},n),restricted:h({},n),previous:h({},n),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},e.rect=this.resizeRects.restricted,e.deltaRect=this.resizeRects.delta}return this.target.fire(e),this.resizing=!0,e},resizeMove:function(t){var e=new Z(this,t,"resize","move",this.element),n=this.prepared.edges,r=this.target.options.resize.invert,i="reposition"===r||"negate"===r;if(n){var o=e.dx,a=e.dy,s=this.resizeRects.start,l=this.resizeRects.current,u=this.resizeRects.restricted,c=this.resizeRects.delta,d=h(this.resizeRects.previous,u),p=n;if(this.target.options.resize.preserveAspectRatio){var f=this.resizeStartAspectRatio;n=this.prepared._linkedEdges,p.left&&p.bottom||p.right&&p.top?a=-o/f:p.left||p.right?a=o/f:(p.top||p.bottom)&&(o=a*f)}else this.target.options.resize.square&&(n=this.prepared._linkedEdges,p.left&&p.bottom||p.right&&p.top?a=-o:p.left||p.right?a=o:(p.top||p.bottom)&&(o=a));if(n.top&&(l.top+=a),n.bottom&&(l.bottom+=a),n.left&&(l.left+=o),n.right&&(l.right+=o),i){if(h(u,l),"reposition"===r){var g;u.top>u.bottom&&(g=u.top,u.top=u.bottom,u.bottom=g),u.left>u.right&&(g=u.left,u.left=u.right,u.right=g)}}else u.top=Math.min(l.top,s.bottom),u.bottom=Math.max(l.bottom,s.top),u.left=Math.min(l.left,s.right),u.right=Math.max(l.right,s.left);u.width=u.right-u.left,u.height=u.bottom-u.top;for(var v in u)c[v]=u[v]-d[v];e.edges=this.prepared.edges,e.rect=u,e.deltaRect=c}return this.target.fire(e),e},gestureStart:function(t){var e=new Z(this,t,"gesture","start",this.element);
return e.ds=0,this.gesture.startDistance=this.gesture.prevDistance=e.distance,this.gesture.startAngle=this.gesture.prevAngle=e.angle,this.gesture.scale=1,this.gesturing=!0,this.target.fire(e),e},gestureMove:function(t){if(!this.pointerIds.length)return this.prevEvent;var e;return e=new Z(this,t,"gesture","move",this.element),e.ds=e.scale-this.gesture.scale,this.target.fire(e),this.gesture.prevAngle=e.angle,this.gesture.prevDistance=e.distance,e.scale===1/0||null===e.scale||void 0===e.scale||isNaN(e.scale)||(this.gesture.scale=e.scale),e},pointerHold:function(t,e,n){this.collectEventTargets(t,e,n,"hold")},pointerUp:function(t,e,n,r){var i=this.mouse?0:ct(this.pointerIds,w(t));clearTimeout(this.holdTimers[i]),this.collectEventTargets(t,e,n,"up"),this.collectEventTargets(t,e,n,"tap"),this.pointerEnd(t,e,n,r),this.removePointer(t)},pointerCancel:function(t,e,n,r){var i=this.mouse?0:ct(this.pointerIds,w(t));clearTimeout(this.holdTimers[i]),this.collectEventTargets(t,e,n,"cancel"),this.pointerEnd(t,e,n,r),this.removePointer(t)},ie8Dblclick:function(t,e,n){this.prevTap&&e.clientX===this.prevTap.clientX&&e.clientY===this.prevTap.clientY&&n===this.prevTap.target&&(this.downTargets[0]=n,this.downTimes[0]=(new Date).getTime(),this.collectEventTargets(t,e,n,"tap"))},pointerEnd:function(t,e,n,r){var i,o=this.target,a=o&&o.options,s=a&&this.prepared.name&&a[this.prepared.name].inertia,l=this.inertiaStatus;if(this.interacting()){if(l.active&&!l.ending)return;var u,c,d=(new Date).getTime(),p=!1,g=!1,v=!1,m=j(o,this.prepared.name)&&a[this.prepared.name].snap.endOnly,y=V(o,this.prepared.name)&&a[this.prepared.name].restrict.endOnly,b=0,x=0;if(u=this.dragging?"x"===a.drag.axis?Math.abs(this.pointerDelta.client.vx):"y"===a.drag.axis?Math.abs(this.pointerDelta.client.vy):this.pointerDelta.client.speed:this.pointerDelta.client.speed,p=s&&s.enabled&&"gesture"!==this.prepared.name&&e!==l.startEvent,g=p&&d-this.curCoords.timeStamp<50&&u>s.minSpeed&&u>s.endSpeed,p&&!g&&(m||y)){var _={};_.snap=_.restrict=_,m&&(this.setSnapping(this.curCoords.page,_),_.locked&&(b+=_.dx,x+=_.dy)),y&&(this.setRestriction(this.curCoords.page,_),_.restricted&&(b+=_.dx,x+=_.dy)),(b||x)&&(v=!0)}if(g||v){if(f(l.upCoords,this.curCoords),this.pointers[0]=l.startEvent=c=new Z(this,e,this.prepared.name,"inertiastart",this.element),l.t0=d,o.fire(l.startEvent),g){l.vx0=this.pointerDelta.client.vx,l.vy0=this.pointerDelta.client.vy,l.v0=u,this.calcInertia(l);var w,k=h({},this.curCoords.page),M=D(o,this.element);if(k.x=k.x+l.xe-M.x,k.y=k.y+l.ye-M.y,w={useStatusXY:!0,x:k.x,y:k.y,dx:0,dy:0,snap:null},w.snap=w,b=x=0,m){var C=this.setSnapping(this.curCoords.page,w);C.locked&&(b+=C.dx,x+=C.dy)}if(y){var S=this.setRestriction(this.curCoords.page,w);S.restricted&&(b+=S.dx,x+=S.dy)}l.modifiedXe+=b,l.modifiedYe+=x,l.i=Ut(this.boundInertiaFrame)}else l.smoothEnd=!0,l.xe=b,l.ye=x,l.sx=l.sy=0,l.i=Ut(this.boundSmoothEndFrame);return void(l.active=!0)}(m||y)&&this.pointerMove(t,e,n,r,!0)}if(this.dragging){i=new Z(this,e,"drag","end",this.element);var L=this.element,A=this.getDrop(i,e,L);this.dropTarget=A.dropzone,this.dropElement=A.element;var E=this.getDropEvents(e,i);E.leave&&this.prevDropTarget.fire(E.leave),E.enter&&this.dropTarget.fire(E.enter),E.drop&&this.dropTarget.fire(E.drop),E.deactivate&&this.fireActiveDrops(E.deactivate),o.fire(i)}else this.resizing?(i=new Z(this,e,"resize","end",this.element),o.fire(i)):this.gesturing&&(i=new Z(this,e,"gesture","end",this.element),o.fire(i));this.stop(e)},collectDrops:function(t){var e,r=[],i=[];for(t=t||this.element,e=0;e<Lt.length;e++)if(Lt[e].options.drop.enabled){var o=Lt[e],a=o.options.drop.accept;if(!(n(a)&&a!==t||c(a)&&!ht(t,a)))for(var s=o.selector?o._context.querySelectorAll(o.selector):[o._element],l=0,u=s.length;l<u;l++){var d=s[l];d!==t&&(r.push(o),i.push(d))}}return{dropzones:r,elements:i}},fireActiveDrops:function(t){var e,n,r,i;for(e=0;e<this.activeDrops.dropzones.length;e++)n=this.activeDrops.dropzones[e],r=this.activeDrops.elements[e],r!==i&&(t.target=r,n.fire(t)),i=r},setActiveDrops:function(t){var e=this.collectDrops(t,!0);this.activeDrops.dropzones=e.dropzones,this.activeDrops.elements=e.elements,this.activeDrops.rects=[];for(var n=0;n<this.activeDrops.dropzones.length;n++)this.activeDrops.rects[n]=this.activeDrops.dropzones[n].getRect(this.activeDrops.elements[n])},getDrop:function(t,e,n){var r=[];Et&&this.setActiveDrops(n);for(var i=0;i<this.activeDrops.dropzones.length;i++){var o=this.activeDrops.dropzones[i],a=this.activeDrops.elements[i],s=this.activeDrops.rects[i];r.push(o.dropCheck(t,e,this.target,n,a,s)?a:null)}var l=U(r),u=this.activeDrops.dropzones[l]||null,c=this.activeDrops.elements[l]||null;return{dropzone:u,element:c}},getDropEvents:function(t,e){var n={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return this.dropElement!==this.prevDropElement&&(this.prevDropTarget&&(n.leave={target:this.prevDropElement,dropzone:this.prevDropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dragleave"},e.dragLeave=this.prevDropElement,e.prevDropzone=this.prevDropTarget),this.dropTarget&&(n.enter={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dragenter"},e.dragEnter=this.dropElement,e.dropzone=this.dropTarget)),"dragend"===e.type&&this.dropTarget&&(n.drop={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"drop"},e.dropzone=this.dropTarget),"dragstart"===e.type&&(n.activate={target:null,dropzone:null,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dropactivate"}),"dragend"===e.type&&(n.deactivate={target:null,dropzone:null,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,timeStamp:e.timeStamp,type:"dropdeactivate"}),"dragmove"===e.type&&this.dropTarget&&(n.move={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:e.target,draggable:e.interactable,dragEvent:e,interaction:this,dragmove:e,timeStamp:e.timeStamp,type:"dropmove"},e.dropzone=this.dropTarget),n},currentAction:function(){return this.dragging&&"drag"||this.resizing&&"resize"||this.gesturing&&"gesture"||null},interacting:function(){return this.dragging||this.resizing||this.gesturing},clearTargets:function(){this.target=this.element=null,this.dropTarget=this.dropElement=this.prevDropTarget=this.prevDropElement=null},stop:function(t){if(this.interacting()){Dt.stop(),this.matches=[],this.matchElements=[];var e=this.target;e.options.styleCursor&&(e._doc.documentElement.style.cursor=""),t&&s(t.preventDefault)&&this.checkAndPreventDefault(t,e,this.element),this.dragging&&(this.activeDrops.dropzones=this.activeDrops.elements=this.activeDrops.rects=null)}this.clearTargets(),this.pointerIsDown=this.snapStatus.locked=this.dragging=this.resizing=this.gesturing=!1,this.prepared.name=this.prevEvent=null,this.inertiaStatus.resumeDx=this.inertiaStatus.resumeDy=0;for(var n=0;n<this.pointers.length;n++)ct(this.pointerIds,w(this.pointers[n]))===-1&&this.pointers.splice(n,1)},inertiaFrame:function(){var t=this.inertiaStatus,e=this.target.options[this.prepared.name].inertia,n=e.resistance,r=(new Date).getTime()/1e3-t.t0;if(r<t.te){var i=1-(Math.exp(-n*r)-t.lambda_v0)/t.one_ve_v0;if(t.modifiedXe===t.xe&&t.modifiedYe===t.ye)t.sx=t.xe*i,t.sy=t.ye*i;else{var o=N(0,0,t.xe,t.ye,t.modifiedXe,t.modifiedYe,i);t.sx=o.x,t.sy=o.y}this.pointerMove(t.startEvent,t.startEvent),t.i=Ut(this.boundInertiaFrame)}else t.ending=!0,t.sx=t.modifiedXe,t.sy=t.modifiedYe,this.pointerMove(t.startEvent,t.startEvent),this.pointerEnd(t.startEvent,t.startEvent),t.active=t.ending=!1},smoothEndFrame:function(){var t=this.inertiaStatus,e=(new Date).getTime()-t.t0,n=this.target.options[this.prepared.name].inertia.smoothEndDuration;e<n?(t.sx=I(e,0,t.xe,n),t.sy=I(e,0,t.ye,n),this.pointerMove(t.startEvent,t.startEvent),t.i=Ut(this.boundSmoothEndFrame)):(t.ending=!0,t.sx=t.xe,t.sy=t.ye,this.pointerMove(t.startEvent,t.startEvent),this.pointerEnd(t.startEvent,t.startEvent),t.smoothEnd=t.active=t.ending=!1)},addPointer:function(t){var e=w(t),n=this.mouse?0:ct(this.pointerIds,e);return n===-1&&(n=this.pointerIds.length),this.pointerIds[n]=e,this.pointers[n]=t,n},removePointer:function(t){var e=w(t),n=this.mouse?0:ct(this.pointerIds,e);n!==-1&&(this.pointers.splice(n,1),this.pointerIds.splice(n,1),this.downTargets.splice(n,1),this.downTimes.splice(n,1),this.holdTimers.splice(n,1))},recordPointer:function(t){var e=this.mouse?0:ct(this.pointerIds,w(t));e!==-1&&(this.pointers[e]=t)},collectEventTargets:function(t,e,r,i){function o(t,e,o){var a=gt?o.querySelectorAll(e):void 0;t._iEvents[i]&&n(u)&&F(t,u)&&!R(t,u,r)&&B(t,u,r)&&ht(u,e,a)&&(s.push(t),l.push(u))}var a=this.mouse?0:ct(this.pointerIds,w(t));if("tap"!==i||!this.pointerWasMoved&&this.downTargets[a]&&this.downTargets[a]===r){for(var s=[],l=[],u=r;u;)ot.isSet(u)&&ot(u)._iEvents[i]&&(s.push(ot(u)),l.push(u)),Lt.forEachSelector(o),u=W(u);(s.length||"tap"===i)&&this.firePointers(t,e,r,s,l,i)}},firePointers:function(t,e,n,r,i,o){var a,s,l,u=this.mouse?0:ct(this.pointerIds,w(t)),d={};for("doubletap"===o?d=t:(p(d,e),e!==t&&p(d,t),d.preventDefault=Q,d.stopPropagation=Z.prototype.stopPropagation,d.stopImmediatePropagation=Z.prototype.stopImmediatePropagation,d.interaction=this,d.timeStamp=(new Date).getTime(),d.originalEvent=e,d.originalPointer=t,d.type=o,d.pointerId=w(t),d.pointerType=this.mouse?"mouse":Nt?c(t.pointerType)?t.pointerType:[,,"touch","pen","mouse"][t.pointerType]:"touch"),"tap"===o&&(d.dt=d.timeStamp-this.downTimes[u],s=d.timeStamp-this.tapTime,l=!!(this.prevTap&&"doubletap"!==this.prevTap.type&&this.prevTap.target===d.target&&s<500),d.double=l,this.tapTime=d.timeStamp),a=0;a<r.length&&(d.currentTarget=i[a],d.interactable=r[a],r[a].fire(d),!(d.immediatePropagationStopped||d.propagationStopped&&i[a+1]!==d.currentTarget));a++);if(l){var f={};h(f,d),f.dt=s,f.type="doubletap",this.collectEventTargets(f,e,n,"doubletap"),this.prevTap=f}else"tap"===o&&(this.prevTap=d)},validateSelector:function(t,e,n,r){for(var i=0,o=n.length;i<o;i++){var a=n[i],s=r[i],l=nt(a.getAction(t,e,this,s),a);if(l&&q(a,s,l))return this.target=a,this.element=s,l}},setSnapping:function(t,e){var n,r,i,o=this.target.options[this.prepared.name].snap,a=[];if(e=e||this.snapStatus,e.useStatusXY)r={x:e.x,y:e.y};else{var u=D(this.target,this.element);r=h({},t),r.x-=u.x,r.y-=u.y}e.realX=r.x,e.realY=r.y,r.x=r.x-this.inertiaStatus.resumeDx,r.y=r.y-this.inertiaStatus.resumeDy;for(var c=o.targets?o.targets.length:0,d=0;d<this.snapOffsets.length;d++){var p={x:r.x-this.snapOffsets[d].x,y:r.y-this.snapOffsets[d].y};for(i=0;i<c;i++)n=s(o.targets[i])?o.targets[i](p.x,p.y,this):o.targets[i],n&&a.push({x:l(n.x)?n.x+this.snapOffsets[d].x:p.x,y:l(n.y)?n.y+this.snapOffsets[d].y:p.y,range:l(n.range)?n.range:o.range})}var f={target:null,inRange:!1,distance:0,range:0,dx:0,dy:0};for(i=0,c=a.length;i<c;i++){n=a[i];var g=n.range,v=n.x-r.x,m=n.y-r.y,y=Mt(v,m),b=y<=g;g===1/0&&f.inRange&&f.range!==1/0&&(b=!1),f.target&&!(b?f.inRange&&g!==1/0?y/g<f.distance/f.range:g===1/0&&f.range!==1/0||y<f.distance:!f.inRange&&y<f.distance)||(g===1/0&&(b=!0),f.target=n,f.distance=y,f.range=g,f.inRange=b,f.dx=v,f.dy=m,e.range=g)}var x;return f.target?(x=e.snappedX!==f.target.x||e.snappedY!==f.target.y,e.snappedX=f.target.x,e.snappedY=f.target.y):(x=!0,e.snappedX=NaN,e.snappedY=NaN),e.dx=f.dx,e.dy=f.dy,e.changed=x||f.inRange&&!e.locked,e.locked=f.inRange,e},setRestriction:function(t,e){var r,i=this.target,o=i&&i.options[this.prepared.name].restrict,a=o&&o.restriction;if(!a)return e;e=e||this.restrictStatus,r=r=e.useStatusXY?{x:e.x,y:e.y}:h({},t),e.snap&&e.snap.locked&&(r.x+=e.snap.dx||0,r.y+=e.snap.dy||0),r.x-=this.inertiaStatus.resumeDx,r.y-=this.inertiaStatus.resumeDy,e.dx=0,e.dy=0,e.restricted=!1;var l,u,d;return c(a)&&(a="parent"===a?W(this.element):"self"===a?i.getRect(this.element):G(this.element,a),!a)?e:(s(a)&&(a=a(r.x,r.y,this.element)),n(a)&&(a=S(a)),l=a,a?"x"in a&&"y"in a?(u=Math.max(Math.min(l.x+l.width-this.restrictOffset.right,r.x),l.x+this.restrictOffset.left),d=Math.max(Math.min(l.y+l.height-this.restrictOffset.bottom,r.y),l.y+this.restrictOffset.top)):(u=Math.max(Math.min(l.right-this.restrictOffset.right,r.x),l.left+this.restrictOffset.left),d=Math.max(Math.min(l.bottom-this.restrictOffset.bottom,r.y),l.top+this.restrictOffset.top)):(u=r.x,d=r.y),e.dx=u-r.x,e.dy=d-r.y,e.changed=e.restrictedX!==u||e.restrictedY!==d,e.restricted=!(!e.dx&&!e.dy),e.restrictedX=u,e.restrictedY=d,e)},checkAndPreventDefault:function(t,e,n){if(e=e||this.target){var r=e.options,i=r.preventDefault;if("auto"===i&&n&&!/^(input|select|textarea)$/i.test(t.target.nodeName)){if(/down|start/i.test(t.type)&&"drag"===this.prepared.name&&"xy"!==r.drag.axis)return;if(r[this.prepared.name]&&r[this.prepared.name].manualStart&&!this.interacting())return;return void t.preventDefault()}return"always"===i?void t.preventDefault():void 0}},calcInertia:function(t){var e=this.target.options[this.prepared.name].inertia,n=e.resistance,r=-Math.log(e.endSpeed/t.v0)/n;t.x0=this.prevEvent.pageX,t.y0=this.prevEvent.pageY,t.t0=t.startEvent.timeStamp/1e3,t.sx=t.sy=0,t.modifiedXe=t.xe=(t.vx0-r)/n,t.modifiedYe=t.ye=(t.vy0-r)/n,t.te=r,t.lambda_v0=n/t.v0,t.one_ve_v0=1-e.endSpeed/t.v0},autoScrollMove:function(t){if(this.interacting()&&$(this.target,this.prepared.name)){if(this.inertiaStatus.active)return void(Dt.x=Dt.y=0);var e,n,i,o,a=this.target.options[this.prepared.name].autoScroll,s=a.container||M(this.element);if(r(s))o=t.clientX<Dt.margin,e=t.clientY<Dt.margin,n=t.clientX>s.innerWidth-Dt.margin,i=t.clientY>s.innerHeight-Dt.margin;else{var l=C(s);o=t.clientX<l.left+Dt.margin,e=t.clientY<l.top+Dt.margin,n=t.clientX>l.right-Dt.margin,i=t.clientY>l.bottom-Dt.margin}Dt.x=n?1:o?-1:0,Dt.y=i?1:e?-1:0,Dt.isScrolling||(Dt.margin=a.margin,Dt.speed=a.speed,Dt.start(this))}},_updateEventTargets:function(t,e){this._eventTarget=t,this._curEventTarget=e}},Z.prototype={preventDefault:e,stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},stopPropagation:function(){this.propagationStopped=!0}};for(var Zt={},Qt=["dragStart","dragMove","resizeStart","resizeMove","gestureStart","gestureMove","pointerOver","pointerOut","pointerHover","selectorDown","pointerDown","pointerMove","pointerUp","pointerCancel","pointerEnd","addPointer","removePointer","recordPointer","autoScrollMove"],Jt=0,te=Qt.length;Jt<te;Jt++){var ee=Qt[Jt];Zt[ee]=K(ee)}Lt.indexOfElement=function(t,e){e=e||mt;for(var n=0;n<this.length;n++){var r=this[n];if(r.selector===t&&r._context===e||!r.selector&&r._element===t)return n}return-1},Lt.get=function(t,e){return this[this.indexOfElement(t,e&&e.context)]},Lt.forEachSelector=function(t){for(var e=0;e<this.length;e++){var n=this[e];if(n.selector){var r=t(n,n.selector,n._context,e,this);if(void 0!==r)return r}}},at.prototype={setOnEvents:function(t,e){return"drop"===t?(s(e.ondrop)&&(this.ondrop=e.ondrop),s(e.ondropactivate)&&(this.ondropactivate=e.ondropactivate),s(e.ondropdeactivate)&&(this.ondropdeactivate=e.ondropdeactivate),s(e.ondragenter)&&(this.ondragenter=e.ondragenter),s(e.ondragleave)&&(this.ondragleave=e.ondragleave),s(e.ondropmove)&&(this.ondropmove=e.ondropmove)):(t="on"+t,s(e.onstart)&&(this[t+"start"]=e.onstart),s(e.onmove)&&(this[t+"move"]=e.onmove),s(e.onend)&&(this[t+"end"]=e.onend),s(e.oninertiastart)&&(this[t+"inertiastart"]=e.oninertiastart)),this},draggable:function(t){return a(t)?(this.options.drag.enabled=t.enabled!==!1,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^x$|^y$|^xy$/.test(t.axis)?this.options.drag.axis=t.axis:null===t.axis&&delete this.options.drag.axis,this):u(t)?(this.options.drag.enabled=t,this):this.options.drag},setPerAction:function(t,e){for(var n in e)n in Pt[t]&&(a(e[n])?(this.options[t][n]=h(this.options[t][n]||{},e[n]),a(Pt.perAction[n])&&"enabled"in Pt.perAction[n]&&(this.options[t][n].enabled=e[n].enabled!==!1)):u(e[n])&&a(Pt.perAction[n])?this.options[t][n].enabled=e[n]:void 0!==e[n]&&(this.options[t][n]=e[n]))},dropzone:function(t){return a(t)?(this.options.drop.enabled=t.enabled!==!1,this.setOnEvents("drop",t),/^(pointer|center)$/.test(t.overlap)?this.options.drop.overlap=t.overlap:l(t.overlap)&&(this.options.drop.overlap=Math.max(Math.min(1,t.overlap),0)),"accept"in t&&(this.options.drop.accept=t.accept),"checker"in t&&(this.options.drop.checker=t.checker),this):u(t)?(this.options.drop.enabled=t,this):this.options.drop},dropCheck:function(t,e,n,r,i,o){var a=!1;if(!(o=o||this.getRect(i)))return!!this.options.drop.checker&&this.options.drop.checker(t,e,a,this,i,n,r);var s=this.options.drop.overlap;if("pointer"===s){var u,c,d=b(t),h=D(n,r);d.x+=h.x,d.y+=h.y,u=d.x>o.left&&d.x<o.right,c=d.y>o.top&&d.y<o.bottom,a=u&&c}var p=n.getRect(r);if("center"===s){var f=p.left+p.width/2,g=p.top+p.height/2;a=f>=o.left&&f<=o.right&&g>=o.top&&g<=o.bottom}if(l(s)){var v=Math.max(0,Math.min(o.right,p.right)-Math.max(o.left,p.left))*Math.max(0,Math.min(o.bottom,p.bottom)-Math.max(o.top,p.top)),m=v/(p.width*p.height);a=m>=s}return this.options.drop.checker&&(a=this.options.drop.checker(t,e,a,this,i,n,r)),a},dropChecker:function(t){return s(t)?(this.options.drop.checker=t,this):null===t?(delete this.options.getRect,this):this.options.drop.checker},accept:function(t){return n(t)?(this.options.drop.accept=t,this):d(t)?(this.options.drop.accept=t,this):null===t?(delete this.options.drop.accept,this):this.options.drop.accept},resizable:function(t){return a(t)?(this.options.resize.enabled=t.enabled!==!1,this.setPerAction("resize",t),this.setOnEvents("resize",t),/^x$|^y$|^xy$/.test(t.axis)?this.options.resize.axis=t.axis:null===t.axis&&(this.options.resize.axis=Pt.resize.axis),u(t.preserveAspectRatio)?this.options.resize.preserveAspectRatio=t.preserveAspectRatio:u(t.square)&&(this.options.resize.square=t.square),this):u(t)?(this.options.resize.enabled=t,this):this.options.resize},squareResize:function(t){return u(t)?(this.options.resize.square=t,this):null===t?(delete this.options.resize.square,this):this.options.resize.square},gesturable:function(t){return a(t)?(this.options.gesture.enabled=t.enabled!==!1,this.setPerAction("gesture",t),this.setOnEvents("gesture",t),this):u(t)?(this.options.gesture.enabled=t,this):this.options.gesture},autoScroll:function(t){return a(t)?t=h({actions:["drag","resize"]},t):u(t)&&(t={actions:["drag","resize"],enabled:t}),this.setOptions("autoScroll",t)},snap:function(t){var e=this.setOptions("snap",t);return e===this?this:e.drag},setOptions:function(t,e){var n,r=e&&o(e.actions)?e.actions:["drag"];if(a(e)||u(e)){for(n=0;n<r.length;n++){var i=/resize/.test(r[n])?"resize":r[n];if(a(this.options[i])){var s=this.options[i][t];a(e)?(h(s,e),s.enabled=e.enabled!==!1,"snap"===t&&("grid"===s.mode?s.targets=[ot.createSnapGrid(h({offset:s.gridOffset||{x:0,y:0}},s.grid||{}))]:"anchor"===s.mode?s.targets=s.anchors:"path"===s.mode&&(s.targets=s.paths),"elementOrigin"in e&&(s.relativePoints=[e.elementOrigin]))):u(e)&&(s.enabled=e)}}return this}var l={},c=["drag","resize","gesture"];for(n=0;n<c.length;n++)t in Pt[c[n]]&&(l[c[n]]=this.options[c[n]][t]);return l},inertia:function(t){var e=this.setOptions("inertia",t);return e===this?this:e.drag},getAction:function(t,e,n,r){var i=this.defaultActionChecker(t,n,r);return this.options.actionChecker?this.options.actionChecker(t,e,i,this,r,n):i},defaultActionChecker:et,actionChecker:function(t){return s(t)?(this.options.actionChecker=t,this):null===t?(delete this.options.actionChecker,this):this.options.actionChecker},getRect:function(t){return t=t||this._element,this.selector&&!n(t)&&(t=this._context.querySelector(this.selector)),S(t)},rectChecker:function(t){return s(t)?(this.getRect=t,this):null===t?(delete this.options.getRect,this):this.getRect},styleCursor:function(t){return u(t)?(this.options.styleCursor=t,this):null===t?(delete this.options.styleCursor,this):this.options.styleCursor},preventDefault:function(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):u(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault},origin:function(t){return d(t)?(this.options.origin=t,this):a(t)?(this.options.origin=t,this):this.options.origin},deltaSource:function(t){return"page"===t||"client"===t?(this.options.deltaSource=t,this):this.options.deltaSource},restrict:function(t){if(!a(t))return this.setOptions("restrict",t);for(var e,n=["drag","resize","gesture"],r=0;r<n.length;r++){var i=n[r];if(i in t){var o=h({actions:[i],restriction:t[i]},t);e=this.setOptions("restrict",o)}}return e},context:function(){return this._context},_context:mt,ignoreFrom:function(t){return d(t)?(this.options.ignoreFrom=t,this):n(t)?(this.options.ignoreFrom=t,this):this.options.ignoreFrom},allowFrom:function(t){return d(t)?(this.options.allowFrom=t,this):n(t)?(this.options.allowFrom=t,this):this.options.allowFrom},element:function(){return this._element},fire:function(t){if(!t||!t.type||!dt(Ht,t.type))return this;var e,n,r,i="on"+t.type,o="";if(t.type in this._iEvents)for(e=this._iEvents[t.type],n=0,r=e.length;n<r&&!t.immediatePropagationStopped;n++)o=e[n].name,e[n](t);if(s(this[i])&&(o=this[i].name,this[i](t)),t.type in jt&&(e=jt[t.type]))for(n=0,r=e.length;n<r&&!t.immediatePropagationStopped;n++)o=e[n].name,e[n](t);return this},on:function(t,e,n){var r;if(c(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),o(t)){for(r=0;r<t.length;r++)this.on(t[r],e,n);return this}if(a(t)){for(var i in t)this.on(i,t[i],e);return this}if("wheel"===t&&(t=Bt),n=!!n,dt(Ht,t))t in this._iEvents?this._iEvents[t].push(e):this._iEvents[t]=[e];else if(this.selector){if(!Tt[t])for(Tt[t]={selectors:[],contexts:[],listeners:[]},r=0;r<St.length;r++)Yt.add(St[r],t,rt),Yt.add(St[r],t,it,!0);var s,l=Tt[t];for(s=l.selectors.length-1;s>=0&&(l.selectors[s]!==this.selector||l.contexts[s]!==this._context);s--);s===-1&&(s=l.selectors.length,l.selectors.push(this.selector),l.contexts.push(this._context),l.listeners.push([])),l.listeners[s].push([e,n])}else Yt.add(this._element,t,e,n);return this},off:function(t,e,n){var r;if(c(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),o(t)){for(r=0;r<t.length;r++)this.off(t[r],e,n);return this}if(a(t)){for(var i in t)this.off(i,t[i],e);return this}var s,l=-1;if(n=!!n,"wheel"===t&&(t=Bt),dt(Ht,t))s=this._iEvents[t],s&&(l=ct(s,e))!==-1&&this._iEvents[t].splice(l,1);else if(this.selector){var u=Tt[t],d=!1;if(!u)return this;for(l=u.selectors.length-1;l>=0;l--)if(u.selectors[l]===this.selector&&u.contexts[l]===this._context){var h=u.listeners[l];for(r=h.length-1;r>=0;r--){var p=h[r][0],f=h[r][1];if(p===e&&f===n){h.splice(r,1),h.length||(u.selectors.splice(l,1),u.contexts.splice(l,1),u.listeners.splice(l,1),Yt.remove(this._context,t,rt),Yt.remove(this._context,t,it,!0),u.selectors.length||(Tt[t]=null)),d=!0;break}}if(d)break}}else Yt.remove(this._element,t,e,n);return this},set:function(t){a(t)||(t={}),this.options=h({},Pt.base);var e,n=["drag","drop","resize","gesture"],r=["draggable","dropzone","resizable","gesturable"],i=h(h({},Pt.perAction),t[o]||{});for(e=0;e<n.length;e++){var o=n[e];this.options[o]=h({},Pt[o]),this.setPerAction(o,i),this[r[e]](t[o])}var s=["accept","actionChecker","allowFrom","deltaSource","dropChecker","ignoreFrom","origin","preventDefault","rectChecker","styleCursor"];for(e=0,te=s.length;e<te;e++){var l=s[e];this.options[l]=Pt.base[l],l in t&&this[l](t[l])}return this},unset:function(){if(Yt.remove(this._element,"all"),c(this.selector))for(var t in Tt)for(var e=Tt[t],n=0;n<e.selectors.length;n++){e.selectors[n]===this.selector&&e.contexts[n]===this._context&&(e.selectors.splice(n,1),e.contexts.splice(n,1),e.listeners.splice(n,1),e.selectors.length||(Tt[t]=null)),Yt.remove(this._context,t,rt),Yt.remove(this._context,t,it,!0);break}else Yt.remove(this,"all"),this.options.styleCursor&&(this._element.style.cursor="");return this.dropzone(!1),Lt.splice(ct(Lt,this),1),ot}},at.prototype.snap=st(at.prototype.snap,"Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping"),at.prototype.restrict=st(at.prototype.restrict,"Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction"),at.prototype.inertia=st(at.prototype.inertia,"Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia"),at.prototype.autoScroll=st(at.prototype.autoScroll,"Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll"),at.prototype.squareResize=st(at.prototype.squareResize,"Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square"),at.prototype.accept=st(at.prototype.accept,"Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead"),at.prototype.dropChecker=st(at.prototype.dropChecker,"Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead"),at.prototype.context=st(at.prototype.context,"Interactable#context as a method is deprecated. It will soon be a DOM Node instead"),ot.isSet=function(t,e){return Lt.indexOfElement(t,e&&e.context)!==-1},ot.on=function(t,e,n){if(c(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),o(t)){for(var r=0;r<t.length;r++)ot.on(t[r],e,n);return ot}if(a(t)){for(var i in t)ot.on(i,t[i],e);return ot}return dt(Ht,t)?jt[t]?jt[t].push(e):jt[t]=[e]:Yt.add(mt,t,e,n),ot},ot.off=function(t,e,n){if(c(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),o(t)){for(var r=0;r<t.length;r++)ot.off(t[r],e,n);return ot}if(a(t)){for(var i in t)ot.off(i,t[i],e);return ot}if(dt(Ht,t)){var s;t in jt&&(s=ct(jt[t],e))!==-1&&jt[t].splice(s,1)}else Yt.remove(mt,t,e,n);return ot},ot.enableDragging=st(function(t){return null!==t&&void 0!==t?(Rt.drag=t,ot):Rt.drag},"interact.enableDragging is deprecated and will soon be removed."),ot.enableResizing=st(function(t){return null!==t&&void 0!==t?(Rt.resize=t,ot):Rt.resize},"interact.enableResizing is deprecated and will soon be removed."),ot.enableGesturing=st(function(t){return null!==t&&void 0!==t?(Rt.gesture=t,ot):Rt.gesture},"interact.enableGesturing is deprecated and will soon be removed."),ot.eventTypes=Ht,ot.debug=function(){var t=At[0]||new X;return{interactions:At,target:t.target,dragging:t.dragging,resizing:t.resizing,gesturing:t.gesturing,prepared:t.prepared,matches:t.matches,matchElements:t.matchElements,prevCoords:t.prevCoords,startCoords:t.startCoords,pointerIds:t.pointerIds,pointers:t.pointers,addPointer:Zt.addPointer,removePointer:Zt.removePointer,recordPointer:Zt.recordPointer,snap:t.snapStatus,restrict:t.restrictStatus,inertia:t.inertiaStatus,downTime:t.downTimes[0],downEvent:t.downEvent,downPointer:t.downPointer,prevEvent:t.prevEvent,Interactable:at,interactables:Lt,pointerIsDown:t.pointerIsDown,defaultOptions:Pt,defaultActionChecker:et,actionCursors:Ft,dragMove:Zt.dragMove,resizeMove:Zt.resizeMove,gestureMove:Zt.gestureMove,pointerUp:Zt.pointerUp,pointerDown:Zt.pointerDown,pointerMove:Zt.pointerMove,pointerHover:Zt.pointerHover,eventTypes:Ht,events:Yt,globalEvents:jt,delegatedEvents:Tt,prefixedPropREs:Kt}},ot.getPointerAverage=A,ot.getTouchBBox=E,ot.getTouchDistance=T,ot.getTouchAngle=P,ot.getElementRect=S,ot.getElementClientRect=C,ot.matchesSelector=ht,ot.closest=G,ot.margin=st(function(t){return l(t)?(It=t,ot):It},"interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead."),ot.supportsTouch=function(){return Ot},ot.supportsPointerEvent=function(){return Nt},ot.stop=function(t){for(var e=At.length-1;e>=0;e--)At[e].stop(t);return ot},ot.dynamicDrop=function(t){return u(t)?(Et=t,ot):Et},ot.pointerMoveTolerance=function(t){return l(t)?(zt=t,this):zt},ot.maxInteractions=function(t){return l(t)?(Wt=t,this):Wt},ot.createSnapGrid=function(t){return function(e,n){var r=0,i=0;a(t.offset)&&(r=t.offset.x,i=t.offset.y);var o=Math.round((e-r)/t.x),s=Math.round((n-i)/t.y),l=o*t.x+r,u=s*t.y+i;return{x:l,y:u,range:t.range}}},ut(mt),qt in Element.prototype&&s(Element.prototype[qt])||(gt=function(t,e,n){n=n||t.parentNode.querySelectorAll(e);for(var r=0,i=n.length;r<i;r++)if(n[r]===t)return!0;return!1}),function(){for(var e=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!t.requestAnimationFrame;++r)Ut=t[n[r]+"RequestAnimationFrame"],Xt=t[n[r]+"CancelAnimationFrame"]||t[n[r]+"CancelRequestAnimationFrame"];Ut||(Ut=function(t){var n=(new Date).getTime(),r=Math.max(0,16-(n-e)),i=setTimeout(function(){t(n+r)},r);return e=n+r,i}),Xt||(Xt=function(t){clearTimeout(t)})}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=ot),exports.interact=ot):"function"==typeof define&&define.amd?define("interact",function(){return ot}):t.interact=ot}}("undefined"==typeof window?void 0:window),function(){function t(t,e){window.XMLHttpRequest.prototype[t]=e(window.XMLHttpRequest.prototype[t])}function e(t,e,n,r,i,a,s){function l(){return"input"===e[0].tagName.toLowerCase()&&e.attr("type")&&"file"===e.attr("type").toLowerCase()}function u(n){a(function(){e.parent().length&&g.push(t.$watch(n,function(t,e){t!=e&&c()}))})}function c(){var n=e.clone();if(e.attr("__afu_gen__")&&angular.element(document.getElementById(e.attr("id").substring(1))).remove(),e.parent().length){for(var r=0;r<g.length;r++)g[r]();e.replaceWith(n),s(n)(t)}return n}function d(r,o){if(r){u(r);var a=i(r)(t);a?(e.attr(o,a),n[o]=a):(e.attr(o,null),delete n[o])}}function h(e){var i;i=e.__files_||e.target&&e.target.files,f(i,n,r,t,e)}function p(t){var n=null!=v[0].value&&""!=v[0].value;if(v[0].value=null,navigator.userAgent.indexOf("Chrome")===-1)if(e.attr("__afu_clone__"))e.attr("__afu_clone__",null);else if(n&&h({target:{files:[]}}),navigator.appVersion.indexOf("MSIE 10")!==-1){var r=c();return r.attr("__afu_clone__",!0),r[0].click(),t.preventDefault(),t.stopPropagation(),!0}}function f(t,e,n,r,s){for(var l=[],u=[],c=e.accept?new RegExp(o(e.accept),"gi"):null,d=0;d<t.length;d++){var h=t.item(d);!c||h.type.match(c)||null!=h.name&&h.name.match(c)?l.push(h):u.push(h)}n&&a(function(){r[e.ngModel]&&(r[e.ngModel].value=l),r[e.ngModel]=l,n&&n.$setViewValue(null!=l&&0==l.length?"":l),e.ngModelRejected&&(r[e.ngModelRejected]&&(r[e.ngModelRejected].value=u),r[e.ngModelRejected]=u)}),e.ngFileChange&&""!=e.ngFileChange&&a(function(){i(e.ngFileChange)(r,{$files:l,$rejectedFiles:u,$event:s})})}var g=[];d(n.ngMultiple,"multiple"),d(n.ngAccept,"accept"),d(n.ngCapture,"capture"),""!=n.ngFileSelect&&(n.ngFileChange=n.ngFileSelect);var v=e;if(l())e.bind("click",p);else{v=angular.element('<input type="file">'),n.multiple&&v.attr("multiple",n.multiple),n.accept&&v.attr("accept",n.accept),n.capture&&v.attr("capture",n.capture);for(var m in n)if(0==m.indexOf("inputFile")){var y=m.substring("inputFile".length);y=y[0].toLowerCase()+y.substring(1),v.attr(y,n[m])}v.css("width","0px").css("height","0px").css("position","absolute").css("padding",0).css("margin",0).css("overflow","hidden").attr("tabindex","-1").css("opacity",0).attr("__afu_gen__",!0),e.attr("__refElem__",!0),v[0].__refElem__=e[0],e.parent()[0].insertBefore(v[0],e[0]),e.css("overflow","hidden"),e.bind("click",function(t){p(t)||v[0].click()})}v.bind("change",h),e.on("$destroy",function(){for(var t=0;t<g.length;t++)g[t]();e[0]!=v[0]&&v.remove()}),g.push(t.$watch(n.ngModel,function(t,e){t==e||null!=t&&t.length||(navigator.appVersion.indexOf("MSIE 10")!==-1?c():v[0].value=null)}))}function n(t,e,n,a,s,l,u){function c(t,e,n){var r=!0;if(y){var i=n.dataTransfer.items;if(null!=i)for(var o=0;o<i.length&&r;o++)r=r&&("file"==i[o].kind||""==i[o].kind)&&(null!=i[o].type.match(y)||null!=i[o].name&&null!=i[o].name.match(y))}var a=s(e.dragOverClass)(t,{$event:n});return a&&(a.delay&&(v=a.delay),a.accept&&(a=r?a.accept:a.reject)),
a||e.dragOverClass||"dragover"}function d(t,e,n,r){function o(t){!y||t.type.match(y)||null!=t.name&&t.name.match(y)?s.push(t):c.push(t)}function a(t,e,n){if(null!=e)if(e.isDirectory){var r=(n||"")+e.name;o({name:e.name,type:"directory",path:r});var i=e.createReader(),s=[];h++;var l=function(){i.readEntries(function(r){try{if(r.length)s=s.concat(Array.prototype.slice.call(r||[],0)),l();else{for(var i=0;i<s.length;i++)a(t,s[i],(n?n:"")+e.name+"/");h--}}catch(t){h--,console.error(t)}},function(){h--})};l()}else h++,e.file(function(t){try{h--,t.path=(n?n:"")+t.name,o(t)}catch(t){h--,console.error(t)}},function(t){h--})}var s=[],c=[],d=t.dataTransfer.items,h=0;if(d&&d.length>0&&"file"!=u.protocol())for(var p=0;p<d.length;p++){if(d[p].webkitGetAsEntry&&d[p].webkitGetAsEntry()&&d[p].webkitGetAsEntry().isDirectory){var f=d[p].webkitGetAsEntry();if(f.isDirectory&&!n)continue;null!=f&&(i(f.name)?a(s,f):d[p].webkitGetAsEntry().isDirectory||o(d[p].getAsFile()))}else{var g=d[p].getAsFile();null!=g&&o(g)}if(!r&&s.length>0)break}else{var v=t.dataTransfer.files;if(null!=v)for(var p=0;p<v.length&&(o(v.item(p)),r||!(s.length>0));p++);}var m=0;!function t(n){l(function(){if(h)10*m++<2e4&&t(10);else{if(!r&&s.length>1){for(var n=0;"directory"==s[n].type;)n++;s=[s[n]]}e(s,c)}},n||0)}()}var h=r();if(n.dropAvailable&&l(function(){t.dropAvailable?t.dropAvailable.value=h:t.dropAvailable=h}),!h)return void(0!=s(n.hideOnDropNotAvailable)(t)&&e.css("display","none"));var p,f=null,g=s(n.stopPropagation)(t),v=1,m=s(n.ngAccept)(t)||n.accept,y=m?new RegExp(o(m),"gi"):null;e[0].addEventListener("dragover",function(r){r.preventDefault(),g&&r.stopPropagation();var i=r.dataTransfer.effectAllowed;r.dataTransfer.dropEffect="move"===i||"linkMove"===i?"move":"copy",l.cancel(f),t.actualDragOverClass||(p=c(t,n,r)),e.addClass(p)},!1),e[0].addEventListener("dragenter",function(t){t.preventDefault(),g&&t.stopPropagation()},!1),e[0].addEventListener("dragleave",function(t){f=l(function(){e.removeClass(p),p=null},v||1)},!1),""!=n.ngFileDrop&&(n.ngFileChange=t.ngFileDrop),e[0].addEventListener("drop",function(r){r.preventDefault(),g&&r.stopPropagation(),e.removeClass(p),p=null,d(r,function(e,i){l(function(){a&&(t[n.ngModel]&&(t[n.ngModel].value=e),t[n.ngModel]=e,a&&a.$setViewValue(null!=e&&0==e.length?"":e)),n.ngModelRejected&&(t[n.ngModelRejected]&&(t[n.ngModelRejected].value=i),t[n.ngModelRejected]=i)}),l(function(){s(n.ngFileChange)(t,{$files:e,$rejectedFiles:i,$event:r})})},0!=s(n.allowDir)(t),n.multiple||s(n.ngMultiple)(t))},!1)}function r(){var t=document.createElement("div");return"draggable"in t&&"ondrop"in t}function i(t){return/^[\000-\177]*$/.test(t)}function o(t){if(t.length>2&&"/"===t[0]&&"/"===t[t.length-1])return t.substring(1,t.length-1);var e=t.split(","),n="";if(e.length>1)for(var r=0;r<e.length;r++)0==e[r].indexOf(".")&&(e[r]="*"+e[r]),n+="("+o(e[r])+")",r<e.length-1&&(n+="|");else n="^"+t.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",n=n.replace(/\\\*/g,".*").replace(/\\\?/g,".");return n}window.XMLHttpRequest&&!window.XMLHttpRequest.__isFileAPIShim&&t("setRequestHeader",function(t){return function(e,n){if("__setXHR_"===e){var r=n(this);r instanceof Function&&r(this)}else t.apply(this,arguments)}});var a=angular.module("angularFileUpload",[]);a.version="3.0.4",a.service("$upload",["$http","$q","$timeout",function(t,e,n){function r(r){r.method=r.method||"POST",r.headers=r.headers||{},r.transformRequest=r.transformRequest||function(e,n){return window.ArrayBuffer&&e instanceof window.ArrayBuffer?e:t.defaults.transformRequest[0](e,n)};var i=e.defer(),o=i.promise;return r.headers.__setXHR_=function(){return function(t){t&&(r.__XHR=t,r.xhrFn&&r.xhrFn(t),t.upload.addEventListener("progress",function(t){t.config=r,i.notify?i.notify(t):o.progress_fn&&n(function(){o.progress_fn(t)})},!1),t.upload.addEventListener("load",function(t){t.lengthComputable&&(t.config=r,i.notify?i.notify(t):o.progress_fn&&n(function(){o.progress_fn(t)}))},!1))}},t(r).then(function(t){i.resolve(t)},function(t){i.reject(t)},function(t){i.notify(t)}),o.success=function(t){return o.then(function(e){t(e.data,e.status,e.headers,r)}),o},o.error=function(t){return o.then(null,function(e){t(e.data,e.status,e.headers,r)}),o},o.progress=function(t){return o.progress_fn=t,o.then(null,null,function(e){t(e)}),o},o.abort=function(){return r.__XHR&&n(function(){r.__XHR.abort()}),o},o.xhr=function(t){return r.xhrFn=function(e){return function(){e&&e.apply(o,arguments),t.apply(o,arguments)}}(r.xhrFn),o},o}this.upload=function(t){t.headers=t.headers||{},t.headers["Content-Type"]=void 0;t.transformRequest;return t.transformRequest=t.transformRequest?"[object Array]"===Object.prototype.toString.call(t.transformRequest)?t.transformRequest:[t.transformRequest]:[],t.transformRequest.push(function(e,n){var r=new FormData,i={};for(var o in t.fields)i[o]=t.fields[o];if(e&&(i.data=e),t.formDataAppender)for(var o in i)t.formDataAppender(r,o,i[o]);else for(var o in i){var a=i[o];void 0!==a&&("[object String]"===Object.prototype.toString.call(a)?r.append(o,a):t.sendObjectsAsJsonBlob&&"object"==typeof a?r.append(o,new Blob([a],{type:"application/json"})):r.append(o,JSON.stringify(a)))}if(null!=t.file){var s=t.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(t.file))for(var l="[object String]"===Object.prototype.toString.call(s),u=0;u<t.file.length;u++)r.append(l?s:s[u],t.file[u],t.fileName&&t.fileName[u]||t.file[u].name);else r.append(s,t.file,t.fileName||t.file.name)}return r}),r(t)},this.http=function(t){return r(t)}}]),a.directive("ngFileSelect",["$parse","$timeout","$compile",function(t,n,r){return{restrict:"AEC",require:"?ngModel",link:function(i,o,a,s){e(i,o,a,s,t,n,r)}}}]),a.directive("ngFileDrop",["$parse","$timeout","$location",function(t,e,r){return{restrict:"AEC",require:"?ngModel",link:function(i,o,a,s){n(i,o,a,s,t,e,r)}}}]),a.directive("ngNoFileDrop",function(){return function(t,e,n){r()&&e.css("display","none")}}),a.directive("ngFileDropAvailable",["$parse","$timeout",function(t,e){return function(n,i,o){if(r()){var a=t(o.ngFileDropAvailable);e(function(){a(n)})}}}]);var s=angular.module("ngFileUpload",[]);for(var l in a)s[l]=a[l]}(),function(){function t(t,e){window.XMLHttpRequest.prototype[t]=e(window.XMLHttpRequest.prototype[t])}function e(t,e,n){try{Object.defineProperty(t,e,{get:n})}catch(t){}}var n=function(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t)return!0}catch(t){if(void 0!=navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1};if(window.XMLHttpRequest&&!window.FormData||window.FileAPI&&FileAPI.forceLoad){var r=function(t){if(!t.__listeners){t.upload||(t.upload={}),t.__listeners=[];var e=t.upload.addEventListener;t.upload.addEventListener=function(n,r,i){t.__listeners[n]=r,e&&e.apply(this,arguments)}}};t("open",function(t){return function(e,n,i){r(this),this.__url=n;try{t.apply(this,[e,n,i])}catch(n){n.message.indexOf("Access is denied")>-1&&(this.__origError=n,this.__url="_fix_for_ie_crossdomain__",t.apply(this,[e,this.__url,i]))}}}),t("getResponseHeader",function(t){return function(e){return this.__fileApiXHR&&this.__fileApiXHR.getResponseHeader?this.__fileApiXHR.getResponseHeader(e):null==t?null:t.apply(this,[e])}}),t("getAllResponseHeaders",function(t){return function(){return this.__fileApiXHR&&this.__fileApiXHR.getAllResponseHeaders?this.__fileApiXHR.getAllResponseHeaders():null==t?null:t.apply(this)}}),t("abort",function(t){return function(){return this.__fileApiXHR&&this.__fileApiXHR.abort?this.__fileApiXHR.abort():null==t?null:t.apply(this)}}),t("setRequestHeader",function(t){return function(e,n){if("__setXHR_"===e){r(this);var i=n(this);i instanceof Function&&i(this)}else this.__requestHeaders=this.__requestHeaders||{},this.__requestHeaders[e]=n,t.apply(this,arguments)}}),t("send",function(t){return function(){var r=this;if(arguments[0]&&arguments[0].__isFileAPIShim){var i=arguments[0],o={url:r.__url,jsonp:!1,cache:!0,complete:function(t,n){r.__completed=!0,!t&&r.__listeners.load&&r.__listeners.load({type:"load",loaded:r.__loaded,total:r.__total,target:r,lengthComputable:!0}),!t&&r.__listeners.loadend&&r.__listeners.loadend({type:"loadend",loaded:r.__loaded,total:r.__total,target:r,lengthComputable:!0}),"abort"===t&&r.__listeners.abort&&r.__listeners.abort({type:"abort",loaded:r.__loaded,total:r.__total,target:r,lengthComputable:!0}),void 0!==n.status&&e(r,"status",function(){return 0==n.status&&t&&"abort"!==t?500:n.status}),void 0!==n.statusText&&e(r,"statusText",function(){return n.statusText}),e(r,"readyState",function(){return 4}),void 0!==n.response&&e(r,"response",function(){return n.response});var i=n.responseText||(t&&0==n.status&&"abort"!==t?t:void 0);e(r,"responseText",function(){return i}),e(r,"response",function(){return i}),t&&e(r,"err",function(){return t}),r.__fileApiXHR=n,r.onreadystatechange&&r.onreadystatechange(),r.onload&&r.onload()},fileprogress:function(t){if(t.target=r,r.__listeners.progress&&r.__listeners.progress(t),r.__total=t.total,r.__loaded=t.loaded,t.total===t.loaded){var e=this;setTimeout(function(){r.__completed||(r.getAllResponseHeaders=function(){},e.complete(null,{status:204,statusText:"No Content"}))},FileAPI.noContentTimeout||1e4)}},headers:r.__requestHeaders};o.data={},o.files={};for(var a=0;a<i.data.length;a++){var s=i.data[a];null!=s.val&&null!=s.val.name&&null!=s.val.size&&null!=s.val.type?o.files[s.key]=s.val:o.data[s.key]=s.val}setTimeout(function(){if(!n())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';r.__fileApiXHR=FileAPI.upload(o)},1)}else{if("_fix_for_ie_crossdomain__"===this.__url)throw this.__origError;t.apply(r,arguments)}}}),window.XMLHttpRequest.__isFileAPIShim=!0;var i=function(t){if(!n())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';var e=angular.element(t);if(!e.attr("disabled")){for(var r=!1,i=0;i<e[0].attributes.length;i++){var o=e[0].attributes[i];if(o.name.indexOf("file-select")!==-1){r=!0;break}}if(!e.hasClass("js-fileapi-wrapper")&&(r||null!=e.attr("__afu_gen__"))&&(e.addClass("js-fileapi-wrapper"),null!=e.attr("__afu_gen__"))){for(var a=e[0].__refElem__&&angular.element(e[0].__refElem__)||e;a&&!a.attr("__refElem__");)a=angular.element(a[0].nextSibling);a.bind("mouseover",function(){""!==e.parent().css("position")&&"static"!==e.parent().css("position")||e.parent().css("position","relative"),e.css("position","absolute").css("top",a[0].offsetTop+"px").css("left",a[0].offsetLeft+"px").css("width",a[0].offsetWidth+"px").css("height",a[0].offsetHeight+"px").css("padding",a.css("padding")).css("margin",a.css("margin")).css("filter","alpha(opacity=0)"),a.attr("onclick",""),e.css("z-index","1000")})}}},o=function(t){return function(e){for(var n=FileAPI.getFiles(e),r=0;r<n.length;r++)void 0===n[r].size&&(n[r].size=0),void 0===n[r].name&&(n[r].name="file"),void 0===n[r].type&&(n[r].type="undefined");e.target||(e.target={}),e.target.files=n,e.target.files!=n&&(e.__files_=n),(e.__files_||e.target.files).item=function(t){return(e.__files_||e.target.files)[t]||null},t&&t.apply(this,[e])}},a=function(t,e){return("change"===e.toLowerCase()||"onchange"===e.toLowerCase())&&"file"==t.getAttribute("type")};HTMLInputElement.prototype.addEventListener&&(HTMLInputElement.prototype.addEventListener=function(t){return function(e,n,r,s){a(this,e)?(i(this),t.apply(this,[e,o(n),r,s])):t.apply(this,[e,n,r,s])}}(HTMLInputElement.prototype.addEventListener)),HTMLInputElement.prototype.attachEvent&&(HTMLInputElement.prototype.attachEvent=function(t){return function(e,n){a(this,e)?(i(this),window.jQuery?angular.element(this).bind("change",o(null)):t.apply(this,[e,o(n)])):t.apply(this,[e,n])}}(HTMLInputElement.prototype.attachEvent)),window.FormData=FormData=function(){return{append:function(t,e,n){e.__isFileAPIBlobShim&&(e=e.data[0]),this.data.push({key:t,val:e,name:n})},data:[],__isFileAPIShim:!0}},window.Blob=Blob=function(t){return{data:t,__isFileAPIBlobShim:!0}},function(){if(window.FileAPI||(window.FileAPI={}),FileAPI.forceLoad&&(FileAPI.html5=!1),!FileAPI.upload){var t,e,r,i,o,a=document.createElement("script"),s=document.getElementsByTagName("script");if(window.FileAPI.jsUrl)t=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)e=window.FileAPI.jsPath;else for(r=0;r<s.length;r++)if(o=s[r].src,i=o.search(/\/angular\-file\-upload[\-a-zA-z0-9\.]*\.js/),i>-1){e=o.substring(0,i+1);break}null==FileAPI.staticPath&&(FileAPI.staticPath=e),a.setAttribute("src",t||e+"FileAPI.min.js"),document.getElementsByTagName("head")[0].appendChild(a),FileAPI.hasFlash=n()}}(),FileAPI.disableFileInput=function(t,e){e?t.removeClass("js-fileapi-wrapper"):t.addClass("js-fileapi-wrapper")}}window.FileReader||(window.FileReader=function(){var t=this,e=!1;this.listeners={},this.addEventListener=function(e,n){t.listeners[e]=t.listeners[e]||[],t.listeners[e].push(n)},this.removeEventListener=function(e,n){t.listeners[e]&&t.listeners[e].splice(t.listeners[e].indexOf(n),1)},this.dispatchEvent=function(e){var n=t.listeners[e.type];if(n)for(var r=0;r<n.length;r++)n[r].call(t,e)},this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var n=function(e,n){var r={type:e,target:t,loaded:n.loaded,total:n.total,error:n.error};return null!=n.result&&(r.target.result=n.result),r},r=function(r){if(e||(e=!0,t.onloadstart&&t.onloadstart(n("loadstart",r))),"load"===r.type){t.onloadend&&t.onloadend(n("loadend",r));var i=n("load",r);t.onload&&t.onload(i),t.dispatchEvent(i)}else if("progress"===r.type){var i=n("progress",r);t.onprogress&&t.onprogress(i),t.dispatchEvent(i)}else{var i=n("error",r);t.onerror&&t.onerror(i),t.dispatchEvent(i)}};this.readAsArrayBuffer=function(t){FileAPI.readAsBinaryString(t,r)},this.readAsBinaryString=function(t){FileAPI.readAsBinaryString(t,r)},this.readAsDataURL=function(t){FileAPI.readAsDataURL(t,r)},this.readAsText=function(t){FileAPI.readAsText(t,r)}})}(),function(t){function e(){var t=Error.apply(this,arguments);t.name=this.name="FlashError",this.stack=t.stack,this.message=t.message}function r(){var t=Error.apply(this,arguments);t.name=this.name="WebcamError",this.stack=t.stack,this.message=t.message}var i;IntermediateInheritor=function(){},IntermediateInheritor.prototype=Error.prototype,e.prototype=new IntermediateInheritor,r.prototype=new IntermediateInheritor;var o={version:"1.0.22",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,iOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0,iosPlaceholderText:"Click here to open camera.",user_callback:null,user_canvas:null},errors:{FlashError:e,WebcamError:r},hooks:{},init:function(){var e=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function(t){return new Promise(function(e,n){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,t,e,n)})}}:null,t.URL=t.URL||t.webkitURL||t.mozURL||t.msURL,this.userMedia=this.userMedia&&!!this.mediaDevices&&!!t.URL,navigator.userAgent.match(/Firefox\D+(\d+)/)&&parseInt(RegExp.$1,10)<21&&(this.userMedia=null),this.userMedia&&t.addEventListener("beforeunload",function(t){e.reset()})},exifOrientation:function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return console.log("Not a valid JPEG file"),0;for(var r=2,i=null;r<t.byteLength;){if(255!=e.getUint8(r))return console.log("Not a valid marker at offset "+r+", found: "+e.getUint8(r)),0;if(i=e.getUint8(r+1),225==i){r+=4;var o="";for(n=0;n<4;n++)o+=String.fromCharCode(e.getUint8(r+n));if("Exif"!=o)return console.log("Not valid EXIF data found"),0;r+=6;var a=null;if(18761==e.getUint16(r))a=!1;else{if(19789!=e.getUint16(r))return console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),0;a=!0}if(42!=e.getUint16(r+2,!a))return console.log("Not valid TIFF data! (no 0x002A)"),0;var s=e.getUint32(r+4,!a);if(s<8)return console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(r+4,!a)),0;for(var l=r+s,u=e.getUint16(l,!a),c=0;c<u;c++){var d=l+12*c+2;if(274==e.getUint16(d,!a)){var h=e.getUint16(d+2,!a),p=e.getUint32(d+4,!a);if(3!=h&&1!=p)return console.log("Invalid EXIF orientation value type ("+h+") or count ("+p+")"),0;var f=e.getUint16(d+8,!a);return f<1||f>8?(console.log("Invalid EXIF orientation value ("+f+")"),0):f}}}else r+=2+e.getUint16(r+2)}return 0},fixOrientation:function(t,e,n){var r=new Image;r.addEventListener("load",function(t){var i=document.createElement("canvas"),o=i.getContext("2d");switch(e<5?(i.width=r.width,i.height=r.height):(i.width=r.height,i.height=r.width),e){case 2:o.transform(-1,0,0,1,r.width,0);break;case 3:o.transform(-1,0,0,-1,r.width,r.height);break;case 4:o.transform(1,0,0,-1,0,r.height);break;case 5:o.transform(0,1,1,0,0,0);break;case 6:o.transform(0,1,-1,0,r.height,0);break;case 7:o.transform(0,-1,-1,0,r.height,r.width);break;case 8:o.transform(0,-1,1,0,0,r.width)}o.drawImage(r,0,0),n.src=i.toDataURL()},!1),r.src=t},attach:function(e){if("string"==typeof e&&(e=document.getElementById(e)||document.querySelector(e)),!e)return this.dispatch("error",new r("Could not locate DOM element to attach to."));this.container=e,e.innerHTML="";var n=document.createElement("div");if(e.appendChild(n),this.peg=n,this.params.width||(this.params.width=e.offsetWidth),this.params.height||(this.params.height=e.offsetHeight),!this.params.width||!this.params.height)return this.dispatch("error",new r("No width and/or height for webcam.  Please call set() first, or attach to a visible element."));this.params.dest_width||(this.params.dest_width=this.params.width),this.params.dest_height||(this.params.dest_height=this.params.height),this.userMedia=void 0===i?this.userMedia:i,this.params.force_flash&&(i=this.userMedia,this.userMedia=null),"number"!=typeof this.params.fps&&(this.params.fps=30);var a=this.params.width/this.params.dest_width,s=this.params.height/this.params.dest_height;if(this.userMedia){var l=document.createElement("video");l.setAttribute("autoplay","autoplay"),l.style.width=""+this.params.dest_width+"px",l.style.height=""+this.params.dest_height+"px",1==a&&1==s||(e.style.overflow="hidden",l.style.webkitTransformOrigin="0px 0px",l.style.mozTransformOrigin="0px 0px",l.style.msTransformOrigin="0px 0px",l.style.oTransformOrigin="0px 0px",l.style.transformOrigin="0px 0px",l.style.webkitTransform="scaleX("+a+") scaleY("+s+")",l.style.mozTransform="scaleX("+a+") scaleY("+s+")",l.style.msTransform="scaleX("+a+") scaleY("+s+")",l.style.oTransform="scaleX("+a+") scaleY("+s+")",l.style.transform="scaleX("+a+") scaleY("+s+")"),e.appendChild(l),this.video=l;var u=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then(function(e){l.onloadedmetadata=function(t){u.stream=e,u.loaded=!0,u.live=!0,u.dispatch("load"),u.dispatch("live"),u.flip()},l.src=t.URL.createObjectURL(e)||e}).catch(function(t){u.params.enable_flash&&u.detectFlash()?setTimeout(function(){u.params.force_flash=1,u.attach(e)},1):u.dispatch("error",t)})}else if(this.iOS){var c=document.createElement("div");c.id=this.container.id+"-ios_div",c.className="webcamjs-ios-placeholder",c.style.width=""+this.params.width+"px",c.style.height=""+this.params.height+"px",c.style.textAlign="center",c.style.display="table-cell",c.style.verticalAlign="middle",c.style.backgroundRepeat="no-repeat",c.style.backgroundSize="contain",c.style.backgroundPosition="center";var d=document.createElement("span");d.className="webcamjs-ios-text",d.innerHTML=this.params.iosPlaceholderText,c.appendChild(d);var h=document.createElement("img");h.id=this.container.id+"-ios_img",h.style.width=""+this.params.dest_width+"px",h.style.height=""+this.params.dest_height+"px",h.style.display="none",c.appendChild(h);var p=document.createElement("input");p.id=this.container.id+"-ios_input",p.setAttribute("type","file"),p.setAttribute("accept","image/*"),p.setAttribute("capture","camera");var u=this,f=this.params;p.addEventListener("change",function(t){if(t.target.files.length>0&&0==t.target.files[0].type.indexOf("image/")){var e=URL.createObjectURL(t.target.files[0]),n=new Image;n.addEventListener("load",function(t){var e=document.createElement("canvas");e.width=f.dest_width,e.height=f.dest_height;var r=e.getContext("2d");ratio=Math.min(n.width/f.dest_width,n.height/f.dest_height);var i=f.dest_width*ratio,o=f.dest_height*ratio,a=(n.width-i)/2,s=(n.height-o)/2;r.drawImage(n,a,s,i,o,0,0,f.dest_width,f.dest_height);var l=e.toDataURL();h.src=l,c.style.backgroundImage="url('"+l+"')"},!1);var r=new FileReader;r.addEventListener("load",function(t){var r=u.exifOrientation(t.target.result);r>1?u.fixOrientation(e,r,n):n.src=e},!1);var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(t){200!=this.status&&0!==this.status||r.readAsArrayBuffer(this.response)},i.send()}},!1),p.style.display="none",e.appendChild(p),c.addEventListener("click",function(t){f.user_callback?u.snap(f.user_callback,f.user_canvas):(p.style.display="block",p.focus(),p.click(),p.style.display="none")},!1),e.appendChild(c),this.loaded=!0,this.live=!0}else if(this.params.enable_flash&&this.detectFlash()){t.Webcam=o;var c=document.createElement("div");c.innerHTML=this.getSWFHTML(),e.appendChild(c)}else this.dispatch("error",new r(this.params.noInterfaceFoundText));if(this.params.crop_width&&this.params.crop_height){var g=Math.floor(this.params.crop_width*a),v=Math.floor(this.params.crop_height*s);e.style.width=""+g+"px",e.style.height=""+v+"px",e.style.overflow="hidden",e.scrollLeft=Math.floor(this.params.width/2-g/2),e.scrollTop=Math.floor(this.params.height/2-v/2)}else e.style.width=""+this.params.width+"px",e.style.height=""+this.params.height+"px"},reset:function(){if(this.preview_active&&this.unfreeze(),this.unflip(),this.userMedia){if(this.stream)if(this.stream.getVideoTracks){var t=this.stream.getVideoTracks();t&&t[0]&&t[0].stop&&t[0].stop()}else this.stream.stop&&this.stream.stop();delete this.stream,delete this.video}if(this.userMedia!==!0&&this.loaded&&!this.iOS){var e=this.getMovie();e&&e._releaseCamera&&e._releaseCamera()}this.container&&(this.container.innerHTML="",delete this.container),this.loaded=!1,this.live=!1},set:function(){if(1==arguments.length)for(var t in arguments[0])this.params[t]=arguments[0][t];else this.params[arguments[0]]=arguments[1]},on:function(t,e){t=t.replace(/^on/i,"").toLowerCase(),this.hooks[t]||(this.hooks[t]=[]),this.hooks[t].push(e)},off:function(t,e){if(t=t.replace(/^on/i,"").toLowerCase(),this.hooks[t])if(e){var n=this.hooks[t].indexOf(e);n>-1&&this.hooks[t].splice(n,1)}else this.hooks[t]=[]},dispatch:function(){var n=arguments[0].replace(/^on/i,"").toLowerCase(),i=Array.prototype.slice.call(arguments,1);if(this.hooks[n]&&this.hooks[n].length){for(var o=0,a=this.hooks[n].length;o<a;o++){var s=this.hooks[n][o];"function"==typeof s?s.apply(this,i):"object"==typeof s&&2==s.length?s[0][s[1]].apply(s[0],i):t[s]&&t[s].apply(t,i)}return!0}return"error"==n&&(i[0]instanceof e||i[0]instanceof r?message=i[0].message:message="Could not access webcam: "+i[0].name+": "+i[0].message+" "+i[0].toString(),alert("Webcam.js Error: "+message)),!1},setSWFLocation:function(t){this.set("swfURL",t)},detectFlash:function(){var e="Shockwave Flash",n="ShockwaveFlash.ShockwaveFlash",r="application/x-shockwave-flash",i=t,o=navigator,a=!1;if("undefined"!=typeof o.plugins&&"object"==typeof o.plugins[e]){var s=o.plugins[e].description;s&&"undefined"!=typeof o.mimeTypes&&o.mimeTypes[r]&&o.mimeTypes[r].enabledPlugin&&(a=!0)}else if("undefined"!=typeof i.ActiveXObject)try{var l=new ActiveXObject(n);if(l){var u=l.GetVariable("$version");u&&(a=!0)}}catch(t){}return a},getSWFHTML:function(){var n="",r=this.params.swfURL;if(location.protocol.match(/file/))return this.dispatch("error",new e("Flash does not work from local disk.  Please run from a web server.")),'<h3 style="color:red">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>';if(!this.detectFlash())return this.dispatch("error",new e("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again.")),'<h3 style="color:red">'+this.params.flashNotDetectedText+"</h3>";if(!r){for(var i="",o=document.getElementsByTagName("script"),a=0,s=o.length;a<s;a++){var l=o[a].getAttribute("src");l&&l.match(/\/webcam(\.min)?\.js/)&&(i=l.replace(/\/webcam(\.min)?\.js.*$/,""),a=s)}r=i?i+"/webcam.swf":"webcam.swf"}t.localStorage&&!localStorage.getItem("visited")&&(this.params.new_user=1,localStorage.setItem("visited",1));var u="";for(var c in this.params)u&&(u+="&"),u+=c+"="+escape(this.params[c]);return n+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this.params.width+'" height="'+this.params.height+'" id="webcam_movie_obj" align="middle"><param name="wmode" value="opaque" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+r+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+u+'"/><embed id="webcam_movie_embed" src="'+r+'" wmode="opaque" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+this.params.width+'" height="'+this.params.height+'" name="webcam_movie_embed" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+u+'"></embed></object>'},getMovie:function(){if(!this.loaded)return this.dispatch("error",new e("Flash Movie is not loaded yet"));var t=document.getElementById("webcam_movie_obj");return t&&t._snap||(t=document.getElementById("webcam_movie_embed")),t||this.dispatch("error",new e("Cannot locate Flash movie in DOM")),t},freeze:function(){var t=this,e=this.params;this.preview_active&&this.unfreeze();var n=this.params.width/this.params.dest_width,r=this.params.height/this.params.dest_height;this.unflip();var i=e.crop_width||e.dest_width,o=e.crop_height||e.dest_height,a=document.createElement("canvas");a.width=i,a.height=o;var s=a.getContext("2d");this.preview_canvas=a,this.preview_context=s,1==n&&1==r||(a.style.webkitTransformOrigin="0px 0px",a.style.mozTransformOrigin="0px 0px",a.style.msTransformOrigin="0px 0px",a.style.oTransformOrigin="0px 0px",a.style.transformOrigin="0px 0px",a.style.webkitTransform="scaleX("+n+") scaleY("+r+")",a.style.mozTransform="scaleX("+n+") scaleY("+r+")",a.style.msTransform="scaleX("+n+") scaleY("+r+")",a.style.oTransform="scaleX("+n+") scaleY("+r+")",a.style.transform="scaleX("+n+") scaleY("+r+")"),this.snap(function(){a.style.position="relative",a.style.left=""+t.container.scrollLeft+"px",a.style.top=""+t.container.scrollTop+"px",t.container.insertBefore(a,t.peg),t.container.style.overflow="hidden",t.preview_active=!0},a)},unfreeze:function(){this.preview_active&&(this.container.removeChild(this.preview_canvas),delete this.preview_context,delete this.preview_canvas,this.preview_active=!1,this.flip())},flip:function(){if(this.params.flip_horiz){var t=this.container.style;t.webkitTransform="scaleX(-1)",t.mozTransform="scaleX(-1)",t.msTransform="scaleX(-1)",t.oTransform="scaleX(-1)",t.transform="scaleX(-1)",t.filter="FlipH",t.msFilter="FlipH"}},unflip:function(){if(this.params.flip_horiz){var t=this.container.style;t.webkitTransform="scaleX(1)",t.mozTransform="scaleX(1)",t.msTransform="scaleX(1)",t.oTransform="scaleX(1)",t.transform="scaleX(1)",t.filter="",t.msFilter=""}},savePreview:function(t,e){var n=this.params,r=this.preview_canvas,i=this.preview_context;if(e){var o=e.getContext("2d");o.drawImage(r,0,0)}t(e?null:r.toDataURL("image/"+n.image_format,n.jpeg_quality/100),r,i),this.params.unfreeze_snap&&this.unfreeze()},snap:function(t,e){t||(t=this.params.user_callback),e||(e=this.params.user_canvas);var n=this.params;if(!this.loaded)return this.dispatch("error",new r("Webcam is not loaded yet"));if(!t)return this.dispatch("error",new r("Please provide a callback function or canvas to snap()"));if(this.preview_active)return this.savePreview(t,e),null;var i=document.createElement("canvas");i.width=this.params.dest_width,i.height=this.params.dest_height;var o=i.getContext("2d");this.params.flip_horiz&&(o.translate(n.dest_width,0),o.scale(-1,1));var a=function(){if(this.src&&this.width&&this.height&&o.drawImage(this,0,0,n.dest_width,n.dest_height),n.crop_width&&n.crop_height){var r=document.createElement("canvas");r.width=n.crop_width,r.height=n.crop_height;var a=r.getContext("2d");a.drawImage(i,Math.floor(n.dest_width/2-n.crop_width/2),Math.floor(n.dest_height/2-n.crop_height/2),n.crop_width,n.crop_height,0,0,n.crop_width,n.crop_height),o=a,i=r}if(e){var s=e.getContext("2d");s.drawImage(i,0,0)}t(e?null:i.toDataURL("image/"+n.image_format,n.jpeg_quality/100),i,o)};if(this.userMedia)o.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height),a();else if(this.iOS){var s=document.getElementById(this.container.id+"-ios_div"),l=document.getElementById(this.container.id+"-ios_img"),u=document.getElementById(this.container.id+"-ios_input");iFunc=function(t){a.call(l),l.removeEventListener("load",iFunc),s.style.backgroundImage="none",l.removeAttribute("src"),u.value=null},u.value?iFunc(null):(l.addEventListener("load",iFunc),u.style.display="block",u.focus(),u.click(),u.style.display="none")}else{var c=this.getMovie()._snap(),l=new Image;l.onload=a,l.src="data:image/"+this.params.image_format+";base64,"+c}return null},configure:function(t){t||(t="camera"),this.getMovie()._configure(t)},flashNotify:function(t,n){switch(t){case"flashLoadComplete":this.loaded=!0,this.dispatch("load");break;case"cameraLive":this.live=!0,this.dispatch("live");break;case"error":this.dispatch("error",new e(n))}},b64ToUint6:function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0},base64DecToArr:function(t,e){for(var n,r,i=t.replace(/[^A-Za-z0-9\+\/]/g,""),o=i.length,a=e?Math.ceil((3*o+1>>2)/e)*e:3*o+1>>2,s=new Uint8Array(a),l=0,u=0,c=0;c<o;c++)if(r=3&c,l|=this.b64ToUint6(i.charCodeAt(c))<<18-6*r,3===r||o-c===1){for(n=0;n<3&&u<a;n++,u++)s[u]=l>>>(16>>>n&24)&255;l=0}return s},upload:function(t,e,n){var r=this.params.upload_name||"webcam",i="";if(!t.match(/^data\:image\/(\w+)/))throw"Cannot locate image format in Data URI";i=RegExp.$1;var a=t.replace(/^data\:image\/\w+\;base64\,/,""),s=new XMLHttpRequest;s.open("POST",e,!0),s.upload&&s.upload.addEventListener&&s.upload.addEventListener("progress",function(t){if(t.lengthComputable){var e=t.loaded/t.total;o.dispatch("uploadProgress",e,t)}},!1);var l=this;s.onload=function(){n&&n.apply(l,[s.status,s.responseText,s.statusText]),o.dispatch("uploadComplete",s.status,s.responseText,s.statusText)};var u=new Blob([this.base64DecToArr(a)],{type:"image/"+i}),c=new FormData;c.append(r,u,r+"."+i.replace(/e/,"")),s.send(c)}};o.init(),"function"==typeof define&&define.amd?define(function(){return o}):"object"==typeof module&&module.exports?module.exports=o:t.Webcam=o}(window);var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var t=/\blang(?:uage)?-(\w+)\b/i,e=0,n=_self.Prism={
util:{encode:function(t){return t instanceof r?new r(t.type,n.util.encode(t.content),t.alias):"Array"===n.util.type(t)?t.map(n.util.encode):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).match(/\[object (\w+)\]/)[1]},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++e}),t.__id},clone:function(t){var e=n.util.type(t);switch(e){case"Object":var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=n.util.clone(t[i]));return r;case"Array":return t.map&&t.map(function(t){return n.util.clone(t)})}return t}},languages:{extend:function(t,e){var r=n.util.clone(n.languages[t]);for(var i in e)r[i]=e[i];return r},insertBefore:function(t,e,r,i){i=i||n.languages;var o=i[t];if(2==arguments.length){r=arguments[1];for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);return o}var s={};for(var l in o)if(o.hasOwnProperty(l)){if(l==e)for(var a in r)r.hasOwnProperty(a)&&(s[a]=r[a]);s[l]=o[l]}return n.languages.DFS(n.languages,function(e,n){n===i[t]&&e!=t&&(this[e]=s)}),i[t]=s},DFS:function(t,e,r,i){i=i||{};for(var o in t)t.hasOwnProperty(o)&&(e.call(t,o,t[o],r||o),"Object"!==n.util.type(t[o])||i[n.util.objId(t[o])]?"Array"!==n.util.type(t[o])||i[n.util.objId(t[o])]||(i[n.util.objId(t[o])]=!0,n.languages.DFS(t[o],e,o,i)):(i[n.util.objId(t[o])]=!0,n.languages.DFS(t[o],e,null,i)))}},plugins:{},highlightAll:function(t,e){var r={callback:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",r);for(var i,o=r.elements||document.querySelectorAll(r.selector),a=0;i=o[a++];)n.highlightElement(i,t===!0,r.callback)},highlightElement:function(e,r,i){for(var o,a,s=e;s&&!t.test(s.className);)s=s.parentNode;s&&(o=(s.className.match(t)||[,""])[1].toLowerCase(),a=n.languages[o]),e.className=e.className.replace(t,"").replace(/\s+/g," ")+" language-"+o,s=e.parentNode,/pre/i.test(s.nodeName)&&(s.className=s.className.replace(t,"").replace(/\s+/g," ")+" language-"+o);var l=e.textContent,u={element:e,language:o,grammar:a,code:l};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(u.element.textContent=u.code),void n.hooks.run("complete",u);if(n.hooks.run("before-highlight",u),r&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(t){u.highlightedCode=t.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,i&&i.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,i&&i.call(e),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(t,e,i){var o=n.tokenize(t,e);return r.stringify(n.util.encode(o),i)},tokenize:function(t,e,r){var i=n.Token,o=[t],a=e.rest;if(a){for(var s in a)e[s]=a[s];delete e.rest}t:for(var s in e)if(e.hasOwnProperty(s)&&e[s]){var l=e[s];l="Array"===n.util.type(l)?l:[l];for(var u=0;u<l.length;++u){var c=l[u],d=c.inside,h=!!c.lookbehind,p=!!c.greedy,f=0,g=c.alias;if(p&&!c.pattern.global){var v=c.pattern.toString().match(/[imuy]*$/)[0];c.pattern=RegExp(c.pattern.source,v+"g")}c=c.pattern||c;for(var m=0,y=0;m<o.length;y+=o[m].length,++m){var b=o[m];if(o.length>t.length)break t;if(!(b instanceof i)){c.lastIndex=0;var x=c.exec(b),_=1;if(!x&&p&&m!=o.length-1){if(c.lastIndex=y,x=c.exec(t),!x)break;for(var w=x.index+(h?x[1].length:0),k=x.index+x[0].length,M=m,C=y,S=o.length;M<S&&C<k;++M)C+=o[M].length,w>=C&&(++m,y=C);if(o[m]instanceof i||o[M-1].greedy)continue;_=M-m,b=t.slice(y,C),x.index-=y}if(x){h&&(f=x[1].length);var w=x.index+f,x=x[0].slice(f),k=w+x.length,L=b.slice(0,w),A=b.slice(k),E=[m,_];L&&E.push(L);var T=new i(s,d?n.tokenize(x,d):x,g,x,p);E.push(T),A&&E.push(A),Array.prototype.splice.apply(o,E)}}}}}return o},hooks:{all:{},add:function(t,e){var r=n.hooks.all;r[t]=r[t]||[],r[t].push(e)},run:function(t,e){var r=n.hooks.all[t];if(r&&r.length)for(var i,o=0;i=r[o++];)i(e)}}},r=n.Token=function(t,e,n,r,i){this.type=t,this.content=e,this.alias=n,this.length=0|(r||"").length,this.greedy=!!i};if(r.stringify=function(t,e,i){if("string"==typeof t)return t;if("Array"===n.util.type(t))return t.map(function(n){return r.stringify(n,e,t)}).join("");var o={type:t.type,content:r.stringify(t.content,e,i),tag:"span",classes:["token",t.type],attributes:{},language:e,parent:i};if("comment"==o.type&&(o.attributes.spellcheck="true"),t.alias){var a="Array"===n.util.type(t.alias)?t.alias:[t.alias];Array.prototype.push.apply(o.classes,a)}n.hooks.run("wrap",o);var s=Object.keys(o.attributes).map(function(t){return t+'="'+(o.attributes[t]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+(s?" "+s:"")+">"+o.content+"</"+o.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(t){var e=JSON.parse(t.data),r=e.language,i=e.code,o=e.immediateClose;_self.postMessage(n.highlight(i,n.languages[r],r)),o&&_self.close()},!1),_self.Prism):_self.Prism;var i=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return i&&(n.filename=i.src,document.addEventListener&&!i.hasAttribute("data-manual")&&("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism),Prism.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/i,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag)),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*\*?|\/|~|\^|%|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript,function(){"undefined"!=typeof self&&self.Prism&&self.document&&document.querySelector&&(self.Prism.fileHighlight=function(){var t={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"};Array.prototype.forEach&&Array.prototype.slice.call(document.querySelectorAll("pre[data-src]")).forEach(function(e){for(var n,r=e.getAttribute("data-src"),i=e,o=/\blang(?:uage)?-(?!\*)(\w+)\b/i;i&&!o.test(i.className);)i=i.parentNode;if(i&&(n=(e.className.match(o)||[,""])[1]),!n){var a=(r.match(/\.(\w+)$/)||[,""])[1];n=t[a]||a}var s=document.createElement("code");s.className="language-"+n,e.textContent="",s.textContent="Loading",e.appendChild(s);var l=new XMLHttpRequest;l.open("GET",r,!0),l.onreadystatechange=function(){4==l.readyState&&(l.status<400&&l.responseText?(s.textContent=l.responseText,Prism.highlightElement(s)):l.status>=400?s.textContent=" Error "+l.status+" while fetching file: "+l.statusText:s.textContent=" Error: File does not exist or is empty")},l.send(null)})},document.addEventListener("DOMContentLoaded",self.Prism.fileHighlight))}(),Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*\*?|\/|~|\^|%|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript,Prism.languages.json={property:/"(?:\\.|[^|"])*"(?=\s*:)/gi,string:/"(?!:)(?:\\.|[^|"])*"(?!:)/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee][+-]?\d+)?)\b/g,punctuation:/[{}[\]);,]/g,operator:/:/g,boolean:/\b(true|false)\b/gi,null:/\bnull\b/gi},Prism.languages.jsonp=Prism.languages.json,Prism.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag)),Prism.languages.yaml={scalar:{pattern:/([\-:]\s*(![^\s]+)?[ \t]*[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)[^\r\n]+(?:\3[^\r\n]+)*)/,lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:/(\s*(?:^|[:\-,[{\r\n?])[ \t]*(![^\s]+)?[ \t]*)[^\r\n{[\]},#\s]+?(?=\s*:\s)/,lookbehind:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(\d{4}-\d\d?-\d\d?([tT]|[ \t]+)\d\d?:\d{2}:\d{2}(\.\d*)?[ \t]*(Z|[-+]\d\d?(:\d{2})?)?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(:\d{2}(\.\d*)?)?)(?=[ \t]*($|,|]|}))/m,lookbehind:!0,alias:"number"},boolean:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(true|false)[ \t]*(?=$|,|]|})/im,lookbehind:!0,alias:"important"},null:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(null|~)[ \t]*(?=$|,|]|})/im,lookbehind:!0,alias:"important"},string:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)("(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*')(?=[ \t]*($|,|]|}))/m,lookbehind:!0},number:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)[+\-]?(0x[\da-f]+|0o[0-7]+|(\d+\.?\d*|\.?\d+)(e[\+\-]?\d+)?|\.inf|\.nan)[ \t]*(?=$|,|]|})/im,lookbehind:!0},tag:/![^\s]+/,important:/[&*][\w]+/,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.CodeMirror=e()}(this,function(){"use strict";function t(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}function e(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function n(t,n){return e(t).appendChild(n)}function r(t,e,n,r){var i=document.createElement(t);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof e)i.appendChild(document.createTextNode(e));else if(e)for(var o=0;o<e.length;++o)i.appendChild(e[o]);return i}function i(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do if(11==e.nodeType&&(e=e.host),e==t)return!0;while(e=e.parentNode)}function o(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.root&&t.root.activeElement;)t=t.root.activeElement;return t}function a(e,n){var r=e.className;t(n).test(r)||(e.className+=(r?" ":"")+n)}function s(e,n){for(var r=e.split(" "),i=0;i<r.length;i++)r[i]&&!t(r[i]).test(n)&&(n+=" "+r[i]);return n}function l(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function u(t,e,n){e||(e={});for(var r in t)!t.hasOwnProperty(r)||n===!1&&e.hasOwnProperty(r)||(e[r]=t[r]);return e}function c(t,e,n,r,i){null==e&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));for(var o=r||0,a=i||0;;){var s=t.indexOf("\t",o);if(s<0||s>=e)return a+(e-o);a+=s-o,a+=n-a%n,o=s+1}}function d(t,e){for(var n=0;n<t.length;++n)if(t[n]==e)return n;return-1}function h(t,e,n){for(var r=0,i=0;;){var o=t.indexOf("\t",r);o==-1&&(o=t.length);var a=o-r;if(o==t.length||i+a>=e)return r+Math.min(a,e-i);if(i+=o-r,i+=n-i%n,r=o+1,i>=e)return r}}function p(t){for(;Ma.length<=t;)Ma.push(f(Ma)+" ");return Ma[t]}function f(t){return t[t.length-1]}function g(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=e(t[r],r);return n}function v(t,e,n){for(var r=0,i=n(e);r<t.length&&n(t[r])<=i;)r++;t.splice(r,0,e)}function m(){}function y(t,e){var n;return Object.create?n=Object.create(t):(m.prototype=t,n=new m),e&&u(e,n),n}function b(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Ca.test(t))}function x(t,e){return e?!!(e.source.indexOf("\\w")>-1&&b(t))||e.test(t):b(t)}function _(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function w(t){return t.charCodeAt(0)>=768&&Sa.test(t)}function k(t,e,n){for(;(n<0?e>0:e<t.length)&&w(t.charAt(e));)e+=n;return e}function M(t,e,n){for(;;){if(Math.abs(e-n)<=1)return t(e)?e:n;var r=Math.floor((e+n)/2);t(r)?n=r:e=r}}function C(t,e,n){var i=this;this.input=n,i.scrollbarFiller=r("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=r("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=r("div",null,"CodeMirror-code"),i.selectionDiv=r("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=r("div",null,"CodeMirror-cursors"),i.measure=r("div",null,"CodeMirror-measure"),i.lineMeasure=r("div",null,"CodeMirror-measure"),i.lineSpace=r("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=r("div",[r("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=r("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=r("div",null,null,"position: absolute; height: "+ba+"px; width: 1px;"),i.gutters=r("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=r("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=r("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),Ko&&Zo<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),Qo||qo&&aa||(i.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(i.wrapper):t(i.wrapper)),i.viewFrom=i.viewTo=e.first,i.reportedViewFrom=i.reportedViewTo=e.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,n.init(i)}function S(t,e){if(e-=t.first,e<0||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var n=t;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(e<o){n=i;break}e-=o}return n.lines[e]}function L(t,e,n){var r=[],i=e.line;return t.iter(e.line,n.line+1,function(t){var o=t.text;i==n.line&&(o=o.slice(0,n.ch)),i==e.line&&(o=o.slice(e.ch)),r.push(o),++i}),r}function A(t,e,n){var r=[];return t.iter(e,n,function(t){r.push(t.text)}),r}function E(t,e){var n=e-t.height;if(n)for(var r=t;r;r=r.parent)r.height+=n}function T(t){if(null==t.parent)return null;for(var e=t.parent,n=d(e.lines,t),r=e.parent;r;e=r,r=r.parent)for(var i=0;r.children[i]!=e;++i)n+=r.children[i].chunkSize();return n+e.first}function P(t,e){var n=t.first;t:do{for(var r=0;r<t.children.length;++r){var i=t.children[r],o=i.height;if(e<o){t=i;continue t}e-=o,n+=i.chunkSize()}return n}while(!t.lines);for(var a=0;a<t.lines.length;++a){var s=t.lines[a],l=s.height;if(e<l)break;e-=l}return n+a}function D(t,e){return e>=t.first&&e<t.first+t.size}function O(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function N(t,e,n){return void 0===n&&(n=null),this instanceof N?(this.line=t,this.ch=e,void(this.sticky=n)):new N(t,e,n)}function I(t,e){return t.line-e.line||t.ch-e.ch}function z(t,e){return t.sticky==e.sticky&&0==I(t,e)}function G(t){return N(t.line,t.ch)}function W(t,e){return I(t,e)<0?e:t}function F(t,e){return I(t,e)<0?t:e}function R(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function B(t,e){if(e.line<t.first)return N(t.first,0);var n=t.first+t.size-1;return e.line>n?N(n,S(t,n).text.length):H(e,S(t,e.line).text.length)}function H(t,e){var n=t.ch;return null==n||n>e?N(t.line,e):n<0?N(t.line,0):t}function j(t,e){for(var n=[],r=0;r<e.length;r++)n[r]=B(t,e[r]);return n}function V(){La=!0}function $(){Aa=!0}function q(t,e,n){this.marker=t,this.from=e,this.to=n}function U(t,e){if(t)for(var n=0;n<t.length;++n){var r=t[n];if(r.marker==e)return r}}function X(t,e){for(var n,r=0;r<t.length;++r)t[r]!=e&&(n||(n=[])).push(t[r]);return n}function Y(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function K(t,e,n){var r;if(t)for(var i=0;i<t.length;++i){var o=t[i],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=e:o.from<e);if(s||o.from==e&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=e:o.to>e);(r||(r=[])).push(new q(a,o.from,l?null:o.to))}}return r}function Z(t,e,n){var r;if(t)for(var i=0;i<t.length;++i){var o=t[i],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=e:o.to>e);if(s||o.from==e&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=e:o.from<e);(r||(r=[])).push(new q(a,l?null:o.from-e,null==o.to?null:o.to-e))}}return r}function Q(t,e){if(e.full)return null;var n=D(t,e.from.line)&&S(t,e.from.line).markedSpans,r=D(t,e.to.line)&&S(t,e.to.line).markedSpans;if(!n&&!r)return null;var i=e.from.ch,o=e.to.ch,a=0==I(e.from,e.to),s=K(n,i,a),l=Z(r,o,a),u=1==e.text.length,c=f(e.text).length+(u?i:0);if(s)for(var d=0;d<s.length;++d){var h=s[d];if(null==h.to){var p=U(l,h.marker);p?u&&(h.to=null==p.to?null:p.to+c):h.to=i}}if(l)for(var g=0;g<l.length;++g){var v=l[g];if(null!=v.to&&(v.to+=c),null==v.from){var m=U(s,v.marker);m||(v.from=c,u&&(s||(s=[])).push(v))}else v.from+=c,u&&(s||(s=[])).push(v)}s&&(s=J(s)),l&&l!=s&&(l=J(l));var y=[s];if(!u){var b,x=e.text.length-2;if(x>0&&s)for(var _=0;_<s.length;++_)null==s[_].to&&(b||(b=[])).push(new q(s[_].marker,null,null));for(var w=0;w<x;++w)y.push(b);y.push(l)}return y}function J(t){for(var e=0;e<t.length;++e){var n=t[e];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&t.splice(e--,1)}return t.length?t:null}function tt(t,e,n){var r=null;if(t.iter(e.line,n.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var n=t.markedSpans[e].marker;!n.readOnly||r&&d(r,n)!=-1||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:e,to:n}],o=0;o<r.length;++o)for(var a=r[o],s=a.find(0),l=0;l<i.length;++l){var u=i[l];if(!(I(u.to,s.from)<0||I(u.from,s.to)>0)){var c=[l,1],h=I(u.from,s.from),p=I(u.to,s.to);(h<0||!a.inclusiveLeft&&!h)&&c.push({from:u.from,to:s.from}),(p>0||!a.inclusiveRight&&!p)&&c.push({from:s.to,to:u.to}),i.splice.apply(i,c),l+=c.length-3}}return i}function et(t){var e=t.markedSpans;if(e){for(var n=0;n<e.length;++n)e[n].marker.detachLine(t);t.markedSpans=null}}function nt(t,e){if(e){for(var n=0;n<e.length;++n)e[n].marker.attachLine(t);t.markedSpans=e}}function rt(t){return t.inclusiveLeft?-1:0}function it(t){return t.inclusiveRight?1:0}function ot(t,e){var n=t.lines.length-e.lines.length;if(0!=n)return n;var r=t.find(),i=e.find(),o=I(r.from,i.from)||rt(t)-rt(e);if(o)return-o;var a=I(r.to,i.to)||it(t)-it(e);return a?a:e.id-t.id}function at(t,e){var n,r=Aa&&t.markedSpans;if(r)for(var i=void 0,o=0;o<r.length;++o)i=r[o],i.marker.collapsed&&null==(e?i.from:i.to)&&(!n||ot(n,i.marker)<0)&&(n=i.marker);return n}function st(t){return at(t,!0)}function lt(t){return at(t,!1)}function ut(t,e,n,r,i){var o=S(t,e),a=Aa&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var u=l.marker.find(0),c=I(u.from,n)||rt(l.marker)-rt(i),d=I(u.to,r)||it(l.marker)-it(i);if(!(c>=0&&d<=0||c<=0&&d>=0)&&(c<=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?I(u.to,n)>=0:I(u.to,n)>0)||c>=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?I(u.from,r)<=0:I(u.from,r)<0)))return!0}}}function ct(t){for(var e;e=st(t);)t=e.find(-1,!0).line;return t}function dt(t){for(var e;e=lt(t);)t=e.find(1,!0).line;return t}function ht(t){for(var e,n;e=lt(t);)t=e.find(1,!0).line,(n||(n=[])).push(t);return n}function pt(t,e){var n=S(t,e),r=ct(n);return n==r?e:T(r)}function ft(t,e){if(e>t.lastLine())return e;var n,r=S(t,e);if(!gt(t,r))return e;for(;n=lt(r);)r=n.find(1,!0).line;return T(r)+1}function gt(t,e){var n=Aa&&e.markedSpans;if(n)for(var r=void 0,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&vt(t,e,r))return!0}}function vt(t,e,n){if(null==n.to){var r=n.marker.find(1,!0);return vt(t,r.line,U(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==e.text.length)return!0;for(var i=void 0,o=0;o<e.markedSpans.length;++o)if(i=e.markedSpans[o],i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&vt(t,e,i))return!0}function mt(t){t=ct(t);for(var e=0,n=t.parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==t)break;e+=i.height}for(var o=n.parent;o;n=o,o=n.parent)for(var a=0;a<o.children.length;++a){var s=o.children[a];if(s==n)break;e+=s.height}return e}function yt(t){if(0==t.height)return 0;for(var e,n=t.text.length,r=t;e=st(r);){var i=e.find(0,!0);r=i.from.line,n+=i.from.ch-i.to.ch}for(r=t;e=lt(r);){var o=e.find(0,!0);n-=r.text.length-o.from.ch,r=o.to.line,n+=r.text.length-o.to.ch}return n}function bt(t){var e=t.display,n=t.doc;e.maxLine=S(n,n.first),e.maxLineLength=yt(e.maxLine),e.maxLineChanged=!0,n.iter(function(t){var n=yt(t);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=t)})}function xt(t,e,n,r){if(!t)return r(e,n,"ltr");for(var i=!1,o=0;o<t.length;++o){var a=t[o];(a.from<n&&a.to>e||e==n&&a.to==e)&&(r(Math.max(a.from,e),Math.min(a.to,n),1==a.level?"rtl":"ltr"),i=!0)}i||r(e,n,"ltr")}function _t(t,e,n){var r;Ea=null;for(var i=0;i<t.length;++i){var o=t[i];if(o.from<e&&o.to>e)return i;o.to==e&&(o.from!=o.to&&"before"==n?r=i:Ea=i),o.from==e&&(o.from!=o.to&&"before"!=n?r=i:Ea=i)}return null!=r?r:Ea}function wt(t){var e=t.order;return null==e&&(e=t.order=Ta(t.text)),e}function kt(t,e,n){var r=k(t.text,e+n,n);return r<0||r>t.text.length?null:r}function Mt(t,e,n){var r=kt(t,e.ch,n);return null==r?null:new N(e.line,r,n<0?"after":"before")}function Ct(t,e,n,r,i){if(t){var o=wt(n);if(o){var a,s=i<0?f(o):o[0],l=i<0==(1==s.level),u=l?"after":"before";if(s.level>0){var c=Ye(e,n);a=i<0?n.text.length-1:0;var d=Ke(e,c,a).top;a=M(function(t){return Ke(e,c,t).top==d},i<0==(1==s.level)?s.from:s.to-1,a),"before"==u&&(a=kt(n,a,1,!0))}else a=i<0?s.to:s.from;return new N(r,a,u)}}return new N(r,i<0?n.text.length:0,i<0?"before":"after")}function St(t,e,n,r){var i=wt(e);if(!i)return Mt(e,n,r);n.ch>=e.text.length?(n.ch=e.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var o=_t(i,n.ch,n.sticky),a=i[o];if(a.level%2==0&&(r>0?a.to>n.ch:a.from<n.ch))return Mt(e,n,r);var s,l=function(t,n){return kt(e,t instanceof N?t.ch:t,n)},u=function(n){return t.options.lineWrapping?(s=s||Ye(t,e),gn(t,e,s,n)):{begin:0,end:e.text.length}},c=u("before"==n.sticky?l(n,-1):n.ch);if(a.level%2==1){var d=l(n,-r);if(null!=d&&(r>0?d>=a.from&&d>=c.begin:d<=a.to&&d<=c.end)){var h=r<0?"before":"after";return new N(n.line,d,h)}}var p=function(t,e,r){for(var o=function(t,e){return e?new N(n.line,l(t,1),"before"):new N(n.line,t,"after")};t>=0&&t<i.length;t+=e){var a=i[t],s=e>0==(1!=a.level),u=s?r.begin:l(r.end,-1);if(a.from<=u&&u<a.to)return o(u,s);if(u=s?a.from:l(a.to,-1),r.begin<=u&&u<r.end)return o(u,s)}},f=p(o+r,r,c);if(f)return f;var g=r>0?c.end:l(c.begin,-1);return null==g||r>0&&g==e.text.length||!(f=p(r>0?0:i.length-1,r,u(g)))?null:f}function Lt(t,e){return t._handlers&&t._handlers[e]||Pa}function At(t,e,n){if(t.removeEventListener)t.removeEventListener(e,n,!1);else if(t.detachEvent)t.detachEvent("on"+e,n);else{var r=t._handlers,i=r&&r[e];if(i){var o=d(i,n);o>-1&&(r[e]=i.slice(0,o).concat(i.slice(o+1)))}}}function Et(t,e){var n=Lt(t,e);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function Tt(t,e,n){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),Et(t,n||e.type,t,e),zt(e)||e.codemirrorIgnore}function Pt(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var n=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),r=0;r<e.length;++r)d(n,e[r])==-1&&n.push(e[r])}function Dt(t,e){return Lt(t,e).length>0}function Ot(t){t.prototype.on=function(t,e){Da(this,t,e)},t.prototype.off=function(t,e){At(this,t,e)}}function Nt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function It(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function zt(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function Gt(t){Nt(t),It(t)}function Wt(t){return t.target||t.srcElement}function Ft(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),sa&&t.ctrlKey&&1==e&&(e=3),e}function Rt(t){if(null==ma){var e=r("span","");n(t,r("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(ma=e.offsetWidth<=1&&e.offsetHeight>2&&!(Ko&&Zo<8))}var i=ma?r("span",""):r("span","",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function Bt(t){if(null!=ya)return ya;var r=n(t,document.createTextNode("AA")),i=da(r,0,1).getBoundingClientRect(),o=da(r,1,2).getBoundingClientRect();return e(t),!(!i||i.left==i.right)&&(ya=o.right-i.right<3)}function Ht(t){if(null!=Ga)return Ga;var e=n(t,r("span","x")),i=e.getBoundingClientRect(),o=da(e,0,1).getBoundingClientRect();return Ga=Math.abs(i.left-o.left)>1}function jt(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),Wa[t]=e}function Vt(t,e){Fa[t]=e}function $t(t){if("string"==typeof t&&Fa.hasOwnProperty(t))t=Fa[t];else if(t&&"string"==typeof t.name&&Fa.hasOwnProperty(t.name)){var e=Fa[t.name];"string"==typeof e&&(e={name:e}),t=y(e,t),t.name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return $t("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return $t("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function qt(t,e){e=$t(e);var n=Wa[e.name];if(!n)return qt(t,"text/plain");var r=n(t,e);if(Ra.hasOwnProperty(e.name)){var i=Ra[e.name];for(var o in i)i.hasOwnProperty(o)&&(r.hasOwnProperty(o)&&(r["_"+o]=r[o]),r[o]=i[o])}if(r.name=e.name,e.helperType&&(r.helperType=e.helperType),e.modeProps)for(var a in e.modeProps)r[a]=e.modeProps[a];return r}function Ut(t,e){var n=Ra.hasOwnProperty(t)?Ra[t]:Ra[t]={};u(e,n)}function Xt(t,e){if(e===!0)return e;if(t.copyState)return t.copyState(e);var n={};for(var r in e){var i=e[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Yt(t,e){for(var n;t.innerMode&&(n=t.innerMode(e),n&&n.mode!=t);)e=n.state,t=n.mode;return n||{mode:t,state:e}}function Kt(t,e,n){return!t.startState||t.startState(e,n)}function Zt(t,e,n,r){var i=[t.state.modeGen],o={};oe(t,e.text,t.doc.mode,n,function(t,e){return i.push(t,e)},o,r);for(var a=function(n){var r=t.state.overlays[n],a=1,s=0;oe(t,e.text,r.mode,!0,function(t,e){for(var n=a;s<t;){var o=i[a];o>t&&i.splice(a,1,t,i[a+1],o),a+=2,s=Math.min(t,o)}if(e)if(r.opaque)i.splice(n,a-n,t,"overlay "+e),a=n+2;else for(;n<a;n+=2){var l=i[n+1];i[n+1]=(l?l+" ":"")+"overlay "+e}},o)},s=0;s<t.state.overlays.length;++s)a(s);return{styles:i,classes:o.bgClass||o.textClass?o:null}}function Qt(t,e,n){if(!e.styles||e.styles[0]!=t.state.modeGen){var r=Jt(t,T(e)),i=Zt(t,e,e.text.length>t.options.maxHighlightLength?Xt(t.doc.mode,r):r);
e.stateAfter=r,e.styles=i.styles,i.classes?e.styleClasses=i.classes:e.styleClasses&&(e.styleClasses=null),n===t.doc.frontier&&t.doc.frontier++}return e.styles}function Jt(t,e,n){var r=t.doc,i=t.display;if(!r.mode.startState)return!0;var o=ae(t,e,n),a=o>r.first&&S(r,o-1).stateAfter;return a=a?Xt(r.mode,a):Kt(r.mode),r.iter(o,e,function(n){te(t,n.text,a);var s=o==e-1||o%5==0||o>=i.viewFrom&&o<i.viewTo;n.stateAfter=s?Xt(r.mode,a):null,++o}),n&&(r.frontier=o),a}function te(t,e,n,r){var i=t.doc.mode,o=new Ba(e,t.options.tabSize);for(o.start=o.pos=r||0,""==e&&ee(i,n);!o.eol();)ne(i,o,n),o.start=o.pos}function ee(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var n=Yt(t,e);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function ne(t,e,n,r){for(var i=0;i<10;i++){r&&(r[0]=Yt(t,n).mode);var o=t.token(e,n);if(e.pos>e.start)return o}throw new Error("Mode "+t.name+" failed to advance stream.")}function re(t,e,n,r){var i,o=function(t){return{start:d.start,end:d.pos,string:d.current(),type:i||null,state:t?Xt(a.mode,c):c}},a=t.doc,s=a.mode;e=B(a,e);var l,u=S(a,e.line),c=Jt(t,e.line,n),d=new Ba(u.text,t.options.tabSize);for(r&&(l=[]);(r||d.pos<e.ch)&&!d.eol();)d.start=d.pos,i=ne(s,d,c),r&&l.push(o(!0));return r?l:o()}function ie(t,e){if(t)for(;;){var n=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;t=t.slice(0,n.index)+t.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==e[r]?e[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(e[r])||(e[r]+=" "+n[2])}return t}function oe(t,e,n,r,i,o,a){var s=n.flattenSpans;null==s&&(s=t.options.flattenSpans);var l,u=0,c=null,d=new Ba(e,t.options.tabSize),h=t.options.addModeClass&&[null];for(""==e&&ie(ee(n,r),o);!d.eol();){if(d.pos>t.options.maxHighlightLength?(s=!1,a&&te(t,e,r,d.pos),d.pos=e.length,l=null):l=ie(ne(n,d,r,h),o),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!s||c!=l){for(;u<d.start;)u=Math.min(d.start,u+5e3),i(u,c);c=l}d.start=d.pos}for(;u<d.pos;){var f=Math.min(d.pos,u+5e3);i(f,c),u=f}}function ae(t,e,n){for(var r,i,o=t.doc,a=n?-1:e-(t.doc.mode.innerMode?1e3:100),s=e;s>a;--s){if(s<=o.first)return o.first;var l=S(o,s-1);if(l.stateAfter&&(!n||s<=o.frontier))return s;var u=c(l.text,null,t.options.tabSize);(null==i||r>u)&&(i=s-1,r=u)}return i}function se(t,e,n,r){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),et(t),nt(t,n);var i=r?r(t):1;i!=t.height&&E(t,i)}function le(t){t.parent=null,et(t)}function ue(t,e){if(!t||/^\s*$/.test(t))return null;var n=e.addModeClass?$a:Va;return n[t]||(n[t]=t.replace(/\S+/g,"cm-$&"))}function ce(t,e){var n=r("span",null,null,Qo?"padding-right: .1px":null),i={pre:r("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:(Ko||Qo)&&t.getOption("lineWrapping")};n.setAttribute("role","presentation"),i.pre.setAttribute("role","presentation"),e.measure={};for(var o=0;o<=(e.rest?e.rest.length:0);o++){var a=o?e.rest[o-1]:e.line,l=void 0;i.pos=0,i.addToken=he,Bt(t.display.measure)&&(l=wt(a))&&(i.addToken=fe(i.addToken,l)),i.map=[];var u=e!=t.display.externalMeasured&&T(a);ve(a,i,Qt(t,a,u)),a.styleClasses&&(a.styleClasses.bgClass&&(i.bgClass=s(a.styleClasses.bgClass,i.bgClass||"")),a.styleClasses.textClass&&(i.textClass=s(a.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Rt(t.display.measure))),0==o?(e.measure.map=i.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(i.map),(e.measure.caches||(e.measure.caches=[])).push({}))}if(Qo){var c=i.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return Et(t,"renderLine",t,e.line,i.pre),i.pre.className&&(i.textClass=s(i.pre.className,i.textClass||"")),i}function de(t){var e=r("span","","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function he(t,e,n,i,o,a,s){if(e){var l,u=t.splitSpaces?pe(e,t.trailingSpace):e,c=t.cm.state.specialChars,d=!1;if(c.test(e)){l=document.createDocumentFragment();for(var h=0;;){c.lastIndex=h;var f=c.exec(e),g=f?f.index-h:e.length-h;if(g){var v=document.createTextNode(u.slice(h,h+g));Ko&&Zo<9?l.appendChild(r("span",[v])):l.appendChild(v),t.map.push(t.pos,t.pos+g,v),t.col+=g,t.pos+=g}if(!f)break;h+=g+1;var m=void 0;if("\t"==f[0]){var y=t.cm.options.tabSize,b=y-t.col%y;m=l.appendChild(r("span",p(b),"cm-tab")),m.setAttribute("role","presentation"),m.setAttribute("cm-text","\t"),t.col+=b}else"\r"==f[0]||"\n"==f[0]?(m=l.appendChild(r("span","\r"==f[0]?"":"","cm-invalidchar")),m.setAttribute("cm-text",f[0]),t.col+=1):(m=t.cm.options.specialCharPlaceholder(f[0]),m.setAttribute("cm-text",f[0]),Ko&&Zo<9?l.appendChild(r("span",[m])):l.appendChild(m),t.col+=1);t.map.push(t.pos,t.pos+1,m),t.pos++}}else t.col+=e.length,l=document.createTextNode(u),t.map.push(t.pos,t.pos+e.length,l),Ko&&Zo<9&&(d=!0),t.pos+=e.length;if(t.trailingSpace=32==u.charCodeAt(e.length-1),n||i||o||d||s){var x=n||"";i&&(x+=i),o&&(x+=o);var _=r("span",[l],x,s);return a&&(_.title=a),t.content.appendChild(_)}t.content.appendChild(l)}}function pe(t,e){if(t.length>1&&!/  /.test(t))return t;for(var n=e,r="",i=0;i<t.length;i++){var o=t.charAt(i);" "!=o||!n||i!=t.length-1&&32!=t.charCodeAt(i+1)||(o=""),r+=o,n=" "==o}return r}function fe(t,e){return function(n,r,i,o,a,s,l){i=i?i+" cm-force-border":"cm-force-border";for(var u=n.pos,c=u+r.length;;){for(var d=void 0,h=0;h<e.length&&(d=e[h],!(d.to>u&&d.from<=u));h++);if(d.to>=c)return t(n,r,i,o,a,s,l);t(n,r.slice(0,d.to-u),i,o,null,s,l),o=null,r=r.slice(d.to-u),u=d.to}}}function ge(t,e,n,r){var i=!r&&n.widgetNode;i&&t.map.push(t.pos,t.pos+e,i),!r&&t.cm.display.input.needsContentAttribute&&(i||(i=t.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(t.cm.display.input.setUneditable(i),t.content.appendChild(i)),t.pos+=e,t.trailingSpace=!1}function ve(t,e,n){var r=t.markedSpans,i=t.text,o=0;if(r)for(var a,s,l,u,c,d,h,p=i.length,f=0,g=1,v="",m=0;;){if(m==f){l=u=c=d=s="",h=null,m=1/0;for(var y=[],b=void 0,x=0;x<r.length;++x){var _=r[x],w=_.marker;"bookmark"==w.type&&_.from==f&&w.widgetNode?y.push(w):_.from<=f&&(null==_.to||_.to>f||w.collapsed&&_.to==f&&_.from==f)?(null!=_.to&&_.to!=f&&m>_.to&&(m=_.to,u=""),w.className&&(l+=" "+w.className),w.css&&(s=(s?s+";":"")+w.css),w.startStyle&&_.from==f&&(c+=" "+w.startStyle),w.endStyle&&_.to==m&&(b||(b=[])).push(w.endStyle,_.to),w.title&&!d&&(d=w.title),w.collapsed&&(!h||ot(h.marker,w)<0)&&(h=_)):_.from>f&&m>_.from&&(m=_.from)}if(b)for(var k=0;k<b.length;k+=2)b[k+1]==m&&(u+=" "+b[k]);if(!h||h.from==f)for(var M=0;M<y.length;++M)ge(e,0,y[M]);if(h&&(h.from||0)==f){if(ge(e,(null==h.to?p+1:h.to)-f,h.marker,null==h.from),null==h.to)return;h.to==f&&(h=!1)}}if(f>=p)break;for(var C=Math.min(p,m);;){if(v){var S=f+v.length;if(!h){var L=S>C?v.slice(0,C-f):v;e.addToken(e,L,a?a+l:l,c,f+L.length==m?u:"",d,s)}if(S>=C){v=v.slice(C-f),f=C;break}f=S,c=""}v=i.slice(o,o=n[g++]),a=ue(n[g++],e.cm.options)}}else for(var A=1;A<n.length;A+=2)e.addToken(e,i.slice(o,o=n[A]),ue(n[A+1],e.cm.options))}function me(t,e,n){this.line=e,this.rest=ht(e),this.size=this.rest?T(f(this.rest))-n+1:1,this.node=this.text=null,this.hidden=gt(t,e)}function ye(t,e,n){for(var r,i=[],o=e;o<n;o=r){var a=new me(t.doc,S(t.doc,o),o);r=o+a.size,i.push(a)}return i}function be(t){qa?qa.ops.push(t):t.ownsGroup=qa={ops:[t],delayedCallbacks:[]}}function xe(t){var e=t.delayedCallbacks,n=0;do{for(;n<e.length;n++)e[n].call(null);for(var r=0;r<t.ops.length;r++){var i=t.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<e.length)}function _e(t,e){var n=t.ownsGroup;if(n)try{xe(n)}finally{qa=null,e(n)}}function we(t,e){var n=Lt(t,e);if(n.length){var r,i=Array.prototype.slice.call(arguments,2);qa?r=qa.delayedCallbacks:Ua?r=Ua:(r=Ua=[],setTimeout(ke,0));for(var o=function(t){r.push(function(){return n[t].apply(null,i)})},a=0;a<n.length;++a)o(a)}}function ke(){var t=Ua;Ua=null;for(var e=0;e<t.length;++e)t[e]()}function Me(t,e,n,r){for(var i=0;i<e.changes.length;i++){var o=e.changes[i];"text"==o?Ae(t,e):"gutter"==o?Te(t,e,n,r):"class"==o?Ee(e):"widget"==o&&Pe(t,e,r)}e.changes=null}function Ce(t){return t.node==t.text&&(t.node=r("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),Ko&&Zo<8&&(t.node.style.zIndex=2)),t.node}function Se(t){var e=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(e&&(e+=" CodeMirror-linebackground"),t.background)e?t.background.className=e:(t.background.parentNode.removeChild(t.background),t.background=null);else if(e){var n=Ce(t);t.background=n.insertBefore(r("div",null,e),n.firstChild)}}function Le(t,e){var n=t.display.externalMeasured;return n&&n.line==e.line?(t.display.externalMeasured=null,e.measure=n.measure,n.built):ce(t,e)}function Ae(t,e){var n=e.text.className,r=Le(t,e);e.text==e.node&&(e.node=r.pre),e.text.parentNode.replaceChild(r.pre,e.text),e.text=r.pre,r.bgClass!=e.bgClass||r.textClass!=e.textClass?(e.bgClass=r.bgClass,e.textClass=r.textClass,Ee(e)):n&&(e.text.className=n)}function Ee(t){Se(t),t.line.wrapClass?Ce(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var e=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=e||""}function Te(t,e,n,i){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var o=Ce(e);e.gutterBackground=r("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),o.insertBefore(e.gutterBackground,e.text)}var a=e.line.gutterMarkers;if(t.options.lineNumbers||a){var s=Ce(e),l=e.gutter=r("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(t.display.input.setUneditable(l),s.insertBefore(l,e.text),e.line.gutterClass&&(l.className+=" "+e.line.gutterClass),!t.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(e.lineNumber=l.appendChild(r("div",O(t.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),a)for(var u=0;u<t.options.gutters.length;++u){var c=t.options.gutters[u],d=a.hasOwnProperty(c)&&a[c];d&&l.appendChild(r("div",[d],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function Pe(t,e,n){e.alignable&&(e.alignable=null);for(var r=e.node.firstChild,i=void 0;r;r=i)i=r.nextSibling,"CodeMirror-linewidget"==r.className&&e.node.removeChild(r);Oe(t,e,n)}function De(t,e,n,r){var i=Le(t,e);return e.text=e.node=i.pre,i.bgClass&&(e.bgClass=i.bgClass),i.textClass&&(e.textClass=i.textClass),Ee(e),Te(t,e,n,r),Oe(t,e,r),e.node}function Oe(t,e,n){if(Ne(t,e.line,e,n,!0),e.rest)for(var r=0;r<e.rest.length;r++)Ne(t,e.rest[r],e,n,!1)}function Ne(t,e,n,i,o){if(e.widgets)for(var a=Ce(n),s=0,l=e.widgets;s<l.length;++s){var u=l[s],c=r("div",[u.node],"CodeMirror-linewidget");u.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),Ie(u,c,n,i),t.display.input.setUneditable(c),o&&u.above?a.insertBefore(c,n.gutter||n.text):a.appendChild(c),we(u,"redraw")}}function Ie(t,e,n,r){if(t.noHScroll){(n.alignable||(n.alignable=[])).push(e);var i=r.wrapperWidth;e.style.left=r.fixedPos+"px",t.coverGutter||(i-=r.gutterTotalWidth,e.style.paddingLeft=r.gutterTotalWidth+"px"),e.style.width=i+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-r.gutterTotalWidth+"px"))}function ze(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!i(document.body,t.node)){var o="position: relative;";t.coverGutter&&(o+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(o+="width: "+e.display.wrapper.clientWidth+"px;"),n(e.display.measure,r("div",[t.node],null,o))}return t.height=t.node.parentNode.offsetHeight}function Ge(t,e){for(var n=Wt(e);n!=t.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==t.sizer&&n!=t.mover)return!0}function We(t){return t.lineSpace.offsetTop}function Fe(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function Re(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=n(t.measure,r("pre","x")),i=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,o={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(o.left)||isNaN(o.right)||(t.cachedPaddingH=o),o}function Be(t){return ba-t.display.nativeBarWidth}function He(t){return t.display.scroller.clientWidth-Be(t)-t.display.barWidth}function je(t){return t.display.scroller.clientHeight-Be(t)-t.display.barHeight}function Ve(t,e,n){var r=t.options.lineWrapping,i=r&&He(t);if(!e.measure.heights||r&&e.measure.width!=i){var o=e.measure.heights=[];if(r){e.measure.width=i;for(var a=e.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],u=a[s+1];Math.abs(l.bottom-u.bottom)>2&&o.push((l.bottom+u.top)/2-n.top)}}o.push(n.bottom-n.top)}}function $e(t,e,n){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var r=0;r<t.rest.length;r++)if(t.rest[r]==e)return{map:t.measure.maps[r],cache:t.measure.caches[r]};for(var i=0;i<t.rest.length;i++)if(T(t.rest[i])>n)return{map:t.measure.maps[i],cache:t.measure.caches[i],before:!0}}function qe(t,e){e=ct(e);var r=T(e),i=t.display.externalMeasured=new me(t.doc,e,r);i.lineN=r;var o=i.built=ce(t,i);return i.text=o.pre,n(t.display.lineMeasure,o.pre),i}function Ue(t,e,n,r){return Ke(t,Ye(t,e),n,r)}function Xe(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[Mn(t,e)];var n=t.display.externalMeasured;return n&&e>=n.lineN&&e<n.lineN+n.size?n:void 0}function Ye(t,e){var n=T(e),r=Xe(t,n);r&&!r.text?r=null:r&&r.changes&&(Me(t,r,n,bn(t)),t.curOp.forceUpdate=!0),r||(r=qe(t,e));var i=$e(r,e,n);return{line:e,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Ke(t,e,n,r,i){e.before&&(n=-1);var o,a=n+(r||"");return e.cache.hasOwnProperty(a)?o=e.cache[a]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(Ve(t,e.view,e.rect),e.hasHeights=!0),o=Je(t,e,n,r),o.bogus||(e.cache[a]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function Ze(t,e,n){for(var r,i,o,a,s,l,u=0;u<t.length;u+=3)if(s=t[u],l=t[u+1],e<s?(i=0,o=1,a="left"):e<l?(i=e-s,o=i+1):(u==t.length-3||e==l&&t[u+3]>e)&&(o=l-s,i=o-1,e>=l&&(a="right")),null!=i){if(r=t[u+2],s==l&&n==(r.insertLeft?"left":"right")&&(a=n),"left"==n&&0==i)for(;u&&t[u-2]==t[u-3]&&t[u-1].insertLeft;)r=t[(u-=3)+2],a="left";if("right"==n&&i==l-s)for(;u<t.length-3&&t[u+3]==t[u+4]&&!t[u+5].insertLeft;)r=t[(u+=3)+2],a="right";break}return{node:r,start:i,end:o,collapse:a,coverStart:s,coverEnd:l}}function Qe(t,e){var n=Xa;if("left"==e)for(var r=0;r<t.length&&(n=t[r]).left==n.right;r++);else for(var i=t.length-1;i>=0&&(n=t[i]).left==n.right;i--);return n}function Je(t,e,n,r){var i,o=Ze(e.map,n,r),a=o.node,s=o.start,l=o.end,u=o.collapse;if(3==a.nodeType){for(var c=0;c<4;c++){for(;s&&w(e.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+l<o.coverEnd&&w(e.line.text.charAt(o.coverStart+l));)++l;if(i=Ko&&Zo<9&&0==s&&l==o.coverEnd-o.coverStart?a.parentNode.getBoundingClientRect():Qe(da(a,s,l).getClientRects(),r),i.left||i.right||0==s)break;l=s,s-=1,u="right"}Ko&&Zo<11&&(i=tn(t.display.measure,i))}else{s>0&&(u=r="right");var d;i=t.options.lineWrapping&&(d=a.getClientRects()).length>1?d["right"==r?d.length-1:0]:a.getBoundingClientRect()}if(Ko&&Zo<9&&!s&&(!i||!i.left&&!i.right)){var h=a.parentNode.getClientRects()[0];i=h?{left:h.left,right:h.left+yn(t.display),top:h.top,bottom:h.bottom}:Xa}for(var p=i.top-e.rect.top,f=i.bottom-e.rect.top,g=(p+f)/2,v=e.view.measure.heights,m=0;m<v.length-1&&!(g<v[m]);m++);var y=m?v[m-1]:0,b=v[m],x={left:("right"==u?i.right:i.left)-e.rect.left,right:("left"==u?i.left:i.right)-e.rect.left,top:y,bottom:b};return i.left||i.right||(x.bogus=!0),t.options.singleCursorHeightPerLine||(x.rtop=p,x.rbottom=f),x}function tn(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Ht(t))return e;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*n,right:e.right*n,top:e.top*r,bottom:e.bottom*r}}function en(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function nn(t){t.display.externalMeasure=null,e(t.display.lineMeasure);for(var n=0;n<t.display.view.length;n++)en(t.display.view[n])}function rn(t){nn(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function on(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function an(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function sn(t,e,n,r,i){if(!i&&e.widgets)for(var o=0;o<e.widgets.length;++o)if(e.widgets[o].above){var a=ze(e.widgets[o]);n.top+=a,n.bottom+=a}if("line"==r)return n;r||(r="local");var s=mt(e);if("local"==r?s+=We(t.display):s-=t.display.viewOffset,"page"==r||"window"==r){var l=t.display.lineSpace.getBoundingClientRect();s+=l.top+("window"==r?0:an());var u=l.left+("window"==r?0:on());n.left+=u,n.right+=u}return n.top+=s,n.bottom+=s,n}function ln(t,e,n){if("div"==n)return e;var r=e.left,i=e.top;if("page"==n)r-=on(),i-=an();else if("local"==n||!n){var o=t.display.sizer.getBoundingClientRect();r+=o.left,i+=o.top}var a=t.display.lineSpace.getBoundingClientRect();return{left:r-a.left,top:i-a.top}}function un(t,e,n,r,i){return r||(r=S(t.doc,e.line)),sn(t,r,Ue(t,r,e.ch,i),n)}function cn(t,e,n,r,i,o){function a(e,a){var s=Ke(t,i,e,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,sn(t,r,s,n)}function s(t,e,n){var r=l[e],i=r.level%2!=0;return a(n?t-1:t,i!=n)}r=r||S(t.doc,e.line),i||(i=Ye(t,r));var l=wt(r),u=e.ch,c=e.sticky;if(u>=r.text.length?(u=r.text.length,c="before"):u<=0&&(u=0,c="after"),!l)return a("before"==c?u-1:u,"before"==c);var d=_t(l,u,c),h=Ea,p=s(u,d,"before"==c);return null!=h&&(p.other=s(u,h,"before"!=c)),p}function dn(t,e){var n=0;e=B(t.doc,e),t.options.lineWrapping||(n=yn(t.display)*e.ch);var r=S(t.doc,e.line),i=mt(r)+We(t.display);return{left:n,right:n,top:i,bottom:i+r.height}}function hn(t,e,n,r,i){var o=N(t,e,n);return o.xRel=i,r&&(o.outside=!0),o}function pn(t,e,n){var r=t.doc;if(n+=t.display.viewOffset,n<0)return hn(r.first,0,null,!0,-1);var i=P(r,n),o=r.first+r.size-1;if(i>o)return hn(r.first+r.size-1,S(r,o).text.length,null,!0,1);e<0&&(e=0);for(var a=S(r,i);;){var s=vn(t,a,i,e,n),l=lt(a),u=l&&l.find(0,!0);if(!l||!(s.ch>u.from.ch||s.ch==u.from.ch&&s.xRel>0))return s;i=T(a=u.to.line)}}function fn(t,e,n,r){var i=function(r){return sn(t,e,Ke(t,n,r),"line")},o=e.text.length,a=M(function(t){return i(t-1).bottom<=r},o,0);return o=M(function(t){return i(t).top>r},a,o),{begin:a,end:o}}function gn(t,e,n,r){var i=sn(t,e,Ke(t,n,r),"line").top;return fn(t,e,n,i)}function vn(t,e,n,r,i){i-=mt(e);var o,a=0,s=e.text.length,l=Ye(t,e),u=wt(e);if(u){if(t.options.lineWrapping){var c;c=fn(t,e,l,i),a=c.begin,s=c.end,c}o=new N(n,a);var d,h,p=cn(t,o,"line",e,l).left,f=p<r?1:-1,g=p-r;do{if(d=g,h=o,o=St(t,e,o,f),null==o||o.ch<a||s<=("before"==o.sticky?o.ch-1:o.ch)){o=h;break}g=cn(t,o,"line",e,l).left-r}while(f<0!=g<0&&Math.abs(g)<=Math.abs(d));if(Math.abs(g)>Math.abs(d)){if(g<0==d<0)throw new Error("Broke out of infinite loop in coordsCharInner");o=h}}else{var v=M(function(n){var o=sn(t,e,Ke(t,l,n),"line");return o.top>i?(s=Math.min(n,s),!0):!(o.bottom<=i)&&(o.left>r||!(o.right<r)&&r-o.left<o.right-r)},a,s);v=k(e.text,v,1),o=new N(n,v,v==s?"before":"after")}var m=cn(t,o,"line",e,l);return(i<m.top||m.bottom<i)&&(o.outside=!0),o.xRel=r<m.left?-1:r>m.right?1:0,o}function mn(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==ja){ja=r("pre");for(var i=0;i<49;++i)ja.appendChild(document.createTextNode("x")),ja.appendChild(r("br"));ja.appendChild(document.createTextNode("x"))}n(t.measure,ja);var o=ja.offsetHeight/50;return o>3&&(t.cachedTextHeight=o),e(t.measure),o||1}function yn(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=r("span","xxxxxxxxxx"),i=r("pre",[e]);n(t.measure,i);var o=e.getBoundingClientRect(),a=(o.right-o.left)/10;return a>2&&(t.cachedCharWidth=a),a||10}function bn(t){for(var e=t.display,n={},r={},i=e.gutters.clientLeft,o=e.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[t.options.gutters[a]]=o.offsetLeft+o.clientLeft+i,r[t.options.gutters[a]]=o.clientWidth;return{fixedPos:xn(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:e.wrapper.clientWidth}}function xn(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function _n(t){var e=mn(t.display),n=t.options.lineWrapping,r=n&&Math.max(5,t.display.scroller.clientWidth/yn(t.display)-3);return function(i){if(gt(t.doc,i))return 0;var o=0;if(i.widgets)for(var a=0;a<i.widgets.length;a++)i.widgets[a].height&&(o+=i.widgets[a].height);return n?o+(Math.ceil(i.text.length/r)||1)*e:o+e}}function wn(t){var e=t.doc,n=_n(t);e.iter(function(t){var e=n(t);e!=t.height&&E(t,e)})}function kn(t,e,n,r){var i=t.display;if(!n&&"true"==Wt(e).getAttribute("cm-not-content"))return null;var o,a,s=i.lineSpace.getBoundingClientRect();try{o=e.clientX-s.left,a=e.clientY-s.top}catch(t){return null}var l,u=pn(t,o,a);if(r&&1==u.xRel&&(l=S(t.doc,u.line).text).length==u.ch){var d=c(l,l.length,t.options.tabSize)-l.length;u=N(u.line,Math.max(0,Math.round((o-Re(t.display).left)/yn(t.display))-d))}return u}function Mn(t,e){if(e>=t.display.viewTo)return null;if(e-=t.display.viewFrom,e<0)return null;for(var n=t.display.view,r=0;r<n.length;r++)if(e-=n[r].size,e<0)return r}function Cn(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Sn(t,e){for(var n=t.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(e!==!1||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=t.display.viewTo||s.to().line<t.display.viewFrom)){var l=s.empty();(l||t.options.showCursorWhenSelecting)&&Ln(t,s.head,i),l||An(t,s,o)}}return r}function Ln(t,e,n){var i=cn(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),o=n.appendChild(r("div","","CodeMirror-cursor"));if(o.style.left=i.left+"px",o.style.top=i.top+"px",o.style.height=Math.max(0,i.bottom-i.top)*t.options.cursorHeight+"px",i.other){var a=n.appendChild(r("div","","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=i.other.left+"px",a.style.top=i.other.top+"px",a.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function An(t,e,n){function i(t,e,n,i){e<0&&(e=0),e=Math.round(e),i=Math.round(i),l.appendChild(r("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+e+"px; width: "+(null==n?d-t:n)+"px;\n                             height: "+(i-e)+"px"))}function o(e,n,r){function o(n,r){return un(t,N(e,n),"div",u,r)}var a,l,u=S(s,e),h=u.text.length;return xt(wt(u),n||0,null==r?h:r,function(t,e,s){var u,p,f,g=o(t,"left");if(t==e)u=g,p=f=g.left;else{if(u=o(e-1,"right"),"rtl"==s){var v=g;g=u,u=v}p=g.left,f=u.right}null==n&&0==t&&(p=c),u.top-g.top>3&&(i(p,g.top,null,g.bottom),p=c,g.bottom<u.top&&i(p,g.bottom,null,u.top)),null==r&&e==h&&(f=d),(!a||g.top<a.top||g.top==a.top&&g.left<a.left)&&(a=g),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),p<c+1&&(p=c),i(p,u.top,f-p,u.bottom)}),{start:a,end:l}}var a=t.display,s=t.doc,l=document.createDocumentFragment(),u=Re(t.display),c=u.left,d=Math.max(a.sizerWidth,He(t)-a.sizer.offsetLeft)-u.right,h=e.from(),p=e.to();if(h.line==p.line)o(h.line,h.ch,p.ch);else{var f=S(s,h.line),g=S(s,p.line),v=ct(f)==ct(g),m=o(h.line,h.ch,v?f.text.length+1:null).end,y=o(p.line,v?0:null,p.ch).start;v&&(m.top<y.top-2?(i(m.right,m.top,null,m.bottom),i(c,y.top,y.left,y.bottom)):i(m.right,m.top,y.left-m.right,m.bottom)),m.bottom<y.top&&i(c,m.bottom,null,y.top)}n.appendChild(l)}function En(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var n=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){return e.cursorDiv.style.visibility=(n=!n)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function Tn(t){t.state.focused||(t.display.input.focus(),Dn(t))}function Pn(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,On(t))},100)}function Dn(t,e){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(Et(t,"focus",t,e),t.state.focused=!0,a(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),Qo&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),En(t))}function On(t,e){t.state.delayingBlurEvent||(t.state.focused&&(Et(t,"blur",t,e),t.state.focused=!1,fa(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function Nn(t){var e=t.display,n=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var r=xn(e)-e.scroller.scrollLeft+t.doc.scrollLeft,i=e.gutters.offsetWidth,o=r+"px",a=0;a<n.length;a++)if(!n[a].hidden){t.options.fixedGutter&&(n[a].gutter&&(n[a].gutter.style.left=o),n[a].gutterBackground&&(n[a].gutterBackground.style.left=o));var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}t.options.fixedGutter&&(e.gutters.style.left=r+i+"px")}}function In(t){if(!t.options.lineNumbers)return!1;var e=t.doc,n=O(t.options,e.first+e.size-1),i=t.display;if(n.length!=i.lineNumChars){var o=i.measure.appendChild(r("div",[r("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=o.firstChild.offsetWidth,s=o.offsetWidth-a;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(a,i.lineGutter.offsetWidth-s)+1,i.lineNumWidth=i.lineNumInnerWidth+s,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",Sr(t),!0}return!1}function zn(t){for(var e=t.display,n=e.lineDiv.offsetTop,r=0;r<e.view.length;r++){var i=e.view[r],o=void 0;if(!i.hidden){if(Ko&&Zo<8){var a=i.node.offsetTop+i.node.offsetHeight;o=a-n,n=a}else{var s=i.node.getBoundingClientRect();o=s.bottom-s.top}var l=i.line.height-o;if(o<2&&(o=mn(e)),(l>.001||l<-.001)&&(E(i.line,o),Gn(i.line),i.rest))for(var u=0;u<i.rest.length;u++)Gn(i.rest[u])}}}function Gn(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e)t.widgets[e].height=t.widgets[e].node.parentNode.offsetHeight}function Wn(t,e,n){var r=n&&null!=n.top?Math.max(0,n.top):t.scroller.scrollTop;r=Math.floor(r-We(t));var i=n&&null!=n.bottom?n.bottom:r+t.wrapper.clientHeight,o=P(e,r),a=P(e,i);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;s<o?(o=s,a=P(e,mt(S(e,s))+t.wrapper.clientHeight)):Math.min(l,e.lastLine())>=a&&(o=P(e,mt(S(e,l))-t.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function Fn(t,e){Math.abs(t.doc.scrollTop-e)<2||(t.doc.scrollTop=e,qo||Mr(t,{top:e}),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbars.setScrollTop(e),qo&&Mr(t),br(t,100))}function Rn(t,e,n){(n?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)||(e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),t.doc.scrollLeft=e,Nn(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function Bn(t){var e=t.wheelDeltaX,n=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==n&&t.detail&&t.axis==t.VERTICAL_AXIS?n=t.detail:null==n&&(n=t.wheelDelta),{x:e,y:n}}function Hn(t){var e=Bn(t);return e.x*=Ka,e.y*=Ka,e}function jn(t,e){var n=Bn(e),r=n.x,i=n.y,o=t.display,a=o.scroller,s=a.scrollWidth>a.clientWidth,l=a.scrollHeight>a.clientHeight;if(r&&s||i&&l){if(i&&sa&&Qo)t:for(var u=e.target,c=o.view;u!=a;u=u.parentNode)for(var d=0;d<c.length;d++)if(c[d].node==u){t.display.currentWheelTarget=u;break t}if(r&&!qo&&!ea&&null!=Ka)return i&&l&&Fn(t,Math.max(0,Math.min(a.scrollTop+i*Ka,a.scrollHeight-a.clientHeight))),Rn(t,Math.max(0,Math.min(a.scrollLeft+r*Ka,a.scrollWidth-a.clientWidth))),(!i||i&&l)&&Nt(e),void(o.wheelStartX=null);if(i&&null!=Ka){var h=i*Ka,p=t.doc.scrollTop,f=p+o.wrapper.clientHeight;h<0?p=Math.max(0,p+h-50):f=Math.min(t.doc.height,f+h+50),Mr(t,{top:p,bottom:f})}Ya<20&&(null==o.wheelStartX?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=r,o.wheelDY=i,setTimeout(function(){if(null!=o.wheelStartX){var t=a.scrollLeft-o.wheelStartX,e=a.scrollTop-o.wheelStartY,n=e&&o.wheelDY&&e/o.wheelDY||t&&o.wheelDX&&t/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(Ka=(Ka*Ya+n)/(Ya+1),++Ya)}},200)):(o.wheelDX+=r,o.wheelDY+=i))}}function Vn(t){var e=t.display,n=e.gutters.offsetWidth,r=Math.round(t.doc.height+Fe(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Be(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:n}}function $n(t,e){e||(e=Vn(t));var n=t.display.barWidth,r=t.display.barHeight;qn(t,e);for(var i=0;i<4&&n!=t.display.barWidth||r!=t.display.barHeight;i++)n!=t.display.barWidth&&t.options.lineWrapping&&zn(t),qn(t,Vn(t)),n=t.display.barWidth,r=t.display.barHeight}function qn(t,e){var n=t.display,r=n.scrollbars.update(e);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=e.gutterWidth+"px"):n.gutterFiller.style.display=""}function Un(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&fa(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new Ja[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Da(e,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,n){"horizontal"==n?Rn(t,e):Fn(t,e)},t),t.display.scrollbars.addClass&&a(t.display.wrapper,t.display.scrollbars.addClass)}function Xn(t,e){if(!Tt(t,"scrollCursorIntoView")){var n=t.display,i=n.sizer.getBoundingClientRect(),o=null;if(e.top+i.top<0?o=!0:e.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null!=o&&!ia){var a=r("div","",null,"position: absolute;\n                         top: "+(e.top-n.viewOffset-We(t.display))+"px;\n                         height: "+(e.bottom-e.top+Be(t)+n.barHeight)+"px;\n                         left: "+e.left+"px; width: 2px;");t.display.lineSpace.appendChild(a),a.scrollIntoView(o),t.display.lineSpace.removeChild(a)}}}function Yn(t,e,n,r){null==r&&(r=0);for(var i,o=0;o<5;o++){var a=!1;i=cn(t,e);var s=n&&n!=e?cn(t,n):i,l=Zn(t,Math.min(i.left,s.left),Math.min(i.top,s.top)-r,Math.max(i.left,s.left),Math.max(i.bottom,s.bottom)+r),u=t.doc.scrollTop,c=t.doc.scrollLeft;if(null!=l.scrollTop&&(Fn(t,l.scrollTop),Math.abs(t.doc.scrollTop-u)>1&&(a=!0)),null!=l.scrollLeft&&(Rn(t,l.scrollLeft),
Math.abs(t.doc.scrollLeft-c)>1&&(a=!0)),!a)break}return i}function Kn(t,e,n,r,i){var o=Zn(t,e,n,r,i);null!=o.scrollTop&&Fn(t,o.scrollTop),null!=o.scrollLeft&&Rn(t,o.scrollLeft)}function Zn(t,e,n,r,i){var o=t.display,a=mn(t.display);n<0&&(n=0);var s=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:o.scroller.scrollTop,l=je(t),u={};i-n>l&&(i=n+l);var c=t.doc.height+Fe(o),d=n<a,h=i>c-a;if(n<s)u.scrollTop=d?0:n;else if(i>s+l){var p=Math.min(n,(h?c:i)-l);p!=s&&(u.scrollTop=p)}var f=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:o.scroller.scrollLeft,g=He(t)-(t.options.fixedGutter?o.gutters.offsetWidth:0),v=r-e>g;return v&&(r=e+g),e<10?u.scrollLeft=0:e<f?u.scrollLeft=Math.max(0,e-(v?0:10)):r>g+f-3&&(u.scrollLeft=r+(v?0:10)-g),u}function Qn(t,e,n){null==e&&null==n||tr(t),null!=e&&(t.curOp.scrollLeft=(null==t.curOp.scrollLeft?t.doc.scrollLeft:t.curOp.scrollLeft)+e),null!=n&&(t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+n)}function Jn(t){tr(t);var e=t.getCursor(),n=e,r=e;t.options.lineWrapping||(n=e.ch?N(e.line,e.ch-1):e,r=N(e.line,e.ch+1)),t.curOp.scrollToPos={from:n,to:r,margin:t.options.cursorScrollMargin,isCursor:!0}}function tr(t){var e=t.curOp.scrollToPos;if(e){t.curOp.scrollToPos=null;var n=dn(t,e.from),r=dn(t,e.to),i=Zn(t,Math.min(n.left,r.left),Math.min(n.top,r.top)-e.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+e.margin);t.scrollTo(i.scrollLeft,i.scrollTop)}}function er(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++ts},be(t.curOp)}function nr(t){var e=t.curOp;_e(e,function(t){for(var e=0;e<t.ops.length;e++)t.ops[e].cm.curOp=null;rr(t)})}function rr(t){for(var e=t.ops,n=0;n<e.length;n++)ir(e[n]);for(var r=0;r<e.length;r++)or(e[r]);for(var i=0;i<e.length;i++)ar(e[i]);for(var o=0;o<e.length;o++)sr(e[o]);for(var a=0;a<e.length;a++)lr(e[a])}function ir(t){var e=t.cm,n=e.display;_r(e),t.updateMaxLine&&bt(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<n.viewFrom||t.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new es(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function or(t){t.updatedDisplay=t.mustUpdate&&wr(t.cm,t.update)}function ar(t){var e=t.cm,n=e.display;t.updatedDisplay&&zn(e),t.barMeasure=Vn(e),n.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Ue(e,n.maxLine,n.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+t.adjustWidthTo+Be(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+t.adjustWidthTo-He(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=n.input.prepareSelection(t.focus))}function sr(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&Rn(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1);var n=t.focus&&t.focus==o()&&(!document.hasFocus||document.hasFocus());t.preparedSelection&&e.display.input.showSelection(t.preparedSelection,n),(t.updatedDisplay||t.startHeight!=e.doc.height)&&$n(e,t.barMeasure),t.updatedDisplay&&Lr(e,t.barMeasure),t.selectionChanged&&En(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),n&&Tn(t.cm)}function lr(t){var e=t.cm,n=e.display,r=e.doc;if(t.updatedDisplay&&kr(e,t.update),null==n.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==t.scrollTop||n.scroller.scrollTop==t.scrollTop&&!t.forceScroll||(r.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,t.scrollTop)),n.scrollbars.setScrollTop(r.scrollTop),n.scroller.scrollTop=r.scrollTop),null==t.scrollLeft||n.scroller.scrollLeft==t.scrollLeft&&!t.forceScroll||(r.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,t.scrollLeft)),n.scrollbars.setScrollLeft(r.scrollLeft),n.scroller.scrollLeft=r.scrollLeft,Nn(e)),t.scrollToPos){var i=Yn(e,B(r,t.scrollToPos.from),B(r,t.scrollToPos.to),t.scrollToPos.margin);t.scrollToPos.isCursor&&e.state.focused&&Xn(e,i)}var o=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||Et(o[s],"hide");if(a)for(var l=0;l<a.length;++l)a[l].lines.length&&Et(a[l],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&Et(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function ur(t,e){if(t.curOp)return e();er(t);try{return e()}finally{nr(t)}}function cr(t,e){return function(){if(t.curOp)return e.apply(t,arguments);er(t);try{return e.apply(t,arguments)}finally{nr(t)}}}function dr(t){return function(){if(this.curOp)return t.apply(this,arguments);er(this);try{return t.apply(this,arguments)}finally{nr(this)}}}function hr(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);er(e);try{return t.apply(this,arguments)}finally{nr(e)}}}function pr(t,e,n,r){null==e&&(e=t.doc.first),null==n&&(n=t.doc.first+t.doc.size),r||(r=0);var i=t.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>e)&&(i.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=i.viewTo)Aa&&pt(t.doc,e)<i.viewTo&&gr(t);else if(n<=i.viewFrom)Aa&&ft(t.doc,n+r)>i.viewFrom?gr(t):(i.viewFrom+=r,i.viewTo+=r);else if(e<=i.viewFrom&&n>=i.viewTo)gr(t);else if(e<=i.viewFrom){var o=vr(t,n,n+r,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):gr(t)}else if(n>=i.viewTo){var a=vr(t,e,e,-1);a?(i.view=i.view.slice(0,a.index),i.viewTo=a.lineN):gr(t)}else{var s=vr(t,e,e,-1),l=vr(t,n,n+r,1);s&&l?(i.view=i.view.slice(0,s.index).concat(ye(t,s.lineN,l.lineN)).concat(i.view.slice(l.index)),i.viewTo+=r):gr(t)}var u=i.externalMeasured;u&&(n<u.lineN?u.lineN+=r:e<u.lineN+u.size&&(i.externalMeasured=null))}function fr(t,e,n){t.curOp.viewChanged=!0;var r=t.display,i=t.display.externalMeasured;if(i&&e>=i.lineN&&e<i.lineN+i.size&&(r.externalMeasured=null),!(e<r.viewFrom||e>=r.viewTo)){var o=r.view[Mn(t,e)];if(null!=o.node){var a=o.changes||(o.changes=[]);d(a,n)==-1&&a.push(n)}}}function gr(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function vr(t,e,n,r){var i,o=Mn(t,e),a=t.display.view;if(!Aa||n==t.doc.first+t.doc.size)return{index:o,lineN:n};for(var s=t.display.viewFrom,l=0;l<o;l++)s+=a[l].size;if(s!=e){if(r>0){if(o==a.length-1)return null;i=s+a[o].size-e,o++}else i=s-e;e+=i,n+=i}for(;pt(t.doc,n)!=n;){if(o==(r<0?0:a.length-1))return null;n+=r*a[o-(r<0?1:0)].size,o+=r}return{index:o,lineN:n}}function mr(t,e,n){var r=t.display,i=r.view;0==i.length||e>=r.viewTo||n<=r.viewFrom?(r.view=ye(t,e,n),r.viewFrom=e):(r.viewFrom>e?r.view=ye(t,e,r.viewFrom).concat(r.view):r.viewFrom<e&&(r.view=r.view.slice(Mn(t,e))),r.viewFrom=e,r.viewTo<n?r.view=r.view.concat(ye(t,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,Mn(t,n)))),r.viewTo=n}function yr(t){for(var e=t.display.view,n=0,r=0;r<e.length;r++){var i=e[r];i.hidden||i.node&&!i.changes||++n}return n}function br(t,e){t.doc.mode.startState&&t.doc.frontier<t.display.viewTo&&t.state.highlight.set(e,l(xr,t))}function xr(t){var e=t.doc;if(e.frontier<e.first&&(e.frontier=e.first),!(e.frontier>=t.display.viewTo)){var n=+new Date+t.options.workTime,r=Xt(e.mode,Jt(t,e.frontier)),i=[];e.iter(e.frontier,Math.min(e.first+e.size,t.display.viewTo+500),function(o){if(e.frontier>=t.display.viewFrom){var a=o.styles,s=o.text.length>t.options.maxHighlightLength,l=Zt(t,o,s?Xt(e.mode,r):r,!0);o.styles=l.styles;var u=o.styleClasses,c=l.classes;c?o.styleClasses=c:u&&(o.styleClasses=null);for(var d=!a||a.length!=o.styles.length||u!=c&&(!u||!c||u.bgClass!=c.bgClass||u.textClass!=c.textClass),h=0;!d&&h<a.length;++h)d=a[h]!=o.styles[h];d&&i.push(e.frontier),o.stateAfter=s?r:Xt(e.mode,r)}else o.text.length<=t.options.maxHighlightLength&&te(t,o.text,r),o.stateAfter=e.frontier%5==0?Xt(e.mode,r):null;if(++e.frontier,+new Date>n)return br(t,t.options.workDelay),!0}),i.length&&ur(t,function(){for(var e=0;e<i.length;e++)fr(t,i[e],"text")})}}function _r(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Be(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=Be(t)+"px",e.scrollbarsClipped=!0)}function wr(t,n){var r=t.display,i=t.doc;if(n.editorIsHidden)return gr(t),!1;if(!n.force&&n.visible.from>=r.viewFrom&&n.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==yr(t))return!1;In(t)&&(gr(t),n.dims=bn(t));var a=i.first+i.size,s=Math.max(n.visible.from-t.options.viewportMargin,i.first),l=Math.min(a,n.visible.to+t.options.viewportMargin);r.viewFrom<s&&s-r.viewFrom<20&&(s=Math.max(i.first,r.viewFrom)),r.viewTo>l&&r.viewTo-l<20&&(l=Math.min(a,r.viewTo)),Aa&&(s=pt(t.doc,s),l=ft(t.doc,l));var u=s!=r.viewFrom||l!=r.viewTo||r.lastWrapHeight!=n.wrapperHeight||r.lastWrapWidth!=n.wrapperWidth;mr(t,s,l),r.viewOffset=mt(S(t.doc,r.viewFrom)),t.display.mover.style.top=r.viewOffset+"px";var c=yr(t);if(!u&&0==c&&!n.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var d=o();return c>4&&(r.lineDiv.style.display="none"),Cr(t,r.updateLineNumbers,n.dims),c>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,d&&o()!=d&&d.offsetHeight&&d.focus(),e(r.cursorDiv),e(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,u&&(r.lastWrapHeight=n.wrapperHeight,r.lastWrapWidth=n.wrapperWidth,br(t,400)),r.updateLineNumbers=null,!0}function kr(t,e){for(var n=e.viewport,r=!0;(r&&t.options.lineWrapping&&e.oldDisplayWidth!=He(t)||(n&&null!=n.top&&(n={top:Math.min(t.doc.height+Fe(t.display)-je(t),n.top)}),e.visible=Wn(t.display,t.doc,n),!(e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)))&&wr(t,e);r=!1){zn(t);var i=Vn(t);Cn(t),$n(t,i),Lr(t,i)}e.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function Mr(t,e){var n=new es(t,e);if(wr(t,n)){zn(t),kr(t,n);var r=Vn(t);Cn(t),$n(t,r),Lr(t,r),n.finish()}}function Cr(t,n,r){function i(e){var n=e.nextSibling;return Qo&&sa&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),n}for(var o=t.display,a=t.options.lineNumbers,s=o.lineDiv,l=s.firstChild,u=o.view,c=o.viewFrom,h=0;h<u.length;h++){var p=u[h];if(p.hidden);else if(p.node&&p.node.parentNode==s){for(;l!=p.node;)l=i(l);var f=a&&null!=n&&n<=c&&p.lineNumber;p.changes&&(d(p.changes,"gutter")>-1&&(f=!1),Me(t,p,c,r)),f&&(e(p.lineNumber),p.lineNumber.appendChild(document.createTextNode(O(t.options,c)))),l=p.node.nextSibling}else{var g=De(t,p,c,r);s.insertBefore(g,l)}c+=p.size}for(;l;)l=i(l)}function Sr(t){var e=t.display.gutters.offsetWidth;t.display.sizer.style.marginLeft=e+"px"}function Lr(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+Be(t)+"px"}function Ar(t){var n=t.display.gutters,i=t.options.gutters;e(n);for(var o=0;o<i.length;++o){var a=i[o],s=n.appendChild(r("div",null,"CodeMirror-gutter "+a));"CodeMirror-linenumbers"==a&&(t.display.lineGutter=s,s.style.width=(t.display.lineNumWidth||1)+"px")}n.style.display=o?"":"none",Sr(t)}function Er(t){var e=d(t.gutters,"CodeMirror-linenumbers");e==-1&&t.lineNumbers?t.gutters=t.gutters.concat(["CodeMirror-linenumbers"]):e>-1&&!t.lineNumbers&&(t.gutters=t.gutters.slice(0),t.gutters.splice(e,1))}function Tr(t,e){var n=t[e];t.sort(function(t,e){return I(t.from(),e.from())}),e=d(t,n);for(var r=1;r<t.length;r++){var i=t[r],o=t[r-1];if(I(o.to(),i.from())>=0){var a=F(o.from(),i.from()),s=W(o.to(),i.to()),l=o.empty()?i.from()==i.head:o.from()==o.head;r<=e&&--e,t.splice(--r,2,new rs(l?s:a,l?a:s))}}return new ns(t,e)}function Pr(t,e){return new ns([new rs(t,e||t)],0)}function Dr(t){return t.text?N(t.from.line+t.text.length-1,f(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function Or(t,e){if(I(t,e.from)<0)return t;if(I(t,e.to)<=0)return Dr(e);var n=t.line+e.text.length-(e.to.line-e.from.line)-1,r=t.ch;return t.line==e.to.line&&(r+=Dr(e).ch-e.to.ch),N(n,r)}function Nr(t,e){for(var n=[],r=0;r<t.sel.ranges.length;r++){var i=t.sel.ranges[r];n.push(new rs(Or(i.anchor,e),Or(i.head,e)))}return Tr(n,t.sel.primIndex)}function Ir(t,e,n){return t.line==e.line?N(n.line,t.ch-e.ch+n.ch):N(n.line+(t.line-e.line),t.ch)}function zr(t,e,n){for(var r=[],i=N(t.first,0),o=i,a=0;a<e.length;a++){var s=e[a],l=Ir(s.from,i,o),u=Ir(Dr(s),i,o);if(i=s.to,o=u,"around"==n){var c=t.sel.ranges[a],d=I(c.head,c.anchor)<0;r[a]=new rs(d?u:l,d?l:u)}else r[a]=new rs(l,l)}return new ns(r,t.sel.primIndex)}function Gr(t){t.doc.mode=qt(t.options,t.doc.modeOption),Wr(t)}function Wr(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.frontier=t.doc.first,br(t,100),t.state.modeGen++,t.curOp&&pr(t)}function Fr(t,e){return 0==e.from.ch&&0==e.to.ch&&""==f(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function Rr(t,e,n,r){function i(t){return n?n[t]:null}function o(t,n,i){se(t,n,i,r),we(t,"change",t,e)}function a(t,e){for(var n=[],o=t;o<e;++o)n.push(new Ha(u[o],i(o),r));return n}var s=e.from,l=e.to,u=e.text,c=S(t,s.line),d=S(t,l.line),h=f(u),p=i(u.length-1),g=l.line-s.line;if(e.full)t.insert(0,a(0,u.length)),t.remove(u.length,t.size-u.length);else if(Fr(t,e)){var v=a(0,u.length-1);o(d,d.text,p),g&&t.remove(s.line,g),v.length&&t.insert(s.line,v)}else if(c==d)if(1==u.length)o(c,c.text.slice(0,s.ch)+h+c.text.slice(l.ch),p);else{var m=a(1,u.length-1);m.push(new Ha(h+c.text.slice(l.ch),p,r)),o(c,c.text.slice(0,s.ch)+u[0],i(0)),t.insert(s.line+1,m)}else if(1==u.length)o(c,c.text.slice(0,s.ch)+u[0]+d.text.slice(l.ch),i(0)),t.remove(s.line+1,g);else{o(c,c.text.slice(0,s.ch)+u[0],i(0)),o(d,h+d.text.slice(l.ch),p);var y=a(1,u.length-1);g>1&&t.remove(s.line+1,g-1),t.insert(s.line+1,y)}we(t,"change",t,e)}function Br(t,e,n){function r(t,i,o){if(t.linked)for(var a=0;a<t.linked.length;++a){var s=t.linked[a];if(s.doc!=i){var l=o&&s.sharedHist;n&&!l||(e(s.doc,l),r(s.doc,t,l))}}}r(t,null,!0)}function Hr(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,wn(t),Gr(t),t.options.lineWrapping||bt(t),t.options.mode=e.modeOption,pr(t)}function jr(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function Vr(t,e){var n={from:G(e.from),to:Dr(e),text:L(t,e.from,e.to)};return Zr(t,n,e.from.line,e.to.line+1),Br(t,function(t){return Zr(t,n,e.from.line,e.to.line+1)},!0),n}function $r(t){for(;t.length;){var e=f(t);if(!e.ranges)break;t.pop()}}function qr(t,e){return e?($r(t.done),f(t.done)):t.done.length&&!f(t.done).ranges?f(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),f(t.done)):void 0}function Ur(t,e,n,r){var i=t.history;i.undone.length=0;var o,a,s=+new Date;if((i.lastOp==r||i.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&t.cm&&i.lastModTime>s-t.cm.options.historyEventDelay||"*"==e.origin.charAt(0)))&&(o=qr(i,i.lastOp==r)))a=f(o.changes),0==I(e.from,e.to)&&0==I(e.from,a.to)?a.to=Dr(e):o.changes.push(Vr(t,e));else{var l=f(i.done);for(l&&l.ranges||Kr(t.sel,i.done),o={changes:[Vr(t,e)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=e.origin,a||Et(t,"historyAdded")}function Xr(t,e,n,r){var i=e.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function Yr(t,e,n,r){var i=t.history,o=r&&r.origin;n==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||Xr(t,o,f(i.done),e))?i.done[i.done.length-1]=e:Kr(e,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=n,r&&r.clearRedo!==!1&&$r(i.undone)}function Kr(t,e){var n=f(e);n&&n.ranges&&n.equals(t)||e.push(t)}function Zr(t,e,n,r){var i=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,r),function(n){n.markedSpans&&((i||(i=e["spans_"+t.id]={}))[o]=n.markedSpans),++o})}function Qr(t){if(!t)return null;for(var e,n=0;n<t.length;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}function Jr(t,e){var n=e["spans_"+t.id];if(!n)return null;for(var r=[],i=0;i<e.text.length;++i)r.push(Qr(n[i]));return r}function ti(t,e){var n=Jr(t,e),r=Q(t,e);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],a=r[i];if(o&&a)t:for(var s=0;s<a.length;++s){for(var l=a[s],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue t;o.push(l)}else a&&(n[i]=a)}return n}function ei(t,e,n){for(var r=[],i=0;i<t.length;++i){var o=t[i];if(o.ranges)r.push(n?ns.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];r.push({changes:s});for(var l=0;l<a.length;++l){var u=a[l],c=void 0;if(s.push({from:u.from,to:u.to,text:u.text}),e)for(var h in u)(c=h.match(/^spans_(\d+)$/))&&d(e,Number(c[1]))>-1&&(f(s)[h]=u[h],delete u[h])}}}return r}function ni(t,e,n,r){if(t.cm&&t.cm.display.shift||t.extend){var i=e.anchor;if(r){var o=I(n,i)<0;o!=I(r,i)<0?(i=n,n=r):o!=I(n,r)<0&&(n=r)}return new rs(i,n)}return new rs(r||n,n)}function ri(t,e,n,r){ui(t,new ns([ni(t,t.sel.primary(),e,n)],0),r)}function ii(t,e,n){for(var r=[],i=0;i<t.sel.ranges.length;i++)r[i]=ni(t,t.sel.ranges[i],e[i],null);var o=Tr(r,t.sel.primIndex);ui(t,o,n)}function oi(t,e,n,r){var i=t.sel.ranges.slice(0);i[e]=n,ui(t,Tr(i,t.sel.primIndex),r)}function ai(t,e,n,r){ui(t,Pr(e,n),r)}function si(t,e,n){var r={ranges:e.ranges,update:function(e){var n=this;this.ranges=[];for(var r=0;r<e.length;r++)n.ranges[r]=new rs(B(t,e[r].anchor),B(t,e[r].head))},origin:n&&n.origin};return Et(t,"beforeSelectionChange",t,r),t.cm&&Et(t.cm,"beforeSelectionChange",t.cm,r),r.ranges!=e.ranges?Tr(r.ranges,r.ranges.length-1):e}function li(t,e,n){var r=t.history.done,i=f(r);i&&i.ranges?(r[r.length-1]=e,ci(t,e,n)):ui(t,e,n)}function ui(t,e,n){ci(t,e,n),Yr(t,t.sel,t.cm?t.cm.curOp.id:NaN,n)}function ci(t,e,n){(Dt(t,"beforeSelectionChange")||t.cm&&Dt(t.cm,"beforeSelectionChange"))&&(e=si(t,e,n));var r=n&&n.bias||(I(e.primary().head,t.sel.primary().head)<0?-1:1);di(t,pi(t,e,r,!0)),n&&n.scroll===!1||!t.cm||Jn(t.cm)}function di(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=t.cm.curOp.selectionChanged=!0,Pt(t.cm)),we(t,"cursorActivity",t))}function hi(t){di(t,pi(t,t.sel,null,!1),_a)}function pi(t,e,n,r){for(var i,o=0;o<e.ranges.length;o++){var a=e.ranges[o],s=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[o],l=gi(t,a.anchor,s&&s.anchor,n,r),u=gi(t,a.head,s&&s.head,n,r);(i||l!=a.anchor||u!=a.head)&&(i||(i=e.ranges.slice(0,o)),i[o]=new rs(l,u))}return i?Tr(i,e.primIndex):e}function fi(t,e,n,r,i){var o=S(t,e.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var s=o.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=e.ch:s.from<e.ch))&&(null==s.to||(l.inclusiveRight?s.to>=e.ch:s.to>e.ch))){if(i&&(Et(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var u=l.find(r<0?1:-1),c=void 0;if((r<0?l.inclusiveRight:l.inclusiveLeft)&&(u=vi(t,u,-r,u&&u.line==e.line?o:null)),u&&u.line==e.line&&(c=I(u,n))&&(r<0?c<0:c>0))return fi(t,u,e,r,i)}var d=l.find(r<0?-1:1);return(r<0?l.inclusiveLeft:l.inclusiveRight)&&(d=vi(t,d,r,d.line==e.line?o:null)),d?fi(t,d,e,r,i):null}}return e}function gi(t,e,n,r,i){var o=r||1,a=fi(t,e,n,o,i)||!i&&fi(t,e,n,o,!0)||fi(t,e,n,-o,i)||!i&&fi(t,e,n,-o,!0);return a?a:(t.cantEdit=!0,N(t.first,0))}function vi(t,e,n,r){return n<0&&0==e.ch?e.line>t.first?B(t,N(e.line-1)):null:n>0&&e.ch==(r||S(t,e.line)).text.length?e.line<t.first+t.size-1?N(e.line+1,0):null:new N(e.line,e.ch+n)}function mi(t){t.setSelection(N(t.firstLine(),0),N(t.lastLine()),_a)}function yi(t,e,n){var r={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return r.canceled=!0}};return n&&(r.update=function(e,n,i,o){e&&(r.from=B(t,e)),n&&(r.to=B(t,n)),i&&(r.text=i),void 0!==o&&(r.origin=o)}),Et(t,"beforeChange",t,r),t.cm&&Et(t.cm,"beforeChange",t.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function bi(t,e,n){if(t.cm){if(!t.cm.curOp)return cr(t.cm,bi)(t,e,n);if(t.cm.state.suppressEdits)return}if(!(Dt(t,"beforeChange")||t.cm&&Dt(t.cm,"beforeChange"))||(e=yi(t,e,!0))){var r=La&&!n&&tt(t,e.from,e.to);if(r)for(var i=r.length-1;i>=0;--i)xi(t,{from:r[i].from,to:r[i].to,text:i?[""]:e.text});else xi(t,e)}}function xi(t,e){if(1!=e.text.length||""!=e.text[0]||0!=I(e.from,e.to)){var n=Nr(t,e);Ur(t,e,n,t.cm?t.cm.curOp.id:NaN),ki(t,e,n,Q(t,e));var r=[];Br(t,function(t,n){n||d(r,t.history)!=-1||(Ai(t.history,e),r.push(t.history)),ki(t,e,null,Q(t,e))})}}function _i(t,e,n){if(!t.cm||!t.cm.state.suppressEdits||n){for(var r,i=t.history,o=t.sel,a="undo"==e?i.done:i.undone,s="undo"==e?i.undone:i.done,l=0;l<a.length&&(r=a[l],n?!r.ranges||r.equals(t.sel):r.ranges);l++);if(l!=a.length){for(i.lastOrigin=i.lastSelOrigin=null;r=a.pop(),r.ranges;){if(Kr(r,s),n&&!r.equals(t.sel))return void ui(t,r,{clearRedo:!1});o=r}var u=[];Kr(o,s),s.push({changes:u,generation:i.generation}),i.generation=r.generation||++i.maxGeneration;for(var c=Dt(t,"beforeChange")||t.cm&&Dt(t.cm,"beforeChange"),h=function(n){var i=r.changes[n];if(i.origin=e,c&&!yi(t,i,!1))return a.length=0,{};u.push(Vr(t,i));var o=n?Nr(t,i):f(a);ki(t,i,o,ti(t,i)),!n&&t.cm&&t.cm.scrollIntoView({from:i.from,to:Dr(i)});var s=[];Br(t,function(t,e){e||d(s,t.history)!=-1||(Ai(t.history,i),s.push(t.history)),ki(t,i,null,ti(t,i))})},p=r.changes.length-1;p>=0;--p){var g=h(p);if(g)return g.v}}}}function wi(t,e){if(0!=e&&(t.first+=e,t.sel=new ns(g(t.sel.ranges,function(t){return new rs(N(t.anchor.line+e,t.anchor.ch),N(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){pr(t.cm,t.first,t.first-e,e);for(var n=t.cm.display,r=n.viewFrom;r<n.viewTo;r++)fr(t.cm,r,"gutter")}}function ki(t,e,n,r){if(t.cm&&!t.cm.curOp)return cr(t.cm,ki)(t,e,n,r);if(e.to.line<t.first)return void wi(t,e.text.length-1-(e.to.line-e.from.line));if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var i=e.text.length-1-(t.first-e.from.line);wi(t,i),e={from:N(t.first,0),to:N(e.to.line+i,e.to.ch),text:[f(e.text)],origin:e.origin}}var o=t.lastLine();e.to.line>o&&(e={from:e.from,to:N(o,S(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=L(t,e.from,e.to),n||(n=Nr(t,e)),t.cm?Mi(t.cm,e,r):Rr(t,e,r),ci(t,n,_a)}}function Mi(t,e,n){var r=t.doc,i=t.display,o=e.from,a=e.to,s=!1,l=o.line;t.options.lineWrapping||(l=T(ct(S(r,o.line))),r.iter(l,a.line+1,function(t){if(t==i.maxLine)return s=!0,!0})),r.sel.contains(e.from,e.to)>-1&&Pt(t),Rr(r,e,n,_n(t)),t.options.lineWrapping||(r.iter(l,o.line+e.text.length,function(t){var e=yt(t);e>i.maxLineLength&&(i.maxLine=t,i.maxLineLength=e,i.maxLineChanged=!0,s=!1)}),s&&(t.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,o.line),br(t,400);var u=e.text.length-(a.line-o.line)-1;e.full?pr(t):o.line!=a.line||1!=e.text.length||Fr(t.doc,e)?pr(t,o.line,a.line+1,u):fr(t,o.line,"text");var c=Dt(t,"changes"),d=Dt(t,"change");if(d||c){var h={from:o,to:a,text:e.text,removed:e.removed,origin:e.origin};d&&we(t,"change",t,h),c&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(h)}t.display.selForContextMenu=null}function Ci(t,e,n,r,i){if(r||(r=n),I(r,n)<0){var o=r;r=n,n=o}"string"==typeof e&&(e=t.splitLines(e)),bi(t,{from:n,to:r,text:e,origin:i})}function Si(t,e,n,r){n<t.line?t.line+=r:e<t.line&&(t.line=e,t.ch=0)}function Li(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i],a=!0;if(o.ranges){o.copied||(o=t[i]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)Si(o.ranges[s].anchor,e,n,r),Si(o.ranges[s].head,e,n,r)}else{for(var l=0;l<o.changes.length;++l){var u=o.changes[l];if(n<u.from.line)u.from=N(u.from.line+r,u.from.ch),u.to=N(u.to.line+r,u.to.ch);else if(e<=u.to.line){a=!1;break}}a||(t.splice(0,i+1),i=0)}}}function Ai(t,e){var n=e.from.line,r=e.to.line,i=e.text.length-(r-n)-1;Li(t.done,n,r,i),Li(t.undone,n,r,i)}function Ei(t,e,n,r){var i=e,o=e;return"number"==typeof e?o=S(t,R(t,e)):i=T(e),null==i?null:(r(o,i)&&t.cm&&fr(t.cm,i,n),o)}function Ti(t,e,n){mt(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&Qn(t,null,n)}function Pi(t,e,n,r){var i=new as(t,n,r),o=t.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),Ei(t,e,"widget",function(e){var n=e.widgets||(e.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!gt(t,e)){var r=mt(e)<t.scrollTop;E(e,e.height+ze(i)),r&&Qn(o,null,i.height),o.curOp.forceUpdate=!0}return!0}),we(o,"lineWidgetAdded",o,i,"number"==typeof e?e:T(e)),i}function Di(t,e,n,i,o){if(i&&i.shared)return Oi(t,e,n,i,o);if(t.cm&&!t.cm.curOp)return cr(t.cm,Di)(t,e,n,i,o);var a=new ls(t,o),s=I(e,n);if(i&&u(i,a,!1),s>0||0==s&&a.clearWhenEmpty!==!1)return a;if(a.replacedWith&&(a.collapsed=!0,a.widgetNode=r("span",[a.replacedWith],"CodeMirror-widget"),a.widgetNode.setAttribute("role","presentation"),i.handleMouseEvents||a.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(a.widgetNode.insertLeft=!0)),a.collapsed){if(ut(t,e.line,e,n,a)||e.line!=n.line&&ut(t,n.line,e,n,a))throw new Error("Inserting collapsed marker partially overlapping an existing one");$()}a.addToHistory&&Ur(t,{from:e,to:n,origin:"markText"},t.sel,NaN);var l,c=e.line,d=t.cm;if(t.iter(c,n.line+1,function(t){d&&a.collapsed&&!d.options.lineWrapping&&ct(t)==d.display.maxLine&&(l=!0),a.collapsed&&c!=e.line&&E(t,0),Y(t,new q(a,c==e.line?e.ch:null,c==n.line?n.ch:null)),++c}),a.collapsed&&t.iter(e.line,n.line+1,function(e){gt(t,e)&&E(e,0)}),a.clearOnEnter&&Da(a,"beforeCursorEnter",function(){return a.clear()}),a.readOnly&&(V(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),a.collapsed&&(a.id=++ss,a.atomic=!0),d){if(l&&(d.curOp.updateMaxLine=!0),a.collapsed)pr(d,e.line,n.line+1);else if(a.className||a.title||a.startStyle||a.endStyle||a.css)for(var h=e.line;h<=n.line;h++)fr(d,h,"text");a.atomic&&hi(d.doc),we(d,"markerAdded",d,a)}return a}function Oi(t,e,n,r,i){r=u(r),r.shared=!1;var o=[Di(t,e,n,r,i)],a=o[0],s=r.widgetNode;return Br(t,function(t){s&&(r.widgetNode=s.cloneNode(!0)),o.push(Di(t,B(t,e),B(t,n),r,i));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;a=f(o)}),new us(o,a)}function Ni(t){return t.findMarks(N(t.first,0),t.clipPos(N(t.lastLine())),function(t){return t.parent})}function Ii(t,e){for(var n=0;n<e.length;n++){var r=e[n],i=r.find(),o=t.clipPos(i.from),a=t.clipPos(i.to);if(I(o,a)){var s=Di(t,o,a,r.primary,r.primary.type);r.markers.push(s),s.parent=r}}}function zi(t){for(var e=function(e){var n=t[e],r=[n.primary.doc];Br(n.primary.doc,function(t){return r.push(t)});for(var i=0;i<n.markers.length;i++){var o=n.markers[i];d(r,o.doc)==-1&&(o.parent=null,n.markers.splice(i--,1))}},n=0;n<t.length;n++)e(n)}function Gi(t){var e=this;if(Ri(e),!Tt(e,t)&&!Ge(e.display,t)){Nt(t),Ko&&(hs=+new Date);var n=kn(e,t,!0),r=t.dataTransfer.files;if(n&&!e.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),a=0,s=function(t,r){if(!e.options.allowDropFileTypes||d(e.options.allowDropFileTypes,t.type)!=-1){var s=new FileReader;s.onload=cr(e,function(){var t=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(t)&&(t=""),o[r]=t,++a==i){n=B(e.doc,n);var l={from:n,to:n,text:e.doc.splitLines(o.join(e.doc.lineSeparator())),origin:"paste"};bi(e.doc,l),li(e.doc,Pr(n,Dr(l)))}}),s.readAsText(t)}},l=0;l<i;++l)s(r[l],l);else{if(e.state.draggingText&&e.doc.sel.contains(n)>-1)return e.state.draggingText(t),void setTimeout(function(){return e.display.input.focus()},20);try{var u=t.dataTransfer.getData("Text");if(u){var c;if(e.state.draggingText&&!e.state.draggingText.copy&&(c=e.listSelections()),ci(e.doc,Pr(n,n)),c)for(var h=0;h<c.length;++h)Ci(e.doc,"",c[h].anchor,c[h].head,"drag");e.replaceSelection(u,"around","paste"),e.display.input.focus()}}catch(t){}}}}function Wi(t,e){if(Ko&&(!t.state.draggingText||+new Date-hs<100))return void Gt(e);if(!Tt(t,e)&&!Ge(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!na)){var n=r("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ea&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),ea&&n.parentNode.removeChild(n)}}function Fi(t,e){var i=kn(t,e);if(i){var o=document.createDocumentFragment();Ln(t,i,o),t.display.dragCursor||(t.display.dragCursor=r("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),n(t.display.dragCursor,o)}}function Ri(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function Bi(t){if(document.body.getElementsByClassName)for(var e=document.body.getElementsByClassName("CodeMirror"),n=0;n<e.length;n++){var r=e[n].CodeMirror;r&&t(r)}}function Hi(){ps||(ji(),ps=!0)}function ji(){var t;Da(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Bi(Vi)},100))}),Da(window,"blur",function(){return Bi(On)})}function Vi(t){var e=t.display;e.lastWrapHeight==e.wrapper.clientHeight&&e.lastWrapWidth==e.wrapper.clientWidth||(e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize())}function $i(t){var e=t.split(/-(?!$)/);t=e[e.length-1];for(var n,r,i,o,a=0;a<e.length-1;a++){var s=e[a];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);i=!0}}return n&&(t="Alt-"+t),r&&(t="Ctrl-"+t),o&&(t="Cmd-"+t),i&&(t="Shift-"+t),t}function qi(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==r){delete t[n];continue}for(var i=g(n.split(" "),$i),o=0;o<i.length;o++){var a=void 0,s=void 0;o==i.length-1?(s=i.join(" "),a=r):(s=i.slice(0,o+1).join(" "),a="...");var l=e[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else e[s]=a}delete t[n]}for(var u in e)t[u]=e[u];return t}function Ui(t,e,n,r){e=Ki(e);var i=e.call?e.call(t,r):e[t];if(i===!1)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return Ui(t,e.fallthrough,n,r);for(var o=0;o<e.fallthrough.length;o++){var a=Ui(t,e.fallthrough[o],n,r);if(a)return a}}}function Xi(t){var e="string"==typeof t?t:fs[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Yi(t,e){if(ea&&34==t.keyCode&&t.char)return!1;var n=fs[t.keyCode],r=n;return null!=r&&!t.altGraphKey&&(t.altKey&&"Alt"!=n&&(r="Alt-"+r),(ha?t.metaKey:t.ctrlKey)&&"Ctrl"!=n&&(r="Ctrl-"+r),(ha?t.ctrlKey:t.metaKey)&&"Cmd"!=n&&(r="Cmd-"+r),!e&&t.shiftKey&&"Shift"!=n&&(r="Shift-"+r),r)}function Ki(t){return"string"==typeof t?ys[t]:t}function Zi(t,e){for(var n=t.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=e(n[i]);r.length&&I(o.from,f(r).to)<=0;){var a=r.pop();if(I(a.from,o.from)<0){o.from=a.from;break}}r.push(o)}ur(t,function(){for(var e=r.length-1;e>=0;e--)Ci(t.doc,"",r[e].from,r[e].to,"+delete");Jn(t)})}function Qi(t,e){var n=S(t.doc,e),r=ct(n);
return r!=n&&(e=T(r)),Ct(!0,t,r,e,1)}function Ji(t,e){var n=S(t.doc,e),r=dt(n);return r!=n&&(e=T(r)),Ct(!0,t,n,e,-1)}function to(t,e){var n=Qi(t,e.line),r=S(t.doc,n.line),i=wt(r);if(!i||0==i[0].level){var o=Math.max(0,r.text.search(/\S/)),a=e.line==n.line&&e.ch<=o&&e.ch;return N(n.line,a?0:o,n.sticky)}return n}function eo(t,e,n){if("string"==typeof e&&(e=_s[e],!e))return!1;t.display.input.ensurePolled();var r=t.display.shift,i=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),n&&(t.display.shift=!1),i=e(t)!=xa}finally{t.display.shift=r,t.state.suppressEdits=!1}return i}function no(t,e,n){for(var r=0;r<t.state.keyMaps.length;r++){var i=Ui(e,t.state.keyMaps[r],n,t);if(i)return i}return t.options.extraKeys&&Ui(e,t.options.extraKeys,n,t)||Ui(e,t.options.keyMap,n,t)}function ro(t,e,n,r){var i=t.state.keySeq;if(i){if(Xi(e))return"handled";ws.set(50,function(){t.state.keySeq==i&&(t.state.keySeq=null,t.display.input.reset())}),e=i+" "+e}var o=no(t,e,r);return"multi"==o&&(t.state.keySeq=e),"handled"==o&&we(t,"keyHandled",t,e,n),"handled"!=o&&"multi"!=o||(Nt(n),En(t)),i&&!o&&/\'$/.test(e)?(Nt(n),!0):!!o}function io(t,e){var n=Yi(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?ro(t,"Shift-"+n,e,function(e){return eo(t,e,!0)})||ro(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return eo(t,e)}):ro(t,n,e,function(e){return eo(t,e)}))}function oo(t,e,n){return ro(t,"'"+n+"'",e,function(e){return eo(t,e,!0)})}function ao(t){var e=this;if(e.curOp.focus=o(),!Tt(e,t)){Ko&&Zo<11&&27==t.keyCode&&(t.returnValue=!1);var n=t.keyCode;e.display.shift=16==n||t.shiftKey;var r=io(e,t);ea&&(ks=r?n:null,!r&&88==n&&!za&&(sa?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||so(e)}}function so(t){function e(t){18!=t.keyCode&&t.altKey||(fa(n,"CodeMirror-crosshair"),At(document,"keyup",e),At(document,"mouseover",e))}var n=t.display.lineDiv;a(n,"CodeMirror-crosshair"),Da(document,"keyup",e),Da(document,"mouseover",e)}function lo(t){16==t.keyCode&&(this.doc.sel.shift=!1),Tt(this,t)}function uo(t){var e=this;if(!(Ge(e.display,t)||Tt(e,t)||t.ctrlKey&&!t.altKey||sa&&t.metaKey)){var n=t.keyCode,r=t.charCode;if(ea&&n==ks)return ks=null,void Nt(t);if(!ea||t.which&&!(t.which<10)||!io(e,t)){var i=String.fromCharCode(null==r?n:r);"\b"!=i&&(oo(e,t,i)||e.display.input.onKeyPress(t))}}}function co(t){var e=this,n=e.display;if(!(Tt(e,t)||n.activeTouch&&n.input.supportsTouch())){if(n.input.ensurePolled(),n.shift=t.shiftKey,Ge(n,t))return void(Qo||(n.scroller.draggable=!1,setTimeout(function(){return n.scroller.draggable=!0},100)));if(!vo(e,t)){var r=kn(e,t);switch(window.focus(),Ft(t)){case 1:e.state.selectingText?e.state.selectingText(t):r?ho(e,t,r):Wt(t)==n.scroller&&Nt(t);break;case 2:Qo&&(e.state.lastMiddleDown=+new Date),r&&ri(e.doc,r),setTimeout(function(){return n.input.focus()},20),Nt(t);break;case 3:pa?mo(e,t):Pn(e)}}}}function ho(t,e,n){Ko?setTimeout(l(Tn,t),0):t.curOp.focus=o();var r,i=+new Date;xs&&xs.time>i-400&&0==I(xs.pos,n)?r="triple":bs&&bs.time>i-400&&0==I(bs.pos,n)?(r="double",xs={time:i,pos:n}):(r="single",bs={time:i,pos:n});var a,s=t.doc.sel,u=sa?e.metaKey:e.ctrlKey;t.options.dragDrop&&Oa&&!t.isReadOnly()&&"single"==r&&(a=s.contains(n))>-1&&(I((a=s.ranges[a]).from(),n)<0||n.xRel>0)&&(I(a.to(),n)>0||n.xRel<0)?po(t,e,n,u):fo(t,e,n,r,u)}function po(t,e,n,r){var i=t.display,o=+new Date,a=cr(t,function(s){Qo&&(i.scroller.draggable=!1),t.state.draggingText=!1,At(document,"mouseup",a),At(i.scroller,"drop",a),Math.abs(e.clientX-s.clientX)+Math.abs(e.clientY-s.clientY)<10&&(Nt(s),!r&&+new Date-200<o&&ri(t.doc,n),Qo||Ko&&9==Zo?setTimeout(function(){document.body.focus(),i.input.focus()},20):i.input.focus())});Qo&&(i.scroller.draggable=!0),t.state.draggingText=a,a.copy=sa?e.altKey:e.ctrlKey,i.scroller.dragDrop&&i.scroller.dragDrop(),Da(document,"mouseup",a),Da(i.scroller,"drop",a)}function fo(t,e,n,r,i){function a(e){if(0!=I(b,e))if(b=e,"rect"==r){for(var i=[],o=t.options.tabSize,a=c(S(d,n.line).text,n.ch,o),s=c(S(d,e.line).text,e.ch,o),l=Math.min(a,s),u=Math.max(a,s),v=Math.min(n.line,e.line),m=Math.min(t.lastLine(),Math.max(n.line,e.line));v<=m;v++){var y=S(d,v).text,x=h(y,l,o);l==u?i.push(new rs(N(v,x),N(v,x))):y.length>x&&i.push(new rs(N(v,x),N(v,h(y,u,o))))}i.length||i.push(new rs(n,n)),ui(d,Tr(g.ranges.slice(0,f).concat(i),f),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var _=p,w=_.anchor,k=e;if("single"!=r){var M;M="double"==r?t.findWordAt(e):new rs(N(e.line,0),B(d,N(e.line+1,0))),I(M.anchor,w)>0?(k=M.head,w=F(_.from(),M.anchor)):(k=M.anchor,w=W(_.to(),M.head))}var C=g.ranges.slice(0);C[f]=new rs(B(d,w),k),ui(d,Tr(C,f),wa)}}function s(e){var n=++_,i=kn(t,e,!0,"rect"==r);if(i)if(0!=I(i,b)){t.curOp.focus=o(),a(i);var l=Wn(u,d);(i.line>=l.to||i.line<l.from)&&setTimeout(cr(t,function(){_==n&&s(e)}),150)}else{var c=e.clientY<x.top?-20:e.clientY>x.bottom?20:0;c&&setTimeout(cr(t,function(){_==n&&(u.scroller.scrollTop+=c,s(e))}),50)}}function l(e){t.state.selectingText=!1,_=1/0,Nt(e),u.input.focus(),At(document,"mousemove",w),At(document,"mouseup",k),d.history.lastSelOrigin=null}var u=t.display,d=t.doc;Nt(e);var p,f,g=d.sel,v=g.ranges;if(i&&!e.shiftKey?(f=d.sel.contains(n),p=f>-1?v[f]:new rs(n,n)):(p=d.sel.primary(),f=d.sel.primIndex),la?e.shiftKey&&e.metaKey:e.altKey)r="rect",i||(p=new rs(n,n)),n=kn(t,e,!0,!0),f=-1;else if("double"==r){var m=t.findWordAt(n);p=t.display.shift||d.extend?ni(d,p,m.anchor,m.head):m}else if("triple"==r){var y=new rs(N(n.line,0),B(d,N(n.line+1,0)));p=t.display.shift||d.extend?ni(d,p,y.anchor,y.head):y}else p=ni(d,p,n);i?f==-1?(f=v.length,ui(d,Tr(v.concat([p]),f),{scroll:!1,origin:"*mouse"})):v.length>1&&v[f].empty()&&"single"==r&&!e.shiftKey?(ui(d,Tr(v.slice(0,f).concat(v.slice(f+1)),0),{scroll:!1,origin:"*mouse"}),g=d.sel):oi(d,f,p,wa):(f=0,ui(d,new ns([p],0),wa),g=d.sel);var b=n,x=u.wrapper.getBoundingClientRect(),_=0,w=cr(t,function(t){Ft(t)?s(t):l(t)}),k=cr(t,l);t.state.selectingText=k,Da(document,"mousemove",w),Da(document,"mouseup",k)}function go(t,e,n,r){var i,o;try{i=e.clientX,o=e.clientY}catch(t){return!1}if(i>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;r&&Nt(e);var a=t.display,s=a.lineDiv.getBoundingClientRect();if(o>s.bottom||!Dt(t,n))return zt(e);o-=s.top-a.viewOffset;for(var l=0;l<t.options.gutters.length;++l){var u=a.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=i){var c=P(t.doc,o),d=t.options.gutters[l];return Et(t,n,t,c,d,e),zt(e)}}}function vo(t,e){return go(t,e,"gutterClick",!0)}function mo(t,e){Ge(t.display,e)||yo(t,e)||Tt(t,e,"contextmenu")||t.display.input.onContextMenu(e)}function yo(t,e){return!!Dt(t,"gutterContextMenu")&&go(t,e,"gutterContextMenu",!1)}function bo(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),rn(t)}function xo(t){function e(e,r,i,o){t.defaults[e]=r,i&&(n[e]=o?function(t,e,n){n!=Ms&&i(t,e,n)}:i)}var n=t.optionHandlers;t.defineOption=e,t.Init=Ms,e("value","",function(t,e){return t.setValue(e)},!0),e("mode",null,function(t,e){t.doc.modeOption=e,Gr(t)},!0),e("indentUnit",2,Gr,!0),e("indentWithTabs",!1),e("smartIndent",!0),e("tabSize",4,function(t){Wr(t),rn(t),pr(t)},!0),e("lineSeparator",null,function(t,e){if(t.doc.lineSep=e,e){var n=[],r=t.doc.first;t.doc.iter(function(t){for(var i=0;;){var o=t.text.indexOf(e,i);if(o==-1)break;i=o+e.length,n.push(N(r,o))}r++});for(var i=n.length-1;i>=0;i--)Ci(t.doc,e,n[i],N(n[i].line,n[i].ch+e.length))}}),e("specialChars",/[\u0000-\u001f\u007f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,e,n){t.state.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),n!=Ms&&t.refresh()}),e("specialCharPlaceholder",de,function(t){return t.refresh()},!0),e("electricChars",!0),e("inputStyle",aa?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),e("spellcheck",!1,function(t,e){return t.getInputField().spellcheck=e},!0),e("rtlMoveVisually",!ua),e("wholeLineUpdateBefore",!0),e("theme","default",function(t){bo(t),_o(t)},!0),e("keyMap","default",function(t,e,n){var r=Ki(e),i=n!=Ms&&Ki(n);i&&i.detach&&i.detach(t,r),r.attach&&r.attach(t,i||null)}),e("extraKeys",null),e("lineWrapping",!1,ko,!0),e("gutters",[],function(t){Er(t.options),_o(t)},!0),e("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?xn(t.display)+"px":"0",t.refresh()},!0),e("coverGutterNextToScrollbar",!1,function(t){return $n(t)},!0),e("scrollbarStyle","native",function(t){Un(t),$n(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)},!0),e("lineNumbers",!1,function(t){Er(t.options),_o(t)},!0),e("firstLineNumber",1,_o,!0),e("lineNumberFormatter",function(t){return t},_o,!0),e("showCursorWhenSelecting",!1,Cn,!0),e("resetSelectionOnContextMenu",!0),e("lineWiseCopyCut",!0),e("readOnly",!1,function(t,e){"nocursor"==e?(On(t),t.display.input.blur(),t.display.disabled=!0):t.display.disabled=!1,t.display.input.readOnlyChanged(e)}),e("disableInput",!1,function(t,e){e||t.display.input.reset()},!0),e("dragDrop",!0,wo),e("allowDropFileTypes",null),e("cursorBlinkRate",530),e("cursorScrollMargin",0),e("cursorHeight",1,Cn,!0),e("singleCursorHeightPerLine",!0,Cn,!0),e("workTime",100),e("workDelay",100),e("flattenSpans",!0,Wr,!0),e("addModeClass",!1,Wr,!0),e("pollInterval",100),e("undoDepth",200,function(t,e){return t.doc.history.undoDepth=e}),e("historyEventDelay",1250),e("viewportMargin",10,function(t){return t.refresh()},!0),e("maxHighlightLength",1e4,Wr,!0),e("moveInputWithCursor",!0,function(t,e){e||t.display.input.resetPosition()}),e("tabindex",null,function(t,e){return t.display.input.getField().tabIndex=e||""}),e("autofocus",null)}function _o(t){Ar(t),pr(t),Nn(t)}function wo(t,e,n){var r=n&&n!=Ms;if(!e!=!r){var i=t.display.dragFunctions,o=e?Da:At;o(t.display.scroller,"dragstart",i.start),o(t.display.scroller,"dragenter",i.enter),o(t.display.scroller,"dragover",i.over),o(t.display.scroller,"dragleave",i.leave),o(t.display.scroller,"drop",i.drop)}}function ko(t){t.options.lineWrapping?(a(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(fa(t.display.wrapper,"CodeMirror-wrap"),bt(t)),wn(t),pr(t),rn(t),setTimeout(function(){return $n(t)},100)}function Mo(t,e){var n=this;if(!(this instanceof Mo))return new Mo(t,e);this.options=e=e?u(e):{},u(Cs,e,!1),Er(e);var r=e.value;"string"==typeof r&&(r=new ds(r,e.mode,null,e.lineSeparator)),this.doc=r;var i=new Mo.inputStyles[e.inputStyle](this),o=this.display=new C(t,r,i);o.wrapper.CodeMirror=this,Ar(this),bo(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Un(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new va,keySeq:null,specialChars:null},e.autofocus&&!aa&&o.input.focus(),Ko&&Zo<11&&setTimeout(function(){return n.display.input.reset(!0)},20),Co(this),Hi(),er(this),this.curOp.forceUpdate=!0,Hr(this,r),e.autofocus&&!aa||this.hasFocus()?setTimeout(l(Dn,this),20):On(this);for(var a in Ss)Ss.hasOwnProperty(a)&&Ss[a](n,e[a],Ms);In(this),e.finishInit&&e.finishInit(this);for(var s=0;s<Ls.length;++s)Ls[s](n);nr(this),Qo&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function Co(t){function e(){i.activeTouch&&(o=setTimeout(function(){return i.activeTouch=null},1e3),a=i.activeTouch,a.end=+new Date)}function n(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return e.radiusX<=1&&e.radiusY<=1}function r(t,e){if(null==e.left)return!0;var n=e.left-t.left,r=e.top-t.top;return n*n+r*r>400}var i=t.display;Da(i.scroller,"mousedown",cr(t,co)),Ko&&Zo<11?Da(i.scroller,"dblclick",cr(t,function(e){if(!Tt(t,e)){var n=kn(t,e);if(n&&!vo(t,e)&&!Ge(t.display,e)){Nt(e);var r=t.findWordAt(n);ri(t.doc,r.anchor,r.head)}}})):Da(i.scroller,"dblclick",function(e){return Tt(t,e)||Nt(e)}),pa||Da(i.scroller,"contextmenu",function(e){return mo(t,e)});var o,a={end:0};Da(i.scroller,"touchstart",function(e){if(!Tt(t,e)&&!n(e)){i.input.ensurePolled(),clearTimeout(o);var r=+new Date;i.activeTouch={start:r,moved:!1,prev:r-a.end<=300?a:null},1==e.touches.length&&(i.activeTouch.left=e.touches[0].pageX,i.activeTouch.top=e.touches[0].pageY)}}),Da(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)}),Da(i.scroller,"touchend",function(n){var o=i.activeTouch;if(o&&!Ge(i,n)&&null!=o.left&&!o.moved&&new Date-o.start<300){var a,s=t.coordsChar(i.activeTouch,"page");a=!o.prev||r(o,o.prev)?new rs(s,s):!o.prev.prev||r(o,o.prev.prev)?t.findWordAt(s):new rs(N(s.line,0),B(t.doc,N(s.line+1,0))),t.setSelection(a.anchor,a.head),t.focus(),Nt(n)}e()}),Da(i.scroller,"touchcancel",e),Da(i.scroller,"scroll",function(){i.scroller.clientHeight&&(Fn(t,i.scroller.scrollTop),Rn(t,i.scroller.scrollLeft,!0),Et(t,"scroll",t))}),Da(i.scroller,"mousewheel",function(e){return jn(t,e)}),Da(i.scroller,"DOMMouseScroll",function(e){return jn(t,e)}),Da(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),i.dragFunctions={enter:function(e){Tt(t,e)||Gt(e)},over:function(e){Tt(t,e)||(Fi(t,e),Gt(e))},start:function(e){return Wi(t,e)},drop:cr(t,Gi),leave:function(e){Tt(t,e)||Ri(t)}};var s=i.input.getField();Da(s,"keyup",function(e){return lo.call(t,e)}),Da(s,"keydown",cr(t,ao)),Da(s,"keypress",cr(t,uo)),Da(s,"focus",function(e){return Dn(t,e)}),Da(s,"blur",function(e){return On(t,e)})}function So(t,e,n,r){var i,o=t.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?i=Jt(t,e):n="prev");var a=t.options.tabSize,s=S(o,e),l=c(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var u,d=s.text.match(/^\s*/)[0];if(r||/\S/.test(s.text)){if("smart"==n&&(u=o.mode.indent(i,s.text.slice(d.length),s.text),u==xa||u>150)){if(!r)return;n="prev"}}else u=0,n="not";"prev"==n?u=e>o.first?c(S(o,e-1).text,null,a):0:"add"==n?u=l+t.options.indentUnit:"subtract"==n?u=l-t.options.indentUnit:"number"==typeof n&&(u=l+n),u=Math.max(0,u);var h="",f=0;if(t.options.indentWithTabs)for(var g=Math.floor(u/a);g;--g)f+=a,h+="\t";if(f<u&&(h+=p(u-f)),h!=d)return Ci(o,h,N(e,0),N(e,d.length),"+input"),s.stateAfter=null,!0;for(var v=0;v<o.sel.ranges.length;v++){var m=o.sel.ranges[v];if(m.head.line==e&&m.head.ch<d.length){var y=N(e,d.length);oi(o,v,new rs(y,y));break}}}function Lo(t){As=t}function Ao(t,e,n,r,i){var o=t.doc;t.display.shift=!1,r||(r=o.sel);var a=t.state.pasteIncoming||"paste"==i,s=Na(e),l=null;if(a&&r.ranges.length>1)if(As&&As.text.join("\n")==e){if(r.ranges.length%As.text.length==0){l=[];for(var u=0;u<As.text.length;u++)l.push(o.splitLines(As.text[u]))}}else s.length==r.ranges.length&&(l=g(s,function(t){return[t]}));for(var c,d=r.ranges.length-1;d>=0;d--){var h=r.ranges[d],p=h.from(),v=h.to();h.empty()&&(n&&n>0?p=N(p.line,p.ch-n):t.state.overwrite&&!a?v=N(v.line,Math.min(S(o,v.line).text.length,v.ch+f(s).length)):As&&As.lineWise&&As.text.join("\n")==e&&(p=v=N(p.line,0))),c=t.curOp.updateInput;var m={from:p,to:v,text:l?l[d%l.length]:s,origin:i||(a?"paste":t.state.cutIncoming?"cut":"+input")};bi(t.doc,m),we(t,"inputRead",t,m)}e&&!a&&To(t,e),Jn(t),t.curOp.updateInput=c,t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=!1}function Eo(t,e){var n=t.clipboardData&&t.clipboardData.getData("Text");if(n)return t.preventDefault(),e.isReadOnly()||e.options.disableInput||ur(e,function(){return Ao(e,n,0,null,"paste")}),!0}function To(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var n=t.doc.sel,r=n.ranges.length-1;r>=0;r--){var i=n.ranges[r];if(!(i.head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)){var o=t.getModeAt(i.head),a=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(e.indexOf(o.electricChars.charAt(s))>-1){a=So(t,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(S(t.doc,i.head.line).text.slice(0,i.head.ch))&&(a=So(t,i.head.line,"smart"));a&&we(t,"electricInput",t,i.head.line)}}}function Po(t){for(var e=[],n=[],r=0;r<t.doc.sel.ranges.length;r++){var i=t.doc.sel.ranges[r].head.line,o={anchor:N(i,0),head:N(i+1,0)};n.push(o),e.push(t.getRange(o.anchor,o.head))}return{text:e,ranges:n}}function Do(t,e){t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("spellcheck",!!e)}function Oo(){var t=r("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),e=r("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return Qo?t.style.width="1000px":t.setAttribute("wrap","off"),oa&&(t.style.border="1px solid black"),Do(t),e}function No(t){var e=t.optionHandlers,n=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,n){var r=this.options,i=r[t];r[t]==n&&"mode"!=t||(r[t]=n,e.hasOwnProperty(t)&&cr(this,e[t])(this,n,i),Et(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](Ki(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,n=0;n<e.length;++n)if(e[n]==t||e[n].name==t)return e.splice(n,1),!0},addOverlay:dr(function(e,n){var r=e.token?e:t.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");v(this.state.overlays,{mode:r,modeSpec:e,opaque:n&&n.opaque,priority:n&&n.priority||0},function(t){return t.priority}),this.state.modeGen++,pr(this)}),removeOverlay:dr(function(t){for(var e=this,n=this.state.overlays,r=0;r<n.length;++r){var i=n[r].modeSpec;if(i==t||"string"==typeof t&&i.name==t)return n.splice(r,1),e.state.modeGen++,void pr(e)}}),indentLine:dr(function(t,e,n){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),D(this.doc,t)&&So(this,t,e,n)}),indentSelection:dr(function(t){for(var e=this,n=this.doc.sel.ranges,r=-1,i=0;i<n.length;i++){var o=n[i];if(o.empty())o.head.line>r&&(So(e,o.head.line,t,!0),r=o.head.line,i==e.doc.sel.primIndex&&Jn(e));else{var a=o.from(),s=o.to(),l=Math.max(r,a.line);r=Math.min(e.lastLine(),s.line-(s.ch?0:1))+1;for(var u=l;u<r;++u)So(e,u,t);var c=e.doc.sel.ranges;0==a.ch&&n.length==c.length&&c[i].from().ch>0&&oi(e.doc,i,new rs(a,c[i].to()),_a)}}}),getTokenAt:function(t,e){return re(this,t,e)},getLineTokens:function(t,e){return re(this,N(t),e,!0)},getTokenTypeAt:function(t){t=B(this.doc,t);var e,n=Qt(this,S(this.doc,t.line)),r=0,i=(n.length-1)/2,o=t.ch;if(0==o)e=n[2];else for(;;){var a=r+i>>1;if((a?n[2*a-1]:0)>=o)i=a;else{if(!(n[2*a+1]<o)){e=n[2*a+2];break}r=a+1}}var s=e?e.indexOf("overlay "):-1;return s<0?e:0==s?null:e.slice(0,s-1)},getModeAt:function(e){var n=this.doc.mode;return n.innerMode?t.innerMode(n,this.getTokenAt(e).state).mode:n},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var r=this,i=[];if(!n.hasOwnProperty(e))return i;var o=n[e],a=this.getModeAt(t);if("string"==typeof a[e])o[a[e]]&&i.push(o[a[e]]);else if(a[e])for(var s=0;s<a[e].length;s++){var l=o[a[e][s]];l&&i.push(l)}else a.helperType&&o[a.helperType]?i.push(o[a.helperType]):o[a.name]&&i.push(o[a.name]);for(var u=0;u<o._global.length;u++){var c=o._global[u];c.pred(a,r)&&d(i,c.val)==-1&&i.push(c.val)}return i},getStateAfter:function(t,e){var n=this.doc;return t=R(n,null==t?n.first+n.size-1:t),Jt(this,t+1,e)},cursorCoords:function(t,e){var n,r=this.doc.sel.primary();return n=null==t?r.head:"object"==typeof t?B(this.doc,t):t?r.from():r.to(),cn(this,n,e||"page")},charCoords:function(t,e){return un(this,B(this.doc,t),e||"page")},coordsChar:function(t,e){return t=ln(this,t,e||"page"),pn(this,t.left,t.top)},lineAtHeight:function(t,e){return t=ln(this,{top:t,left:0},e||"page").top,P(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e,n){var r,i=!1;if("number"==typeof t){var o=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>o&&(t=o,i=!0),r=S(this.doc,t)}else r=t;return sn(this,r,{top:0,left:0},e||"page",n||i).top+(i?this.doc.height-mt(r):0)},defaultTextHeight:function(){return mn(this.display)},defaultCharWidth:function(){return yn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,n,r,i){var o=this.display;t=cn(this,B(this.doc,t));var a=t.bottom,s=t.left;if(e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),o.sizer.appendChild(e),"over"==r)a=t.top;else if("above"==r||"near"==r){var l=Math.max(o.wrapper.clientHeight,this.doc.height),u=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?a=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=l&&(a=t.bottom),s+e.offsetWidth>u&&(s=u-e.offsetWidth)}e.style.top=a+"px",e.style.left=e.style.right="","right"==i?(s=o.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==i?s=0:"middle"==i&&(s=(o.sizer.clientWidth-e.offsetWidth)/2),e.style.left=s+"px"),n&&Kn(this,s,a,s+e.offsetWidth,a+e.offsetHeight)},triggerOnKeyDown:dr(ao),triggerOnKeyPress:dr(uo),triggerOnKeyUp:lo,execCommand:function(t){if(_s.hasOwnProperty(t))return _s[t].call(null,this)},triggerElectric:dr(function(t){To(this,t)}),findPosH:function(t,e,n,r){var i=this,o=1;e<0&&(o=-1,e=-e);for(var a=B(this.doc,t),s=0;s<e&&(a=Io(i.doc,a,o,n,r),!a.hitSide);++s);return a},moveH:dr(function(t,e){var n=this;this.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?Io(n.doc,r.head,t,e,n.options.rtlMoveVisually):t<0?r.from():r.to()},ka)}),deleteH:dr(function(t,e){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Zi(this,function(n){var i=Io(r,n.head,t,e,!1);return t<0?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(t,e,n,r){var i=this,o=1,a=r;e<0&&(o=-1,e=-e);for(var s=B(this.doc,t),l=0;l<e;++l){var u=cn(i,s,"div");if(null==a?a=u.left:u.left=a,s=zo(i,u,o,n),s.hitSide)break}return s},moveV:dr(function(t,e){var n=this,r=this.doc,i=[],o=!this.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy(function(a){if(o)return t<0?a.from():a.to();var s=cn(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),i.push(s.left);var l=zo(n,s,t,e);return"page"==e&&a==r.sel.primary()&&Qn(n,null,un(n,l,"div").top-s.top),l},ka),i.length)for(var a=0;a<r.sel.ranges.length;a++)r.sel.ranges[a].goalColumn=i[a]}),findWordAt:function(t){var e=this.doc,n=S(e,t.line).text,r=t.ch,i=t.ch;if(n){var o=this.getHelper(t,"wordChars");"before"!=t.sticky&&i!=n.length||!r?++i:--r;for(var a=n.charAt(r),s=x(a,o)?function(t){return x(t,o)}:/\s/.test(a)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!x(t)};r>0&&s(n.charAt(r-1));)--r;for(;i<n.length&&s(n.charAt(i));)++i}return new rs(N(t.line,r),N(t.line,i))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?a(this.display.cursorDiv,"CodeMirror-overwrite"):fa(this.display.cursorDiv,"CodeMirror-overwrite"),Et(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==o()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:dr(function(t,e){null==t&&null==e||tr(this),null!=t&&(this.curOp.scrollLeft=t),null!=e&&(this.curOp.scrollTop=e)}),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-Be(this)-this.display.barHeight,width:t.scrollWidth-Be(this)-this.display.barWidth,clientHeight:je(this),clientWidth:He(this)}},scrollIntoView:dr(function(t,e){if(null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:N(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line)tr(this),this.curOp.scrollToPos=t;else{var n=Zn(this,Math.min(t.from.left,t.to.left),Math.min(t.from.top,t.to.top)-t.margin,Math.max(t.from.right,t.to.right),Math.max(t.from.bottom,t.to.bottom)+t.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:dr(function(t,e){var n=this,r=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=r(t)),null!=e&&(this.display.wrapper.style.height=r(e)),this.options.lineWrapping&&nn(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){fr(n,i,"widget");break}++i}),this.curOp.forceUpdate=!0,Et(this,"refresh",this)}),operation:function(t){return ur(this,t)},refresh:dr(function(){var t=this.display.cachedTextHeight;pr(this),this.curOp.forceUpdate=!0,rn(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),Sr(this),(null==t||Math.abs(t-mn(this.display))>.5)&&wn(this),Et(this,"refresh",this)}),swapDoc:dr(function(t){var e=this.doc;return e.cm=null,Hr(this,t),rn(this),this.display.input.reset(),this.scrollTo(t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,we(this,"swapDoc",this,e),e}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ot(t),t.registerHelper=function(e,r,i){n.hasOwnProperty(e)||(n[e]=t[e]={_global:[]}),n[e][r]=i},t.registerGlobalHelper=function(e,r,i,o){t.registerHelper(e,r,o),n[e]._global.push({pred:i,val:o})}}function Io(t,e,n,r,i){function o(){var r=e.line+n;return!(r<t.first||r>=t.first+t.size)&&(e=new N(r,e.ch,e.sticky),u=S(t,r))}function a(r){var a;if(a=i?St(t.cm,u,e,n):Mt(u,e,n),null==a){if(r||!o())return!1;e=Ct(i,t.cm,u,e.line,n)}else e=a;return!0}var s=e,l=n,u=S(t,e.line);if("char"==r)a();else if("column"==r)a(!0);else if("word"==r||"group"==r)for(var c=null,d="group"==r,h=t.cm&&t.cm.getHelper(e,"wordChars"),p=!0;!(n<0)||a(!p);p=!1){var f=u.text.charAt(e.ch)||"\n",g=x(f,h)?"w":d&&"\n"==f?"n":!d||/\s/.test(f)?null:"p";if(!d||p||g||(g="s"),c&&c!=g){n<0&&(n=1,a(),e.sticky="after");break}if(g&&(c=g),n>0&&!a(!p))break}var v=gi(t,e,s,l,!0);return z(s,v)&&(v.hitSide=!0),v}function zo(t,e,n,r){var i,o=t.doc,a=e.left;if("page"==r){var s=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),l=Math.max(s-.5*mn(t.display),3);i=(n>0?e.bottom:e.top)+n*l}else"line"==r&&(i=n>0?e.bottom+3:e.top-3);for(var u;u=pn(t,a,i),u.outside;){if(n<0?i<=0:i>=o.height){u.hitSide=!0;break}i+=5*n}return u}function Go(t,e){var n=Xe(t,e.line);if(!n||n.hidden)return null;var r=S(t.doc,e.line),i=$e(n,r,e.line),o=wt(r),a="left";if(o){var s=_t(o,e.ch);a=s%2?"right":"left"}var l=Ze(i.map,e.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function Wo(t,e){return e&&(t.bad=!0),t}function Fo(t,e,n,r,i){function o(t){return function(e){return e.id==t}}function a(e){if(1==e.nodeType){var n=e.getAttribute("cm-text");if(null!=n)return void(s+=""==n?e.textContent.replace(/\u200b/g,""):n);var c,d=e.getAttribute("cm-marker");if(d){var h=t.findMarks(N(r,0),N(i+1,0),o(+d));return void(h.length&&(c=h[0].find())&&(s+=L(t.doc,c.from,c.to).join(u)))}if("false"==e.getAttribute("contenteditable"))return;for(var p=0;p<e.childNodes.length;p++)a(e.childNodes[p]);/^(pre|div|p)$/i.test(e.nodeName)&&(l=!0)}else if(3==e.nodeType){var f=e.nodeValue;if(!f)return;l&&(s+=u,l=!1),s+=f}}for(var s="",l=!1,u=t.doc.lineSeparator();a(e),e!=n;)e=e.nextSibling;return s}function Ro(t,e,n){var r;if(e==t.display.lineDiv){if(r=t.display.lineDiv.childNodes[n],!r)return Wo(t.clipPos(N(t.display.viewTo-1)),!0);e=null,n=0}else for(r=e;;r=r.parentNode){if(!r||r==t.display.lineDiv)return null;if(r.parentNode&&r.parentNode==t.display.lineDiv)break}for(var i=0;i<t.display.view.length;i++){var o=t.display.view[i];if(o.node==r)return Bo(o,e,n)}}function Bo(t,e,n){function r(e,n,r){for(var i=-1;i<(d?d.length:0);i++)for(var o=i<0?c.map:d[i],a=0;a<o.length;a+=3){var s=o[a+2];if(s==e||s==n){var l=T(i<0?t.line:t.rest[i]),u=o[a]+r;return(r<0||s!=e)&&(u=o[a+(r?1:0)]),N(l,u)}}}var o=t.text.firstChild,a=!1;if(!e||!i(o,e))return Wo(N(T(t.line),0),!0);if(e==o&&(a=!0,e=o.childNodes[n],n=0,!e)){var s=t.rest?f(t.rest):t.line;return Wo(N(T(s),s.text.length),a)}var l=3==e.nodeType?e:null,u=e;for(l||1!=e.childNodes.length||3!=e.firstChild.nodeType||(l=e.firstChild,n&&(n=l.nodeValue.length));u.parentNode!=o;)u=u.parentNode;var c=t.measure,d=c.maps,h=r(l,u,n);if(h)return Wo(h,a);for(var p=u.nextSibling,g=l?l.nodeValue.length-n:0;p;p=p.nextSibling){if(h=r(p,p.firstChild,0))return Wo(N(h.line,h.ch-g),a);g+=p.textContent.length}for(var v=u.previousSibling,m=n;v;v=v.previousSibling){if(h=r(v,v.firstChild,-1))return Wo(N(h.line,h.ch+m),a);m+=v.textContent.length}}function Ho(t,e){function n(){t.value=l.getValue()}if(e=e?u(e):{},e.value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var r=o();e.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}var i;if(t.form&&(Da(t.form,"submit",n),!e.leaveSubmitMethodAlone)){var a=t.form;i=a.submit;try{var s=a.submit=function(){n(),a.submit=i,a.submit(),a.submit=s}}catch(t){}}e.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(At(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=i))}},t.style.display="none";var l=Mo(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e);return l}function jo(t){t.off=At,t.on=Da,t.wheelEventPixels=Hn,t.Doc=ds,t.splitLines=Na,t.countColumn=c,t.findColumn=h,t.isWordChar=b,t.Pass=xa,t.signal=Et,t.Line=Ha,t.changeEnd=Dr,t.scrollbarModel=Ja,t.Pos=N,t.cmpPos=I,t.modes=Wa,t.mimeModes=Fa,t.resolveMode=$t,t.getMode=qt,t.modeExtensions=Ra,t.extendMode=Ut,t.copyState=Xt,t.startState=Kt,t.innerMode=Yt,t.commands=_s,t.keyMap=ys,t.keyName=Yi,t.isModifierKey=Xi,t.lookupKey=Ui,t.normalizeKeyMap=qi,t.StringStream=Ba,t.SharedTextMarker=us,t.TextMarker=ls,t.LineWidget=as,t.e_preventDefault=Nt,t.e_stopPropagation=It,t.e_stop=Gt,t.addClass=a,t.contains=i,t.rmClass=fa,t.keyNames=fs}var Vo=navigator.userAgent,$o=navigator.platform,qo=/gecko\/\d/i.test(Vo),Uo=/MSIE \d/.test(Vo),Xo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Vo),Yo=/Edge\/(\d+)/.exec(Vo),Ko=Uo||Xo||Yo,Zo=Ko&&(Uo?document.documentMode||6:+(Yo||Xo)[1]),Qo=!Yo&&/WebKit\//.test(Vo),Jo=Qo&&/Qt\/\d+\.\d+/.test(Vo),ta=!Yo&&/Chrome\//.test(Vo),ea=/Opera\//.test(Vo),na=/Apple Computer/.test(navigator.vendor),ra=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(Vo),ia=/PhantomJS/.test(Vo),oa=!Yo&&/AppleWebKit/.test(Vo)&&/Mobile\/\w+/.test(Vo),aa=oa||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(Vo),sa=oa||/Mac/.test($o),la=/\bCrOS\b/.test(Vo),ua=/win/i.test($o),ca=ea&&Vo.match(/Version\/(\d*\.\d*)/);ca&&(ca=Number(ca[1])),ca&&ca>=15&&(ea=!1,Qo=!0);var da,ha=sa&&(Jo||ea&&(null==ca||ca<12.11)),pa=qo||Ko&&Zo>=9,fa=function(e,n){var r=e.className,i=t(n).exec(r);if(i){var o=r.slice(i.index+i[0].length);e.className=r.slice(0,i.index)+(o?i[1]+o:"")}};da=document.createRange?function(t,e,n,r){var i=document.createRange();return i.setEnd(r||t,n),i.setStart(t,e),i}:function(t,e,n){var r=document.body.createTextRange();try{r.moveToElementText(t.parentNode)}catch(t){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",e),r};var ga=function(t){t.select()};oa?ga=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:Ko&&(ga=function(t){try{t.select()}catch(t){}});var va=function(){this.id=null};va.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var ma,ya,ba=30,xa={toString:function(){return"CodeMirror.Pass"}},_a={scroll:!1},wa={origin:"*mouse"},ka={origin:"+move"},Ma=[""],Ca=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Sa=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,La=!1,Aa=!1,Ea=null,Ta=function(){
function t(t){return t<=247?n.charAt(t):1424<=t&&t<=1524?"R":1536<=t&&t<=1785?r.charAt(t-1536):1774<=t&&t<=2220?"r":8192<=t&&t<=8203?"w":8204==t?"b":"L"}function e(t,e,n){this.level=t,this.from=e,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,u="L";return function(n){if(!i.test(n))return!1;for(var r=n.length,c=[],d=0;d<r;++d)c.push(t(n.charCodeAt(d)));for(var h=0,p=u;h<r;++h){var g=c[h];"m"==g?c[h]=p:p=g}for(var v=0,m=u;v<r;++v){var y=c[v];"1"==y&&"r"==m?c[v]="n":a.test(y)&&(m=y,"r"==y&&(c[v]="R"))}for(var b=1,x=c[0];b<r-1;++b){var _=c[b];"+"==_&&"1"==x&&"1"==c[b+1]?c[b]="1":","!=_||x!=c[b+1]||"1"!=x&&"n"!=x||(c[b]=x),x=_}for(var w=0;w<r;++w){var k=c[w];if(","==k)c[w]="N";else if("%"==k){var M=void 0;for(M=w+1;M<r&&"%"==c[M];++M);for(var C=w&&"!"==c[w-1]||M<r&&"1"==c[M]?"1":"N",S=w;S<M;++S)c[S]=C;w=M-1}}for(var L=0,A=u;L<r;++L){var E=c[L];"L"==A&&"1"==E?c[L]="L":a.test(E)&&(A=E)}for(var T=0;T<r;++T)if(o.test(c[T])){var P=void 0;for(P=T+1;P<r&&o.test(c[P]);++P);for(var D="L"==(T?c[T-1]:u),O="L"==(P<r?c[P]:u),N=D||O?"L":"R",I=T;I<P;++I)c[I]=N;T=P-1}for(var z,G=[],W=0;W<r;)if(s.test(c[W])){var F=W;for(++W;W<r&&s.test(c[W]);++W);G.push(new e(0,F,W))}else{var R=W,B=G.length;for(++W;W<r&&"L"!=c[W];++W);for(var H=R;H<W;)if(l.test(c[H])){R<H&&G.splice(B,0,new e(1,R,H));var j=H;for(++H;H<W&&l.test(c[H]);++H);G.splice(B,0,new e(2,j,H)),R=H}else++H;R<W&&G.splice(B,0,new e(1,R,W))}return 1==G[0].level&&(z=n.match(/^\s+/))&&(G[0].from=z[0].length,G.unshift(new e(0,0,z[0].length))),1==f(G).level&&(z=n.match(/\s+$/))&&(f(G).to-=z[0].length,G.push(new e(0,r-z[0].length,r))),G}}(),Pa=[],Da=function(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent("on"+e,n);else{var r=t._handlers||(t._handlers={});r[e]=(r[e]||Pa).concat(n)}},Oa=function(){if(Ko&&Zo<9)return!1;var t=r("div");return"draggable"in t||"dragDrop"in t}(),Na=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,n=[],r=t.length;e<=r;){var i=t.indexOf("\n",e);i==-1&&(i=t.length);var o=t.slice(e,"\r"==t.charAt(i-1)?i-1:i),a=o.indexOf("\r");a!=-1?(n.push(o.slice(0,a)),e+=a+1):(n.push(o),e=i+1)}return n}:function(t){return t.split(/\r\n?|\n/)},Ia=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(t){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},za=function(){var t=r("div");return"oncopy"in t||(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),Ga=null,Wa={},Fa={},Ra={},Ba=function(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Ba.prototype.eol=function(){return this.pos>=this.string.length},Ba.prototype.sol=function(){return this.pos==this.lineStart},Ba.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Ba.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Ba.prototype.eat=function(t){var e,n=this.string.charAt(this.pos);if(e="string"==typeof t?n==t:n&&(t.test?t.test(n):t(n)))return++this.pos,n},Ba.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},Ba.prototype.eatSpace=function(){for(var t=this,e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++t.pos;return this.pos>e},Ba.prototype.skipToEnd=function(){this.pos=this.string.length},Ba.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},Ba.prototype.backUp=function(t){this.pos-=t},Ba.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=c(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?c(this.string,this.lineStart,this.tabSize):0)},Ba.prototype.indentation=function(){return c(this.string,null,this.tabSize)-(this.lineStart?c(this.string,this.lineStart,this.tabSize):0)},Ba.prototype.match=function(t,e,n){if("string"!=typeof t){var r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&e!==!1&&(this.pos+=r[0].length),r)}var i=function(t){return n?t.toLowerCase():t},o=this.string.substr(this.pos,t.length);if(i(o)==i(t))return e!==!1&&(this.pos+=t.length),!0},Ba.prototype.current=function(){return this.string.slice(this.start,this.pos)},Ba.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}};var Ha=function(t,e,n){this.text=t,nt(this,e),this.height=n?n(this):1};Ha.prototype.lineNo=function(){return T(this)},Ot(Ha);var ja,Va={},$a={},qa=null,Ua=null,Xa={left:0,right:0,top:0,bottom:0},Ya=0,Ka=null;Ko?Ka=-.53:qo?Ka=15:ta?Ka=-.7:na&&(Ka=-1/3);var Za=function(t,e,n){this.cm=n;var i=this.vert=r("div",[r("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=r("div",[r("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");t(i),t(o),Da(i,"scroll",function(){i.clientHeight&&e(i.scrollTop,"vertical")}),Da(o,"scroll",function(){o.clientWidth&&e(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,Ko&&Zo<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Za.prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,n=t.scrollHeight>t.clientHeight+1,r=t.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=e?r+"px":"0";var i=t.viewHeight-(e?r:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=t.barLeft+"px";var o=t.viewWidth-t.barLeft-(n?r:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?r:0,bottom:e?r:0}},Za.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},Za.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},Za.prototype.zeroWidthHack=function(){var t=sa&&!ra?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new va,this.disableVert=new va},Za.prototype.enableZeroWidthBar=function(t,e){function n(){var r=t.getBoundingClientRect(),i=document.elementFromPoint(r.left+1,r.bottom-1);i!=t?t.style.pointerEvents="none":e.set(1e3,n)}t.style.pointerEvents="auto",e.set(1e3,n)},Za.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var Qa=function(){};Qa.prototype.update=function(){return{bottom:0,right:0}},Qa.prototype.setScrollLeft=function(){},Qa.prototype.setScrollTop=function(){},Qa.prototype.clear=function(){};var Ja={native:Za,null:Qa},ts=0,es=function(t,e,n){var r=t.display;this.viewport=e,this.visible=Wn(r,t.doc,e),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=He(t),this.force=n,this.dims=bn(t),this.events=[]};es.prototype.signal=function(t,e){Dt(t,e)&&this.events.push(arguments)},es.prototype.finish=function(){for(var t=this,e=0;e<this.events.length;e++)Et.apply(null,t.events[e])};var ns=function(t,e){this.ranges=t,this.primIndex=e};ns.prototype.primary=function(){return this.ranges[this.primIndex]},ns.prototype.equals=function(t){var e=this;if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var r=e.ranges[n],i=t.ranges[n];if(!z(r.anchor,i.anchor)||!z(r.head,i.head))return!1}return!0},ns.prototype.deepCopy=function(){for(var t=this,e=[],n=0;n<this.ranges.length;n++)e[n]=new rs(G(t.ranges[n].anchor),G(t.ranges[n].head));return new ns(e,this.primIndex)},ns.prototype.somethingSelected=function(){for(var t=this,e=0;e<this.ranges.length;e++)if(!t.ranges[e].empty())return!0;return!1},ns.prototype.contains=function(t,e){var n=this;e||(e=t);for(var r=0;r<this.ranges.length;r++){var i=n.ranges[r];if(I(e,i.from())>=0&&I(t,i.to())<=0)return r}return-1};var rs=function(t,e){this.anchor=t,this.head=e};rs.prototype.from=function(){return F(this.anchor,this.head)},rs.prototype.to=function(){return W(this.anchor,this.head)},rs.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};var is=function(t){var e=this;this.lines=t,this.parent=null;for(var n=0,r=0;r<t.length;++r)t[r].parent=e,n+=t[r].height;this.height=n};is.prototype.chunkSize=function(){return this.lines.length},is.prototype.removeInner=function(t,e){for(var n=this,r=t,i=t+e;r<i;++r){var o=n.lines[r];n.height-=o.height,le(o),we(o,"delete")}this.lines.splice(t,e)},is.prototype.collapse=function(t){t.push.apply(t,this.lines)},is.prototype.insertInner=function(t,e,n){var r=this;this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var i=0;i<e.length;++i)e[i].parent=r},is.prototype.iterN=function(t,e,n){for(var r=this,i=t+e;t<i;++t)if(n(r.lines[t]))return!0};var os=function(t){var e=this;this.children=t;for(var n=0,r=0,i=0;i<t.length;++i){var o=t[i];n+=o.chunkSize(),r+=o.height,o.parent=e}this.size=n,this.height=r,this.parent=null};os.prototype.chunkSize=function(){return this.size},os.prototype.removeInner=function(t,e){var n=this;this.size-=e;for(var r=0;r<this.children.length;++r){var i=n.children[r],o=i.chunkSize();if(t<o){var a=Math.min(e,o-t),s=i.height;if(i.removeInner(t,a),n.height-=s-i.height,o==a&&(n.children.splice(r--,1),i.parent=null),0==(e-=a))break;t=0}else t-=o}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof is))){var l=[];this.collapse(l),this.children=[new is(l)],this.children[0].parent=this}},os.prototype.collapse=function(t){for(var e=this,n=0;n<this.children.length;++n)e.children[n].collapse(t)},os.prototype.insertInner=function(t,e,n){var r=this;this.size+=e.length,this.height+=n;for(var i=0;i<this.children.length;++i){var o=r.children[i],a=o.chunkSize();if(t<=a){if(o.insertInner(t,e,n),o.lines&&o.lines.length>50){for(var s=o.lines.length%25+25,l=s;l<o.lines.length;){var u=new is(o.lines.slice(l,l+=25));o.height-=u.height,r.children.splice(++i,0,u),u.parent=r}o.lines=o.lines.slice(0,s),r.maybeSpill()}break}t-=a}},os.prototype.maybeSpill=function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),n=new os(e);if(t.parent){t.size-=n.size,t.height-=n.height;var r=d(t.parent.children,t);t.parent.children.splice(r+1,0,n)}else{var i=new os(t.children);i.parent=t,t.children=[i,n],t=i}n.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},os.prototype.iterN=function(t,e,n){for(var r=this,i=0;i<this.children.length;++i){var o=r.children[i],a=o.chunkSize();if(t<a){var s=Math.min(e,a-t);if(o.iterN(t,s,n))return!0;if(0==(e-=s))break;t=0}else t-=a}};var as=function(t,e,n){var r=this;if(n)for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);this.doc=t,this.node=e};as.prototype.clear=function(){var t=this,e=this.doc.cm,n=this.line.widgets,r=this.line,i=T(r);if(null!=i&&n){for(var o=0;o<n.length;++o)n[o]==t&&n.splice(o--,1);n.length||(r.widgets=null);var a=ze(this);E(r,Math.max(0,r.height-a)),e&&(ur(e,function(){Ti(e,r,-a),fr(e,i,"widget")}),we(e,"lineWidgetCleared",e,this,i))}},as.prototype.changed=function(){var t=this,e=this.height,n=this.doc.cm,r=this.line;this.height=null;var i=ze(this)-e;i&&(E(r,r.height+i),n&&ur(n,function(){n.curOp.forceUpdate=!0,Ti(n,r,i),we(n,"lineWidgetChanged",n,t,T(r))}))},Ot(as);var ss=0,ls=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++ss};ls.prototype.clear=function(){var t=this;if(!this.explicitlyCleared){var e=this.doc.cm,n=e&&!e.curOp;if(n&&er(e),Dt(this,"clear")){var r=this.find();r&&we(this,"clear",r.from,r.to)}for(var i=null,o=null,a=0;a<this.lines.length;++a){var s=t.lines[a],l=U(s.markedSpans,t);e&&!t.collapsed?fr(e,T(s),"text"):e&&(null!=l.to&&(o=T(s)),null!=l.from&&(i=T(s))),s.markedSpans=X(s.markedSpans,l),null==l.from&&t.collapsed&&!gt(t.doc,s)&&e&&E(s,mn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var u=0;u<this.lines.length;++u){var c=ct(t.lines[u]),d=yt(c);d>e.display.maxLineLength&&(e.display.maxLine=c,e.display.maxLineLength=d,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&pr(e,i,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&hi(e.doc)),e&&we(e,"markerCleared",e,this,i,o),n&&nr(e),this.parent&&this.parent.clear()}},ls.prototype.find=function(t,e){var n=this;null==t&&"bookmark"==this.type&&(t=1);for(var r,i,o=0;o<this.lines.length;++o){var a=n.lines[o],s=U(a.markedSpans,n);if(null!=s.from&&(r=N(e?a:T(a),s.from),t==-1))return r;if(null!=s.to&&(i=N(e?a:T(a),s.to),1==t))return i}return r&&{from:r,to:i}},ls.prototype.changed=function(){var t=this,e=this.find(-1,!0),n=this,r=this.doc.cm;e&&r&&ur(r,function(){var i=e.line,o=T(e.line),a=Xe(r,o);if(a&&(en(a),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!gt(n.doc,i)&&null!=n.height){var s=n.height;n.height=null;var l=ze(n)-s;l&&E(i,i.height+l)}we(r,"markerChanged",r,t)})},ls.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&d(e.maybeHiddenMarkers,this)!=-1||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},ls.prototype.detachLine=function(t){if(this.lines.splice(d(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},Ot(ls);var us=function(t,e){var n=this;this.markers=t,this.primary=e;for(var r=0;r<t.length;++r)t[r].parent=n};us.prototype.clear=function(){var t=this;if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)t.markers[e].clear();we(this,"clear")}},us.prototype.find=function(t,e){return this.primary.find(t,e)},Ot(us);var cs=0,ds=function(t,e,n,r){if(!(this instanceof ds))return new ds(t,e,n,r);null==n&&(n=0),os.call(this,[new is([new Ha("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var i=N(n,0);this.sel=Pr(i),this.history=new jr(null),this.id=++cs,this.modeOption=e,this.lineSep=r,this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),Rr(this,{from:i,to:i,text:t}),ui(this,Pr(i),_a)};ds.prototype=y(os.prototype,{constructor:ds,iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var n=0,r=0;r<e.length;++r)n+=e[r].height;this.insertInner(t-this.first,e,n)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=A(this,this.first,this.first+this.size);return t===!1?e:e.join(t||this.lineSeparator())},setValue:hr(function(t){var e=N(this.first,0),n=this.first+this.size-1;bi(this,{from:e,to:N(n,S(this,n).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),ui(this,Pr(e))}),replaceRange:function(t,e,n,r){e=B(this,e),n=n?B(this,n):e,Ci(this,t,e,n,r)},getRange:function(t,e,n){var r=L(this,B(this,t),B(this,e));return n===!1?r:r.join(n||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(D(this,t))return S(this,t)},getLineNumber:function(t){return T(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=S(this,t)),ct(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return B(this,t)},getCursor:function(t){var e,n=this.sel.primary();return e=null==t||"head"==t?n.head:"anchor"==t?n.anchor:"end"==t||"to"==t||t===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:hr(function(t,e,n){ai(this,B(this,"number"==typeof t?N(t,e||0):t),null,n)}),setSelection:hr(function(t,e,n){ai(this,B(this,t),B(this,e||t),n)}),extendSelection:hr(function(t,e,n){ri(this,B(this,t),e&&B(this,e),n)}),extendSelections:hr(function(t,e){ii(this,j(this,t),e)}),extendSelectionsBy:hr(function(t,e){var n=g(this.sel.ranges,t);ii(this,j(this,n),e)}),setSelections:hr(function(t,e,n){var r=this;if(t.length){for(var i=[],o=0;o<t.length;o++)i[o]=new rs(B(r,t[o].anchor),B(r,t[o].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),ui(this,Tr(i,e),n)}}),addSelection:hr(function(t,e,n){var r=this.sel.ranges.slice(0);r.push(new rs(B(this,t),B(this,e||t))),ui(this,Tr(r,r.length-1),n)}),getSelection:function(t){for(var e,n=this,r=this.sel.ranges,i=0;i<r.length;i++){var o=L(n,r[i].from(),r[i].to());e=e?e.concat(o):o}return t===!1?e:e.join(t||this.lineSeparator())},getSelections:function(t){for(var e=this,n=[],r=this.sel.ranges,i=0;i<r.length;i++){var o=L(e,r[i].from(),r[i].to());t!==!1&&(o=o.join(t||e.lineSeparator())),n[i]=o}return n},replaceSelection:function(t,e,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=t;this.replaceSelections(r,e,n||"+input")},replaceSelections:hr(function(t,e,n){for(var r=this,i=[],o=this.sel,a=0;a<o.ranges.length;a++){var s=o.ranges[a];i[a]={from:s.from(),to:s.to(),text:r.splitLines(t[a]),origin:n}}for(var l=e&&"end"!=e&&zr(this,i,e),u=i.length-1;u>=0;u--)bi(r,i[u]);l?li(this,l):this.cm&&Jn(this.cm)}),undo:hr(function(){_i(this,"undo")}),redo:hr(function(){_i(this,"redo")}),undoSelection:hr(function(){_i(this,"undo",!0)}),redoSelection:hr(function(){_i(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,n=0,r=0;r<t.done.length;r++)t.done[r].ranges||++e;for(var i=0;i<t.undone.length;i++)t.undone[i].ranges||++n;return{undo:e,redo:n}},clearHistory:function(){this.history=new jr(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:ei(this.history.done),undone:ei(this.history.undone)}},setHistory:function(t){var e=this.history=new jr(this.history.maxGeneration);e.done=ei(t.done.slice(0),null,!0),e.undone=ei(t.undone.slice(0),null,!0)},setGutterMarker:hr(function(t,e,n){return Ei(this,t,"gutter",function(t){var r=t.gutterMarkers||(t.gutterMarkers={});return r[e]=n,!n&&_(r)&&(t.gutterMarkers=null),!0})}),clearGutter:hr(function(t){var e=this;this.iter(function(n){n.gutterMarkers&&n.gutterMarkers[t]&&Ei(e,n,"gutter",function(){return n.gutterMarkers[t]=null,_(n.gutterMarkers)&&(n.gutterMarkers=null),!0})})}),lineInfo:function(t){var e;if("number"==typeof t){if(!D(this,t))return null;if(e=t,t=S(this,t),!t)return null}else if(e=T(t),null==e)return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:hr(function(e,n,r){return Ei(this,e,"gutter"==n?"gutter":"class",function(e){var i="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(e[i]){if(t(r).test(e[i]))return!1;e[i]+=" "+r}else e[i]=r;return!0})}),removeLineClass:hr(function(e,n,r){return Ei(this,e,"gutter"==n?"gutter":"class",function(e){var i="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass",o=e[i];if(!o)return!1;if(null==r)e[i]=null;else{var a=o.match(t(r));if(!a)return!1;var s=a.index+a[0].length;e[i]=o.slice(0,a.index)+(a.index&&s!=o.length?" ":"")+o.slice(s)||null}return!0})}),addLineWidget:hr(function(t,e,n){return Pi(this,t,e,n)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,n){return Di(this,B(this,t),B(this,e),n,n&&n.type||"range")},setBookmark:function(t,e){var n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return t=B(this,t),Di(this,t,t,n,"bookmark")},findMarksAt:function(t){t=B(this,t);var e=[],n=S(this,t.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=t.ch)&&(null==i.to||i.to>=t.ch)&&e.push(i.marker.parent||i.marker)}return e},findMarks:function(t,e,n){t=B(this,t),e=B(this,e);var r=[],i=t.line;return this.iter(t.line,e.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&i==t.line&&t.ch>=l.to||null==l.from&&i!=t.line||null!=l.from&&i==e.line&&l.from>=e.ch||n&&!n(l.marker)||r.push(l.marker.parent||l.marker)}++i}),r},getAllMarks:function(){var t=[];return this.iter(function(e){var n=e.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&t.push(n[r].marker)}),t},posFromIndex:function(t){var e,n=this.first,r=this.lineSeparator().length;return this.iter(function(i){var o=i.text.length+r;return o>t?(e=t,!0):(t-=o,void++n)}),B(this,N(n,e))},indexFromPos:function(t){t=B(this,t);var e=t.ch;if(t.line<this.first||t.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,t.line,function(t){e+=t.text.length+n}),e},copy:function(t){var e=new ds(A(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,n=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<n&&(n=t.to);var r=new ds(A(this,e,n),t.mode||this.modeOption,e,this.lineSep);return t.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:t.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],Ii(r,Ni(this)),r},unlinkDoc:function(t){var e=this;if(t instanceof Mo&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=e.linked[n];if(r.doc==t){e.linked.splice(n,1),t.unlinkDoc(e),zi(Ni(e));break}}if(t.history==this.history){var i=[t.id];Br(t,function(t){return i.push(t.id)},!0),t.history=new jr(null),t.history.done=ei(this.history.done,i),t.history.undone=ei(this.history.undone,i)}},iterLinkedDocs:function(t){Br(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):Na(t)},lineSeparator:function(){return this.lineSep||"\n"}}),ds.prototype.eachLine=ds.prototype.iter;for(var hs=0,ps=!1,fs={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},gs=0;gs<10;gs++)fs[gs+48]=fs[gs+96]=String(gs);for(var vs=65;vs<=90;vs++)fs[vs]=String.fromCharCode(vs);for(var ms=1;ms<=12;ms++)fs[ms+111]=fs[ms+63235]="F"+ms;var ys={};ys.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ys.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ys.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ys.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ys.default=sa?ys.macDefault:ys.pcDefault;var bs,xs,_s={selectAll:mi,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),_a)},killLine:function(t){return Zi(t,function(e){if(e.empty()){var n=S(t.doc,e.head.line).text.length;return e.head.ch==n&&e.head.line<t.lastLine()?{from:e.head,to:N(e.head.line+1,0)}:{from:e.head,to:N(e.head.line,n)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return Zi(t,function(e){return{from:N(e.from().line,0),to:B(t.doc,N(e.to().line+1,0))}})},delLineLeft:function(t){return Zi(t,function(t){return{from:N(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){return Zi(t,function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:n},"div");return{from:r,to:e.from()}})},delWrappedLineRight:function(t){return Zi(t,function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div");return{from:e.from(),to:r}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(N(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(N(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Qi(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return to(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return Ji(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div")},ka)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:n},"div")},ka)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:n},"div");return r.ch<t.getLine(r.line).search(/\S/)?to(t,e.head):r},ka)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"char")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],n=t.listSelections(),r=t.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),a=c(t.getLine(o.line),o.ch,r);e.push(p(r-a%r))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return ur(t,function(){for(var e=t.listSelections(),n=[],r=0;r<e.length;r++)if(e[r].empty()){var i=e[r].head,o=S(t.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new N(i.line,i.ch-1)),i.ch>0)i=new N(i.line,i.ch+1),t.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),N(i.line,i.ch-2),i,"+transpose");else if(i.line>t.doc.first){var a=S(t.doc,i.line-1).text;a&&(i=new N(i.line,1),t.replaceRange(o.charAt(0)+t.doc.lineSeparator()+a.charAt(a.length-1),N(i.line-1,a.length-1),i,"+transpose"))}n.push(new rs(i,i))}t.setSelections(n)})},newlineAndIndent:function(t){return ur(t,function(){for(var e=t.listSelections(),n=e.length-1;n>=0;n--)t.replaceRange(t.doc.lineSeparator(),e[n].anchor,e[n].head,"+input");e=t.listSelections();for(var r=0;r<e.length;r++)t.indentLine(e[r].from().line,null,!0);Jn(t)})},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}},ws=new va,ks=null,Ms={toString:function(){return"CodeMirror.Init"}},Cs={},Ss={};Mo.defaults=Cs,Mo.optionHandlers=Ss;var Ls=[];Mo.defineInitHook=function(t){return Ls.push(t)};var As=null,Es=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new va,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};Es.prototype.init=function(t){function e(t){if(!Tt(i,t)){if(i.somethingSelected())Lo({lineWise:!1,text:i.getSelections()}),"cut"==t.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var e=Po(i);Lo({lineWise:!0,text:e.text}),"cut"==t.type&&i.operation(function(){i.setSelections(e.ranges,0,_a),i.replaceSelection("",null,"cut")})}if(t.clipboardData){t.clipboardData.clearData();var n=As.text.join("\n");if(t.clipboardData.setData("Text",n),t.clipboardData.getData("Text")==n)return void t.preventDefault()}var a=Oo(),s=a.firstChild;i.display.lineSpace.insertBefore(a,i.display.lineSpace.firstChild),s.value=As.text.join("\n");var l=document.activeElement;ga(s),setTimeout(function(){i.display.lineSpace.removeChild(a),
l.focus(),l==o&&r.showPrimarySelection()},50)}}var n=this,r=this,i=r.cm,o=r.div=t.lineDiv;Do(o,i.options.spellcheck),Da(o,"paste",function(t){Tt(i,t)||Eo(t,i)||Zo<=11&&setTimeout(cr(i,function(){r.pollContent()||pr(i)}),20)}),Da(o,"compositionstart",function(t){n.composing={data:t.data,done:!1}}),Da(o,"compositionupdate",function(t){n.composing||(n.composing={data:t.data,done:!1})}),Da(o,"compositionend",function(t){n.composing&&(t.data!=n.composing.data&&n.readFromDOMSoon(),n.composing.done=!0)}),Da(o,"touchstart",function(){return r.forceCompositionEnd()}),Da(o,"input",function(){n.composing||n.readFromDOMSoon()}),Da(o,"copy",e),Da(o,"cut",e)},Es.prototype.prepareSelection=function(){var t=Sn(this.cm,!1);return t.focus=this.cm.state.focused,t},Es.prototype.showSelection=function(t,e){t&&this.cm.display.view.length&&((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},Es.prototype.showPrimarySelection=function(){var t=window.getSelection(),e=this.cm.doc.sel.primary(),n=Ro(this.cm,t.anchorNode,t.anchorOffset),r=Ro(this.cm,t.focusNode,t.focusOffset);if(!n||n.bad||!r||r.bad||0!=I(F(n,r),e.from())||0!=I(W(n,r),e.to())){var i=Go(this.cm,e.from()),o=Go(this.cm,e.to());if(i||o){var a=this.cm.display.view,s=t.rangeCount&&t.getRangeAt(0);if(i){if(!o){var l=a[a.length-1].measure,u=l.maps?l.maps[l.maps.length-1]:l.map;o={node:u[u.length-1],offset:u[u.length-2]-u[u.length-3]}}}else i={node:a[0].measure.map[2],offset:0};var c;try{c=da(i.node,i.offset,o.offset,o.node)}catch(t){}c&&(!qo&&this.cm.state.focused?(t.collapse(i.node,i.offset),c.collapsed||(t.removeAllRanges(),t.addRange(c))):(t.removeAllRanges(),t.addRange(c)),s&&null==t.anchorNode?t.addRange(s):qo&&this.startGracePeriod()),this.rememberSelection()}}},Es.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},Es.prototype.showMultipleSelections=function(t){n(this.cm.display.cursorDiv,t.cursors),n(this.cm.display.selectionDiv,t.selection)},Es.prototype.rememberSelection=function(){var t=window.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},Es.prototype.selectionInEditor=function(){var t=window.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return i(this.div,e)},Es.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Es.prototype.blur=function(){this.div.blur()},Es.prototype.getField=function(){return this.div},Es.prototype.supportsTouch=function(){return!0},Es.prototype.receivedFocus=function(){function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}var e=this;this.selectionInEditor()?this.pollSelection():ur(this.cm,function(){return e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,t)},Es.prototype.selectionChanged=function(){var t=window.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},Es.prototype.pollSelection=function(){if(!this.composing&&null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=window.getSelection(),e=this.cm;this.rememberSelection();var n=Ro(e,t.anchorNode,t.anchorOffset),r=Ro(e,t.focusNode,t.focusOffset);n&&r&&ur(e,function(){ui(e.doc,Pr(n,r),_a),(n.bad||r.bad)&&(e.curOp.selectionChanged=!0)})}},Es.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t=this.cm,e=t.display,n=t.doc.sel.primary(),r=n.from(),i=n.to();if(0==r.ch&&r.line>t.firstLine()&&(r=N(r.line-1,S(t.doc,r.line-1).length)),i.ch==S(t.doc,i.line).text.length&&i.line<t.lastLine()&&(i=N(i.line+1,0)),r.line<e.viewFrom||i.line>e.viewTo-1)return!1;var o,a,s;r.line==e.viewFrom||0==(o=Mn(t,r.line))?(a=T(e.view[0].line),s=e.view[0].node):(a=T(e.view[o].line),s=e.view[o-1].node.nextSibling);var l,u,c=Mn(t,i.line);if(c==e.view.length-1?(l=e.viewTo-1,u=e.lineDiv.lastChild):(l=T(e.view[c+1].line)-1,u=e.view[c+1].node.previousSibling),!s)return!1;for(var d=t.doc.splitLines(Fo(t,s,u,a,l)),h=L(t.doc,N(a,0),N(l,S(t.doc,l).text.length));d.length>1&&h.length>1;)if(f(d)==f(h))d.pop(),h.pop(),l--;else{if(d[0]!=h[0])break;d.shift(),h.shift(),a++}for(var p=0,g=0,v=d[0],m=h[0],y=Math.min(v.length,m.length);p<y&&v.charCodeAt(p)==m.charCodeAt(p);)++p;for(var b=f(d),x=f(h),_=Math.min(b.length-(1==d.length?p:0),x.length-(1==h.length?p:0));g<_&&b.charCodeAt(b.length-g-1)==x.charCodeAt(x.length-g-1);)++g;d[d.length-1]=b.slice(0,b.length-g).replace(/^\u200b+/,""),d[0]=d[0].slice(p).replace(/\u200b+$/,"");var w=N(a,p),k=N(l,h.length?f(h).length-g:0);return d.length>1||d[0]||I(w,k)?(Ci(t.doc,d,w,k,"+input"),!0):void 0},Es.prototype.ensurePolled=function(){this.forceCompositionEnd()},Es.prototype.reset=function(){this.forceCompositionEnd()},Es.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.pollContent()||pr(this.cm),this.div.blur(),this.div.focus())},Es.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}!t.cm.isReadOnly()&&t.pollContent()||ur(t.cm,function(){return pr(t.cm)})},80))},Es.prototype.setUneditable=function(t){t.contentEditable="false"},Es.prototype.onKeyPress=function(t){0!=t.charCode&&(t.preventDefault(),this.cm.isReadOnly()||cr(this.cm,Ao)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},Es.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},Es.prototype.onContextMenu=function(){},Es.prototype.resetPosition=function(){},Es.prototype.needsContentAttribute=!0;var Ts=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new va,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null};Ts.prototype.init=function(t){function e(t){if(!Tt(i,t)){if(i.somethingSelected())Lo({lineWise:!1,text:i.getSelections()}),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,a.value=As.text.join("\n"),ga(a));else{if(!i.options.lineWiseCopyCut)return;var e=Po(i);Lo({lineWise:!0,text:e.text}),"cut"==t.type?i.setSelections(e.ranges,null,_a):(r.prevInput="",a.value=e.text.join("\n"),ga(a))}"cut"==t.type&&(i.state.cutIncoming=!0)}}var n=this,r=this,i=this.cm,o=this.wrapper=Oo(),a=this.textarea=o.firstChild;t.wrapper.insertBefore(o,t.wrapper.firstChild),oa&&(a.style.width="0px"),Da(a,"input",function(){Ko&&Zo>=9&&n.hasSelection&&(n.hasSelection=null),r.poll()}),Da(a,"paste",function(t){Tt(i,t)||Eo(t,i)||(i.state.pasteIncoming=!0,r.fastPoll())}),Da(a,"cut",e),Da(a,"copy",e),Da(t.scroller,"paste",function(e){Ge(t,e)||Tt(i,e)||(i.state.pasteIncoming=!0,r.focus())}),Da(t.lineSpace,"selectstart",function(e){Ge(t,e)||Nt(e)}),Da(a,"compositionstart",function(){var t=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:t,range:i.markText(t,i.getCursor("to"),{className:"CodeMirror-composing"})}}),Da(a,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},Ts.prototype.prepareSelection=function(){var t=this.cm,e=t.display,n=t.doc,r=Sn(t);if(t.options.moveInputWithCursor){var i=cn(t,n.sel.primary().head,"div"),o=e.wrapper.getBoundingClientRect(),a=e.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,i.top+a.top-o.top)),r.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,i.left+a.left-o.left))}return r},Ts.prototype.showSelection=function(t){var e=this.cm,r=e.display;n(r.cursorDiv,t.cursors),n(r.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},Ts.prototype.reset=function(t){if(!this.contextMenuPending){var e,n,r=this.cm,i=r.doc;if(r.somethingSelected()){this.prevInput="";var o=i.sel.primary();e=za&&(o.to().line-o.from().line>100||(n=r.getSelection()).length>1e3);var a=e?"-":n||r.getSelection();this.textarea.value=a,r.state.focused&&ga(this.textarea),Ko&&Zo>=9&&(this.hasSelection=a)}else t||(this.prevInput=this.textarea.value="",Ko&&Zo>=9&&(this.hasSelection=null));this.inaccurateSelection=e}},Ts.prototype.getField=function(){return this.textarea},Ts.prototype.supportsTouch=function(){return!1},Ts.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!aa||o()!=this.textarea))try{this.textarea.focus()}catch(t){}},Ts.prototype.blur=function(){this.textarea.blur()},Ts.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ts.prototype.receivedFocus=function(){this.slowPoll()},Ts.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},Ts.prototype.fastPoll=function(){function t(){var r=n.poll();r||e?(n.pollingFast=!1,n.slowPoll()):(e=!0,n.polling.set(60,t))}var e=!1,n=this;n.pollingFast=!0,n.polling.set(20,t)},Ts.prototype.poll=function(){var t=this,e=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!e.state.focused||Ia(n)&&!r&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var i=n.value;if(i==r&&!e.somethingSelected())return!1;if(Ko&&Zo>=9&&this.hasSelection===i||sa&&/[\uf700-\uf7ff]/.test(i))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||r||(r=""),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var a=0,s=Math.min(r.length,i.length);a<s&&r.charCodeAt(a)==i.charCodeAt(a);)++a;return ur(e,function(){Ao(e,i.slice(a),r.length-a,null,t.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?n.value=t.prevInput="":t.prevInput=i,t.composing&&(t.composing.range.clear(),t.composing.range=e.markText(t.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ts.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ts.prototype.onKeyPress=function(){Ko&&Zo>=9&&(this.hasSelection=null),this.fastPoll()},Ts.prototype.onContextMenu=function(t){function e(){if(null!=a.selectionStart){var t=i.somethingSelected(),e=""+(t?a.value:"");a.value="",a.value=e,r.prevInput=t?"":"",a.selectionStart=1,a.selectionEnd=e.length,o.selForContextMenu=i.doc.sel}}function n(){if(r.contextMenuPending=!1,r.wrapper.style.cssText=d,a.style.cssText=c,Ko&&Zo<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l),null!=a.selectionStart){(!Ko||Ko&&Zo<9)&&e();var t=0,n=function(){o.selForContextMenu==i.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&""==r.prevInput?cr(i,mi)(i):t++<10?o.detectingSelectAll=setTimeout(n,500):(o.selForContextMenu=null,o.input.reset())};o.detectingSelectAll=setTimeout(n,200)}}var r=this,i=r.cm,o=i.display,a=r.textarea,s=kn(i,t),l=o.scroller.scrollTop;if(s&&!ea){var u=i.options.resetSelectionOnContextMenu;u&&i.doc.sel.contains(s)==-1&&cr(i,ui)(i.doc,Pr(s),_a);var c=a.style.cssText,d=r.wrapper.style.cssText;r.wrapper.style.cssText="position: absolute";var h=r.wrapper.getBoundingClientRect();a.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-h.top-5)+"px; left: "+(t.clientX-h.left-5)+"px;\n      z-index: 1000; background: "+(Ko?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var p;if(Qo&&(p=window.scrollY),o.input.focus(),Qo&&window.scrollTo(null,p),o.input.reset(),i.somethingSelected()||(a.value=r.prevInput=" "),r.contextMenuPending=!0,o.selForContextMenu=i.doc.sel,clearTimeout(o.detectingSelectAll),Ko&&Zo>=9&&e(),pa){Gt(t);var f=function(){At(window,"mouseup",f),setTimeout(n,20)};Da(window,"mouseup",f)}else setTimeout(n,50)}},Ts.prototype.readOnlyChanged=function(t){t||this.reset()},Ts.prototype.setUneditable=function(){},Ts.prototype.needsContentAttribute=!1,xo(Mo),No(Mo);var Ps="iter insert remove copy getEditor constructor".split(" ");for(var Ds in ds.prototype)ds.prototype.hasOwnProperty(Ds)&&d(Ps,Ds)<0&&(Mo.prototype[Ds]=function(t){return function(){return t.apply(this.doc,arguments)}}(ds.prototype[Ds]));return Ot(ds),Mo.inputStyles={textarea:Ts,contenteditable:Es},Mo.defineMode=function(t){Mo.defaults.mode||"null"==t||(Mo.defaults.mode=t),jt.apply(this,arguments)},Mo.defineMIME=Vt,Mo.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),Mo.defineMIME("text/plain","null"),Mo.defineExtension=function(t,e){Mo.prototype[t]=e},Mo.defineDocExtension=function(t,e){ds.prototype[t]=e},Mo.fromTextArea=Ho,jo(Mo),Mo.version="5.24.2",Mo}),angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",uiCodemirrorDirective),uiCodemirrorDirective.$inject=["$timeout","uiCodemirrorConfig"],function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){angular.module("nemLogging",[]),angular.module("nemLogging").provider("nemDebug",function(){var e=null;return e=t("debug"),this.$get=function(){return e},this.debug=e,this});var r=function(t,e){return function(){return t.apply(e,arguments)}},i=[].slice;angular.module("nemLogging").provider("nemSimpleLogger",["nemDebugProvider",function(t){var e,n,o,a,s,l,u,c,d,h,p,f;for(p=t.debug,o={},a=["debug","info","warn","error","log"],e={},d=c=0,h=a.length;c<h;d=++c)f=a[d],e[f]=d;return l=function(t,e,n){if(t>=e)return n()},s=function(t){var e,n,r;if(e=!1,!t)return e;for(n=0,r=a.length;n<r&&(f=a[n],e=null!=t[f]&&"function"==typeof t[f],e);n++);return e},u=function(t,e){var n,r,i,s;for(null==o[t]&&(o[t]=p(t)),n=o[t],s={},r=0,i=a.length;r<i;r++)f=a[r],s[f]="debug"===f?n:e[f];return s},n=function(){function t(t){var n,o,u,c,d;if(this.$log=t,this.spawn=r(this.spawn,this),!this.$log)throw"internalLogger undefined";if(!s(this.$log))throw"@$log is invalid";for(this.doLog=!0,d={},n=function(t){return function(n){return d[n]=function(){var r;if(r=1<=arguments.length?i.call(arguments,0):[],t.doLog)return l(e[n],t.currentLevel,function(){var e;return(e=t.$log)[n].apply(e,r)})},t[n]=d[n]}}(this),o=0,u=a.length;o<u;o++)c=a[o],n(c);this.LEVELS=e,this.currentLevel=e.error}return t.prototype.spawn=function(e){if("string"==typeof e){if(!s(this.$log))throw"@$log is invalid";if(!p)throw"nemDebug is undefined this is probably the light version of this library sep debug logggers is not supported!";return u(e,this.$log)}return new t(e||this.$log)},t}(),this.decorator=["$log",function(t){var r;return r=new n(t),r.currentLevel=e.debug,r}],this.$get=["$log",function(t){return new n(t)}],this}])},{debug:2}],2:[function(t,e,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var i=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r),t}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(t){}}function s(){var t;try{t=n.storage.debug}catch(t){}return t}function l(){try{return window.localStorage}catch(t){}}n=e.exports=t("./debug"),n.log=o,n.formatArgs=i,n.save=a,n.load=s,n.useColors=r,n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:l(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(t){return JSON.stringify(t)},n.enable(s())},{"./debug":3}],3:[function(t,e,n){function r(){return n.colors[c++%n.colors.length]}function i(t){function e(){}function i(){var t=i,e=+new Date,o=e-(u||e);t.diff=o,t.prev=u,t.curr=e,u=e,null==t.useColors&&(t.useColors=n.useColors()),null==t.color&&t.useColors&&(t.color=r());var a=Array.prototype.slice.call(arguments);a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;s++;var i=n.formatters[r];if("function"==typeof i){var o=a[s];e=i.call(t,o),a.splice(s,1),s--}return e}),"function"==typeof n.formatArgs&&(a=n.formatArgs.apply(t,a));var l=i.log||n.log||console.log.bind(console);l.apply(t,a)}e.enabled=!1,i.enabled=!0;var o=n.enabled(t)?i:e;return o.namespace=t,o}function o(t){n.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,i=0;i<r;i++)e[i]&&(t=e[i].replace(/\*/g,".*?"),"-"===t[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")))}function a(){n.enable("")}function s(t){var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1}function l(t){return t instanceof Error?t.stack||t.message:t}n=e.exports=i,n.coerce=l,n.disable=a,n.enable=o,n.enabled=s,n.humanize=t("ms"),n.names=[],n.skips=[],n.formatters={};var u,c=0},{ms:4}],4:[function(t,e,n){function r(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*l;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function i(t){return t>=c?Math.round(t/c)+"d":t>=u?Math.round(t/u)+"h":t>=l?Math.round(t/l)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function o(t){return a(t,c,"day")||a(t,u,"hour")||a(t,l,"minute")||a(t,s,"second")||t+" ms"}function a(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var s=1e3,l=60*s,u=60*l,c=24*u,d=365.25*c;e.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e.long?o(t):i(t)}},{}]},{},[1]),function(t,e,n){"use strict";(function(){e.module("uiGmapgoogle-maps.providers",["nemLogging"]),e.module("uiGmapgoogle-maps.wrapped",[]),e.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),e.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),e.module("uiGmapgoogle-maps.directives.api.managers",[]),e.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),e.module("uiGmapgoogle-maps.directives.api.options.builders",[]),e.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),e.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),e.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),e.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),function(){e.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function(n,r){var i,o,a,s,l;return s=void 0,l=void 0,i=function(t){return t.china?"http://maps.google.cn/maps/api/js?":"auto"===t.transport?"//maps.googleapis.com/maps/api/js?":t.transport+"://maps.googleapis.com/maps/api/js?"},o=function(t){var e,n,o,a;return e=["transport","isGoogleMapsForWork","china","preventLoad"],t.isGoogleMapsForWork&&e.push("key"),n=_.map(_.omit(t,e),function(t,e){return e+"="+t}),s&&(a=document.getElementById(s),a.parentNode.removeChild(a)),n=n.join("&"),o=document.createElement("script"),o.id=s="ui_gmap_map_load_"+r.generate(),o.type="text/javascript",o.src=i(t)+n,document.body.appendChild(o)},a=function(){return e.isDefined(t.google)&&e.isDefined(t.google.maps)},{load:function(e){var r,i;return r=n.defer(),a()?(r.resolve(t.google.maps),r.promise):(i=e.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),t[i]=function(){t[i]=null,r.resolve(t.google.maps)},t.navigator.connection&&t.Connection&&t.navigator.connection.type===t.Connection.NONE&&!e.preventLoad?document.addEventListener("online",function(){if(!a())return o(e)}):e.preventLoad||o(e),l=e,l.randomizedFunctionName=i,r.promise)},manualLoad:function(){var e;return e=l,a()?t[e.randomizedFunctionName]?t[e.randomizedFunctionName]():void 0:o(e)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",preventLoad:!1},this.configure=function(t){e.extend(this.options,t)},this.$get=["uiGmapMapScriptLoader",function(t){return function(e){return e.load(t.options)}}(this)],this}).service("uiGmapGoogleMapApiManualLoader",["uiGmapMapScriptLoader",function(t){return{load:function(){t.manualLoad()}}}])}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;e.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendGWin",function(){return{init:_.once(function(){var e;if(google||("undefined"!=typeof google&&null!==google?google.maps:void 0)||null!=google.maps.InfoWindow)return google.maps.InfoWindow.prototype._open=google.maps.InfoWindow.prototype.open,google.maps.InfoWindow.prototype._close=google.maps.InfoWindow.prototype.close,google.maps.InfoWindow.prototype._isOpen=!1,google.maps.InfoWindow.prototype.open=function(t,e,n){null==n&&(this._isOpen=!0,this._open(t,e,!0))},google.maps.InfoWindow.prototype.close=function(t){null==t&&(this._isOpen=!1,this._close(!0))},google.maps.InfoWindow.prototype.isOpen=function(t){return null==t&&(t=void 0),null==t?this._isOpen:this._isOpen=t},t.InfoBox&&(t.InfoBox.prototype._open=t.InfoBox.prototype.open,t.InfoBox.prototype._close=t.InfoBox.prototype.close,t.InfoBox.prototype._isOpen=!1,t.InfoBox.prototype.open=function(t,e){this._isOpen=!0,this._open(t,e)},t.InfoBox.prototype.close=function(){this._isOpen=!1,this._close()},t.InfoBox.prototype.isOpen=function(t){return null==t&&(t=void 0),null==t?this._isOpen:this._isOpen=t},e=function(e){function i(e){this.getOrigCloseBoxImg_=n(this.getOrigCloseBoxImg_,this),this.getCloseBoxDiv_=n(this.getCloseBoxDiv_,this);var r;r=new t.InfoBox(e),_.extend(this,r),null!=e.closeBoxDiv&&(this.closeBoxDiv_=e.closeBoxDiv)}return r(i,e),i.prototype.getCloseBoxDiv_=function(){return this.closeBoxDiv_},i.prototype.getCloseBoxImg_=function(){var t,e;return t=this.getCloseBoxDiv_(),e=this.getOrigCloseBoxImg_(),t||e},i.prototype.getOrigCloseBoxImg_=function(){var t;return t="",""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},i}(t.InfoBox),t.uiGmapInfoBox=e),t.MarkerLabel_?t.MarkerLabel_.prototype.setContent=function(){var t;t=this.marker_.get("labelContent"),t&&!_.isEqual(this.oldContent,t)&&("undefined"==typeof(null!=t?t.nodeType:void 0)?(this.labelDiv_.innerHTML=t,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML,this.oldContent=t):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(t),t=t.cloneNode(!0),this.labelDiv_.innerHTML="",this.eventDiv_.appendChild(t),this.oldContent=t))}:void 0})}})}.call(this),function(){e.module("uiGmapgoogle-maps.extensions").service("uiGmapLodash",function(){var t,e,n,r,i,o,a,s;return o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,i=/\\(\\)?/g,n=function(t){var e,n,r;if(n=t.missingName,r=t.swapName,e=t.isProto,null==_[n]&&(_[n]=_[r],e))return _.prototype[n]=_[r]},[{missingName:"contains",swapName:"includes",isProto:!0},{missingName:"includes",swapName:"contains",isProto:!0},{missingName:"object",swapName:"zipObject"},{missingName:"zipObject",swapName:"object"},{missingName:"all",swapName:"every"},{missingName:"every",swapName:"all"},{missingName:"any",swapName:"some"},{missingName:"some",swapName:"any"},{missingName:"first",swapName:"head"},{missingName:"head",swapName:"first"}].forEach(function(t){return n(t)}),null==_.get&&(a=function(t){return _.isObject(t)?t:Object(t)},e=function(t){return null===t?"":t+""},s=function(t){var n;return _.isArray(t)?t:(n=[],e(t).replace(o,function(t,e,r,o){n.push(r?o.replace(i,"$1"):e||t)}),n)},t=function(t,e,n){var r,i;if(null!==t){void 0!==n&&n in a(t)&&(e=[n]),r=0,i=e.length;for(;!_.isUndefined(t)&&r<i;)t=t[e[r++]];return r&&r===i?t:void 0}},r=function(e,n,r){var i;return i=null===e?void 0:t(e,s(n),n+""),void 0===i?r:i},_.get=r),this.intersectionObjects=function(t,e,n){var r;return null==n&&(n=void 0),r=_.map(t,function(t){return _.find(e,function(e){return null!=n?n(t,e):_.isEqual(t,e)})}),_.filter(r,function(t){return null!=t})},this.containsObject=_.includeObject=function(t,e,n){return null==n&&(n=void 0),null!==t&&_.some(t,function(t){return null!=n?n(t,e):_.isEqual(t,e)})},this.differenceObjects=function(t,e,n){return null==n&&(n=void 0),_.filter(t,function(t){return function(r){return!t.containsObject(e,r,n)}}(this))},this.withoutObjects=this.differenceObjects,this.indexOfObject=function(t,e,n,r){var i,o;if(null==t)return-1;if(i=0,o=t.length,r){if("number"!=typeof r)return i=_.sortedIndex(t,e),t[i]===e?i:-1;i=r<0?Math.max(0,o+r):r}for(;i<o;){if(null!=n){if(n(t[i],e))return i}else if(_.isEqual(t[i],e))return i;i++}return-1},this.isNullOrUndefined=function(t){return _.isNull(t||_.isUndefined(t))},this})}.call(this),function(){e.module("uiGmapgoogle-maps.extensions").factory("uiGmapString",function(){return function(t){return this.contains=function(e,n){return t.indexOf(e,n)!==-1},this}})}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmap_sync",[function(){return{fakePromise:function(){var t;return t=void 0,{then:function(e){return t=e},resolve:function(){return t.apply(void 0,arguments)}}}}}]).service("uiGmap_async",["$timeout","uiGmapPromise","uiGmapLogger","$q","uiGmapDataStructures","uiGmapGmapUtil",function(t,n,r,i,o,a){var s,l,u,c,d,h,p,f,g,v,m,y,b,x,w,k,M,C,S,L;return S=n.promiseTypes,y=n.isInProgress,C=n.promiseStatus,s=n.ExposedPromise,u=n.SniffedPromise,b=function(t,e){var n;return n=t.promise(),n.promiseType=t.promiseType,n.$$state&&r.debug("promiseType: "+n.promiseType+", state: "+C(n.$$state.status)),n.cancelCb=e,n},f=function(t,e){return t.promiseType===S.create&&e.promiseType!==S.delete&&e.promiseType!==S.init&&(r.debug("lastPromise.promiseType "+e.promiseType+", newPromiseType: "+t.promiseType+", SKIPPED MUST COME AFTER DELETE ONLY"),!0)},M=function(t,e,n){var i;if(e.promiseType===S.delete&&n.promiseType!==S.delete&&null!=n.cancelCb&&_.isFunction(n.cancelCb)&&y(n)&&(r.debug("promiseType: "+e.promiseType+", CANCELING LAST PROMISE type: "+n.promiseType),n.cancelCb("cancel safe"),i=t.peek(),null!=i&&y(i)))return i.hasOwnProperty("cancelCb")&&_.isFunction(i.cancelCb)?(r.debug("promiseType: "+i.promiseType+", CANCELING FIRST PROMISE type: "+i.promiseType),i.cancelCb("cancel safe")):r.warn("first promise was not cancelable")},l=function(t,e,n){var r,i;if(t.existingPieces){if(r=_.last(t.existingPieces._content),f(e,r))return;return M(t.existingPieces,e,r),i=s(r.finally(function(){return b(e,n)})),i.cancelCb=n,i.promiseType=e.promiseType,t.existingPieces.enqueue(i),r.finally(function(){return t.existingPieces.dequeue()})}return t.existingPieces=new o.Queue,t.existingPieces.enqueue(b(e,n))},w=function(t,e,n,i,o){var a;return null==n&&(n=""),a=function(t){if(r.debug(t+": "+t),null!=i&&_.isFunction(i))return i(t)},l(t,u(o,e),a)},h=80,v={value:null},L=function(t,e,n){var r;try{return t.apply(e,n)}catch(t){return r=t,v.value=r,v}},x=function(t,e,n,i){var o,a;return a=L(t,e,i),a===v&&(o="error within chunking iterator: "+v.value,r.error(o),n.reject(o)),"cancel safe"!==a},c=function(t,e,n){var r,i;return r=t===e,i=e[n],r?i:t[i]},d=["length","forEach","map"],m=function(t,n,r,i){var o,a,s;if(e.isArray(t))o=t;else if(n)o=n;else{o=[];for(a in t)s=t[a],t.hasOwnProperty(a)&&!_.includes(d,a)&&o.push(a)}return null==i&&(i=r),e.isArray(o)&&!(null!=o?o.length:void 0)&&i!==r?r():i(o,n)},p=function(n,r,i,o,a,s,l,u){return m(n,u,function(u,d){var h,f,g,v;for(h=r&&r<u.length?r:u.length,f=l,g=!0;g&&h--&&f<(u?u.length:f+1);)v=c(n,u,f),g=!!e.isFunction(v)||x(o,void 0,s,[v,f]),++f;if(u){if(!(g&&f<u.length))return s.resolve();if(l=f,r)return null!=a&&_.isFunction(a)&&x(a,void 0,s,[]),t(function(){return p(n,r,i,o,a,s,l,d)},i,!1)}})},g=function(t,e,i,o,a,s,l){var u,c,d;return null==i&&(i=h),null==a&&(a=0),null==s&&(s=1),d=void 0,c=n.defer(),d=c.promise,s?m(t,l,function(){return c.resolve(),d},function(n,r){return p(t,i,s,e,o,c,a,r),d}):(u="pause (delay) must be set from _async!",r.error(u),c.reject(u),d)},k=function(t,e,r,i,o,a,s){var l;return l=[],m(t,s,function(){return n.resolve(l)},function(n,s){return g(t,function(t){return l.push(e(t))},r,i,o,a,s).then(function(){return l})})},{each:g,map:k,managePromiseQueue:w,promiseLock:w,defaultChunkSize:h,getArrayAndKeys:m,chunkSizeFrom:function(t,e){return null==e&&(e=void 0),_.isNumber(t)&&(e=t),(a.isFalse(t)||t===!1)&&(e=!1),e}}}])}.call(this),function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapBaseObject",function(){var e,n;return n=["extended","included"],e=function(){function e(){}return e.extend=function(e){var r,i,o;for(r in e)o=e[r],t.call(n,r)<0&&(this[r]=o);return null!=(i=e.extended)&&i.apply(this),this},e.include=function(e){var r,i,o;for(r in e)o=e[r],t.call(n,r)<0&&(this.prototype[r]=o);return null!=(i=e.included)&&i.apply(this),this},e}()})}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChildEvents",function(){return{onChildCreation:function(t){}}})}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapCtrlHandle",["$q",function(t){var e;return e={handle:function(n,r){return n.$on("$destroy",function(){return e.handle(n)}),n.deferred=t.defer(),{getScope:function(){return n}}},mapPromise:function(t,e){var n;return n=e.getScope(),n.deferred.promise.then(function(e){return t.map=e}),n.deferred.promise}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function(t){var n,r;return r=function(t){return e.isDefined(t.events)&&null!=t.events&&e.isObject(t.events)},n=function(t,e){return r(t)?t:r(e)?e:void 0},{setEvents:function(t,r,i,o){var a;if(a=n(r,i),null!=a)return _.compact(_.map(a.events,function(n,s){var l;if(o&&(l=_(o).includes(s)),a.events.hasOwnProperty(s)&&e.isFunction(a.events[s])&&!l)return google.maps.event.addListener(t,s,function(){return r.$evalAsync||(r.$evalAsync=function(){}),r.$evalAsync(n.apply(r,[t,s,i,arguments]))})}))},removeEvents:function(t){
var e,n;if(t)for(e in t)n=t[e],n&&t.hasOwnProperty(e)&&google.maps.event.removeListener(n)}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapFitHelper",["uiGmapLogger",function(t){return{fit:function(t,e){var n,r,i,o,a;if(e&&(null!=t?t.length:void 0)){n=new google.maps.LatLngBounds,r=!1;for(i in t)o=t[i],o&&(r||(r=!0),a=_.isFunction(o.getPosition)?o.getPosition():o),n.extend(a);if(r)return e.fitBounds(n)}}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(t,n){var r,i,o,a,s,l;return i=function(t,e,n){return t===e||n.indexOf(t)!==-1},r=function(t){return i(t,!1,["false","FALSE",0,"n","N","no","NO"])},a=function(t){return Array.isArray(t)&&2===t.length?t[1]:e.isDefined(t.type)&&"Point"===t.type?t.coordinates[1]:t.latitude},s=function(t){return Array.isArray(t)&&2===t.length?t[0]:e.isDefined(t.type)&&"Point"===t.type?t.coordinates[0]:t.longitude},o=function(t){if(t)return Array.isArray(t)&&2===t.length?new google.maps.LatLng(t[1],t[0]):e.isDefined(t.type)&&"Point"===t.type?new google.maps.LatLng(t.coordinates[1],t.coordinates[0]):new google.maps.LatLng(t.latitude,t.longitude)},l=function(t){if(e.isUndefined(t))return!1;if(_.isArray(t)){if(2===t.length)return!0}else if(null!=t&&(null!=t?t.type:void 0)&&"Point"===t.type&&_.isArray(t.coordinates)&&2===t.coordinates.length)return!0;return!(!t||!e.isDefined((null!=t?t.latitude:void 0)&&e.isDefined(null!=t?t.longitude:void 0)))},{setCoordsFromEvent:function(t,n){if(t)return Array.isArray(t)&&2===t.length?(t[1]=n.lat(),t[0]=n.lng()):e.isDefined(t.type)&&"Point"===t.type?(t.coordinates[1]=n.lat(),t.coordinates[0]=n.lng()):(t.latitude=n.lat(),t.longitude=n.lng()),t},getLabelPositionPoint:function(t){var e,n;if(void 0!==t)return t=/^([-\d\.]+)\s([-\d\.]+)$/.exec(t),e=parseFloat(t[1]),n=parseFloat(t[2]),null!=e&&null!=n?new google.maps.Point(e,n):void 0},createWindowOptions:function(r,i,a,s){var l;return null!=a&&null!=s&&null!=n?(l=e.extend({},s,{content:this.buildContent(i,s,a),position:null!=s.position?s.position:e.isObject(r)?r.getPosition():o(i.coords)}),null!=r&&null==(null!=l?l.pixelOffset:void 0)&&(null==l.boxClass||(l.pixelOffset={height:0,width:-2})),l):s?s:(t.error("infoWindow defaults not defined"),a?void 0:t.error("infoWindow content not defined"))},buildContent:function(t,e,r){var i,o;return null!=e.content?o=e.content:null!=n?(r=r.replace(/^\s+|\s+$/g,""),i=""===r?"":n(r)(t),i.length>0&&(o=i[0])):o=r,o},defaultDelay:50,isTrue:function(t){return i(t,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:r,isFalsy:function(t){return i(t,!1,[void 0,null])||r(t)},getCoords:o,validateCoords:l,equalCoords:function(t,e){return a(t)===a(e)&&s(t)===s(e)},validatePath:function(t){var n,r,i,o;if(r=0,e.isUndefined(t.type)){if(!Array.isArray(t)||t.length<2)return!1;for(;r<t.length;){if(!(e.isDefined(t[r].latitude)&&e.isDefined(t[r].longitude)||"function"==typeof t[r].lat&&"function"==typeof t[r].lng))return!1;r++}return!0}if(e.isUndefined(t.coordinates))return!1;if("Polygon"===t.type){if(t.coordinates[0].length<4)return!1;n=t.coordinates[0]}else if("MultiPolygon"===t.type){if(o={max:0,index:0},_.forEach(t.coordinates,function(t,e){if(t[0].length>this.max)return this.max=t[0].length,this.index=e},o),i=t.coordinates[o.index],n=i[0],n.length<4)return!1}else{if("LineString"!==t.type)return!1;if(t.coordinates.length<2)return!1;n=t.coordinates}for(;r<n.length;){if(2!==n[r].length)return!1;r++}return!0},convertPathPoints:function(t){var n,r,i,o,a;if(r=0,o=new google.maps.MVCArray,e.isUndefined(t.type))for(;r<t.length;)e.isDefined(t[r].latitude)&&e.isDefined(t[r].longitude)?i=new google.maps.LatLng(t[r].latitude,t[r].longitude):"function"==typeof t[r].lat&&"function"==typeof t[r].lng&&(i=t[r]),o.push(i),r++;else for("Polygon"===t.type?n=t.coordinates[0]:"MultiPolygon"===t.type?(a={max:0,index:0},_.forEach(t.coordinates,function(t,e){if(t[0].length>this.max)return this.max=t[0].length,this.index=e},a),n=t.coordinates[a.index][0]):"LineString"===t.type&&(n=t.coordinates);r<n.length;)o.push(new google.maps.LatLng(n[r][1],n[r][0])),r++;return o},getPath:function(t,e){var n;return null!=e&&_.isString(e)?(n=t,_.each(e.split("."),function(t){if(n)return n=n[t]}),n):e},validateBoundPoints:function(t){return!(e.isUndefined(t.sw.latitude)||e.isUndefined(t.sw.longitude)||e.isUndefined(t.ne.latitude)||e.isUndefined(t.ne.longitude))},convertBoundPoints:function(t){var e;return e=new google.maps.LatLngBounds(new google.maps.LatLng(t.sw.latitude,t.sw.longitude),new google.maps.LatLng(t.ne.latitude,t.ne.longitude))},fitMapBounds:function(t,e){return t.fitBounds(e)}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapIsReady",["$q","$timeout",function(t,e){var n,r,i,o;return r=0,o=[],i=function(){return t.all(o)},n=function(t,o,a){return e(function(){return a<=0?void t.reject("Your maps are not found we have checked the maximum amount of times. :)"):void(r!==o?n(t,o,a-1):t.resolve(i()))},100)},{spawn:function(){var e;return e=t.defer(),o.push(e.promise),r+=1,{instance:r,deferred:e}},promises:i,instances:function(){return r},promise:function(e,r){var i;return null==e&&(e=1),null==r&&(r=50),i=t.defer(),n(i,e,r),i.promise},reset:function(){r=0,o.length=0},decrement:function(){r>0&&(r-=1),o.length&&(o.length-=1)}}}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapLinked",["uiGmapBaseObject",function(e){var n;return n=function(e){function n(t,e,n,r){this.scope=t,this.element=e,this.attrs=n,this.ctrls=r}return t(n,e),n}(e)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["nemSimpleLogger",function(t){return t.spawn()}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelKey",["uiGmapBaseObject","uiGmapGmapUtil",function(r,i){return function(r){function o(e,n){this.scope=e,this.interface=null!=n?n:{scopeKeys:[]},this.modelsLength=t(this.modelsLength,this),this.updateChild=t(this.updateChild,this),this.destroy=t(this.destroy,this),this.setChildScope=t(this.setChildScope,this),this.getChanges=t(this.getChanges,this),this.getProp=t(this.getProp,this),this.setIdKey=t(this.setIdKey,this),this.modelKeyComparison=t(this.modelKeyComparison,this),o.__super__.constructor.call(this),this.defaultIdKey="id",this.idKey=void 0}return n(o,r),o.prototype.evalModelHandle=function(t,e){if(null!=t&&null!=e)return"self"===e?t:(_.isFunction(e)&&(e=e()),i.getPath(t,e))},o.prototype.modelKeyComparison=function(t,e){var n,r,o,a,s,l;if(o=this.interface.scopeKeys.indexOf("coords")>=0,(o&&null!=this.scope.coords||!o)&&(s=this.scope),null==s)throw"No scope set!";return o&&(n=this.scopeOrModelVal("coords",s,t),r=this.scopeOrModelVal("coords",s,e),a=i.equalCoords(n,r),!a)?a:(l=_.without(this.interface.scopeKeys,"coords"),a=_.every(l,function(n){return function(r){return n.scopeOrModelVal(s[r],s,t)===n.scopeOrModelVal(s[r],s,e)}}(this)))},o.prototype.setIdKey=function(t){return this.idKey=null!=t.idKey?t.idKey:this.defaultIdKey},o.prototype.setVal=function(t,e,n){return this.modelOrKey(t,e=n),t},o.prototype.modelOrKey=function(t,e){if(null!=e)return"self"!==e?i.getPath(t,e):t},o.prototype.getProp=function(t,e,n){return this.scopeOrModelVal(t,e,n)},o.prototype.getChanges=function(t,e,n){var r,i,o;n&&(e=_.pick(e,n),t=_.pick(t,n)),i={},o={},r={};for(o in t)e&&e[o]===t[o]||(_.isArray(t[o])?i[o]=t[o]:_.isObject(t[o])?(r=this.getChanges(t[o],e?e[o]:null),_.isEmpty(r)||(i[o]=r)):i[o]=t[o]);return i},o.prototype.scopeOrModelVal=function(t,e,n,r){var i,o,a,s;return null==r&&(r=!1),i=function(t,e,n){return null==n&&(n=!1),n?{isScope:t,value:e}:e},s=_.get(e,t),_.isFunction(s)?i(!0,s(n),r):_.isObject(s)?i(!0,s,r):_.isString(s)?(o=s,a=o?"self"===o?n:_.get(n,o):_.get(n,t),_.isFunction(a)?i(!1,a(),r):i(!1,a,r)):i(!0,s,r)},o.prototype.setChildScope=function(t,e,n){var r,i,o,a;for(i in t)o=t[i],r=this.scopeOrModelVal(o,e,n,!0),null!=(null!=r?r.value:void 0)&&(a=r.value,a!==e[o]&&(e[o]=a));return e.model=n},o.prototype.onDestroy=function(t){},o.prototype.destroy=function(t){var e;return null==t&&(t=!1),null==this.scope||(null!=(e=this.scope)?e.$$destroyed:void 0)||!this.needToManualDestroy&&!t?this.clean():this.scope.$destroy()},o.prototype.updateChild=function(t,e){return null==e[this.idKey]?void this.$log.error("Model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):t.updateModel(e)},o.prototype.modelsLength=function(t){var n,r;return null==t&&(t=void 0),n=0,r=t?t:this.scope.models,null==r?n:n=e.isArray(r)||null!=r.length?r.length:Object.keys(r).length},o}(r)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelsWatcher",["uiGmapLogger","uiGmap_async","$q","uiGmapPromise",function(t,e,n,r){return{didQueueInitPromise:function(t,n){return 0===n.models.length&&(e.promiseLock(t,r.promiseTypes.init,null,null,function(){return r.resolve()}),!0)},figureOutState:function(e,n,r,i,o){var a,s,l,u,c;return a=[],l={},u=[],c=[],n.models.forEach(function(o){var s;return null==o[e]?t.error(" id missing for model #{m.toString()},\ncan not use do comparison/insertion"):(l[o[e]]={},null==r.get(o[e])?a.push(o):(s=r.get(o[e]),i(o,s.clonedModel,n)?void 0:c.push({model:o,child:s})))}),s=r.values(),s.forEach(function(n){var r;return null==n?void t.error("child undefined in ModelsWatcher."):null==n.model?void t.error("child.model undefined in ModelsWatcher."):(r=n.model[e],null==l[r]?u.push(n):void 0)}),{adds:a,removals:u,updates:c}}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapPromise",["$q","$timeout","uiGmapLogger",function(t,e,n){var r,i,o,a,s,l,u,c,d,h,p;return d={create:"create",update:"update",delete:"delete",init:"init"},c={IN_PROGRESS:0,RESOLVED:1,REJECTED:2},p=function(){var t;return t={},t[""+c.IN_PROGRESS]="in-progress",t[""+c.RESOLVED]="resolved",t[""+c.REJECTED]="rejected",t}(),a=function(t){return t.$$state?t.$$state.status===c.IN_PROGRESS:!t.hasOwnProperty("$$v")||void 0},s=function(t){return t.$$state?t.$$state.status===c.RESOLVED:!!t.hasOwnProperty("$$v")||void 0},u=function(t){return p[t]||"done w error"},r=function(e){var n,r,i;return n=t.defer(),r=t.all([e,n.promise]),i=t.defer(),e.then(n.resolve,function(){},function(t){return n.notify(t),i.notify(t)}),r.then(function(t){return i.resolve(t[0]||t[1])},function(t){return i.reject(t)}),i.promise.cancel=function(t){return null==t&&(t="canceled"),n.reject(t)},i.promise.notify=function(t){if(null==t&&(t="cancel safe"),i.notify(t),e.hasOwnProperty("notify"))return e.notify(t)},null!=e.promiseType&&(i.promise.promiseType=e.promiseType),i.promise},i=function(t,e){return{promise:t,promiseType:e}},o=function(){return t.defer()},h=function(){var e;return e=t.defer(),e.resolve.apply(void 0,arguments),e.promise},l=function(r){var i;return _.isFunction(r)?(i=t.defer(),e(function(){var t;return t=r(),i.resolve(t)}),i.promise):void n.error("uiGmapPromise.promise() only accepts functions")},{defer:o,promise:l,resolve:h,promiseTypes:d,isInProgress:a,isResolved:s,promiseStatus:u,ExposedPromise:r,SniffedPromise:i}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropMap",function(){var e;return e=function(){function e(){this.removeAll=t(this.removeAll,this),this.slice=t(this.slice,this),this.push=t(this.push,this),this.keys=t(this.keys,this),this.values=t(this.values,this),this.remove=t(this.remove,this),this.put=t(this.put,this),this.stateChanged=t(this.stateChanged,this),this.get=t(this.get,this),this.length=0,this.dict={},this.didValsStateChange=!1,this.didKeysStateChange=!1,this.allVals=[],this.allKeys=[]}return e.prototype.get=function(t){return this.dict[t]},e.prototype.stateChanged=function(){return this.didValsStateChange=!0,this.didKeysStateChange=!0},e.prototype.put=function(t,e){return null==this.get(t)&&this.length++,this.stateChanged(),this.dict[t]=e},e.prototype.remove=function(t,e){var n;if(null==e&&(e=!1),!e||this.get(t))return n=this.dict[t],delete this.dict[t],this.length--,this.stateChanged(),n},e.prototype.valuesOrKeys=function(t){var e,n;return null==t&&(t="Keys"),this["did"+t+"StateChange"]?(n=[],e=[],_.each(this.dict,function(t,r){return n.push(t),e.push(r)}),this.didKeysStateChange=!1,this.didValsStateChange=!1,this.allVals=n,this.allKeys=e,this["all"+t]):this["all"+t]},e.prototype.values=function(){return this.valuesOrKeys("Vals")},e.prototype.keys=function(){return this.valuesOrKeys()},e.prototype.push=function(t,e){return null==e&&(e="key"),this.put(t[e],t)},e.prototype.slice=function(){return this.keys().map(function(t){return function(e){return t.remove(e)}}(this))},e.prototype.removeAll=function(){return this.slice()},e.prototype.each=function(t){return _.each(this.dict,function(e,n){return t(e)})},e.prototype.map=function(t){return _.map(this.dict,function(e,n){return t(e)})},e}()})}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropertyAction",["uiGmapLogger",function(t){var e;return e=function(t){return this.setIfChange=function(e){return function(n,r){if(!_.isEqual(r,n))return t(e,n)}},this.sic=this.setIfChange,this}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapClustererMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap","uiGmapEventsHelper",function(n,r,i,o){var a;return a=function(){function a(e,r,o,s){null==r&&(r={}),this.opt_options=null!=o?o:{},this.opt_events=s,this.checkSync=t(this.checkSync,this),this.getGMarkers=t(this.getGMarkers,this),this.fit=t(this.fit,this),this.destroy=t(this.destroy,this),this.attachEvents=t(this.attachEvents,this),this.clear=t(this.clear,this),this.draw=t(this.draw,this),this.removeMany=t(this.removeMany,this),this.remove=t(this.remove,this),this.addMany=t(this.addMany,this),this.update=t(this.update,this),this.add=t(this.add,this),this.type=a.type,this.clusterer=new NgMapMarkerClusterer(e,r,this.opt_options),this.propMapGMarkers=new i,this.attachEvents(this.opt_events,"opt_events"),this.clusterer.setIgnoreHidden(!0),this.noDrawOnSingleAddRemoves=!0,n.info(this)}return a.type="ClustererMarkerManager",a.prototype.checkKey=function(t){var e;if(null==t.key)return e="gMarker.key undefined and it is REQUIRED!!",n.error(e)},a.prototype.add=function(t){return this.checkKey(t),this.clusterer.addMarker(t,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.put(t.key,t),this.checkSync()},a.prototype.update=function(t){return this.remove(t),this.add(t)},a.prototype.addMany=function(t){return t.forEach(function(t){return function(e){return t.add(e)}}(this))},a.prototype.remove=function(t){var e;return this.checkKey(t),e=this.propMapGMarkers.get(t.key),e&&(this.clusterer.removeMarker(t,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.remove(t.key)),this.checkSync()},a.prototype.removeMany=function(t){return t.forEach(function(t){return function(e){return t.remove(e)}}(this))},a.prototype.draw=function(){return this.clusterer.repaint()},a.prototype.clear=function(){return this.removeMany(this.getGMarkers()),this.clusterer.repaint()},a.prototype.attachEvents=function(t,r){var i,o,a;if(this.listeners=[],e.isDefined(t)&&null!=t&&e.isObject(t)){a=[];for(o in t)i=t[o],t.hasOwnProperty(o)&&e.isFunction(t[o])?(n.info(r+": Attaching event: "+o+" to clusterer"),a.push(this.listeners.push(google.maps.event.addListener(this.clusterer,o,t[o])))):a.push(void 0);return a}},a.prototype.clearEvents=function(){return o.removeEvents(this.listeners),this.listeners=[]},a.prototype.destroy=function(){return this.clearEvents(),this.clear()},a.prototype.fit=function(){return r.fit(this.getGMarkers(),this.clusterer.getMap())},a.prototype.getGMarkers=function(){return this.clusterer.getMarkers().values()},a.prototype.checkSync=function(){},a}()}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.managers").service("uiGmapGoogleMapObjectManager",[function(){var t,n;return t=[],n=[],{createMapInstance:function(r,i){var o;return o=null,0===t.length?(o=new google.maps.Map(r,i),n.push(o)):(o=t.pop(),e.element(r).append(o.getDiv()),o.setOptions(i),n.push(o)),o},recycleMapInstance:function(e){var r;if(r=n.indexOf(e),r<0)throw new Error("Expected map instance to be a previously used instance");return n.splice(r,1),t.push(e)}}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function(e,n,r){var i;return i=function(){function i(n,o,a){this.getGMarkers=t(this.getGMarkers,this),this.fit=t(this.fit,this),this.handleOptDraw=t(this.handleOptDraw,this),this.clear=t(this.clear,this),this.destroy=t(this.destroy,this),this.draw=t(this.draw,this),this.removeMany=t(this.removeMany,this),this.remove=t(this.remove,this),this.addMany=t(this.addMany,this),this.update=t(this.update,this),this.add=t(this.add,this),this.type=i.type,this.gMap=n,this.gMarkers=new r,this.$log=e,this.$log.info(this)}return i.type="MarkerManager",i.prototype.add=function(t,n){var r,i;if(null==n&&(n=!0),null==t.key)throw i="gMarker.key undefined and it is REQUIRED!!",e.error(i),i;if(r=this.gMarkers.get(t.key),!r)return this.handleOptDraw(t,n,!0),this.gMarkers.put(t.key,t)},i.prototype.update=function(t,e){return null==e&&(e=!0),this.remove(t,e),this.add(t,e)},i.prototype.addMany=function(t){return t.forEach(function(t){return function(e){return t.add(e)}}(this))},i.prototype.remove=function(t,e){if(null==e&&(e=!0),this.handleOptDraw(t,e,!1),this.gMarkers.get(t.key))return this.gMarkers.remove(t.key)},i.prototype.removeMany=function(t){return t.forEach(function(t){return function(e){return t.remove(e)}}(this))},i.prototype.draw=function(){var t;return t=[],this.gMarkers.each(function(e){return function(n){if(!n.isDrawn)return n.doAdd?(n.setMap(e.gMap),n.isDrawn=!0):t.push(n)}}(this)),t.forEach(function(t){return function(e){return e.isDrawn=!1,t.remove(e,!0)}}(this))},i.prototype.destroy=function(){return this.clear()},i.prototype.clear=function(){return this.gMarkers.each(function(t){return t.setMap(null)}),delete this.gMarkers,this.gMarkers=new r},i.prototype.handleOptDraw=function(t,e,n){return e===!0?(n?t.setMap(this.gMap):t.setMap(null),t.isDrawn=!0):(t.isDrawn=!1,t.doAdd=n)},i.prototype.fit=function(){return n.fit(this.getGMarkers(),this.gMap)},i.prototype.getGMarkers=function(){return this.gMarkers.values()},i}()}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapSpiderfierMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap","uiGmapMarkerSpiderfier",function(n,r,i,o){var a;return a=function(){function a(e,r,s,l,u){null==r&&(r={}),this.opt_options=null!=s?s:{},this.opt_events=l,this.scope=u,this.checkSync=t(this.checkSync,this),this.isSpiderfied=t(this.isSpiderfied,this),this.getGMarkers=t(this.getGMarkers,this),this.fit=t(this.fit,this),this.destroy=t(this.destroy,this),this.attachEvents=t(this.attachEvents,this),this.clear=t(this.clear,this),this.draw=t(this.draw,this),this.removeMany=t(this.removeMany,this),this.remove=t(this.remove,this),this.addMany=t(this.addMany,this),this.update=t(this.update,this),this.add=t(this.add,this),this.type=a.type,this.markerSpiderfier=new o(e,this.opt_options),this.propMapGMarkers=new i,this.attachEvents(this.opt_events,"opt_events"),this.noDrawOnSingleAddRemoves=!0,n.info(this)}return a.type="SpiderfierMarkerManager",a.prototype.checkKey=function(t){var e;if(null==t.key)return e="gMarker.key undefined and it is REQUIRED!!",n.error(e)},a.prototype.add=function(t){return t.setMap(this.markerSpiderfier.map),this.checkKey(t),this.markerSpiderfier.addMarker(t,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.put(t.key,t),this.checkSync()},a.prototype.update=function(t){return this.remove(t),this.add(t)},a.prototype.addMany=function(t){return t.forEach(function(t){return function(e){return t.add(e)}}(this))},a.prototype.remove=function(t){var e;return this.checkKey(t),e=this.propMapGMarkers.get(t.key),e&&(t.setMap(null),this.markerSpiderfier.removeMarker(t,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.remove(t.key)),this.checkSync()},a.prototype.removeMany=function(t){return t.forEach(function(t){return function(e){return t.remove(e)}}(this))},a.prototype.draw=function(){},a.prototype.clear=function(){return this.removeMany(this.getGMarkers())},a.prototype.attachEvents=function(t,r){if(e.isDefined(t)&&null!=t&&e.isObject(t))return _.each(t,function(i){return function(o,a){if(t.hasOwnProperty(a)&&e.isFunction(t[a]))return n.info(r+": Attaching event: "+a+" to markerSpiderfier"),i.markerSpiderfier.addListener(a,function(){return"spiderfy"===a||"unspiderfy"===a?i.scope.$evalAsync(t[a].apply(t,arguments)):i.scope.$evalAsync(t[a].apply(t,[arguments[0],a,arguments[0].model,arguments]))})}}(this))},a.prototype.clearEvents=function(t,r){var i,o;if(e.isDefined(t)&&null!=t&&e.isObject(t))for(o in t)i=t[o],t.hasOwnProperty(o)&&e.isFunction(t[o])&&(n.info(r+": Clearing event: "+o+" to markerSpiderfier"),this.markerSpiderfier.clearListeners(o))},a.prototype.destroy=function(){return this.clearEvents(this.opt_events,"opt_events"),this.clear()},a.prototype.fit=function(){return r.fit(this.getGMarkers(),this.markerSpiderfier.map)},a.prototype.getGMarkers=function(){return this.markerSpiderfier.getMarkers()},a.prototype.isSpiderfied=function(){return _.find(this.getGMarkers(),function(t){return null!=(null!=t?t._omsData:void 0)})},a.prototype.checkSync=function(){},a}()}])}.call(this),function(){e.module("uiGmapgoogle-maps").factory("uiGmapadd-events",["$timeout",function(t){var n,r;return n=function(e,n,r){return google.maps.event.addListener(e,n,function(){return r.apply(this,arguments),t(function(){},!0)})},r=function(t,r,i){var o;return i?n(t,r,i):(o=[],e.forEach(r,function(e,r){return o.push(n(t,r,e))}),function(){return e.forEach(o,function(t){return google.maps.event.removeListener(t)}),o=null})}}])}.call(this),function(){e.module("uiGmapgoogle-maps").factory("uiGmaparray-sync",["uiGmapadd-events",function(t){return function(n,r,i,o){var a,s,l,u,c,d,h,p,f;return u=!1,p=r.$eval(i),r.static||(c={set_at:function(t){var e;if(!u&&(e=n.getAt(t)))return e.lng&&e.lat?(p[t].latitude=e.lat(),p[t].longitude=e.lng()):p[t]=e},insert_at:function(t){var e;if(!u&&(e=n.getAt(t)))return e.lng&&e.lat?p.splice(t,0,{latitude:e.lat(),longitude:e.lng()}):p.splice(t,0,e)},remove_at:function(t){if(!u)return p.splice(t,1)}},"Polygon"===p.type?a=p.coordinates[0]:"LineString"===p.type&&(a=p.coordinates),s={set_at:function(t){var e;if(!u&&(e=n.getAt(t),e&&e.lng&&e.lat))return a[t][1]=e.lat(),a[t][0]=e.lng()},insert_at:function(t){var e;if(!u&&(e=n.getAt(t),e&&e.lng&&e.lat))return a.splice(t,0,[e.lng(),e.lat()])},remove_at:function(t){if(!u)return a.splice(t,1)}},h=t(n,e.isUndefined(p.type)?c:s)),d=function(t){var e,r,i,a,s,l,c,d;if(u=!0,l=n,e=!1,t){for(r=0,c=l.getLength(),a=t.length,i=Math.min(c,a),s=void 0;r<i;)d=l.getAt(r),s=t[r],"function"==typeof s.equals?s.equals(d)||(l.setAt(r,s),e=!0):d.lat()===s.latitude&&d.lng()===s.longitude||(l.setAt(r,new google.maps.LatLng(s.latitude,s.longitude)),e=!0),r++;for(;r<a;)s=t[r],"function"==typeof s.lat&&"function"==typeof s.lng?l.push(s):l.push(new google.maps.LatLng(s.latitude,s.longitude)),e=!0,r++;for(;r<c;)l.pop(),e=!0,r++}if(u=!1,e)return o(l)},l=function(t){var e,r,i,a,s,l,c,d,h;if(u=!0,c=n,r=!1,t){for("Polygon"===p.type?e=t.coordinates[0]:"LineString"===p.type&&(e=t.coordinates),i=0,d=c.getLength(),s=e.length,a=Math.min(d,s),l=void 0;i<a;)h=c.getAt(i),l=e[i],h.lat()===l[1]&&h.lng()===l[0]||(c.setAt(i,new google.maps.LatLng(l[1],l[0])),r=!0),i++;for(;i<s;)l=e[i],c.push(new google.maps.LatLng(l[1],l[0])),r=!0,i++;for(;i<d;)c.pop(),r=!0,i++}if(u=!1,r)return o(c)},r.static||(f=e.isUndefined(p.type)?r.$watchCollection(i,d):r.$watch(i,l,!0)),function(){if(h&&(h(),h=null),f)return f(),f=null}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChromeFixes",["$timeout",function(t){return{maybeRepaint:function(e){if(e)return e.style.opacity=.9,t(function(){return e.style.opacity=1})}}}])}.call(this),function(){e.module("uiGmapgoogle-maps").service("uiGmapObjectIterators",function(){var t,e,n,r;return t=["length","forEach","map"],e=[],n=function(e){return e.forEach=function(n){return _.each(_.omit(e,t),function(t){if(!_.isFunction(t))return n(t)})},e},e.push(n),r=function(e){return e.map=function(n){return _.map(_.omit(e,t),function(t){if(!_.isFunction(t))return n(t)})},e},e.push(r),{slapMap:r,slapForEach:n,slapAll:function(t){return e.forEach(function(e){return e(t)}),t}}})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.options.builders").service("uiGmapCommonOptionsBuilder",["uiGmapBaseObject","uiGmapLogger","uiGmapModelKey",function(r,i,o){var a;return a=function(r){function o(){return this.watchProps=t(this.watchProps,this),this.buildOpts=t(this.buildOpts,this),o.__super__.constructor.apply(this,arguments)}return n(o,r),o.prototype.props=["clickable","draggable","editable","visible",{prop:"stroke",isColl:!0}],o.prototype.getCorrectModel=function(t){return e.isDefined(null!=t?t.model:void 0)?t.model:t},o.prototype.buildOpts=function(t,n,r){var o,a,s;return null==t&&(t={}),null==r&&(r={}),this.scope?this.gMap?(o=this.getCorrectModel(this.scope),s=this.scopeOrModelVal("stroke",this.scope,o),a=e.extend(t,this.DEFAULTS,{map:this.gMap,strokeColor:null!=s?s.color:void 0,strokeOpacity:null!=s?s.opacity:void 0,strokeWeight:null!=s?s.weight:void 0}),e.forEach(e.extend(r,{clickable:!0,draggable:!1,editable:!1,static:!1,fit:!1,visible:!0,zIndex:0,icons:[]}),function(t){return function(r,i){var s;return s=n?n[i]:t.scopeOrModelVal(i,t.scope,o),e.isUndefined(s)?a[i]=r:a[i]=o[i]}}(this)),a.static&&(a.editable=!1),a):void i.error("this.map not defined in CommonOptionsBuilder can not buildOpts"):void i.error("this.scope not defined in CommonOptionsBuilder can not buildOpts")},o.prototype.watchProps=function(t){return null==t&&(t=this.props),t.forEach(function(t){return function(e){if(null!=t.attrs[e]||null!=t.attrs[null!=e?e.prop:void 0])return(null!=e?e.isColl:void 0)?t.scope.$watchCollection(e.prop,t.setMyOptions):t.scope.$watch(e,t.setMyOptions)}}(this))},o}(o)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.options.builders").factory("uiGmapPolylineOptionsBuilder",["uiGmapCommonOptionsBuilder",function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.buildOpts=function(t,e){return n.__super__.buildOpts.call(this,{path:t},e,{geodesic:!1})},n}(e)}]).factory("uiGmapShapeOptionsBuilder",["uiGmapCommonOptionsBuilder",function(n){var r;return r=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.buildOpts=function(t,n,i){var o,a;return a=this.getCorrectModel(this.scope),o=n?n.fill:this.scopeOrModelVal("fill",this.scope,a),t=e.extend(t,{fillColor:null!=o?o.color:void 0,fillOpacity:null!=o?o.opacity:void 0}),r.__super__.buildOpts.call(this,t,n,i)},r}(n)}]).factory("uiGmapPolygonOptionsBuilder",["uiGmapShapeOptionsBuilder",function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.buildOpts=function(t,e){return n.__super__.buildOpts.call(this,{path:t},e,{geodesic:!1})},n}(e)}]).factory("uiGmapRectangleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.buildOpts=function(t,e){return n.__super__.buildOpts.call(this,{bounds:t},e)},n}(e)}]).factory("uiGmapCircleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.buildOpts=function(t,e,r){return n.__super__.buildOpts.call(this,{center:t,radius:e},r)},n}(e)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.options").service("uiGmapMarkerOptions",["uiGmapLogger","uiGmapGmapUtil",function(t,n){return _.extend(n,{createOptions:function(t,r,i,o){var a;return null==i&&(i={}),a=e.extend({},i,{position:null!=i.position?i.position:n.getCoords(t),visible:null!=i.visible?i.visible:n.validateCoords(t)}),null==i.icon&&null==r||(a=e.extend(a,{icon:null!=i.icon?i.icon:r})),null!=o&&(a.map=o),a},isLabel:function(t){return null!=t&&(null!=t.labelContent||null!=t.labelAnchor||null!=t.labelClass||null!=t.labelStyle||null!=t.labelVisible)}})}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapBasePolyChildModel",["uiGmapLogger","$timeout","uiGmaparray-sync","uiGmapGmapUtil","uiGmapEventsHelper",function(r,i,o,a,s){return function(r,i){var l;return l=function(r){function l(n){var r,a,l;this.scope=n.scope,this.attrs=n.attrs,this.gMap=n.gMap,this.defaults=n.defaults,this.model=n.model,a=n.gObjectChangeCb,this.isScopeModel=null!=(l=n.isScopeModel)&&l,this.clean=t(this.clean,this),this.isScopeModel&&(this.clonedModel=_.clone(this.model,!0)),this.isDragging=!1,this.internalEvents={dragend:function(t){return function(){return _.defer(function(){return t.isDragging=!1})}}(this),dragstart:function(t){return function(){return t.isDragging=!0}}(this)},r=function(t){return function(){var n;if(!t.isDragging)return t.pathPoints=t.convertPathPoints(t.scope.path),null!=t.gObject&&t.clean(),null!=t.scope.model&&(n=t.scope),t.pathPoints.length>0&&(t.gObject=i(t.buildOpts(t.pathPoints,n))),t.gObject?(o(t.gObject.getPath(),t.scope,"path",function(e){if(t.pathPoints=e,null!=a)return a()}),e.isDefined(t.scope.events)&&e.isObject(t.scope.events)&&(t.listeners=t.model?s.setEvents(t.gObject,t.scope,t.model):s.setEvents(t.gObject,t.scope,t.scope)),t.internalListeners=t.model?s.setEvents(t.gObject,{events:t.internalEvents},t.model):s.setEvents(t.gObject,{events:t.internalEvents},t.scope)):void 0}}(this),r(),this.scope.$watch("path",function(t){return function(e,n){if(!_.isEqual(e,n)||!t.gObject)return r()}}(this),!0),!this.scope.static&&e.isDefined(this.scope.editable)&&this.scope.$watch("editable",function(t){return function(e,n){var r;if(e!==n)return e=!t.isFalse(e),null!=(r=t.gObject)?r.setEditable(e):void 0}}(this),!0),e.isDefined(this.scope.draggable)&&this.scope.$watch("draggable",function(t){return function(e,n){var r;if(e!==n)return e=!t.isFalse(e),
null!=(r=t.gObject)?r.setDraggable(e):void 0}}(this),!0),e.isDefined(this.scope.visible)&&this.scope.$watch("visible",function(t){return function(e,n){var r;return e!==n&&(e=!t.isFalse(e)),null!=(r=t.gObject)?r.setVisible(e):void 0}}(this),!0),e.isDefined(this.scope.geodesic)&&this.scope.$watch("geodesic",function(t){return function(e,n){var r;if(e!==n)return e=!t.isFalse(e),null!=(r=t.gObject)?r.setOptions(t.buildOpts(t.gObject.getPath())):void 0}}(this),!0),e.isDefined(this.scope.stroke)&&e.isDefined(this.scope.stroke.weight)&&this.scope.$watch("stroke.weight",function(t){return function(e,n){var r;if(e!==n)return null!=(r=t.gObject)?r.setOptions(t.buildOpts(t.gObject.getPath())):void 0}}(this),!0),e.isDefined(this.scope.stroke)&&e.isDefined(this.scope.stroke.color)&&this.scope.$watch("stroke.color",function(t){return function(e,n){var r;if(e!==n)return null!=(r=t.gObject)?r.setOptions(t.buildOpts(t.gObject.getPath())):void 0}}(this),!0),e.isDefined(this.scope.stroke)&&e.isDefined(this.scope.stroke.opacity)&&this.scope.$watch("stroke.opacity",function(t){return function(e,n){var r;if(e!==n)return null!=(r=t.gObject)?r.setOptions(t.buildOpts(t.gObject.getPath())):void 0}}(this),!0),e.isDefined(this.scope.icons)&&this.scope.$watch("icons",function(t){return function(e,n){var r;if(e!==n)return null!=(r=t.gObject)?r.setOptions(t.buildOpts(t.gObject.getPath())):void 0}}(this),!0),this.scope.$on("$destroy",function(t){return function(){return t.clean(),t.scope=null}}(this)),e.isDefined(this.scope.fill)&&e.isDefined(this.scope.fill.color)&&this.scope.$watch("fill.color",function(t){return function(e,n){if(e!==n)return t.gObject.setOptions(t.buildOpts(t.gObject.getPath()))}}(this)),e.isDefined(this.scope.fill)&&e.isDefined(this.scope.fill.opacity)&&this.scope.$watch("fill.opacity",function(t){return function(e,n){if(e!==n)return t.gObject.setOptions(t.buildOpts(t.gObject.getPath()))}}(this)),e.isDefined(this.scope.zIndex)&&this.scope.$watch("zIndex",function(t){return function(e,n){if(e!==n)return t.gObject.setOptions(t.buildOpts(t.gObject.getPath()))}}(this))}return n(l,r),l.include(a),l.prototype.clean=function(){var t;return s.removeEvents(this.listeners),s.removeEvents(this.internalListeners),null!=(t=this.gObject)&&t.setMap(null),this.gObject=null},l}(r)}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapDrawFreeHandChildModel",["uiGmapLogger","$q",function(t,e){var n,r;return n=function(t,e,n){var r,i;i=new google.maps.Polyline({map:t,clickable:!1}),r=google.maps.event.addListener(t,"mousemove",function(t){return i.getPath().push(t.latLng)}),google.maps.event.addListenerOnce(t,"mouseup",function(o){var a;return google.maps.event.removeListener(r),a=i.getPath(),i.setMap(null),e.push(new google.maps.Polygon({map:t,path:a})),i=null,google.maps.event.clearListeners(t.getDiv(),"mousedown"),n()})},r=function(r,i){var o,a;return this.map=r,o=function(e){return function(){var n;return n={draggable:!1,disableDefaultUI:!0,scrollwheel:!1,disableDoubleClickZoom:!1},t.info("disabling map move"),e.map.setOptions(n)}}(this),a=function(t){return function(){var e,n;return e={draggable:!0,disableDefaultUI:!1,scrollwheel:!0,disableDoubleClickZoom:!0},null!=(n=t.deferred)&&n.resolve(),_.defer(function(){return t.map.setOptions(_.extend(e,i.options))})}}(this),this.engage=function(r){return function(i){return r.polys=i,r.deferred=e.defer(),o(),t.info("DrawFreeHandChildModel is engaged (drawing)."),google.maps.event.addDomListener(r.map.getDiv(),"mousedown",function(t){return n(r.map,r.polys,a)}),r.deferred.promise}}(this),this}}])}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapMarkerChildModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger","uiGmapEventsHelper","uiGmapPropertyAction","uiGmapMarkerOptions","uiGmapIMarker","uiGmapMarkerManager","uiGmapPromise",function(i,o,a,s,l,u,c,d,h){var p;return p=function(i){function p(t){this.internalEvents=n(this.internalEvents,this),this.setLabelOptions=n(this.setLabelOptions,this),this.setOptions=n(this.setOptions,this),this.setIcon=n(this.setIcon,this),this.setCoords=n(this.setCoords,this),this.isNotValid=n(this.isNotValid,this),this.maybeSetScopeValue=n(this.maybeSetScopeValue,this),this.createMarker=n(this.createMarker,this),this.setMyScope=n(this.setMyScope,this),this.updateModel=n(this.updateModel,this),this.handleModelChanges=n(this.handleModelChanges,this),this.destroy=n(this.destroy,this);var e,r,i,o,s,u,c;c=t.scope,this.model=t.model,this.keys=t.keys,this.gMap=t.gMap,this.defaults=null!=(r=t.defaults)?r:{},this.doClick=t.doClick,this.gManager=t.gManager,this.doDrawSelf=null==(i=t.doDrawSelf)||i,this.trackModel=null==(o=t.trackModel)||o,this.needRedraw=null!=(s=t.needRedraw)&&s,this.isScopeModel=null!=(u=t.isScopeModel)&&u,this.isScopeModel&&(this.clonedModel=_.clone(this.model,!0)),this.deferred=h.defer(),_.each(this.keys,function(t){return function(e,n){var r;if(r=t.keys[n],null!=r&&!_.isFunction(r)&&_.isString(r))return t[n+"Key"]=r}}(this)),this.idKey=this.idKeyKey||"id",null!=this.model[this.idKey]&&(this.id=this.model[this.idKey]),p.__super__.constructor.call(this,c),this.scope.getGMarker=function(t){return function(){return t.gObject}}(this),this.firstTime=!0,this.trackModel?(this.scope.model=this.model,this.scope.$watch("model",function(t){return function(e,n){if(e!==n)return t.handleModelChanges(e,n)}}(this),!0)):(e=new l(function(t){return function(e){if(_.isFunction(e)&&(e="all"),!t.firstTime)return t.setMyScope(e,c)}}(this),(!1)),_.each(this.keys,function(t,n){return c.$watch(n,e.sic(n),!0)})),this.scope.$on("$destroy",function(t){return function(){return f(t)}}(this)),this.createMarker(this.model),a.info(this)}var f;return r(p,i),p.include(o),p.include(s),p.include(u),f=function(t){if(null!=(null!=t?t.gObject:void 0)&&(t.removeEvents(t.externalListeners),t.removeEvents(t.internalListeners),null!=t?t.gObject:void 0))return t.removeFromManager&&t.gManager.remove(t.gObject),t.gObject.setMap(null),t.gObject=null},p.prototype.destroy=function(t){return null==t&&(t=!0),this.removeFromManager=t,this.scope.$destroy()},p.prototype.handleModelChanges=function(t,e){var n,r,i;if(n=this.getChanges(t,e,c.keys),!this.firstTime)return r=0,i=_.keys(n).length,_.each(n,function(n){return function(o,a){var s;return r+=1,s=i===r,n.setMyScope(a,t,e,!1,!0,s),n.needRedraw=!0}}(this))},p.prototype.updateModel=function(t){return this.isScopeModel&&(this.clonedModel=_.clone(t,!0)),this.setMyScope("all",t,this.model)},p.prototype.renderGMarker=function(e,n){var r,i,o;if(null==e&&(e=!0),r=this.getProp("coords",this.scope,this.model),null!=(null!=(o=this.gManager)?o.isSpiderfied:void 0)&&(i=this.gManager.isSpiderfied()),null!=r){if(!this.validateCoords(r))return void a.debug("MarkerChild does not have coords yet. They may be defined later.");if(null!=n&&n(),e&&this.gObject&&this.gManager.add(this.gObject),i)return this.gManager.markerSpiderfier.spiderListener(this.gObject,t.event)}else if(e&&this.gObject)return this.gManager.remove(this.gObject)},p.prototype.setMyScope=function(t,e,n,r,i){var o;switch(null==n&&(n=void 0),null==r&&(r=!1),null==i&&(i=!0),null==e?e=this.model:this.model=e,this.gObject||(this.setOptions(this.scope,i),o=!0),t){case"all":return _.each(this.keys,function(t){return function(o,a){return t.setMyScope(a,e,n,r,i)}}(this));case"icon":return this.maybeSetScopeValue({gSetter:this.setIcon,doDraw:i});case"coords":return this.maybeSetScopeValue({gSetter:this.setCoords,doDraw:i});case"options":if(!o)return this.createMarker(e,n,r,i)}},p.prototype.createMarker=function(t,e,n,r){return null==e&&(e=void 0),null==n&&(n=!1),null==r&&(r=!0),this.maybeSetScopeValue({gSetter:this.setOptions,doDraw:r}),this.firstTime=!1},p.prototype.maybeSetScopeValue=function(t){var e,n,r;if(n=t.gSetter,e=null==(r=t.doDraw)||r,null!=n&&n(this.scope,e),this.doDrawSelf&&e)return this.gManager.draw()},p.prototype.isNotValid=function(t,e){var n,r;return null==e&&(e=!0),r=!!e&&void 0===this.gObject,n=!this.trackModel&&t.$id!==this.scope.$id,n||r},p.prototype.setCoords=function(t,e){if(null==e&&(e=!0),!this.isNotValid(t)&&null!=this.gObject)return this.renderGMarker(e,function(e){return function(){var n,r,i;if(r=e.getProp("coords",t,e.model),n=e.getCoords(r),i=e.gObject.getPosition(),null==i||null==n||n.lng()!==i.lng()||n.lat()!==i.lat())return e.gObject.setPosition(n),e.gObject.setVisible(e.validateCoords(r))}}(this))},p.prototype.setIcon=function(t,e){if(null==e&&(e=!0),!this.isNotValid(t)&&null!=this.gObject)return this.renderGMarker(e,function(e){return function(){var n,r,i;if(i=e.gObject.getIcon(),r=e.getProp("icon",t,e.model),i!==r)return e.gObject.setIcon(r),n=e.getProp("coords",t,e.model),e.gObject.setPosition(e.getCoords(n)),e.gObject.setVisible(e.validateCoords(n))}}(this))},p.prototype.setOptions=function(t,e){var n;if(null==e&&(e=!0),!this.isNotValid(t,!1)){if(this.renderGMarker(e,function(e){return function(){var n,r,i;if(r=e.getProp("coords",t,e.model),i=e.getProp("icon",t,e.model),n=e.getProp("options",t,e.model),e.opts=e.createOptions(r,i,n),e.isLabel(e.gObject)!==e.isLabel(e.opts)&&null!=e.gObject&&(e.gManager.remove(e.gObject),e.gObject=void 0),null!=e.gObject&&e.gObject.setOptions(e.setLabelOptions(e.opts)),e.gObject||(e.isLabel(e.opts)?e.gObject=new MarkerWithLabel(e.setLabelOptions(e.opts)):e.opts.content?(e.gObject=new RichMarker(e.opts),e.gObject.getIcon=e.gObject.getContent,e.gObject.setIcon=e.gObject.setContent):e.gObject=new google.maps.Marker(e.opts),_.extend(e.gObject,{model:e.model})),e.externalListeners&&e.removeEvents(e.externalListeners),e.internalListeners&&e.removeEvents(e.internalListeners),e.externalListeners=e.setEvents(e.gObject,e.scope,e.model,["dragend"]),e.internalListeners=e.setEvents(e.gObject,{events:e.internalEvents(),$evalAsync:function(){}},e.model),null!=e.id)return e.gObject.key=e.id}}(this)),this.gObject&&(this.gObject.getMap()||this.gManager.type!==d.type))this.deferred.resolve(this.gObject);else{if(!this.gObject)return this.deferred.reject("gObject is null");null!=(n=this.gObject)&&n.getMap()&&this.gManager.type===d.type||(a.debug("gObject has no map yet"),this.deferred.resolve(this.gObject))}return this.model[this.fitKey]?this.gManager.fit():void 0}},p.prototype.setLabelOptions=function(t){return t.labelAnchor&&(t.labelAnchor=this.getLabelPositionPoint(t.labelAnchor)),t},p.prototype.internalEvents=function(){return{dragend:function(t){return function(e,n,r,i){var o,a,s;return a=t.trackModel?t.scope.model:t.model,s=t.setCoordsFromEvent(t.modelOrKey(a,t.coordsKey),t.gObject.getPosition()),a=t.setVal(r,t.coordsKey,s),o=t.scope.events,null!=(null!=o?o.dragend:void 0)&&o.dragend(e,n,a,i),t.scope.$apply()}}(this),click:function(t){return function(n,r,i,o){var a;if(a=t.getProp("click",t.scope,t.model),t.doClick&&e.isFunction(a))return t.scope.$evalAsync(a(n,r,t.model,o))}}(this)}},p}(i)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygonChildModel",["uiGmapBasePolyChildModel","uiGmapPolygonOptionsBuilder",function(e,n){var r,i,o;return o=function(t){return new google.maps.Polygon(t)},i=new e(n,o),r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(i)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylineChildModel",["uiGmapBasePolyChildModel","uiGmapPolylineOptionsBuilder",function(e,n){var r,i,o;return o=function(t){return new google.maps.Polyline(t)},i=e(n,o),r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(i)}])}.call(this),function(){var n=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapWindowChildModel",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapLogger","$compile","$http","$templateCache","uiGmapChromeFixes","uiGmapEventsHelper",function(i,o,a,s,l,u,c,d){var h;return h=function(i){function h(t){this.updateModel=n(this.updateModel,this),this.destroy=n(this.destroy,this),this.remove=n(this.remove,this),this.getLatestPosition=n(this.getLatestPosition,this),this.hideWindow=n(this.hideWindow,this),this.showWindow=n(this.showWindow,this),this.handleClick=n(this.handleClick,this),this.watchOptions=n(this.watchOptions,this),this.watchCoords=n(this.watchCoords,this),this.createGWin=n(this.createGWin,this),this.watchElement=n(this.watchElement,this),this.watchAndDoShow=n(this.watchAndDoShow,this),this.doShow=n(this.doShow,this);var e,r,i,o,s;this.model=null!=(r=t.model)?r:{},this.scope=t.scope,this.opts=t.opts,this.isIconVisibleOnClick=t.isIconVisibleOnClick,this.gMap=t.gMap,this.markerScope=t.markerScope,this.element=t.element,this.needToManualDestroy=null!=(i=t.needToManualDestroy)&&i,this.markerIsVisibleAfterWindowClose=null==(o=t.markerIsVisibleAfterWindowClose)||o,this.isScopeModel=null!=(s=t.isScopeModel)&&s,this.isScopeModel&&(this.clonedModel=_.clone(this.model,!0)),this.getGmarker=function(){var t,e;if(null!=(null!=(t=this.markerScope)?t.getGMarker:void 0))return null!=(e=this.markerScope)?e.getGMarker():void 0},this.listeners=[],this.createGWin(),e=this.getGmarker(),null!=e&&e.setClickable(!0),this.watchElement(),this.watchOptions(),this.watchCoords(),this.watchAndDoShow(),this.scope.$on("$destroy",function(t){return function(){return t.destroy()}}(this)),a.info(this)}return r(h,i),h.include(o),h.include(d),h.prototype.doShow=function(t){return this.scope.show===!0||t?this.showWindow():this.hideWindow()},h.prototype.watchAndDoShow=function(){return null!=this.model.show&&(this.scope.show=this.model.show),this.scope.$watch("show",this.doShow,!0),this.doShow()},h.prototype.watchElement=function(){return this.scope.$watch(function(t){return function(){var e,n;if(t.element||t.html)return t.html!==t.element.html()&&t.gObject?(null!=(e=t.opts)&&(e.content=void 0),n=t.gObject.isOpen(),t.remove(),t.createGWin(n)):void 0}}(this))},h.prototype.createGWin=function(e){var n,r,i,o,a;if(null==e&&(e=!1),i=this.getGmarker(),r={},null!=this.opts&&(this.scope.coords&&(this.opts.position=this.getCoords(this.scope.coords)),r=this.opts),this.element&&(this.html=_.isObject(this.element)?this.element.html():this.element),n=this.scope.options?this.scope.options:r,this.opts=this.createWindowOptions(i,this.markerScope||this.scope,this.html,n),null!=this.opts)return this.gObject||(this.opts.boxClass&&t.InfoBox&&"function"==typeof t.InfoBox?this.gObject=new t.InfoBox(this.opts):this.gObject=new google.maps.InfoWindow(this.opts),this.listeners.push(google.maps.event.addListener(this.gObject,"domready",function(){return c.maybeRepaint(this.content)})),this.listeners.push(google.maps.event.addListener(this.gObject,"closeclick",function(t){return function(){return i&&(i.setAnimation(t.oldMarkerAnimation),t.markerIsVisibleAfterWindowClose&&_.delay(function(){return i.setVisible(!1),i.setVisible(t.markerIsVisibleAfterWindowClose)},250)),t.gObject.close(),t.model.show=!1,null!=t.scope.closeClick?t.scope.$evalAsync(t.scope.closeClick()):t.scope.$evalAsync()}}(this)))),this.gObject.setContent(this.opts.content),this.handleClick((null!=(o=this.scope)&&null!=(a=o.options)?a.forceClick:void 0)||e),this.doShow(this.gObject.isOpen())},h.prototype.watchCoords=function(){var t;return t=null!=this.markerScope?this.markerScope:this.scope,t.$watch("coords",function(t){return function(e,n){var r;if(e!==n){if(null==e)t.hideWindow();else if(!t.validateCoords(e))return void a.error("WindowChildMarker cannot render marker as scope.coords as no position on marker: "+JSON.stringify(t.model));if(r=t.getCoords(e),t.doShow(),t.gObject.setPosition(r),t.opts)return t.opts.position=r}}}(this),!0)},h.prototype.watchOptions=function(){return this.scope.$watch("options",function(t){return function(e,n){if(e!==n&&(t.opts=e,null!=t.gObject)){if(t.gObject.setOptions(t.opts),null!=t.opts.visible&&t.opts.visible)return t.showWindow();if(null!=t.opts.visible)return t.hideWindow()}}}(this),!0)},h.prototype.handleClick=function(t){var e,n;if(null!=this.gObject)return n=this.getGmarker(),e=function(t){return function(){if(null==t.gObject&&t.createGWin(),t.showWindow(),null!=n)return t.initialMarkerVisibility=n.getVisible(),t.oldMarkerAnimation=n.getAnimation(),n.setVisible(t.isIconVisibleOnClick)}}(this),t&&e(),n?this.listeners=this.listeners.concat(this.setEvents(n,{events:{click:e}},this.model)):void 0},h.prototype.showWindow=function(){var t,n,r;if(null!=this.gObject)return r=null,n=function(t){return function(){var e,n,r;if(!t.gObject.isOpen()){if(n=t.getGmarker(),null!=t.gObject&&null!=t.gObject.getPosition&&(r=t.gObject.getPosition()),n&&(r=n.getPosition()),!r)return;if(t.gObject.open(t.gMap,n),e=t.gObject.isOpen(),t.model.show!==e)return t.model.show=e}}}(this),this.scope.templateUrl?l.get(this.scope.templateUrl,{cache:u}).then(function(t){return function(i){var o;return r=t.scope.$new(),e.isDefined(t.scope.templateParameter)&&(r.parameter=t.scope.templateParameter),o=s(i.data)(r),t.gObject.setContent(o[0]),n()}}(this)):this.scope.template?(r=this.scope.$new(),e.isDefined(this.scope.templateParameter)&&(r.parameter=this.scope.templateParameter),t=s(this.scope.template)(r),this.gObject.setContent(t[0]),n()):n(),this.scope.$on("destroy",function(){return r.$destroy()})},h.prototype.hideWindow=function(){if(null!=this.gObject&&this.gObject.isOpen())return this.gObject.close()},h.prototype.getLatestPosition=function(t){var e;return e=this.getGmarker(),null==this.gObject||null==e||t?t?this.gObject.setPosition(t):void 0:this.gObject.setPosition(e.getPosition())},h.prototype.remove=function(){return this.hideWindow(),this.removeEvents(this.listeners),this.listeners.length=0,delete this.gObject,delete this.opts},h.prototype.destroy=function(t){var e;if(null==t&&(t=!1),this.remove(),null!=this.scope&&!(null!=(e=this.scope)?e.$$destroyed:void 0)&&(this.needToManualDestroy||t))return this.scope.$destroy()},h.prototype.updateModel=function(t){return this.isScopeModel&&(this.clonedModel=_.clone(t,!0)),_.extend(this.model,this.clonedModel||t)},h}(i)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapBasePolysParentModel",["$timeout","uiGmapLogger","uiGmapModelKey","uiGmapModelsWatcher","uiGmapPropMap","uiGmap_async","uiGmapPromise","uiGmapFitHelper",function(r,i,o,a,s,l,u,c){return function(r,d,h){var p;return p=function(o){function p(e,n,o,a,l){this.element=n,this.attrs=o,this.gMap=a,this.defaults=l,this.maybeFit=t(this.maybeFit,this),this.createChild=t(this.createChild,this),this.pieceMeal=t(this.pieceMeal,this),this.createAllNew=t(this.createAllNew,this),this.watchIdKey=t(this.watchIdKey,this),this.createChildScopes=t(this.createChildScopes,this),this.watchDestroy=t(this.watchDestroy,this),this.onDestroy=t(this.onDestroy,this),this.rebuildAll=t(this.rebuildAll,this),this.doINeedToWipe=t(this.doINeedToWipe,this),this.watchModels=t(this.watchModels,this),p.__super__.constructor.call(this,e),this.interface=r,this.$log=i,this.plurals=new s,_.each(r.scopeKeys,function(t){return function(e){return t[e+"Key"]=void 0}}(this)),this.models=void 0,this.firstTime=!0,this.$log.info(this),this.createChildScopes()}return n(p,o),p.include(a),p.prototype.watchModels=function(t){return t.$watch("models",function(e){return function(n,r){if(n!==r)return e.doINeedToWipe(n)||t.doRebuildAll?e.rebuildAll(t,!0,!0):e.createChildScopes(!1)}}(this),!0)},p.prototype.doINeedToWipe=function(t){var e;return e=null==t||0===t.length,this.plurals.length>0&&e},p.prototype.rebuildAll=function(t,e,n){return this.onDestroy(n).then(function(t){return function(){if(e)return t.createChildScopes()}}(this))},p.prototype.onDestroy=function(){return p.__super__.onDestroy.call(this,this.scope),l.promiseLock(this,u.promiseTypes.delete,void 0,void 0,function(t){return function(){return l.each(t.plurals.values(),function(t){return t.destroy(!0)},l.chunkSizeFrom(t.scope.cleanchunk,!1)).then(function(){var e;return null!=(e=t.plurals)?e.removeAll():void 0})}}(this))},p.prototype.watchDestroy=function(t){return t.$on("$destroy",function(e){return function(){return e.rebuildAll(t,!1,!0)}}(this))},p.prototype.createChildScopes=function(t){return null==t&&(t=!0),e.isUndefined(this.scope.models)?void this.$log.error("No models to create "+h+"s from! I Need direct models!"):null!=this.gMap&&null!=this.scope.models?(this.watchIdKey(this.scope),t?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)):void 0},p.prototype.watchIdKey=function(t){return this.setIdKey(t),t.$watch("idKey",function(e){return function(n,r){if(n!==r&&null==n)return e.idKey=n,e.rebuildAll(t,!0,!0)}}(this))},p.prototype.createAllNew=function(t,e){var n;if(null==e&&(e=!1),this.models=t.models,this.firstTime&&(this.watchModels(t),this.watchDestroy(t)),!this.didQueueInitPromise(this,t))return n=null,l.promiseLock(this,u.promiseTypes.create,"createAllNew",function(t){return n=t},function(e){return function(){return l.map(t.models,function(t){var r;return r=e.createChild(t,e.gMap),n&&(i.debug("createNew should fall through safely"),r.isEnabled=!1),r.pathPoints.getArray()},l.chunkSizeFrom(t.chunk)).then(function(t){return e.maybeFit(t),e.firstTime=!1})}}(this))},p.prototype.pieceMeal=function(t,e){var n,r;if(null==e&&(e=!0),!t.$$destroyed)return n=null,r=null,this.models=t.models,null!=t&&this.modelsLength()&&this.plurals.length?l.promiseLock(this,u.promiseTypes.update,"pieceMeal",function(t){return n=t},function(e){return function(){return u.promise(function(){return e.figureOutState(e.idKey,t,e.plurals,e.modelKeyComparison)}).then(function(i){return r=i,r.updates.length&&l.each(r.updates,function(t){return _.extend(t.child.scope,t.model),t.child.model=t.model}),l.each(r.removals,function(t){if(null!=t)return t.destroy(),e.plurals.remove(t.model[e.idKey]),n},l.chunkSizeFrom(t.chunk))}).then(function(){return l.each(r.adds,function(t){return n&&i.debug("pieceMeal should fall through safely"),e.createChild(t,e.gMap),n},l.chunkSizeFrom(t.chunk)).then(function(){return e.maybeFit()})})}}(this)):(this.inProgress=!1,this.rebuildAll(this.scope,!0,!0))},p.prototype.createChild=function(t,e){var n,i;return i=this.scope.$new(!1),this.setChildScope(r.scopeKeys,i,t),i.$watch("model",function(t){return function(e,n){if(e!==n)return t.setChildScope(i,e)}}(this),!0),i.static=this.scope.static,n=new d({isScopeModel:!0,scope:i,attrs:this.attrs,gMap:e,defaults:this.defaults,model:t,gObjectChangeCb:function(t){return function(){return t.maybeFit()}}(this)}),null==t[this.idKey]?void this.$log.error(h+" model has no id to assign a child to.\nThis is required for performance. Please assign id,\nor redirect id to a different key."):(this.plurals.put(t[this.idKey],n),n)},p.prototype.maybeFit=function(t){if(null==t&&(t=this.plurals.map(function(t){return t.pathPoints})),this.scope.fit)return t=_.flatten(t),c.fit(t,this.gMap)},p}(o)}}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapCircleParentModel",["uiGmapLogger","$timeout","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapCircleOptionsBuilder",function(n,r,i,o,a){var s,l;return l=function(t,e){return t.settingFromDirective=!0,e(),r(function(){return t.settingFromDirective=!1})},s=function(r){function a(t,r,o,a,s){var u,c,d;this.attrs=o,this.gMap=a,this.DEFAULTS=s,this.scope=t,d=null,u=function(t){return function(){if(d=null,null!=t.listeners)return t.removeEvents(t.listeners),t.listeners=void 0}}(this),c=new google.maps.Circle(this.buildOpts(i.getCoords(t.center),t.radius)),this.setMyOptions=function(e){return function(n,r){if(!t.settingFromDirective)return!_.isEqual(n,r)||n!==r||null!=n&&null!=r&&n.coordinates!==r.coordinates?c.setOptions(e.buildOpts(i.getCoords(t.center),t.radius)):void 0}}(this),this.props=this.props.concat([{prop:"center",isColl:!0},{prop:"fill",isColl:!0},"radius","zIndex"]),this.watchProps(),null!=this.scope.control&&(this.scope.control.getCircle=function(){return c}),u(),this.listeners=this.setEvents(c,t,t,["radius_changed"])||[],this.listeners.push(google.maps.event.addListener(c,"radius_changed",function(){var n,r;if(n=c.getRadius(),n!==d)return d=n,r=function(){return l(t,function(){var e,r;if(n!==t.radius&&(t.radius=n),(null!=(e=t.events)?e.radius_changed:void 0)&&_.isFunction(null!=(r=t.events)?r.radius_changed:void 0))return t.events.radius_changed(c,"radius_changed",t,arguments)})},e.mock?r():t.$evalAsync(function(){return r()})})),this.listeners.push(google.maps.event.addListener(c,"center_changed",function(){return t.$evalAsync(function(){return l(t,function(){return e.isDefined(t.center.type)?(t.center.coordinates[1]=c.getCenter().lat(),t.center.coordinates[0]=c.getCenter().lng()):(t.center.latitude=c.getCenter().lat(),t.center.longitude=c.getCenter().lng())})})})),t.$on("$destroy",function(){return u(),c.setMap(null)}),n.info(this)}return t(a,r),a.include(i),a.include(o),a}(a)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapDrawingManagerParentModel",["uiGmapLogger","$timeout","uiGmapBaseObject","uiGmapEventsHelper",function(e,n,r,i){var o;return o=function(e){function n(t,e,n,r){var i,o;this.scope=t,this.attrs=n,this.map=r,i=new google.maps.drawing.DrawingManager(this.scope.options),i.setMap(this.map),o=void 0,null!=this.scope.control&&(this.scope.control.getDrawingManager=function(){return i}),!this.scope.static&&this.scope.options&&this.scope.$watch("options",function(t){return null!=i?i.setOptions(t):void 0},!0),null!=this.scope.events&&(o=this.setEvents(i,this.scope,this.scope),this.scope.$watch("events",function(t){return function(e,n){if(!_.isEqual(e,n))return null!=o&&t.removeEvents(o),o=t.setEvents(i,t.scope,t.scope)}}(this))),this.scope.$on("$destroy",function(t){return function(){return null!=o&&t.removeEvents(o),i.setMap(null),i=null}}(this))}return t(n,e),n.include(i),n}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIMarkerParentModel",["uiGmapModelKey","uiGmapLogger",function(r,i){var o;return o=function(r){function o(n,r,a,s){if(this.scope=n,this.element=r,this.attrs=a,this.map=s,this.onWatch=t(this.onWatch,this),this.watch=t(this.watch,this),this.validateScope=t(this.validateScope,this),o.__super__.constructor.call(this,this.scope),this.$log=i,!this.validateScope(this.scope))throw new String("Unable to construct IMarkerParentModel due to invalid scope");this.doClick=e.isDefined(this.attrs.click),null!=this.scope.options&&(this.DEFAULTS=this.scope.options),this.watch("coords",this.scope),this.watch("icon",this.scope),this.watch("options",this.scope),this.scope.$on("$destroy",function(t){return function(){return t.onDestroy(t.scope)}}(this))}return n(o,r),o.prototype.DEFAULTS={},o.prototype.validateScope=function(t){var e;return null==t?(this.$log.error(this.constructor.name+": invalid scope used"),!1):(e=null!=t.coords,e?e:(this.$log.error(this.constructor.name+": no valid coords attribute found"),!1))},o.prototype.watch=function(t,e,n){return null==n&&(n=!0),e.$watch(t,function(n){return function(r,i){if(!_.isEqual(r,i))return n.onWatch(t,e,r,i)}}(this),n)},o.prototype.onWatch=function(t,e,n,r){},o}(r)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIWindowParentModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger",function(e,n,r){var i;return i=function(e){function i(t,e,n,o,a,s,l,u){i.__super__.constructor.call(this,t),this.$log=r,this.$timeout=a,this.$compile=s,this.$http=l,this.$templateCache=u,this.DEFAULTS={},null!=t.options&&(this.DEFAULTS=t.options)}return t(i,e),i.include(n),i.prototype.getItem=function(t,e,n){return"models"===e?t[e][n]:t[e].get(n)},i}(e)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapLayerParentModel",["uiGmapBaseObject","uiGmapLogger","$timeout",function(r,i,o){var a;return a=function(r){function o(n,r,o,a,s,l){return this.scope=n,this.element=r,this.attrs=o,this.gMap=a,this.onLayerCreated=null!=s?s:void 0,this.$log=null!=l?l:i,this.createGoogleLayer=t(this.createGoogleLayer,this),null==this.attrs.type?void this.$log.info("type attribute for the layer directive is mandatory. Layer creation aborted!!"):(this.createGoogleLayer(),this.doShow=!0,e.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.gObject.setMap(this.gMap),this.scope.$watch("show",function(t){return function(e,n){if(e!==n)return t.doShow=e,e?t.gObject.setMap(t.gMap):t.gObject.setMap(null)}}(this),!0),this.scope.$watch("options",function(t){return function(e,n){if(e!==n&&t.doShow)return t.gObject.setOptions(e)}}(this),!0),void this.scope.$on("$destroy",function(t){return function(){return t.gObject.setMap(null)}}(this)))}return n(o,r),o.prototype.createGoogleLayer=function(){var t;if(null==this.attrs.options?this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type]:new google.maps[this.attrs.namespace][this.attrs.type]:this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type](this.scope.options):new google.maps[this.attrs.namespace][this.attrs.type](this.scope.options),null!=this.gObject&&this.doShow&&this.gObject.setMap(this.gMap),null!=this.gObject&&null!=this.onLayerCreated)return"function"==typeof(t=this.onLayerCreated(this.scope,this.gObject))?t(this.gObject):void 0},o}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMapTypeParentModel",["uiGmapBaseObject","uiGmapLogger",function(r,i){var o;
return o=function(r){function o(n,r,o,a,s){return this.scope=n,this.element=r,this.attrs=o,this.gMap=a,this.$log=null!=s?s:i,this.hideOverlay=t(this.hideOverlay,this),this.showOverlay=t(this.showOverlay,this),this.refreshMapType=t(this.refreshMapType,this),this.createMapType=t(this.createMapType,this),null==this.attrs.options?void this.$log.info("options attribute for the map-type directive is mandatory. Map type creation aborted!!"):(this.id=this.gMap.overlayMapTypesCount=this.gMap.overlayMapTypesCount+1||0,this.doShow=!0,this.createMapType(),e.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.showOverlay(),this.scope.$watch("show",function(t){return function(e,n){if(e!==n)return t.doShow=e,e?t.showOverlay():t.hideOverlay()}}(this),!0),this.scope.$watchCollection("options",function(t){return function(e,n){var r,i;if(!_.isEqual(e,n)&&(i=["tileSize","maxZoom","minZoom","name","alt"],r=_.some(i,function(t){return!n||!e||!_.isEqual(e[t],n[t])})))return t.refreshMapType()}}(this)),e.isDefined(this.attrs.refresh)&&this.scope.$watch("refresh",function(t){return function(e,n){if(!_.isEqual(e,n))return t.refreshMapType()}}(this),!0),void this.scope.$on("$destroy",function(t){return function(){return t.hideOverlay(),t.mapType=null}}(this)))}return n(o,r),o.prototype.createMapType=function(){if(null!=this.scope.options.getTile)this.mapType=this.scope.options;else{if(null==this.scope.options.getTileUrl)return void this.$log.info("options should provide either getTile or getTileUrl methods. Map type creation aborted!!");this.mapType=new google.maps.ImageMapType(this.scope.options)}return this.attrs.id&&this.scope.id&&(this.gMap.mapTypes.set(this.scope.id,this.mapType),e.isDefined(this.attrs.show)||(this.doShow=!1)),this.mapType.layerId=this.id},o.prototype.refreshMapType=function(){if(this.hideOverlay(),this.mapType=null,this.createMapType(),this.doShow&&null!=this.gMap)return this.showOverlay()},o.prototype.showOverlay=function(){return this.gMap.overlayMapTypes.push(this.mapType)},o.prototype.hideOverlay=function(){var t;return t=!1,this.gMap.overlayMapTypes.forEach(function(e){return function(n,r){t||n.layerId!==e.id||(t=!0,e.gMap.overlayMapTypes.removeAt(r))}}(this))},o}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMarkersParentModel",["uiGmapIMarkerParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapMarkerChildModel","uiGmap_async","uiGmapClustererMarkerManager","uiGmapMarkerManager","$timeout","uiGmapIMarker","uiGmapPromise","uiGmapGmapUtil","uiGmapLogger","uiGmapSpiderfierMarkerManager",function(r,i,o,a,s,l,u,c,d,h,p,f,g){var v,m;return m=function(t,e){return e.plurals=new o,e.scope.plurals=e.plurals,e},v=function(r){function c(e,n,r,i){this.maybeExecMappedEvent=t(this.maybeExecMappedEvent,this),this.onDestroy=t(this.onDestroy,this),this.newChildMarker=t(this.newChildMarker,this),this.pieceMeal=t(this.pieceMeal,this),this.rebuildAll=t(this.rebuildAll,this),this.createAllNew=t(this.createAllNew,this),this.bindToTypeEvents=t(this.bindToTypeEvents,this),this.createChildScopes=t(this.createChildScopes,this),this.validateScope=t(this.validateScope,this),this.onWatch=t(this.onWatch,this),c.__super__.constructor.call(this,e,n,r,i),this.interface=d,m(new o,this),this.scope.pluralsUpdate={updateCtr:0},this.$log.info(this),this.doRebuildAll=null!=this.scope.doRebuildAll&&this.scope.doRebuildAll,this.setIdKey(this.scope),this.scope.$watch("doRebuildAll",function(t){return function(e,n){if(e!==n)return t.doRebuildAll=e}}(this)),this.modelsLength()||(this.modelsRendered=!1),this.scope.$watch("models",function(t){return function(e,n){if(!_.isEqual(e,n)||!t.modelsRendered){if(0===e.length&&0===n.length)return;return t.modelsRendered=!0,t.onWatch("models",t.scope,e,n)}}}(this),!this.isTrue(r.modelsbyref)),this.watch("doCluster",this.scope),this.watch("type",this.scope),this.watch("clusterOptions",this.scope),this.watch("clusterEvents",this.scope),this.watch("typeOptions",this.scope),this.watch("typeEvents",this.scope),this.watch("fit",this.scope),this.watch("idKey",this.scope),this.gManager=void 0,this.createAllNew(this.scope)}return n(c,r),c.include(p),c.include(i),c.prototype.onWatch=function(t,e,n,r){return"idKey"===t&&n!==r&&(this.idKey=n),this.doRebuildAll||"doCluster"===t||"type"===t?this.rebuildAll(e):this.pieceMeal(e)},c.prototype.validateScope=function(t){var n;return n=e.isUndefined(t.models)||void 0===t.models,n&&this.$log.error(this.constructor.name+": no valid models attribute found"),c.__super__.validateScope.call(this,t)||n},c.prototype.createChildScopes=function(t){if(null!=this.gMap&&null!=this.scope.models)return t?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)},c.prototype.bindToTypeEvents=function(t,n){var r,i;return null==n&&(n=["click","mouseout","mouseover"]),i=this,this.origTypeEvents?e.extend(t,this.origTypeEvents):(this.origTypeEvents={},_.each(n,function(e){return function(n){return e.origTypeEvents[n]=null!=t?t[n]:void 0}}(this))),r={},_.each(n,function(t){return r[t]=function(e){return i.maybeExecMappedEvent(e,t)}}),e.extend(t,r)},c.prototype.createAllNew=function(t){var e,n,r,i;if(null!=this.gManager&&(this.gManager instanceof g&&(e=this.gManager.isSpiderfied()),this.gManager.clear(),delete this.gManager),r=t.typeEvents||t.clusterEvents,i=t.typeOptions||t.clusterOptions,t.doCluster||"cluster"===t.type?(null!=r&&this.bindToTypeEvents(r),this.gManager=new l(this.map,(void 0),i,r)):"spider"===t.type?(null!=r&&this.bindToTypeEvents(r,["spiderfy","unspiderfy"]),this.gManager=new g(this.map,(void 0),i,r,this.scope),e&&this.gManager.spiderfy()):this.gManager=new u(this.map),!this.didQueueInitPromise(this,t))return n=null,s.promiseLock(this,h.promiseTypes.create,"createAllNew",function(t){return n=t},function(e){return function(){return s.each(t.models,function(r){return e.newChildMarker(r,t),n},s.chunkSizeFrom(t.chunk)).then(function(){return e.modelsRendered=!0,t.fit&&e.gManager.fit(),e.gManager.draw(),e.scope.pluralsUpdate.updateCtr+=1},s.chunkSizeFrom(t.chunk))}}(this))},c.prototype.rebuildAll=function(t){var e;if(t.doRebuild||void 0===t.doRebuild)return(null!=(e=this.scope.plurals)?e.length:void 0)?this.onDestroy(t).then(function(e){return function(){return e.createAllNew(t)}}(this)):this.createAllNew(t)},c.prototype.pieceMeal=function(t){var e,n;if(!t.$$destroyed)return e=null,n=null,this.modelsLength()&&this.scope.plurals.length?s.promiseLock(this,h.promiseTypes.update,"pieceMeal",function(t){return e=t},function(r){return function(){return h.promise(function(){return r.figureOutState(r.idKey,t,r.scope.plurals,r.modelKeyComparison)}).then(function(i){return n=i,s.each(n.removals,function(t){if(null!=t)return null!=t.destroy&&t.destroy(),r.scope.plurals.remove(t.id),e},s.chunkSizeFrom(t.chunk))}).then(function(){return s.each(n.adds,function(n){return r.newChildMarker(n,t),e},s.chunkSizeFrom(t.chunk))}).then(function(){return s.each(n.updates,function(t){return r.updateChild(t.child,t.model),e},s.chunkSizeFrom(t.chunk))}).then(function(){return(n.adds.length>0||n.removals.length>0||n.updates.length>0)&&(t.plurals=r.scope.plurals,t.fit&&r.gManager.fit(),r.gManager.draw()),r.scope.pluralsUpdate.updateCtr+=1})}}(this)):(this.inProgress=!1,this.rebuildAll(t))},c.prototype.newChildMarker=function(t,e){var n,r,i;if(!t)throw"model undefined";return null==t[this.idKey]?void this.$log.error("Marker model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.$log.info("child",n,"markers",this.scope.markerModels),r=e.$new(!1),r.events=e.events,i={},d.scopeKeys.forEach(function(t){return i[t]=e[t]}),n=new a({scope:r,model:t,keys:i,gMap:this.map,defaults:this.DEFAULTS,doClick:this.doClick,gManager:this.gManager,doDrawSelf:!1,isScopeModel:!0}),this.scope.plurals.put(t[this.idKey],n),n)},c.prototype.onDestroy=function(t){return c.__super__.onDestroy.call(this,t),s.promiseLock(this,h.promiseTypes.delete,void 0,void 0,function(t){return function(){return s.each(t.scope.plurals.values(),function(t){if(null!=t)return t.destroy(!1)},s.chunkSizeFrom(t.scope.cleanchunk,!1)).then(function(){return null!=t.gManager&&t.gManager.destroy(),t.plurals.removeAll(),t.plurals!==t.scope.plurals&&console.error("plurals out of sync for MarkersParentModel"),t.scope.pluralsUpdate.updateCtr+=1})}}(this))},c.prototype.maybeExecMappedEvent=function(t,e){var n,r;if(!this.scope.$$destroyed)return r=this.scope.typeEvents||this.scope.clusterEvents,_.isFunction(null!=r?r[e]:void 0)&&(n=this.mapTypeToPlurals(t),this.origTypeEvents[e])?this.origTypeEvents[e](n.group,n.mapped):void 0},c.prototype.mapTypeToPlurals=function(t){var e,n,r;return _.isArray(t)?e=t:_.isFunction(t.getMarkers)&&(e=t.getMarkers()),null==e?void f.error("Unable to map event as we cannot find the array group to map"):(n=(null!=(r=this.scope.plurals.values())?r.length:void 0)?e.map(function(t){return function(e){return t.scope.plurals.get(e.key).model}}(this)):[],{cluster:t,mapped:n,group:t})},c.prototype.getItem=function(t,e,n){return"models"===e?t[e][n]:t[e].get(n)},c}(r)}])}.call(this),function(){["Polygon","Polyline"].forEach(function(t){return e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmap"+t+"sParentModel",["uiGmapBasePolysParentModel","uiGmap"+t+"ChildModel","uiGmapI"+t,function(e,n,r){return e(r,n,t)}])})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapRectangleParentModel",["uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapRectangleOptionsBuilder",function(e,n,r,i){var o;return o=function(i){function o(t,n,r,i,o){var a,s,l,u,c,d,h,p,f,g,v;this.scope=t,this.attrs=r,this.gMap=i,this.DEFAULTS=o,a=void 0,u=!1,f=[],p=void 0,c=function(t){return function(){if(t.isTrue(t.attrs.fit))return t.fitMapBounds(t.gMap,a)}}(this),l=function(t){return function(){var n,r,i;return null!=t.scope.bounds&&null!=(null!=(n=t.scope.bounds)?n.sw:void 0)&&null!=(null!=(r=t.scope.bounds)?r.ne:void 0)&&t.validateBoundPoints(t.scope.bounds)?(a=t.convertBoundPoints(t.scope.bounds),e.info("new new bounds created: "+JSON.stringify(a))):null!=t.scope.bounds.getNorthEast&&null!=t.scope.bounds.getSouthWest?a=t.scope.bounds:null!=t.scope.bounds?e.error("Invalid bounds for newValue: "+JSON.stringify(null!=(i=t.scope)?i.bounds:void 0)):void 0}}(this),l(),d=new google.maps.Rectangle(this.buildOpts(a)),e.info("gObject (rectangle) created: "+d),g=!1,v=function(t){return function(){var e,n,r;if(e=d.getBounds(),n=e.getNorthEast(),r=e.getSouthWest(),!g)return t.scope.$evalAsync(function(t){if(null!=t.bounds&&null!=t.bounds.sw&&null!=t.bounds.ne&&(t.bounds.ne={latitude:n.lat(),longitude:n.lng()},t.bounds.sw={latitude:r.lat(),longitude:r.lng()}),null!=t.bounds.getNorthEast&&null!=t.bounds.getSouthWest)return t.bounds=e})}}(this),h=function(t){return function(){return c(),t.removeEvents(f),f.push(google.maps.event.addListener(d,"dragstart",function(){return u=!0})),f.push(google.maps.event.addListener(d,"dragend",function(){return u=!1,v()})),f.push(google.maps.event.addListener(d,"bounds_changed",function(){if(!u)return v()}))}}(this),s=function(t){return function(){return t.removeEvents(f),null!=p&&t.removeEvents(p),d.setMap(null)}}(this),null!=a&&h(),this.scope.$watch("bounds",function(t,e){var n;if(!(_.isEqual(t,e)&&null!=a||u))return g=!0,null==t?void s():(null==a?n=!0:c(),l(),d.setBounds(a),g=!1,n&&null!=a?h():void 0)},!0),this.setMyOptions=function(t){return function(e,n){if(!_.isEqual(e,n)&&null!=a&&null!=e)return d.setOptions(t.buildOpts(a))}}(this),this.props.push("bounds"),this.watchProps(this.props),null!=this.attrs.events&&(p=this.setEvents(d,this.scope,this.scope),this.scope.$watch("events",function(t){return function(e,n){if(!_.isEqual(e,n))return null!=p&&t.removeEvents(p),p=t.setEvents(d,t.scope,t.scope)}}(this))),this.scope.$on("$destroy",function(){return s()}),e.info(this)}return t(o,i),o.include(n),o.include(r),o}(i)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapSearchBoxParentModel",["uiGmapBaseObject","uiGmapLogger","uiGmapEventsHelper",function(r,i,o){var a;return a=function(r){function a(n,r,o,a,s,l,u){var c;return this.scope=n,this.element=r,this.attrs=o,this.gMap=a,this.ctrlPosition=s,this.template=l,this.$log=null!=u?u:i,this.setVisibility=t(this.setVisibility,this),this.getBounds=t(this.getBounds,this),this.setBounds=t(this.setBounds,this),this.createSearchBox=t(this.createSearchBox,this),this.addToParentDiv=t(this.addToParentDiv,this),this.addAsMapControl=t(this.addAsMapControl,this),this.init=t(this.init,this),null==this.attrs.template?void this.$log.error("template attribute for the search-box directive is mandatory. Places Search Box creation aborted!!"):(e.isUndefined(this.scope.options)&&(this.scope.options={},this.scope.options.visible=!0),e.isUndefined(this.scope.options.visible)&&(this.scope.options.visible=!0),e.isUndefined(this.scope.options.autocomplete)&&(this.scope.options.autocomplete=!1),this.visible=this.scope.options.visible,this.autocomplete=this.scope.options.autocomplete,c=e.element("<div></div>"),c.append(this.template),this.input=c.find("input")[0],void this.init())}return n(a,r),a.include(o),a.prototype.init=function(){return this.createSearchBox(),this.scope.$watch("options",function(t){return function(n,r){if(e.isObject(n)&&(null!=n.bounds&&t.setBounds(n.bounds),null!=n.visible&&t.visible!==n.visible))return t.setVisibility(n.visible)}}(this),!0),null!=this.attrs.parentdiv?this.addToParentDiv():this.addAsMapControl(),this.visible||this.setVisibility(this.visible),this.autocomplete?this.listener=google.maps.event.addListener(this.gObject,"place_changed",function(t){return function(){return t.places=t.gObject.getPlace()}}(this)):this.listener=google.maps.event.addListener(this.gObject,"places_changed",function(t){return function(){return t.places=t.gObject.getPlaces()}}(this)),this.listeners=this.setEvents(this.gObject,this.scope,this.scope),this.$log.info(this),this.scope.$on("$stateChangeSuccess",function(t){return function(){if(null!=t.attrs.parentdiv)return t.addToParentDiv()}}(this)),this.scope.$on("$destroy",function(t){return function(){return t.gObject=null}}(this))},a.prototype.addAsMapControl=function(){return this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input)},a.prototype.addToParentDiv=function(){var t;if(this.parentDiv=e.element(document.getElementById(this.scope.parentdiv)),null!=(t=this.parentDiv)?t.length:void 0)return this.parentDiv.append(this.input)},a.prototype.createSearchBox=function(){return this.autocomplete?this.gObject=new google.maps.places.Autocomplete(this.input,this.scope.options):this.gObject=new google.maps.places.SearchBox(this.input,this.scope.options)},a.prototype.setBounds=function(t){if(e.isUndefined(t.isEmpty))this.$log.error("Error: SearchBoxParentModel setBounds. Bounds not an instance of LatLngBounds.");else if(t.isEmpty()===!1&&null!=this.gObject)return this.gObject.setBounds(t)},a.prototype.getBounds=function(){return this.gObject.getBounds()},a.prototype.setVisibility=function(t){return null!=this.attrs.parentdiv?t===!1?this.parentDiv.addClass("ng-hide"):this.parentDiv.removeClass("ng-hide"):t===!1?this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].clear():this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input),this.visible=t},a}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapWindowsParentModel",["uiGmapIWindowParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapWindowChildModel","uiGmapLinked","uiGmap_async","uiGmapLogger","$timeout","$compile","$http","$templateCache","$interpolate","uiGmapPromise","uiGmapIWindow","uiGmapGmapUtil",function(r,i,o,a,s,l,u,c,d,h,p,f,g,v,m){var y;return y=function(r){function y(e,n,r,i,a,l){this.gMap=a,this.markersScope=l,this.modelKeyComparison=t(this.modelKeyComparison,this),this.interpolateContent=t(this.interpolateContent,this),this.setChildScope=t(this.setChildScope,this),this.createWindow=t(this.createWindow,this),this.setContentKeys=t(this.setContentKeys,this),this.pieceMeal=t(this.pieceMeal,this),this.createAllNew=t(this.createAllNew,this),this.watchIdKey=t(this.watchIdKey,this),this.createChildScopes=t(this.createChildScopes,this),this.watchOurScope=t(this.watchOurScope,this),this.watchDestroy=t(this.watchDestroy,this),this.onDestroy=t(this.onDestroy,this),this.rebuildAll=t(this.rebuildAll,this),this.doINeedToWipe=t(this.doINeedToWipe,this),this.watchModels=t(this.watchModels,this),this.go=t(this.go,this),y.__super__.constructor.call(this,e,n,r,i,c,d,h,p),this.interface=v,this.plurals=new o,_.each(v.scopeKeys,function(t){return function(e){return t[e+"Key"]=void 0}}(this)),this.linked=new s(e,n,r,i),this.contentKeys=void 0,this.isIconVisibleOnClick=void 0,this.firstTime=!0,this.firstWatchModels=!0,this.$log.info(self),this.parentScope=void 0,this.go(e)}return n(y,r),y.include(i),y.prototype.go=function(t){return this.watchOurScope(t),this.doRebuildAll=null!=this.scope.doRebuildAll&&this.scope.doRebuildAll,t.$watch("doRebuildAll",function(t){return function(e,n){if(e!==n)return t.doRebuildAll=e}}(this)),this.createChildScopes()},y.prototype.watchModels=function(t){var e;return e=null!=this.markersScope?"pluralsUpdate":"models",t.$watch(e,function(e){return function(n,r){var i;if(!_.isEqual(n,r)||e.firstWatchModels)return e.firstWatchModels=!1,e.doRebuildAll||e.doINeedToWipe(t.models)?e.rebuildAll(t,!0,!0):(i=0===e.plurals.length,null!=e.existingPieces?_.last(e.existingPieces._content).then(function(){return e.createChildScopes(i)}):e.createChildScopes(i))}}(this),!0)},y.prototype.doINeedToWipe=function(t){var e;return e=null==t||0===t.length,this.plurals.length>0&&e},y.prototype.rebuildAll=function(t,e,n){return this.onDestroy(n).then(function(t){return function(){if(e)return t.createChildScopes()}}(this))},y.prototype.onDestroy=function(t){return y.__super__.onDestroy.call(this,this.scope),l.promiseLock(this,g.promiseTypes.delete,void 0,void 0,function(t){return function(){return l.each(t.plurals.values(),function(t){return t.destroy(!0)},l.chunkSizeFrom(t.scope.cleanchunk,!1)).then(function(){var e;return null!=(e=t.plurals)?e.removeAll():void 0})}}(this))},y.prototype.watchDestroy=function(t){return t.$on("$destroy",function(e){return function(){return e.firstWatchModels=!0,e.firstTime=!0,e.rebuildAll(t,!1,!0)}}(this))},y.prototype.watchOurScope=function(t){return _.each(v.scopeKeys,function(e){return function(n){var r;return r=n+"Key",e[r]="function"==typeof t[n]?t[n]():t[n]}}(this))},y.prototype.createChildScopes=function(t){var n,r,i;return null==t&&(t=!0),this.isIconVisibleOnClick=!0,e.isDefined(this.linked.attrs.isiconvisibleonclick)&&(this.isIconVisibleOnClick=this.linked.scope.isIconVisibleOnClick),n=e.isUndefined(this.linked.scope.models),!n||void 0!==this.markersScope&&void 0!==(null!=(r=this.markersScope)?r.plurals:void 0)&&void 0!==(null!=(i=this.markersScope)?i.models:void 0)?null!=this.gMap?null!=this.linked.scope.models?(this.watchIdKey(this.linked.scope),t?this.createAllNew(this.linked.scope,!1):this.pieceMeal(this.linked.scope,!1)):(this.parentScope=this.markersScope,this.watchIdKey(this.parentScope),t?this.createAllNew(this.markersScope,!0,"plurals",!1):this.pieceMeal(this.markersScope,!0,"plurals",!1)):void 0:void this.$log.error("No models to create windows from! Need direct models or models derived from markers!")},y.prototype.watchIdKey=function(t){return this.setIdKey(t),t.$watch("idKey",function(e){return function(n,r){if(n!==r&&null==n)return e.idKey=n,e.rebuildAll(t,!0,!0)}}(this))},y.prototype.createAllNew=function(t,e,n,r){var i;if(null==n&&(n="models"),null==r&&(r=!1),this.firstTime&&(this.watchModels(t),this.watchDestroy(t)),this.setContentKeys(t.models),!this.didQueueInitPromise(this,t))return i=null,l.promiseLock(this,g.promiseTypes.create,"createAllNew",function(t){return i=t},function(r){return function(){return l.each(t.models,function(o){var a,s;return a=e&&null!=(s=r.getItem(t,n,o[r.idKey]))?s.gObject:void 0,i||(!a&&r.markersScope&&u.error("Unable to get gMarker from markersScope!"),r.createWindow(o,a,r.gMap)),i},l.chunkSizeFrom(t.chunk)).then(function(){return r.firstTime=!1})}}(this))},y.prototype.pieceMeal=function(t,e,n,r){var i,o;if(null==n&&(n="models"),null==r&&(r=!0),!t.$$destroyed)return i=null,o=null,null!=t&&this.modelsLength()&&this.plurals.length?l.promiseLock(this,g.promiseTypes.update,"pieceMeal",function(t){return i=t},function(e){return function(){return g.promise(function(){return e.figureOutState(e.idKey,t,e.plurals,e.modelKeyComparison)}).then(function(n){return o=n,l.each(o.removals,function(t){if(null!=t)return e.plurals.remove(t.id),null!=t.destroy&&t.destroy(!0),i},l.chunkSizeFrom(t.chunk))}).then(function(){return l.each(o.adds,function(r){var o,a;if(o=null!=(a=e.getItem(t,n,r[e.idKey]))?a.gObject:void 0,!o)throw"Gmarker undefined";return e.createWindow(r,o,e.gMap),i})}).then(function(){return l.each(o.updates,function(t){return e.updateChild(t.child,t.model),i},l.chunkSizeFrom(t.chunk))})}}(this)):(u.debug("pieceMeal: rebuildAll"),this.rebuildAll(this.scope,!0,!0))},y.prototype.setContentKeys=function(t){if(this.modelsLength(t))return this.contentKeys=Object.keys(t[0])},y.prototype.createWindow=function(t,e,n){var r,i,o,s,l,u;return i=this.linked.scope.$new(!1),this.setChildScope(i,t),i.$watch("model",function(t){return function(e,n){if(e!==n)return t.setChildScope(i,e)}}(this),!0),o={html:function(e){return function(){return e.interpolateContent(e.linked.element.html(),t)}}(this)},this.DEFAULTS=this.scopeOrModelVal(this.optionsKey,this.scope,t)||{},s=this.createWindowOptions(e,i,o.html(),this.DEFAULTS),r=new a({model:t,scope:i,opts:s,isIconVisibleOnClick:this.isIconVisibleOnClick,gMap:n,markerScope:null!=(l=this.markersScope)&&null!=(u=l.plurals.get(t[this.idKey]))?u.scope:void 0,element:o,needToManualDestroy:!1,markerIsVisibleAfterWindowClose:!0,isScopeModel:!0}),null==t[this.idKey]?void this.$log.error("Window model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.plurals.put(t[this.idKey],r),r)},y.prototype.setChildScope=function(t,e){return _.each(v.scopeKeys,function(n){return function(r){var i,o;if(i=r+"Key",o="self"===n[i]?e:e[n[i]],o!==t[r])return t[r]=o}}(this)),t.model=e},y.prototype.interpolateContent=function(t,e){var n,r,i,o,a,s;if(void 0!==this.contentKeys&&0!==this.contentKeys.length){for(n=f(t),i={},s=this.contentKeys,r=0,a=s.length;r<a;r++)o=s[r],i[o]=e[o];return n(i)}},y.prototype.modelKeyComparison=function(t,e){var n,r;if(r=null!=this.scope.coords?this.scope:this.parentScope,null==r)throw"No scope or parentScope set!";return(n=m.equalCoords(this.evalModelHandle(t,r.coords),this.evalModelHandle(e,r.coords)))?n=_.every(_.without(this.interface.scopeKeys,"coords"),function(n){return function(i){return n.evalModelHandle(t,r[i])===n.evalModelHandle(e,r[i])}}(this)):n},y}(r)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapCircle",["uiGmapICircle","uiGmapCircleParentModel",function(t,e){return _.extend(t,{link:function(t,n,r,i){return i.getScope().deferred.promise.then(function(i){return new e(t,n,r,i)})}})}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapControl",["uiGmapIControl","$http","$templateCache","$compile","$controller","uiGmapGoogleMapApi",function(r,i,o,a,s,l){var u;return u=function(u){function c(){this.link=t(this.link,this),c.__super__.constructor.call(this)}return n(c,u),c.prototype.link=function(t,n,u,c){return l.then(function(n){return function(l){var u,d;return e.isUndefined(t.template)?void n.$log.error("mapControl: could not find a valid template property"):(u=e.isDefined(t.index&&!isNaN(parseInt(t.index)))?parseInt(t.index):void 0,d=e.isDefined(t.position)?t.position.toUpperCase().replace(/-/g,"_"):"TOP_CENTER",l.ControlPosition[d]?r.mapPromise(t,c).then(function(r){var l,c;return l=void 0,c=e.element("<div></div>"),i.get(t.template,{cache:o}).success(function(n){var r,i;if(i=t.$new(),c.append(n),e.isDefined(t.controller)&&(r=s(t.controller,{$scope:i}),c.children().data("$ngControllerController",r)),l=a(c.children())(i),u)return l[0].index=u}).error(function(t){return n.$log.error("mapControl: template could not be found")}).then(function(){return r.controls[google.maps.ControlPosition[d]].push(l[0])})}):void n.$log.error("mapControl: invalid position property"))}}(this))},c}(r)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").service("uiGmapDragZoom",["uiGmapCtrlHandle","uiGmapPropertyAction",function(t,e){return{restrict:"EMA",transclude:!0,template:'<div class="angular-google-map-dragzoom" ng-transclude style="display: none"></div>',require:"^uiGmapGoogleMap",scope:{keyboardkey:"=",options:"=",spec:"="},controller:["$scope","$element",function(e,n){return e.ctrlType="uiGmapDragZoom",_.extend(this,t.handle(e,n))}],link:function(n,r,i,o){return t.mapPromise(n,o).then(function(t){var r,i,o;return r=function(e){return t.enableKeyDragZoom(e)},i=new e(function(t,e){return e?r({key:e}):r()}),o=new e(function(t,e){if(e)return r(e)}),n.$watch("keyboardkey",i.sic("keyboardkey")),i.sic(n.keyboardkey),n.$watch("options",o.sic("options")),o.sic(n.options)})}}}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapDrawingManager",["uiGmapIDrawingManager","uiGmapDrawingManagerParentModel",function(t,e){return _.extend(t,{link:function(t,n,r,i){return i.getScope().deferred.promise.then(function(i){return new e(t,n,r,i)})}})}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapApiFreeDrawPolygons",["uiGmapLogger","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapDrawFreeHandChildModel","uiGmapLodash",function(e,r,i,o,a){var s;return s=function(r){function s(){return this.link=t(this.link,this),s.__super__.constructor.apply(this,arguments)}return n(s,r),s.include(i),s.prototype.restrict="EMA",s.prototype.replace=!0,s.prototype.require="^uiGmapGoogleMap",s.prototype.scope={polygons:"=",draw:"="},s.prototype.link=function(t,n,r,i){return this.mapPromise(t,i).then(function(n){return function(n){var r,s;return t.polygons?_.isArray(t.polygons)?(r=new o(n,i.getScope()),s=void 0,t.draw=function(){return"function"==typeof s&&s(),r.engage(t.polygons).then(function(){var e;return e=!0,s=t.$watchCollection("polygons",function(t,n){var r;return e||t===n?void(e=!1):(r=a.differenceObjects(n,t),r.forEach(function(t){return t.setMap(null)}))})})}):e.error("Free Draw Polygons must be of type Array!"):e.error("No polygons to bind to!")}}(this))},s}(r)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").service("uiGmapICircle",[function(){var t;return t={},{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{center:"=center",radius:"=radius",stroke:"=stroke",fill:"=fill",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=icons",visible:"=",events:"=",control:"=",zIndex:"=zindex"}}}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIControl",["uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(e,n,r){var i;return i=function(e){function i(){this.restrict="EA",this.replace=!0,this.require="^uiGmapGoogleMap",this.scope={template:"@template",position:"@position",controller:"@controller",index:"@index"},this.$log=n}return t(i,e),i.extend(r),i.prototype.link=function(t,e,n,r){throw new Exception("Not implemented!!")},i}(e)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").service("uiGmapIDrawingManager",[function(){return{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{static:"@",control:"=",options:"=",events:"="}}}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIMarker",["uiGmapBaseObject","uiGmapCtrlHandle",function(e,n){var r;return r=function(e){function r(){this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.replace=!0,this.scope=_.extend(this.scope||{},r.scope)}return t(r,e),r.scope={coords:"=coords",icon:"=icon",click:"&click",options:"=options",events:"=events",fit:"=fit",idKey:"=idkey",control:"=control"},r.scopeKeys=_.keys(r.scope),r.keys=r.scopeKeys,r.extend(n),r}(e)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolygon",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(e,n,r,i){var o;return o=function(n){function o(){}return t(o,n),o.scope={path:"=path",stroke:"=stroke",clickable:"=",draggable:"=",editable:"=",geodesic:"=",fill:"=",icons:"=icons",visible:"=",static:"=",events:"=",zIndex:"=zindex",fit:"=",control:"=control"},o.scopeKeys=_.keys(o.scope),o.include(e),o.extend(i),o.prototype.restrict="EMA",o.prototype.replace=!0,o.prototype.require="^uiGmapGoogleMap",o.prototype.scope=o.scope,o.prototype.DEFAULTS={},o.prototype.$log=r,o}(n)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolyline",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(e,n,r,i){var o;return o=function(n){function o(){}return t(o,n),o.scope={path:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=",visible:"=",static:"=",fit:"=",events:"=",zIndex:"=zindex"},o.scopeKeys=_.keys(o.scope),o.include(e),o.extend(i),o.prototype.restrict="EMA",o.prototype.replace=!0,o.prototype.require="^uiGmapGoogleMap",o.prototype.scope=o.scope,o.prototype.DEFAULTS={},o.prototype.$log=r,o}(n)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").service("uiGmapIRectangle",[function(){
var t;return t={},{restrict:"EMA",require:"^uiGmapGoogleMap",replace:!0,scope:{bounds:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",fill:"=",visible:"=",events:"="}}}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIWindow",["uiGmapBaseObject","uiGmapChildEvents","uiGmapCtrlHandle",function(e,n,r){var i;return i=function(e){function i(){this.restrict="EMA",this.template=void 0,this.transclude=!0,this.priority=-100,this.require="^uiGmapGoogleMap",this.replace=!0,this.scope=_.extend(this.scope||{},i.scope)}return t(i,e),i.scope={coords:"=coords",template:"=template",templateUrl:"=templateurl",templateParameter:"=templateparameter",isIconVisibleOnClick:"=isiconvisibleonclick",closeClick:"&closeclick",options:"=options",control:"=control",show:"=show"},i.scopeKeys=_.keys(i.scope),i.include(n),i.extend(r),i}(e)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMap",["$timeout","$q","$log","uiGmapGmapUtil","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapIsReady","uiGmapuuid","uiGmapExtendGWin","uiGmapExtendMarkerClusterer","uiGmapGoogleMapsUtilV3","uiGmapGoogleMapApi","uiGmapEventsHelper","uiGmapGoogleMapObjectManager",function(r,i,o,a,s,l,u,c,d,h,p,f,g,v){var m,y,b;return m=void 0,b=[p,d,h],y=function(i){function s(){this.link=t(this.link,this);var e;e=function(t){var e,n;return n=void 0,t.$on("$destroy",function(){return u.decrement()}),e=l.handle(t),t.ctrlType="Map",t.deferred.promise.then(function(){return b.forEach(function(t){return t.init()})}),e.getMap=function(){return t.map},n=_.extend(this,e)},this.controller=["$scope",e]}return n(s,i),s.include(a),s.prototype.restrict="EMA",s.prototype.transclude=!0,s.prototype.replace=!1,s.prototype.template='<div class="angular-google-map"><div class="angular-google-map-container">\n</div><div ng-transclude style="display: none"></div></div>',s.prototype.scope={center:"=",zoom:"=",dragging:"=",control:"=",options:"=",events:"=",eventOpts:"=",styles:"=",bounds:"=",update:"="},s.prototype.link=function(t,n,i){var a,s;return a=[],t.$on("$destroy",function(){if(g.removeEvents(a),"true"===i.recycleMapInstance&&t.map)return v.recycleMapInstance(t.map),t.map=null}),t.idleAndZoomChanged=!1,null==t.center?void(s=t.$watch("center",function(e){return function(){if(t.center)return s(),e.link(t,n,i)}}(this))):f.then(function(s){return function(l){var d,h,p,f,y,b,x,w,k,M,C,S,L,A,E,T,P;if(m={mapTypeId:l.MapTypeId.ROADMAP},A=u.spawn(),S=function(){return A.deferred.resolve({instance:A.instance,map:d})},!s.validateCoords(t.center))return void o.error("angular-google-maps: could not find a valid center property");if(!e.isDefined(t.zoom))return void o.error("angular-google-maps: map zoom property not set");if(y=e.element(n),y.addClass("angular-google-map"),M={options:{}},i.options&&(M.options=t.options),i.styles&&(M.styles=t.styles),i.type&&(E=i.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(E)?M.mapTypeId=google.maps.MapTypeId[i.type.toUpperCase()]:o.error("angular-google-maps: invalid map type '"+i.type+"'")),w=e.extend({},m,M,{center:s.getCoords(t.center),zoom:t.zoom,bounds:t.bounds}),d="true"===i.recycleMapInstance?v.createMapInstance(y.find("div")[1],w):new google.maps.Map(y.find("div")[1],w),d.uiGmap_id=c.generate(),f=!1,a.push(google.maps.event.addListenerOnce(d,"idle",function(){return t.deferred.resolve(d),S()})),p=i.events&&null!=(null!=(C=t.events)?C.blacklist:void 0)?t.events.blacklist:[],_.isString(p)&&(p=[p]),k=function(e,n,r){if(!_.includes(p,e))return r&&r(),a.push(google.maps.event.addListener(d,e,function(){var e;if(!(null!=(e=t.update)?e.lazy:void 0))return n()}))},_.includes(p,"all")||(k("dragstart",function(){return f=!0,t.$evalAsync(function(t){if(null!=t.dragging)return t.dragging=f})}),k("dragend",function(){return f=!1,t.$evalAsync(function(t){if(null!=t.dragging)return t.dragging=f})}),T=function(n,r){if(null==n&&(n=d.center),null==r&&(r=t),!_.includes(p,"center"))if(e.isDefined(r.center.type)){if(r.center.coordinates[1]!==n.lat()&&(r.center.coordinates[1]=n.lat()),r.center.coordinates[0]!==n.lng())return r.center.coordinates[0]=n.lng()}else if(r.center.latitude!==n.lat()&&(r.center.latitude=n.lat()),r.center.longitude!==n.lng())return r.center.longitude=n.lng()},L=!1,k("idle",function(){var e,n,r;return e=d.getBounds(),n=e.getNorthEast(),r=e.getSouthWest(),L=!0,t.$evalAsync(function(e){return T(),_.isUndefined(e.bounds)||_.includes(p,"bounds")||(e.bounds.northeast={latitude:n.lat(),longitude:n.lng()},e.bounds.southwest={latitude:r.lat(),longitude:r.lng()}),_.includes(p,"zoom")||(e.zoom=d.zoom,t.idleAndZoomChanged=!t.idleAndZoomChanged),L=!1})})),e.isDefined(t.events)&&null!==t.events&&e.isObject(t.events)){x=function(e){return function(){return t.events[e].apply(t,[d,e,arguments])}},h=[];for(b in t.events)t.events.hasOwnProperty(b)&&e.isFunction(t.events[b])&&h.push(google.maps.event.addListener(d,b,x(b)));a.concat(h)}return d.getOptions=function(){return w},t.map=d,null!=i.control&&null!=t.control&&(t.control.refresh=function(t){var e,n,r;if(null!=d)return null!=("undefined"!=typeof google&&null!==google&&null!=(n=google.maps)&&null!=(r=n.event)?r.trigger:void 0)&&null!=d&&google.maps.event.trigger(d,"resize"),null!=(null!=t?t.latitude:void 0)&&null!=(null!=t?t.longitude:void 0)?(e=s.getCoords(t),s.isTrue(i.pan)?d.panTo(e):d.setCenter(e)):void 0},t.control.getGMap=function(){return d},t.control.getMapOptions=function(){return w},t.control.getCustomEventListeners=function(){return h},t.control.removeEvents=function(t){return g.removeEvents(t)}),t.$watch("center",function(e,n){var r;if(e!==n&&!L&&(r=s.getCoords(t.center),r.lat()!==d.center.lat()||r.lng()!==d.center.lng()))return f?void 0:(s.validateCoords(e)||o.error("Invalid center for newValue: "+JSON.stringify(e)),s.isTrue(i.pan)&&t.zoom===d.zoom?d.panTo(r):d.setCenter(r))},!0),P=null,t.$watch("zoom",function(e,n){var i,o;if(null!=e&&!_.isEqual(e,n)&&(null!=d?d.getZoom():void 0)!==(null!=t?t.zoom:void 0)&&!L)return null!=P&&r.cancel(P),P=r(function(){return d.setZoom(e)},(null!=(i=t.eventOpts)&&null!=(o=i.debounce)?o.zoomMs:void 0)+20,!1)}),t.$watch("bounds",function(t,e){var n,r,i,a,s,l,u;if(t!==e)return null==(null!=t&&null!=(i=t.northeast)?i.latitude:void 0)||null==(null!=t&&null!=(a=t.northeast)?a.longitude:void 0)||null==(null!=t&&null!=(s=t.southwest)?s.latitude:void 0)||null==(null!=t&&null!=(l=t.southwest)?l.longitude:void 0)?void o.error("Invalid map bounds for new value: "+JSON.stringify(t)):(r=new google.maps.LatLng(t.northeast.latitude,t.northeast.longitude),u=new google.maps.LatLng(t.southwest.latitude,t.southwest.longitude),n=new google.maps.LatLngBounds(u,r),d.fitBounds(n))}),["options","styles"].forEach(function(e){return t.$watch(e,function(t,n){if(!_.isEqual(t,n))return"options"===e?M.options=t:M.options[e]=t,null!=d?d.setOptions(M):void 0},!0)})}}(this))},s}(s)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarker",["uiGmapIMarker","uiGmapMarkerChildModel","uiGmapMarkerManager","uiGmapLogger",function(e,n,r,i){var o;return o=function(o){function a(){a.__super__.constructor.call(this),this.template='<span class="angular-google-map-marker" ng-transclude></span>',i.info(this)}return t(a,o),a.prototype.controller=["$scope","$element",function(t,n){return t.ctrlType="Marker",_.extend(this,e.handle(t,n))}],a.prototype.link=function(t,i,o,a){var s;return s=e.mapPromise(t,a),s.then(function(i){var o,a,s;if(o=new r(i),a=_.object(e.keys,e.keys),s=new n({scope:t,model:t,keys:a,gMap:i,doClick:!0,gManager:o,doDrawSelf:!1,trackModel:!1}),s.deferred.promise.then(function(e){return t.deferred.resolve(e)}),null!=t.control)return t.control.getGMarkers=o.getGMarkers}),t.$on("$destroy",function(){var t;return"undefined"!=typeof t&&null!==t&&t.clear(),t=null})},a}(e)}])}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarkers",["uiGmapIMarker","uiGmapPlural","uiGmapMarkersParentModel","uiGmap_sync","uiGmapLogger",function(e,n,r,i,o){var a;return a=function(i){function a(){a.__super__.constructor.call(this),this.template='<span class="angular-google-map-markers" ng-transclude></span>',n.extend(this,{doCluster:"=?docluster",clusterOptions:"=clusteroptions",clusterEvents:"=clusterevents",modelsByRef:"=modelsbyref",type:"=?type",typeOptions:"=?typeoptions",typeEvents:"=?typeevents"}),o.info(this)}return t(a,i),a.prototype.controller=["$scope","$element",function(t,n){return t.ctrlType="Markers",_.extend(this,e.handle(t,n))}],a.prototype.link=function(t,i,o,a){var s,l;return s=void 0,l=function(){return t.deferred.resolve()},e.mapPromise(t,a).then(function(e){var u;return u=a.getScope(),u.$watch("idleAndZoomChanged",function(){return _.defer(s.gManager.draw)}),s=new r(t,i,o,e),n.link(t,s),null!=t.control&&(t.control.getGMarkers=function(){var t;return null!=(t=s.gManager)?t.getGMarkers():void 0},t.control.getChildMarkers=function(){return s.plurals}),_.last(s.existingPieces._content).then(function(){return l()})})},a}(e)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").service("uiGmapPlural",[function(){var t;return t=function(t,e){if(null!=t.control)return t.control.updateModels=function(n){return t.models=n,e.createChildScopes(!1)},t.control.newModels=function(n){return t.models=n,e.rebuildAll(t,!0,!0)},t.control.clean=function(){return e.rebuildAll(t,!1,!0)},t.control.getPlurals=function(){return e.plurals},t.control.getManager=function(){return e.gManager},t.control.hasManager=function(){return null!=e.gManager==!0},t.control.managerDraw=function(){var e;if(t.control.hasManager())return null!=(e=t.control.getManager())?e.draw():void 0}},{extend:function(t,e){return _.extend(t.scope||{},e||{},{idKey:"=idkey",doRebuildAll:"=dorebuildall",models:"=models",chunk:"=chunk",cleanchunk:"=cleanchunk",control:"=control"})},link:function(e,n){return t(e,n)}}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygon",["uiGmapIPolygon","$timeout","uiGmapPolygonChildModel",function(e,r,i){var o;return o=function(r){function o(){return this.link=t(this.link,this),o.__super__.constructor.apply(this,arguments)}return n(o,r),o.prototype.link=function(t,n,r,o){var a,s;return a=[],s=e.mapPromise(t,o),null!=t.control&&(t.control.getInstance=this,t.control.polygons=a,t.control.promise=s),s.then(function(e){return function(n){return a.push(new i({scope:t,attrs:r,gMap:n,defaults:e.DEFAULTS}))}}(this))},o}(e)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygons",["uiGmapIPolygon","$timeout","uiGmapPolygonsParentModel","uiGmapPlural",function(r,i,o,a){var s;return s=function(r){function i(){this.link=t(this.link,this),i.__super__.constructor.call(this),a.extend(this),this.$log.info(this)}return n(i,r),i.prototype.link=function(t,n,r,i){return i.getScope().deferred.promise.then(function(i){return function(s){return(e.isUndefined(t.path)||null===t.path)&&i.$log.warn("polygons: no valid path attribute found"),t.models||i.$log.warn("polygons: no models found to create from"),a.link(t,new o(t,n,r,s,i.DEFAULTS))}}(this))},i}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolyline",["uiGmapIPolyline","$timeout","uiGmapPolylineChildModel",function(r,i,o){var a;return a=function(i){function a(){return this.link=t(this.link,this),a.__super__.constructor.apply(this,arguments)}return n(a,i),a.prototype.link=function(t,n,i,a){return r.mapPromise(t,a).then(function(n){return function(r){return!e.isUndefined(t.path)&&null!==t.path&&n.validatePath(t.path)||n.$log.warn("polyline: no valid path attribute found"),new o({scope:t,attrs:i,gMap:r,defaults:n.DEFAULTS})}}(this))},a}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylines",["uiGmapIPolyline","$timeout","uiGmapPolylinesParentModel","uiGmapPlural",function(r,i,o,a){var s;return s=function(r){function i(){this.link=t(this.link,this),i.__super__.constructor.call(this),a.extend(this),this.$log.info(this)}return n(i,r),i.prototype.link=function(t,n,r,i){return i.getScope().deferred.promise.then(function(i){return function(s){return(e.isUndefined(t.path)||null===t.path)&&i.$log.warn("polylines: no valid path attribute found"),t.models||i.$log.warn("polylines: no models found to create from"),a.link(t,new o(t,n,r,s,i.DEFAULTS))}}(this))},i}(r)}])}.call(this),function(){e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapRectangle",["uiGmapLogger","uiGmapGmapUtil","uiGmapIRectangle","uiGmapRectangleParentModel",function(t,e,n,r){return _.extend(n,{link:function(t,e,n,i){return i.getScope().deferred.promise.then(function(i){return new r(t,e,n,i)})}})}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindow",["uiGmapIWindow","uiGmapGmapUtil","uiGmapWindowChildModel","uiGmapLodash","uiGmapLogger",function(r,i,o,a,s){var l;return l=function(l){function u(){this.link=t(this.link,this),u.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarker"],this.template='<span class="angular-google-maps-window" ng-transclude></span>',s.debug(this),this.childWindows=[]}return n(u,l),u.include(i),u.prototype.link=function(t,n,i,o){var a,s;return a=o.length>1&&null!=o[1]?o[1]:void 0,s=null!=a?a.getScope():void 0,this.mapPromise=r.mapPromise(t,o[0]),this.mapPromise.then(function(r){return function(o){var l;return l=!0,e.isDefined(i.isiconvisibleonclick)&&(l=t.isIconVisibleOnClick),a?s.deferred.promise.then(function(e){return r.init(t,n,l,o,s)}):void r.init(t,n,l,o)}}(this))},u.prototype.init=function(t,e,n,r,i){var s,l,u,c,d;if(l=null!=t.options?t.options:{},c=null!=t&&this.validateCoords(t.coords),null!=(null!=i?i.getGMarker:void 0)&&(u=i.getGMarker()),d=c?this.createWindowOptions(u,t,e.html(),l):l,null!=r&&(s=new o({scope:t,opts:d,isIconVisibleOnClick:n,gMap:r,markerScope:i,element:e}),this.childWindows.push(s),t.$on("$destroy",function(t){return function(){return t.childWindows=a.withoutObjects(t.childWindows,[s],function(t,e){return t.scope.$id===e.scope.$id}),t.childWindows.length=0}}(this))),null!=t.control&&(t.control.getGWindows=function(t){return function(){return t.childWindows.map(function(t){return t.gObject})}}(this),t.control.getChildWindows=function(t){return function(){return t.childWindows}}(this),t.control.getPlurals=t.control.getChildWindows,t.control.showWindow=function(t){return function(){return t.childWindows.map(function(t){return t.showWindow()})}}(this),t.control.hideWindow=function(t){return function(){return t.childWindows.map(function(t){return t.hideWindow()})}}(this)),null!=this.onChildCreation&&null!=s)return this.onChildCreation(s)},u}(r)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;e.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindows",["uiGmapIWindow","uiGmapPlural","uiGmapWindowsParentModel","uiGmapPromise","uiGmapLogger",function(e,r,i,o,a){var s;return s=function(e){function s(){this.link=t(this.link,this),s.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarkers"],this.template='<span class="angular-google-maps-windows" ng-transclude></span>',r.extend(this),a.debug(this)}return n(s,e),s.prototype.link=function(t,e,n,r){var i,a,s;return i=r[0].getScope(),a=r.length>1&&null!=r[1]?r[1]:void 0,s=null!=a?a.getScope():void 0,i.deferred.promise.then(function(i){return function(a){var l,u;return l=(null!=s&&null!=(u=s.deferred)?u.promise:void 0)||o.resolve(),l.then(function(){var o,l;return o=null!=(l=i.parentModel)?l.existingPieces:void 0,o?o.then(function(){return i.init(t,e,n,r,a,s)}):i.init(t,e,n,r,a,s)})}}(this))},s.prototype.init=function(t,e,n,o,a,s){var l;if(l=new i(t,e,n,o,a,s),r.link(t,l),null!=t.control)return t.control.getGWindows=function(){return l.plurals.map(function(t){return t.gObject})},t.control.getChildWindows=function(){return l.plurals}},s}(e)}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapGoogleMap",["uiGmapMap",function(t){return new t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapMarker",["$timeout","uiGmapMarker",function(t,e){return new e(t)}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapMarkers",["$timeout","uiGmapMarkers",function(t,e){return new e(t)}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapPolygon",["uiGmapPolygon",function(t){return new t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapCircle",["uiGmapCircle",function(t){return t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapPolyline",["uiGmapPolyline",function(t){return new t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapPolylines",["uiGmapPolylines",function(t){return new t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapRectangle",["uiGmapLogger","uiGmapRectangle",function(t,e){return e}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapWindow",["$timeout","$compile","$http","$templateCache","uiGmapWindow",function(t,e,n,r,i){return new i(t,e,n,r)}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapWindows",["$timeout","$compile","$http","$templateCache","$interpolate","uiGmapWindows",function(t,e,n,r,i,o){return new o(t,e,n,r,i)}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps").directive("uiGmapLayer",["$timeout","uiGmapLogger","uiGmapLayerParentModel",function(e,n,r){var i;return new(i=function(){function e(){this.link=t(this.link,this),this.$log=n,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-layer' ng-transclude></span>",this.replace=!0,this.scope={show:"=show",type:"=type",namespace:"=namespace",options:"=options",onCreated:"&oncreated"}}return e.prototype.link=function(t,e,n,i){return i.getScope().deferred.promise.then(function(i){return function(i){return null!=t.onCreated?new r(t,e,n,i,t.onCreated):new r(t,e,n,i)}}(this))},e}())}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapMapControl",["uiGmapControl",function(t){return new t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapDragZoom",["uiGmapDragZoom",function(t){return t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapDrawingManager",["uiGmapDrawingManager",function(t){return t}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapFreeDrawPolygons",["uiGmapApiFreeDrawPolygons",function(t){return new t}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps").directive("uiGmapMapType",["$timeout","uiGmapLogger","uiGmapMapTypeParentModel",function(e,n,r){var i;return new(i=function(){function e(){this.link=t(this.link,this),this.$log=n,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template='<span class="angular-google-map-layer" ng-transclude></span>',this.replace=!0,this.scope={show:"=show",options:"=options",refresh:"=refresh",id:"@"}}return e.prototype.link=function(t,e,n,i){return i.getScope().deferred.promise.then(function(i){return function(i){return new r(t,e,n,i)}}(this))},e}())}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapPolygons",["uiGmapPolygons",function(t){return new t}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};e.module("uiGmapgoogle-maps").directive("uiGmapSearchBox",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapSearchBoxParentModel","$http","$templateCache","$compile",function(n,r,i,o,a,s){var l;return new(l=function(){function l(){this.link=t(this.link,this),this.$log=r,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-search' ng-transclude></span>",this.replace=!0,this.scope={template:"=template",events:"=events",position:"=?position",options:"=?options",parentdiv:"=?parentdiv",ngModel:"=?"}}return l.prototype.require="ngModel",l.prototype.link=function(t,r,l,u){return n.then(function(n){return function(c){return null==t.template&&(a.put("uigmap-searchbox-default.tpl.html",'<input type="text">'),t.template="uigmap-searchbox-default.tpl.html"),o.get(t.template,{cache:a}).success(function(o){return e.isUndefined(t.events)?void n.$log.error("searchBox: the events property is required"):u.getScope().deferred.promise.then(function(a){var u;return u=e.isDefined(t.position)?t.position.toUpperCase().replace(/-/g,"_"):"TOP_LEFT",c.ControlPosition[u]?new i(t,r,l,a,u,s(o)(t)):void n.$log.error("searchBox: invalid position property")})})}}(this))},l}())}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapShow",["$animate","uiGmapLogger",function(t,n){return{scope:{uiGmapShow:"=",uiGmapAfterShow:"&",uiGmapAfterHide:"&"},link:function(r,i){var o,a,s;return o=function(e,n){return t[e](i,"ng-hide").then(function(){return n()})},a=function(e,n){return t[e](i,"ng-hide",n)},s=function(t,r){return e.version.major>1?n.error("uiGmapShow is not supported for Angular Major greater than 1.\nYour Major is "+e.version.major+'"'):1===e.version.major&&e.version.minor<3?a(t,r):o(t,r)},r.$watch("uiGmapShow",function(t){if(t&&s("removeClass",r.uiGmapAfterShow),!t)return s("addClass",r.uiGmapAfterHide)})}}}])}.call(this),function(){e.module("uiGmapgoogle-maps").directive("uiGmapStreetViewPanorama",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper",function(t,n,r,i){var o;return o="uiGmapStreetViewPanorama",{restrict:"EMA",template:'<div class="angular-google-map-street-view-panorama"></div>',replace:!0,scope:{focalcoord:"=",radius:"=?",events:"=?",options:"=?",control:"=?",povoptions:"=?",imagestatus:"="},link:function(a,s,l){return t.then(function(t){return function(t){var l,u,c,d,h,p,f,g,v,m;return g=void 0,m=void 0,c=!1,p=void 0,f=null,v=null,l=function(){if(i.removeEvents(p),null!=g&&(g.unbind("position"),g.setVisible(!1)),null!=m)return null!=(null!=m?m.setVisible:void 0)&&m.setVisible(!1),m=void 0},h=function(t,n){var r;return r=google.maps.geometry.spherical.computeHeading(t,n),c=!0,a.radius=a.radius||50,v=e.extend({heading:r,zoom:1,pitch:0},a.povoptions||{}),f=f=e.extend({navigationControl:!1,addressControl:!1,linksControl:!1,position:t,pov:v,visible:!0},a.options||{}),c=!1},u=function(){var t;return a.focalcoord?a.radius?(l(),null==m&&(m=new google.maps.StreetViewService),a.events&&(p=i.setEvents(m,a,a)),t=r.getCoords(a.focalcoord),m.getPanoramaByLocation(t,a.radius,function(e,n){var r,i,o;if(null!=a.imagestatus&&(a.imagestatus=n),null!=(null!=(o=a.events)?o.image_status_changed:void 0)&&a.events.image_status_changed(m,"image_status_changed",a,n),"OK"===n)return i=e.location.latLng,h(i,t),r=s[0],g=new google.maps.StreetViewPanorama(r,f)})):void n.error(o+": needs a radius to set the camera view from its focal target."):void n.error(o+": focalCoord needs to be defined")},null!=a.control&&(a.control.getOptions=function(){return f},a.control.getPovOptions=function(){return v},a.control.getGObject=function(){return m},a.control.getGPano=function(){return g}),a.$watch("options",function(t,e){if(t!==e&&t!==f&&!c)return u()}),d=!0,a.$watch("focalcoord",function(t,e){if((t!==e||d)&&null!=t)return d=!1,u()}),a.$on("$destroy",function(){return l()})}}(this))}}}])}.call(this),e.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function t(){}return t.generate=function(){var e=t._gri,n=t._ha;return n(e(32),8)+"-"+n(e(16),4)+"-"+n(16384|e(12),4)+"-"+n(32768|e(14),4)+"-"+n(e(48),12)},t._gri=function(t){return 0>t?NaN:30>=t?0|Math.random()*(1<<t):53>=t?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<t-30)):NaN},t._ha=function(t,e){for(var n=t.toString(16),r=e-n.length,i="0";0<r;r>>>=1,i+=i)1&r&&(n=i+n);return n},t}),e.module("uiGmapgoogle-maps.wrapped").service("uiGmapGoogleMapsUtilV3",function(){return{init:_.once(function(){+function(){function e(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infoBox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===t.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),"undefined"==typeof t.visible&&("undefined"==typeof t.isHidden?t.visible=!0:t.visible=!t.isHidden),this.isHidden_=!t.visible,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}function r(t,e){t.getMarkerClusterer().extend(r,google.maps.OverlayView),this.cluster_=t,this.className_=t.getMarkerClusterer().getClusterClass(),this.styles_=e,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(t.getMap())}function i(t){this.markerClusterer_=t,this.map_=t.getMap(),this.gridSize_=t.getGridSize(),this.minClusterSize_=t.getMinimumClusterSize(),this.averageCenter_=t.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new r(this,t.getStyles())}function o(t,e,r){this.extend(o,google.maps.OverlayView),e=e||[],r=r||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=r.gridSize||60,this.minClusterSize_=r.minimumClusterSize||2,this.maxZoom_=r.maxZoom||null,this.styles_=r.styles||[],this.title_=r.title||"",this.zoomOnClick_=!0,r.zoomOnClick!==n&&(this.zoomOnClick_=r.zoomOnClick),this.averageCenter_=!1,r.averageCenter!==n&&(this.averageCenter_=r.averageCenter),this.ignoreHidden_=!1,r.ignoreHidden!==n&&(this.ignoreHidden_=r.ignoreHidden),this.enableRetinaIcons_=!1,r.enableRetinaIcons!==n&&(this.enableRetinaIcons_=r.enableRetinaIcons),this.imagePath_=r.imagePath||o.IMAGE_PATH,this.imageExtension_=r.imageExtension||o.IMAGE_EXTENSION,this.imageSizes_=r.imageSizes||o.IMAGE_SIZES,this.calculator_=r.calculator||o.CALCULATOR,this.batchSize_=r.batchSize||o.BATCH_SIZE,this.batchSizeIE_=r.batchSizeIE||o.BATCH_SIZE_IE,this.clusterClass_=r.clusterClass||"cluster",navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(e,!0),this.setMap(t)}function a(t,e){function n(){}n.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new n,t.prototype.constructor=t}function s(t,e,n){this.marker_=t,this.handCursorURL_=t.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=s.getSharedCross(e)}function l(t){t=t||{},t.labelContent=t.labelContent||"",t.labelAnchor=t.labelAnchor||new google.maps.Point(0,0),t.labelClass=t.labelClass||"markerLabels",t.labelStyle=t.labelStyle||{},t.labelInBackground=t.labelInBackground||!1,"undefined"==typeof t.labelVisible&&(t.labelVisible=!0),"undefined"==typeof t.raiseOnDrag&&(t.raiseOnDrag=!0),"undefined"==typeof t.clickable&&(t.clickable=!0),"undefined"==typeof t.draggable&&(t.draggable=!1),"undefined"==typeof t.optimized&&(t.optimized=!1),t.crossImage=t.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",t.handCursor=t.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",t.optimized=!1,this.label=new s(this,t.crossImage,t.handCursor),google.maps.Marker.apply(this,arguments)}function u(t){var e=t||{};this.ready_=!1,this.dragging_=!1,t.visible==n&&(t.visible=!0),t.shadow==n&&(t.shadow="7px -3px 5px rgba(88,88,88,0.7)"),t.anchor==n&&(t.anchor=c.BOTTOM),this.setValues(e)}e.prototype=new google.maps.OverlayView,e.prototype.createInfoBoxDiv_=function(){var t,e,n,r=this,i=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},o=function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault(),r.enableEventPropagation_||i(t)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(n=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-n.left-n.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<e.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,e[t],i));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(t){
this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",o),google.maps.event.trigger(this,"domready")}},e.prototype.getCloseBoxImg_=function(){var t="";return""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},e.prototype.addClickHandler_=function(){var t;""!==this.closeBoxURL_?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null},e.prototype.getCloseClickHandler_=function(){var t=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t,"closeclick"),t.close()}},e.prototype.panBox_=function(t){var e,n,r=0,i=0;if(!t&&(e=this.getMap(),e instanceof google.maps.Map)){e.getBounds().contains(this.position_)||e.setCenter(this.position_),n=e.getBounds();var o=e.getDiv(),a=o.offsetWidth,s=o.offsetHeight,l=this.pixelOffset_.width,u=this.pixelOffset_.height,c=this.div_.offsetWidth,d=this.div_.offsetHeight,h=this.infoBoxClearance_.width,p=this.infoBoxClearance_.height,f=this.getProjection().fromLatLngToContainerPixel(this.position_);if(f.x<-l+h?r=f.x+l-h:f.x+c+l+h>a&&(r=f.x+c+l+h-a),this.alignBottom_?f.y<-u+p+d?i=f.y+u-p-d:f.y+u+p>s&&(i=f.y+u+p-s):f.y<-u+p?i=f.y+u-p:f.y+d+u+p>s&&(i=f.y+d+u+p-s),0!==r||0!==i){e.getCenter();e.panBy(r,i)}}},e.prototype.setBoxStyle_=function(){var t,e;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_;for(t in e)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);this.div_.style.WebkitTransform="translateZ(0)","undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},e.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},n=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=n.ownerDocument.defaultView.getComputedStyle(n,""),t&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0)):document.documentElement.currentStyle&&n.currentStyle&&(e.top=parseInt(n.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(n.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(n.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(n.currentStyle.borderRightWidth,10)||0),e},e.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},e.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},e.prototype.setOptions=function(t){"undefined"!=typeof t.boxClass&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),"undefined"!=typeof t.boxStyle&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),"undefined"!=typeof t.content&&this.setContent(t.content),"undefined"!=typeof t.disableAutoPan&&(this.disableAutoPan_=t.disableAutoPan),"undefined"!=typeof t.maxWidth&&(this.maxWidth_=t.maxWidth),"undefined"!=typeof t.pixelOffset&&(this.pixelOffset_=t.pixelOffset),"undefined"!=typeof t.alignBottom&&(this.alignBottom_=t.alignBottom),"undefined"!=typeof t.position&&this.setPosition(t.position),"undefined"!=typeof t.zIndex&&this.setZIndex(t.zIndex),"undefined"!=typeof t.closeBoxMargin&&(this.closeBoxMargin_=t.closeBoxMargin),"undefined"!=typeof t.closeBoxURL&&(this.closeBoxURL_=t.closeBoxURL),"undefined"!=typeof t.infoBoxClearance&&(this.infoBoxClearance_=t.infoBoxClearance),"undefined"!=typeof t.isHidden&&(this.isHidden_=t.isHidden),"undefined"!=typeof t.visible&&(this.isHidden_=!t.visible),"undefined"!=typeof t.enableEventPropagation&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()},e.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},e.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},e.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")},e.prototype.setVisible=function(t){this.isHidden_=!t,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},e.prototype.getContent=function(){return this.content_},e.prototype.getPosition=function(){return this.position_},e.prototype.getZIndex=function(){return this.zIndex_},e.prototype.getVisible=function(){var t;return t="undefined"!=typeof this.getMap()&&null!==this.getMap()&&!this.isHidden_},e.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},e.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},e.prototype.open=function(t,e){var n=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){n.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()},e.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},function(){function e(t,e){var n=this,r=new google.maps.OverlayView;r.onAdd=function(){n.init_(t,e)},r.draw=function(){},r.onRemove=function(){},r.setMap(t),this.prjov_=r}var n=function(t){var e;switch(t){case"thin":e="2px";break;case"medium":e="4px";break;case"thick":e="6px";break;default:e=t}return e},r=function(t){var e,r={};if(document.defaultView&&document.defaultView.getComputedStyle){if(e=t.ownerDocument.defaultView.getComputedStyle(t,""))return r.top=parseInt(e.borderTopWidth,10)||0,r.bottom=parseInt(e.borderBottomWidth,10)||0,r.left=parseInt(e.borderLeftWidth,10)||0,r.right=parseInt(e.borderRightWidth,10)||0,r}else if(document.documentElement.currentStyle&&t.currentStyle)return r.top=parseInt(n(t.currentStyle.borderTopWidth),10)||0,r.bottom=parseInt(n(t.currentStyle.borderBottomWidth),10)||0,r.left=parseInt(n(t.currentStyle.borderLeftWidth),10)||0,r.right=parseInt(n(t.currentStyle.borderRightWidth),10)||0,r;return r.top=parseInt(t.style["border-top-width"],10)||0,r.bottom=parseInt(t.style["border-bottom-width"],10)||0,r.left=parseInt(t.style["border-left-width"],10)||0,r.right=parseInt(t.style["border-right-width"],10)||0,r},i={x:0,y:0},o=function(t){i.x="undefined"!=typeof document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,i.y="undefined"!=typeof document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};o();var a=function(e){var n=0,r=0;return e=e||t.event,"undefined"!=typeof e.pageX?(n=e.pageX,r=e.pageY):"undefined"!=typeof e.clientX&&(n=e.clientX+i.x,r=e.clientY+i.y),{left:n,top:r}},s=function(e){for(var n=e.offsetLeft,r=e.offsetTop,i=e.offsetParent;null!==i;){i!==document.body&&i!==document.documentElement&&(n-=i.scrollLeft,r-=i.scrollTop);var o=i,a=o.offsetLeft,s=o.offsetTop;if(!a&&!s&&t.getComputedStyle){var l=document.defaultView.getComputedStyle(o,null).MozTransform||document.defaultView.getComputedStyle(o,null).WebkitTransform;if(l&&"string"==typeof l){var u=l.split(",");a+=parseInt(u[4],10)||0,s+=parseInt(u[5],10)||0}}n+=a,r+=s,i=i.offsetParent}return{left:n,top:r}},l=function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},u=function(t,e){"undefined"!=typeof e&&(t.style.opacity=e),"undefined"!=typeof t.style.opacity&&""!==t.style.opacity&&(t.style.filter="alpha(opacity="+100*t.style.opacity+")")};e.prototype.init_=function(e,n){var i,a=this;for(this.map_=e,n=n||{},this.key_=n.key||"shift",this.key_=this.key_.toLowerCase(),this.borderWidths_=r(this.map_.getDiv()),this.veilDiv_=[],i=0;i<4;i++)this.veilDiv_[i]=document.createElement("div"),this.veilDiv_[i].onselectstart=function(){return!1},l(this.veilDiv_[i].style,{backgroundColor:"gray",opacity:.25,cursor:"crosshair"}),l(this.veilDiv_[i].style,n.paneStyle),l(this.veilDiv_[i].style,n.veilStyle),l(this.veilDiv_[i].style,{position:"absolute",overflow:"hidden",display:"none"}),"shift"===this.key_&&(this.veilDiv_[i].style.MozUserSelect="none"),u(this.veilDiv_[i]),"transparent"===this.veilDiv_[i].style.backgroundColor&&(this.veilDiv_[i].style.backgroundColor="white",u(this.veilDiv_[i],0)),this.map_.getDiv().appendChild(this.veilDiv_[i]);this.noZoom_=n.noZoom||!1,this.visualEnabled_=n.visualEnabled||!1,this.visualClass_=n.visualClass||"",this.visualPosition_=n.visualPosition||google.maps.ControlPosition.LEFT_TOP,this.visualPositionOffset_=n.visualPositionOffset||new google.maps.Size(35,0),this.visualPositionIndex_=n.visualPositionIndex||null,this.visualSprite_=n.visualSprite||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/mapfiles/ftr/controls/dragzoom_btn.png",this.visualSize_=n.visualSize||new google.maps.Size(20,20),this.visualTips_=n.visualTips||{},this.visualTips_.off=this.visualTips_.off||"Turn on drag zoom mode",this.visualTips_.on=this.visualTips_.on||"Turn off drag zoom mode",this.boxDiv_=document.createElement("div"),l(this.boxDiv_.style,{border:"4px solid #736AFF"}),l(this.boxDiv_.style,n.boxStyle),l(this.boxDiv_.style,{position:"absolute",display:"none"}),u(this.boxDiv_),this.map_.getDiv().appendChild(this.boxDiv_),this.boxBorderWidths_=r(this.boxDiv_),this.listeners_=[google.maps.event.addDomListener(document,"keydown",function(t){a.onKeyDown_(t)}),google.maps.event.addDomListener(document,"keyup",function(t){a.onKeyUp_(t)}),google.maps.event.addDomListener(this.veilDiv_[0],"mousedown",function(t){a.onMouseDown_(t)}),google.maps.event.addDomListener(this.veilDiv_[1],"mousedown",function(t){a.onMouseDown_(t)}),google.maps.event.addDomListener(this.veilDiv_[2],"mousedown",function(t){a.onMouseDown_(t)}),google.maps.event.addDomListener(this.veilDiv_[3],"mousedown",function(t){a.onMouseDown_(t)}),google.maps.event.addDomListener(document,"mousedown",function(t){a.onMouseDownDocument_(t)}),google.maps.event.addDomListener(document,"mousemove",function(t){a.onMouseMove_(t)}),google.maps.event.addDomListener(document,"mouseup",function(t){a.onMouseUp_(t)}),google.maps.event.addDomListener(t,"scroll",o)],this.hotKeyDown_=!1,this.mouseDown_=!1,this.dragging_=!1,this.startPt_=null,this.endPt_=null,this.mapWidth_=null,this.mapHeight_=null,this.mousePosn_=null,this.mapPosn_=null,this.visualEnabled_&&(this.buttonDiv_=this.initControl_(this.visualPositionOffset_),null!==this.visualPositionIndex_&&(this.buttonDiv_.index=this.visualPositionIndex_),this.map_.controls[this.visualPosition_].push(this.buttonDiv_),this.controlIndex_=this.map_.controls[this.visualPosition_].length-1)},e.prototype.initControl_=function(t){var e,n,r=this;return e=document.createElement("div"),e.className=this.visualClass_,e.style.position="relative",e.style.overflow="hidden",e.style.height=this.visualSize_.height+"px",e.style.width=this.visualSize_.width+"px",e.title=this.visualTips_.off,n=document.createElement("img"),n.src=this.visualSprite_,n.style.position="absolute",n.style.left=-(2*this.visualSize_.width)+"px",n.style.top="0px",e.appendChild(n),e.onclick=function(t){r.hotKeyDown_=!r.hotKeyDown_,r.hotKeyDown_?(r.buttonDiv_.firstChild.style.left=-(0*r.visualSize_.width)+"px",r.buttonDiv_.title=r.visualTips_.on,r.activatedByControl_=!0,google.maps.event.trigger(r,"activate")):(r.buttonDiv_.firstChild.style.left=-(2*r.visualSize_.width)+"px",r.buttonDiv_.title=r.visualTips_.off,google.maps.event.trigger(r,"deactivate")),r.onMouseMove_(t)},e.onmouseover=function(){r.buttonDiv_.firstChild.style.left=-(1*r.visualSize_.width)+"px"},e.onmouseout=function(){r.hotKeyDown_?(r.buttonDiv_.firstChild.style.left=-(0*r.visualSize_.width)+"px",r.buttonDiv_.title=r.visualTips_.on):(r.buttonDiv_.firstChild.style.left=-(2*r.visualSize_.width)+"px",r.buttonDiv_.title=r.visualTips_.off)},e.ondragstart=function(){return!1},l(e.style,{cursor:"pointer",marginTop:t.height+"px",marginLeft:t.width+"px"}),e},e.prototype.isHotKeyDown_=function(e){var n;if(e=e||t.event,n=e.shiftKey&&"shift"===this.key_||e.altKey&&"alt"===this.key_||e.ctrlKey&&"ctrl"===this.key_,!n)switch(e.keyCode){case 16:"shift"===this.key_&&(n=!0);break;case 17:"ctrl"===this.key_&&(n=!0);break;case 18:"alt"===this.key_&&(n=!0)}return n},e.prototype.isMouseOnMap_=function(){var t=this.mousePosn_;if(t){var e=this.mapPosn_,n=this.map_.getDiv();return t.left>e.left&&t.left<e.left+n.offsetWidth&&t.top>e.top&&t.top<e.top+n.offsetHeight}return!1},e.prototype.setVeilVisibility_=function(){var t;if(this.map_&&this.hotKeyDown_&&this.isMouseOnMap_()){var e=this.map_.getDiv();if(this.mapWidth_=e.offsetWidth-(this.borderWidths_.left+this.borderWidths_.right),this.mapHeight_=e.offsetHeight-(this.borderWidths_.top+this.borderWidths_.bottom),this.activatedByControl_){var n=parseInt(this.buttonDiv_.style.left,10)+this.visualPositionOffset_.width,r=parseInt(this.buttonDiv_.style.top,10)+this.visualPositionOffset_.height,i=this.visualSize_.width,o=this.visualSize_.height;for(this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=n+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=n+i+"px",this.veilDiv_[1].style.width=this.mapWidth_-(n+i)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=n+"px",this.veilDiv_[2].style.width=i+"px",this.veilDiv_[2].style.height=r+"px",this.veilDiv_[3].style.top=r+o+"px",this.veilDiv_[3].style.left=n+"px",this.veilDiv_[3].style.width=i+"px",this.veilDiv_[3].style.height=this.mapHeight_-(r+o)+"px",t=0;t<this.veilDiv_.length;t++)this.veilDiv_[t].style.display="block"}else{for(this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.width=this.mapWidth_+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",t=1;t<this.veilDiv_.length;t++)this.veilDiv_[t].style.width="0px",this.veilDiv_[t].style.height="0px";for(t=0;t<this.veilDiv_.length;t++)this.veilDiv_[t].style.display="block"}}else for(t=0;t<this.veilDiv_.length;t++)this.veilDiv_[t].style.display="none"},e.prototype.onKeyDown_=function(t){this.map_&&!this.hotKeyDown_&&this.isHotKeyDown_(t)&&(this.mapPosn_=s(this.map_.getDiv()),this.hotKeyDown_=!0,this.activatedByControl_=!1,this.setVeilVisibility_(),google.maps.event.trigger(this,"activate"))},e.prototype.getMousePoint_=function(t){var e=a(t),n=new google.maps.Point;return n.x=e.left-this.mapPosn_.left-this.borderWidths_.left,n.y=e.top-this.mapPosn_.top-this.borderWidths_.top,n.x=Math.min(n.x,this.mapWidth_),n.y=Math.min(n.y,this.mapHeight_),n.x=Math.max(n.x,0),n.y=Math.max(n.y,0),n},e.prototype.onMouseDown_=function(t){if(this.map_&&this.hotKeyDown_){this.mapPosn_=s(this.map_.getDiv()),this.dragging_=!0,this.startPt_=this.endPt_=this.getMousePoint_(t),this.boxDiv_.style.width=this.boxDiv_.style.height="0px";var e=this.prjov_.getProjection(),n=e.fromContainerPixelToLatLng(this.startPt_);google.maps.event.trigger(this,"dragstart",n)}},e.prototype.onMouseDownDocument_=function(t){this.mouseDown_=!0},e.prototype.onMouseMove_=function(t){if(this.mousePosn_=a(t),this.dragging_){this.endPt_=this.getMousePoint_(t);var e=Math.min(this.startPt_.x,this.endPt_.x),n=Math.min(this.startPt_.y,this.endPt_.y),r=Math.abs(this.startPt_.x-this.endPt_.x),i=Math.abs(this.startPt_.y-this.endPt_.y),o=Math.max(0,r-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)),l=Math.max(0,i-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom));this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=e+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=e+r+"px",this.veilDiv_[1].style.width=this.mapWidth_-(e+r)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=e+"px",this.veilDiv_[2].style.width=r+"px",this.veilDiv_[2].style.height=n+"px",this.veilDiv_[3].style.top=n+i+"px",this.veilDiv_[3].style.left=e+"px",this.veilDiv_[3].style.width=r+"px",this.veilDiv_[3].style.height=this.mapHeight_-(n+i)+"px",this.boxDiv_.style.top=n+"px",this.boxDiv_.style.left=e+"px",this.boxDiv_.style.width=o+"px",this.boxDiv_.style.height=l+"px",this.boxDiv_.style.display="block",google.maps.event.trigger(this,"drag",new google.maps.Point(e,n+i),new google.maps.Point(e+r,n),this.prjov_.getProjection())}else this.mouseDown_||(this.mapPosn_=s(this.map_.getDiv()),this.setVeilVisibility_())},e.prototype.onMouseUp_=function(t){var e,n=this;if(this.mouseDown_=!1,this.dragging_){if(this.getMousePoint_(t).x===this.startPt_.x&&this.getMousePoint_(t).y===this.startPt_.y)return void this.onKeyUp_(t);var r=Math.min(this.startPt_.x,this.endPt_.x),i=Math.min(this.startPt_.y,this.endPt_.y),o=Math.abs(this.startPt_.x-this.endPt_.x),a=Math.abs(this.startPt_.y-this.endPt_.y),s=!0;s&&(r+=this.borderWidths_.left,i+=this.borderWidths_.top);var l=this.prjov_.getProjection(),u=l.fromContainerPixelToLatLng(new google.maps.Point(r,i+a)),c=l.fromContainerPixelToLatLng(new google.maps.Point(r+o,i)),d=new google.maps.LatLngBounds(u,c);if(this.noZoom_)this.boxDiv_.style.display="none";else{e=this.map_.getZoom(),this.map_.fitBounds(d),this.map_.getZoom()<e&&this.map_.setZoom(e);var h=l.fromLatLngToContainerPixel(u),p=l.fromLatLngToContainerPixel(c);s&&(h.x-=this.borderWidths_.left,h.y-=this.borderWidths_.top,p.x-=this.borderWidths_.left,p.y-=this.borderWidths_.top),this.boxDiv_.style.left=h.x+"px",this.boxDiv_.style.top=p.y+"px",this.boxDiv_.style.width=Math.abs(p.x-h.x)-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)+"px",this.boxDiv_.style.height=Math.abs(p.y-h.y)-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom)+"px",setTimeout(function(){n.boxDiv_.style.display="none"},1e3)}this.dragging_=!1,this.onMouseMove_(t),google.maps.event.trigger(this,"dragend",d),this.isHotKeyDown_(t)||this.onKeyUp_(t)}},e.prototype.onKeyUp_=function(t){var e,n,r,i,o,a,s,l,u=null;if(this.map_&&this.hotKeyDown_){for(this.hotKeyDown_=!1,this.dragging_&&(this.boxDiv_.style.display="none",this.dragging_=!1,n=Math.min(this.startPt_.x,this.endPt_.x),r=Math.min(this.startPt_.y,this.endPt_.y),i=Math.abs(this.startPt_.x-this.endPt_.x),o=Math.abs(this.startPt_.y-this.endPt_.y),a=this.prjov_.getProjection(),s=a.fromContainerPixelToLatLng(new google.maps.Point(n,r+o)),l=a.fromContainerPixelToLatLng(new google.maps.Point(n+i,r)),u=new google.maps.LatLngBounds(s,l)),e=0;e<this.veilDiv_.length;e++)this.veilDiv_[e].style.display="none";this.visualEnabled_&&(this.buttonDiv_.firstChild.style.left=-(2*this.visualSize_.width)+"px",this.buttonDiv_.title=this.visualTips_.off,this.buttonDiv_.style.display=""),google.maps.event.trigger(this,"deactivate",u)}},google.maps.Map.prototype.enableKeyDragZoom=function(t){this.dragZoom_=new e(this,t)},google.maps.Map.prototype.disableKeyDragZoom=function(){var t,e=this.dragZoom_;if(e){for(t=0;t<e.listeners_.length;++t)google.maps.event.removeListener(e.listeners_[t]);for(this.getDiv().removeChild(e.boxDiv_),t=0;t<e.veilDiv_.length;t++)this.getDiv().removeChild(e.veilDiv_[t]);e.visualEnabled_&&this.controls[e.visualPosition_].removeAt(e.controlIndex_),e.prjov_.setMap(null),this.dragZoom_=null}},google.maps.Map.prototype.keyDragZoomEnabled=function(){return null!==this.dragZoom_},google.maps.Map.prototype.getDragZoomObject=function(){return this.dragZoom_}}(),r.prototype.onAdd=function(){var t,e,n=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){e=t}),google.maps.event.addDomListener(this.div_,"mousedown",function(){t=!0,e=!1}),google.maps.event.addDomListener(this.div_,"click",function(r){if(t=!1,!e){var i,o,a=n.cluster_.getMarkerClusterer();google.maps.event.trigger(a,"click",n.cluster_),google.maps.event.trigger(a,"clusterclick",n.cluster_),a.getZoomOnClick()&&(o=a.getMaxZoom(),i=n.cluster_.getBounds(),a.getMap().fitBounds(i),setTimeout(function(){a.getMap().fitBounds(i),null!==o&&a.getMap().getZoom()>o&&a.getMap().setZoom(o+1)},100)),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var t=n.cluster_.getMarkerClusterer();google.maps.event.trigger(t,"mouseover",n.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var t=n.cluster_.getMarkerClusterer();google.maps.event.trigger(t,"mouseout",n.cluster_)})},r.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},r.prototype.draw=function(){if(this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.top=t.y+"px",this.div_.style.left=t.x+"px"}},r.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},r.prototype.show=function(){if(this.div_){var t="",e=this.backgroundPosition_.split(" "),n=parseInt(e[0].trim(),10),r=parseInt(e[1].trim(),10),i=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(i),t="<img src='"+this.url_+"' style='position: absolute; top: "+r+"px; left: "+n+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(t+="clip: rect("+-1*r+"px, "+(-1*n+this.width_)+"px, "+(-1*r+this.height_)+"px, "+-1*n+"px);"),t+="'>",this.div_.innerHTML=t+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},r.prototype.useStyle=function(t){this.sums_=t;var e=Math.max(0,t.index-1);e=Math.min(this.styles_.length-1,e);var n=this.styles_[e];this.url_=n.url,this.height_=n.height,this.width_=n.width,this.anchorText_=n.anchorText||[0,0],this.anchorIcon_=n.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=n.textColor||"black",this.textSize_=n.textSize||11,this.textDecoration_=n.textDecoration||"none",this.fontWeight_=n.fontWeight||"bold",this.fontStyle_=n.fontStyle||"normal",this.fontFamily_=n.fontFamily||"Arial,sans-serif",this.backgroundPosition_=n.backgroundPosition||"0 0"},r.prototype.setCenter=function(t){this.center_=t},r.prototype.createCss=function(t){var e=[];return e.push("cursor: pointer;"),e.push("position: absolute; top: "+t.y+"px; left: "+t.x+"px;"),e.push("width: "+this.width_+"px; height: "+this.height_+"px;"),e.join("")},r.prototype.getPosFromLatLng_=function(t){var e=this.getProjection().fromLatLngToDivPixel(t);return e.x-=this.anchorIcon_[1],e.y-=this.anchorIcon_[0],e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e},i.prototype.getSize=function(){return this.markers_.length},i.prototype.getMarkers=function(){return this.markers_},i.prototype.getCenter=function(){return this.center_},i.prototype.getMap=function(){return this.map_},i.prototype.getMarkerClusterer=function(){return this.markerClusterer_},i.prototype.getBounds=function(){var t,e=new google.maps.LatLngBounds(this.center_,this.center_),n=this.getMarkers();for(t=0;t<n.length;t++)e.extend(n[t].getPosition());return e},i.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},i.prototype.addMarker=function(t){var e,n,r;if(this.isMarkerAlreadyAdded_(t))return!1;if(this.center_){if(this.averageCenter_){var i=this.markers_.length+1,o=(this.center_.lat()*(i-1)+t.getPosition().lat())/i,a=(this.center_.lng()*(i-1)+t.getPosition().lng())/i;this.center_=new google.maps.LatLng(o,a),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();if(t.isAdded=!0,this.markers_.push(t),n=this.markers_.length,r=this.markerClusterer_.getMaxZoom(),null!==r&&this.map_.getZoom()>r)t.getMap()!==this.map_&&t.setMap(this.map_);else if(n<this.minClusterSize_)t.getMap()!==this.map_&&t.setMap(this.map_);else if(n===this.minClusterSize_)for(e=0;e<n;e++)this.markers_[e].setMap(null);else t.setMap(null);return this.updateIcon_(),!0},i.prototype.isMarkerInClusterBounds=function(t){return this.bounds_.contains(t.getPosition())},i.prototype.calculateBounds_=function(){var t=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(t)},i.prototype.updateIcon_=function(){var t=this.markers_.length,e=this.markerClusterer_.getMaxZoom();if(null!==e&&this.map_.getZoom()>e)return void this.clusterIcon_.hide();if(t<this.minClusterSize_)return void this.clusterIcon_.hide();var n=this.markerClusterer_.getStyles().length,r=this.markerClusterer_.getCalculator()(this.markers_,n);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(r),this.clusterIcon_.show()},i.prototype.isMarkerAlreadyAdded_=function(t){var e;if(this.markers_.indexOf)return this.markers_.indexOf(t)!==-1;for(e=0;e<this.markers_.length;e++)if(t===this.markers_[e])return!0;return!1},o.prototype.onAdd=function(){var t=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){t.resetViewport_(!1),this.getZoom()!==(this.get("minZoom")||0)&&this.getZoom()!==this.get("maxZoom")||google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){t.redraw_()})]},o.prototype.onRemove=function(){var t;for(t=0;t<this.markers_.length;t++)this.markers_[t].getMap()!==this.activeMap_&&this.markers_[t].setMap(this.activeMap_);for(t=0;t<this.clusters_.length;t++)this.clusters_[t].remove();for(this.clusters_=[],t=0;t<this.listeners_.length;t++)google.maps.event.removeListener(this.listeners_[t]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},o.prototype.draw=function(){},o.prototype.setupStyles_=function(){var t,e;if(!(this.styles_.length>0))for(t=0;t<this.imageSizes_.length;t++)e=this.imageSizes_[t],this.styles_.push({url:this.imagePath_+(t+1)+"."+this.imageExtension_,height:e,width:e})},o.prototype.fitMapToMarkers=function(){var t,e=this.getMarkers(),n=new google.maps.LatLngBounds;for(t=0;t<e.length;t++)n.extend(e[t].getPosition());this.getMap().fitBounds(n)},o.prototype.getGridSize=function(){return this.gridSize_},o.prototype.setGridSize=function(t){this.gridSize_=t},o.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},o.prototype.setMinimumClusterSize=function(t){this.minClusterSize_=t},o.prototype.getMaxZoom=function(){return this.maxZoom_},o.prototype.setMaxZoom=function(t){this.maxZoom_=t},o.prototype.getStyles=function(){return this.styles_},o.prototype.setStyles=function(t){this.styles_=t},o.prototype.getTitle=function(){return this.title_},o.prototype.setTitle=function(t){this.title_=t},o.prototype.getZoomOnClick=function(){return this.zoomOnClick_},o.prototype.setZoomOnClick=function(t){this.zoomOnClick_=t},o.prototype.getAverageCenter=function(){return this.averageCenter_},o.prototype.setAverageCenter=function(t){this.averageCenter_=t},o.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},o.prototype.setIgnoreHidden=function(t){this.ignoreHidden_=t},o.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},o.prototype.setEnableRetinaIcons=function(t){this.enableRetinaIcons_=t},o.prototype.getImageExtension=function(){return this.imageExtension_},o.prototype.setImageExtension=function(t){this.imageExtension_=t},o.prototype.getImagePath=function(){return this.imagePath_},o.prototype.setImagePath=function(t){this.imagePath_=t},o.prototype.getImageSizes=function(){return this.imageSizes_},o.prototype.setImageSizes=function(t){this.imageSizes_=t},o.prototype.getCalculator=function(){return this.calculator_},o.prototype.setCalculator=function(t){this.calculator_=t},o.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},o.prototype.setBatchSizeIE=function(t){this.batchSizeIE_=t},o.prototype.getClusterClass=function(){return this.clusterClass_},o.prototype.setClusterClass=function(t){this.clusterClass_=t},o.prototype.getMarkers=function(){return this.markers_},o.prototype.getTotalMarkers=function(){return this.markers_.length},o.prototype.getClusters=function(){return this.clusters_},o.prototype.getTotalClusters=function(){return this.clusters_.length},o.prototype.addMarker=function(t,e){this.pushMarkerTo_(t),e||this.redraw_()},o.prototype.addMarkers=function(t,e){var n;for(n in t)t.hasOwnProperty(n)&&this.pushMarkerTo_(t[n]);e||this.redraw_()},o.prototype.pushMarkerTo_=function(t){if(t.getDraggable()){var e=this;google.maps.event.addListener(t,"dragend",function(){e.ready_&&(this.isAdded=!1,e.repaint())})}t.isAdded=!1,this.markers_.push(t)},o.prototype.removeMarker=function(t,e){var n=this.removeMarker_(t);return!e&&n&&this.repaint(),n},o.prototype.removeMarkers=function(t,e){var n,r,i=!1;for(n=0;n<t.length;n++)r=this.removeMarker_(t[n]),i=i||r;return!e&&i&&this.repaint(),i},o.prototype.removeMarker_=function(t){var e,n=-1;if(this.markers_.indexOf)n=this.markers_.indexOf(t);else for(e=0;e<this.markers_.length;e++)if(t===this.markers_[e]){n=e;break}return n!==-1&&(t.setMap(null),this.markers_.splice(n,1),!0)},o.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},o.prototype.repaint=function(){var t=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var e;for(e=0;e<t.length;e++)t[e].remove()},0)},o.prototype.getExtendedBounds=function(t){var e=this.getProjection(),n=new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()),r=new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()),i=e.fromLatLngToDivPixel(n);i.x+=this.gridSize_,i.y-=this.gridSize_;var o=e.fromLatLngToDivPixel(r);o.x-=this.gridSize_,o.y+=this.gridSize_;var a=e.fromDivPixelToLatLng(i),s=e.fromDivPixelToLatLng(o);return t.extend(a),t.extend(s),t},o.prototype.redraw_=function(){this.createClusters_(0)},o.prototype.resetViewport_=function(t){var e,n;
for(e=0;e<this.clusters_.length;e++)this.clusters_[e].remove();for(this.clusters_=[],e=0;e<this.markers_.length;e++)n=this.markers_[e],n.isAdded=!1,t&&n.setMap(null)},o.prototype.distanceBetweenPoints_=function(t,e){var n=6371,r=(e.lat()-t.lat())*Math.PI/180,i=(e.lng()-t.lng())*Math.PI/180,o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(e.lat()*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2),a=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),s=n*a;return s},o.prototype.isMarkerInBounds_=function(t,e){return e.contains(t.getPosition())},o.prototype.addToClosestCluster_=function(t){var e,n,r,o,a=4e4,s=null;for(e=0;e<this.clusters_.length;e++)r=this.clusters_[e],o=r.getCenter(),o&&(n=this.distanceBetweenPoints_(o,t.getPosition()),n<a&&(a=n,s=r));s&&s.isMarkerInClusterBounds(t)?s.addMarker(t):(r=new i(this),r.addMarker(t),this.clusters_.push(r))},o.prototype.createClusters_=function(t){var e,n,r,i=this;if(this.ready_){0===t&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),r=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,(-178.48388434375)),new google.maps.LatLng((-85.08136444384544),178.00048865625));var o=this.getExtendedBounds(r),a=Math.min(t+this.batchSize_,this.markers_.length);for(e=t;e<a;e++)n=this.markers_[e],!n.isAdded&&this.isMarkerInBounds_(n,o)&&(!this.ignoreHidden_||this.ignoreHidden_&&n.getVisible())&&this.addToClosestCluster_(n);a<this.markers_.length?this.timerRefStatic=setTimeout(function(){i.createClusters_(a)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},o.prototype.extend=function(t,e){return function(t){var e;for(e in t.prototype)this.prototype[e]=t.prototype[e];return this}.apply(t,[e])},o.CALCULATOR=function(t,e){for(var n=0,r="",i=t.length.toString(),o=i;0!==o;)o=parseInt(o/10,10),n++;return n=Math.min(n,e),{text:i,index:n,title:r}},o.BATCH_SIZE=2e3,o.BATCH_SIZE_IE=500,o.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",o.IMAGE_EXTENSION="png",o.IMAGE_SIZES=[53,56,66,78,90],a(s,google.maps.OverlayView),s.getSharedCross=function(t){var e;return"undefined"==typeof s.getSharedCross.crossDiv&&(e=document.createElement("img"),e.style.cssText="position: absolute; z-index: 1000002; display: none;",e.style.marginLeft="-8px",e.style.marginTop="-9px",e.src=t,s.getSharedCross.crossDiv=e),s.getSharedCross.crossDiv},s.prototype.onAdd=function(){var t,e,n,r,i,o,a,l=this,u=!1,c=!1,d=20,h="url("+this.handCursorURL_+")",p=function(t){t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},f=function(){l.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof s.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),s.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(t){(l.marker_.getDraggable()||l.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(l.marker_,"mouseover",t))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(t){!l.marker_.getDraggable()&&!l.marker_.getClickable()||c||(this.style.cursor=l.marker_.getCursor(),google.maps.event.trigger(l.marker_,"mouseout",t))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(t){c=!1,l.marker_.getDraggable()&&(u=!0,this.style.cursor=h),(l.marker_.getDraggable()||l.marker_.getClickable())&&(google.maps.event.trigger(l.marker_,"mousedown",t),p(t))}),google.maps.event.addDomListener(document,"mouseup",function(e){var n;if(u&&(u=!1,l.eventDiv_.style.cursor="pointer",google.maps.event.trigger(l.marker_,"mouseup",e)),c){if(i){n=l.getProjection().fromLatLngToDivPixel(l.marker_.getPosition()),n.y+=d,l.marker_.setPosition(l.getProjection().fromDivPixelToLatLng(n));try{l.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(f,1406)}catch(t){}}l.crossDiv_.style.display="none",l.marker_.setZIndex(t),r=!0,c=!1,e.latLng=l.marker_.getPosition(),google.maps.event.trigger(l.marker_,"dragend",e)}}),google.maps.event.addListener(l.marker_.getMap(),"mousemove",function(r){var s;u&&(c?(r.latLng=new google.maps.LatLng(r.latLng.lat()-e,r.latLng.lng()-n),s=l.getProjection().fromLatLngToDivPixel(r.latLng),i&&(l.crossDiv_.style.left=s.x+"px",l.crossDiv_.style.top=s.y+"px",l.crossDiv_.style.display="",s.y-=d),l.marker_.setPosition(l.getProjection().fromDivPixelToLatLng(s)),i&&(l.eventDiv_.style.top=s.y+d+"px"),google.maps.event.trigger(l.marker_,"drag",r)):(e=r.latLng.lat()-l.marker_.getPosition().lat(),n=r.latLng.lng()-l.marker_.getPosition().lng(),t=l.marker_.getZIndex(),o=l.marker_.getPosition(),a=l.marker_.getMap().getCenter(),i=l.marker_.get("raiseOnDrag"),c=!0,l.marker_.setZIndex(1e6),r.latLng=l.marker_.getPosition(),google.maps.event.trigger(l.marker_,"dragstart",r)))}),google.maps.event.addDomListener(document,"keydown",function(t){c&&27===t.keyCode&&(i=!1,l.marker_.setPosition(o),l.marker_.getMap().setCenter(a),google.maps.event.trigger(document,"mouseup",t))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(t){(l.marker_.getDraggable()||l.marker_.getClickable())&&(r?r=!1:(google.maps.event.trigger(l.marker_,"click",t),p(t)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(t){(l.marker_.getDraggable()||l.marker_.getClickable())&&(google.maps.event.trigger(l.marker_,"dblclick",t),p(t))}),google.maps.event.addListener(this.marker_,"dragstart",function(t){c||(i=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(t){c||i&&(l.setPosition(d),l.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(t){c||i&&l.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){l.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){l.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){l.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){l.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){l.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){l.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){l.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){l.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){l.setStyles()})]},s.prototype.onRemove=function(){var t;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),t=0;t<this.listeners_.length;t++)google.maps.event.removeListener(this.listeners_[t])},s.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},s.prototype.setContent=function(){var t=this.marker_.get("labelContent");"undefined"==typeof t.nodeType?(this.labelDiv_.innerHTML=t,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(t),t=t.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(t))},s.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},s.prototype.setStyles=function(){var t,e;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",e=this.marker_.get("labelStyle");for(t in e)e.hasOwnProperty(t)&&(this.labelDiv_.style[t]=e[t],this.eventDiv_.style[t]=e[t]);this.setMandatoryStyles()},s.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},s.prototype.setAnchor=function(){var t=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-t.x+"px",this.labelDiv_.style.marginTop=-t.y+"px",this.eventDiv_.style.marginLeft=-t.x+"px",this.eventDiv_.style.marginTop=-t.y+"px"},s.prototype.setPosition=function(t){var e=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof t&&(t=0),this.labelDiv_.style.left=Math.round(e.x)+"px",this.labelDiv_.style.top=Math.round(e.y-t)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},s.prototype.setZIndex=function(){var t=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+t,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+t,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},s.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},a(l,google.maps.Marker),l.prototype.setMap=function(t){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(t)},u.prototype=new google.maps.OverlayView,t.RichMarker=u,u.prototype.getVisible=function(){return this.get("visible")},u.prototype.getVisible=u.prototype.getVisible,u.prototype.setVisible=function(t){this.set("visible",t)},u.prototype.setVisible=u.prototype.setVisible,u.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},u.prototype.visible_changed=u.prototype.visible_changed,u.prototype.setFlat=function(t){this.set("flat",!!t)},u.prototype.setFlat=u.prototype.setFlat,u.prototype.getFlat=function(){return this.get("flat")},u.prototype.getFlat=u.prototype.getFlat,u.prototype.getWidth=function(){return this.get("width")},u.prototype.getWidth=u.prototype.getWidth,u.prototype.getHeight=function(){return this.get("height")},u.prototype.getHeight=u.prototype.getHeight,u.prototype.setShadow=function(t){this.set("shadow",t),this.flat_changed()},u.prototype.setShadow=u.prototype.setShadow,u.prototype.getShadow=function(){return this.get("shadow")},u.prototype.getShadow=u.prototype.getShadow,u.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},u.prototype.flat_changed=u.prototype.flat_changed,u.prototype.setZIndex=function(t){this.set("zIndex",t)},u.prototype.setZIndex=u.prototype.setZIndex,u.prototype.getZIndex=function(){return this.get("zIndex")},u.prototype.getZIndex=u.prototype.getZIndex,u.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},u.prototype.zIndex_changed=u.prototype.zIndex_changed,u.prototype.getDraggable=function(){return this.get("draggable")},u.prototype.getDraggable=u.prototype.getDraggable,u.prototype.setDraggable=function(t){this.set("draggable",!!t)},u.prototype.setDraggable=u.prototype.setDraggable,u.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},u.prototype.draggable_changed=u.prototype.draggable_changed,u.prototype.getPosition=function(){return this.get("position")},u.prototype.getPosition=u.prototype.getPosition,u.prototype.setPosition=function(t){this.set("position",t)},u.prototype.setPosition=u.prototype.setPosition,u.prototype.position_changed=function(){this.draw()},u.prototype.position_changed=u.prototype.position_changed,u.prototype.getAnchor=function(){return this.get("anchor")},u.prototype.getAnchor=u.prototype.getAnchor,u.prototype.setAnchor=function(t){this.set("anchor",t)},u.prototype.setAnchor=u.prototype.setAnchor,u.prototype.anchor_changed=function(){this.draw()},u.prototype.anchor_changed=u.prototype.anchor_changed,u.prototype.htmlToDocumentFragment_=function(t){var e=document.createElement("DIV");if(e.innerHTML=t,1==e.childNodes.length)return e.removeChild(e.firstChild);for(var n=document.createDocumentFragment();e.firstChild;)n.appendChild(e.firstChild);return n},u.prototype.removeChildren_=function(t){if(t)for(var e;e=t.firstChild;)t.removeChild(e)},u.prototype.setContent=function(t){this.set("content",t)},u.prototype.setContent=u.prototype.setContent,u.prototype.getContent=function(){return this.get("content")},u.prototype.getContent=u.prototype.getContent,u.prototype.content_changed=function(){if(this.markerContent_){this.removeChildren_(this.markerContent_);var t=this.getContent();if(t){"string"==typeof t&&(t=t.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),t=this.htmlToDocumentFragment_(t)),this.markerContent_.appendChild(t);for(var e,n=this,r=this.markerContent_.getElementsByTagName("IMG"),i=0;e=r[i];i++)google.maps.event.addDomListener(e,"mousedown",function(t){n.getDraggable()&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1)}),google.maps.event.addDomListener(e,"load",function(){n.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},u.prototype.content_changed=u.prototype.content_changed,u.prototype.setCursor_=function(t){if(this.ready_){var e="";navigator.userAgent.indexOf("Gecko/")!==-1?("dragging"==t&&(e="-moz-grabbing"),"dragready"==t&&(e="-moz-grab"),"draggable"==t&&(e="pointer")):("dragging"!=t&&"dragready"!=t||(e="move"),"draggable"==t&&(e="pointer")),this.markerWrapper_.style.cursor!=e&&(this.markerWrapper_.style.cursor=e)}},u.prototype.startDrag=function(t){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var e=this.getMap();this.mapDraggable_=e.get("draggable"),e.set("draggable",!1),this.mouseX_=t.clientX,this.mouseY_=t.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},u.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},u.prototype.drag=function(t){if(!this.getDraggable()||!this.dragging_)return void this.stopDrag();var e=this.mouseX_-t.clientX,n=this.mouseY_-t.clientY;this.mouseX_=t.clientX,this.mouseY_=t.clientY;var r=parseInt(this.markerWrapper_.style.left,10)-e,i=parseInt(this.markerWrapper_.style.top,10)-n;this.markerWrapper_.style.left=r+"px",this.markerWrapper_.style.top=i+"px";var o=this.getOffset_(),a=new google.maps.Point(r-o.width,i-o.height),s=this.getProjection();this.setPosition(s.fromDivPixelToLatLng(a)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},u.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},u.prototype.addDragging_=function(t){if(t){var e=this;this.draggableListener_=google.maps.event.addDomListener(t,"mousedown",function(t){e.startDrag(t)}),this.setCursor_("draggable")}},u.prototype.addDraggingListeners_=function(){var e=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(t){e.drag(t)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){e.stopDrag(),e.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(t,"mousemove",function(t){e.drag(t)},!0),google.maps.event.addDomListener(t,"mouseup",function(){e.stopDrag()},!0)]},u.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var t,e=0;t=this.draggingListeners_[e];e++)google.maps.event.removeListener(t);this.draggingListeners_.length=0}},u.prototype.getOffset_=function(){var t=this.getAnchor();if("object"==typeof t)return t;var e=new google.maps.Size(0,0);if(!this.markerContent_)return e;var n=this.markerContent_.offsetWidth,r=this.markerContent_.offsetHeight;switch(t){case c.TOP_LEFT:break;case c.TOP:e.width=-n/2;break;case c.TOP_RIGHT:e.width=-n;break;case c.LEFT:e.height=-r/2;break;case c.MIDDLE:e.width=-n/2,e.height=-r/2;break;case c.RIGHT:e.width=-n,e.height=-r/2;break;case c.BOTTOM_LEFT:e.height=-r;break;case c.BOTTOM:e.width=-n/2,e.height=-r;break;case c.BOTTOM_RIGHT:e.width=-n,e.height=-r}return e},u.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var t=this;google.maps.event.addDomListener(this.markerContent_,"click",function(e){google.maps.event.trigger(t,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(e){google.maps.event.trigger(t,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(e){google.maps.event.trigger(t,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var e=this.getPanes();e&&e.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},u.prototype.onAdd=u.prototype.onAdd,u.prototype.draw=function(){if(this.ready_&&!this.dragging_){var t=this.getProjection();if(t){var e=this.get("position"),n=t.fromLatLngToDivPixel(e),r=this.getOffset_();this.markerWrapper_.style.top=n.y+r.height+"px",this.markerWrapper_.style.left=n.x+r.width+"px";var i=this.markerContent_.offsetHeight,o=this.markerContent_.offsetWidth;o!=this.get("width")&&this.set("width",o),i!=this.get("height")&&this.set("height",i)}}},u.prototype.draw=u.prototype.draw,u.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},u.prototype.onRemove=u.prototype.onRemove;var c={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};t.RichMarkerPosition=c,t.InfoBox=e,t.Cluster=i,t.ClusterIcon=r,t.MarkerClusterer=o,t.MarkerLabel_=s,t.MarkerWithLabel=l,t.RichMarker=u}()})}}),function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,n,r){e.module("uiGmapgoogle-maps.wrapped").service("uiGmapDataStructures",function(){return{Graph:r(1).Graph,Queue:r(1).Queue}})},function(t,e,n){(function(){t.exports={Graph:n(2),Heap:n(3),LinkedList:n(4),Map:n(5),Queue:n(6),RedBlackTree:n(7),Trie:n(8)}}).call(this)},function(t,e){(function(){var e,n={}.hasOwnProperty;e=function(){function t(){this._nodes={},this.nodeSize=0,this.edgeSize=0}return t.prototype.addNode=function(t){if(!this._nodes[t])return this.nodeSize++,this._nodes[t]={_outEdges:{},_inEdges:{}}},t.prototype.getNode=function(t){return this._nodes[t]},t.prototype.removeNode=function(t){var e,r,i,o,a;if(r=this._nodes[t]){o=r._outEdges;for(i in o)n.call(o,i)&&this.removeEdge(t,i);a=r._inEdges;for(e in a)n.call(a,e)&&this.removeEdge(e,t);return this.nodeSize--,delete this._nodes[t],r}},t.prototype.addEdge=function(t,e,n){var r,i,o;if(null==n&&(n=1),!this.getEdge(t,e)&&(i=this._nodes[t],o=this._nodes[e],i&&o))return r={weight:n},i._outEdges[e]=r,o._inEdges[t]=r,this.edgeSize++,r},t.prototype.getEdge=function(t,e){var n,r;if(n=this._nodes[t],r=this._nodes[e],n&&r)return n._outEdges[e]},t.prototype.removeEdge=function(t,e){var n,r,i;if(r=this._nodes[t],i=this._nodes[e],n=this.getEdge(t,e))return delete r._outEdges[e],delete i._inEdges[t],this.edgeSize--,n},t.prototype.getInEdgesOf=function(t){var e,r,i,o;i=this._nodes[t],r=[],o=null!=i?i._inEdges:void 0;for(e in o)n.call(o,e)&&r.push(this.getEdge(e,t));return r},t.prototype.getOutEdgesOf=function(t){var e,r,i,o;e=this._nodes[t],r=[],o=null!=e?e._outEdges:void 0;for(i in o)n.call(o,i)&&r.push(this.getEdge(t,i));return r},t.prototype.getAllEdgesOf=function(t){var e,n,r,i,o,a,s;if(n=this.getInEdgesOf(t),r=this.getOutEdgesOf(t),0===n.length)return r;for(i=this.getEdge(t,t),e=o=0,a=n.length;0<=a?o<a:o>a;e=0<=a?++o:--o)if(n[e]===i){s=[n[n.length-1],n[e]],n[e]=s[0],n[n.length-1]=s[1],n.pop();break}return n.concat(r)},t.prototype.forEachNode=function(t){var e,r,i;i=this._nodes;for(e in i)n.call(i,e)&&(r=i[e],t(r,e))},t.prototype.forEachEdge=function(t){var e,r,i,o,a,s;a=this._nodes;for(r in a)if(n.call(a,r)){i=a[r],s=i._outEdges;for(o in s)n.call(s,o)&&(e=s[o],t(e))}},t}(),t.exports=e}).call(this)},function(t,e){(function(){var e,n,r,i;e=function(){function t(t){var e,n,r,i,o,a;for(null==t&&(t=[]),this._data=[void 0],r=0,o=t.length;r<o;r++)n=t[r],null!=n&&this._data.push(n);if(this._data.length>1)for(e=i=2,a=this._data.length;2<=a?i<a:i>a;e=2<=a?++i:--i)this._upHeap(e);this.size=this._data.length-1}return t.prototype.add=function(t){if(null!=t)return this._data.push(t),this._upHeap(this._data.length-1),this.size++,t},t.prototype.removeMin=function(){var t;if(1!==this._data.length)return this.size--,2===this._data.length?this._data.pop():(t=this._data[1],this._data[1]=this._data.pop(),this._downHeap(),t)},t.prototype.peekMin=function(){return this._data[1]},t.prototype._upHeap=function(t){var e,n;for(e=this._data[t];this._data[t]<this._data[r(t)]&&t>1;)n=[this._data[r(t)],this._data[t]],this._data[t]=n[0],this._data[r(t)]=n[1],t=r(t)},t.prototype._downHeap=function(){var t,e,r;for(t=1;n(t<this._data.length)&&(e=n(t),e<this._data.length-1&&this._data[i(t)]<this._data[e]&&(e=i(t)),this._data[e]<this._data[t]);)r=[this._data[t],this._data[e]],this._data[e]=r[0],this._data[t]=r[1],t=e},t}(),r=function(t){return t>>1},n=function(t){return t<<1},i=function(t){return(t<<1)+1},t.exports=e}).call(this)},function(t,e){(function(){var e;e=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this.head={prev:void 0,value:void 0,next:void 0},this.tail={prev:void 0,value:void 0,next:void 0},this.size=0,n=0,r=t.length;n<r;n++)e=t[n],this.add(e)}return t.prototype.at=function(t){var e,n,r,i,o;if(-this.size<=t&&t<this.size){if(t=this._adjust(t),2*t<this.size)for(e=this.head,n=r=1;r<=t;n=r+=1)e=e.next;else for(e=this.tail,n=i=1,o=this.size-t-1;i<=o;n=i+=1)e=e.prev;return e}},t.prototype.add=function(t,e){var n,r,i,o,a;if(null==e&&(e=this.size),-this.size<=e&&e<=this.size)return r={value:t},e=this._adjust(e),0===this.size?this.head=r:0===e?(i=[r,this.head,r],this.head.prev=i[0],r.next=i[1],this.head=i[2]):(n=this.at(e-1),o=[n.next,r,r,n],r.next=o[0],null!=(a=n.next)?a.prev=o[1]:void 0,n.next=o[2],r.prev=o[3]),e===this.size&&(this.tail=r),this.size++,t},t.prototype.removeAt=function(t){var e,n,r;if(null==t&&(t=this.size-1),-this.size<=t&&t<this.size&&0!==this.size)return t=this._adjust(t),1===this.size?(n=this.head.value,this.head.value=this.tail.value=void 0):0===t?(n=this.head.value,this.head=this.head.next,this.head.prev=void 0):(e=this.at(t),n=e.value,e.prev.next=e.next,null!=(r=e.next)&&(r.prev=e.prev),t===this.size-1&&(this.tail=e.prev)),this.size--,n},t.prototype.remove=function(t){var e;if(null!=t){for(e=this.head;e&&e.value!==t;)e=e.next;if(e)return 1===this.size?this.head.value=this.tail.value=void 0:e===this.head?(this.head=this.head.next,this.head.prev=void 0):e===this.tail?(this.tail=this.tail.prev,this.tail.next=void 0):(e.prev.next=e.next,e.next.prev=e.prev),this.size--,t}},t.prototype.indexOf=function(t,e){var n,r;if(null==e&&(e=0),null==this.head.value&&!this.head.next||e>=this.size)return-1;for(e=Math.max(0,this._adjust(e)),n=this.at(e),r=e;n&&n.value!==t;)n=n.next,r++;return r===this.size?-1:r},t.prototype._adjust=function(t){return t<0?this.size+t:t},t}(),t.exports=e}).call(this)},function(t,e){(function(){var e,n,r,i,o={}.hasOwnProperty;n="_mapId_",e=function(){function t(e){var n,r;this._content={},this._itemId=0,this._id=t._newMapId(),this.size=0;for(n in e)o.call(e,n)&&(r=e[n],this.set(n,r))}return t._mapIdTracker=0,t._newMapId=function(){return this._mapIdTracker++},t.prototype.hash=function(t,e){var o,a;return null==e&&(e=!1),a=r(t),i(t)?(o=n+this._id,e&&!t[o]&&(t[o]=this._itemId++),o+"_"+t[o]):a+"_"+t},t.prototype.set=function(t,e){return this.has(t)||this.size++,this._content[this.hash(t,!0)]=[e,t],e},t.prototype.get=function(t){var e;return null!=(e=this._content[this.hash(t)])?e[0]:void 0},t.prototype.has=function(t){return this.hash(t)in this._content},t.prototype.delete=function(t){var e;return e=this.hash(t),e in this._content&&(delete this._content[e],i(t)&&delete t[n+this._id],this.size--,!0)},t.prototype.forEach=function(t){var e,n,r;r=this._content;for(e in r)o.call(r,e)&&(n=r[e],t(n[1],n[0]))},t}(),i=function(t){var e,n,i,o,a;for(e=["Boolean","Number","String","Undefined","Null","RegExp","Function"],i=r(t),o=0,a=e.length;o<a;o++)if(n=e[o],i===n)return!1;return!0},r=function(t){return Object.prototype.toString.apply(t).match(/\[object (.+)\]/)[1]},t.exports=e}).call(this)},function(t,e){(function(){var e;e=function(){function t(t){null==t&&(t=[]),this._content=t,this._dequeueIndex=0,this.size=this._content.length}return t.prototype.enqueue=function(t){return this.size++,this._content.push(t),t},t.prototype.dequeue=function(){var t;if(0!==this.size)return this.size--,t=this._content[this._dequeueIndex],this._dequeueIndex++,2*this._dequeueIndex>this._content.length&&(this._content=this._content.slice(this._dequeueIndex),this._dequeueIndex=0),t},t.prototype.peek=function(){return this._content[this._dequeueIndex]},t}(),t.exports=e}).call(this)},function(t,e){(function(){var e,n,r,i,o,a,s,l,u,c,d,h,p,f,g;n=0,r=1,i=2,s=3,o=1,e=2,a=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this._root,this.size=0,n=0,r=t.length;n<r;n++)e=t[n],null!=e&&this.add(e)}return t.prototype.add=function(t){var a,d,h,p;if(null!=t){if(this.size++,h={value:t,_color:o},this._root){if(d=l(this._root,function(e){return t===e.value?n:t<e.value?e._left?r:(h._parent=e,e._left=h,s):e._right?i:(h._parent=e,e._right=h,s)}),null!=d)return}else this._root=h;for(a=h;;){if(a===this._root){a._color=e;break}if(a._parent._color===e)break;{if((null!=(p=g(a))?p._color:void 0)!==o){!c(a)&&c(a._parent)?(this._rotateLeft(a._parent),a=a._left):c(a)&&!c(a._parent)&&(this._rotateRight(a._parent),a=a._right),a._parent._color=e,u(a)._color=o,c(a)?this._rotateRight(u(a)):this._rotateLeft(u(a));break}a._parent._color=e,g(a)._color=e,u(a)._color=o,a=u(a)}}return t}},t.prototype.has=function(t){var e;return e=l(this._root,function(e){return t===e.value?n:t<e.value?r:i}),!!e},t.prototype.peekMin=function(){var t;return null!=(t=p(this._root))?t.value:void 0},t.prototype.peekMax=function(){var t;return null!=(t=h(this._root))?t.value:void 0},t.prototype.remove=function(t){var e;if(e=l(this._root,function(e){return t===e.value?n:t<e.value?r:i}))return this._removeNode(this._root,e),this.size--,t},t.prototype.removeMin=function(){var t,e;if(t=p(this._root))return e=t.value,this._removeNode(this._root,t),e},t.prototype.removeMax=function(){var t,e;if(t=h(this._root))return e=t.value,this._removeNode(this._root,t),e},t.prototype._removeNode=function(t,n){var r,i,a,s,l,u,h,g,v,m;if(n._left&&n._right&&(i=p(n._right),n.value=i.value,n=i),i=n._left||n._right,i||(i={color:e,_right:void 0,_left:void 0,isLeaf:!0}),i._parent=n._parent,null!=(a=n._parent)&&(a[d(n)]=i),n._color===e)if(i._color===o)i._color=e,i._parent||(this._root=i);else for(;;){if(!i._parent){i.isLeaf?this._root=void 0:this._root=i;break}if(r=f(i),(null!=r?r._color:void 0)===o&&(i._parent._color=o,r._color=e,c(i)?this._rotateLeft(i._parent):this._rotateRight(i._parent)),r=f(i),i._parent._color!==e||r&&(r._color!==e||r._left&&r._left._color!==e||r._right&&r._right._color!==e)){if(!(i._parent._color!==o||r&&(r._color!==e||r._left&&(null!=(s=r._left)?s._color:void 0)!==e||r._right&&(null!=(l=r._right)?l._color:void 0)!==e))){null!=r&&(r._color=o),i._parent._color=e;break}if((null!=r?r._color:void 0)===e){!c(i)||r._right&&r._right._color!==e||(null!=(u=r._left)?u._color:void 0)!==o?c(i)||r._left&&r._left._color!==e||(null!=(g=r._right)?g._color:void 0)!==o||(r._color=o,null!=(v=r._right)&&(v._color=e),this._rotateLeft(r)):(r._color=o,null!=(h=r._left)&&(h._color=e),this._rotateRight(r));break}r=f(i),r._color=i._parent._color,c(i)?(r._right._color=e,this._rotateRight(i._parent)):(r._left._color=e,this._rotateLeft(i._parent))}else null!=r&&(r._color=o),i.isLeaf&&(i._parent[d(i)]=void 0),i=i._parent}if(i.isLeaf)return null!=(m=i._parent)?m[d(i)]=void 0:void 0},t.prototype._rotateLeft=function(t){var e,n;if(null!=(e=t._parent)&&(e[d(t)]=t._right),t._right._parent=t._parent,t._parent=t._right,t._right=t._right._left,t._parent._left=t,null!=(n=t._right)&&(n._parent=t),null==t._parent._parent)return this._root=t._parent},t.prototype._rotateRight=function(t){var e,n;if(null!=(e=t._parent)&&(e[d(t)]=t._left),t._left._parent=t._parent,t._parent=t._left,t._left=t._left._right,t._parent._right=t,null!=(n=t._left)&&(n._parent=t),null==t._parent._parent)return this._root=t._parent},t}(),c=function(t){return t===t._parent._left},d=function(t){return c(t)?"_left":"_right"},l=function(t,e){var o,a,l;for(a=t,l=void 0;a;){if(o=e(a),o===n){l=a;break}if(o===r)a=a._left;else if(o===i)a=a._right;else if(o===s)break}return l},p=function(t){return l(t,function(t){return t._left?r:n})},h=function(t){return l(t,function(t){return t._right?i:n})},u=function(t){var e;return null!=(e=t._parent)?e._parent:void 0},g=function(t){if(u(t))return c(t._parent)?u(t)._right:u(t)._left},f=function(t){return c(t)?t._parent._right:t._parent._left},t.exports=a}).call(this)},function(t,e,n){(function(){var e,r,i,o,a={}.hasOwnProperty;e=n(6),i="end",r=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this._root={},this.size=0,n=0,r=t.length;n<r;n++)e=t[n],this.add(e)}return t.prototype.add=function(t){var e,n,r,o;if(null!=t){for(this.size++,e=this._root,r=0,o=t.length;r<o;r++)n=t[r],null==e[n]&&(e[n]={}),e=e[n];return e[i]=!0,t}},t.prototype.has=function(t){var e,n,r,o;if(null==t)return!1;for(e=this._root,r=0,o=t.length;r<o;r++){if(n=t[r],null==e[n])return!1;e=e[n]}return!!e[i]},t.prototype.longestPrefixOf=function(t){var e,n,r,i,o;if(null==t)return"";for(e=this._root,r="",i=0,o=t.length;i<o&&(n=t[i],null!=e[n]);i++)r+=n,e=e[n];return r},t.prototype.wordsWithPrefix=function(t){var n,r,o,s,l,u,c,d,h,p;if(null==t)return[];for(null!=t||(t=""),c=[],r=this._root,d=0,h=t.length;d<h;d++)if(o=t[d],r=r[o],null==r)return[];for(l=new e,l.enqueue([r,""]);0!==l.size;){
p=l.dequeue(),s=p[0],n=p[1],s[i]&&c.push(t+n);for(o in s)a.call(s,o)&&(u=s[o],l.enqueue([u,n+o]))}return c},t.prototype.remove=function(t){var e,n,r,a,s,l,u,c;if(null!=t){for(e=this._root,a=[],s=0,u=t.length;s<u;s++){if(r=t[s],null==e[r])return;e=e[r],a.push([r,e])}if(e[i]){if(this.size--,delete e[i],o(e,1))return t;for(n=l=c=a.length-1;(c<=1?l<=1:l>=1)&&!o(a[n][1],1);n=c<=1?++l:--l)delete a[n-1][1][a[n][0]];return o(this._root[a[0][0]],1)||delete this._root[a[0][0]],t}}},t}(),o=function(t,e){var n,r;if(0===e)return!0;r=0;for(n in t)if(a.call(t,n)&&(r++,r>=e))return!0;return!1},t.exports=r}).call(this)}]),e.module("uiGmapgoogle-maps.wrapped").service("uiGmapMarkerSpiderfier",["uiGmapGoogleMapApi",function(e){var n=this;return+function(){var e={}.hasOwnProperty,n=[].slice;this.OverlappingMarkerSpiderfier=function(){function r(t,n){var r,o,a,s,l,u;this.map=t,null==n&&(n={});for(o in n)e.call(n,o)&&(u=n[o],this[o]=u);for(this.projHelper=new this.constructor.ProjHelper(this.map),this.initMarkerArrays(),this.listeners={},l=["click","zoom_changed","maptypeid_changed"],a=0,s=l.length;a<s;a++)r=l[a],i.addListener(this.map,r,function(t){return function(){return t.unspiderfy()}}(this))}var i,o,a,s,l,u,c,d,h,p,f;for(d=r.prototype,h=[r,d],a=0,u=h.length;a<u;a++)f=h[a],f.VERSION="0.3.3";return o=void 0,i=void 0,c=void 0,p=2*Math.PI,d.keepSpiderfied=!1,d.markersWontHide=!1,d.markersWontMove=!1,d.nearbyDistance=20,d.circleSpiralSwitchover=9,d.circleFootSeparation=23,d.circleStartAngle=p/12,d.spiralFootSeparation=26,d.spiralLengthStart=11,d.spiralLengthFactor=4,d.spiderfiedZIndex=1e3,d.usualLegZIndex=10,d.highlightedLegZIndex=20,d.event="click",d.minZoomLevel=!1,d.legWeight=1.5,d.legColors={usual:{},highlighted:{}},l=d.legColors.usual,s=d.legColors.highlighted,r.initializeGoogleMaps=function(t){return o=t.maps,i=o.event,c=o.MapTypeId,l[c.HYBRID]=l[c.SATELLITE]="#fff",s[c.HYBRID]=s[c.SATELLITE]="#f00",l[c.TERRAIN]=l[c.ROADMAP]="#444",s[c.TERRAIN]=s[c.ROADMAP]="#f00",this.ProjHelper=function(t){return this.setMap(t)},this.ProjHelper.prototype=new o.OverlayView,this.ProjHelper.prototype.draw=function(){}},d.initMarkerArrays=function(){return this.markers=[],this.markerListenerRefs=[]},d.addMarker=function(t){var e;return null!=t._oms?this:(t._oms=!0,e=[i.addListener(t,this.event,function(e){return function(n){return e.spiderListener(t,n)}}(this))],this.markersWontHide||e.push(i.addListener(t,"visible_changed",function(e){return function(){return e.markerChangeListener(t,!1)}}(this))),this.markersWontMove||e.push(i.addListener(t,"position_changed",function(e){return function(){return e.markerChangeListener(t,!0)}}(this))),this.markerListenerRefs.push(e),this.markers.push(t),this)},d.markerChangeListener=function(t,e){if(null!=t._omsData&&(e||!t.getVisible())&&null==this.spiderfying&&null==this.unspiderfying)return this.unspiderfy(e?t:null)},d.getMarkers=function(){return this.markers.slice(0)},d.removeMarker=function(t){var e,n,r,o,a;if(null!=t._omsData&&this.unspiderfy(),e=this.arrIndexOf(this.markers,t),e<0)return this;for(a=this.markerListenerRefs.splice(e,1)[0],n=0,r=a.length;n<r;n++)o=a[n],i.removeListener(o);return delete t._oms,this.markers.splice(e,1),this},d.clearMarkers=function(){var t,e,n,r,o,a,s,l,u;for(this.unspiderfy(),u=this.markers,t=e=0,n=u.length;e<n;t=++e){for(s=u[t],a=this.markerListenerRefs[t],l=0,r=a.length;l<r;l++)o=a[l],i.removeListener(o);delete s._oms}return this.initMarkerArrays(),this},d.addListener=function(t,e){var n;return(null!=(n=this.listeners)[t]?n[t]:n[t]=[]).push(e),this},d.removeListener=function(t,e){var n;return n=this.arrIndexOf(this.listeners[t],e),n<0||this.listeners[t].splice(n,1),this},d.clearListeners=function(t){return this.listeners[t]=[],this},d.trigger=function(){var t,e,r,i,o,a,s,l;for(e=arguments[0],t=2<=arguments.length?n.call(arguments,1):[],s=null!=(a=this.listeners[e])?a:[],l=[],i=0,o=s.length;i<o;i++)r=s[i],l.push(r.apply(null,t));return l},d.generatePtsCircle=function(t,e){var n,r,i,a,s,l,u,c;for(i=this.circleFootSeparation*(2+t),l=i/p,r=p/t,c=[],a=s=0,u=t;0<=u?s<u:s>u;a=0<=u?++s:--s)n=this.circleStartAngle+a*r,c.push(new o.Point(e.x+l*Math.cos(n),e.y+l*Math.sin(n)));return c},d.generatePtsSpiral=function(t,e){var n,r,i,a,s,l,u;for(a=this.spiralLengthStart,n=0,u=[],r=i=0,l=t;0<=l?i<l:i>l;r=0<=l?++i:--i)n+=this.spiralFootSeparation/a+5e-4*r,s=new o.Point(e.x+a*Math.cos(n),e.y+a*Math.sin(n)),a+=p*this.spiralLengthFactor/n,u.push(s);return u},d.spiderListener=function(e,n){var r,i,o,a,s,l,u,c,h,p,f,g,v;if(c=null!=e._omsData,c&&this.keepSpiderfied||("mouseover"===this.event?(r=this,i=function(){return r.unspiderfy()},t.clearTimeout(d.timeout),d.timeout=setTimeout(i,3e3)):this.unspiderfy()),c||this.map.getStreetView().getVisible()||"GoogleEarthAPI"===this.map.getMapTypeId())return this.trigger("click",e,n);for(p=[],f=[],h=this.nearbyDistance,g=h*h,u=this.llToPt(e.position),v=this.markers,o=0,a=v.length;o<a;o++)s=v[o],null!=s.map&&s.getVisible()&&(l=this.llToPt(s.position),this.ptDistanceSq(l,u)<g?p.push({marker:s,markerPt:l}):f.push(s));return 1===p.length?this.trigger("click",e,n):this.spiderfy(p,f)},d.markersNearMarker=function(t,e){var n,r,i,o,a,s,l,u,c,d,h;if(null==e&&(e=!1),null==this.projHelper.getProjection())throw"Must wait for 'idle' event on map before calling markersNearMarker";for(l=this.nearbyDistance,u=l*l,a=this.llToPt(t.position),s=[],c=this.markers,n=0,r=c.length;n<r&&(i=c[n],!(i!==t&&null!=i.map&&i.getVisible()&&(o=this.llToPt(null!=(d=null!=(h=i._omsData)?h.usualPosition:void 0)?d:i.position),this.ptDistanceSq(o,a)<u&&(s.push(i),e))));n++);return s},d.markersNearAnyOtherMarker=function(){var t,e,n,r,i,o,a,s,l,u,c,d,h,p,f,g,v,m,y,b,x;if(null==this.projHelper.getProjection())throw"Must wait for 'idle' event on map before calling markersNearAnyOtherMarker";for(f=this.nearbyDistance,g=f*f,h=function(){var t,e,n,r,i,o;for(n=this.markers,o=[],t=0,e=n.length;t<e;t++)s=n[t],o.push({pt:this.llToPt(null!=(r=null!=(i=s._omsData)?i.usualPosition:void 0)?r:s.position),willSpiderfy:!1});return o}.call(this),m=this.markers,e=r=0,i=m.length;r<i;e=++r)if(l=m[e],null!=l.map&&l.getVisible()&&(u=h[e],!u.willSpiderfy))for(y=this.markers,n=p=0,o=y.length;p<o;n=++p)if(c=y[n],n!==e&&null!=c.map&&c.getVisible()&&(d=h[n],(!(n<e)||d.willSpiderfy)&&this.ptDistanceSq(u.pt,d.pt)<g)){u.willSpiderfy=d.willSpiderfy=!0;break}for(b=this.markers,x=[],t=v=0,a=b.length;v<a;t=++v)s=b[t],h[t].willSpiderfy&&x.push(s);return x},d.makeHighlightListenerFuncs=function(t){return{highlight:function(e){return function(){return t._omsData.leg.setOptions({strokeColor:e.legColors.highlighted[e.map.mapTypeId],zIndex:e.highlightedLegZIndex})}}(this),unhighlight:function(e){return function(){return t._omsData.leg.setOptions({strokeColor:e.legColors.usual[e.map.mapTypeId],zIndex:e.usualLegZIndex})}}(this)}},d.spiderfy=function(t,e){var n,r,a,s,l,u,c,d,h,p,f;return!(this.minZoomLevel&&this.map.getZoom()<this.minZoomLevel)&&(this.spiderfying=!0,p=t.length,n=this.ptAverage(function(){var e,n,r;for(r=[],e=0,n=t.length;e<n;e++)d=t[e],r.push(d.markerPt);return r}()),s=p>=this.circleSpiralSwitchover?this.generatePtsSpiral(p,n).reverse():this.generatePtsCircle(p,n),f=function(){var e,n,d;for(d=[],e=0,n=s.length;e<n;e++)a=s[e],r=this.ptToLl(a),h=this.minExtract(t,function(t){return function(e){return t.ptDistanceSq(e.markerPt,a)}}(this)),c=h.marker,u=new o.Polyline({map:this.map,path:[c.position,r],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex}),c._omsData={usualPosition:c.position,leg:u},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(l=this.makeHighlightListenerFuncs(c),c._omsData.hightlightListeners={highlight:i.addListener(c,"mouseover",l.highlight),unhighlight:i.addListener(c,"mouseout",l.unhighlight)}),c.setPosition(r),c.setZIndex(Math.round(this.spiderfiedZIndex+a.y)),d.push(c);return d}.call(this),delete this.spiderfying,this.spiderfied=!0,this.trigger("spiderfy",f,e))},d.unspiderfy=function(t){var e,n,r,o,a,s,l;if(null==t&&(t=null),null==this.spiderfied)return this;for(this.unspiderfying=!0,l=[],a=[],s=this.markers,e=0,n=s.length;e<n;e++)o=s[e],null!=o._omsData?(o._omsData.leg.setMap(null),o!==t&&o.setPosition(o._omsData.usualPosition),o.setZIndex(null),r=o._omsData.hightlightListeners,null!=r&&(i.removeListener(r.highlight),i.removeListener(r.unhighlight)),delete o._omsData,l.push(o)):a.push(o);return delete this.unspiderfying,delete this.spiderfied,this.trigger("unspiderfy",l,a),this},d.ptDistanceSq=function(t,e){var n,r;return n=t.x-e.x,r=t.y-e.y,n*n+r*r},d.ptAverage=function(t){var e,n,r,i,a,s;for(a=s=0,e=0,n=t.length;e<n;e++)i=t[e],a+=i.x,s+=i.y;return r=t.length,new o.Point(a/r,s/r)},d.llToPt=function(t){return this.projHelper.getProjection().fromLatLngToDivPixel(t)},d.ptToLl=function(t){return this.projHelper.getProjection().fromDivPixelToLatLng(t)},d.minExtract=function(t,e){var n,r,i,o,a,s,l;for(i=a=0,s=t.length;a<s;i=++a)o=t[i],l=e(o),("undefined"==typeof n||null===n||l<r)&&(r=l,n=i);return t.splice(n,1)[0]},d.arrIndexOf=function(t,e){var n,r,i,o;if(null!=t.indexOf)return t.indexOf(e);for(n=r=0,i=t.length;r<i;n=++r)if(o=t[n],o===e)return n;return-1},r}()}.apply(n),e.then(function(){n.OverlappingMarkerSpiderfier.initializeGoogleMaps(t.google)}),this.OverlappingMarkerSpiderfier}]),e.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendMarkerClusterer",["uiGmapLodash","uiGmapPropMap",function(e,n){return{init:_.once(function(){(function(){var r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t.NgMapCluster=function(t){function r(t){r.__super__.constructor.call(this,t),this.markers_=new n}return i(r,t),r.prototype.addMarker=function(t){var e,n;if(this.isMarkerAlreadyAdded_(t)){var r=this.markers_.get(t.key);if(r.getPosition().lat()==t.getPosition().lat()&&r.getPosition().lon()==t.getPosition().lon())return!1}if(this.center_){if(this.averageCenter_){var i=this.markers_.length+1,o=(this.center_.lat()*(i-1)+t.getPosition().lat())/i,a=(this.center_.lng()*(i-1)+t.getPosition().lng())/i;this.center_=new google.maps.LatLng(o,a),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();return t.isAdded=!0,this.markers_.push(t),e=this.markers_.length,n=this.markerClusterer_.getMaxZoom(),null!==n&&this.map_.getZoom()>n?t.getMap()!==this.map_&&t.setMap(this.map_):e<this.minClusterSize_?t.getMap()!==this.map_&&t.setMap(this.map_):e===this.minClusterSize_?this.markers_.each(function(t){t.setMap(null)}):t.setMap(null),!0},r.prototype.isMarkerAlreadyAdded_=function(t){return e.isNullOrUndefined(this.markers_.get(t.key))},r.prototype.getBounds=function(){var t=new google.maps.LatLngBounds(this.center_,this.center_);return this.getMarkers().each(function(e){t.extend(e.getPosition())}),t},r.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=new n,delete this.markers_},r}(Cluster),t.NgMapMarkerClusterer=function(t){function e(t,r,i){e.__super__.constructor.call(this,t,r,i),this.markers_=new n}return i(e,t),e.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=new n},e.prototype.removeMarker_=function(t){return!!this.markers_.get(t.key)&&(t.setMap(null),this.markers_.remove(t.key),!0)},e.prototype.createClusters_=function(t){var e,n,r,i=this;if(this.ready_){0===t&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),r=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,(-178.48388434375)),new google.maps.LatLng((-85.08136444384544),178.00048865625));var o=this.getExtendedBounds(r),a=Math.min(t+this.batchSize_,this.markers_.length),s=this.markers_.values();for(e=t;e<a;e++)n=s[e],!n.isAdded&&this.isMarkerInBounds_(n,o)&&(!this.ignoreHidden_||this.ignoreHidden_&&n.getVisible())&&this.addToClosestCluster_(n);if(a<this.markers_.length)this.timerRefStatic=setTimeout(function(){i.createClusters_(a)},0);else{for(e=0;e<this.clusters_.length;e++)this.clusters_[e].updateIcon_();delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this)}}},e.prototype.addToClosestCluster_=function(t){var e,n,r,i,o=4e4,a=null;for(e=0;e<this.clusters_.length;e++)r=this.clusters_[e],i=r.getCenter(),i&&(n=this.distanceBetweenPoints_(i,t.getPosition()),n<o&&(o=n,a=r));a&&a.isMarkerInClusterBounds(t)?a.addMarker(t):(r=new NgMapCluster(this),r.addMarker(t),this.clusters_.push(r))},e.prototype.redraw_=function(){this.createClusters_(0)},e.prototype.resetViewport_=function(t){var e;for(e=0;e<this.clusters_.length;e++)this.clusters_[e].remove();this.clusters_=[],this.markers_.each(function(e){e.isAdded=!1,t&&e.setMap(null)})},e.prototype.extend=function(t,e){return function(t){var e;for(e in t.prototype)"constructor"!==e&&(this.prototype[e]=t.prototype[e]);return this}.apply(t,[e])},ClusterIcon.prototype.show=function(){if(this.div_){var t="",e=this.backgroundPosition_.split(" "),n=parseInt(e[0].trim(),10),r=parseInt(e[1].trim(),10),i=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(i),t="<img src='"+this.url_+"' style='position: absolute; top: "+r+"px; left: "+n+"px; ",t+=this.cluster_.getMarkerClusterer().enableRetinaIcons_?"width: "+this.width_+"px;height: "+this.height_+"px;":"clip: rect("+-1*r+"px, "+(-1*n+this.width_)+"px, "+(-1*r+this.height_)+"px, "+-1*n+"px);",t+="'>",this.div_.innerHTML=t+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},e}(MarkerClusterer)}).call(this)})}}])}(window,angular);