{"version":3,"sources":["/source/core.js","/source/behaviors/clear_errors.js","/source/behaviors/draggable.js","/source/behaviors/fab_tooltip_visibility.js","/source/behaviors/focused.js","/source/behaviors/infinite_scroll.js","/source/behaviors/selected.js","/source/behaviors/unsaved_changes.js","/source/filters/datetime.js","/source/filters/translate.js","/source/formatting/date_format.js","/source/services/assert.js","/source/services/debug.js","/source/services/errors.js","/source/services/state.js","/source/services/theme.js","/source/services/timer.js","/source/services/transactions.js","/source/services/translate.js","/source/utilities/collections.js","/source/utilities/dates.js","/source/utilities/form_errors.js","/source/utilities/general.js","/source/utilities/strings.js","/source/utilities/tags.js","/source/utilities/utilities.js","/source/cache/data_cache.js","/source/cache/session_cache.js","/source/cache/tags_cache.js","/source/core/access.js","/source/core/auth_state.js","/source/core/enums.js","/source/core/rest.js","/source/core/session.js","/source/data/announces_data.js","/source/data/data.js","/source/data/data_model.js","/source/data/feedbacks_data.js","/source/data/guides_data.js","/source/data/image_sets_data.js","/source/data/session_data.js","/source/data/settings_data.js","/source/data/tags_data.js","/source/data/tips_data.js","/source/data/users_data.js","/source/layouts.js","/source/card/card.js","/source/dialog/dialog.js","/source/document/document.js","/source/main/main.js","/source/simple/simple.js","/source/split/split.js","/source/tiles/tiles.js","/source/pip-webui-controls-html.js","/source/controls.js","/source/color_picker/color_picker.js","/source/confirmation_dialog/confirmation_dialog.js","/source/conversion_dialog/conversion_dialog.js","/source/date/date.js","/source/date_range/date_range.js","/source/error_details_dialog/error_details_dialog.js","/source/image_slider/image_slider.js","/source/information_dialog/information_dialog.js","/source/markdown/markdown.js","/source/options_dialog/options_dialog.js","/source/options_dialog/options_dialog_big.js","/source/popover/popover.js","/source/progress/routing_progress.js","/source/refresh_button/refresh_button.js","/source/time_edit/time_edit.js","/source/time_view/time_view.js","/source/toast/toasts.js","/source/toggle_buttons/toggle_buttons.js","/source/nav.js","/source/pip-webui-nav-html.js","/source/appbar/appbar.js","/source/appbar/appbar_service.js","/source/dropdown/dropdown.js","/source/sidenav/sidenav.js","/source/sidenav/sidenav_service.js","/source/tabs/tabs.js","/source/pip-webui-locations-html.js","/source/locations.js","/source/location/location.js","/source/location_dialog/location_dialog.js","/source/location_edit/location_edit.js","/source/location_ip/location_ip.js","/source/location_map/location_map.js","/source/documents.js","/source/pip-webui-documents-html.js","/source/document_list/document_list.js","/source/document_list_edit/document_list_edit.js","/source/pictures.js","/source/pip-webui-pictures-html.js","/source/avatar/avatar.js","/source/add_image/add_image.js","/source/avatar_edit/avatar_edit.js","/source/camera_dialog/camera_dialog.js","/source/collage/collage.js","/source/gallery_search_dialog/gallery_search_dialog.js","/source/picture/picture.js","/source/picture_edit/picture_edit.js","/source/picture_list_edit/picture_list_edit.js","/source/picture_url_dialog/picture_url_dialog.js","/source/utilities/picture_paste.js","/source/utilities/picture_utils.js","/source/composite.js","/source/pip-webui-composite-html.js","/source/checklist_edit/checklist_edit.js","/source/checklist_view/checklist_view.js","/source/composite_summary/composite_summary.js","/source/composite_edit/composite_edit.js","/source/composite_view/composite_view.js","/source/composite_toolbar/composite_toolbar.js","/source/content_switch/content_switch.js","/source/mobile_mouse/mobile_mousedown.js","/source/mobile_mouse/mobile_mouseup.js","/source/utilities/composite_focused.js","/source/entry.js","/source/pip-webui-entry-html.js","/source/common/email_unique.js","/source/common/entry_common.js","/source/common/entry_strings.js","/source/common/password_match.js","/source/post_signup/post_signup.js","/source/post_signup/post_signup_dialog.js","/source/post_signup/post_signup_panel.js","/source/recover_password/recover_password.js","/source/recover_password/recover_password_dialog.js","/source/recover_password/recover_password_panel.js","/source/reset_password/reset_password.js","/source/reset_password/reset_password_dialog.js","/source/reset_password/reset_password_panel.js","/source/signin/signin.js","/source/signin/signin_dialog.js","/source/signin/signin_panel.js","/source/verify_email/verify_email.js","/source/signup/signup.js","/source/signup/signup_dialog.js","/source/signup/signup_panel.js","/source/pip-webui-errors-html.js","/source/errors.js","/source/errors_pages/errors_pages.js","/source/errors_pages/errors_strings.js","/source/maintenance/maintenance.js","/source/missing_route/missing_route.js","/source/no_connection/no_connection.js","/source/unknown/unknown.js","/source/unsupported/unsupported.js","/source/settings.js","/source/pip-webui-settings-html.js","/source/settings_page/settings_page.js","/source/settings_service/settings_service.js","/source/user_settings/user_settings.js","/source/user_settings/user_settings_basic_info.js","/source/user_settings/user_settings_change_password.js","/source/user_settings/user_settings_data.js","/source/user_settings/user_settings_sessions.js","/source/user_settings/user_settings_strings.js","/source/user_settings/user_settings_verify_email.js","/source/guidance.js","/source/pip-webui-guidance-html.js","/source/guidance/guidance_dialog.js","/source/intro_guidance/intro_guidance_dialog.js","/source/intro_guidance/intro_guidance_service.js","/source/tips/tips_service.js","/source/help.js","/source/pip-webui-help-html.js","/source/help_page/help_page.js","/source/help_service/help_service.js","/source/support.js","/source/pip-webui-support-html.js","/source/analytics/analytics.js","/source/feedback/feedback.js","/source/feedback/feedback_dialog.js","/source/feedback/feedback_panel.js","/source/feedback/feedback_strings.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3gBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACreA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACviBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7yBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9dA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnlCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"pip-webui.js","sourcesContent":["/**\r\n * @file Registration of all WebUI core services\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipCore', [\r\n        'pipUtils',\r\n        'pipErrors',\r\n\t    'pipTransactions',\r\n\t    'pipTranslate',\r\n        'pipState',\r\n        'pipTimer',\r\n        'pipAssert',\r\n        'pipDebug',\r\n        'pipDateFormat',\r\n        'pipDateTimeFilters',\r\n        'pipTranslateFilters',\r\n        'pipClearErrors',\r\n        'pipTheme',\r\n\r\n        'pipFocused',\r\n        'pipSelected',\r\n        'pipInfiniteScroll',\r\n        'pipDraggable',\r\n        'pipUnsavedChanges',\r\n        'pipFabTooltipVisibility',\r\n    ]);\r\n    \r\n})();","/**\r\n * @file Special error handling for forms\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipClearErrors', []);\r\n\r\n    thisModule.directive('pipClearErrors', function () {\r\n        return {\r\n            restrict: 'A',\r\n            require: ['ngModel', '^?form'],\r\n            link: function ($scope, $element, $attrs, $ctrls) {\r\n                var \r\n                    fieldController = $ctrls[0],\r\n                    formController = $ctrls[1];\r\n\r\n                $scope.$watch($attrs.ngModel, function (newValue) {\r\n                    clearFieldErrors();\r\n                    clearFormErrors();\r\n                });\r\n\r\n                //-------------------\r\n\r\n                function clearFieldErrors() {\r\n                    var errors = fieldController.$error;\r\n\r\n                    for (var prop in errors) {\r\n                        if (errors.hasOwnProperty(prop) && prop.substring(0, 6) == 'ERROR_') {\r\n                            fieldController.$setValidity(prop, true);\r\n                        }\r\n                    };\r\n                }\r\n\r\n                function clearFormErrors() {\r\n                    formController.$serverError = {};\r\n                };\r\n            }\r\n        };\r\n    });\r\n\r\n})();","/**\r\n * @file Drag & drop attachable behavior\r\n * @description\r\n * Based on https://github.com/fatlinesofcode/pipDraggable\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDraggable\", ['pipUtils']);\r\n\r\n    thisModule.service('pipDraggable', function () {\r\n\r\n        var scope = this;\r\n        scope.inputEvent = function (event) {\r\n            if (angular.isDefined(event.touches)) {\r\n                return event.touches[0];\r\n            }\r\n            //Checking both is not redundent. If only check if touches isDefined, angularjs isDefnied will return error and stop the remaining scripty if event.originalEvent is not defined.\r\n            else if (angular.isDefined(event.originalEvent) && angular.isDefined(event.originalEvent.touches)) {\r\n                return event.originalEvent.touches[0];\r\n            }\r\n            return event;\r\n        };\r\n\r\n    });\r\n\r\n    thisModule.directive('pipDrag', ['$rootScope', '$parse', '$document', '$window', 'pipDraggable', 'pipUtils', function ($rootScope, $parse, $document, $window, pipDraggable, pipUtils) {\r\n            return {\r\n\r\n                restrict: 'A',\r\n                link: function (scope, element, attrs) {\r\n                    scope.value = attrs.ngDrag;\r\n                    var offset, _centerAnchor = false, _mx, _my, _tx, _ty, _mrx, _mry;\r\n                    var _hasTouch = ('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch;\r\n                    var _pressEvents = 'touchstart mousedown';\r\n                    var _moveEvents = 'touchmove mousemove';\r\n                    var _releaseEvents = 'touchend mouseup';\r\n                    var _dragHandle;\r\n\r\n                    // to identify the element in order to prevent getting superflous events when a single element has both drag and drop directives on it.\r\n                    var _myid = scope.$id;\r\n                    var _data = null;\r\n\r\n                    var _dragOffset = null;\r\n\r\n                    var _dragEnabled = false;\r\n\r\n                    var _pressTimer = null;\r\n\r\n                    var onDragStartCallback = $parse(attrs.pipDragStart) || null;\r\n                    var onDragStopCallback = $parse(attrs.pipDragStop) || null;\r\n                    var onDragSuccessCallback = $parse(attrs.pipDragSuccess) || null;\r\n                    var allowTransform = angular.isDefined(attrs.allowTransform) ? scope.$eval(attrs.allowTransform) : false;\r\n\r\n                    var getDragData = $parse(attrs.pipDragData);\r\n                    var\r\n                        verticalScroll = pipUtils.toBoolean(attrs.pipVerticalScroll) || true,\r\n                        horizontalScroll = pipUtils.toBoolean(attrs.pipHorizontalScroll) || true,\r\n                        activationDistance = parseFloat(attrs.pipActivationDistance) || 75,\r\n                        scrollDistance = parseFloat(attrs.pipScrollDistance) || 50,\r\n                        scrollParent = false,\r\n\r\n                        scrollContainer = angular.element(window),\r\n                        scrollContainerGetter = $parse(attrs.pipScrollContainer);\r\n\r\n                    // deregistration function for mouse move events in $rootScope triggered by jqLite trigger handler\r\n                    var _deregisterRootMoveListener = angular.noop;\r\n\r\n                    var initialize = function () {\r\n                        element.attr('pip-draggable', 'false'); // prevent native drag\r\n                        // check to see if drag handle(s) was specified\r\n                        // if querySelectorAll is available, we use this instead of find\r\n                        // as JQLite find is limited to tagnames\r\n                        if (element[0].querySelectorAll) {\r\n                            var dragHandles = angular.element(element[0].querySelectorAll('[pip-drag-handle]'));\r\n                        } else {\r\n                            var dragHandles = element.find('[pip-drag-handle]');\r\n                        }\r\n                        if (dragHandles.length) {\r\n                            _dragHandle = dragHandles;\r\n                        }\r\n                        toggleListeners(true);\r\n\r\n                        // Initialize scroll container\r\n                        if (scrollParent) {\r\n                            scrollContainer = angular.element($element.parent());\r\n                        } else if (attrs.pipScrollContainer) {\r\n                            scrollContainer = angular.element(scrollContainerGetter(scope));\r\n                        } else {\r\n                            scrollContainer = angular.element(window);\r\n                        }\r\n                    };\r\n\r\n                    var toggleListeners = function (enable) {\r\n                        if (!enable)return;\r\n                        // add listeners.\r\n\r\n                        scope.$on('$destroy', onDestroy);\r\n                        scope.$watch(attrs.pipDrag, onEnableChange);\r\n                        scope.$watch(attrs.pipCenterAnchor, onCenterAnchor);\r\n                        // wire up touch events\r\n                        if (_dragHandle) {\r\n                            // handle(s) specified, use those to initiate drag\r\n                            _dragHandle.on(_pressEvents, onpress);\r\n                        } else {\r\n                            // no handle(s) specified, use the element as the handle\r\n                            element.on(_pressEvents, onpress);\r\n                        }\r\n                        if (!_hasTouch && element[0].nodeName.toLowerCase() == \"img\") {\r\n                            element.on('mousedown', function () {\r\n                                return false;\r\n                            }); // prevent native drag for images\r\n                        }\r\n                    };\r\n                    var onDestroy = function (enable) {\r\n                        toggleListeners(false);\r\n                    };\r\n                    var onEnableChange = function (newVal, oldVal) {\r\n                        _dragEnabled = (newVal);\r\n                    };\r\n                    var onCenterAnchor = function (newVal, oldVal) {\r\n                        if (angular.isDefined(newVal))\r\n                            _centerAnchor = (newVal || 'true');\r\n                    };\r\n\r\n                    var isClickableElement = function (evt) {\r\n                        return (\r\n                            angular.isDefined(angular.element(evt.target).attr(\"pip-cancel-drag\"))\r\n                        );\r\n                    };\r\n                    /*\r\n                     * When the element is clicked start the drag behaviour\r\n                     * On touch devices as a small delay so as not to prevent native window scrolling\r\n                     */\r\n                    var onpress = function (evt) {\r\n                        if (!_dragEnabled)return;\r\n\r\n                        if (isClickableElement(evt)) {\r\n                            return;\r\n                        }\r\n\r\n                        if (evt.type == \"mousedown\" && evt.button != 0) {\r\n                            // Do not start dragging on right-click\r\n                            return;\r\n                        }\r\n\r\n                        if (_hasTouch) {\r\n                            cancelPress();\r\n                            _pressTimer = setTimeout(function () {\r\n                                cancelPress();\r\n                                onlongpress(evt);\r\n                            }, 100);\r\n                            $document.on(_moveEvents, cancelPress);\r\n                            $document.on(_releaseEvents, cancelPress);\r\n                        } else {\r\n                            onlongpress(evt);\r\n                        }\r\n\r\n                    };\r\n\r\n                    var cancelPress = function () {\r\n                        clearTimeout(_pressTimer);\r\n                        $document.off(_moveEvents, cancelPress);\r\n                        $document.off(_releaseEvents, cancelPress);\r\n                    };\r\n\r\n                    var onlongpress = function (evt) {\r\n                        if (!_dragEnabled)return;\r\n                        evt.preventDefault();\r\n\r\n                        offset = element[0].getBoundingClientRect();\r\n                        if (allowTransform)\r\n                            _dragOffset = offset;\r\n                        else {\r\n                            _dragOffset = {left: document.body.scrollLeft, top: document.body.scrollTop};\r\n                        }\r\n\r\n\r\n                        element.centerX = element[0].offsetWidth / 2;\r\n                        element.centerY = element[0].offsetHeight / 2;\r\n\r\n                        _mx = pipDraggable.inputEvent(evt).pageX;\r\n                        _my = pipDraggable.inputEvent(evt).pageY;\r\n                        _mrx = _mx - offset.left;\r\n                        _mry = _my - offset.top;\r\n                        if (_centerAnchor) {\r\n                            _tx = _mx - element.centerX - $window.pageXOffset;\r\n                            _ty = _my - element.centerY - $window.pageYOffset;\r\n                        } else {\r\n                            _tx = _mx - _mrx - $window.pageXOffset;\r\n                            _ty = _my - _mry - $window.pageYOffset;\r\n                        }\r\n\r\n                        $document.on(_moveEvents, onmove);\r\n                        $document.on(_releaseEvents, onrelease);\r\n                        // This event is used to receive manually triggered mouse move events\r\n                        // jqLite unfortunately only supports triggerHandler(...)\r\n                        // See http://api.jquery.com/triggerHandler/\r\n                        // _deregisterRootMoveListener = $rootScope.$on('draggable:_triggerHandlerMove', onmove);\r\n                        _deregisterRootMoveListener = $rootScope.$on('draggable:_triggerHandlerMove', function (event, origEvent) {\r\n                            onmove(origEvent);\r\n                        });\r\n                    };\r\n\r\n                    var onmove = function (evt) {\r\n                        if (!_dragEnabled)return;\r\n                        evt.preventDefault();\r\n\r\n                        if (!element.hasClass('pip-dragging')) {\r\n                            _data = getDragData(scope);\r\n                            element.addClass('pip-dragging');\r\n                            $rootScope.$broadcast('draggable:start', {\r\n                                x: _mx,\r\n                                y: _my,\r\n                                tx: _tx,\r\n                                ty: _ty,\r\n                                event: evt,\r\n                                element: element,\r\n                                data: _data\r\n                            });\r\n\r\n                            if (onDragStartCallback) {\r\n                                scope.$apply(function () {\r\n                                    onDragStartCallback(scope, {$data: _data, $event: evt});\r\n                                });\r\n                            }\r\n                        }\r\n\r\n                        _mx = pipDraggable.inputEvent(evt).pageX;\r\n                        _my = pipDraggable.inputEvent(evt).pageY;\r\n\r\n                        if (horizontalScroll || verticalScroll) {\r\n                            dragToScroll();\r\n                        }\r\n\r\n                        if (_centerAnchor) {\r\n                            _tx = _mx - element.centerX - _dragOffset.left;\r\n                            _ty = _my - element.centerY - _dragOffset.top;\r\n                        } else {\r\n                            _tx = _mx - _mrx - _dragOffset.left;\r\n                            _ty = _my - _mry - _dragOffset.top;\r\n                        }\r\n\r\n                        moveElement(_tx, _ty);\r\n\r\n                        $rootScope.$broadcast('draggable:move', {\r\n                            x: _mx,\r\n                            y: _my,\r\n                            tx: _tx,\r\n                            ty: _ty,\r\n                            event: evt,\r\n                            element: element,\r\n                            data: _data,\r\n                            uid: _myid,\r\n                            dragOffset: _dragOffset\r\n                        });\r\n                    };\r\n\r\n                    var onrelease = function (evt) {\r\n                        if (!_dragEnabled)\r\n                            return;\r\n                        evt.preventDefault();\r\n                        $rootScope.$broadcast('draggable:end', {\r\n                            x: _mx,\r\n                            y: _my,\r\n                            tx: _tx,\r\n                            ty: _ty,\r\n                            event: evt,\r\n                            element: element,\r\n                            data: _data,\r\n                            callback: onDragComplete,\r\n                            uid: _myid\r\n                        });\r\n                        element.removeClass('pip-dragging');\r\n                        element.parent().find('.pip-drag-enter').removeClass('pip-drag-enter');\r\n                        reset();\r\n                        $document.off(_moveEvents, onmove);\r\n                        $document.off(_releaseEvents, onrelease);\r\n\r\n                        if (onDragStopCallback) {\r\n                            scope.$apply(function () {\r\n                                onDragStopCallback(scope, {$data: _data, $event: evt});\r\n                            });\r\n                        }\r\n\r\n                        _deregisterRootMoveListener();\r\n                    };\r\n\r\n                    var onDragComplete = function (evt) {\r\n\r\n\r\n                        if (!onDragSuccessCallback)return;\r\n\r\n                        scope.$apply(function () {\r\n                            onDragSuccessCallback(scope, {$data: _data, $event: evt});\r\n                        });\r\n                    };\r\n\r\n                    var reset = function () {\r\n                        if (allowTransform)\r\n                            element.css({transform: '', 'z-index': '', '-webkit-transform': '', '-ms-transform': ''});\r\n                        else\r\n                            element.css({'position': '', top: '', left: '', 'z-index': '', width: ''});\r\n                    };\r\n\r\n                    var moveElement = function (x, y) {\r\n                        var eWidth = element.css('width');\r\n                        if (allowTransform) {\r\n                            element.css({\r\n                                transform: 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + x + ', ' + y + ', 0, 1)',\r\n                                'z-index': 99999,\r\n                                '-webkit-transform': 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + x + ', ' + y + ', 0, 1)',\r\n                                '-ms-transform': 'matrix(1, 0, 0, 1, ' + x + ', ' + y + ')'\r\n                            });\r\n                        } else {\r\n                            element.css({\r\n                                'left': x + 'px',\r\n                                'top': y + 'px',\r\n                                'position': 'fixed',\r\n                                'z-index': 100,\r\n                                width: eWidth\r\n                            });\r\n                        }\r\n                    };\r\n\r\n                    var dragToScroll = function () {\r\n                        var scrollX = 0, scrollY = 0,\r\n                            offset = function (element) {\r\n                                return element.offset() || {left: 0, top: 0};\r\n                            };\r\n\r\n                        if (horizontalScroll) {\r\n                            var\r\n                                containerLeft = offset(scrollContainer).left,\r\n                                containerWidth = scrollContainer.innerWidth(),\r\n                                containerRight = containerLeft + containerWidth;\r\n\r\n                            if ((_mx - containerLeft) < activationDistance) {\r\n                                scrollX = -scrollDistance;\r\n                            }\r\n                            else if ((containerRight - _mx) < activationDistance) {\r\n                                scrollX = scrollDistance;\r\n                            }\r\n                        }\r\n\r\n                        if (verticalScroll) {\r\n                            var\r\n                                containerTop = offset(scrollContainer).top,\r\n                                containerHeight = scrollContainer.innerHeight(),\r\n                                containerBottom = containerTop + containerHeight;\r\n\r\n                            if ((_my - containerTop) < activationDistance) {\r\n                                scrollY = -scrollDistance + 30;\r\n                            }\r\n                            else if ((containerBottom - _my) < activationDistance) {\r\n                                scrollY = scrollDistance - 30;\r\n                            }\r\n                        }\r\n                        if (scrollX !== 0 || scrollY !== 0) {\r\n                            var\r\n                                containerScrollLeft = scrollContainer.scrollLeft(),\r\n                                containerScrollTop = scrollContainer.scrollTop();\r\n\r\n                            scrollContainer.scrollLeft(containerScrollLeft + scrollX);\r\n                            scrollContainer.scrollTop(containerScrollTop + scrollY);\r\n                        }\r\n\r\n                    };\r\n\r\n                    initialize();\r\n                }\r\n            };\r\n        }]);\r\n\r\n    thisModule.directive('pipDrop', ['$parse', '$timeout', '$window', '$document', 'pipDraggable', function ($parse, $timeout, $window, $document, pipDraggable) {\r\n        return {\r\n            restrict: 'A',\r\n            link: function (scope, element, attrs) {\r\n                scope.value = attrs.pipDrop;\r\n                scope.isTouching = false;\r\n\r\n                var _lastDropTouch = null;\r\n\r\n                var _myid = scope.$id;\r\n\r\n                var _dropEnabled = false;\r\n\r\n                var onDropCallback = $parse(attrs.pipDropSuccess);// || function(){};\r\n\r\n                var onDragStartCallback = $parse(attrs.pipDragStart);\r\n                var onDragStopCallback = $parse(attrs.pipDragStop);\r\n                var onDragMoveCallback = $parse(attrs.pipDragMove);\r\n\r\n                var initialize = function () {\r\n                    toggleListeners(true);\r\n                };\r\n\r\n                var toggleListeners = function (enable) {\r\n                    // remove listeners\r\n\r\n                    if (!enable)return;\r\n                    // add listeners.\r\n                    scope.$watch(attrs.pipDrop, onEnableChange);\r\n                    scope.$on('$destroy', onDestroy);\r\n                    scope.$on('draggable:start', onDragStart);\r\n                    scope.$on('draggable:move', onDragMove);\r\n                    scope.$on('draggable:end', onDragEnd);\r\n                };\r\n\r\n                var onDestroy = function (enable) {\r\n                    toggleListeners(false);\r\n                };\r\n                var onEnableChange = function (newVal, oldVal) {\r\n                    _dropEnabled = newVal;\r\n                };\r\n                var onDragStart = function (evt, obj) {\r\n                    if (!_dropEnabled)return;\r\n                    isTouching(obj.x, obj.y, obj.element);\r\n\r\n                    if (attrs.pipDragStart) {\r\n                        $timeout(function () {\r\n                            onDragStartCallback(scope, {$data: obj.data, $event: obj});\r\n                        });\r\n                    }\r\n                };\r\n                var onDragMove = function (evt, obj) {\r\n                    if (!_dropEnabled)return;\r\n                    isTouching(obj.x, obj.y, obj.element);\r\n\r\n                    if (attrs.pipDragMove) {\r\n                        $timeout(function () {\r\n                            onDragMoveCallback(scope, {$data: obj.data, $event: obj});\r\n                        });\r\n                    }\r\n                };\r\n\r\n                var onDragEnd = function (evt, obj) {\r\n\r\n                    // don't listen to drop events if this is the element being dragged\r\n                    // only update the styles and return\r\n                    if (!_dropEnabled || _myid === obj.uid) {\r\n                        updateDragStyles(false, obj.element);\r\n                        return;\r\n                    }\r\n                    if (isTouching(obj.x, obj.y, obj.element)) {\r\n                        // call the pipDraggable pipDragSuccess element callback\r\n                        if (obj.callback) {\r\n                            obj.callback(obj);\r\n                        }\r\n\r\n                        if (attrs.pipDropSuccess) {\r\n                            $timeout(function () {\r\n                                onDropCallback(scope, {\r\n                                    $data: obj.data,\r\n                                    $event: obj,\r\n                                    $target: scope.$eval(scope.value)\r\n                                });\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    if (attrs.pipDragStop) {\r\n                        $timeout(function () {\r\n                            onDragStopCallback(scope, {$data: obj.data, $event: obj});\r\n                        });\r\n                    }\r\n\r\n                    updateDragStyles(false, obj.element);\r\n                };\r\n\r\n                var isTouching = function (mouseX, mouseY, dragElement) {\r\n                    var touching = hitTest(mouseX, mouseY);\r\n                    scope.isTouching = touching;\r\n                    if (touching) {\r\n                        _lastDropTouch = element;\r\n                    }\r\n                    updateDragStyles(touching, dragElement);\r\n                    return touching;\r\n                };\r\n\r\n                var updateDragStyles = function (touching, dragElement) {\r\n                    if (touching) {\r\n                        element.addClass('pip-drag-enter');\r\n                        dragElement.addClass('pip-drag-over');\r\n                    } else if (_lastDropTouch == element) {\r\n                        _lastDropTouch = null;\r\n                        element.removeClass('pip-drag-enter');\r\n                        dragElement.removeClass('pip-drag-over');\r\n                    }\r\n                };\r\n\r\n                var hitTest = function (x, y) {\r\n                    var bounds = element[0].getBoundingClientRect();\r\n                    x -= $document[0].body.scrollLeft + $document[0].documentElement.scrollLeft;\r\n                    y -= $document[0].body.scrollTop + $document[0].documentElement.scrollTop;\r\n                    return x >= bounds.left\r\n                        && x <= bounds.right\r\n                        && y <= bounds.bottom\r\n                        && y >= bounds.top;\r\n                };\r\n\r\n                initialize();\r\n            }\r\n        };\r\n    }]);\r\n\r\n    //thisModule.directive('pipDragClone', ['$parse', '$timeout', 'pipDraggable', function ($parse, $timeout, pipDraggable) {\r\n    //    return {\r\n    //        restrict: 'A',\r\n    //        link: function (scope, element, attrs) {\r\n    //            var img, _allowClone = true;\r\n    //            var _dragOffset = null;\r\n    //            scope.clonedData = {};\r\n    //            var initialize = function () {\r\n//\r\n    //                img = element.find('img');\r\n    //                element.attr('pip-draggable', 'false');\r\n    //                img.attr('draggable', 'false');\r\n    //                reset();\r\n    //                toggleListeners(true);\r\n    //            };\r\n//\r\n//\r\n    //            var toggleListeners = function (enable) {\r\n    //                // remove listeners\r\n//\r\n    //                if (!enable)return;\r\n    //                // add listeners.\r\n    //                scope.$on('draggable:start', onDragStart);\r\n    //                scope.$on('draggable:move', onDragMove);\r\n    //                scope.$on('draggable:end', onDragEnd);\r\n    //                preventContextMenu();\r\n//\r\n    //            };\r\n    //            var preventContextMenu = function () {\r\n    //                //  element.off('mousedown touchstart touchmove touchend touchcancel', absorbEvent_);\r\n    //                img.off('mousedown touchstart touchmove touchend touchcancel', absorbEvent_);\r\n    //                //  element.on('mousedown touchstart touchmove touchend touchcancel', absorbEvent_);\r\n    //                img.on('mousedown touchstart touchmove touchend touchcancel', absorbEvent_);\r\n    //            };\r\n    //            var onDragStart = function (evt, obj, elm) {\r\n    //                _allowClone = true;\r\n    //                if (angular.isDefined(obj.data.allowClone)) {\r\n    //                    _allowClone = obj.data.allowClone;\r\n    //                }\r\n    //                if (_allowClone) {\r\n    //                    scope.$apply(function () {\r\n    //                        scope.clonedData = obj.data;\r\n    //                    });\r\n    //                    element.css('width', obj.element[0].offsetWidth);\r\n    //                    element.css('height', obj.element[0].offsetHeight);\r\n//\r\n    //                    moveElement(obj.tx, obj.ty);\r\n    //                }\r\n//\r\n    //            };\r\n    //            var onDragMove = function (evt, obj) {\r\n    //                if (_allowClone) {\r\n//\r\n    //                    _tx = obj.tx + obj.dragOffset.left;\r\n    //                    _ty = obj.ty + obj.dragOffset.top;\r\n//\r\n    //                    moveElement(_tx, _ty);\r\n    //                }\r\n    //            };\r\n    //            var onDragEnd = function (evt, obj) {\r\n    //                //moveElement(obj.tx,obj.ty);\r\n    //                if (_allowClone) {\r\n    //                    reset();\r\n    //                }\r\n    //            };\r\n//\r\n    //            var reset = function () {\r\n    //                element.css({left: 0, top: 0, position: 'fixed', 'z-index': -1, visibility: 'hidden'});\r\n    //            };\r\n    //            var moveElement = function (x, y) {\r\n    //                element.css({\r\n    //                    transform: 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + x + ', ' + y + ', 0, 1)',\r\n    //                    'z-index': 99999,\r\n    //                    'visibility': 'visible',\r\n    //                    '-webkit-transform': 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + x + ', ' + y + ', 0, 1)',\r\n    //                    '-ms-transform': 'matrix(1, 0, 0, 1, ' + x + ', ' + y + ')'\r\n    //                    //,margin: '0'  don't monkey with the margin,\r\n    //                });\r\n    //            };\r\n//\r\n    //            var absorbEvent_ = function (event) {\r\n    //                var e = event;//.originalEvent;\r\n    //                e.preventDefault && e.preventDefault();\r\n    //                e.stopPropagation && e.stopPropagation();\r\n    //                e.cancelBubble = true;\r\n    //                e.returnValue = false;\r\n    //                return false;\r\n    //            };\r\n//\r\n    //            initialize();\r\n    //        }\r\n    //    };\r\n    //}]);\r\n\r\n    thisModule.directive('pipPreventDrag', ['$parse', '$timeout', function ($parse, $timeout) {\r\n        return {\r\n            restrict: 'A',\r\n            link: function (scope, element, attrs) {\r\n                var initialize = function () {\r\n\r\n                    element.attr('pip-draggable', 'false');\r\n                    toggleListeners(true);\r\n                };\r\n\r\n\r\n                var toggleListeners = function (enable) {\r\n                    // remove listeners\r\n\r\n                    if (!enable)return;\r\n                    // add listeners.\r\n                    element.on('mousedown touchstart touchmove touchend touchcancel', absorbEvent_);\r\n                };\r\n\r\n\r\n                var absorbEvent_ = function (event) {\r\n                    var e = event.originalEvent;\r\n                    e.preventDefault && e.preventDefault();\r\n                    e.stopPropagation && e.stopPropagation();\r\n                    e.cancelBubble = true;\r\n                    e.returnValue = false;\r\n                    return false;\r\n                };\r\n\r\n                initialize();\r\n            }\r\n        };\r\n    }]);\r\n\r\n    thisModule.directive('pipCancelDrag', function () {\r\n        return {\r\n            restrict: 'A',\r\n            link: function (scope, element, attrs) {\r\n                element.find('*').attr('pip-cancel-drag', 'pip-cancel-drag');\r\n            }\r\n        };\r\n    });\r\n})();\r\n\r\n","/**\r\n * @file Directive to show confirmation dialog when user tries to leave page with unsaved changes.\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function(){\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipFabTooltipVisibility\", []);\r\n\r\n    thisModule.directive(\"pipFabTooltipVisibility\", ['$parse', '$timeout', function ($parse, $timeout) {\r\n        return {\r\n            restrict: 'A',\r\n            scope: false,\r\n            controller: ['$scope', '$attrs', function($scope, $attrs) {\r\n                var trigGetter = $parse($attrs.pipFabTooltipVisibility),\r\n                    showGetter = $parse($attrs.pipFabShowTooltip),\r\n                    showSetter = showGetter.assign;\r\n\r\n                $scope.$watch(trigGetter, function(isOpen) {\r\n                    if (isOpen) {\r\n                        $timeout(function() {\r\n                            showSetter($scope, isOpen);\r\n                        }, 600);\r\n                    } else {\r\n                        showSetter($scope, isOpen);\r\n                    }\r\n                });\r\n            }]\r\n        };\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Keyboard navigation over few focusable controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipFocused\", []);\r\n\r\n    thisModule.directive('pipFocused', ['$timeout', '$mdConstant', function($timeout, $mdConstant) {\r\n        return {\r\n            require: \"?ngModel\",\r\n            link: function ($scope, $element, $attrs) {\r\n                var controls, controlsLength,\r\n                    withHidden = $attrs.pipWithHidden;\r\n\r\n                $timeout(init);\r\n                $element.on('keydown', keydownListener);\r\n\r\n                $scope.$watch($attrs.ngModel, function () {\r\n                    $timeout(init);\r\n                }, true);\r\n\r\n                function init() {\r\n                    var selector = withHidden ? '.pip-focusable' : '.pip-focusable:visible';\r\n                    controls = $element.find(selector);\r\n                    controlsLength = controls.length;\r\n\r\n                    // add needed event listeners\r\n                    controls.on('focus', function () {\r\n                        $element.addClass('pip-focused-container');\r\n                        $(this).addClass('md-focused');\r\n                    }).on('focusout', function () {\r\n                        $element.removeClass('pip-focused-container');\r\n                    });\r\n                }\r\n\r\n                function keydownListener(e) {\r\n                    var keyCode = e.which || e.keyCode;\r\n\r\n                    // Check control keyCode\r\n                    if (keyCode == $mdConstant.KEY_CODE.LEFT_ARROW ||\r\n                        keyCode == $mdConstant.KEY_CODE.UP_ARROW ||\r\n                        keyCode == $mdConstant.KEY_CODE.RIGHT_ARROW ||\r\n                        keyCode == $mdConstant.KEY_CODE.DOWN_ARROW) {\r\n\r\n                        e.preventDefault();\r\n\r\n                        var \r\n                            increment = (keyCode == $mdConstant.KEY_CODE.RIGHT_ARROW || keyCode == $mdConstant.KEY_CODE.DOWN_ARROW) ? 1 : -1,\r\n                            moveToControl = controls.index(controls.filter(\".md-focused\")) + increment;\r\n\r\n                        // Move focus to next control\r\n                        if (moveToControl >= 0 && moveToControl < controlsLength) {\r\n                            controls[moveToControl].focus();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }]);\r\n\r\n})();\r\n\r\n","/**\r\n * @file Infinite scrolling behavior\r\n * @description\r\n * Modified from https://github.com/sroze/ngInfiniteScroll\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipInfiniteScroll\", []);\r\n\r\n    thisModule.directive('pipInfiniteScroll', \r\n        ['$rootScope', '$window', '$interval', '$parse', function($rootScope, $window, $interval, $parse) {\r\n            var THROTTLE_MILLISECONDS = 500;\r\n\r\n            return {\r\n                scope: {\r\n                    pipInfiniteScroll: '&',\r\n                    pipScrollContainer: '=',\r\n                    pipScrollDistance: '=',\r\n                    pipScrollDisabled: '=',\r\n                    pipScrollUseDocumentBottom: '=',\r\n                    pipScrollListenForEvent: '@'\r\n                },\r\n                link: function($scope, $element, $attrs) {\r\n                    var \r\n                        checkWhenEnabled = null,\r\n                        scrollContainer,\r\n                        immediateCheck = true,\r\n                        scrollDistance = null,\r\n                        scrollEnabled = null, \r\n                        unregisterEventListener = null,\r\n                        useDocumentBottom = false, \r\n                        windowElement = angular.element($window);\r\n                    \r\n                    function height(element) {\r\n                        element = element[0] || element;\r\n                        if (isNaN(element.offsetHeight)) {\r\n                            return element.document.documentElement.clientHeight;\r\n                        } else {\r\n                            return element.offsetHeight;\r\n                        }\r\n                    };\r\n\r\n                    function offsetTop(element) {\r\n                        if (!element[0].getBoundingClientRect || element.css('none')) {\r\n                            return;\r\n                        }\r\n                        return element[0].getBoundingClientRect().top + pageYOffset(element);\r\n                    };\r\n\r\n                    function pageYOffset(element) {\r\n                        element = element[0] || element;\r\n                        if (isNaN(window.pageYOffset)) {\r\n                            return element.document.documentElement.scrollTop;\r\n                        } else {\r\n                            return element.ownerDocument.defaultView.pageYOffset;\r\n                        }\r\n                    };\r\n\r\n                    var onContainerScroll = function() {\r\n                        var \r\n                            containerBottom, \r\n                            containerTopOffset, \r\n                            elementBottom, \r\n                            remaining, \r\n                            shouldScroll;\r\n                                                \r\n                        if (scrollContainer === windowElement) {\r\n                            containerBottom = height(scrollContainer) + pageYOffset(scrollContainer[0].document.documentElement);\r\n                            elementBottom = offsetTop($element) + height($element);\r\n                        } else {\r\n                            containerBottom = height(scrollContainer);\r\n                            containerTopOffset = 0;\r\n                            if (offsetTop(scrollContainer) !== void 0) {\r\n                                containerTopOffset = offsetTop(scrollContainer);\r\n                            }\r\n                            elementBottom = offsetTop($element) - containerTopOffset + height($element);\r\n                        }\r\n\r\n                        if (useDocumentBottom) {\r\n                            elementBottom = height(($element[0].ownerDocument || $element[0].document).documentElement);\r\n                        }\r\n\r\n                        remaining = elementBottom - containerBottom;\r\n                        shouldScroll = remaining <= height(scrollContainer) * scrollDistance + 1;\r\n                        \r\n                        if (shouldScroll) {\r\n                            checkWhenEnabled = true;\r\n                            if (scrollEnabled) {\r\n                                if ($scope.$$phase || $rootScope.$$phase) {\r\n                                    return $scope.pipInfiniteScroll();\r\n                                } else {\r\n                                    return $scope.$apply($scope.pipInfiniteScroll);\r\n                                }\r\n                            }\r\n                        } else {\r\n                            return checkWhenEnabled = false;\r\n                        }\r\n                    };\r\n\r\n                    if (THROTTLE_MILLISECONDS != null) {\r\n                        onContainerScroll = _.throttle(onContainerScroll, THROTTLE_MILLISECONDS);                    \r\n                    }\r\n\r\n                    $scope.$on('$destroy', function() {\r\n                        scrollContainer.unbind('scroll', onContainerScroll);\r\n                        if (unregisterEventListener != null) {\r\n                            unregisterEventListener();\r\n                            return unregisterEventListener = null;\r\n                        }\r\n                    });\r\n\r\n                    function handleScrollDistance(v) {\r\n                        return scrollDistance = parseFloat(v) || 0;\r\n                    };\r\n                    $scope.$watch('pipScrollDistance', handleScrollDistance);\r\n                    handleScrollDistance($scope.pipScrollDistance);\r\n                    \r\n                    function handleScrollDisabled(v) {\r\n                        scrollEnabled = !v;\r\n                        if (scrollEnabled && checkWhenEnabled) {\r\n                            checkWhenEnabled = false;\r\n                            return onContainerScroll();\r\n                        }\r\n                    };\r\n                    $scope.$watch('pipScrollDisabled', handleScrollDisabled);\r\n                    handleScrollDisabled($scope.pipScrollDisabled);\r\n\r\n                    function handleScrollUseDocumentBottom(v) {\r\n                        return useDocumentBottom = v;\r\n                    };\r\n                    $scope.$watch('pipScrollUseDocumentBottom', handleScrollUseDocumentBottom);\r\n                    handleScrollUseDocumentBottom($scope.pipScrollUseDocumentBottom);\r\n\r\n                    function changeContainer(newContainer) {\r\n                        if (scrollContainer != null) {\r\n                            scrollContainer.unbind('scroll', onContainerScroll);\r\n                        }\r\n\r\n                        scrollContainer = newContainer;\r\n                        if (newContainer != null) {\r\n                            return scrollContainer.bind('scroll', onContainerScroll);\r\n                        }\r\n                    };\r\n\r\n                    changeContainer(windowElement);\r\n                    if ($scope.pipScrollListenForEvent) {\r\n                        unregisterEventListener = $rootScope.$on($scope.pipScrollListenForEvent, onContainerScroll);\r\n                    }\r\n\r\n                    function handleScrollContainer(newContainer) {\r\n                        if ((newContainer == null) || newContainer.length === 0) {\r\n                            return;\r\n                        }\r\n                        if (newContainer instanceof HTMLElement) {\r\n                            newContainer = angular.element(newContainer);\r\n                        } else if (typeof newContainer.append === 'function') {\r\n                            newContainer = angular.element(newContainer[newContainer.length - 1]);\r\n                        } else if (typeof newContainer === 'string') {\r\n                            newContainer = $element.parents().find(newContainer);\r\n                        }\r\n\r\n                        if (newContainer != null && (!Array.isArray(newContainer) ||\r\n                            (Array.isArray(newContainer) && newContainer.length > 0))) {\r\n                            return changeContainer(newContainer);\r\n                        } else {\r\n                            throw new Error(\"Invalid pip-scroll-container attribute.\");\r\n                        }\r\n                    };\r\n                    $scope.$watch('pipScrollContainer', function (newContainer) {\r\n                        if (newContainer !== scrollContainer)\r\n                            handleScrollContainer(newContainer);\r\n                    });\r\n                    handleScrollContainer($scope.pipScrollContainer || []);\r\n                    \r\n                    if ($attrs.pipScrollParent != null) {\r\n                        changeContainer(angular.element($element.parent()));\r\n                    }\r\n                    if ($attrs.pipScrolImmediateCheck != null) {\r\n                        immediateCheck = $scope.$eval($attrs.pipScrolImmediateCheck);\r\n                    }\r\n                    \r\n                    return $interval((function() {\r\n                        if (immediateCheck) {\r\n                            return onContainerScroll();\r\n                        }\r\n                    }), 0, 1);\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Keyboard navigation with scrolling over non-focusable controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipSelected\", ['pipUtils']);\r\n\r\n    thisModule.directive('pipSelected',['$parse', 'pipUtils', '$mdConstant', '$timeout', function ($parse, pipUtils, $mdConstant, $timeout) {\r\n        return {\r\n            restrict: 'A',\r\n            scope: false,\r\n            link: function ($scope, $element, $attrs) {\r\n                var\r\n                    indexGetter = $attrs.pipSelected ? $parse($attrs.pipSelected) : null,\r\n                    indexSetter = indexGetter ? indexGetter.assign : null,\r\n                    idGetter = $attrs.pipSelectedId ? $parse($attrs.pipSelectedId) : null,\r\n                    idSetter = idGetter ? idGetter.assign : null,\r\n                    changeGetter = $attrs.pipSelect ? $parse($attrs.pipSelect) : null,\r\n                    enterSpaceGetter = $attrs.pipEnterSpacePress ? $parse($attrs.pipEnterSpacePress) : null,\r\n                    noScroll = pipUtils.toBoolean($attrs.pipNoScroll),\r\n                    modifier = pipUtils.toBoolean($attrs.pipSkipHidden) ? ':visible' : '',\r\n                    className = pipUtils.toBoolean($attrs.pipTreeList) ? '.pip-selectable-tree' : '.pip-selectable',\r\n                    selectedIndex = indexGetter($scope),\r\n                    currentElementTabinex = $element.attr('tabindex'),\r\n                    pipSelectedWatch = $attrs.pipSelectedWatch;\r\n\r\n                // Set tabindex if it's not set yet\r\n                $element.attr('tabindex', currentElementTabinex || 0);\r\n\r\n                // Watch selected item index\r\n                if (!pipUtils.toBoolean($attrs.pipTreeList)) {\r\n                    $scope.$watch(indexGetter, function(newSelectedIndex) {\r\n                        selectItem({itemIndex: newSelectedIndex});\r\n                    });\r\n                } else {\r\n                    $scope.$watch(idGetter, function(newSelectedId) {\r\n                        setTimeout(function () {\r\n                            selectItem({itemId: newSelectedId, raiseEvent: true});\r\n                        }, 0);\r\n                    });\r\n                }\r\n\r\n                // Watch resync selection\r\n                if (pipSelectedWatch) {\r\n                    $scope.$watch(pipSelectedWatch, function() {\r\n                        // Delay update to allow ng-repeat to update DOM\r\n                        setTimeout(function() {\r\n                            selectedIndex = indexGetter($scope);\r\n                            selectItem({itemIndex: selectedIndex});\r\n                        }, 100);\r\n                    });\r\n                }\r\n\r\n                // Select item defined by index\r\n                selectItem({itemIndex: selectedIndex, items: $element.find(className)});\r\n\r\n                // Functions and listeners\r\n\r\n                function selectItem(itemParams) {\r\n                    var itemIndex = itemParams.itemIndex,\r\n                        itemId = itemParams.itemId,\r\n                        items = itemParams.items || $element.find(className + modifier),\r\n                        itemsLength = items.length,\r\n                        item = (function () {\r\n                            if (itemParams.item) return itemParams.item;\r\n                            if (itemIndex === undefined && itemIndex === -1) {\r\n                                itemIndex = items.index(items.filter('[pip-id=' + itemId + ']'));\r\n                            }\r\n                            if (itemIndex >= 0 && itemIndex < itemsLength) {\r\n                                return items[itemIndex]\r\n                            }\r\n                        }()),\r\n                        raiseEvent = itemParams.raiseEvent;\r\n\r\n                    if (item) {\r\n                        $element.find(className).removeClass('selected md-focused');\r\n                        item = angular.element(item)\r\n                            .addClass('selected md-focused')\r\n                            .focus();\r\n                        if (!noScroll) scrollToItem(item);\r\n                        if (raiseEvent) defineSelectedIndex(items);\r\n                    }\r\n                };\r\n\r\n                function defineSelectedIndex(items) {\r\n                    var oldSelectedIndex = selectedIndex;\r\n                    selectedIndex = -1;\r\n                    for (var index = 0; index < items.length; index++) {\r\n                        if ($(items[index]).hasClass('selected')) {\r\n                            selectedIndex = index;\r\n\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    // Execute callback to notify about item select\r\n                    if (oldSelectedIndex != selectedIndex && selectedIndex !== -1) {\r\n                        $scope.$apply(updateIndex);\r\n                    }\r\n\r\n                    function updateIndex() {\r\n                        var selectedItem = angular.element(items[selectedIndex]),\r\n                            selectedId = selectedItem.attr('pip-id');\r\n\r\n                        if (indexSetter) indexSetter($scope, selectedIndex);\r\n                        if (idSetter) idSetter($scope, selectedId);\r\n                        if (changeGetter) {\r\n                            changeGetter($scope, {\r\n                                $event: {\r\n                                    target: $element,\r\n                                    item: selectedItem,\r\n                                    index: selectedIndex,\r\n                                    id: selectedId,\r\n                                    newIndex: selectedIndex,\r\n                                    oldIndex: oldSelectedIndex\r\n                                }\r\n                            });\r\n                        }\r\n                    };\r\n                };\r\n\r\n                function scrollToItem($item) {\r\n                    if (noScroll) return;\r\n\r\n                    var\r\n                        containerTop = $element.offset().top,\r\n                        containerHeight = $element.height(),\r\n                        containerBottom = containerTop + containerHeight,\r\n                        itemTop = $item.offset().top,\r\n                        itemHeight = $item.outerHeight(true),\r\n                        itemBottom = itemTop + itemHeight,\r\n                        containerScrollTop = $element.scrollTop();\r\n\r\n                    if (containerTop > itemTop) {\r\n                        $element.scrollTop(containerScrollTop + itemTop - containerTop);\r\n                    }\r\n                    else if (containerBottom < itemBottom) {\r\n                        $element.scrollTop(containerScrollTop + itemBottom - containerBottom);\r\n                    }\r\n\r\n                };\r\n\r\n                $element.on('click touchstart', className, function (event) {\r\n                    selectItem({item: event.currentTarget, raiseEvent: true});\r\n                });\r\n\r\n                $element.on('keydown', function (e) {\r\n                    var keyCode = e.which || e.keyCode;\r\n\r\n                    // Check control keyCode\r\n                    if (keyCode == $mdConstant.KEY_CODE.ENTER || keyCode == $mdConstant.KEY_CODE.SPACE) {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n\r\n                        if (enterSpaceGetter) {\r\n                            enterSpaceGetter($scope, {\r\n                                $event: {\r\n                                    target: $element,\r\n                                    index: selectedIndex,\r\n                                    item: $element.find('.selected')\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                    } else\r\n                    if (keyCode == $mdConstant.KEY_CODE.LEFT_ARROW || keyCode == $mdConstant.KEY_CODE.RIGHT_ARROW ||\r\n                        keyCode == $mdConstant.KEY_CODE.UP_ARROW || keyCode == $mdConstant.KEY_CODE.DOWN_ARROW) {\r\n\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n\r\n                        // Get next selectable control index\r\n                        var items = $element.find(className + modifier),\r\n                            inc = (keyCode == $mdConstant.KEY_CODE.RIGHT_ARROW || keyCode == $mdConstant.KEY_CODE.DOWN_ARROW) ? 1 : -1,\r\n                            newSelectedIndex = selectedIndex + inc;\r\n\r\n                        // Set next control as selected\r\n                        selectItem({itemIndex: newSelectedIndex, items: items, raiseEvent: true});\r\n                    }\r\n                });\r\n\r\n                $element.on('focusin', function (event) {\r\n                    // Choose selected element\r\n                    var items,\r\n                        selectedItem = $element.find(className + '.selected');\r\n\r\n                    selectedItem.addClass('md-focused');\r\n\r\n                    // If there are not selected elements then pick the first one\r\n                    if (selectedItem.length === 0) {\r\n                        selectedIndex = indexGetter($scope);\r\n                        items = $element.find(className + modifier);\r\n                        selectItem({itemIndex: selectedIndex || 0, items: items, raiseEvent: true});\r\n                    }\r\n                });\r\n\r\n                $element.on('focusout', function (event) {\r\n                    $element.find(className + '.md-focused' + modifier).removeClass('md-focused');\r\n                });\r\n            }\r\n        };\r\n    }]);\r\n\r\n})();\r\n\r\n","/**\r\n * @file Directive to show confirmation dialog when user tries to leave page with unsaved changes.\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function(){\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipUnsavedChanges\", []);\r\n\r\n    thisModule.directive(\"pipUnsavedChanges\", ['$window', '$rootScope', function ($window, $rootScope) {\r\n        return {\r\n            restrict: 'AE',\r\n            scope: {\r\n                unsavedChangesAvailable: '&pipUnsavedChangesAvailable',\r\n                unsavedChangesMessage: '@pipUnsavedChangesMessage',\r\n                afterLeave: '&pipUnsavedChangesAfterLeave'\r\n            },\r\n            link: function($scope) {\r\n\r\n                $window.onbeforeunload = function() {\r\n                    if ($scope.unsavedChangesAvailable()) {\r\n                        $rootScope.$routing = false;\r\n                        return $scope.unsavedChangesMessage;\r\n                    }\r\n                };\r\n\r\n                var unbindFunc = $scope.$on('$stateChangeStart', function(event) {\r\n                    if ($scope.unsavedChangesAvailable() && !$window.confirm($scope.unsavedChangesMessage)) {\r\n                        $rootScope.$routing = false;\r\n                        event.preventDefault();\r\n                    } else {\r\n                        _.isFunction($scope.afterLeave) && $scope.afterLeave();\r\n                    }\r\n                });\r\n\r\n                $scope.$on('$destroy', function() {\r\n                    $window.onbeforeunload = null;\r\n                    unbindFunc();\r\n                });\r\n            }\r\n        };\r\n    }]);\r\n\r\n})();","/**\r\n * @file Filter to format date and time\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipDateTimeFilters', ['pipDateFormat']);\r\n\r\n    thisModule.filter('formatDate',  \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value, format) {\r\n                return pipDateFormat.formatDate(value, format);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatLongDate', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatLongDate(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatLongDateWithYear',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatLongDateWithYear(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatMonth',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value, format) {\r\n                return pipDateFormat.formatMonth(value, format);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatShortDate', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatShortDate(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatShortDateWithYear',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatShortDateWithYear(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatLongMonth',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatLongMonth(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatYear',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatYear(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatShortWeek',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatShortWeek(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value, format) {\r\n                return pipDateFormat.formatTime(value, format);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatLongTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatLongTime(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatShortTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatShortTime(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatLongDateTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatLongDateTime(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatShortDateTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatShortDateTime(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatElapsedInterval', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatElapsedInterval(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatElapsedTime', \r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatElapsedTime(value);  \r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatMillisecondsToSeconds',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value) {\r\n                return pipDateFormat.formatMillisecondsToSeconds(value);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatDateRange',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value1, value2) {\r\n                return pipDateFormat.formatDateRange(value1, value2);\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.filter('formatDateTimeRange',\r\n        ['pipDateFormat', function (pipDateFormat) {\r\n            return function(value1, value2) {\r\n                return pipDateFormat.formatDateTimeRange(value1, value2);\r\n            };\r\n        }]\r\n    );\r\n\r\n\r\n})();\r\n","/**\r\n * @file Filter to translate string resources\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTranslateFilters', ['pipTranslate']);\r\n\r\n    thisModule.filter('translate', ['pipTranslate', function (pipTranslate) {\r\n        return function (key) {\r\n            return pipTranslate.translate(key) || key;\r\n        }\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Date formatting service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global _, angular */\r\n \r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipDateFormat', ['pipUtils', 'pipTranslate']);\r\n\r\n\tthisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n\r\n        pipTranslateProvider.translations('en', {\r\n            // Months - 'MONTH_' + monthIndex\r\n            // start at 0 to match JS date format\r\n            'MONTH_1': 'January',\r\n            'MONTH_2': 'February',\r\n            'MONTH_3': 'March',\r\n            'MONTH_4': 'April',\r\n            'MONTH_5': 'May',\r\n            'MONTH_6': 'June',\r\n            'MONTH_7': 'July',\r\n            'MONTH_8': 'August',\r\n            'MONTH_9': 'September',\r\n            'MONTH_10': 'October',\r\n            'MONTH_11': 'November',\r\n            'MONTH_12': 'December',\r\n\r\n            'MONTH_LONG_1': 'January',\r\n            'MONTH_LONG_2': 'February',\r\n            'MONTH_LONG_3': 'March',\r\n            'MONTH_LONG_4': 'April',\r\n            'MONTH_LONG_5': 'May',\r\n            'MONTH_LONG_6': 'June',\r\n            'MONTH_LONG_7': 'July',\r\n            'MONTH_LONG_8': 'August',\r\n            'MONTH_LONG_9': 'September',\r\n            'MONTH_LONG_10': 'October',\r\n            'MONTH_LONG_11': 'November',\r\n            'MONTH_LONG_12': 'December',\r\n\r\n            'MONTH_SHORT_1': 'Jan',\r\n            'MONTH_SHORT_2': 'Feb',\r\n            'MONTH_SHORT_3': 'Mar',\r\n            'MONTH_SHORT_4': 'Apr',\r\n            'MONTH_SHORT_5': 'May',\r\n            'MONTH_SHORT_6': 'Jun',\r\n            'MONTH_SHORT_7': 'Jul',\r\n            'MONTH_SHORT_8': 'Aug',\r\n            'MONTH_SHORT_9': 'Sep',\r\n            'MONTH_SHORT_10': 'Oct',\r\n            'MONTH_SHORT_11': 'Nov',\r\n            'MONTH_SHORT_12': 'Dec',\r\n\r\n            // Days of the week - 'DAY_' + dayIndex\r\n            // start at 1 to match JS date format\r\n            'DAY_1': 'Monday',\r\n            'DAY_2': 'Tuesday',\r\n            'DAY_3': 'Wednesday',\r\n            'DAY_4': 'Thursday',\r\n            'DAY_5': 'Friday',\r\n            'DAY_6': 'Saturday',\r\n            'DAY_7': 'Sunday',\r\n\r\n            'ELAPSED_TODAY': 'Today',\r\n            'ELAPSED_YESTERDAY': 'Yesterday',\r\n            'ELAPSED_YEARS': 'y',\r\n            'ELAPSED_MONTHS': 'mth',\r\n            'ELAPSED_WEEKS': 'w',\r\n            'ELAPSED_DAYS': 'd',\r\n            'ELAPSED_HOURS': 'h',\r\n            'ELAPSED_MINUTES': 'm',\r\n            'ELAPSED_SECONDS': 's',\r\n            'ELAPSED_AT': 'at',\r\n            'ELAPSED_AGO': 'ago',\r\n            'ELAPSED_JUST_NOW': 'Just now',\r\n            'ELAPSED_FEW_MIN_AGO': 'Few min ago',\r\n            'ELAPSED_MIN_AGO': 'min ago',\r\n            'ELAPSED_HOUR_AGO': 'hour ago',\r\n            'ELAPSED_HOURS_AGO': 'hours ago',\r\n            'ELAPSED_HOURS_AGO_MORE_THAN_FIVE': 'hours ago'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            // Months - 'MONTH_' + monthIndex\r\n            // start at 0 to match JS date format\r\n            'MONTH_1': 'январь',\r\n            'MONTH_2': 'февраль',\r\n            'MONTH_3': 'март',\r\n            'MONTH_4': 'апрель',\r\n            'MONTH_5': 'май',\r\n            'MONTH_6': 'июнь',\r\n            'MONTH_7': 'июль',\r\n            'MONTH_8': 'август',\r\n            'MONTH_9': 'сентябрь',\r\n            'MONTH_10': 'октябрь',\r\n            'MONTH_11': 'ноябрь',\r\n            'MONTH_12': 'декабрь',\r\n\r\n            'MONTH_LONG_1': 'января',\r\n            'MONTH_LONG_2': 'февраля',\r\n            'MONTH_LONG_3': 'марта',\r\n            'MONTH_LONG_4': 'апреля',\r\n            'MONTH_LONG_5': 'мая',\r\n            'MONTH_LONG_6': 'июня',\r\n            'MONTH_LONG_7': 'июля',\r\n            'MONTH_LONG_8': 'августа',\r\n            'MONTH_LONG_9': 'сентября',\r\n            'MONTH_LONG_10': 'октября',\r\n            'MONTH_LONG_11': 'ноября',\r\n            'MONTH_LONG_12': 'декабря',\r\n\r\n            'MONTH_SHORT_1': 'янв',\r\n            'MONTH_SHORT_2': 'фев',\r\n            'MONTH_SHORT_3': 'мар',\r\n            'MONTH_SHORT_4': 'апр',\r\n            'MONTH_SHORT_5': 'май',\r\n            'MONTH_SHORT_6': 'июн',\r\n            'MONTH_SHORT_7': 'июл',\r\n            'MONTH_SHORT_8': 'авг',\r\n            'MONTH_SHORT_9': 'сен',\r\n            'MONTH_SHORT_10': 'окт',\r\n            'MONTH_SHORT_11': 'ноя',\r\n            'MONTH_SHORT_12': 'дек',\r\n\r\n            // Days of the week - 'DAY_' + dayIndex\r\n            // start at 1 to match JS date format\r\n            'DAY_1': 'понедельник',\r\n            'DAY_2': 'вторник',\r\n            'DAY_3': 'среда',\r\n            'DAY_4': 'четверг',\r\n            'DAY_5': 'пятница',\r\n            'DAY_6': 'суббота',\r\n            'DAY_7': 'воскресенье',\r\n\r\n            'ELAPSED_TODAY': 'Сегодня',\r\n            'ELAPSED_YESTERDAY': 'Вчера',\r\n            'ELAPSED_YEARS': 'г',\r\n            'ELAPSED_MONTHS': 'мц',\r\n            'ELAPSED_WEEKS': 'н',\r\n            'ELAPSED_DAYS': 'д',\r\n            'ELAPSED_HOURS': 'ч',\r\n            'ELAPSED_MINUTES': 'м',\r\n            'ELAPSED_SECONDS': 'с',\r\n            'ELAPSED_AT': 'в',\r\n            'ELAPSED_AGO': 'тн',\r\n            'ELAPSED_JUST_NOW': 'Только что',\r\n            'ELAPSED_FEW_MIN_AGO': 'Несколько мин тн',\r\n            'ELAPSED_MIN_AGO': 'мин тн',\r\n            'ELAPSED_HOUR_AGO': 'час тн',\r\n            'ELAPSED_HOURS_AGO': 'часа тн',\r\n            'ELAPSED_HOURS_AGO_MORE_THAN_FIVE': 'часов тн'\r\n        });\r\n\t\t\r\n\t}]);\r\n\r\n    thisModule.factory('pipDateFormat',\r\n        ['pipDates', 'pipTranslate', '$rootScope', function (pipDates, pipTranslate, $rootScope) {\r\n\r\n            return {\r\n                formatDate: formatDate,\r\n                formatLongDate: formatLongDate,\r\n                formatShortDate: formatShortDate,\r\n                formatShortDateWithYear: formatShortDateWithYear,\r\n                formatLongDateWithYear: formatLongDateWithYear,\r\n\r\n                formatLongMonth: formatLongMonth,\r\n                formatMonth: formatMonth,\r\n                formatYear: formatYear,\r\n                formatShortWeek: formatShortWeek,\r\n                formatShortDayAndMonth: formatShortDayAndMonth,\r\n                formatLongDayAndMonth: formatLongDayAndMonth,\r\n\r\n                formatDateRange: formatDateRange,\r\n                formatDateTimeRange: formatDateTimeRange,\r\n\r\n                formatTime: formatTime,\r\n                formatLongTime: formatLongTime,\r\n                formatShortTime: formatShortTime, \r\n\r\n                formatLongDateTime: formatLongDateTime,\r\n                formatShortDateTime: formatShortDateTime,\r\n\r\n                formatElapsedTime: formatElapsedTime,\r\n                formatElapsedInterval: formatElapsedInterval,\r\n\r\n                formatMillisecondsToSeconds: formatMillisecondsToSeconds\r\n            };\r\n\r\n\r\n            function twoDigits(value) {\r\n                return value < 10 ? '0' + value : value; \r\n            };\r\n\r\n            function formatDate(value, format, str) {\r\n                if (value == null) return '';\r\n\r\n                var\r\n                    strict = str || false,\r\n                    value = _.isDate(value) ? value : new Date(value),\r\n                    thisYear = new Date().getUTCFullYear(),\r\n                    year = value.getUTCFullYear(),\r\n                    month = value.getUTCMonth(),\r\n                    longMonthName = pipTranslate.translate('MONTH_LONG_' + (month + 1)),\r\n                    shortMonthName = pipTranslate.translate('MONTH_SHORT_' + (month + 1)),\r\n                    monthName = pipTranslate.translate('MONTH_' + (month + 1)),\r\n                    day = value.getUTCDate(),\r\n                    startWeek = pipDates.toStartWeek(value),\r\n                    endWeek = pipDates.toEndWeek(value, -1);\r\n\r\n                if (strict == false && format == 'd MMMM yyyy' && thisYear === year) {\r\n                        format = 'MMMM d';\r\n                }\r\n                if (strict == false && format == 'd MMM yyyy' && thisYear === year) {\r\n                        format = 'MMM d';\r\n                }\r\n                if ((format == 'MMM d') && $rootScope.$language == 'ru') {\r\n                        format = 'd MMM';\r\n                }\r\n                if ((format == 'MMMM d') && $rootScope.$language == 'ru') {\r\n                    format = 'd MMMM';\r\n                }\r\n\r\n                if (format == 'd MMMM yyyy')\r\n                    return '' + day + ' ' + longMonthName + ' ' + year\r\n                else if (format == 'MMMM d, yyyy')\r\n                    return '' + monthName + ' ' + day + ', ' + year\r\n                if (format == 'd MMM yyyy')\r\n                    return '' + day + ' ' + shortMonthName + ' ' + year\r\n                else if (format == 'MMM d, yyyy')\r\n                    return '' + shortMonthName + ' ' + day + ', ' + year\r\n                else if (format == 'd MMMM')\r\n                    return '' + day + ' ' + longMonthName\r\n                else if (format == 'd MMM')\r\n                    return '' + day + ' ' + shortMonthName\r\n                else if (format == 'MMM d')\r\n                    return '' + shortMonthName + ' ' + day;\r\n                else if (format == 'MMMM d')\r\n                    return '' + longMonthName + ' ' + day;\r\n                else if (format == 'yyyy/M/d')\r\n                    return '' + year + '/' + month + '/' + day;\r\n                else if (format == 'yyy-M-d')\r\n                    return '' + year + '-' + month + '-' + day;\r\n                else if (format == 'MMMM')\r\n                    return '' + longMonthName + ' ' + year;\r\n                else if (format == 'yyyy')\r\n                    return '' + year;\r\n                else if (format == 'ww')\r\n                    return '' + startWeek.getUTCDate() + ' - ' + endWeek.getUTCDate() + ' ' + monthName + ' ' + year;\r\n\r\n                return '' + day + ' ' + monthName + ' ' + year\r\n            }\r\n\r\n            function formatLongDate(value) {\r\n                return formatDate(value, 'd MMMM yyyy');\r\n            }\r\n\r\n            function formatShortDateWithYear(value) {\r\n                return formatDate(value, 'd MMM yyyy', true);\r\n            }\r\n\r\n            function formatLongDateWithYear(value) {\r\n                return formatDate(value, 'd MMMM yyyy', true);\r\n            }\r\n\r\n            function formatShortDate(value) {\r\n                return formatDate(value, 'd MMM yyyy');\r\n            }\r\n\r\n            function formatLongMonth(value) {\r\n                return formatDate(value, 'MMMM');\r\n            }\r\n\r\n            function formatYear(value) {\r\n                return formatDate(value, 'yyyy');\r\n            }\r\n\r\n            function formatShortWeek(value) {\r\n                return formatDate(value, 'ww');\r\n            }\r\n\r\n            function formatShortDayAndMonth(value) {\r\n                return formatDate(value, 'd MMM');\r\n            }\r\n\r\n            function formatLongDayAndMonth(value) {\r\n                if ($rootScope.$language == 'ru')\r\n                    return formatDate(value, 'd MMMM');\r\n                else\r\n                    return formatDate(value, 'MMMM d');\r\n            }\r\n\r\n            function formatDateRange(value1, value2) {\r\n                value1 =  value1 ? (_.isDate(value1) ? value1 : new Date(value1)) : null;\r\n                value2 =  value2 ? (_.isDate(value2) ? value2 : new Date(value2)) : null;\r\n\r\n                if (value1 == null) {\r\n                    if ($rootScope.$language == 'ru')\r\n                        return formatDate(value2, 'd MMM yyyy', true);\r\n                    else\r\n                        return formatDate(value2, 'MMM d, yyyy', true);\r\n                }\r\n\r\n                if (value2 == null || value1 == value2) {\r\n                    if ($rootScope.$language == 'ru')\r\n                        return formatDate(value1, 'd MMM yyyy', true);\r\n                    else\r\n                        return formatDate(value1, 'MMM d, yyyy', true);\r\n                }\r\n\r\n                if (value1.getUTCFullYear() !== value2.getUTCFullYear()) {\r\n                    if ($rootScope.$language == 'ru')\r\n                        return formatDate(value1, 'd MMM yyyy', true) + '-' + formatDate(value2, 'd MMM yyyy', true);\r\n                    else\r\n                        return formatDate(value1, 'MMM d, yyyy', true) + '-' + formatDate(value2, 'MMM d, yyyy', true);\r\n                } else {\r\n                        return formatDate(value1, 'd MMM') + ' - ' + formatDate(value2, 'd MMM')\r\n                            + ((new Date().getUTCFullYear() !== value1.getUTCFullYear()) ? ' ' + formatDate(value1, 'yyyy') : '');\r\n                }\r\n            }\r\n\r\n            function formatDateTimeRange(value1, value2) {\r\n                value1 =  value1 ? (_.isDate(value1) ? value1 : new Date(value1)) : null;\r\n                value2 =  value2 ? (_.isDate(value2) ? value2 : new Date(value2)) : null;\r\n                if (value1 == null && value2 == null) return '';\r\n\r\n                if (value1 == null) {\r\n                    return formatShortDateTime(value2);\r\n                }\r\n\r\n                if (value2 == null || value1 == value2) {\r\n                    return formatShortDateTime(value1);\r\n                }\r\n\r\n                var dayStart, monthStart, yearStart,\r\n                    dayEnd, monthEnd, yearEnd;\r\n\r\n                dayStart = value1.getUTCDate();\r\n                monthStart = value1.getUTCMonth();\r\n                yearStart = value1.getUTCFullYear();\r\n                dayEnd = value2.getUTCDate();\r\n                monthEnd = value2.getUTCMonth();\r\n                yearEnd = value2.getUTCFullYear();\r\n\r\n\r\n                if (yearStart !== yearEnd) {\r\n                    return formatDate(value1, 'd MMM') + ', ' + yearStart + ' ' + formatTime(value1, 'hh:mm') +\r\n                        ' - ' + formatDate(value2, 'd MMM') + ', ' + yearEnd + ' ' + formatTime(value2, 'hh:mm');\r\n                } else {\r\n                    if (monthStart != monthEnd && !dayStart != dayEnd)\r\n                        return formatDate(value1, 'd MMM') + ', ' + formatTime(value1, 'hh:mm') +\r\n                            ' - ' + formatDate(value2, 'd MMM') + ', ' + formatTime(value2, 'hh:mm');\r\n                    else\r\n                        return formatTime(value1, 'hh:mm') + ' - ' + formatTime(value2, 'hh:mm')\r\n                }\r\n            }\r\n\r\n            function formatTime(value, format) {\r\n                if (value == null) return '';\r\n\r\n                value = _.isDate(value) ? value : new Date(value);\r\n                \r\n                var \r\n                    hours = value.getHours(),\r\n                    mins = value.getMinutes(),\r\n                    secs = value.getSeconds(),\r\n                    ampm = '';\r\n\r\n                if (pipTranslate.use() == 'en') {\r\n                    ampm = hours >= 12 ? ' PM' : ' AM';\r\n                    hours = hours % 12;\r\n                    if (hours == 0) hours = 12;\r\n                }\r\n\r\n                if (format == 'hh:mm:ss')\r\n                    return '' + twoDigits(hours) + ':' + twoDigits(mins) + ':' + twoDigits(secs) + ampm;\r\n                else if (format == 'hh:mm')\r\n                    return '' + twoDigits(hours) + ':' + twoDigits(mins) + ampm;\r\n\r\n                return '' + twoDigits(hours) + ':' + twoDigits(mins) + ':' + twoDigits(secs) + ampm;\r\n            }\r\n\r\n            function formatMonth(value, short) {\r\n                if (value == null) return '';\r\n                return short ? pipTranslate.translate('MONTH_SHORT_' + value) : pipTranslate.translate('MONTH_' + value);\r\n            }\r\n\r\n            function formatLongTime(value) {\r\n                return formatTime(value, 'hh:mm:ss');\r\n            }\r\n\r\n            function formatShortTime(value) {\r\n                return formatTime(value, 'hh:mm');\r\n            }\r\n\r\n            function formatLongDateTime(value) {\r\n                if (value == null) return '';\r\n                value = _.isDate(value) ? value : new Date(value);\r\n                return formatLongDate(value) + ' ' + formatLongTime(value);\r\n            }\r\n\r\n            function formatShortDateTime(value) {\r\n                if (value == null) return '';\r\n                value = _.isDate(value) ? value : new Date(value);\r\n                return formatShortDate(value) + ' ' + formatShortTime(value);\r\n            }\r\n\r\n            function formatElapsedTime(value, format) {\r\n                if (value == null) return '';\r\n\r\n                value = _.isDate(value) ? value : new Date(value);\r\n\r\n                var \r\n                    current = new Date(),\r\n                    diff = Math.floor(((current.getTime() + current.getTimezoneOffset()) - (value.getTime() + value.getTimezoneOffset())) / 1000);\r\n\r\n                if (diff < 1) return pipTranslate.translate('ELAPSED_JUST_NOW');\r\n\r\n                var years, months, weeks, days, hours, mins, secs;\r\n\r\n                secs = diff % 60;\r\n\r\n                diff = Math.floor(diff / 60);\r\n                mins = diff % 60;\r\n\r\n                diff = Math.floor(diff / 60);\r\n                hours = diff % 24;\r\n\r\n                diff = diff / 24;\r\n                years = Math.floor(diff / 365),\r\n\r\n                diff = diff - years * 365;\r\n                months = Math.floor(diff / 30),\r\n                days = Math.floor(diff - months * 30);\r\n\r\n                if (days % 7 == 0) {\r\n                    weeks = Math.floor(days / 7);\r\n                    days = 0;\r\n                } else {\r\n                    weeks = 0;\r\n                }\r\n\r\n                if (format == 'interval') {\r\n                    var result = '';\r\n\r\n                    if (years) {\r\n                        result += ' ' + years + pipTranslate.translate('ELAPSED_YEARS');\r\n                        weeks = days = hours = mins = secs = null;\r\n                    }\r\n                    if (months) {\r\n                        result += ' ' + months + pipTranslate.translate('ELAPSED_MONTHS');\r\n                        days = hours = mins = secs = null;\r\n                    }\r\n                    if (weeks) {\r\n                        result += ' ' + weeks + pipTranslate.translate('ELAPSED_WEEKS');\r\n                        hours = mins = secs = null;\r\n                    }\r\n                    if (days) {\r\n                        result += ' ' + days + pipTranslate.translate('ELAPSED_DAYS');\r\n                        mins = secs = null;\r\n                    }\r\n                    if (hours) {\r\n                        result += ' ' + hours + pipTranslate.translate('ELAPSED_HOURS');\r\n                        secs = null;\r\n                    }\r\n                    if (mins) result += ' ' + mins + pipTranslate.translate('ELAPSED_MINUTES');\r\n                    if (secs) result += ' ' + secs + pipTranslate.translate('ELAPSED_SECONDS');\r\n\r\n                    return result != '' ? result + ' ' + pipTranslate.translate('ELAPSED_AGO') \r\n                        : pipTranslate.translate('ELAPSED_JUST_NOW');\r\n                }\r\n\r\n                // Default time format = 'default'\r\n\r\n                if (years > 0) {\r\n                    return formatDate(value, 'd MMM yyyy');\r\n                }\r\n\r\n                if (months > 0 || weeks > 0 || days > 1) {\r\n                    return formatDate(value, 'MMM d') \r\n                        + ', ' + formatTime(value, 'hh:mm');\r\n                }\r\n\r\n                if (days == 1) {\r\n                    return pipTranslate.translate('ELAPSED_YESTERDAY') \r\n                        + ', ' + formatTime(value, 'hh:mm');\r\n                }\r\n\r\n                if (hours > 10) {\r\n                    return pipTranslate.translate('ELAPSED_TODAY') \r\n                        + ', ' + formatTime(value, 'hh:mm');\r\n                }\r\n\r\n                if (hours > 0) {\r\n                    return '' + hours + ' ' + (hours < 2 ? pipTranslate.translate('ELAPSED_HOUR_AGO') :\r\n                        hours < 5 ? pipTranslate.translate('ELAPSED_HOURS_AGO') : pipTranslate.translate('ELAPSED_HOURS_AGO_MORE_THAN_FIVE'));\r\n                }\r\n\r\n                if (mins > 10) {\r\n                    return '' + mins + ' ' + pipTranslate.translate('ELAPSED_MIN_AGO');\r\n                }\r\n\r\n                if (mins > 0) {\r\n                    return pipTranslate.translate('ELAPSED_FEW_MIN_AGO');\r\n                }\r\n\r\n                return pipTranslate.translate('ELAPSED_JUST_NOW');\r\n            }\r\n\r\n            function formatElapsedInterval(value) {\r\n                return formatElapsedTime(value, 'interval');  \r\n            }\r\n\r\n            function formatMillisecondsToSeconds(value) {\r\n                return Math.floor(value / 1000)\r\n            }\r\n\r\n        }]\r\n    );\r\n    \r\n})();\r\n","/**\r\n * @file Assertion utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipAssert', ['pipDebug']);\r\n\r\n    thisModule.provider('pipAssert', ['pipDebugProvider', function (pipDebugProvider) {\r\n\r\n        return {\r\n            isEmpty: pipDebugProvider.enabled() ? isEmpty : noop,\r\n            isObjectId: pipDebugProvider.enabled() ? isObjectId : noop,\r\n            isDefined: pipDebugProvider.enabled() ? isDefined : noop,\r\n            isDef: pipDebugProvider.enabled() ? isDefined : noop,\r\n            contains: pipDebugProvider.enabled() ? contains : noop,\r\n            equal: pipDebugProvider.enabled() ? equal : noop,\r\n            notEqual: pipDebugProvider.enabled() ? notEqual : noop,\r\n            strictEqual: pipDebugProvider.enabled() ? strictEqual : noop,\r\n            notStrictEqual: pipDebugProvider.enabled() ? notStrictEqual : noop,\r\n            isArray: pipDebugProvider.enabled() ? isArray : noop,\r\n            isBoolean: pipDebugProvider.enabled() ? isBoolean : noop,\r\n            isNumber: pipDebugProvider.enabled() ? isNumber : noop,\r\n            isString: pipDebugProvider.enabled() ? isString : noop,\r\n            isObject: pipDebugProvider.enabled() ? isObject : noop,\r\n            isDate: pipDebugProvider.enabled() ? isDate : noop,\r\n            isError: pipDebugProvider.enabled() ? isError : noop,\r\n            isFunction: pipDebugProvider.enabled() ? isFunction : noop,\r\n            isNotNull: pipDebugProvider.enabled() ? isNotNull : noop,\r\n            \r\n            $get: ['pipDebug', function(pipDebug) {\r\n                return {\r\n                    isEmpty: pipDebug.enabled() ? isEmpty : noop,\r\n                    isObjectId: pipDebug.enabled() ? isObjectId : noop,\r\n                    isDefined: pipDebug.enabled() ? isDefined : noop,\r\n                    isDef: pipDebug.enabled() ? isDefined : noop,\r\n                    contains: pipDebug.enabled() ? contains : noop,\r\n                    equal: pipDebug.enabled() ? equal :  noop,\r\n                    notEqual: pipDebug.enabled() ? notEqual : noop,\r\n                    strictEqual: pipDebug.enabled() ? strictEqual : noop,\r\n                    notStrictEqual: pipDebug.enabled() ? notStrictEqual :  noop,\r\n                    isArray: pipDebug.enabled() ? isArray : noop,\r\n                    isBoolean: pipDebug.enabled() ? isBoolean : noop,\r\n                    isNumber: pipDebug.enabled() ? isNumber : noop,\r\n                    isString: pipDebug.enabled() ? isString : noop,\r\n                    isObject: pipDebug.enabled() ? isObject : noop,\r\n                    isDate: pipDebug.enabled() ? isDate : noop,\r\n                    isError: pipDebug.enabled() ? isError : noop,\r\n                    isFunction: pipDebug.enabled() ? isFunction : noop,\r\n                    isNotNull: pipDebug.enabled() ? isNotNull : noop\r\n                }\r\n            }]\r\n        };\r\n\r\n        function noop() {}\r\n\r\n        function objectToString(o) {\r\n            return Object.prototype.toString.call(o);\r\n        }\r\n\r\n        function isArray(arg, message) {\r\n            if (!Array.isArray(arg)) {\r\n                throw new Error(message || arg + ' should be array');\r\n            }\r\n        }\r\n\r\n        function isBoolean(arg, message) {\r\n            if (typeof arg !== 'boolean') {\r\n                throw new Error(message || arg + ' should be boolean');\r\n            }\r\n        }\r\n\r\n        function isNotNull(arg, message) {\r\n            if (arg === null) {\r\n                throw new Error(message || arg + ' should be not null');\r\n            }\r\n        }\r\n\r\n        function isNumber(arg, message) {\r\n            if (typeof arg !== 'number') {\r\n                throw new Error(message || arg + ' should be number');\r\n            }\r\n        }\r\n\r\n        function isString(arg, message) {\r\n            if (typeof arg !== 'string') {\r\n                throw new Error(message || arg + ' should be string');\r\n            }\r\n        }\r\n\r\n        function isObject(arg, message) {\r\n            if (typeof arg !== 'object') {\r\n                throw new Error(message || arg + ' should be an object');\r\n            }\r\n        }\r\n\r\n        function isDate(d, message) {\r\n            if (typeof d === 'object' && objectToString(d) !== '[object Date]') {\r\n                throw new Error(message || d + ' should be a date');\r\n            }\r\n        }\r\n\r\n        function isError(e, message) {\r\n            if (typeof e === 'object' && (objectToString(e) !== '[object Error]' || e instanceof Error)) {\r\n                throw new Error(message || e + ' should be an error');\r\n            }\r\n        }\r\n\r\n        function isFunction(arg, message) {\r\n            if (typeof arg !== 'function') {\r\n                throw new Error(message || arg + ' should be a function');\r\n            }\r\n        }\r\n\r\n        function isDefined(arg, message) {\r\n           if (typeof arg === \"undefined\") {\r\n               throw new Error(message || arg + ' should be defined');\r\n           }\r\n        }\r\n\r\n        function isEmpty(arg, message) {\r\n            if (arg === null || arg === undefined || arg === false) {\r\n                throw new Error(message || arg + ' should be not null or undefined or false');\r\n            }\r\n        }\r\n\r\n        function contains(obj, prop, message) {\r\n            if (typeof obj !== 'object') {\r\n                throw new Error(obj + ' should be an object');\r\n            }\r\n            if (obj[prop] === null || obj[prop] === undefined) {\r\n                throw new Error(message || prop + ' should be in object ' + obj);\r\n            }\r\n        }\r\n\r\n        // Compares args with ==\r\n        function equal(actual, expected, message) {\r\n            if (actual != expected) {\r\n                throw new Error(message || actual + ' should be not equal ' + expected);\r\n            }\r\n        }\r\n\r\n        // Compares args with !=\r\n        function notEqual(actual, expected, message) {\r\n            if (actual == expected) {\r\n                throw new Error(message || actual + ' should be equal ' + expected);\r\n            }\r\n        }\r\n\r\n        // Compares args with ===\r\n        function strictEqual(actual, expected, message) {\r\n            if (actual !== expected) {\r\n                throw new Error(message || actual + ' should not be strict equal ' + expected);\r\n            }\r\n        }\r\n\r\n        // Compares args with !==\r\n        function notStrictEqual(actual, expected, message) {\r\n            if (actual === expected) {\r\n                throw new Error(message || actual + ' should not strict equal ' + expected);\r\n            }\r\n        }\r\n\r\n        // Checks if value is a valid ObjectId\r\n        function isObjectId(value, message) {\r\n            var checkForHexRegExp = new RegExp(\"^[0-9a-fA-F]{24}$\");\r\n            if (!checkForHexRegExp.test(value)) {\r\n                throw new Error(message || value + ' should be an object id');\r\n            }\r\n        }\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Debugging service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipDebug', []);\r\n\r\n    thisModule.provider('pipDebug', ['$logProvider', function ($logProvider) {\r\n\r\n        this.enabled = true;\r\n\r\n        return {\r\n            enable: enable,\r\n            disable: disable,\r\n            enabled: enabled,\r\n            \r\n            $get: ['$log', function($log) {\r\n                return {\r\n                    enabled: enabled,\r\n                    log: $log.log,\r\n                    info: $log.info,\r\n                    warn: $log.warn,\r\n                    error: $log.error,\r\n                    debug: $log.debug\r\n                }\r\n            }]\r\n        };\r\n\r\n        function enabled() {\r\n            return this.enabled;\r\n        }\r\n\r\n        function enable() {\r\n            this.enabled = true;\r\n            $logProvider.debugEnabled(true);\r\n        }\r\n\r\n        function disable() {\r\n            this.enabled = false;\r\n            $logProvider.debugEnabled(false);\r\n        }\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Error context\r\n * @description\r\n * Error context decouples business components that throw errors\r\n * and visualization components that show them to users\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors', ['pipUtils', 'pipAssert']);\r\n\r\n    /*\r\n     * Error is designed to assist with error handling\r\n     * within different application scopes & controllers without overlap.\r\n     *\r\n     * A unique identification of the scope/controller is passed to the service\r\n     * when it is initialized to identify the error for that scope.\r\n     * */\r\n    thisModule.factory('pipError',\r\n        ['$rootScope', 'pipAssert', function ($rootScope, pipAssert) {\r\n\r\n            // Initialize error scope\r\n            $rootScope.errors = {};\r\n\r\n            return createError;\r\n\r\n            //----------------------------\r\n\r\n            function initError(scope) {\r\n                $rootScope.errors[scope] = {\r\n                    message: undefined,\r\n                    code: undefined,\r\n                    details: undefined\r\n                };\r\n            };\r\n\r\n            function errorMessage(error) {\r\n                if (_.isNull(error)) {\r\n                    return null;\r\n                }\r\n\r\n                // Process regular messages\r\n                if (error.message) {\r\n                    return error.message;\r\n                }\r\n\r\n                // Process server application errors\r\n                if (error.data) {\r\n                    if (error.data.code) {\r\n                        // process server error codes here\r\n                        return 'ERROR_' + error.data.code;\r\n                    }\r\n\r\n                    if (error.data.message) {\r\n                        return error.data.message;\r\n                    }\r\n                }\r\n\r\n                // Process standard HTTP errors\r\n                if (error.statusText) {\r\n                    return error.statusText;\r\n                }\r\n\r\n                if (error.status) {\r\n                    return 'ERROR_' + error.status;\r\n                }\r\n                \r\n                return error.data ? error.data : error;\r\n            };\r\n\r\n            function errorCode(error) {\r\n                if (_.isNull(error)) {\r\n                    return null;\r\n                }\r\n\r\n                if (error.data && error.data.code) {\r\n                    return error.data.code;\r\n                }\r\n\r\n                if (error.status) {\r\n                    return error.status;\r\n                }\r\n                \r\n                return null;\r\n            };\r\n\r\n            function errorDetails(error) {\r\n                return error && error.data ? error.data : error;\r\n            };\r\n\r\n            function createError(scope, scopeObject) {\r\n                scope = scope || 'global';\r\n\r\n                var error = {\r\n                    reset: function () {\r\n                        initError(scope);\r\n                    },\r\n\r\n                    empty: function() {\r\n                        var error = $rootScope.errors[scope];\r\n                        return _.isNull(error) || (_.isNull(error.message) && _.isNull(error.code));\r\n                    },\r\n\r\n                    get: function () {\r\n                        if ($rootScope.errors[scope]) {\r\n                            return $rootScope.errors[scope];\r\n                        }\r\n                        return '';\r\n                    },\r\n\r\n                    message: function () {\r\n                        if ($rootScope.errors[scope]) {\r\n                            return $rootScope.errors[scope].message;\r\n                        }\r\n                        return null;\r\n                    },\r\n\r\n                    code: function () {\r\n                        if ($rootScope.errors[scope]) {\r\n                            return $rootScope.errors[scope].code;\r\n                        }\r\n                        return null;\r\n                    },\r\n\r\n                    details: function () {\r\n                        if ($rootScope.errors[scope]) {\r\n                            return $rootScope.errors[scope].details;\r\n                        }\r\n                        return null;\r\n                    },\r\n\r\n                    set: function (error) {\r\n                        if (error) {\r\n                            pipAssert.isObject(error, \"Setting error: error should be an object\");\r\n\r\n                            $rootScope.errors[scope] = {\r\n                                message: errorMessage(error),\r\n                                code: errorCode(error),\r\n                                details: errorDetails(error)\r\n                            };\r\n                            console.error($rootScope.errors[scope]);\r\n                        } else {\r\n                            initError(scope);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                // Assign error into scope\r\n                if (_.isObject(scopeObject)) scopeObject.error = error;\r\n\r\n                return error;\r\n            };\r\n        }]\r\n    );\r\n    \r\n})();","/**\r\n * @file Application router extended from ui.router\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n    \r\n    var thisModule = angular.module('pipState', ['ui.router', 'pipTranslate', 'pipAssert']);\r\n\r\n    thisModule.config(\r\n        ['$locationProvider', '$httpProvider', 'pipTranslateProvider', function($locationProvider, $httpProvider, pipTranslateProvider) {\r\n            // Switch to HTML5 routing mode\r\n            //$locationProvider.html5Mode(true);\r\n            pipTranslateProvider.translations('en', {\r\n                'ERROR_SWITCHING': 'Error while switching route. Try again.'\r\n            });\r\n\r\n            pipTranslateProvider.translations('ru', {\r\n                'ERROR_SWITCHING': 'Ошибка при переходе. Попробуйте ещё раз.'\r\n            });\r\n        }]\r\n    );\r\n\r\n    thisModule.run(\r\n        ['$rootScope', 'pipTranslate', '$state', function($rootScope, pipTranslate, $state) {\r\n            $rootScope.$on('$stateChangeSuccess',\r\n                function(event, toState, toParams, fromState, fromParams) {\r\n                    if ($rootScope.$user && $rootScope.$user.id && toState.params && toState.params.access) {\r\n                        if (toParams && toParams.party_id) {\r\n                            var party = _.find($rootScope.$user.party_access, {party_id: toParams.party_id});\r\n                            if (party) {\r\n                                if (toState.params.access == 'manager' && !party.manager ||\r\n                                    toState.params.access == 'contributor' && !party.contributor) {\r\n                                    if (toState.params.toState) {\r\n                                        event.preventDefault();\r\n                                        $state.go(toState.params.toState, toParams);\r\n                                        return;\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                if (toParams.party_id != $rootScope.$user.id && toState.params.toState) {\r\n                                    event.preventDefault();\r\n                                    $state.go(toState.params.toState, toParams);\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Unset routing variable to disable page transition\r\n                    $rootScope.$routing = false;\r\n                    // Record current and previous state\r\n                    $rootScope.$state = {name: toState.name, url: toState.url, params: toParams};\r\n                    $rootScope.$prevState = {name: fromState.name, url: fromState.url, params: fromParams};\r\n                }\r\n            );\r\n\r\n            // Intercept route error\r\n            $rootScope.$on('$stateChangeError',\r\n                function(event, toState, toParams, fromState, fromParams, error) {\r\n                    // Unset routing variable to disable page transition\r\n                    $rootScope.$routing = false;\r\n\r\n                    console.error('Error while switching route to ' + toState.name);\r\n                    console.error(error);\r\n                }\r\n            );\r\n\r\n\r\n            // Intercept route error\r\n            $rootScope.$on('$stateNotFound',\r\n                function(event, unfoundState, fromState, fromParams) {\r\n                    event.preventDefault();\r\n\r\n                    // todo make configured error state name\r\n                    $state.go('errors_missing_route',  {\r\n                            unfoundState: unfoundState,\r\n                            fromState : {\r\n                                to: fromState ? fromState.name : '',\r\n                                fromParams: fromParams\r\n                            }\r\n                        }\r\n                    );\r\n                    $rootScope.$routing = false;\r\n                }\r\n            );\r\n\r\n        }]\r\n    );\r\n\r\n    thisModule.provider('pipState', ['$stateProvider', 'pipAssertProvider', function($stateProvider, pipAssertProvider) {\r\n        // Configuration of redirected states\r\n        var redirectedStates = {};\r\n\r\n        this.redirect = setRedirect;\r\n        this.state = $stateProvider.state;\r\n\r\n        this.$get = ['$state', '$timeout', 'pipAssert', function ($state, $timeout, pipAssert) {\r\n            $state.redirect = redirect;\r\n            \r\n            return $state;\r\n            \r\n\t\t\t//------------------------\r\n            function redirect(event, state, params, $rootScope) {\r\n                pipAssert.contains(state, 'name', \"$state.redirect: state should contains name prop\");\r\n                pipAssert.isObject(params, \"$state.redirect: params should be an object\");\r\n\r\n                var toState;\r\n\r\n                $rootScope.$routing = true;\r\n                toState = redirectedStates[state.name];\r\n                if (_.isFunction(toState)) {\r\n                    toState = toState(state.name, params, $rootScope);\r\n\r\n                    if (_.isNull(toState)) {\r\n                        $rootScope.$routing = false;\r\n                        throw new Error('Redirected toState cannot be null');\r\n                    }\r\n                }\r\n\r\n                if (!!toState) {\r\n                    $timeout(function() {\r\n                        event.preventDefault();\r\n                        $state.transitionTo(toState, params, {location: 'replace'});\r\n                    });\r\n\r\n                    return true;\r\n                }\r\n\r\n                return false;\r\n            }\r\n        }];\r\n\r\n        return;        \r\n        //------------------\r\n\r\n        // Specify automatic redirect from one state to another\r\n        function setRedirect(fromState, toState) {\r\n            pipAssertProvider.isNotNull(fromState, \"pipState.redirect: fromState cannot be null\");\r\n            pipAssertProvider.isNotNull(toState, \"pipState.redirect: toState cannot be null\");\r\n            \r\n            redirectedStates[fromState] = toState;  \r\n\r\n            return this;\r\n        };\r\n\r\n    }]);\r\n\r\n})();","\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    config.$inject = ['$mdThemingProvider', 'pipTranslateProvider'];\r\n    run.$inject = ['localStorageService', 'pipTheme', '$rootScope'];\r\n    ThemeFactory.$inject = ['localStorageService', '$mdTheming', '$rootScope', '$timeout', '$state', '$stateParams'];\r\n    angular\r\n        .module('pipTheme', ['ngMaterial'])\r\n        .config(config)\r\n        .run(run)\r\n        .factory('pipTheme', ThemeFactory);\r\n\r\n    function config($mdThemingProvider, pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            THEME: 'Theme',\r\n            blue: 'Blue',\r\n            pink: 'Pink',\r\n            amber: 'Amber',\r\n            orange: 'Orange',\r\n            green: 'Green',\r\n            navy: 'Navy',\r\n            grey: 'Grey'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            THEME: 'Тема',\r\n            blue: 'Голубая',\r\n            pink: 'Розовая',\r\n            amber: 'Янтарная',\r\n            orange: 'Оранжевая',\r\n            green: 'Зеленая',\r\n            navy: 'Сине-серая',\r\n            grey: 'Серая'\r\n        });\r\n\r\n\r\n        registerBlueTheme('default');\r\n        registerBlueTheme('blue');\r\n        registerPinkTheme('pink');\r\n        registerAmberTheme('amber');\r\n        registerOrangeTheme('orange');\r\n        registerGreenTheme('green');\r\n        registerNavyTheme('navy');\r\n        registerGreyTheme('grey');\r\n       // registerDarkTheme('dark');\r\n       // registerBlackTheme('black');\r\n\r\n        $mdThemingProvider.setDefaultTheme('default');\r\n        $mdThemingProvider.alwaysWatchTheme(true);\r\n\r\n        function registerBlueTheme(themeName) {\r\n            var bluePrimaryPalette = $mdThemingProvider.extendPalette('blue', {\r\n                'contrastDefaultColor': 'light',\r\n                'contrastDarkColors': undefined\r\n            });\r\n            $mdThemingProvider.definePalette('blue-primary', bluePrimaryPalette);\r\n\r\n            var blueBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(33, 150, 243, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('blue-background', blueBackgroundPalette);\r\n\r\n            var blueAccentPalette = $mdThemingProvider.extendPalette('green', {\r\n                '600': 'rgba(0, 200, 83, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('blue-accent', blueAccentPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('blue-primary', {\r\n                    'default': '500',\r\n                    'hue-1': '300'\r\n                })\r\n                .backgroundPalette('blue-background', {\r\n                    'default': '50',  // background\r\n                    'hue-1': 'A200',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('blue-accent', {\r\n                    'default': '600'\r\n                });\r\n        }\r\n\r\n        function registerPinkTheme(themeName) {\r\n            var PinkBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(188, 86, 121, 1)',\r\n                'contrastDefaultColor': 'dark',\r\n                'contrastLightColors': ['A200', 'A700']\r\n            });\r\n            $mdThemingProvider.definePalette('pink-background', PinkBackgroundPalette);\r\n\r\n            var PinkPrimaryPalette = $mdThemingProvider.extendPalette('pink', {\r\n                '600': 'rgba(255, 128, 171, 1)',\r\n                '700': 'rgba(188, 86, 121, .54)',\r\n                '900': 'rgba(188, 86, 121, 1)',\r\n                'contrastDefaultColor': 'light'\r\n            });\r\n            $mdThemingProvider.definePalette('pink-primary', PinkPrimaryPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('pink-primary', {\r\n                    'default': '900',\r\n                    'hue-1': '700'\r\n                })\r\n                .backgroundPalette('pink-background', {\r\n                    'default': '50',  // background\r\n                    'hue-1': 'A200',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('pink-primary', {\r\n                    'default': '600'\r\n                });\r\n        }\r\n\r\n\r\n        function registerAmberTheme(themeName) {\r\n            var orangeBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(255, 152, 0, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('orange-background', orangeBackgroundPalette);\r\n\r\n            var orangePrimaryPalette = $mdThemingProvider.extendPalette('orange', {\r\n                '800': 'rgba(255, 152, 0, 1)',\r\n                '900': 'rgba(255, 152, 0, .54);'\r\n            });\r\n            $mdThemingProvider.definePalette('orange-primary', orangePrimaryPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('orange-primary', {\r\n                    'default': '800',\r\n                    'hue-1': '900'\r\n                })\r\n                .backgroundPalette('orange-background', {\r\n                    'default': '50',  // background\r\n                    'hue-1': 'A200',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('orange', {\r\n                    'default': '900'\r\n                });\r\n        }\r\n\r\n        function registerOrangeTheme(themeName) {\r\n            var RedBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(255, 112, 67, 1)',\r\n                'contrastLightColors': ['600', '700', '800', '900', 'A200']\r\n            });\r\n            $mdThemingProvider.definePalette('red-background', RedBackgroundPalette);\r\n\r\n            var RedPrimaryPalette = $mdThemingProvider.extendPalette('orange', {\r\n                '800': 'rgba(255, 112, 67, 1)',\r\n                '900': 'rgba(255, 152, 67, .54)',\r\n                'A100': 'rgba(255, 171, 64, 1)',\r\n                'contrastLightColors': ['800', '900', 'A100']\r\n            });\r\n            $mdThemingProvider.definePalette('red-primary', RedPrimaryPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('red-primary', {\r\n                    'default': '800',\r\n                    'hue-1': '900'\r\n                })\r\n                .backgroundPalette('red-background', {\r\n                    'default': '50',  // background\r\n                    'hue-1': 'A200',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('red-primary', {\r\n                    'default': 'A100'\r\n                });\r\n        }\r\n\r\n        function registerGreenTheme(themeName) {\r\n            var greenBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(76, 175, 80, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('green-background', greenBackgroundPalette);\r\n\r\n            var greenPrimaryPalette = $mdThemingProvider.extendPalette('green', {\r\n                '300':'#9ed4a1',\r\n                'contrastLightColors': ['500', '300']\r\n            });\r\n            $mdThemingProvider.definePalette('green-primary', greenPrimaryPalette);\r\n\r\n\r\n            var greenAccentPalette = $mdThemingProvider.extendPalette('amber', {\r\n                'contrastLightColors': ['A700']\r\n            });\r\n            $mdThemingProvider.definePalette('green-accent', greenAccentPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('green-primary', {\r\n                    'default': '500',\r\n                    'hue-1': '300'\r\n                })\r\n                .backgroundPalette('green-background', {\r\n                    'default': '50',  // background\r\n                    'hue-1': 'A200',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('green-accent', {\r\n                    'default': 'A700'\r\n                });\r\n        }\r\n\r\n        function registerNavyTheme(themeName) {\r\n            var greyPalette = $mdThemingProvider.extendPalette('grey', {\r\n                '700': 'rgba(86, 97, 125, 1)',\r\n                '800': 'rgba(86, 97, 125, .54)',\r\n                'A100': 'rgba(231, 231, 231, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('grey', greyPalette);\r\n\r\n            var tealPalette = $mdThemingProvider.extendPalette('teal', {\r\n                'contrastLightColors': [ '500', '600', '700', '800', '900', 'A700']\r\n            });\r\n            $mdThemingProvider.definePalette('teal', tealPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('grey', {\r\n                    'default': '700',\r\n                    'hue-1': '800'\r\n                })\r\n                .backgroundPalette('grey', {\r\n                    'default': '50',  // background\r\n                    'hue-1': '700',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('teal', {\r\n                    'default': 'A700'\r\n                });\r\n        }\r\n\r\n        function registerGreyTheme(themeName) {\r\n            var thirdPartyPalette = $mdThemingProvider.extendPalette('grey', {\r\n                'A100': 'rgba(231, 231, 231, 1)',\r\n                'A200': 'rgba(255, 152, 0, 1)',\r\n                'A400': '#a9b9c0',\r\n                '500': '#607D8B',\r\n                'A700': '#90A4AE',\r\n                //'800': '',\r\n                'contrastDefaultColor': 'dark',\r\n                'contrastLightColors': [ '300', '400', '500', '600', '700', '800', '900', 'A700']\r\n            });\r\n            $mdThemingProvider.definePalette('third-party', thirdPartyPalette);\r\n\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('third-party', {\r\n                    'default': '500',\r\n                    'hue-1': 'A400'\r\n                })\r\n                .backgroundPalette('third-party', {\r\n                    'default': '50',  // background\r\n                    'hue-1': '500',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('third-party', {\r\n                    'default': 'A700'\r\n                });\r\n        }\r\n\r\n        function registerDarkTheme(themeName) {\r\n            var darkBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                '600': 'rgba(48, 48, 48, 1)',\r\n                '700': 'rgba(255, 255, 255, 0.54)',\r\n                '800': 'rgba(66, 66, 66, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('dark-background', darkBackgroundPalette);\r\n\r\n            var darkAccentPalette = $mdThemingProvider.extendPalette('green', {\r\n                '600': 'rgba(0, 200, 83, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('dark-accent', darkAccentPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('dark-background', {\r\n                    'default': '900',\r\n                    'hue-1': '700'\r\n                })\r\n                .backgroundPalette('dark-background', {\r\n                    'default': '800',  // background\r\n                    'hue-1': '900',  // tiles dialog\r\n                    'hue-2': 'A700'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('dark-accent', {\r\n                    'default': '600'\r\n                });\r\n        }\r\n\r\n        function registerBlackTheme(themeName) {\r\n            var blackBackgroundPalette = $mdThemingProvider.extendPalette('grey', {\r\n                '600': 'rgba(48, 48, 48, 1)',\r\n                '700': 'rgba(255, 255, 255, 0.54)',\r\n                '800': 'rgba(66, 66, 66, 1)',\r\n                '500': 'rgba(38, 50, 56, 1)'\r\n            });\r\n            $mdThemingProvider.definePalette('black-background', blackBackgroundPalette);\r\n\r\n            var blackAccentPalette = $mdThemingProvider.extendPalette('blue-grey', {\r\n                '700': 'rgba(255, 255, 255, 0.54)'\r\n            });\r\n            $mdThemingProvider.definePalette('black-accent', blackAccentPalette);\r\n\r\n            $mdThemingProvider.theme(themeName)\r\n                .primaryPalette('black-accent', {\r\n                    'default': '900',\r\n                    'hue-1': '700'\r\n                })\r\n                .backgroundPalette('black-background', {\r\n                    'default': '800',  // background\r\n                    'hue-1': '500',  // tiles dialog\r\n                    'hue-2': '800'   // app bar\r\n                })\r\n                .warnPalette('red', {\r\n                    'default': 'A200'\r\n                })\r\n                .accentPalette('black-accent', {\r\n                    'default': '600'\r\n                });\r\n        }\r\n    }\r\n\r\n\r\n\r\n    function run(localStorageService, pipTheme, $rootScope) {\r\n        try {\r\n            var currentTheme = ($rootScope.$user && $rootScope.$user.theme) ?\r\n                $rootScope.$user.theme : localStorageService.get('theme');\r\n\r\n            pipTheme.initializeTheme(currentTheme);\r\n        } catch (ex) {\r\n            pipTheme.initializeTheme('blue');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ngdoc factory\r\n     * @name pipTheme\r\n     */\r\n    function ThemeFactory(localStorageService, $mdTheming, $rootScope, $timeout, $state, $stateParams) {\r\n        return {\r\n            /**\r\n             * Set current theme\r\n             * @param {String} theme - theme name\r\n             * @param {String}\r\n             * @throws {Error} 'Theme is not specified' in case if theme is not defined\r\n             * @throws {Error} 'Theme XXX is not registered. Please, register it first with $mdThemingProvider' if theme is not registered\r\n             */\r\n            setCurrentTheme: function (theme) {\r\n                if (theme == null || theme === '') {\r\n                    throw new Error('Theme is not specified');\r\n                }\r\n\r\n                if (localStorageService.get('theme') == theme && $rootScope.$theme == theme) {\r\n                    return;\r\n                }\r\n\r\n                if (!(theme in $mdTheming.THEMES)) {\r\n                    throw new Error('Theme ' + theme + ' is not registered. Please, register it first with $mdThemingProvider');\r\n                }\r\n                localStorageService.set('theme', theme);\r\n                $rootScope.$theme = theme;\r\n            },\r\n\r\n            /** Add attribute 'md-theme' with value current theme\r\n             *  Add current theme class\r\n             */\r\n            initializeTheme: function (theme) {\r\n                if (theme == null || theme === '') {\r\n                    throw new Error('Theme is not specified');\r\n                }\r\n\r\n                if (!(theme in $mdTheming.THEMES)) {\r\n                    throw new Error('Theme ' + theme + ' is not registered. Please, register it first with $mdThemingProvider');\r\n                }\r\n\r\n                $rootScope.$theme = theme;\r\n                $('body').attr('md-theme', '{{ $theme }}').addClass('{{ $theme }}');\r\n            }\r\n        };\r\n    }\r\n})();\r\n","/**\r\n * @file Global application timer service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTimer', []);\r\n\r\n    thisModule.service('pipTimer', \r\n        ['$interval', '$rootScope', function ($interval, $rootScope) {\r\n            var \r\n                AUTO_PULL_CHANGES_TIMEOUT = 60000,\r\n                AUTO_UPDATE_PAGE_TIMEOUT = 15000,\r\n                started = false, \r\n                autoPullChangesInterval, \r\n                autoUpdatePageInterval;\r\n\r\n            return {\r\n                isStarted: isStarted,\r\n                start: start,\r\n                stop: stop\r\n            };\r\n\r\n            //------------------------\r\n\r\n            function isStarted() {\r\n                return started;\r\n            };\r\n\r\n            function start() {\r\n                if (started) return;\r\n\r\n                autoPullChangesInterval = $interval(function () {\r\n                    $rootScope.$broadcast('pipAutoPullChanges');\r\n                }, AUTO_PULL_CHANGES_TIMEOUT);\r\n\r\n                autoUpdatePageInterval = $interval(function () {\r\n                    $rootScope.$broadcast('pipAutoUpdatePage');\r\n                }, AUTO_UPDATE_PAGE_TIMEOUT);\r\n\r\n                started = true;\r\n            };\r\n\r\n            function stop() {\r\n                if (autoPullChangesInterval)\r\n                    $interval.cancel(autoPullChangesInterval);\r\n\r\n                if (autoUpdatePageInterval)\r\n                    $interval.cancel(autoUpdatePageInterval);\r\n\r\n                started = false;\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Transaction context\r\n * @description\r\n * Transaction context helps to wrap multiple server requests\r\n * into one logical transaction. It decouples transaction\r\n * management and progress visualization to the user\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTransactions', ['pipTranslate', 'pipErrors']);\r\n\r\n\tthisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        \r\n        pipTranslateProvider.translations('en', {\r\n            'ENTERING': 'Entering...',\r\n            'PROCESSING': 'Processing...',\r\n            'LOADING': 'Loading...',\r\n            'SAVING': 'Saving...'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'ENTERING': 'Вход в систему...',\r\n            'PROCESSING': 'Обрабатывается...',\r\n            'LOADING': 'Загружается...',\r\n            'SAVING': 'Сохраняется...'\r\n        });\r\n\t\t\r\n\t}]);\r\n\r\n    /*\r\n     * Transaction is designed to assist with transaction processing\r\n     * within different application scopes & controllers without overlap.\r\n     *\r\n     * A unique identification of the scope/controller is passed to the service\r\n     * when it is initialized to identify the error for that scope.\r\n     * \r\n     * Transaction is also integrated with Error service. So you don't need to double it\r\n     * */\r\n    thisModule.factory('pipTransaction',\r\n        ['$rootScope', 'pipError', function ($rootScope, pipError) {\r\n\r\n            // Initialize transaction scope\r\n            $rootScope.transactions = {};\r\n\r\n            return createTransaction;\r\n\r\n            //---------------------------------\r\n\r\n            function initTransaction(scope) {\r\n                $rootScope.transactions[scope] = {\r\n                    id: undefined,\r\n                    operation: undefined\r\n                };\r\n            }\r\n            \r\n            function createTransaction(scope, scopeObject) {\r\n                scope = scope || 'global';\r\n\r\n                var error = pipError(scope);\r\n                var transaction = {\r\n                    error: error,\r\n\r\n                    reset: function () {\r\n                        initTransaction();\r\n                        error.reset();\r\n                    },\r\n\r\n                    busy: function() {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        return transaction != null && transaction.id;\r\n                    },\r\n\r\n                    failed: function() {\r\n                        return !error.empty();\r\n                    },\r\n\r\n                    aborted: function(id) {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        return _.isNull(transaction) || transaction.id != id;\r\n                    },\r\n\r\n                    get: function () {\r\n                        if (_.isNull($rootScope.transactions[scope])) {\r\n                            initTransaction(scope);\r\n                        }\r\n                        return $rootScope.transactions[scope];\r\n                    },\r\n\r\n                    id: function () {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        return transaction ? transaction.id : null;\r\n                    },\r\n\r\n                    operation: function () {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        return transaction ? transaction.operation : null;\r\n                    },\r\n\r\n                    errorMessage: function () {\r\n                        return error.message();\r\n                    },\r\n\r\n                    begin: function (operation) {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        // Transaction already in progress\r\n                        if (transaction != null && transaction.id) {\r\n                            return null;\r\n                        }                      \r\n\r\n                        transaction = $rootScope.transactions[scope] = {\r\n                            id: new Date().getTime(),\r\n                            operation: operation || 'PROCESSING'\r\n                        };\r\n                        error.reset();\r\n\r\n                        return transaction.id;\r\n                    },\r\n\r\n                    abort: function() {\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        if (transaction) {\r\n                            transaction.id = null;\r\n                        }\r\n                        error.reset();\r\n                    },\r\n\r\n                    end: function (err) {\r\n                        if (err) error.set(err);\r\n                        else error.reset();\r\n\r\n                        var transaction = $rootScope.transactions[scope];\r\n                        if (transaction != null) {\r\n                            transaction.id = null;\r\n                        }                      \r\n                    }\r\n                };\r\n\r\n                if (_.isObject(scopeObject)) {\r\n                    scopeObject.error = error;\r\n                    scopeObject.transaction = transaction;\r\n                }\r\n\r\n                return transaction;\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Translatation service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo:\r\n * - Move directives to more appropriate places\r\n */\r\n \r\n /* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTranslate', ['LocalStorageModule', 'pipAssert']);\r\n\r\n    thisModule.provider('pipTranslate', ['pipAssertProvider', function(pipAssertProvider) {\r\n        var \r\n            language = 'en',\r\n            persist = true,\r\n            setRoot = true,\r\n            translationMap = {\r\n                en: {\r\n                    'en': 'English',\r\n                    'ru': 'Russian',\r\n                    'es': 'Spanish',\r\n                    'pt': 'Portuguese',\r\n                    'de': 'German',\r\n                    'fr': 'French'\r\n                },\r\n                ru: {\r\n                    'en': 'Английский',\r\n                    'ru': 'Русский',\r\n                    'es': 'Испанский',\r\n                    'pt': 'Португальский',\r\n                    'de': 'Немецкий',\r\n                    'fr': 'Французский'\r\n                }\r\n            };\r\n\r\n        this.translations = setTranslations;\r\n        this.language = initLanguage;\r\n        this.use = initLanguage;\r\n        this.persist = initPersist;\r\n        this.setRoot = initSetRoot;\r\n\r\n        this.$get = ['$rootScope', '$timeout', 'localStorageService', 'pipAssert', function ($rootScope, $timeout, localStorageService, pipAssert) {\r\n            // Read language from persistent storage\r\n            if (persist)\r\n                language = localStorageService.get('language') || language;\r\n\r\n            // Set root variable\r\n            if (setRoot) \r\n                $rootScope.$language = language;\r\n            \r\n            // Resetting root scope to force update language on the screen\r\n            function reset(fullReset, partialReset) {\r\n                fullReset = fullReset !== undefined ? !!fullReset : true;\r\n                partialReset = partialReset !== undefined ? !!partialReset : true;\r\n\r\n                $rootScope.$reset = fullReset;\r\n                $rootScope.$partialReset = partialReset;\r\n                $timeout(function() {\r\n                    $rootScope.$reset = false;\r\n                    $rootScope.$partialReset = false;\r\n                }, 0);\r\n            }\r\n\r\n            return {\r\n                use: function (newLanguage, fullReset, partialReset) {\r\n                    pipAssert.isString(newLanguage || '', \"pipTranslate.use: argument should be a string\");\r\n                    if (newLanguage != null && newLanguage != language) {\r\n                        language = newLanguage;\r\n                        if (persist)\r\n                            localStorageService.set('language', language);\r\n                        if (setRoot)\r\n                            $rootScope.$language = language;\r\n                        reset(fullReset, partialReset);\r\n                    }\r\n                    return language;\r\n                },\r\n\r\n                translations: setTranslations,\r\n                translate: translate,\r\n                translateArray: translateArray,\r\n                translateSet: translateSet,\r\n                translateObjects: translateObjects,\r\n                translateById: translateById,\r\n                translateSetById: translateSetById,\r\n                translateStringsSet: translateStringsSet\r\n            }\r\n        }];\r\n\r\n        // Initialize language selection\r\n        function initLanguage(newLanguage) {\r\n            pipAssertProvider.isString(newLanguage || '', \"pipTranslateProvider.use or pipTranslateProvider.language: argument should be a string\");\r\n\r\n            if (newLanguage != null) {\r\n                language = newLanguage;\r\n            }\r\n            return language;\r\n        }\r\n\r\n        // Initialize persistence flag\r\n        function initPersist(newPersist) {\r\n            if (newPersist != null) {\r\n                pipAssertProvider.isBoolean(newPersist || '', \"pipTranslateProvider.persist: argument should be a boolean\");\r\n                persist = newPersist;\r\n            }\r\n            return persist;\r\n        }\r\n\r\n        // Initialize set root flag\r\n        function initSetRoot(newSetRoot) {\r\n            if (newSetRoot != null) {\r\n                pipAssertProvider.isBoolean(newSetRoot || '', \"pipTranslateProvider.setRoot: argument should be a boolean\");\r\n                setRoot = newSetRoot;\r\n            }\r\n            return setRoot;  \r\n        }\r\n\r\n        // Set translation strings for specific language\r\n        function setTranslations(language, languageMap) {\r\n            pipAssertProvider.isString(language, \"pipTranslate.setTranslations or pipTranslateProvider.translations: first argument should be a string\");\r\n            pipAssertProvider.isObject(languageMap, \"pipTranslate.setTranslations or pipTranslateProvider.translations: second argument should be an object\");\r\n\r\n            var map = translationMap[language] || {};\r\n            translationMap[language] = _.extend(map, languageMap);\r\n        }\r\n\r\n        // Translate a string by key using set language\r\n        function translate(key) {\r\n            if (_.isNull(key) || _.isUndefined(key)) return '';\r\n\r\n            var map = translationMap[language] || {};\r\n            return map[key] || key;\r\n        }\r\n\r\n        // Translate an array of strings\r\n        function translateArray(keys) {\r\n            if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n            pipAssertProvider.isArray(keys, \"pipTranslate.translateArray: argument should be an array\");\r\n\r\n            var values = [];\r\n            var map = translationMap[language] || {};\r\n\r\n            _.each(keys, function (k) {\r\n                var key = k || '';\r\n                values.push(map[key] || key);\r\n            });\r\n\r\n            return values;\r\n        }\r\n\r\n        // Translate an array of strings into array of objects (set)\r\n        function translateSet(keys, key, value) {\r\n            if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n            pipAssertProvider.isArray(keys, \"pipTranslate.translateSet: first argument should be an array\");\r\n            pipAssertProvider.isString(key || '', \"pipTranslate.translateSet: second argument should be a string\");\r\n            pipAssertProvider.isString(value || '', \"pipTranslate.translateSet: third argument should be a string\");\r\n\r\n            key = key || 'id';\r\n            value = value || 'name';\r\n\r\n            var values = [];\r\n            var map = translationMap[language] || {};\r\n\r\n            _.each(keys, function (k) {\r\n                var obj = {}, mapKey = k || '';\r\n\r\n                obj[key] = mapKey;\r\n                obj[value] = map[mapKey] || mapKey;\r\n\r\n                values.push(obj);\r\n            });\r\n\r\n            return values;\r\n        }\r\n\r\n        // Translate a collection of objects\r\n        function translateObjects(items, key, value) {\r\n            if (_.isNull(items) || items.length == 0) return [];\r\n\r\n            pipAssertProvider.isArray(items, \"pipTranslate.translateObjects: first argument should be an array\");\r\n            pipAssertProvider.isString(key || '', \"pipTranslate.translateObjects: second argument should be a string\");\r\n            pipAssertProvider.isString(value || '', \"pipTranslate.translateObjects: third argument should be a string\");\r\n\r\n            key = key || 'name';\r\n            value = value || 'nameLocal';\r\n\r\n            var map = translationMap[language] || {};\r\n\r\n            _.each(items, function (i) {\r\n                var item = i, mapKey = item[key] || '';\r\n\r\n                item[value] = map[mapKey] || mapKey;\r\n            });\r\n\r\n            return items;\r\n        }\r\n\r\n        // Translate a string by key  with prefix using set language todo\r\n        function translateById(prefix, key) {\r\n            pipAssertProvider.isString(key || '', \"pipTranslate.translateById: second argument should be a string\");\r\n            pipAssertProvider.isString(prefix || '', \"pipTranslate.translateById: first argument should be a string\");\r\n\r\n            prefix = prefix ? prefix + '_' : '';\r\n            key = (prefix + key).replace(/ /g, '_').toUpperCase();\r\n            if (key == null) return '';\r\n            var map = translationMap[language] || {};\r\n            return map[key] || key;\r\n        };\r\n\r\n        function translateSetById(keys, prefix, key, value) {\r\n            if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n            pipAssertProvider.isArray(keys, \"pipTranslate.translateSetById: first argument should be an array\");\r\n            pipAssertProvider.isString(prefix || '', \"pipTranslate.translateSetById: second argument should be a string\");\r\n            pipAssertProvider.isString(key || '', \"pipTranslate.translateSetById: third argument should be a string\");\r\n            pipAssertProvider.isString(value || '', \"pipTranslate.translateSetById: forth argument should be a string\");\r\n\r\n            prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() : '';\r\n            key = key || 'id';\r\n            value = value || 'name';\r\n\r\n            var values = [];\r\n            var map = translationMap[language] || {};\r\n\r\n            _.each(keys, function (k) {\r\n                var obj = {}, mapKey = k || '';\r\n\r\n                obj[key] = mapKey;\r\n                obj[value] = map[prefix + '_' + mapKey] || mapKey;\r\n\r\n                values.push(obj);\r\n            });\r\n\r\n            return values;\r\n        }\r\n\r\n        // Translate an array of strings, apply uppercase and replace ' ' => '_'\r\n        function translateStringsSet(keys, prefix, key, value) {\r\n            if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n            pipAssertProvider.isArray(keys, \"pipTranslate.translateStringsSet: first argument should be an array\");\r\n            pipAssertProvider.isString(prefix || '', \"pipTranslate.translateStringsSet: second argument should be a string\");\r\n            pipAssertProvider.isString(key || '', \"pipTranslate.translateStringsSet: third argument should be a string\");\r\n            pipAssertProvider.isString(value || '', \"pipTranslate.translateStringsSet: forth argument should be a string\");\r\n\r\n            key = key || 'id';\r\n            value = value || 'name';\r\n            prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() + '_': '';\r\n\r\n            var values = [];\r\n            var map = translationMap[language] || {};\r\n\r\n            _.each(keys, function (k) {\r\n                var obj = {}, mapKey = k || '';\r\n                obj[key] = mapKey;\r\n                obj[value] = map[prefix + mapKey.replace(/ /g, '_').toUpperCase()]\r\n                    || (prefix + mapKey.replace(/ /g, '_').toUpperCase());\r\n\r\n                values.push(obj);\r\n            });\r\n\r\n            return values;\r\n        }\r\n    }]);\r\n\r\n    thisModule.directive('pipTranslate', ['pipTranslate', function(pipTranslate) {\r\n        return {\r\n            restrict: 'EA',\r\n            scope: {\r\n                key1: '@pipTranslate',\r\n                key2: '@key'\r\n            },\r\n            link: function (scope, element, attrs) {\r\n                var key = scope.key1 || scope.key2;\r\n                var value = pipTranslate.translate(key);\r\n                element.text(value);\r\n            }\r\n\r\n        };\r\n    }]);\r\n\r\n    thisModule.directive('pipTranslateHtml', ['pipTranslate', function(pipTranslate) {\r\n        return {\r\n            restrict: 'EA',\r\n            scope: {\r\n                key1: '@pipTranslateHtml',\r\n                key2: '@key'\r\n            },\r\n            link: function (scope, element, attrs) {\r\n                var key = scope.key1 || scope.key2;\r\n                var value = pipTranslate.translate(key);\r\n                element.html(value);\r\n            }\r\n\r\n        };\r\n    }]);\r\n\r\n})();","/**\r\n * @file Collection utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.Collections', []);\r\n\r\n    thisModule.factory('pipCollections', function () {\r\n        var collections = {};\r\n\r\n        // Index of element in array by key\r\n        collections.indexBy = function (items, key, value) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i][key] == value) {\r\n                    return i;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    \r\n        // Find element in array by key\r\n        collections.findBy = function (items, key, value) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i][key] == value) {\r\n                    return items[i];\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    \r\n        // Remove element from array by value\r\n        collections.remove = function (items, item) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i] == item) {\r\n                    items.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n        };\r\n    \r\n        // Removes element from array by key\r\n        collections.removeBy = function (items, key, value) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i][key] == value) {\r\n                    items.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n        };\r\n    \r\n        // Replaced element by key\r\n        collections.replaceBy = function (items, key, value, data) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i][key] == value) {\r\n                    items[i] = data;\r\n                    return;\r\n                }\r\n            }\r\n        };\r\n    \r\n        // Calculate difference between two collections\r\n        collections.difference = function (a1, a2, comparator) {\r\n            var result = [];\r\n    \r\n            _.each(a1, function (e1) {\r\n                var e2 = _.find(a2, function (e) {\r\n                    return comparator(e1, e);\r\n                });\r\n    \r\n                if (e2 == null) {\r\n                    result.push(e1);\r\n                }\r\n            })\r\n    \r\n            return result;\r\n        };\r\n\r\n        return collections;\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Date utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.Dates', []);\r\n\r\n    thisModule.factory('pipDates', function () {\r\n        var dates = {};\r\n\r\n        dates.addHours = function (date, hours) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            var time = date.getTime() + hours * 3600000;\r\n            return new Date(time);\r\n        };\r\n\r\n        dates.toStartDay = function (date) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            return new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n        };\r\n\r\n        dates.toEndDay = function (date, offset) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            offset = offset != null ? offset : 0;\r\n            var start = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n            return new Date(start.getTime() + 24 * 3600000 + offset);\r\n        };\r\n\r\n        dates.toStartWeek = function (date) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            var dayOfWeek = date.getDay() ? date.getDay() : 7;\r\n            date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n            return new Date(date.getTime() - (dayOfWeek - 1) * 24 * 3600000);  // dayOfWeek = 0 для воскресенья\r\n        };\r\n\r\n        dates.toEndWeek = function (date, offset) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            offset = offset != null ? offset : 0;\r\n            var dayOfWeek = date.getDay() ? date.getDay() : 7;\r\n            date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n            return new Date(date.getTime() + (8 - dayOfWeek) * 24 * 3600000 + offset);\r\n        };\r\n\r\n        dates.toStartMonth = function (date) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            return new Date(date.getFullYear(), date.getMonth(), 1);\r\n        };\r\n\r\n        dates.toEndMonth = function (date, offset) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n\r\n            var\r\n                month = date.getMonth() + 1,\r\n                year = date.getFullYear();\r\n\r\n            if (month > 11) {\r\n                year++;\r\n                month = 0;\r\n            }\r\n\r\n            date = new Date(year, month, 1);\r\n\r\n            if (offset != null) {\r\n                date = new Date(date.getTime() + offset);\r\n            }\r\n\r\n            return date;\r\n        };\r\n\r\n        dates.toStartYear = function (date) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            return new Date(date.getFullYear(), 0, 1);\r\n        };\r\n\r\n        dates.toEndYear = function (date, offset) {\r\n            date = _.isDate(date) ? date : new Date(date);\r\n            date = new Date(date.getFullYear() + 1, 0, 1);\r\n\r\n            if (offset != null) {\r\n                date = new Date(date.getTime() + offset);\r\n            }\r\n\r\n            return date;\r\n        };\r\n\r\n        /** UTC functions  - **/\r\n        dates.toUTCDate = function (year, month, day) {\r\n            return new Date(Date.UTC(year, month, day));\r\n        };\r\n\r\n        dates.toUTCDate = function (date) {\r\n            return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n        };\r\n\r\n        dates.fromUTCDate = function (date) {\r\n            if (date == null) date = new Date();\r\n            return new Date(\r\n                date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\r\n        };\r\n\r\n        dates.toUTCStartWeek = function (date) {\r\n            if(!_.isDate(date)) {\r\n                date = new Date(date);\r\n                date = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n            }\r\n            var dayOfWeek = date.getDay() ? date.getDay() : 7;\r\n            date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n            date = dayOfWeek != 1 ? new Date(date.getTime() - (dayOfWeek - 1) * 24 * 3600000) : date;\r\n            return  new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n        };\r\n\r\n        dates.toUTCEndWeek = function (date, offset) {\r\n            if(!_.isDate(date)) {\r\n                date = new Date(date);\r\n                date = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n            }\r\n            offset = offset != null ? offset : 0;\r\n            var dayOfWeek = date.getDay() ? date.getDay() : 7;\r\n            date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n            date = new Date(date.getTime() + (8 - dayOfWeek) * 24 * 3600000 + offset);\r\n            return  new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n        };\r\n\r\n        return dates;\r\n    });\r\n})();\r\n","/**\r\n * @file Form error utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n *\r\n */\r\n \r\n /* global _, angular */\r\n \r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.FormErrors', []);\r\n\r\n    thisModule.factory('pipFormErrors', ['$rootScope', function ($rootScope) {\r\n\t\treturn {\r\n\t\t\terrorsWithHint: errorsWithHint,\r\n            //submittedErrors: submittedErrors,\r\n            //submittedErrorsWithHint: submittedErrorsWithHint,\r\n            //dirtyErrors: dirtyErrors,\r\n            //dirtyErrorsWithHint: dirtyErrorsWithHint,\r\n            //touchedErrors: touchedErrors,            \r\n            touchedErrorsWithHint: touchedErrorsWithHint,\r\n            resetFormErrors: resetFormErrors,\r\n            setFormError: setFormError\r\n\t\t};\r\n\t\t//-------------------\r\n\r\n        function errorsWithHint(field) {\r\n            if (field == null) return;\r\n\t\t\t\r\n            return _.isEmpty(field.$error) ? { hint: true } : field.$error;\r\n        };\r\n\t\t\r\n//         function submittedErrors(form, field) {\r\n//             if (form == null) throw new Error('Form is not set');\r\n//             if (field == null) throw new Error('Field is not set');\r\n// \r\n//             if (form.$submitted)\r\n//                 return field.$error;\r\n//             return {};\r\n//         };\r\n// \r\n//         function submittedErrorsWithHint(form, field) {\r\n//             if (form == null) throw new Error('Form is not set');\r\n//             if (field == null) throw new Error('Field is not set');\r\n// \r\n//             if (form.$submitted) {\r\n//                 return _.isEmpty(field.$error) ? { hint: true} : field.$error;\r\n//             }\r\n//             return { hint: true };\r\n//         };\r\n// \r\n//         function dirtyErrors(form, field) {\r\n//             if (form == null) throw new Error('Form is not set');\r\n//             if (field == null) throw new Error('Field is not set');\r\n// \r\n//             if (field.$dirty || form.$dirty)\r\n//                 return field.$error;\r\n//             return {};\r\n//         };\r\n// \r\n//         function dirtyErrorsWithHint(form, field) {\r\n//             if (form == null) throw new Error('Form is not set');\r\n//             if (field == null) throw new Error('Field is not set');\r\n// \r\n//             if (field.$dirty || form.$dirty) {\r\n//                 return _.isEmpty(field.$error) ? { hint: true} : field.$error;\r\n//             }\r\n//             return { hint: true };\r\n//         };\r\n// \r\n//         function touchedErrors(form, field) {\r\n//             if (form == null) throw new Error('Form is not set');\r\n//             if (field == null) throw new Error('Field is not set');\r\n//             \r\n//             if (field.$touched || form.$dirty)\r\n//                 return field.$error;\r\n//             return {};\r\n//         };\r\n\r\n        function touchedErrorsWithHint(form, field) {\r\n            if (form == null) return;\r\n            if (field == null) return;\r\n\r\n            if (form.$submitted && (field.$touched || form.$dirty) || !form.$submitted && (field.$touched || field.$dirty)) {\r\n                var result = _.isEmpty(field.$error) ? { hint: true} : field.$error;\r\n                return result;\r\n            }\r\n            return { hint: true };\r\n        };\r\n\r\n        function resetFormErrors(form, errors) {\r\n            form.$setPristine();\r\n            form.$setUntouched();\r\n\r\n            if (errors) {\r\n                form.$setDirty();\r\n                form.$setSubmitted();\r\n            }\r\n\r\n            form.$serverError = {};\r\n        };\r\n        \r\n        function setFormError(form, error, errorFieldMap) {\r\n            if (error == null) return;\r\n            // Prepare form server errors\r\n            form.$serverError = form.$serverError || {};\r\n            // Prepare error code\r\n            var code = error.code || (error.data || {}).code || null;\r\n            if (!code && error.status) code = error.status;\r\n\r\n            if (code) {\r\n                var \r\n                    errorName = 'ERROR_' + code,\r\n                    field = errorFieldMap ? errorFieldMap[code] : null;\r\n                // Set server error to fields\r\n                if (field && form[field] && form[field].$setValidity) {\r\n                    form[field].$setValidity(errorName, false);\r\n                    return;\r\n                }\r\n\r\n                // Set server error to form\r\n                if (field == 'form') {\r\n                    form.$serverError[errorName] = true;\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // if undefined error for this form or code === undefined/null, go to unhandled error page\r\n            if (error.data && error.data.message) {\r\n                form.$serverError['ERROR_UNKNOWN'] = error.data.message;\r\n                goToUnhandledErrorPage(error);\r\n                return;\r\n            }\r\n\r\n            // Set as undefined error\r\n            if (error.message) {\r\n                form.$serverError['ERROR_UNKNOWN'] = error.message;\r\n                goToUnhandledErrorPage(error);\r\n                return;\r\n            }\r\n\r\n            if (error.name) {\r\n                form.$serverError['ERROR_UNKNOWN'] = error.name;\r\n                goToUnhandledErrorPage(error);\r\n                return;\r\n            }\r\n\r\n            form.$serverError['ERROR_UNKNOWN'] = error;\r\n            goToUnhandledErrorPage(error);\r\n        };\r\n\r\n        function goToUnhandledErrorPage(error) {\r\n            $rootScope.$emit('pipUnhandledInternalError', {\r\n                error: error\r\n            });\r\n        };\r\n        \r\n\t}]);\r\n\r\n})();","/**\r\n * @file General purpose utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.General', ['pipState', 'pipAssert']);\r\n\r\n    thisModule.factory('pipUtils', ['$rootScope', '$window', '$state', 'pipAssert', function ($rootScope, $window, $state, pipAssert) {\r\n\r\n        function strRepeat(str, qty) {\r\n            if (qty < 1) return '';\r\n            var result = '';\r\n            while (qty > 0) {\r\n                if (qty & 1) result += str;\r\n                qty >>= 1, str += str;\r\n            }\r\n            return result;\r\n        }\r\n\r\n        var toString = Object.prototype.toString;\r\n\r\n        var sprintf = (function sprintf() {\r\n            function get_type(variable) {\r\n                return toString.call(variable).slice(8, -1).toLowerCase();\r\n            }\r\n\r\n            var str_repeat = strRepeat;\r\n\r\n            var str_format = function() {\r\n                if (!str_format.cache.hasOwnProperty(arguments[0])) {\r\n                    str_format.cache[arguments[0]] = str_format.parse(arguments[0]);\r\n                }\r\n                return str_format.format.call(null, str_format.cache[arguments[0]], arguments);\r\n            };\r\n\r\n            str_format.format = function(parse_tree, argv) {\r\n                var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length;\r\n                for (i = 0; i < tree_length; i++) {\r\n                    node_type = get_type(parse_tree[i]);\r\n                    if (node_type === 'string') {\r\n                        output.push(parse_tree[i]);\r\n                    }\r\n                    else if (node_type === 'array') {\r\n                        match = parse_tree[i]; // convenience purposes only\r\n                        if (match[2]) { // keyword argument\r\n                            arg = argv[cursor];\r\n                            for (k = 0; k < match[2].length; k++) {\r\n                                if (!arg.hasOwnProperty(match[2][k])) {\r\n                                    throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist', match[2][k]));\r\n                                }\r\n                                arg = arg[match[2][k]];\r\n                            }\r\n                        } else if (match[1]) { // positional argument (explicit)\r\n                            arg = argv[match[1]];\r\n                        }\r\n                        else { // positional argument (implicit)\r\n                            arg = argv[cursor++];\r\n                        }\r\n\r\n                        if (/[^s]/.test(match[8]) && (get_type(arg) != 'number')) {\r\n                            throw new Error(sprintf('[_.sprintf] expecting number but found %s', get_type(arg)));\r\n                        }\r\n                        switch (match[8]) {\r\n                            case 'b': arg = arg.toString(2); break;\r\n                            case 'c': arg = String.fromCharCode(arg); break;\r\n                            case 'd': arg = parseInt(arg, 10); break;\r\n                            case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\r\n                            case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\r\n                            case 'o': arg = arg.toString(8); break;\r\n                            case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\r\n                            case 'u': arg = Math.abs(arg); break;\r\n                            case 'x': arg = arg.toString(16); break;\r\n                            case 'X': arg = arg.toString(16).toUpperCase(); break;\r\n                        }\r\n                        arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);\r\n                        pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\r\n                        pad_length = match[6] - String(arg).length;\r\n                        pad = match[6] ? str_repeat(pad_character, pad_length) : '';\r\n                        output.push(match[5] ? arg + pad : pad + arg);\r\n                    }\r\n                }\r\n                return output.join('');\r\n            };\r\n\r\n            str_format.cache = {};\r\n\r\n            str_format.parse = function(fmt) {\r\n                var _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\r\n                while (_fmt) {\r\n                    if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\r\n                        parse_tree.push(match[0]);\r\n                    }\r\n                    else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\r\n                        parse_tree.push('%');\r\n                    }\r\n                    else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\r\n                        if (match[2]) {\r\n                            arg_names |= 1;\r\n                            var field_list = [], replacement_field = match[2], field_match = [];\r\n                            if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                                while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\r\n                                    if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                        field_list.push(field_match[1]);\r\n                                    }\r\n                                    else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\r\n                                        field_list.push(field_match[1]);\r\n                                    }\r\n                                    else {\r\n                                        throw new Error('[_.sprintf] huh?');\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                throw new Error('[_.sprintf] huh?');\r\n                            }\r\n                            match[2] = field_list;\r\n                        }\r\n                        else {\r\n                            arg_names |= 2;\r\n                        }\r\n                        if (arg_names === 3) {\r\n                            throw new Error('[_.sprintf] mixing positional and named placeholders is not (yet) supported');\r\n                        }\r\n                        parse_tree.push(match);\r\n                    }\r\n                    else {\r\n                        throw new Error('[_.sprintf] huh?');\r\n                    }\r\n                    _fmt = _fmt.substring(match[0].length);\r\n                }\r\n                return parse_tree;\r\n            };\r\n\r\n            return str_format;\r\n        })();\r\n\r\n        return {\r\n            copyProperty: copyProperty,\r\n            copy: copyProperty,\r\n            swapProperties: swapProperties,\r\n            swap: swapProperties,\r\n            convertToBoolean: convertToBoolean,\r\n            toBoolean: convertToBoolean,\r\n            toBool: convertToBoolean,\r\n            convertObjectIdsToString: convertObjectIdsToString,\r\n            OidToString: convertObjectIdsToString,\r\n            generateVerificationCode: generateVerificationCode,\r\n            vercode: generateVerificationCode,\r\n            goBack: goBack,\r\n            goBackAndSelect: goBackAndSelect,\r\n            scrollTo: scrollTo,\r\n            equalObjectIds: equalObjectIds,\r\n            eqOid: equalObjectIds,\r\n            notEqualObjectIds: notEqualObjectIds,\r\n            neqOid: notEqualObjectIds,\r\n            containsObjectId: containsObjectId,\r\n            hasOid: containsObjectId,\r\n            isObjectId: isObjectId,\r\n            // Strings functions. No analogues in lodash.strings\r\n            sampleLine: sampleLine,\r\n            hashCode: hashCode,\r\n            makeString: makeString,\r\n            getBrowser: getBrowser,\r\n            checkSupported: checkSupported,\r\n            sprintf: sprintf,\r\n            // Collection function. No analogues in lodash. It may be in lodash later. Look gitHub/lodash issue #1022\r\n            replaceBy: replaceBy\r\n        };\r\n        \r\n        //--------------------\r\n        function replaceBy(items, key, value, data) {\r\n            if (!items || !items.length)\r\n                return null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (items[i][key] == value) {\r\n                    items[i] = data;\r\n                    return;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Creates a sample line from a text\r\n        function sampleLine(value, maxLength) {\r\n            if (!value || value == '') return '';\r\n\r\n            var length = value.indexOf('\\n');\r\n            length = length >= 0 ? length : value.length;\r\n            length = length < maxLength ? value.length : maxLength;\r\n\r\n            return value.substring(0, length);\r\n        };\r\n\r\n        // Simple version of string hashcode\r\n        function hashCode(value) {\r\n            if (value == null) return 0;\r\n            var result = 0;\r\n            for (var i = 0; i < value.length; i++) {\r\n                result += value.charCodeAt(i);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Ensure some object is a coerced to a string\r\n        function makeString(object) {\r\n            if (object == null) return '';\r\n            return '' + object;\r\n        };\r\n\r\n        function isObjectId(value) {\r\n            var checkForHexRegExp = new RegExp(\"^[0-9a-fA-F]{24}$\");\r\n            return checkForHexRegExp.test(value);\r\n        }\r\n\r\n        // Compares two ObjectIds (they are not equal by '==')\r\n        function equalObjectIds(value1, value2) {\r\n            if (value1 == null && value2 == null)\r\n                return true;\r\n\r\n            if (value1 == null || value2 == null)\r\n                return false;\r\n\r\n            return value1.toString() == value2.toString();\r\n        };\r\n\r\n        // Compares two ObjectIds (they are always not equal by '!=')\r\n        function notEqualObjectIds(value1, value2) {\r\n            if (value1 == null && value2 == null)\r\n                return false;\r\n\r\n            if (value1 == null || value2 == null)\r\n                return true;\r\n\r\n            return value1.toString() != value2.toString();\r\n        };\r\n\r\n        // Checks if array contains concrete objectId\r\n        function containsObjectId(values, value) {\r\n            return _.some(values, function (value1) {\r\n                return equalObjectIds(value1, value);\r\n            });\r\n        };\r\n\r\n        // Copy property from one object to another if it exists (not null)\r\n        function copyProperty(dest, destProperty, orig, origProperty) {\r\n            // Shift if only 3 arguments set\r\n            if (_.isObject(destProperty)\r\n                && typeof (origProperty) == 'undefined') {\r\n                origProperty = orig;\r\n                orig = destProperty;\r\n                destProperty = origProperty;\r\n            }\r\n    \r\n            if (orig[origProperty] || (typeof (orig[origProperty]) === 'number' && orig[origProperty] % 1 == 0)) {\r\n                dest[destProperty] = orig[origProperty];\r\n                return true;\r\n            }\r\n    \r\n            return false;\r\n        };\r\n    \r\n        // Swaps values of two properties\r\n        function swapProperties(obj, prop1, prop2) {\r\n            var \r\n                temp1 = obj[prop1],\r\n                temp2 = obj[prop2];\r\n    \r\n            if (temp1) {\r\n                obj[prop2] = temp1;\r\n            }\r\n            else {\r\n                delete obj[prop2];\r\n            }\r\n    \r\n            if (temp2) {\r\n                obj[prop1] = temp2;\r\n            }\r\n            else {\r\n                delete obj[prop1];\r\n            }\r\n        };\r\n    \r\n        // Converts value into boolean\r\n        function convertToBoolean(value) {\r\n            if (value == null) return false;\r\n            if (!value) return false;\r\n            value = value.toString().toLowerCase();\r\n            return value == '1' || value == 'true';\r\n        };\r\n    \r\n        // Converts array of object ids to strings (for comparison)\r\n        function convertObjectIdsToString(values) {\r\n            return _.map(values, function (value) {\r\n                return value ? value.toString() : 0;\r\n            });\r\n        };\r\n\r\n        // Generates random big number for verification codes\r\n        function generateVerificationCode() {\r\n            return Math.random().toString(36).substr(2, 10).toUpperCase(); // remove `0.`\r\n        };\r\n\r\n        // Navigation\r\n        //-------------\r\n\r\n        function goBack() {\r\n            $window.history.back()\r\n        };\r\n\r\n        function goBackAndSelect(object, idParamName, objParamName) {\r\n            pipAssert.isDef(object, 'pipUtils.goBack: first argument should be defined');\r\n            pipAssert.isDef(idParamName, 'pipUtils.goBack: second argument should be defined');\r\n            pipAssert.isDef(objParamName, 'pipUtils.goBack: third argument should be defined');\r\n            pipAssert.isObject(object, 'pipUtils.goBack: first argument should be an object');\r\n            pipAssert.isString(idParamName, 'pipUtils.goBack: second argument should a string');\r\n            pipAssert.isString(objParamName, 'pipUtils.goBack: third argument should a string');\r\n                \r\n            if ($rootScope.$prevState && $rootScope.$prevState.name) {\r\n                var state = _.cloneDeep($rootScope.$prevState);\r\n\r\n                state.params[idParamName] = object.id;\r\n                state.params[objParamName] = object;\r\n\r\n                $state.go(state.name, state.params);\r\n            } else {\r\n                $window.history.back();\r\n            }\r\n        };\r\n\r\n        // Scrolling\r\n        //--------------\r\n        \r\n        function scrollTo(parentElement, childElement, animationDuration) {\r\n            if(!parentElement || !childElement) return;\r\n            if (animationDuration == undefined) animationDuration = 300;\r\n\r\n            setTimeout(function () {\r\n                if (!$(childElement).position()) return;\r\n                var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n                if (modDiff < 20) return;\r\n                var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n                if (animationDuration > 0)\r\n                    $(parentElement).animate({\r\n                        scrollTop: scrollTo + 'px'\r\n                    }, animationDuration);\r\n            }, 100);\r\n        };\r\n\r\n        // todo add support for iPhone\r\n        function getBrowser() {\r\n            var ua = $window.navigator.userAgent;\r\n\r\n            var bName = function () {\r\n                if (ua.search(/Edge/) > -1) return \"edge\";\r\n                if (ua.search(/MSIE/) > -1) return \"ie\";\r\n                if (ua.search(/Trident/) > -1) return \"ie11\";\r\n                if (ua.search(/Firefox/) > -1) return \"firefox\";\r\n                if (ua.search(/Opera/) > -1) return \"opera\";\r\n                if (ua.search(/OPR/) > -1) return \"operaWebkit\";\r\n                if (ua.search(/YaBrowser/) > -1) return \"yabrowser\";\r\n                if (ua.search(/Chrome/) > -1) return \"chrome\";\r\n                if (ua.search(/Safari/) > -1) return \"safari\";\r\n                if (ua.search(/Maxthon/) > -1) return \"maxthon\";\r\n            }();\r\n\r\n            var version;\r\n            switch (bName) {\r\n                case \"edge\":\r\n                    version = (ua.split(\"Edge\")[1]).split(\"/\")[1];\r\n                    break;\r\n                case \"ie\":\r\n                    version = (ua.split(\"MSIE \")[1]).split(\";\")[0];\r\n                    break;\r\n                case \"ie11\":\r\n                    bName = \"ie\";\r\n                    version = (ua.split(\"; rv:\")[1]).split(\")\")[0];\r\n                    break;\r\n                case \"firefox\":\r\n                    version = ua.split(\"Firefox/\")[1];\r\n                    break;\r\n                case \"opera\":\r\n                    version = ua.split(\"Version/\")[1];\r\n                    break;\r\n                case \"operaWebkit\":\r\n                    bName = \"opera\";\r\n                    version = ua.split(\"OPR/\")[1];\r\n                    break;\r\n                case \"yabrowser\":\r\n                    version = (ua.split(\"YaBrowser/\")[1]).split(\" \")[0];\r\n                    break;\r\n                case \"chrome\":\r\n                    version = (ua.split(\"Chrome/\")[1]).split(\" \")[0];\r\n                    break;\r\n                case \"safari\":\r\n                    version = (ua.split(\"Version/\")[1]).split(\" \")[0];\r\n                    break;\r\n                case \"maxthon\":\r\n                    version = ua.split(\"Maxthon/\")[1];\r\n                    break;\r\n            }\r\n\r\n            var platform = 'desktop';\r\n            if (/iphone|ipad|ipod|android|blackberry|mini|windows\\sce|palm/i.test(ua.toLowerCase())) platform = 'mobile';\r\n\r\n            var os;\r\n            try {\r\n                var osAll = (/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(ua.toLowerCase()) || [u])[0].replace('sunos', 'solaris'),\r\n                    osAndroid = (/(android)/.exec(ua.toLowerCase()) || '');\r\n                    os = osAndroid && (osAndroid == 'android' || (osAndroid[0] == 'android')) ? 'android' : osAll;\r\n            } catch (err) {\r\n                os = 'unknown'\r\n            }\r\n\r\n            var browsrObj;\r\n\r\n            try {\r\n                browsrObj = {\r\n                    platform: platform,\r\n                    browser: bName,\r\n                    versionFull: version,\r\n                    versionShort: version.split(\".\")[0],\r\n                    os: os\r\n                };\r\n            } catch (err) {\r\n                browsrObj = {\r\n                    platform: platform,\r\n                    browser: 'unknown',\r\n                    versionFull: 'unknown',\r\n                    versionShort: 'unknown',\r\n                    os: 'unknown'\r\n                };\r\n            }\r\n\r\n            return browsrObj;\r\n        }\r\n\r\n        // todo нужны каке нибудь настройки?\r\n        function checkSupported(supported) {\r\n            if (!supported) supported = {\r\n                edge: 11,\r\n                ie: 11,\r\n                firefox: 43, //4, for testing\r\n                opera: 35,\r\n                chrome: 47\r\n            };\r\n\r\n            var systemInfo = getBrowser();\r\n\r\n            if (systemInfo && systemInfo.browser && supported[systemInfo.browser]){\r\n                if (systemInfo.versionShort >= supported[systemInfo.browser]) return true;\r\n            }\r\n            return true;\r\n\r\n        };\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file String utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Move functions to general utilities\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.Strings', []);\r\n\r\n    thisModule.factory('pipStrings', function () {\r\n        var strings = {};\r\n\r\n        // Creates a sample line from a text\r\n        strings.sampleLine = function (value, maxLength) {\r\n            if (!value || value == '') return '';\r\n    \r\n            var length = value.indexOf('\\n');\r\n            length = length >= 0 ? length : value.length;\r\n            length = length < maxLength ? value.length : maxLength;\r\n    \r\n            return value.substring(0, length);\r\n        };\r\n    \r\n        // Simple version of string hashcode\r\n        strings.hashCode = function (value) {\r\n            if (value == null) return 0;\r\n            var result = 0;\r\n            for (var i = 0; i < value.length; i++) {\r\n                result += value.charCodeAt(i);\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        return strings;\r\n    });\r\n\r\n})();","/**\r\n * @file Search tag utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUtils.Tags', []);\r\n\r\n    thisModule.factory('pipTags', function () {\r\n        var tags = {};\r\n        \r\n        var HASHTAG_REGEX = /#\\w+/g;\r\n    \r\n        var normalizeTag = function (tag) {\r\n            return tag \r\n                ? _.trim(tag.replace(/(_|#)+/g, ' '))\r\n                : null;\r\n        };\r\n        tags.normalizeTag = normalizeTag;\r\n    \r\n        var compressTag = function (tag) {\r\n            return tag\r\n                ? tag.replace(/( |_|#)/g, '').toLowerCase()\r\n                : null;\r\n        };\r\n        tags.compressTag = compressTag;\r\n    \r\n        var equalTags = function (tag1, tag2) {\r\n            if (tag1 == null && tag2 == null)\r\n                return true;\r\n            if (tag1 == null || tag2 == null)\r\n                return false;\r\n            return compressTag(tag1) == compressTag(tag2);\r\n        };\r\n        tags.equalTags = equalTags;\r\n    \r\n        var normalizeTags = function (tags) {\r\n            if (_.isString(tags)) {\r\n                tags = tags.split(/( |,|;)+/);\r\n            }\r\n    \r\n            tags = _.map(tags, function (tag) {\r\n                return normalizeTag(tag);\r\n            });\r\n    \r\n            return tags;\r\n        };\r\n        tags.normalizeTags = normalizeTags;\r\n    \r\n        var compressTags = function (tags) {\r\n            if (_.isString(tags)) {\r\n                tags = tags.split(/( |,|;)+/);\r\n            }\r\n    \r\n            tags = _.map(tags, function (tag) {\r\n                return compressTag(tag);\r\n            });\r\n    \r\n            return tags;\r\n        };\r\n        tags.compressTags = compressTags;\r\n    \r\n        var extractTags = function (entity, searchFields) {\r\n            var tags = normalizeTags(entity.tags);\r\n    \r\n            _.each(searchFields, function (field) {\r\n                var text = entity[field] || '';\r\n    \r\n                if (text != '') {\r\n                    var hashTags = text.match(HASHTAG_REGEX);\r\n                    tags = tags.concat(normalizeTags(hashTags));\r\n                }\r\n            });\r\n    \r\n            return _.uniq(tags);\r\n        };\r\n        tags.extractTags = extractTags;\r\n\r\n        return tags;\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Collection of utilities\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipUtils', \r\n\t\t['pipUtils.General', 'pipUtils.Strings', 'pipUtils.Dates', 'pipUtils.Tags', 'pipUtils.Collections', 'pipUtils.FormErrors']);\r\n})();\r\n","/**\r\n * @file Global application data cache\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipDataCache', ['pipDataModel']);\r\n\r\n    thisModule.provider('pipDataCache', function() {\r\n        var \r\n            CACHE_TIMEOUT = 5 * 60000, // 5 mins or make it configurable\r\n            cache = {};\r\n            \r\n        this.timeout = timeout;\r\n            \r\n        this.$get = ['$q', 'pipDataModel', function($q, pipDataModel) {\r\n            return {\r\n                timeout: timeout,\r\n                \r\n                clear: clear,\r\n                retrieve: retrieve,\r\n                retrieveOrLoad: retrieveOrLoad,\r\n                store: store,\r\n                storePermanent: storePermanent,\r\n                remove: remove,\r\n\r\n                addItem: addItem,\r\n                updateItem: updateItem,\r\n                removeItem: removeItem,\r\n                \r\n                addDecorator: addDecorator,\r\n                updateDecorator: updateDecorator,\r\n                removeDecorator: removeDecorator\r\n            };\r\n            //-------------\r\n            \r\n            // Clear the entire cache\r\n            function clear() {\r\n                cache = {};\r\n            };\r\n\r\n            // Try to retrieve collection from the cache\r\n            function retrieve(name) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (name == '') throw new Error('name cannot be empty');\r\n\r\n                var holder = cache[name];\r\n                if (holder == null) return null;\r\n\r\n                // If expired then cleanup and return null\r\n                if (holder.expire \r\n                    && _.now() - holder.expire > CACHE_TIMEOUT) {\r\n                    delete cache[name];\r\n                    return null;\r\n                }\r\n\r\n                return holder.data;\r\n            };\r\n\r\n            // Store collection into the cache\r\n            function store(name, data) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (name == '') throw new Error('name cannot be empty');\r\n\r\n                cache[name] = {\r\n                    expire: _.now(),\r\n                    data: data\r\n                };\r\n            };\r\n\r\n            // Store collection into the cache without expiration\r\n            function storePermanent(name, data) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (name == '') throw new Error('name cannot be empty');\r\n\r\n                cache[name] = {\r\n                    expire: null,\r\n                    data: data\r\n                };\r\n            };\r\n\r\n            // Remove collection from the cache\r\n            function remove(name) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (name == '') throw new Error('name cannot be empty');\r\n\r\n                delete cache[name];\r\n            };\r\n\r\n            // Tries to retrieve collection from the cache, otherwise load it from server\r\n            function retrieveOrLoad(params, successCallback, errorCallback) {\r\n                if (params == null) throw new Error('params cannot be null');\r\n                // todo add check params?\r\n\r\n                var name = (params.cache || params.resource);\r\n                if (params && params.party_id !== null && params.party_id !== undefined)\r\n                    name = name + '_' + params.party_id;\r\n                else if (params && params.item && params.item.party_id !== null && params.item.party_id !== undefined)\r\n                    name = name + '_' + params.item.party_id;\r\n\r\n                // Retrieve data from cache\r\n                var filter = params.filter,\r\n                    force = !!params.force,\r\n                    result = !force ? retrieve(name) : null;\r\n\r\n                // Return result if it exists\r\n                if (result) {\r\n                    //console.log('***** Loaded from cache ' + name);\r\n                    //console.log(result);\r\n                    if (filter) result = filter(result);\r\n                    if (successCallback) successCallback(result);\r\n                    return result;\r\n                }\r\n\r\n                // Create deferred\r\n                var deferred = $q.defer();\r\n\r\n                // Load data from server\r\n                pipDataModel[params.singleResult ? 'readOne' : 'read'](\r\n                    params, \r\n                    function (data) {\r\n                        // Store data in cache and return\r\n                        params.singleResult ? updateItem(name,data) : store(name, data);\r\n                        if (filter) data = filter(data);\r\n                        deferred.resolve(data);\r\n\r\n                    //console.log('***** Loaded from server ' + name);\r\n                    //console.log(data);\r\n\r\n                        if (successCallback) successCallback(data);\r\n                    },\r\n                    function (err) {\r\n                        // Return error\r\n                        deferred.reject(err);\r\n                        if (errorCallback) errorCallback(err);\r\n                    }\r\n                );\r\n\r\n                // Return deferred object\r\n                return deferred.promise;\r\n            };\r\n\r\n            // todo if item exist in nameSpace?\r\n            function addItem(name, params, item) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (item == null) return;\r\n\r\n                var data = retrieve(name);\r\n\r\n                if (data == null)  data = []; // todo maybe reload cache data?\r\n                var index = -1;\r\n                for (var i = 0; i < data.length; i++) {\r\n                    if (data[i].id == item.id) {\r\n                        index = i;\r\n                        break;\r\n                    }\r\n                }\r\n                if (index == -1) data.push(item);\r\n                else data[i] = item;\r\n                store(name, data);\r\n            };\r\n\r\n            function addDecorator(resource, params, successCallback) {\r\n                return function(item) {\r\n                    var  nameId, name;\r\n                    if (params && params.party_id) nameId = '_' + params.party_id;\r\n                    else if (params && params.item && params && params.item.party_id) nameId = '_' + params.item.party_id;\r\n                        name = resource + nameId;\r\n\r\n                    updateItem(name, params, item);\r\n\r\n                    if (successCallback) successCallback(item);\r\n                };\r\n            };\r\n\r\n            function updateItem(name, params, item) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (item == null) return;\r\n\r\n                var data = retrieve(name);\r\n\r\n                if (data != null) {\r\n                    var isAdded = false;\r\n                    for (var i = 0; i < data.length; i++) {\r\n                        if (data[i].id == item.id) {\r\n                            data[i] = item;\r\n                            isAdded = true;\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (!isAdded) data.push(item);\r\n                    store(name, data);\r\n                }\r\n            };\r\n\r\n            function updateDecorator(resource, params, successCallback) {\r\n                return function(item) {\r\n                    var  nameId, name;\r\n                    if (params && params.party_id) nameId = '_' + params.party_id;\r\n                    else if (params && params.item && params && params.item.party_id) nameId = '_' + params.item.party_id;\r\n                    name = resource + nameId;\r\n\r\n                    updateItem(name, params, item);\r\n\r\n                    if (successCallback) successCallback(item);\r\n                };\r\n            };\r\n\r\n            function removeItem(name, params, item) {\r\n                if (name == null) throw new Error('name cannot be null');\r\n                if (item == null) return;\r\n\r\n                var data = retrieve(name);\r\n\r\n                if (data == null) return;\r\n\r\n                // delete item\r\n                for (var i = 0; i < data.length; i++) {\r\n                    if (data[i].id == item.id) {\r\n                        data.splice(i, 1);\r\n                        i--;\r\n                    }\r\n                }\r\n                store(name, data);\r\n            };\r\n\r\n            function removeDecorator(resource, params, successCallback) {\r\n                return function(item) {\r\n                    var  nameId, name;\r\n                    if (params && params.party_id) nameId = '_' + params.party_id;\r\n                    else if (params && params.item && params && params.item.party_id) nameId = '_' + params.item.party_id;\r\n                    name = resource + nameId;\r\n\r\n                        removeItem(name, params, params.item);\r\n                    if (successCallback) successCallback(item);\r\n                };\r\n            };\r\n\r\n        }];\r\n        //-----------------------\r\n\r\n        function timeout(newTimeout) {\r\n            if (newTimeout)\r\n                CACHE_TIMEOUT = newTimeout;\r\n            return CACHE_TIMEOUT;  \r\n        };\r\n        \r\n    });\r\n\r\n})();\r\n\r\n","/**\r\n * @file Session data cache\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSessionCache', ['pipCore', 'pipRest', 'pipDataCache']);\r\n\r\n    thisModule.run(['$rootScope', 'pipSessionCache', function($rootScope, pipSessionCache) {\r\n        $rootScope.$on('pipSessionOpened', pipSessionCache.init);\r\n        $rootScope.$on('pipSessionClosed', pipSessionCache.clear);\r\n    }]);\r\n\r\n    thisModule.service('pipSessionCache',\r\n        ['$rootScope', '$stateParams', 'pipTranslate', 'pipRest', 'localStorageService', 'pipAccess', 'pipEnums', 'pipSession', 'pipDataCache', function($rootScope, $stateParams, pipTranslate, pipRest, localStorageService,\r\n            pipAccess, pipEnums, pipSession, pipDataCache) {\r\n                        \r\n            return {\r\n                init: init,\r\n                clear: clear,\r\n                \r\n                readUser: readUser,\r\n\t\t\t\treadParty: readParty,\r\n\t\t\t\treadConnection: readConnection,\r\n                \r\n                readSettings: readSettings,\r\n                onSettingsUpdate: onSettingsUpdate\r\n            };\r\n            //-------------\r\n\r\n            function init(event, data) {\r\n                if (data == null)\r\n                    throw new Error('Unexpected error: issues in openning session');\r\n                \r\n                clear();\r\n                if (data.serverUrl) $rootScope.$serverUrl = data.serverUrl;\r\n                storeUser(data.user, null);\r\n            };\r\n\r\n            function clear() {\r\n                // Clear data cache\r\n                pipDataCache.clear();\r\n                \r\n                // Clear global variables\r\n                delete $rootScope.$user;\r\n                delete $rootScope.$party;\r\n                delete $rootScope.$serverUrl;\r\n                delete $rootScope.$connection;\r\n                delete $rootScope.$settings;\r\n            };\r\n\r\n            function updateUserRights(user, party) {\r\n                // Get parameters from cache if they are not defined\r\n                user = user || pipDataCache.retrieve('user');\r\n                party = party || pipDataCache.retrieve('party');\r\n                \r\n                // Exit if user is not defined\r\n                if (user == null) return;\r\n\r\n                // Update user access rights\r\n                if (party == null) \r\n                    user = pipAccess.asOwner(user);\r\n                else if (user.id == party.id)\r\n                    user = pipAccess.asOwner(user);\r\n                else \r\n                    user = pipAccess.toParty(user, party);\r\n                    \r\n                // Save user with new rights back to cache\r\n                pipDataCache.storePermanent('user', user);\r\n                $rootScope.$user = user;\r\n            };\r\n\r\n            function storeUserTheme(user) {\r\n                if (!user) return;\r\n                var userTheme = user.theme || 'blue';\r\n\r\n                if (user && $rootScope.$party) {\r\n                    if ($rootScope.$party.id == user.id) userTheme = user.theme;\r\n                    else userTheme = 'navy';\r\n                }\r\n\r\n                $rootScope.$theme = userTheme;\r\n                localStorageService.set('theme', userTheme);\r\n            };\r\n\r\n            function storeUser(user) {\r\n                if (user == null) return;                  \r\n\r\n                pipDataCache.storePermanent('user', user);\r\n                $rootScope.$user = user;\r\n                storeUserTheme(user);\r\n                \r\n                // Activate user language\r\n                pipTranslate.use(user.language, false, true);\r\n                updateUserRights(user, null);\r\n            };\r\n\r\n            function readUser(successCallback, errorCallback) {\r\n                // Avoid broken session\r\n                if (!pipSession.opened()) \r\n                    throw new Error('User is not authenticated.');\r\n    \r\n                var \r\n                    userId = pipSession.userId(),\r\n                    user = pipDataCache.retrieve('user');\r\n    \r\n                // Return user from cache    \r\n                if (user) {\r\n                    if (user.id != userId)\r\n                        throw new Error('Unexpected error: issues in openning session');\r\n                        \r\n                    if (successCallback) successCallback(user);\r\n                        \r\n                    return user;\r\n                }\r\n    \r\n                // Read user from server\r\n                return pipRest.users().get(\r\n                    { id: userId }, \r\n                    function (user) {\r\n                        // Double check\r\n                        if (user.id != userId) \r\n                            user == null;\r\n\r\n                        storeUser(user);\r\n\r\n                        if (successCallback) successCallback(use);\r\n                    },\r\n                    errorCallback\r\n                ).$promise;\r\n            };\r\n\r\n            function readParty(stateParams, successCallback, errorCallback) {\r\n                // Avoid broken session\r\n                if (!pipSession.opened())\r\n                    throw new Error('User is not authenticated.');\r\n\r\n                var\r\n                    userId = pipSession.userId(),\r\n                    partyId = stateParams.party_id || userId,\r\n                    party = pipDataCache.retrieve('party');\r\n\r\n                // Skip if party already retrieved\r\n                if (party && party.id == partyId) {\r\n                    $rootScope.$party = party;\r\n\r\n                    storeUserTheme($rootScope.$user);\r\n\r\n                    if (successCallback) successCallback(party);\r\n                    return party;\r\n                }\r\n\r\n                // Read party from server\r\n                return pipRest.parties().get(\r\n                    { id: partyId },\r\n                    function (party) {\r\n                        updateUserRights(null, party);\r\n                        pipDataCache.storePermanent('party', party);\r\n                        $rootScope.$party = party;\r\n\r\n                        storeUserTheme($rootScope.$user);\r\n\r\n                        if (successCallback) successCallback(party);\r\n                    },\r\n                    errorCallback\r\n                ).$promise;\r\n            };\r\n\r\n            function readConnection(stateParams, successCallback, errorCallback) {\r\n                // Avoid broken session\r\n                if (!pipSession.opened()) \r\n                    throw new Error('User is not authenticated.');\r\n    \r\n                var \r\n                    userId = pipSession.userId(),\r\n                    partyId = stateParams.party_id || userId,\r\n                    connection = pipDataCache.retrieve('connection');\r\n\r\n                // Clear connection it does not match user or party\r\n                if (connection \r\n                    && (connection.party_id != userId\r\n                    || connection.to_party_id != partyId)) {\r\n                    connection = null;\r\n                    pipDataCache.remove('connection');\r\n                    delete $rootScope.$connection;\r\n                }\r\n    \r\n                // For owner connection is not defined\r\n                if (userId == partyId) {\r\n                    if (successCallback) successCallback(connection);\r\n                        \r\n                    return connection;\r\n                }\r\n        \r\n                // Read connection from server\r\n                return pipRest.connections().query(\r\n                    { \r\n                        party_id: userId, \r\n                        to_party_id: partyId, \r\n                        accept: pipEnums.ACCEPTANCE.ACCEPTED \r\n                    }, \r\n                    function (connections) {\r\n                        // There are shall not be more than one active connection\r\n                        if (connections && connections.length > 0) \r\n                            connection = connections[0];                            \r\n                        else connection = null;\r\n\r\n                        pipDataCache.storePermanent('connection', connection);\r\n                        $rootScope.$connection = connection;\r\n                                                                                        \r\n                        if (successCallback) successCallback(connection);\r\n                    },\r\n                    errorCallback\r\n                ).$promise;\r\n            };\r\n\r\n            function readSettings(successCallback, errorCallback) {\r\n                // Avoid broken session\r\n                if (!pipSession.opened())\r\n                    throw new Error('User is not authenticated.');\r\n                var\r\n                    userId = pipSession.userId(),\r\n                    settings = pipDataCache.retrieve('settings' + '_' + userId);\r\n\r\n                if (settings) {\r\n                    if (successCallback) successCallback(settings);\r\n\r\n                    return settings;\r\n                }\r\n\r\n                // Read settings from server\r\n                return pipRest.partySettings().get(\r\n                    {\r\n                        party_id: userId\r\n                    },\r\n                    function (settings) {\r\n                        settings = settings || {};\r\n                        pipDataCache.storePermanent('settings' + '_' + userId, settings);\r\n                        $rootScope.$settings = settings;\r\n\r\n                        if (successCallback) successCallback(settings);\r\n                    },\r\n                    errorCallback\r\n                ).$promise;\r\n            };\r\n\r\n            function onSettingsUpdate(item, successCallback) {\r\n                // return function(item) {\r\n                if (item == null) return;\r\n\r\n                var userId = pipSession.userId(),\r\n                    settings = pipDataCache.retrieve('settings' + '_' + userId);\r\n\r\n                // If tags are stored\r\n                if (settings) {\r\n                    settings = _.extend(settings, item);\r\n                    pipDataCache.storePermanent('settings' + '_' + userId, settings);\r\n                    $rootScope.$settings = settings;\r\n                }\r\n\r\n                if (successCallback) successCallback(item);\r\n                //  };\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Tags data cache\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTagsCache', ['pipUtils', 'pipDataCache']);\r\n\r\n    thisModule.service('pipTagsCache',\r\n        ['pipTags', 'pipDataCache', function(pipTags, pipDataCache) {\r\n            return {\r\n                readTags: readTags,\r\n                // Todo: Add updateTags method\r\n                onTagsUpdate: onTagsUpdate,\r\n                tagsUpdateDecorator: tagsUpdateDecorator\r\n            };\r\n\t\t\t//------------------------------\r\n\r\n            function tagsUpdate(params, item) {\r\n                // Extract tag from updated entity\r\n                var tags = item ? pipTags.extractTags(item) : [];\r\n                if (tags.length == 0) return;\r\n\r\n                var cacheName = 'partyTags';\r\n                if (params && params.party_id !== null && params.party_id !== undefined)\r\n                    cacheName = cacheName + '_' + params.party_id;\r\n                else if (params && params.item && params.item.party_id !== null && params.item.party_id !== undefined)\r\n                    cacheName = cacheName + '_' + params.item.party_id;\r\n\r\n                // Todo: this is a wrong way to get party_id (contributor) from entities\r\n                var data = pipDataCache.retrieve(cacheName);\r\n\r\n                // If tags are stored\r\n                if (data) {\r\n                    _.each(tags, function(tag) {\r\n                        // Find if tag already exists\r\n                        var t = _.find(data.tags, function(t) {\r\n                            return pipTags.equalTags(t.tag, tag);\r\n                        });\r\n\r\n                        // Otherwise add a new tag\r\n                        if (t) {\r\n                            t.tag = tag;\r\n                            t.count = t.count + 1;\r\n                            t.used = new Date();\r\n                        } else {\r\n                            if (!data.tags)\r\n                                data.tags = [];\r\n\t\t\t\t\t\t\t\t\r\n                            data.tags.push({\r\n                                tag: tag,\r\n                                count: 1,\r\n                                used: new Date()\r\n                            });\r\n                        }\r\n                    });\r\n                    pipDataCache.store(cacheName, data);\r\n                }\r\n            };\r\n\r\n            function tagsUpdateDecorator(params, successCallback) {\r\n                return function(item) {\r\n                    tagsUpdate(params, item);\r\n\r\n                    if (successCallback) successCallback(item);\r\n                };\r\n            };\r\n\r\n\t\t\tfunction readTags(params, successCallback, errorCallback) {\r\n\t\t\t\tparams.resource = 'partyTags';\r\n\t\t\t\tparams.singleResult = true;\r\n\r\n\t\t\t\treturn pipDataCache.retrieveOrLoad(params, successCallback, errorCallback);\r\n\t\t\t};\r\n\r\n\t\t\t// Todo: Add updateTags method\r\n\r\n\t\t\tfunction onTagsUpdate(params, successCallback) {\r\n\t\t\t\treturn tagsUpdateDecorator(params, successCallback);\r\n\t\t\t};\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file User access permissions service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipRest.Access', ['pipUtils', 'pipRest.Enums']);\r\n\r\n    thisModule.factory('pipAccess', ['pipUtils', 'pipEnums', function (pipUtils, pipEnums) {\r\n\r\n        function defaultAccess(account) {\r\n            // Clone and set default values\r\n            var user = _.defaults(\r\n                {\r\n                    // Fix id\r\n                    id: account.id || account._id,\r\n                    party_id: null,\r\n                    party_name: null,\r\n                    type: null,\r\n                    owner: false,\r\n                    manager: false,\r\n                    contributor: false,\r\n                    share_level: pipEnums.SHARE_LEVEL.WORLD\r\n                },\r\n                account\r\n            );\r\n    \r\n            delete user._id;\r\n    \r\n            return user;\r\n        };\r\n    \r\n        function fixAccess(user) {\r\n            // Owner acts as his own manager\r\n            user.manager = user.manager || user.owner;\r\n    \r\n            // Manager has contributor rights\r\n            user.contributor = user.contributor || user.manager;\r\n    \r\n            // Managers and contributors can access at private level\r\n            if (user.contributor)\r\n                user.share_level = pipEnums.SHARE_LEVEL.PRIVATE;\r\n    \r\n            return user;\r\n        }\r\n    \r\n        function overrideAccess(user, access) {\r\n            // Copy over override\r\n            user.party_id = access.party_id;\r\n            user.party_name = access.party_name;\r\n            user.type = access.type;\r\n            user.owner = !!access.owner;\r\n            user.manager = !!access.manager;\r\n            user.contributor = !!access.contributor;\r\n            user.share_level = access.share_level || pipEnums.SHARE_LEVEL.WORLD;\r\n    \r\n            // Party can be set as an object\r\n            if (access.party) {\r\n                user.party_id = access.party.id || access.party._id;\r\n                user.party_name = access.party.name;\r\n            }\r\n    \r\n            // Make access settings consistent and return\r\n            return fixAccess(user);\r\n        };\r\n    \r\n        function asOwner(account) {\r\n            // Skip if no account set\r\n            if (account == null) return undefined;\r\n    \r\n            // Construct default user\r\n            var user = defaultAccess(account);\r\n    \r\n            // Set owner access rights\r\n            user.party_id = user.id;\r\n            user.party_name = user.name;\r\n            user.type = null;\r\n            user.owner = true;\r\n            user.manager = true;\r\n            user.contributor = true;\r\n            user.share_level = pipEnums.SHARE_LEVEL.PRIVATE;\r\n    \r\n            return user;\r\n        };\r\n    \r\n        function toParty(account, party) {\r\n            // Skip if no account set\r\n            if (account == null) return undefined;\r\n    \r\n            // If no party set then assume owner access\r\n            if (party == null) return asOwner(account);\r\n    \r\n            var \r\n                userId = account.id || account._id,\r\n                partyId = party.id || party._id || party,\r\n                partyName = party.name || account.name;\r\n    \r\n            // If user and party are the same then\r\n            if (userId == partyId) return asOwner(account);\r\n    \r\n            // Set default values\r\n            var user = defaultAccess(account);\r\n            user.party_id = partyId;\r\n            user.party_name = partyName;\r\n    \r\n            // Identify maximum access level\r\n            _.each(user.party_access, function (access) {\r\n                if (pipUtils.equalObjectIds(partyId, access.party_id)) {\r\n                    user.party_name = access.party_name;\r\n                    user.type = access.type;\r\n                    user.manager = user.manager || access.manager;\r\n                    user.contributor = user.contributor || access.contributor;\r\n                    user.share_level = Math.max(user.share_level, access.share_level);\r\n                }\r\n            });\r\n    \r\n            // Make access settings consistent and return\r\n            return fixAccess(user);\r\n        };\r\n    \r\n        // Can be used for testing\r\n        function override(account, access) {\r\n            // Skip if no account set\r\n            if (account == null) return undefined;\r\n    \r\n            // Set default values\r\n            var user = defaultAccess(account);\r\n    \r\n            // If no override return plain user\r\n            if (access) overrideAccess(user, access);\r\n    \r\n            return user;\r\n        };\r\n    \r\n        // Can be used for testing\r\n        function toPartyWithOverride(account, party, access) {\r\n            var user = toParty(account, party);\r\n    \r\n            // If no override return plain user\r\n            if (access) overrideAccess(user, access);\r\n    \r\n            return user;\r\n        };\r\n        \r\n        return {\r\n            asOwner: asOwner,\r\n            toParty: toParty,\r\n            override: override,\r\n            toPartyWithOverride: toPartyWithOverride\r\n        };\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Application secure router\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n    \r\n    var thisModule = angular.module('pipRest.State', ['pipState', 'pipRest.Session', 'pipRest.Access', 'pipSessionCache']);\r\n\r\n    thisModule.config(\r\n        ['$locationProvider', '$httpProvider', function($locationProvider, $httpProvider) {\r\n            // Attach interceptor to react on unauthorized errors\r\n            $httpProvider.interceptors.push('pipAuthHttpResponseInterceptor');\r\n        }]\r\n    );\r\n\r\n    thisModule.run(\r\n        ['$rootScope', 'pipState', 'pipSession', 'pipAuthState', function($rootScope, pipState, pipSession, pipAuthState) {\r\n\r\n            // Intercept routes\r\n            $rootScope.$on('$stateChangeStart', stateChangeStart);\r\n            // Process unauthorized access error\r\n            $rootScope.$on('pipUnauthorizedRedirect', unauthorizedRedirect);\r\n            // Handle other errors\r\n            $rootScope.$on('pipMaintenanceError', maintenanceError);\r\n            $rootScope.$on('pipNoConnectionError', noConnectionError);\r\n            $rootScope.$on('pipMissingRouteError', missingRouteError);\r\n            $rootScope.$on('pipUnknownError', unknownError);\r\n\r\n            function stateChangeStart(event, toState, toParams, fromState, fromParams) {\r\n                // Implement redirect mechanism\r\n                if (pipAuthState.redirect(event, toState, toParams, $rootScope)) {\r\n                    return;\r\n                }\r\n\r\n                // todo apply in all tool\r\n                // If user is not authorized then switch to signin\r\n                if ((toState.auth  || toState.auth === undefined) && !pipSession.opened()) {\r\n                    event.preventDefault();\r\n\r\n                    var redirectTo = pipState.href(toState.name, toParams);\r\n\r\n                    // Remove hashtag\r\n                    if (redirectTo.length > 0 && redirectTo[0] == '#') {\r\n                        redirectTo = redirectTo.substring(1);\r\n                    }\r\n\r\n                    pipAuthState.goToSignin({ redirect_to: redirectTo, toState: toState, toParams: toParams});\r\n\r\n                    return;\r\n                }\r\n\r\n                // Signout and move to unauthorized page\r\n                if (toState.name == pipAuthState.signoutState()) {\r\n                    event.preventDefault();\r\n                    pipSession.signout();\r\n                    pipAuthState.goToUnauthorized({});\r\n                    return;\r\n                }\r\n\r\n                // Move user to authorized page\r\n                if (toState.name == pipAuthState.unauthorizedState()\r\n                    && pipSession.opened()) {\r\n\r\n                    event.preventDefault();\r\n                    pipAuthState.goToAuthorized({});\r\n                    return;\r\n                }\r\n            }\r\n\r\n            function unauthorizedRedirect(event, params) {\r\n                pipSession.close();\r\n                pipAuthState.goToSignin(params);\r\n            }\r\n\r\n            function maintenanceError(event, params) {\r\n                pipAuthState.goToErrors('errors_maintenance', params);\r\n            }\r\n\r\n            function noConnectionError(event, params) {\r\n                pipAuthState.goToErrors('errors_no_connection', params);\r\n            }\r\n\r\n            function missingRouteError(event, params) {\r\n                pipAuthState.goToErrors('errors_missing_route', params);\r\n            }\r\n\r\n            function unknownError(event, params) {\r\n                pipAuthState.goToErrors('errors_unknown', params);\r\n            }\r\n\r\n        }]\r\n    );\r\n\r\n    thisModule.factory('pipAuthHttpResponseInterceptor',\r\n        ['$q', '$location', '$rootScope', function ($q, $location, $rootScope) {\r\n            return {\r\n                response: function (response) {\r\n                    // When server sends Non-authenticated response\r\n                    if (response.status === 401) {\r\n                        console.error(\"Response 401\");\r\n                    }                    \r\n                    return response || $q.when(response);\r\n                },\r\n                \r\n                responseError: function (rejection) {\r\n\r\n\r\n                    var toState = $rootScope.$state && $rootScope.$state.name ? $rootScope.$state.name : null,\r\n                        toParams = $rootScope.$state && $rootScope.$state.params ? $rootScope.$state.params : null;\r\n                    // When server sends Non-authenticated response\r\n                    switch (rejection.status) {\r\n                        case 401:\r\n                        case 440:\r\n                            console.error(\"Response Error 401\", rejection);\r\n                            // Redirect to unauthorized state\r\n                            $rootScope.$emit('pipUnauthorizedRedirect', {\r\n                                redirect_to:  toState && toParams && toParams.redirect_to ? '': $location.url(),\r\n                                toState: toState,\r\n                                toParams: toParams\r\n                            });\r\n\r\n                            break;\r\n                        case 503:\r\n                             //available (maintenance)\r\n                            $rootScope.$emit('pipMaintenanceError', {\r\n                                error: rejection\r\n                            });\r\n\r\n                            console.error(\"errors_maintenance\", rejection);\r\n                            break;\r\n                        case -1:\r\n                            //$rootScope.$emit('pipNoConnectionError', {\r\n                            //    error: rejection\r\n                            //});\r\n\r\n                            console.error(\"errors_no_connection\", rejection);\r\n                            break;\r\n                        default:\r\n                            // unhandled error (internal)\r\n                            //var code = rejection.code || (rejection.data || {}).code || null;\r\n                            //\r\n                            //// if not our server error generate errorEvent\r\n                            //if (!code) {\r\n                            //    $rootScope.$emit('pipUnknownError', {\r\n                            //        error: rejection\r\n                            //    });\r\n                            //}\r\n\r\n                            console.error(\"errors_unknown\", rejection);\r\n                            break;\r\n                    }\r\n\r\n                    return $q.reject(rejection);\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n    thisModule.provider('pipAuthState', ['pipStateProvider', function(pipStateProvider) {\r\n        // Configuration of redirected states\r\n        userResolver.$inject = ['pipSessionCache'];\r\n        partyResolver.$inject = ['pipSessionCache', '$stateParams'];\r\n        connectionResolver.$inject = ['pipSessionCache', '$stateParams'];\r\n        settingsResolver.$inject = ['pipSessionCache'];\r\n        var \r\n            signinState = null,\r\n            signoutState = null,\r\n            authorizedState = '/',\r\n            unauthorizedState = '/';\r\n\r\n        this.signinState = setSigninState;\r\n        this.signoutState = setSignoutState;\r\n        this.authorizedState = setAuthorizedState;\r\n        this.unauthorizedState = setUnauthorizedState;\r\n\r\n        this.redirect = pipStateProvider.redirect;\r\n        this.state = stateOverride;\r\n\r\n        this.$get = ['pipState', function (pipState) {            \r\n            pipState.signinState = function() { return signinState; };\r\n            pipState.signoutState = function() { return signoutState; };\r\n            pipState.authorizedState = function() { return authorizedState; };            \r\n            pipState.unauthorizedState = function() { return unauthorizedState; };\r\n            \r\n            pipState.goToErrors = function(toState, params) {\r\n                if (toState == null)\r\n                    throw new Error('Error state was not defined');\r\n\r\n                pipState.go(toState, params);\r\n            };\r\n\r\n            pipState.goToSignin = function(params) {\r\n                if (signinState == null)\r\n                    throw new Error('Signin state was not defined');\r\n\r\n                pipState.go(signinState, params);\r\n            };\r\n\r\n            pipState.goToSignout = function(params) {\r\n                if (signoutState == null)\r\n                    throw new Error('Signout state was not defined');\r\n                    \r\n                pipState.go(signoutState, params);  \r\n            };\r\n\r\n            pipState.goToAuthorized = function(params) {\r\n                if (authorizedState == null)\r\n                    throw new Error('Authorized state was not defined');\r\n                                        \r\n                pipState.go(authorizedState, params);\r\n            };\r\n\r\n            pipState.goToUnauthorized = function(params) {\r\n                if (unauthorizedState == null)\r\n                    throw new Error('Unauthorized state was not defined');\r\n                    \r\n                pipState.go(unauthorizedState, params);  \r\n            };\r\n\r\n            return pipState;\r\n        }];\r\n\r\n        return;        \r\n        //--------------------------------\r\n\r\n        function setSigninState(newSigninState) {\r\n            if (newSigninState)\r\n                signinState = newSigninState;\r\n            return signinState;\r\n        }\r\n\r\n        function setSignoutState(newSignoutState) {\r\n            if (newSignoutState)\r\n                signoutState = newSignoutState;\r\n            return signoutState;\r\n        }\r\n\r\n        function setAuthorizedState(newAuthorizedState) {\r\n            if (newAuthorizedState)\r\n                authorizedState = newAuthorizedState;\r\n            return authorizedState;\r\n        }\r\n\r\n        function setUnauthorizedState(newUnauthorizedState) {\r\n            if (newUnauthorizedState)\r\n                unauthorizedState = newUnauthorizedState;\r\n            return unauthorizedState;\r\n        }\r\n\r\n        // Overriding state configuration in ui-router to add auth resolves\r\n        function stateOverride(stateName, stateConfig) {\r\n            if (stateName == null)\r\n                throw new Error('stateName cannot be null');\r\n            if (stateConfig == null)\r\n                throw new Error('stateConfig cannot be null');\r\n\r\n            // todo apply in all tool\r\n            if (stateConfig.auth || stateConfig.authenticate) {\r\n                stateConfig.resolve = stateConfig.resolve || {};\r\n\r\n                stateConfig.resolve.user = /* @ngInject */ userResolver;\r\n                stateConfig.resolve.party = /* @ngInject */ partyResolver;\r\n                stateConfig.resolve.connection = /* @ngInject */ connectionResolver;\r\n                stateConfig.resolve.setting = /* @ngInject */ settingsResolver;\r\n            }    \r\n\r\n            pipStateProvider.state(stateName, stateConfig);\r\n\r\n            return this;\r\n        }\r\n\r\n        function userResolver(pipSessionCache) {\r\n            return pipSessionCache.readUser();\r\n        }\r\n\r\n        function partyResolver(pipSessionCache, $stateParams) {\r\n            return pipSessionCache.readParty($stateParams);\r\n        }\r\n\r\n        function connectionResolver(pipSessionCache, $stateParams) {\r\n            return pipSessionCache.readConnection($stateParams);\r\n        }\r\n\r\n        function settingsResolver(pipSessionCache) {\r\n            return pipSessionCache.readSettings();\r\n        }\r\n\r\n    }]);\r\n\r\n})();","/**\r\n * @file Rest API enumerations service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipRest.Enums', []);\r\n\r\n    thisModule.factory('pipEnums', function () {\r\n\r\n        var enums = {};\r\n    \r\n        // Converts enumeration values to string array\r\n        function enumToArray(obj) {\r\n            var result = [];\r\n    \r\n            for (var key in obj)\r\n                if (obj.hasOwnProperty(key))\r\n                    result.push(obj[key]);\r\n\r\n            return result;\r\n        };\r\n    \r\n        enums.SHARE_LEVEL = {\r\n            WORLD: 0, // Everyone\r\n            OUTER: 1, // Familiar\r\n            INNER: 2, // Trusted\r\n            PRIVATE: 3 // Private\r\n        };\r\n    \r\n        enums.URGENCY = {\r\n            LOW: 1,\r\n            NORMAL: 500,\r\n            HIGH: 1000,\r\n            MIN: 0,\r\n            MAX: 1000\r\n        };\r\n        enums.URGENCIES = enumToArray(enums.URGENCY);\r\n    \r\n        enums.IMPORTANCE = {\r\n            LOW: 1,\r\n            NORMAL: 500,\r\n            HIGH: 1000,\r\n            MIN: 0,\r\n            MAX: 1000\r\n        };\r\n        enums.IMPORTANCES = enumToArray(enums.IMPORTANCE);\r\n    \r\n        enums.CONFIDENTIALITY = {\r\n            PUBLIC: 0, // No sharing restrictions level - ANY, groups = yes, parties = yes\r\n            SENSITIVE: 1, // No public sharing - level >= OUTER, groups = yes, parties = yes\r\n            CLASSIFIED: 2, // Only selected parties - level = PRIVATE, groups = yes, parties = yes\r\n            SECRET: 3 // No sharing - level = PRIVATE, groups = no, parties = no\r\n        };\r\n        enums.CONFIDENTIALITIES = enumToArray(enums.CONFIDENTIALITY);\r\n    \r\n        enums.LEVEL = {\r\n            NONE: 0,\r\n            LOW: 1,\r\n            LOW_MEDIUM: 250,\r\n            MEDIUM: 500,\r\n            MEDIUM_HIGH: 750,\r\n            HIGH: 1000,\r\n            MIN: 0,\r\n            MAX: 1000\r\n        };\r\n    \r\n        enums.LANGUAGE = {\r\n            ENGLISH: 'en',\r\n            SPANISH: 'es',\r\n            PORTUGUESE: 'pt',\r\n            FRENCH: 'fr',\r\n            GERMAN: 'de',\r\n            RUSSIAN: 'ru'\r\n        };\r\n        enums.LANGUAGES = enumToArray(enums.LANGUAGE);\r\n    \r\n        enums.STAT_TYPE = {\r\n            DAILY: 'daily',\r\n            MONTHLY: 'monthly',\r\n            YEARLY: 'yearly',\r\n            TOTAL: 'total'\r\n        };\r\n        enums.STAT_TYPES = enumToArray(enums.STAT_TYPE);\r\n    \r\n        enums.STAT_BATCH_OPERATION = {\r\n            RECORD_SYSTEM_STATS: 'record system stats',\r\n            RECORD_PARTY_STATS: 'record party stats'\r\n        };\r\n    \r\n        enums.SERVER_TYPE = {\r\n            REALTIME_DB: 'r/t db master',\r\n            HISTORIAN_DB: 'db slave',\r\n            ANALYTICS: 'analytics',\r\n            BUSINESS_LOGIC: 'business logic',\r\n            REST_API: 'rest api',\r\n            STATIC_CONTENT: 'static content',\r\n            BACKUP_STORAGE: 'backup storage'\r\n        };\r\n        enums.SERVER_TYPES = enumToArray(enums.SERVER_TYPE);\r\n    \r\n        enums.SYSTEM_LOG_TYPE = {\r\n            INFO: 'info',\r\n            STOP: 'stop',\r\n            START: 'start',\r\n            RESTART: 'restart',\r\n            UPGRADE: 'upgrade',\r\n            MAINTENANCE: 'maintenance',\r\n            WARNING: 'warning',\r\n            ERROR: 'error'\r\n        };\r\n        enums.SYSTEM_LOG_TYPES = enumToArray(enums.SYSTEM_LOG_TYPE);\r\n    \r\n        enums.ACTIVITY_TYPE = {\r\n            SIGNUP: 'signup',\r\n            SIGNIN: 'signin',\r\n            PASSWORD_CHANGED: 'password changed',\r\n            PWD_RECOVERED: 'pwd recovered',\r\n            EMAIL_VERIFIED: 'email verified',\r\n            SETTINGS_CHANGED: 'settings changed',\r\n            PARTNERED: 'partnered',\r\n            TEAMED_UP: 'teamed up',\r\n            FOLLOWED: 'followed',\r\n            DISCONNECTED: 'disconnected',\r\n            CREATED: 'created',\r\n            UPDATED: 'updated',\r\n            DELETED: 'deleted',\r\n            ACCEPTED: 'accepted',\r\n            REJECTED: 'rejected',\r\n            JOINED: 'joined',\r\n            COMPLETED: 'completed',\r\n            CANCELED: 'canceled',\r\n            PROGRESS: 'progress',\r\n            POSTED: 'posted',\r\n            BUZZED: 'buzzed',\r\n            COMMENTED: 'commented',\r\n            CHEERED: 'cheered',\r\n            BOOED: 'booed'\r\n        };\r\n        enums.ACTIVITY_TYPES = enumToArray(enums.ACTIVITY_TYPE);\r\n    \r\n        enums.REFERENCE_TYPE = {\r\n            PARTY: 'party',\r\n            CONNECTION: 'connection',\r\n            CONTACT: 'contact',\r\n            MESSAGE: 'message',\r\n            NOTE: 'note',\r\n            AREA: 'area',\r\n            GOAL: 'goal',\r\n            EVENT: 'event',\r\n            VISION: 'vision',\r\n            COLLAGE: 'collage',\r\n            POST: 'post',\r\n            SUPPORT_CASE: 'support case',\r\n            ANNOUNCE: 'announce',\r\n            IMAGE_SET: 'image set',\r\n            FEEDBACK: 'feedback',\r\n            GUIDE: 'guide'\r\n        };\r\n        enums.REFERENCE_TYPES = enumToArray(enums.REFERENCE_TYPE);\r\n    \r\n        enums.CONTENT_TYPE = {\r\n            TEXT: 'text',\r\n            CHECKLIST: 'checklist',\r\n            LOCATION: 'location',\r\n            TIME: 'time',\r\n            PICTURES: 'pictures',\r\n            DOCUMENTS: 'documents'\r\n        };\r\n        enums.CONTENT_TYPES = enumToArray(enums.CONTENT_TYPE);\r\n    \r\n        enums.PARTY_TYPE = {\r\n            PERSON: 'person',\r\n            TEAM: 'team',\r\n            AGENT: 'agent'\r\n        };\r\n        enums.PARTY_TYPES = enumToArray(enums.PARTY_TYPE);\r\n    \r\n        enums.GENDER = {\r\n            MALE: 'male',\r\n            FEMALE: 'female',\r\n            NOT_SPECIFIED: 'n/s'\r\n        };\r\n        enums.GENDERS = enumToArray(enums.GENDER);\r\n    \r\n        enums.VISION_TYPE = {\r\n            OVERALL: 'overall',\r\n            ROLE: 'role',\r\n            MODEL: 'model',\r\n            TIME: 'time'\r\n        };\r\n        enums.VISION_TYPES = enumToArray(enums.VISION_TYPE);\r\n    \r\n        enums.AREA_TYPE = {\r\n            CATEGORY: 'category',\r\n            AREA: 'area'\r\n        };\r\n        enums.AREA_TYPES = enumToArray(enums.AREA_TYPE);\r\n    \r\n        enums.GOAL_TYPE = {\r\n            GOAL: 'goal',\r\n            OBJECTIVE: 'objective',\r\n            DREAM: 'dream',\r\n            //ASPIRATION: 'aspiration',\r\n            ACCOMPLISHMENT: 'accomplishment',\r\n            //CHORE: 'chore',\r\n            //HABIT: 'habit',\r\n            TASK: 'task',\r\n            ROUTINE: 'routine'\r\n        };\r\n        enums.GOAL_TYPES = enumToArray(enums.GOAL_TYPE);\r\n    \r\n        enums.PROCESS_NODE = {\r\n            START: 'start',\r\n            END: 'end',\r\n            EVENT: 'event',\r\n            AWAIT: 'await',\r\n            DECISION: 'decision',\r\n            ACTIVITY: 'activity'\r\n        };\r\n        enums.PROCESS_NODES = enumToArray(enums.PROCESS_NODE);\r\n    \r\n        enums.CALCULATION_METHOD = {\r\n            LAST_VALUE: 'last value',\r\n            SUM: 'sum',\r\n            MAX: 'max',\r\n            MIN: 'min',\r\n            AVERAGE: 'average'\r\n        };\r\n        enums.CALCULATION_METHODS = enumToArray(enums.CALCULATION_METHOD);\r\n    \r\n        enums.EXECUTION_STATUS = {\r\n            NEW: 'new',\r\n            ASSIGNED: 'assigned',\r\n            IN_PROGRESS: 'in progress',\r\n            VERIFYING: 'verifying',\r\n            ON_HOLD: 'on hold',\r\n            CANCELED: 'canceled',\r\n            COMPLETED: 'completed'\r\n        };\r\n        enums.EXECUTION_STATUSES = enumToArray(enums.EXECUTION_STATUS);\r\n    \r\n        enums.CONTRIBUTOR_ROLE = {\r\n            UNDEFINED: 'undefined',\r\n            RESPONSIBLE: 'responsible',\r\n            ACCOUNTABLE: 'accountable',\r\n            CONSULTED: 'consulted',\r\n            INFORMED: 'informed'\r\n        };\r\n        enums.CONSTRIBUTOR_ROLES = enumToArray(enums.CONTRIBUTOR_ROLE);\r\n    \r\n        enums.ACCEPTANCE = {\r\n            JOINED: 'joined',\r\n            INVITED: 'invited',\r\n            ACCEPTED: 'accepted'\r\n            //REJECTED: 'rejected'\r\n        };\r\n        enums.ACCEPTANCES = enumToArray(enums.ACCEPTANCE);\r\n    \r\n        enums.ACCEPT_ACTION = {\r\n            INVITE: 'invite',\r\n            JOIN: 'join',\r\n            ACCEPT: 'accept',\r\n            REJECT: 'reject'\r\n        };\r\n        enums.ACCEPT_ACTIONS = enumToArray(enums.ACCEPT_ACTION);\r\n    \r\n        enums.JOIN_METHOD = {\r\n            INVITE: 'invite',\r\n            APPROVE: 'approve',\r\n            OPEN: 'open'\r\n        };\r\n        enums.JOIN_METHODS = enumToArray(enums.JOIN_METHOD);\r\n    \r\n        enums.SKILL_LEVEL = {\r\n            NOVICE: 'novice',\r\n            INTERMEDIATE: 'intermediate',\r\n            ADVANCED: 'advanced',\r\n            EXPERT: 'expert'\r\n        };\r\n        enums.SKILL_LEVELS = enumToArray(enums.SKILL_LEVEL);\r\n    \r\n        enums.FEEDBACK_TYPE = {\r\n            SUPPORT: 'support',\r\n            TEAM: 'team',\r\n            MEETUP: 'meetup',\r\n            COPYRIGHT: 'copyright',\r\n            BUSINESS: 'business',\r\n            ADVERTISEMENT: 'ad'\r\n        };\r\n        enums.FEEDBACK_TYPES = enumToArray(enums.FEEDBACK_TYPE);\r\n    \r\n        enums.NOTE_CATEGORY = {\r\n            GENERAL: 'general',\r\n            UNFINISHED: 'unfinished',\r\n            ULTIMATE_TODO: 'ultimate todo'\r\n        };\r\n        enums.NOTE_CATEGORIES = enumToArray(enums.NOTE_CATEGORY);\r\n    \r\n        enums.CONNECTION_TYPE = {\r\n            PARTNER: 'partner',\r\n            MEMBER: 'member',\r\n            FOLLOW: 'follow',\r\n            AUTOMATION: 'automation'\r\n        };\r\n        enums.CONNECTION_TYPES = enumToArray(enums.CONNECTION_TYPE);\r\n    \r\n        enums.EVENT_TYPE = {\r\n            INSTANCE: 'instance',\r\n            RECURRENCE: 'recurrence',\r\n            AUTO_INSTANCE: 'auto',\r\n            TIME_ENTRY: 'time entry'\r\n        };\r\n        enums.EVENT_TYPES = enumToArray(enums.EVENT_TYPE);\r\n    \r\n        enums.EVENT_CATEGORY = {\r\n            DAILY: 'daily',\r\n            WEEKLY: 'weekly',\r\n            MONTHLY: 'monthly',\r\n            YEARLY: 'yearly'\r\n            //    COULDDO: 'coulddo'\r\n        };\r\n        enums.EVENT_CATEGORIES = enumToArray(enums.EVENT_CATEGORY);\r\n    \r\n        enums.COMMENT_TYPE = {\r\n            BUZZ: 'buzz',\r\n            CHEER: 'cheer',\r\n            BOO: 'boo',\r\n            COMMENT: 'comment'\r\n        };\r\n        enums.COMMENT_TYPES = enumToArray(enums.COMMENT_TYPE);\r\n    \r\n        enums.POST_TYPE = {\r\n            INFO: 'info',\r\n            QUESTION: 'question',\r\n            ISSUE: 'issue',\r\n            REPORT: 'report',\r\n            FORECAST: 'forecast'\r\n        };\r\n        enums.POST_TYPES = enumToArray(enums.POST_TYPE);\r\n    \r\n        enums.MESSAGE_TYPE = {\r\n            REGULAR: 'regular',\r\n            EMAIL: 'email',\r\n            INVITATION: 'invitation'\r\n        };\r\n        enums.MESSAGE_TYPES = enumToArray(enums.MESSAGE_TYPE);\r\n    \r\n        enums.NOTIFICATION_TYPE = {\r\n            GREETING: 'greeting',\r\n            MESSAGE: 'message',\r\n    \r\n            PARTNER_INVITE: 'partner invite',\r\n            PARTNER_RESPONSE_ACCEPTED: 'partner response accepted',\r\n            PARTNER_RESPONSE_REJECTED: 'partner response rejected',\r\n            PARTNER_JOINED: 'partner joined',\r\n            MEMBER_INVITE: 'member invite',\r\n            MEMBER_REQUEST: 'member request',\r\n            MEMBER_RESPONSE_ACCEPTED: 'member response accepted',\r\n            MEMBER_RESPONSE_REJECTED: 'member response rejected',\r\n            MEMBER_JOINED: 'member joined',\r\n            FOLLOWER_JOINED: 'follower joined',\r\n    \r\n            ENTITY_REQUEST: 'entity request',\r\n            ENTITY_REQUEST_ACCEPTED: 'entity request accepted',\r\n            ENTITY_REQUEST_REJECTED: 'entity request rejected',\r\n            ENTITY_INVITE: 'entity invite',\r\n            ENTITY_INVITE_ACCEPTED: 'entity invite accepted',\r\n            ENTITY_INVITE_REJECTED: 'entity invite rejected',\r\n            ENTITY_JOINED: 'entity joined',\r\n    \r\n            VERIFY_EMAIL: 'verify email',\r\n            COMPLETE_PROFILE: 'complete profile'\r\n        };\r\n        enums.NOTIFICATION_TYPES = enumToArray(enums.NOTIFICATION_TYPE);\r\n    \r\n        enums.NOTIFICATION_BATCH_OPERATION = {\r\n            CREATE: 'create',\r\n            REPLY: 'reply',\r\n            CLOSE: 'close',\r\n            DELETE: 'delete'\r\n        };\r\n    \r\n        enums.SUPPORT_CASE_CATEGORY = {\r\n            ACCOUNT: 'account',\r\n            BILLING: 'billing',\r\n            TECHNICAL: 'technical',\r\n            GENERAL: 'general'\r\n        };\r\n        enums.SUPPORT_CASE_CATEGORIES = enumToArray(enums.SUPPORT_CASE_CATEGORY);\r\n    \r\n        enums.ANNOUNCE_TYPE = {\r\n            APP: 'app',\r\n            EMAIL: 'email',\r\n            APP_AND_EMAIL: 'app and email'\r\n        };\r\n        enums.ANNOUNCE_TYPES = enumToArray(enums.ANNOUNCE_TYPE);\r\n    \r\n        enums.ANNOUNCE_CATEGORY = {\r\n            GENERAL: 'general',\r\n            MAINTENANCE: 'maintenance',\r\n            NEW_RELEASE: 'new release',\r\n            SURVEY: 'survey'\r\n        };\r\n        enums.ANNOUNCE_CATEGORIES = enumToArray(enums.ANNOUNCE_CATEGORY);\r\n    \r\n        enums.GUIDE_TYPE = {\r\n            INTRO: 'intro',\r\n            TOPIC: 'topic',\r\n            CONTEXT: 'context',\r\n            TIP: 'tip',\r\n            NEW_RELEASE: 'new release'\r\n        };\r\n        enums.GUIDE_TYPES = enumToArray(enums.GUIDE_TYPE);\r\n    \r\n        enums.EMAIL_TYPE = {\r\n            HOME: 'home',\r\n            WORK: 'work',\r\n            OTHER: 'other'\r\n        };\r\n        enums.EMAIL_TYPES = enumToArray(enums.EMAIL_TYPE);\r\n    \r\n        enums.ADDRESS_TYPE = {\r\n            HOME: 'home',\r\n            WORK: 'work',\r\n            OTHER: 'other'\r\n        };\r\n        enums.ADDRESS_TYPES = enumToArray(enums.ADDRESS_TYPE);\r\n    \r\n        enums.ADDRESS_TYPE = {\r\n            HOME: 'home',\r\n            WORK: 'work',\r\n            OTHER: 'other'\r\n        };\r\n        enums.ADDRESS_TYPES = enumToArray(enums.ADDRESS_TYPE);\r\n    \r\n        enums.PHONE_TYPE = {\r\n            MOBILE: 'mobile',\r\n            WORK: 'work',\r\n            HOME: 'home',\r\n            MAIN: 'main',\r\n            WORK_FAX: 'work fax',\r\n            HOME_FAX: 'home fax',\r\n            OTHER: 'other'\r\n        };\r\n        enums.PHONE_TYPES = enumToArray(enums.PHONE_TYPE);\r\n    \r\n        enums.MESSANGER_TYPE = {\r\n            SKYPE: 'skype',\r\n            GOOGLE_TALK: 'google talk',\r\n            AIM: 'aim',\r\n            YAHOO: 'yahoo',\r\n            QQ: 'qq',\r\n            MSN: 'msn',\r\n            ICQ: 'icq',\r\n            JABBER: 'jabber',\r\n            OTHER: 'other'\r\n        };\r\n        enums.MESSANGER_TYPES = enumToArray(enums.MESSANGER_TYPE);\r\n    \r\n        enums.WEB_ADDRESS_TYPE = {\r\n            PROFILE: 'profile',\r\n            BLOG: 'blog',\r\n            HOME_PAGE: 'home page',\r\n            WORK: 'work',\r\n            PORTFOLIO: 'portfolio',\r\n            OTHER: 'other'\r\n        };\r\n        enums.WEB_ADDRESS_TYPES = enumToArray(enums.WEB_ADDRESS_TYPE);\r\n    \r\n        enums.DASHBOARD_TILE_SIZE = {\r\n            SMALL: 'small',\r\n            WIDE: 'wide',\r\n            LARGE: 'large'\r\n        };\r\n        enums.DASHBOARD_TILE_SIZES = enumToArray(enums.DASHBOARD_TILE_SIZE);\r\n\r\n        return enums;\r\n    });\r\n    \r\n})();\r\n","/**\r\n * @file PipServices Rest API\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo:\r\n * - Separate application and administrative APIs\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipRest', [\r\n        'ngResource',  \r\n        'pipRest.Enums', 'pipRest.Access',\r\n        'pipRest.Session', 'pipRest.State'\r\n    ]);\r\n\r\n    thisModule.provider('pipRest', ['$httpProvider', function($httpProvider) {\r\n        var serverUrl = '';\r\n        var serverUrlFixed = false;\r\n\r\n        // Set default API version\r\n        $httpProvider.defaults.headers.common['api-version'] = '1.0';\r\n\r\n\r\n        this.version = function (newVersion) {\r\n            if (newVersion)\r\n                $httpProvider.defaults.headers.common['api-version'] = newVersion;\r\n            return $httpProvider.defaults.headers.common['api-version'];\r\n        };\r\n\r\n        this.serverUrlFixed = function (value) {\r\n            if (value === true || value === 'on' )\r\n                serverUrlFixed = value;\r\n            return serverUrlFixed;\r\n        };\r\n\r\n        this.serverUrl = function (newServerUrl) {\r\n            if (newServerUrl)\r\n                serverUrl = newServerUrl;\r\n            return newServerUrl;\r\n        };\r\n\r\n        this.$get = ['$rootScope', '$http', '$resource', function ($rootScope, $http, $resource) {\r\n\r\n            function createResource(url, path, paramDefaults, actions) {\r\n                url = url || serverUrl;\r\n                return $resource(url + path, paramDefaults, actions);\r\n            };\r\n    \r\n            function createOperation(url, path) {\r\n                url = url || serverUrl;\r\n                return $resource(url + path, {},\r\n                    {\r\n                        call: {method: 'POST'}\r\n                    }\r\n                );\r\n            };\r\n    \r\n            function createCollection(url, path, paramDefaults) {\r\n                url = url || serverUrl;\r\n                return $resource(url + path,\r\n                    paramDefaults || { id: '@id' },\r\n                    {\r\n                        update: {method: 'PUT'}\r\n                    }\r\n                );\r\n            };\r\n    \r\n            function createPagedCollection(url, path, paramDefaults) {\r\n                url = url || serverUrl;\r\n                return $resource(url + path,\r\n                    paramDefaults || { id: '@id' },\r\n                    {\r\n                        page: {method: 'GET', isArray: false},\r\n                        update: {method: 'PUT'}\r\n                    }\r\n                );\r\n            };\r\n    \r\n            function createPartyCollection(url, path, paramDefaults) {\r\n                return createPagedCollection(url, path, paramDefaults ||\r\n                    {\r\n                        id: '@id',\r\n                        party_id: '@party_id'\r\n                    }\r\n                );\r\n            };\r\n\r\n            return {\r\n                version: function (newVersion) {\r\n                    if (newVersion)\r\n                        $httpProvider.defaults.headers.common['api-version'] = newVersion;\r\n                    return $httpProvider.defaults.headers.common['api-version'];\r\n                },\r\n\r\n                serverUrl: function (newServerUrl) {\r\n                    if (newServerUrl) {\r\n                        serverUrl = newServerUrl;\r\n                    }\r\n                    return serverUrl;\r\n                },\r\n\r\n                userId: function () {\r\n                    return $http.defaults.headers.common['user-id'];\r\n                },\r\n\r\n                serverUrlFixed: function() {\r\n                    return serverUrlFixed;\r\n                },\r\n\r\n                sessionId: function () {\r\n                    return $http.defaults.headers.common['session-id'];\r\n                },\r\n\r\n                // Used in routing\r\n                partyId: function ($stateParams) {\r\n                    return $stateParams.party_id || $http.defaults.headers.common['user-id'];\r\n                },\r\n\r\n                about: function (url) {\r\n                    return createResource(url, '/api/about');\r\n                },\r\n\r\n                session: function (userId, sessionId) {\r\n                    $http.defaults.headers.common['session-id'] = sessionId;\r\n                    $http.defaults.headers.common['user-id'] = userId;\r\n                },\r\n\r\n                signin: function (url) {\r\n                    return createOperation(url, '/api/signin');\r\n                },\r\n\r\n                signout: function (url) {\r\n                    return createOperation(url, '/api/signout');\r\n                },\r\n\r\n                signup: function (url) {\r\n                    return createOperation(url, '/api/signup');\r\n                },\r\n\r\n                recoverPassword: function (url) {\r\n                    return createOperation(url, '/api/recover_password');\r\n                },\r\n\r\n                resetPassword: function (url) {\r\n                    return createOperation(url, '/api/reset_password');\r\n                },\r\n\r\n                changePassword: function (url) {\r\n                    return createOperation(url, '/api/change_password');\r\n                },\r\n\r\n                requestEmailVerification: function (url) {\r\n                    return createCollection(url, '/api/users/:party_id/resend_email_verification');\r\n                },\r\n\r\n                verifyEmail: function (url) {\r\n                    return createOperation(url, '/api/verify_email');\r\n                },\r\n\r\n                signupValidate: function (url) {\r\n                    return createOperation(url, '/api/signup_validate');\r\n                },\r\n\r\n                users: function (url) {\r\n                    return createPagedCollection(url, '/api/users/:id');\r\n                },\r\n\r\n                currentUser: function (url) {\r\n                    return createResource(url, '/api/users/current',\r\n                        {},\r\n                        {\r\n                            get: {method: 'GET', isArray: false}\r\n                        }\r\n                    );\r\n                },\r\n\r\n                userSessions: function (url) {\r\n                    return createPartyCollection(url, '/api/users/:party_id/sessions/:id');\r\n                },\r\n\r\n\r\n                parties: function (url) {\r\n                    return createPagedCollection(url, '/api/parties/:id');\r\n                },\r\n\r\n                //\r\n                // inviteParty: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:id/invite');\r\n                // },\r\n                //\r\n                // partyActivities: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/activities');\r\n                // },\r\n                //\r\n                partySettings: function (url) {\r\n                    return createPartyCollection(url, '/api/parties/:party_id/settings');\r\n                },\r\n                //\r\n                // partyTags: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/tags');\r\n                // },\r\n\r\n                serverActivities: function (url) {\r\n                    return createPagedCollection(url, '/api/servers/activities/:id');\r\n                },\r\n\r\n                // connectionBlocks: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/blocks/:id');\r\n                // },\r\n                //\r\n                // connectionSuggestions: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/connections/suggestions',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                \r\n                // TBD: REFACTOR SESSION_CACHE AND MOVE OUT OF HERE\r\n                connections: function (url) {\r\n                    return createPartyCollection(url, '/api/parties/:party_id/connections/:id');\r\n                },\r\n                //\r\n                // // Todo: Deprecated operation\r\n                // managedConnections: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/connections/managed');\r\n                // },\r\n                //\r\n                // // Todo: Deprecated operation. Use party_access from user object instead\r\n                // collaborators: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/collaborators/:to_party_id',\r\n                //         {\r\n                //             to_party_id: '@to_party_id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // partners: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/partners/:id');\r\n                // },\r\n                //\r\n                // acceptPartner: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/partners/:id/accept');\r\n                // },\r\n                //\r\n                // members: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/members/:id');\r\n                // },\r\n                //\r\n                // acceptMember: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/members/:id/accept');\r\n                // },\r\n                //\r\n                // following: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/following/:id');\r\n                // },\r\n                //\r\n                // followers: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/followers/:id');\r\n                // },\r\n                //\r\n                // groups: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/groups/:id');\r\n                // },\r\n                //\r\n                // contacts: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/contacts/:id');\r\n                // },\r\n                //\r\n                // getOwnContacts: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/contacts/own');\r\n                // },\r\n                //\r\n                // quotes: function (url) {\r\n                //     return createPagedCollection(url, '/api/quotes/:id');\r\n                // },\r\n                //\r\n                // randomQuote: function (url) {\r\n                //     return createResource(url, '/api/quotes/random');\r\n                // },\r\n                //\r\n                guides: function (url) {\r\n                    return createPagedCollection(url, '/api/guides/:id');\r\n                },\r\n\r\n                tips: function (url) {\r\n                    return createPagedCollection(url, '/api/tips/:id');\r\n                },\r\n\r\n                image_sets: function (url) {\r\n                    return createPagedCollection(url, '/api/image_sets/:id');\r\n                },\r\n\r\n                images: function (url) {\r\n                    return createPagedCollection(url, '/api/images/search');\r\n                },\r\n\r\n                // notes: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/notes/:id');\r\n                // },\r\n                //\r\n                // // Todo: This operation is deprecated. Use contributors management instead\r\n                // sendNote: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/notes/:id/send');\r\n                // },\r\n\r\n                feedbacks: function (url) {\r\n                    return createPartyCollection(url, '/api/feedbacks/:id');\r\n                },\r\n\r\n                // feeds: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/feeds/:id');\r\n                // },\r\n\r\n                // publicPosts: function (url) {\r\n                //     return createCollection(url, '/api/posts/:id');\r\n                // },\r\n                //\r\n                // posts: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/posts/:id');\r\n                // },\r\n                //\r\n                // allFeedPosts: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/feeds/posts/:id');\r\n                // },\r\n                //\r\n                // feedPosts: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/feeds/:feed_id/posts/:id',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id',\r\n                //             feed_id: '@feed_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // // Todo: Move under party  /api/parties/:party_id/posts/:post_id/comments\r\n                // postComments: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/posts/:id/comments/:comment_id',\r\n                //         {\r\n                //             party_id: '@party_id',\r\n                //             id: '@id',\r\n                //             comment_id: '@comment_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // postCheers: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/posts/:post_id/cheers',\r\n                //         {\r\n                //             party_id: '@party_id',\r\n                //             post_id: '@post_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // postBoos: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/posts/:post_id/boos',\r\n                //         {\r\n                //             party_id: '@party_id',\r\n                //             post_id: '@post_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // events: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/events/:id');\r\n                // },\r\n                //\r\n                // acceptEvent: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/events/:id/accept');\r\n                // },\r\n                //\r\n                // rejectEvent: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/events/:id/reject');\r\n                // },\r\n                //\r\n                // acceptVision: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/visions/:id/accept');\r\n                // },\r\n                //\r\n                // rejectVision: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/visions/:id/reject');\r\n                // },\r\n                //\r\n                // messages: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/messages/:id');\r\n                // },\r\n                //\r\n                // receivedMessages: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/messages/received',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // receivedManagedMessages: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/messages/received/managed',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // sentMessages: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/messages/sent',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // viewMessage: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/messages/:id/view');\r\n                // },\r\n                //\r\n                // sentManagedMessages: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/messages/sent/managed',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // notifications: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/notifications',\r\n                //         {\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // // Todo: Add party?\r\n                // managedNotifications: function (url) {\r\n                //     return createCollection(url, '/api/parties/:party_id/notifications/managed', {\r\n                //         party_id: '@party_id'\r\n                //     });\r\n                // },\r\n                //\r\n                // areas: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/areas/:id');\r\n                // },\r\n                //\r\n                // acceptArea: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/areas/:id/accept');\r\n                // },\r\n                //\r\n                // rejectArea: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/areas/:id/reject');\r\n                // },\r\n                //\r\n                // goals: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/goals/:id');\r\n                // },\r\n                //\r\n                // acceptGoal: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/goals/:id/accept');\r\n                // },\r\n                //\r\n                // rejectGoal: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/goals/:id/reject');\r\n                // },\r\n                //\r\n                // visions: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/visions/:id');\r\n                // },\r\n                //\r\n                // // Todo: This one doesn't exist on the server\r\n                // collages: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/collages/:id');\r\n                // },\r\n                //\r\n                // partySupportCases: function (url) {\r\n                //     return createPartyCollection(url, '/api/parties/:party_id/support_cases/:id');\r\n                // },\r\n                //\r\n                // supportCases: function (url) {\r\n                //     return createPagedCollection(url, '/api/support_cases/:id');\r\n                // },\r\n\r\n                announces: function (url) {\r\n                    return createPagedCollection(url, '/api/announcements/:id');\r\n                },\r\n\r\n                // stats: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/counters');\r\n                // },\r\n                //\r\n                // eventContribManage: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/events/:id/manage_contrib',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // areaContribManage: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/areas/:id/manage_contrib',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // goalContribManage: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/goals/:id/manage_contrib',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // visionContribManage: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/visions/:id/manage_contrib',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n                //\r\n                // noteContribManage: function (url) {\r\n                //     return createPagedCollection(url, '/api/parties/:party_id/notes/:id/manage_contrib',\r\n                //         {\r\n                //             id: '@id',\r\n                //             party_id: '@party_id'\r\n                //         }\r\n                //     );\r\n                // },\r\n\r\n                // for testing\r\n                //--------------\r\n\r\n                createResource: createResource,\r\n                createOperation: createOperation,\r\n                createCollection: createCollection,\r\n                createPagedCollection: createPagedCollection,\r\n                createPartyCollection: createPartyCollection\r\n\r\n            };\r\n        }];\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Session service for PipServices Rest API\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipRest.Session', ['ngCookies', 'pipRest']);\r\n\r\n    thisModule.run(['pipSession', function(pipSession) {\r\n        // Reload session to avoid signin\r\n        pipSession.reopen();\r\n    }]);\r\n\r\n    thisModule.factory('pipSession', \r\n        ['$rootScope', '$http', 'localStorageService', '$cookieStore', 'pipRest', 'pipTimer', function ($rootScope, $http, localStorageService, $cookieStore, pipRest, pipTimer) {\r\n            var \r\n                currentOperation = undefined,\r\n                sessionId, userId, serverUrl;\r\n\r\n            return {\r\n                opened: opened,\r\n                userId: getUserId,\r\n                sessionId: getSessionId,\r\n                serverUrl: getServerUrl,\r\n\r\n                lastUsedEmail: lastUsedEmail,\r\n                //lastUsedPassword: lastUsedPassword,\r\n                usedServers: usedServers,\r\n                usedServerUrls: usedServerUrls,\r\n\r\n                signin: signin,\r\n                abort: abort,\r\n                signout: signout,\r\n\r\n                open: open,\r\n                close: close,\r\n                reopen: reopen\r\n            };\r\n            //-----------------------\r\n\r\n            // Session Ids\r\n            //---------------\r\n\r\n            function getUserId() {\r\n                return userId;\r\n            };\r\n\r\n            function getSessionId() {\r\n                return sessionId;  \r\n            };\r\n\r\n            function getServerUrl() {\r\n                return serverUrl || localStorageService.get('serverUrl');\r\n            };\r\n\r\n            function opened() {\r\n                var isOpened = (sessionId !== '' && sessionId !== null && sessionId !== undefined) &&\r\n                    (userId !== '' && userId !== null && userId !== undefined) &&\r\n                    (serverUrl !== '' && serverUrl !== null && serverUrl !== undefined);\r\n\r\n                return isOpened;\r\n            };\r\n\r\n            // Saved connection settings\r\n            //----------------------------\r\n            \r\n            function lastUsedEmail(serverUrl) {\r\n                var servers = localStorageService.get('servers');\r\n                if (servers && servers[serverUrl]) {\r\n                    return servers[serverUrl].email;\r\n                }\r\n                return undefined;\r\n            };\r\n\r\n            function usedServers() {\r\n                return localStorageService.get('servers') || {};\r\n            };\r\n\r\n            function usedServerUrls() {\r\n                var \r\n                    servers = localStorageService.get('servers'),\r\n                    serverUrls = [], serverUrl;\r\n                        \r\n                for (var prop in servers) {\r\n                    if (servers.hasOwnProperty(prop)) {\r\n                        serverUrl = servers[prop].serverUrl;\r\n                        if (serverUrl) {\r\n                            serverUrls.push(serverUrl);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return serverUrls;\r\n            };\r\n\r\n            // Session management\r\n            //---------------------\r\n\r\n            function signin(params, successCallback, errorCallback) {\r\n                var \r\n                    serverUrl = params.serverUrl,\r\n                    email = params.email,\r\n                    password = params.password,\r\n                    remember = params.remember,\r\n                    adminOnly = !!params.adminOnly,\r\n                    thisOperation = new Date().getTime();\r\n\r\n                currentOperation = thisOperation;\r\n\r\n                $http.defaults.headers.common['session-id'] = undefined;\r\n                $http.defaults.headers.common['user-id'] = undefined;\r\n                $http.defaults.headers.common['account-id'] = undefined;\r\n\r\n                pipRest.signin(serverUrl).call(\r\n                    { \r\n                        email: email, \r\n                        password: password,\r\n                        remember: remember\r\n                    },\r\n                    function(user) {\r\n                        if (currentOperation != thisOperation) {\r\n                            return;\r\n                        } else {\r\n                            currentOperation = undefined;\r\n\r\n                            if (adminOnly && !user.admin) {\r\n                                errorCallback('ERROR_ADMIN_ONLY_ACCESS');\r\n                            } else {\r\n                                open(serverUrl, user, remember);\r\n                                $rootScope.$broadcast('pipAutoPullChanges');\r\n                                successCallback(user);\r\n                            }\r\n                        }\r\n                    }, \r\n                    function(error) {\r\n                        if (currentOperation != thisOperation) {\r\n                            return;\r\n                        } else {\r\n                            currentOperation = undefined;\r\n                            errorCallback(error);   \r\n                        }\r\n                    }\r\n                );\r\n            };\r\n\r\n            function signup(params, successCallback, errorCallback) {\r\n                var \r\n                    serverUrl = params.serverUrl,\r\n                    name = params.name,\r\n                    email = params.email,\r\n                    password = params.password,\r\n                    language = params.language,\r\n                    remember = false,\r\n                    thisOperation = new Date().getTime();\r\n\r\n                pipRest.signup(serverUrl).call(\r\n                    {\r\n                        name: name,\r\n                        email: email,\r\n                        password: password,\r\n                        language: language\r\n                    },\r\n                    function(user) {\r\n                        if (currentOperation != thisOperation) {\r\n                            return;\r\n                        } else {\r\n                            currentOperation = undefined;\r\n\r\n                            open(serverUrl, user, remember);\r\n                            successCallback(user);\r\n                        }\r\n                    }, \r\n                    function(error) {\r\n                        if (currentOperation != thisOperation) {\r\n                            return;\r\n                        } else {\r\n                            currentOperation = undefined;\r\n                            errorCallback(error);   \r\n                        }\r\n                    }\r\n                );\r\n            };\r\n\r\n            function abort() {\r\n                currentOperation = undefined;\r\n            };\r\n\r\n            function signout(callback) {\r\n                if (opened()) {\r\n                    pipRest.signout().call({}, callback, callback);\r\n                }\r\n\r\n                close();\r\n            };\r\n\r\n            function open(currentServerUrl, user, remember) {\r\n                sessionId = user.last_session_id;\r\n                userId = user.id;\r\n                serverUrl = currentServerUrl;\r\n\r\n                // Set default headers for subsequent HTTP requests\r\n                $http.defaults.headers.common['session-id'] = sessionId;\r\n                $http.defaults.headers.common['user-id'] = userId;\r\n\r\n                // Save ids into local storage\r\n                if (remember) {\r\n                    var servers = localStorageService.get('servers') || {};\r\n                    servers[serverUrl] = {\r\n                        serverUrl: serverUrl,\r\n                        email: user.email\r\n                    };\r\n                    localStorageService.set('servers', servers);\r\n\r\n                    localStorageService.set('sessionId', sessionId);\r\n                    localStorageService.set('userId', userId);\r\n                    localStorageService.set('serverUrl', serverUrl);\r\n                }\r\n\r\n                // Save into session id to retain the connection while browser is running\r\n                // Remove from cookie store\r\n                $cookieStore.put('user-id', userId);\r\n                $cookieStore.put('session-id', sessionId);\r\n                $cookieStore.put('server-url', serverUrl);\r\n\r\n                // Save context parameters do not save\r\n                if (!pipRest.serverUrlFixed()) pipRest.serverUrl(serverUrl);\r\n                \r\n                // Send broadcast\r\n                // saveSession data\r\n                $rootScope.$emit(\r\n                    'pipSessionOpened', \r\n                    { \r\n                        serverUrl: serverUrl,\r\n                        sessionId: sessionId,\r\n                        userId: userId,\r\n                        user: user\r\n                    }\r\n                );\r\n                pipTimer.start();\r\n            };\r\n\r\n            function reopen() {\r\n                userId = $cookieStore.get('user-id') || localStorageService.get('userId');\r\n                sessionId = $cookieStore.get('session-id') || localStorageService.get('sessionId');\r\n                serverUrl = $cookieStore.get('server-url') || localStorageService.get('serverUrl');\r\n\r\n                // Set default headers for subsequent HTTP requests\r\n                $http.defaults.headers.common['session-id'] = sessionId;\r\n                $http.defaults.headers.common['user-id'] = userId;\r\n\r\n                if (!pipRest.serverUrlFixed() || !pipRest.serverUrl()) pipRest.serverUrl(serverUrl);\r\n                $rootScope.$serverUrl = pipRest.serverUrl();\r\n                // Send broadcast\r\n                $rootScope.$emit(\r\n                    'pipSessionOpened', \r\n                    { \r\n                        serverUrl: serverUrl,\r\n                        sessionId: sessionId,\r\n                        userId: userId\r\n                    }\r\n                );\r\n\r\n            };\r\n\r\n            function close() {\r\n                sessionId = undefined;\r\n                userId = undefined;\r\n                        \r\n                // Unset default headers for subsequent HTTP requests\r\n                $http.defaults.headers.common['session-id'] = undefined;\r\n                $http.defaults.headers.common['user-id'] = undefined;\r\n\r\n                // Remove ids into local storage\r\n                localStorageService.remove('userId');\r\n                localStorageService.remove('sessionId');\r\n\r\n                // Remove from cookie store\r\n                $cookieStore.remove('user-id');\r\n                $cookieStore.remove('session-id');\r\n\r\n                // RemoveToastMessages\r\n                pipTimer.stop();\r\n\r\n                // Send broadcast\r\n                // RemoveToastMessages\r\n                $rootScope.$emit('pipSessionClosed');\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Announces data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipAnnouncesData', ['pipRest', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipAnnouncesData', function () {\r\n\r\n        // Read all announces\r\n        this.readAnnouncesResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', 'pipEnums', function ($stateParams, pipRest, pipEnums) {\r\n                return pipRest.announces().query().$promise;\r\n            }];\r\n        };\r\n\r\n        this.readCompletedAnnouncesResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', 'pipEnums', function ($stateParams, pipRest, pipEnums) {\r\n                return pipRest.announces().query( {\r\n                        status: pipEnums.EXECUTION_STATUS.COMPLETED\r\n                    }\r\n                ).$promise;\r\n            }];\r\n        };\r\n\r\n        this.readAnnounceResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.announces().get({\r\n                    id: $stateParams.id\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        // CRUD operations and other business methods\r\n        this.$get = ['pipRest', '$stateParams', 'pipDataModel', function (pipRest, $stateParams, pipDataModel) {\r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                updateAnnounce: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'announces';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.update(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n                \r\n                updateAnnounceWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'announces';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.update(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                createAnnounceWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'announces';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.create(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n                \r\n                createAnnounce: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'announces';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.create(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                deleteAnnounce: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'announces';\r\n                    pipDataModel.remove(params, successCallback, errorCallback);\r\n                }\r\n            }\r\n        }];\r\n    });\r\n\r\n})();","/**\r\n * @file Registration of all data modules\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipData', [\r\n\t\t'pipDataModel',\r\n\t\t'pipDataCache',\r\n        \r\n        'pipUsersData',\r\n        'pipSettingsData',\r\n        'pipSessionData',\r\n        'pipTagsData',\r\n\r\n        'pipAnnouncesData',\r\n        'pipFeedbacksData',\r\n        'pipGuidesData',\r\n        'pipImageSetsData',\r\n        'pipTipsData'\r\n    ]);\r\n    \r\n})();","/**\r\n * @file Application abstract data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular, _, async */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipDataModel', ['pipUtils', 'pipRest']);\r\n\r\n    thisModule.provider('pipDataModel', function() {\r\n        this.$get = ['$stateParams', 'pipCollections', 'pipRest', function($stateParams, pipCollections, pipRest) {\r\n\r\n            var api = [];\r\n\r\n            for (var call in pipRest) {\r\n                api[call] = pipRest[call];\r\n            }\r\n\r\n            function extendApi(extension) {\r\n                for (var call in extension) {\r\n                    api[call] = extension[call];\r\n                }\r\n            }\r\n\r\n            // Execute request to REST API\r\n            function executeCurl(params, successCallback, errorCallback) {\r\n                var t = params.transaction, tid;\r\n\r\n                if (t && !params.skipTransactionBegin) {\r\n                    tid = params.transactionId = t.begin(\r\n                        params.transactionOperation || 'PROCESSING'\r\n                    );\r\n                    if (!tid) return;\r\n                }\r\n\r\n                return api[params.resource]()[params.operation](\r\n                    params.item,\r\n                    function (result) {\r\n                        if (t && tid && t.aborted(tid)) return;\r\n                        if (t && !params.skipTransactionEnd) t.end();\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    function (error) {\r\n                        if (t) t.end(error);\r\n                        if (errorCallback) errorCallback(error);\r\n                    }\r\n                );\r\n            };\r\n\r\n            // Create an object and add it to object collection\r\n            function createCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'SAVING';\r\n                params.operation = params.operation || 'save';\r\n                \r\n                return executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (params.itemCollection)\r\n                            params.itemCollection.push(result);\r\n\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    function(error){\r\n                        if (errorCallback) errorCallback(error);\r\n                    }\r\n                );\r\n            };\r\n\r\n            // Update an object and replace it in object collection\r\n            function updateCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'SAVING';\r\n                params.operation = params.operation || 'update';\r\n\r\n                return  executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (params.itemCollection)\r\n                            pipCollections.replaceBy(params.itemCollection, 'id', result.id, result);\r\n\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            // Update an object and remove it from object collection\r\n            function deleteCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'SAVING';\r\n                params.operation = params.operation || 'remove';\r\n\r\n                return executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (params.itemCollection)\r\n                            _.remove(params.itemCollection, {id: result.id || (params.object || {}).id || (params.item || {}).id});\r\n\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            // Read a collection of objects\r\n            function readCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'READING';\r\n                params.operation = params.operation || 'query';\r\n\r\n                return executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            // Read a single object and add it into collection\r\n            function readOneCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'READING';\r\n                params.operation = params.operation || 'page';\r\n\r\n                return executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (params.itemCollection && result) {\r\n                            var index = _.findIndex(params.itemCollection, {id: result.id});\r\n                            if (index >= 0) params.itemCollection[index] = result;\r\n                            else params.itemCollection.push(result);\r\n                        }\r\n\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            // Read a page and add results into object collection\r\n            function pageCurl(params, successCallback, errorCallback) {\r\n                params.transactionOperation = params.transactionOperation || 'READING';\r\n                params.operation = params.operation || 'page';\r\n\r\n                return executeCurl(\r\n                    params,\r\n                    function(result) {\r\n                        if (params.itemCollection && result.data) {\r\n                            for (var i = 0; i < result.data.length; i++)\r\n                                params.itemCollection.push(result.data[i]);\r\n                        }\r\n\r\n                        if (successCallback) successCallback(result);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            // Save picture and document files\r\n            function saveFilesCurl(params, successCallback, errorCallback) {\r\n                var t = params.transaction, tid;\r\n\r\n                // Start transaction if necessary\r\n                if (t && !params.skipTransactionBegin) {\r\n                    tid = params.transactionId = t.begin(\r\n                        params.transactionOperation || 'SAVING'\r\n                    );\r\n                    if (!tid) return;\r\n                }\r\n\r\n//------------------\r\n\r\n                var uploadFiles = [{\r\n                    pictures: params.pictures,\r\n                    documents: params.documents\r\n                }];\r\n\r\n                // from content\r\n                if (params.item && params.item.content ) {\r\n                    var saveResult = true;\r\n                    async.eachSeries(_.union(params.item.content, uploadFiles),\r\n                        function (obj, callback) {\r\n                            // не выбран - пропускаем этот item  || нет этого события action\r\n                            if ( !obj.pictures && !obj.documents ) {\r\n                                callback();\r\n                            } else {\r\n                                if (obj.pictures) {\r\n                                    // Save pictures first\r\n                                    obj.pictures.save(\r\n                                        function () {\r\n                                            if (t && tid && t.aborted(tid)) {\r\n                                                saveResult =  false;\r\n                                                callback('aborted');\r\n                                            }\r\n                                            // Save documents second\r\n                                            if (obj.documents) {\r\n                                                obj.documents.save(\r\n                                                    function () {\r\n                                                        if (t && tid && t.aborted(tid)) {\r\n                                                            saveResult =  false;\r\n                                                            callback('aborted');\r\n                                                        }\r\n                                                        callback();\r\n                                                    },\r\n                                                    function (error) {\r\n                                                        saveResult =  false;\r\n                                                        callback(error);\r\n                                                    }\r\n                                                );\r\n                                            } else {\r\n                                                callback();\r\n                                            }\r\n                                        },\r\n                                        function (error) {\r\n                                            saveResult =  false;\r\n                                            callback(error);\r\n                                        }\r\n                                    );\r\n                                } else {\r\n                                    if (obj.documents) {\r\n                                        // Save documents first\r\n                                        obj.documents.save(\r\n                                            function () {\r\n                                                if (t && tid && t.aborted(tid)) {\r\n                                                    saveResult = false;\r\n                                                    callback('aborted');\r\n                                                }\r\n                                                callback();\r\n                                            },\r\n                                            function (error) {\r\n                                                saveResult = false;\r\n                                                callback(error);\r\n                                            }\r\n                                        );\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        function (error) {\r\n                            if (!error && saveResult) {\r\n                                // удаляем ненужные объекты перед сохранением\r\n                                // вызываем колбек\r\n                                if (t & !params.skipTransactionEnd) t.end();\r\n                                _.each(params.item.content, function(item){\r\n                                    delete item.pictures;\r\n                                    delete item.documents;\r\n                                });\r\n                                if (successCallback) successCallback();\r\n                            } else {\r\n                                // вызываем ошибочный колбек\r\n                                if (t) t.end(error);\r\n                                if (errorCallback) {\r\n                                    errorCallback(error);\r\n                                }\r\n                            }\r\n                        }\r\n                    );\r\n                } else {\r\n                    if (params.pictures) {\r\n                        // Save pictures first\r\n                        params.pictures.save(\r\n                            function () {\r\n                                if (t && tid && t.aborted(tid)) return;\r\n\r\n                                // Save documents second\r\n                                if (params.documents) {\r\n                                    params.documents.save(\r\n                                        function () {\r\n                                            if (t && tid && t.aborted(tid)) return;\r\n                                            // Do everything else\r\n                                            if (t & !params.skipTransactionEnd) t.end();\r\n                                            if (successCallback) successCallback();\r\n                                        },\r\n                                        function (error) {\r\n                                            if (t) t.end(error);\r\n                                            if (errorCallback) errorCallback(error);\r\n                                        }\r\n                                    );\r\n                                } else {\r\n                                    // Do everything else\r\n                                    if (t & !params.skipTransactionEnd) t.end();\r\n                                    if (successCallback) successCallback();\r\n                                }\r\n                            },\r\n                            function (error) {\r\n                                if (t) t.end(error);\r\n                                if (errorCallback) errorCallback(error);\r\n                            }\r\n                        );\r\n                    } else if (params.documents) {\r\n                        // Save documents first\r\n                        params.documents.save(\r\n                            function () {\r\n                                if (t && tid && t.aborted(tid)) return;\r\n                                // Do everything else\r\n                                if (t & !params.skipTransactionEnd) t.end();\r\n                                if (successCallback) successCallback();\r\n                            },\r\n                            function (error) {\r\n                                if (t) t.end(error);\r\n                                if (errorCallback) errorCallback(error);\r\n                            }\r\n                        );\r\n                    } else {\r\n                        // Do everything else\r\n                        if (t & !params.skipTransactionEnd) t.end();\r\n                        if (successCallback) successCallback();\r\n                    }\r\n                }\r\n            };\r\n\r\n            // Abort transaction with file upload\r\n            function abortFilesCurl(params) {\r\n                if (params.pictures) \r\n                    params.pictures.abort();\r\n                if (params.documents)\r\n                    params.documents.abort();\r\n                    if (params.transaction)\r\n                    params.transaction.abort();  \r\n            };\r\n\r\n            return {\r\n                extendApi: extendApi,\r\n\r\n                // Executing transactional requests to server\r\n                execute: executeCurl,\r\n\r\n                // Creating an object\r\n                create: createCurl,\r\n\r\n                // Updating an object\r\n                update: updateCurl,\r\n                save: updateCurl,\r\n\r\n                // Deleting an object\r\n                'delete': deleteCurl,\r\n                remove: deleteCurl,\r\n\r\n                // Reading objects\r\n                read: readCurl,\r\n                query: readCurl,\r\n\r\n                // Reading a single object\r\n                readOne: readOneCurl,\r\n                get: readOneCurl,\r\n\r\n                // Reading paginated results\r\n                page: pageCurl,\r\n                readPage: pageCurl,\r\n                queryPage: pageCurl,\r\n\r\n                // Saving files to file store\r\n                saveFiles: saveFilesCurl,\r\n                abortFiles: abortFilesCurl\r\n            }\r\n        }];\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Feedbacks data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipFeedbacksData', ['pipRest', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipFeedbacksData', function() {\r\n\r\n        this.readFeedbacksResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.feedbacks().query().$promise;\r\n            }];\r\n        };\r\n\r\n        this.readFeedbackResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.feedbacks().get({\r\n                    id: $stateParams.id\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        this.$get = ['$stateParams', 'pipRest', 'pipDataModel', function($stateParams, pipRest, pipDataModel) {\r\n            return {\r\n\r\n                sendFeedback: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'feedbacks';\r\n                    pipDataModel.create(params, successCallback, errorCallback);\r\n                },\r\n\r\n                createFeedbackWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'feedbacks';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.create(params, successCallback, errorCallback);\r\n                    });\r\n                },\r\n\r\n                updateFeedback: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'feedbacks';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.update(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                deleteFeedback: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'feedbacks';\r\n                    pipDataModel.remove(params, successCallback, errorCallback);\r\n                }\r\n            };\r\n        }];\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Guides data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipGuidesData', ['pipRest', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipGuidesData', function () {\r\n        var PAGE_SIZE = 5;\r\n\r\n        // Read all guides\r\n        this.readGuidesResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.guides().query().$promise;\r\n            }];\r\n        };\r\n        \r\n        this.readIntroGuidesResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.guides().query({\r\n                        type: 'intro',\r\n                        status : 'completed'\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        this.readGuideResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.guides().get({\r\n                    id: $stateParams.id || '55bf23d3bb22aa175c3e498e'\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        // CRUD operations and other business methods\r\n        this.$get = ['pipRest', '$stateParams', 'pipDataModel', function (pipRest, $stateParams, pipDataModel) {\r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                updateGuide: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'guides';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.update(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                readGuides: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'guides';\r\n                    params.party_id = pipRest.partyId($stateParams);\r\n                    params.type = 'intro';\r\n                    pipDataModel.read(params, successCallback, errorCallback);\r\n                },\r\n\r\n                createGuideWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'guides';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.create(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n                \r\n                updateGuideWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'guides';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.update(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                createGuide: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'guides';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.create(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n                \r\n                deleteGuide: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'guides';\r\n                    pipDataModel.remove(params, successCallback, errorCallback);\r\n                }\r\n\r\n            }\r\n        }];\r\n    });\r\n\r\n})();","/**\r\n * @file Image sets data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n /* global angular */\r\n \r\n(function () {\r\n    'use strict';\r\n    \r\n    var thisModule = angular.module('pipImageSetsData', ['pipRest', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipImageSetsData', function () {\r\n        var PAGE_SIZE = 15;\r\n\r\n        // Read all image sets\r\n        this.readImageSetsResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.image_sets().get({\r\n                    paging: 1,\r\n                    skip: 0,\r\n                    take: PAGE_SIZE,\r\n                    search: $stateParams.search,\r\n                    //tags: $stateParams.search\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        this.readImageSetResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.image_sets().get({\r\n                    id: $stateParams.id\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        // CRUD operations and other business methods\r\n        this.$get = ['pipRest', '$stateParams', 'pipDataModel', function (pipRest, $stateParams, pipDataModel) {\r\n\r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                readImageSets: function (params, transaction, successCallback, errorCallback) {\r\n                    params.resource = 'image_sets';\r\n\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    params.item.search = $stateParams.search || params.item.search;\r\n                   // params.item.tags = $stateParams.search || params.item.search;\r\n\r\n                    params.item.party_id = pipRest.partyId($stateParams);\r\n                    params.item.take = PAGE_SIZE;\r\n                    params.item.paging = 1;\r\n\r\n                    pipDataModel.page(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                updateImageSet: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'image_sets';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.update(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                createImageSet: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'image_sets';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.create(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                createImageSetWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'image_sets';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.create(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                updateImageSetWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'image_sets';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.update(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                deleteImageSet: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'image_sets';\r\n                    pipDataModel.remove(params, successCallback, errorCallback);\r\n                }\r\n            }\r\n        }];\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Session data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSessionData', ['pipRest', 'pipSessionCache']);\r\n\r\n    thisModule.provider('pipSessionData', function() {\r\n\r\n        readUserResolver.$inject = ['pipSessionCache'];\r\n        readPartyResolver.$inject = ['pipSessionCache', '$stateParams'];\r\n        readConnectionResolver.$inject = ['pipSessionCache', '$stateParams'];\r\n        readSettingsResolver.$inject = ['pipSessionCache'];\r\n        readSessionsUserResolver.$inject = ['$stateParams', 'pipRest', '$rootScope'];\r\n        readSessionIdResolver.$inject = ['$stateParams', 'pipSession'];\r\n        this.readUserResolver = /* @ngInject */ readUserResolver;\r\n        this.readPartyResolver = /* @ngInject */ readPartyResolver;\r\n        this.readConnectionResolver = /* @ngInject */ readConnectionResolver;\r\n        this.readSettingsResolver = /* @ngInject */ readSettingsResolver;\r\n\r\n        this.readSessionsUserResolver = /* @ngInject */ readSessionsUserResolver;\r\n        this.readSessionIdResolver = /* @ngInject */ readSessionIdResolver;\r\n\r\n        this.$get = ['$rootScope', '$stateParams', 'pipRest', function($rootScope, $stateParams, pipRest) {\r\n            return {\r\n                getSessionId: getSessionId,\r\n                removeSession: removeSession\r\n            };\r\n\r\n            function getSessionId(pipSession){\r\n                return function () {\r\n                    return pipSession.sessionId();\r\n                };\r\n            };\r\n\r\n            function removeSession(transaction, session, successCallback, errorCallback) {\r\n                var tid = transaction.begin('REMOVING');\r\n                if (!tid) return;\r\n\r\n                pipRest.userSessions().remove(\r\n                    {\r\n                        id: session.id,\r\n                        party_id: $stateParams.id\r\n                    },\r\n                    function (removedSession) {\r\n                        if (transaction.aborted(tid)) return;\r\n                        else transaction.end();\r\n\r\n                        if (successCallback) successCallback(removedSession);\r\n                    },\r\n                    function (error) {\r\n                        transaction.end(error);\r\n                        if (errorCallback) errorCallback(error);\r\n                    }\r\n                );\r\n            };\r\n            \r\n        }];\r\n        //--------------\r\n\r\n        function readUserResolver(pipSessionCache) {\r\n            return pipSessionCache.readUser();                             \r\n        };\r\n\r\n        function readPartyResolver(pipSessionCache, $stateParams) {\r\n            return pipSessionCache.readParty($stateParams);\r\n        };\r\n\r\n        function readConnectionResolver(pipSessionCache, $stateParams) {\r\n            return pipSessionCache.readConnection($stateParams);\r\n        };\r\n\r\n        function readSettingsResolver(pipSessionCache) {\r\n            return pipSessionCache.readSettings();                             \r\n        };\r\n\r\n        function readSessionsUserResolver($stateParams, pipRest, $rootScope) {\r\n            return pipRest.userSessions().query({\r\n                party_id: $stateParams.id\r\n            }).$promise;\r\n        };\r\n\r\n        function readSessionIdResolver($stateParams, pipSession) {\r\n            return pipSession.sessionId();\r\n        };\r\n        \r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Settings data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo Rewrite, use cached settings, remove unrelated methods\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSettingsData', ['pipRest', 'pipSessionData', 'pipSessionCache', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipSettingsData', ['pipSessionDataProvider', function(pipSessionDataProvider) {\r\n\r\n        this.readSettingsResolver = pipSessionDataProvider.readSettingsResolver;\r\n\r\n        this.$get = ['$rootScope', '$stateParams', 'pipRest', 'pipSessionCache', 'pipSession', 'pipDataModel', function($rootScope, $stateParams, pipRest, pipSessionCache, pipSession, pipDataModel) {\r\n            return {\r\n                // Saving generic settings\r\n                saveSettings: saveSettings,\r\n\r\n                readSettings: readSettings,\r\n\r\n                reReadSettings: reReadSettings\r\n\r\n            };\r\n\r\n            function readSettings(successCallback, errorCallback) {\r\n                pipSessionCache.readSettings(successCallback, errorCallback)\r\n            };\r\n\r\n            // force read settings from server and update cache\r\n            function reReadSettings(successCallback, errorCallback) {\r\n                pipRest.partySettings().get(\r\n                    {\r\n                        party_id: pipSession.userId()\r\n                    },\r\n                    function (settings) {\r\n                        settings = settings || {};\r\n                        pipSessionCache.onSettingsUpdate(settings);\r\n                        if (successCallback) successCallback(settings);\r\n                    },\r\n                    errorCallback\r\n                );\r\n            };\r\n\r\n            function saveSettings(settings, keys, successCallback, errorCallback) {\r\n                // Extract specific keys\r\n                settings = keys ? _.pick(settings, keys) : settings;\r\n                settings.party_id = pipSession.userId();\r\n                var oldSettings = _.cloneDeep($rootScope.$settings);\r\n                pipSessionCache.onSettingsUpdate(settings);\r\n\r\n                var params = {};\r\n                params.resource = 'partySettings';\r\n                params.item = settings;\r\n                params.item.creator_id = pipSession.userId();\r\n\r\n                pipDataModel.create(\r\n                    params,\r\n                    successCallback,\r\n                    function(error) {\r\n                        pipSessionCache.onSettingsUpdate(oldSettings);\r\n\r\n                        if (errorCallback) errorCallback(error);\r\n                    }\r\n                );\r\n            };\r\n        }];\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Tags data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTagsData', ['pipRest' , 'pipDataModel', 'pipTagsCache']);\r\n\r\n    thisModule.provider('pipTagsData', function() {\r\n        \r\n        this.readTagsResolver = function() {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', 'pipTagsCache', function($stateParams, pipRest, pipTagsCache) {\r\n                return pipTagsCache.readTags({\r\n                    item: { party_id: pipRest.partyId($stateParams) }\r\n                });\r\n            }];\r\n        };\r\n\r\n        this.$get = ['$stateParams', '$state', 'pipRest', 'pipDataModel', 'pipTagsCache', function($stateParams, $state, pipRest, pipDataModel, pipTagsCache) {\r\n            return {\r\n                partyId: pipRest.partyId,\r\n                \r\n                readTags: function(params, successCallback, errorCallback) {\r\n                    pipTagsCache.readTags(params, successCallback, errorCallback);\r\n                }\r\n            }\r\n        }];\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Tips data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTipsData', ['pipRest', 'pipDataModel']);\r\n\r\n    thisModule.provider('pipTipsData', function () {\r\n        var PAGE_SIZE = 100;\r\n\r\n        // Read all tips\r\n        this.readTipsResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.tips().query().$promise;\r\n            }];\r\n        };\r\n\r\n        this.readTipResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.tips().get({\r\n                    id: $stateParams.id\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        // CRUD operations and other business methods\r\n        this.$get = ['pipRest', '$stateParams', 'pipDataModel', function (pipRest, $stateParams, pipDataModel) {\r\n\r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                readTips: function (params, transaction, successCallback, errorCallback) {\r\n                    params.resource = 'tips';\r\n\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    params.item.search = $stateParams.search;\r\n                    params.item.tags = $stateParams.search;\r\n\r\n                    params.item.party_id = pipRest.partyId($stateParams);\r\n                    params.item.take = PAGE_SIZE;\r\n                    params.item.paging = 1;\r\n\r\n                    pipDataModel.page(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                updateTip: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'tips';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.update(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                createTip: function (params, successCallback, errorCallback) {\r\n                    params.resource = 'tips';\r\n                    params.skipTransactionBegin = true;\r\n                    params.skipTransactionEnd = false;\r\n                    pipDataModel.create(\r\n                        params,\r\n                        successCallback,\r\n                        errorCallback\r\n                    );\r\n                },\r\n\r\n                createTipWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'tips';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.create(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                updateTipWithFiles: function(params, successCallback, errorCallback) {\r\n                    params.skipTransactionEnd = true;\r\n                    pipDataModel.saveFiles(params, function() {\r\n                        params.resource = 'tips';\r\n                        params.skipTransactionBegin = true;\r\n                        params.skipTransactionEnd = false;\r\n                        pipDataModel.update(\r\n                            params,\r\n                            successCallback,\r\n                            errorCallback\r\n                        );\r\n                    });\r\n                },\r\n\r\n                deleteTip: function(params, successCallback, errorCallback) {\r\n                    params.resource = 'tips';\r\n                    pipDataModel.remove(params, successCallback, errorCallback);\r\n                }\r\n            }\r\n        }];\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Users data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUsersData', ['pipRest']);\r\n\r\n    thisModule.provider('pipUsersData', function () {\r\n\r\n        this.readUsersResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.users().page({\r\n                    party_id: $stateParams.id,\r\n                    paging: $stateParams.paging || 1,\r\n                    skip: $stateParams.skip || 0,\r\n                    take: $stateParams.take || 15\r\n                }).$promise;\r\n            }];\r\n        };\r\n\r\n        this.readUserResolver = function () {\r\n            return /* @ngInject */ ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.users().get({\r\n                    id: $stateParams.id,\r\n                    party_id: pipRest.partyId($stateParams)\r\n                }).$promise;\r\n\r\n            }];\r\n        };\r\n\r\n        this.readActivitiesUserResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', '$rootScope', function ($stateParams, pipRest, $rootScope) {\r\n                return pipRest.partyActivities().page({\r\n                    party_id: $rootScope.$user.id,\r\n                    paging: 1,\r\n                    skip: 0,\r\n                    take: 25\r\n                }).$promise;\r\n            }];\r\n\r\n        // CRUD operations and other business methods\r\n        this.$get = ['pipRest', '$stateParams', function (pipRest, $stateParams) {   \r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                readUsers: function (params, transaction, successCallback, errorCallback) {\r\n                    pipRest.users().page(\r\n                        {\r\n                            party_id: pipRest.partyId($stateParams),\r\n                            paging: 1,\r\n                            skip: params.start,\r\n                            search: params.item.search ,\r\n                            active: params.item.active,\r\n                            paid: params.item.paid,\r\n                            admin: params.item.admin,\r\n                            take: 15\r\n                        },\r\n                        function (pagedUsers) {\r\n                            if (successCallback) successCallback(pagedUsers);\r\n                        },\r\n                        function (error) {\r\n                            errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n                \r\n                updateUser: function (item, transaction, successCallback, errorCallback) {\r\n                    pipRest.users().update(\r\n                        item.item,\r\n                        function (updatedItem) {\r\n                            if (successCallback) successCallback(updatedItem);\r\n                        },\r\n                        function (error) {\r\n                            errorCallback(error);\r\n                        }\r\n                    );\r\n                }\r\n\r\n            }\r\n        }];\r\n    });\r\n\r\n})();","/**\r\n * @file Registration of all application layouts\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipLayout', [\r\n        'pipLayout.Main', 'pipLayout.Simple', 'pipLayout.Card', 'pipLayout.Document',\r\n        'pipLayout.Tiles', 'pipLayout.Dialog', 'pipLayout.Split'\r\n    ]);\r\n\r\n})();\r\n","/**\r\n * @file Card layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Card', []);\r\n\r\n    thisModule.directive('pipCard', function() {\r\n        return {\r\n           restrict: 'EA',\r\n           //controller: 'pipCardController'\r\n            link: function($scope, $element, $attrs) {\r\n                var $window = $(window);\r\n\r\n                // Add class to the element\r\n                $element.addClass('pip-card');\r\n\r\n                // Resize every time window is resized\r\n                $scope.$on('pipWindowResized', resize);\r\n\r\n                // Resize right away to avoid flicking\r\n                resize();\r\n\r\n                // Resize the element right away\r\n                setTimeout(resize, 100);\r\n\r\n                return;\r\n\r\n                //---------------\r\n\r\n                function resize() {\r\n                    var\r\n                        $mainBody = $('.pip-main-body'),\r\n                        cardContainer = $('.pip-card-container'),\r\n                        windowWidth = $window.width(),\r\n                        maxWidth = $mainBody.width(),\r\n                        maxHeight = $mainBody.height(),\r\n                        minWidth = $attrs.minWidth ? Math.floor($attrs.minWidth) : null,\r\n                        minHeight = $attrs.minHeight ? Math.floor($attrs.minHeight) : null,\r\n                        width = $attrs.width ? Math.floor($attrs.width) : null,\r\n                        height = $attrs.height ? Math.floor($attrs.height) : null,\r\n                        left, top;\r\n\r\n                    // Full-screen on phone\r\n                    if (windowWidth <= 768) {\r\n                        minWidth = null;\r\n                        minHeight = null;\r\n                        width = null;\r\n                        height = null;\r\n                        maxWidth = null;\r\n                        maxHeight = null;\r\n                    }\r\n                    // Card view with adjustable margins on tablet and desktop\r\n                    else {\r\n                        // Set margin and maximum dimensions\r\n                        var space = windowWidth > 1200 ? 24 : 16;\r\n                        maxWidth -= space * 2;\r\n                        maxHeight -= space * 2;\r\n\r\n                        // Set minimum dimensions\r\n                        minWidth = minWidth ? Math.min(minWidth, maxWidth) : null;\r\n                        minHeight = minHeight ? Math.min(minHeight, maxHeight) : null;\r\n\r\n                        // Set regular dimensions\r\n                        width = width ? Math.min(width, maxWidth) : null;\r\n                        height = height ? Math.min(height, maxHeight) : null;\r\n                    }\r\n\r\n                    // Set dimensions\r\n                    $element.css('max-width', maxWidth ? maxWidth + 'px' : '');\r\n                    $element.css('min-width', minWidth ? minWidth + 'px' : '');\r\n                    $element.css('width', width ? width + 'px' : '');\r\n                    $element.css('height', height ? height + 'px' : '');\r\n\r\n                    if (!cardContainer.hasClass('pip-outer-scroll'))\r\n                    {\r\n                        $element.css('max-height', maxHeight ? maxHeight + 'px' : '');\r\n                        $element.css('min-height', minHeight ? minHeight + 'px' : '');\r\n                        var\r\n                            $header = $element.find('.pip-header:visible'),\r\n                            $footer = $element.find('.pip-footer:visible'),\r\n                            $body = $element.find('.pip-body'),\r\n                            maxBodyHeight = maxHeight || $mainBody.height();\r\n\r\n                        if ($header.length > 0)\r\n                            maxBodyHeight -= $header.outerHeight(true);\r\n                        if ($footer.length > 0)\r\n                            maxBodyHeight -= $footer.outerHeight(true);\r\n\r\n                        $body.css('max-height', maxBodyHeight + 'px');\r\n                    } else {\r\n                        cardContainer.addClass('pip-scroll');\r\n                        if (windowWidth <= 768) {\r\n                            left = 0;\r\n                            top = 0;\r\n                        } else {\r\n                            left = cardContainer.width() / 2 - $element.width() / 2 - 16;\r\n                            top = Math.max(cardContainer.height() / 2 - $element.height() / 2 - 16, 0);\r\n                        }\r\n\r\n                        $element.css('left', left);\r\n                        $element.css('top', top);\r\n                        setTimeout(function () {\r\n                            $element.css('display', 'flex');\r\n                        }, 100);\r\n                    }\r\n\r\n                    // Notify child controls that layout was resized\r\n                    $scope.$broadcast('pipLayoutResized');\r\n                };\r\n            }\r\n        }\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Dialog layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Dialog', []);\r\n\r\n    thisModule.directive('pipDialog', function() {\r\n        return {\r\n           restrict: 'EA',\r\n           controller: 'pipDialogController'\r\n        };\r\n    });\r\n\r\n    thisModule.controller('pipDialogController', \r\n        ['$scope', '$element', '$attrs', function($scope, $element, $attrs) {\r\n            var $window = $(window);\r\n\r\n            // Add class to the element\r\n            $element.addClass('pip-dialog');\r\n\r\n            // Resize every time window is resized\r\n            $scope.$on('pipWindowResized', resize);\r\n\r\n            $scope.$on('pipResizeLayout', resize);\r\n\r\n\r\n            // Resize right away to avoid flicking\r\n            resize();\r\n\r\n            // Resize the element right away\r\n            //setTimeout(resize, 0);\r\n            $window.trigger('resize');\r\n\r\n            return;\r\n\r\n            //-----------------------\r\n\r\n            function resize() {\r\n                var\r\n                    maxWidth = $window.width(),\r\n                    maxHeight = $window.height(),\r\n                    minWidth = $attrs.minWidth ? Math.floor($attrs.minWidth) : null,\r\n                    minHeight = $attrs.minHeight ? Math.floor($attrs.minHeight) : null,\r\n                    width = $attrs.width ? Math.floor($attrs.width) : null,\r\n                    height = $attrs.height ? Math.floor($attrs.height) : null;\r\n\r\n                // Set margin and maximum dimensions\r\n                var space = maxWidth > 1200 ? 24 : 16;\r\n                maxWidth -= space * 2;\r\n                maxHeight -= space * 2;\r\n\r\n                // Set minimum dimensions\r\n                minWidth = minWidth && minWidth < maxWidth ? minWidth : null;\r\n                minHeight = minHeight && minHeight < maxHeight ? minHeight : null;\r\n\r\n                // Set regular dimensions\r\n                width = width ? Math.min(width, maxWidth) : null;\r\n                height = height ? Math.min(height, maxHeight) : null;\r\n\r\n                // Set dimensions\r\n                $element.css('max-width', maxWidth ? maxWidth + 'px' : '');\r\n                $element.css('max-height', maxHeight ? maxHeight + 'px' : '');\r\n                $element.css('min-width', minWidth ? minWidth + 'px' : '');\r\n                $element.css('min-height', minHeight ? minHeight + 'px' : '');\r\n                $element.css('width', width ? width + 'px' : '');\r\n                $element.css('height', height ? height + 'px' : '');\r\n\r\n                // Notify child controls that layout was resized\r\n                $scope.$broadcast('pipLayoutResized');\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Document layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Document', []);\r\n\r\n    thisModule.directive('pipDocument', function() {\r\n        return {\r\n           restrict: 'EA',\r\n           controller: 'pipDocumentController'\r\n        };\r\n    });\r\n\r\n    thisModule.controller('pipDocumentController', \r\n        ['$scope', '$element', '$attrs', function($scope, $element, $attrs) {\r\n            // Add class to the element\r\n            $element.addClass('pip-document');\r\n        }]\r\n    );    \r\n\r\n})();\r\n","/**\r\n * @file Top-level application container\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Main', []);\r\n\r\n    thisModule.directive('pipMain', function() {\r\n        return {\r\n           restrict: 'EA',\r\n           controller: 'pipMainController' \r\n        }\r\n    });\r\n\r\n    thisModule.directive('pipMainBody', function() {\r\n       return {\r\n           restrict: 'EA',\r\n           link: function($scope, $element) {\r\n                $element.addClass('pip-main-body');\r\n           }\r\n       };\r\n    });\r\n\r\n    thisModule.controller('pipMainController',\r\n        ['$scope', '$element', '$rootScope', function($scope, $element, $rootScope) {\r\n            var $window = $(window);\r\n\r\n            // Add CSS class\r\n            $element.addClass('pip-main');\r\n\r\n            // Handle window resize events\r\n            $window.bind('resize', resize);\r\n\r\n            // Unbind when scope is removed\r\n            $scope.$on('$destroy', function() {\r\n                $rootScope.$size = undefined;\r\n                $window.unbind('resize', resize);\r\n            });\r\n\r\n            // Resize window from request\r\n            $rootScope.$on('pipResizeWindow', function(event) {\r\n                // Trigger a bit latter t allow full initialization\r\n                // Do not remove! Otherwise, sizes in layouts calculated incorrectly\r\n                setTimeout(resize, 0);\r\n            });\r\n\r\n            // Allow to finish initialization of all controllers\r\n            setTimeout(resize, 0);\r\n\r\n            return;\r\n            \r\n            //---------------\r\n\r\n            function resize() {\r\n                $rootScope.$broadcast('pipWindowResized');\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Simple layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Simple', []);\r\n\r\n    thisModule.directive('pipSimple', function() {\r\n       return {\r\n           restrict: 'EA',\r\n           link: function($scope, $element, $attrs) {\r\n                $element.addClass('pip-simple');\r\n           }\r\n       };\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Split layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Split', []);\r\n\r\n    thisModule.run( ['$rootScope', 'pipSplit', function($rootScope, pipSplit) {\r\n        // Intercept routes\r\n        $rootScope.$on('$stateChangeStart',\r\n            function(event, toState, toParams, fromState, fromParams) {\r\n                // Split animation\r\n                var splitElements = $('.pip-split');\r\n                if (splitElements.length > 0) {\r\n                    splitElements.removeClass('pip-transition-forward');\r\n                    splitElements.removeClass('pip-transition-back');\r\n                    if (toState.name != fromState.name) {\r\n                        if (pipSplit.forwardTransition(toState, fromState))\r\n                            splitElements.addClass('pip-transition-forward');\r\n                        else\r\n                            splitElements.addClass('pip-transition-back');\r\n                    }\r\n                }\r\n\r\n            }\r\n        );\r\n\r\n    }]);\r\n\r\n    thisModule.provider('pipSplit', function() {\r\n        var transitionSequences = [];\r\n\r\n        this.addTransitionSequence = addTransitionSequence;\r\n\r\n        this.$get = function () {\r\n            return {\r\n                forwardTransition: forwardTransition\r\n            };\r\n        };\r\n\r\n        return;\r\n\r\n        //----------------------------\r\n\r\n        function addTransitionSequence(sequence) {\r\n            if (!_.isArray(sequence) || sequence.length == 0)\r\n                throw new Error('Transition sequence must be an array of state names');\r\n\r\n            transitionSequences.push(sequence);\r\n        }\r\n\r\n        function forwardTransition(toState, fromState) {\r\n            for (var i = 0; i < transitionSequences.length; i++) {\r\n                var toIndex = transitionSequences[i].indexOf(toState.name);\r\n                var fromIndex = transitionSequences[i].indexOf(fromState.name);\r\n\r\n                if (toIndex > -1)\r\n                    return toIndex > fromIndex;\r\n            }\r\n            return false\r\n        }\r\n\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Tiles layout\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global $, angular, Masonry */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLayout.Tiles', ['wu.masonry']);\r\n\r\n    thisModule.directive('pipTiles', function() {\r\n       return {\r\n           restrict: 'EA',\r\n           scope: false,\r\n           transclude: true,\r\n           template:\r\n               function($element, $attrs) {\r\n                   if (convertToBoolean($attrs.pipInfinite)) {\r\n                       return  String()\r\n                       + '<div masonry class=\"pip-tiles-container\" load-images=\"false\" preserve-order  '\r\n                       + ' ng-transclude column-width=\".pip-tile-sizer\" item-selector=\".pip-tile\"'\r\n                       + ' masonry-options=\"tilesOptions\"  pip-scroll-container=\"\\'.pip-tiles\\'\"'\r\n                       + ' pip-infinite-scroll=\"readScroll()\" >'\r\n                       + '</div>';\r\n                   } else {\r\n                       return String()\r\n                           + '<div masonry class=\"pip-tiles-container\" load-images=\"false\" preserve-order  '\r\n                           + ' ng-transclude column-width=\".pip-tile-sizer\" item-selector=\".pip-tile\"'\r\n                           + ' masonry-options=\"tilesOptions\">'\r\n                           + '</div>';\r\n                   }\r\n               },\r\n           controller: ['$scope', function($scope) {\r\n                $scope.tilesOptions = {\r\n                    gutter: 8,//16\r\n                    isFitWidth: false,\r\n                    isResizeBound: false,\r\n                    transitionDuration: 0 // '0.2s'\r\n                };\r\n           }],\r\n           link: pipTilesController \r\n        };\r\n    });\r\n\r\n    function pipTilesController($scope, $element, $attrs) {\r\n        var\r\n            $window = $(window),\r\n            columnWidth = $attrs.columnWidth ? Math.floor($attrs.columnWidth) : 440,\r\n            container = $element.children('.pip-tiles-container'),\r\n            prevContainerWidth = null,\r\n            masonry = Masonry.data(container[0]);\r\n\r\n\r\n        // Add class to the element\r\n        $element.addClass('pip-tiles');\r\n\r\n        // Insert sizer\r\n        var sizer = $('<div class=\"pip-tile-sizer\"></div>');\r\n        sizer.appendTo(container);\r\n\r\n        // Resize every time window is resized\r\n        $scope.$on('pipWindowResized', function () {\r\n            resize(false);\r\n        });\r\n\r\n        // Force layout by request\r\n        $scope.$on('pipResizeLayout', function () {\r\n            resize(true);\r\n        });\r\n\r\n        // Resize the element right away\r\n        resize();\r\n\r\n        return;\r\n\r\n        //--------------------\r\n\r\n        function resize(force) {\r\n            var\r\n                width = $window.width(),\r\n                containerWidth;\r\n\r\n            if (width > 767) {\r\n                width = width - 24 * 2;\r\n\r\n                var columns = Math.floor(width / columnWidth);\r\n                containerWidth = (columnWidth + 16) * columns - 16;\r\n\r\n                if (containerWidth > width) {\r\n                    columns--;\r\n                    containerWidth = (columnWidth + 16) * columns - 16;\r\n                }\r\n\r\n                if (columns < 1) {\r\n                    containerWidth = width;\r\n                    sizer.css('width', containerWidth + 'px');\r\n                } else {\r\n                    sizer.css('width', columnWidth + 'px');\r\n                }\r\n\r\n                // +1 to avoid precision related error\r\n                container.css('width', (containerWidth + 1) + 'px');\r\n            } else {\r\n                width = width - 16 * 2;\r\n                containerWidth = width;\r\n\r\n                sizer.css('width', containerWidth + 'px');\r\n                // +1 to avoid precision related error\r\n                container.css('width', (containerWidth + 1) + 'px');\r\n            }\r\n\r\n            // Manually call layout on tile container\r\n            if (prevContainerWidth != containerWidth || force) {\r\n                prevContainerWidth = containerWidth;\r\n                masonry.layout();\r\n\r\n                // Notify child controls that layout was resized\r\n                $scope.$broadcast('pipLayoutResized');\r\n            }\r\n        }\r\n    }\r\n\r\n    // Converts value into boolean\r\n    function convertToBoolean(value) {\r\n        if (value == null) return false;\r\n        if (!value) return false;\r\n        value = value.toString().toLowerCase();\r\n        return value == '1' || value == 'true';\r\n    };\r\n\r\n})();\r\n","(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('color_picker/color_picker.html',\n    '<ul class=\"pip-color-picker lp0 {{class}}\" pip-selected=\"currentColorIndex\" pip-enter-space-press=\"enterSpacePress($event)\">\\n' +\n    '    <li tabindex=\"-1\" ng-repeat=\"color in colors\">\\n' +\n    '        <md-button  tabindex=\"-1\" class=\"md-icon-button pip-selectable\" ng-click=\"selectColor($index)\" aria-label=\"color\" ng-disabled=\"disabled()\">\\n' +\n    '            <md-icon ng-style=\"{\\'color\\': color}\" md-svg-icon=\"icons:{{ color == currentColor ? \\'circle\\' : \\'radio-off\\' }}\">\\n' +\n    '            </md-icon>\\n' +\n    '        </md-button>\\n' +\n    '    </li>\\n' +\n    '</ul>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('confirmation_dialog/confirmation_dialog.html',\n    '<!--\\n' +\n    '@file Confirmation dialog template\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-confirmation-dialog\" layout=\"column\" width=\"400\" md-theme=\"{{theme}}\">\\n' +\n    '    <div class=\"pip-header text-subhead1\">\\n' +\n    '        <h3 class=\"m0\">{{ title | translate }}</h3>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div>\\n' +\n    '            <md-button ng-click=\"onCancel()\">{{ cancel | translate }}</md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onOk()\">{{ ok | translate }}</md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('conversion_dialog/conversion_dialog.html',\n    '<!--\\n' +\n    '@file Conversion dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-conversion-dialog\" layout=\"column\" min-width=\"450\" md-theme=\"{{theme}}\">\\n' +\n    '    <md-dialog-content class=\"pip-body p0 pip-scroll\">\\n' +\n    '        <div class=\"pip-header\" ng-if=\"!withoutTitle || deleted\" ng-class=\"{\\'header-hint\\': withoutTitle && deleted}\">\\n' +\n    '            <h3 class=\"m0 text-title\" ng-hide=\"withoutTitle\">\\n' +\n    '                {{::title | translate}}\\n' +\n    '            </h3>\\n' +\n    '            <p class=\"tp8 pip-subtitle\" ng-hide=\"withoutTitle\">\\n' +\n    '                <span pip-translate-html=\"{{::subtitle | translate}}\"/>\\n' +\n    '            </p>\\n' +\n    '            <div ng-show=\"withoutTitle && deleted\" class=\"dialog-hint\" layout=\"row\" layout-align=\"start center\">\\n' +\n    '                <div class=\"w40\" flex-fixed><md-icon md-svg-icon=\"icons:info-circle-outline\"></md-icon></div>\\n' +\n    '                <div>{{::withoutTitle | translate}}</div>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-divider\"  ng-if=\"!withoutTitle\"></div>\\n' +\n    '        <div class=\"h8\"  ng-if=\"withoutTitle\"></div>\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <div class=\"pip-list md-primary\" md-no-ink=\"true\" ng-keydown=\"onKeyDown($event)\"\\n' +\n    '                            ng-keypress=\"onKeyPress($event)\" tabindex=\"0\">\\n' +\n    '                <div ng-repeat=\"option in options\" class=\"pip-list-item\" md-ink-ripple\\n' +\n    '                     ui-event=\"{ click: \\'onOptionSelect($event, option)\\' }\"\\n' +\n    '                     ng-class=\"{ selected: option.name == selectedOptionName,\\n' +\n    '                            \\'divider-bottom\\': $index < options.length - 1 }\">\\n' +\n    '\\n' +\n    '                        <div class=\"pip-content lp24-flex rp24-flex\" flex>\\n' +\n    '                            <div class=\"pip-title\" ng-if=\"option.title\">\\n' +\n    '                                {{::option.title | translate}}\\n' +\n    '                            </div>\\n' +\n    '                            <div class=\"pip-subtitle\" ng-if=\"option.subtitle\">\\n' +\n    '                                <span pip-translate-html=\"{{::option.subtitle | translate}}\"/>\\n' +\n    '                            </div>\\n' +\n    '                            <div class=\"pip-text\" ng-if=\"option.text\">\\n' +\n    '                                <span pip-translate-html=\"{{::option.text | translate}}\"/>\\n' +\n    '                            </div>\\n' +\n    '                        </div>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"h8\"></div>\\n' +\n    '    </md-dialog-content>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('date/date.html',\n    '<!--\\n' +\n    '@file Date control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-date\" tabindex=\"-1\" layout=\"row\" flex>\\n' +\n    '\t<md-input-container flex class=\"tm0\">\\n' +\n    '\t\t<md-select class=\"pip-date-day tm0\" ng-disabled=\"disableControls\"\\n' +\n    '\t\t\t\t   ng-model=\"day\" placeholder=\"{{dayLabel}}\" ng-change=\"onDayChanged()\" flex>\\n' +\n    '\t\t\t<md-option ng-value=\"opt\" ng-repeat=\"opt in days track by opt\">{{ opt }}</md-option>\\n' +\n    '\t\t</md-select>\\n' +\n    '\t</md-input-container>\\n' +\n    '\t<div class=\"w16 flex-fixed\"></div>\\n' +\n    '\t<md-input-container flex class=\"tm0\">\\n' +\n    '\t\t<md-select class=\"pip-date-month tm0\" ng-disabled=\"disableControls\"\\n' +\n    '\t\t\t\t   ng-model=\"month\" placeholder=\"{{monthLabel}}\" ng-change=\"onMonthChanged()\" flex>\\n' +\n    '\t\t\t<md-option ng-value=\"opt.id\" ng-repeat=\"opt in months track by opt.id\">{{ opt.name }}</md-option>\\n' +\n    '\t\t</md-select>\\n' +\n    '\t</md-input-container>\\n' +\n    '\t<div class=\"w16 flex-fixed\"></div>\\n' +\n    '\t<md-input-container flex class=\"tm0\">\\n' +\n    '\t\t<md-select class=\"pip-date-year tm0\" ng-disabled=\"disableControls\"\\n' +\n    '\t\t\t\t   ng-model=\"year\" placeholder=\"{{yearLabel}}\" ng-change=\"onYearChanged()\" flex>\\n' +\n    '\t\t\t<md-option ng-value=\"opt\" ng-repeat=\"opt in years track by opt\">{{ opt }}</md-option>\\n' +\n    '\t\t</md-select>\\n' +\n    '\t</md-input-container>\\n' +\n    '</div>\\n' +\n    '\t\t\t\t\t');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('date_range/date_range.html',\n    '<!--\\n' +\n    '@file Date range control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-date-range\" tabindex=\"-1\" layout=\"row\" flex>\\n' +\n    '    <md-input-container flex ng-show=\"isDay()\" class=\"tm0\">\\n' +\n    '        <md-select class=\"select-day w-stretch\"\\n' +\n    '                   ng-class=\"{\\'pip-no-line\\' : pipNoLine}\"\\n' +\n    '                   ng-disable=\"{{disableControls}}\"\\n' +\n    '                   md-on-open=\"onDayClick()\"\\n' +\n    '                   ng-model=\"day\"\\n' +\n    '                   ng-change=\"onDayChanged()\"\\n' +\n    '                   placeholder=\"{{dayLabel}}\"\\n' +\n    '                   aria-label=\"DAY\">\\n' +\n    '\\n' +\n    '            <md-option ng-value=\"opt\" ng-repeat=\"opt in days track by opt \">\\n' +\n    '               {{nameDays[$index]}} {{ opt }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '    <md-input-container flex ng-show=\"isWeek()\" class=\"tm0\">\\n' +\n    '        <md-select class=\"select-week w-stretch\"\\n' +\n    '                   ng-class=\"{\\'pip-no-line\\' : pipNoLine}\"\\n' +\n    '                   ng-disable=\"{{disableControls}}\"\\n' +\n    '                   ng-model=\"week\"\\n' +\n    '                   ng-change=\"onWeekChange()\"\\n' +\n    '                   placeholder=\"{{weekLabel}}\"\\n' +\n    '                   aria-label=\"WEEK\">\\n' +\n    '\\n' +\n    '            <md-option ng-value=\"opt.id\" ng-repeat=\"opt in weeks track by opt.id\">\\n' +\n    '                {{ opt.name }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container >\\n' +\n    '    <div class=\"flex-fixed\"\\n' +\n    '         ng-class=\"{\\'w16\\': $mdMedia(\\'gt-xs\\'), \\'w8\\':  $mdMedia(\\'xs\\')}\"\\n' +\n    '         ng-show=\"isDay() || isWeek()\">\\n' +\n    '    </div>\\n' +\n    '    <md-input-container flex ng-show=\"isMonth() && !monthFormatShort \" class=\"tm0 min-w72\">\\n' +\n    '        <md-select class=\"select-month w-stretch\"\\n' +\n    '                   ng-class=\"{\\'pip-no-line\\' : pipNoLine}\"\\n' +\n    '                   ng-disable=\"{{disableControls}}\"\\n' +\n    '                   md-on-open=\"onMonthClick()\"\\n' +\n    '                   ng-model=\"month\"\\n' +\n    '                   ng-change=\"onMonthChanged()\"\\n' +\n    '                   placeholder=\"{{monthLabel}}\"\\n' +\n    '                   aria-label=\"MONTH\">\\n' +\n    '\\n' +\n    '            <md-option ng-value=\"opt.id\" ng-repeat=\"opt in months track by opt.id\">\\n' +\n    '                {{ opt.name }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '    <md-input-container flex ng-show=\"isMonth() && monthFormatShort\" class=\"tm0\">\\n' +\n    '        <md-select class=\"select-month w-stretch\"\\n' +\n    '                   ng-class=\"{\\'pip-no-line\\' : pipNoLine}\"\\n' +\n    '                   ng-disable=\"{{disableControls}}\"\\n' +\n    '                   md-on-open=\"onMonthClick()\"\\n' +\n    '                   ng-model=\"month\"\\n' +\n    '                   ng-change=\"onMonthChanged()\"\\n' +\n    '                   placeholder=\"{{monthLabel}}\"\\n' +\n    '                   aria-label=\"MONTH\">\\n' +\n    '\\n' +\n    '            <md-option ng-value=\"opt.id\" ng-repeat=\"opt in shortMonths track by opt.id\">\\n' +\n    '                {{ opt.name }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '    <div class=\"flex-fixed\"\\n' +\n    '         ng-class=\"{\\'w16\\': $mdMedia(\\'gt-xs\\'), \\'w8\\':  $mdMedia(\\'xs\\')}\"\\n' +\n    '         ng-show=\"isMonth()\">\\n' +\n    '    </div>\\n' +\n    '    <md-input-container flex class=\"tm0\">\\n' +\n    '        <md-select class=\"select-year w-stretch\"\\n' +\n    '                   ng-class=\"{\\'pip-no-line\\' : pipNoLine}\"\\n' +\n    '                   ng-disable=\"{{disableControls}}\"\\n' +\n    '                   md-on-open=\"onYearClick()\"\\n' +\n    '                   ng-model=\"year\"\\n' +\n    '                   ng-change=\"onYearChanged()\"\\n' +\n    '                   placeholder=\"{{yearLabel}}\"\\n' +\n    '                   aria-label=\"YEAR\">\\n' +\n    '\\n' +\n    '            <md-option ng-value=\"opt\" ng-repeat=\"opt in years track by opt\">\\n' +\n    '                {{ opt }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('error_details_dialog/error_details_dialog.html',\n    '<!--\\n' +\n    '@file Confirmation dialog template\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-details-dialog\" layout=\"column\" width=\"400\" md-theme=\"{{theme}}\">\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '\\n' +\n    '        <div class=\"pip-header p0 bp8  text-subhead1\">{{::\\'ERROR_DETAILS\\' | translate}}</div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" class=\"h48 text-body2 color-secondary-text\" ng-if=\"error.code || (error.data && error.data.code)\">\\n' +\n    '            {{::\\'CODE\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" ng-if=\"error.code || (error.data && error.data.code)\">\\n' +\n    '            {{error.code || error.data.code}}\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" class=\"h48 text-body2 color-secondary-text\" ng-if=\"error.path || (error.data && error.data.path)\">\\n' +\n    '            {{::\\'PATH\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" ng-if=\"error.path || (error.data && error.data.path)\">\\n' +\n    '            {{error.path || error.data.path}}\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" class=\"h48 text-body2 color-secondary-text\" ng-if=\"error.error || (error.data && error.data.error)\">\\n' +\n    '            {{::\\'ERROR\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" ng-if=\"error.error || (error.data && error.data.error)\">\\n' +\n    '            {{error.error || error.data.error}}\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" class=\"h48 text-body2 color-secondary-text\" ng-if=\"error.method || (error.data && error.data.method)\">\\n' +\n    '            {{::\\'METHOD\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" ng-if=\"error.method || (error.data && error.data.method)\">\\n' +\n    '            {{error.method || error.data.method}}\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" class=\"h48 text-body2 color-secondary-text\" ng-if=\"error.message || (error.data && error.data.message)\">\\n' +\n    '            {{::\\'MESSAGE\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\" ng-if=\"error.message || (error.data && error.data.message)\">\\n' +\n    '            {{error.message || error.data.message}}\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-footer rp16\">\\n' +\n    '        <div>\\n' +\n    '            <md-button class=\"md-accent m0\" ng-click=\"onOk()\">{{::\\'DISMISS\\' | translate }}</md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('information_dialog/information_dialog.html',\n    '<!--\\n' +\n    '@file Information dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-information-dialog\" layout=\"column\" width=\"400\" md-theme=\"{{theme}}\">\\n' +\n    '    <div class=\"pip-header\">\\n' +\n    '        <h3 class=\"m0\">{{ title | translate }}</h3>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            {{ content }}\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onOk()\">{{ ok | translate }}</md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('options_dialog/options_dialog.html',\n    '<!--\\n' +\n    '@file Options dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-options-dialog\" layout=\"column\" min-width=\"400\" md-theme=\"{{theme}}\">\\n' +\n    '    <md-dialog-content class=\"pip-body lp0 tp0 rp0 bp24 pip-scroll\">\\n' +\n    '        <div class=\"pip-header\" >\\n' +\n    '            <h3 class=\"m0 bm16 text-title\">{{::title | translate}}</h3>\\n' +\n    '            <div ng-show=\"deletedTitle\" class=\"bp16 tp8 text-subhead1 divider-bottom\">\\n' +\n    '                <md-checkbox ng-model=\"deleted\" aria-label=\"CHECKBOX\" class=\"m0\">{{::deletedTitle | translate}}</md-checkbox>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <md-radio-group ng-model=\"selectedOptionName\" class=\"pip-list md-primary\" md-no-ink=\"true\"\\n' +\n    '                            ng-keypress=\"onKeyPress($event)\" tabindex=\"0\">\\n' +\n    '                <div ng-repeat=\"option in options\" class=\"pip-list-item p0\" md-ink-ripple\\n' +\n    '                     ui-event=\"{ click: \\'onOptionSelect($event, option)\\' }\"\\n' +\n    '                     ng-class=\"{ selected: option.name == selectedOptionName }\">\\n' +\n    '                    <div class=\"pip-list-item\">\\n' +\n    '                        <md-icon class=\"pip-option-icon rm12\" md-svg-icon=\"icons:{{option.icon}}\" ng-if=\"option.icon\">\\n' +\n    '                        </md-icon>\\n' +\n    '                        <div class=\"pip-option-title\">\\n' +\n    '                            {{::option.title | translate}}\\n' +\n    '                        </div>\\n' +\n    '                        <md-radio-button ng-value=\"option.name\" tabindex=\"-1\"\\n' +\n    '                                         aria-label=\"{{::option.title | translate}}\">\\n' +\n    '                        </md-radio-button>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                </div>\\n' +\n    '            </md-radio-group>\\n' +\n    '        </div>\\n' +\n    '    </md-dialog-content>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div>\\n' +\n    '            <md-button class=\"pip-cancel\" ng-click=\"onCancel()\">{{::\\'CANCEL\\' | translate}}</md-button>\\n' +\n    '            <md-button class=\"pip-submit md-accent\" ng-click=\"onSelect()\">{{::applyButtonTitle | translate}}</md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('options_dialog/options_dialog_big.html',\n    '<!--\\n' +\n    '@file Options dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-options-dialog-big\" layout=\"column\" min-width=\"400\" md-theme=\"{{theme}}\">\\n' +\n    '    <md-dialog-content class=\"pip-body p0 pip-scroll\" ng-class=\"{\\'bp24\\': !noActions}\">\\n' +\n    '        <div class=\"pip-header\" ng-class=\"{\\'header-hint\\': noTitle && hint}\">\\n' +\n    '            <h3 class=\"m0 text-title\"  ng-if=\"!noTitle\">\\n' +\n    '                {{::title | translate}}\\n' +\n    '            </h3>\\n' +\n    '            <div ng-show=\"noTitle && hint\" class=\"dialog-hint\" layout=\"row\" layout-align=\"start center\">\\n' +\n    '                <div class=\"w40\" flex-fixed><md-icon md-svg-icon=\"icons:info-circle-outline\"></md-icon></div>\\n' +\n    '                <div>{{::hint | translate}}</div>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-divider\"  ng-if=\"!noTitle\"></div>\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <div class=\"h8\" ng-if=\"noTitle && hint\"></div>\\n' +\n    '            <md-list class=\"pip-menu  pip-ref-list w-stretch\"\\n' +\n    '                     pip-selected=\"optionIndex\" index=\"{{optionIndex }}\"\\n' +\n    '                     pip-select=\"onSelected($event)\">\\n' +\n    '\\n' +\n    '                <md-list-item class=\"pip-ref-list-item pip-selectable\"\\n' +\n    '                              ng-class=\"{\\'selected\\' : option.name == selectedOptionName,\\n' +\n    '                              \\'divider-bottom\\': $index != options.length - 1}\"\\n' +\n    '                              layout=\"row\" layout-align=\"start center\" md-ink-ripple\\n' +\n    '                              xxxxng-keypress=\"onKeyPress($event)\"\\n' +\n    '                              ng-keyup=\"onKeyUp($event, $index)\"\\n' +\n    '                              ng-repeat=\"option in options\" ng-click=\"onOptionSelect($event, option)\">\\n' +\n    '\\n' +\n    '                    <div class=\"pip-content  line-height-string  max-w100-stretch\">\\n' +\n    '                        <p class=\"pip-title  rp24-flex\" ng-if=\"option.title\" style=\"margin-bottom: 4px !important;\">\\n' +\n    '                            {{::option.title | translate}}\\n' +\n    '                        </p>\\n' +\n    '                        <div class=\"pip-subtitle  rp24-flex\"\\n' +\n    '                             style=\"height: inherit\"\\n' +\n    '                             ng-if=\"option.subtitle\">\\n' +\n    '                            {{::option.subtitle | translate}}\\n' +\n    '                        </div>\\n' +\n    '                        <div class=\"pip-subtitle  rp24-flex\"\\n' +\n    '                             style=\"height: inherit\" ng-if=\"option.text\"\\n' +\n    '                             pip-translate-html=\"{{::option.text | translate}}\">\\n' +\n    '                        </div>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                </md-list-item>\\n' +\n    '\\n' +\n    '            </md-list>\\n' +\n    '            <!--\\n' +\n    '            <md-radio-group ng-model=\"selectedOptionName\" class=\"pip-list md-primary\" md-no-ink=\"true\"\\n' +\n    '                            ng-keypress=\"onKeyPress($event)\" tabindex=\"0\">\\n' +\n    '                <div ng-repeat=\"option in options\" class=\"pip-list-item p0\" md-ink-ripple\\n' +\n    '                     ui-event=\"{ click: \\'onOptionSelect($event, option)\\' }\"\\n' +\n    '                     ng-class=\"{ selected: option.name == selectedOptionName }\">\\n' +\n    '                    <div class=\"pip-list-item\">\\n' +\n    '\\n' +\n    '                        <div class=\"pip-content lp24-flex rp24-flex\" flex>\\n' +\n    '                            <div class=\"pip-title\" ng-if=\"option.title\">\\n' +\n    '                                {{::option.title | translate}}\\n' +\n    '                            </div>\\n' +\n    '                            <div class=\"pip-subtitle\" ng-if=\"option.subtitle\">\\n' +\n    '                                {{::option.subtitle | translate}}\\n' +\n    '                            </div>\\n' +\n    '                            <div class=\"pip-text\" ng-if=\"option.text\">\\n' +\n    '\\n' +\n    '                                <span pip-translate-html=\"{{::option.text | translate}}\"/>\\n' +\n    '                            </div>\\n' +\n    '                        </div>\\n' +\n    '\\n' +\n    '                        <md-radio-button ng-value=\"option.name\" tabindex=\"-1\" class=\"rm24-flex\"\\n' +\n    '                                         aria-label=\"{{::option.title | translate}}\">\\n' +\n    '                        </md-radio-button>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                </div>\\n' +\n    '            </md-radio-group> -->\\n' +\n    '        </div>\\n' +\n    '        <div class=\"h8\" ng-if=\"noActions\"></div>\\n' +\n    '    </md-dialog-content>\\n' +\n    '\\n' +\n    '    <div class=\"pip-footer\" ng-if=\"!noActions\">\\n' +\n    '        <div>\\n' +\n    '            <md-button class=\"pip-cancel\" ng-click=\"onCancel()\">{{::\\'CANCEL\\' | translate}}</md-button>\\n' +\n    '            <md-button class=\"pip-submit md-accent\" ng-click=\"onSelect()\" style=\"margin-right: -6px\">\\n' +\n    '                {{::applyButtonTitle | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('popover/popover.template.html',\n    '<div ng-if=\"params.templateUrl\" class=\\'pip-popover flex layout-column\\'\\n' +\n    '     ng-click=\"onPopoverClick($event)\" ng-include=\"params.templateUrl\">\\n' +\n    '</div>\\n' +\n    '\\n' +\n    '<div ng-if=\"params.template\" class=\\'pip-popover\\' ng-click=\"onPopoverClick($event)\">\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('progress/routing_progress.html',\n    '<div class=\"pip-routing-progress\" layout=\"column\" layout-align=\"center center\" ng-show=\"$routing || $reset\">\\n' +\n    '    <div class=\"loader\">\\n' +\n    '        <svg class=\"circular\" viewBox=\"25 25 50 50\">\\n' +\n    '            <circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"/>\\n' +\n    '        </svg>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <img src=\"images/Logo_animation.svg\"  height=\"40\" width=\"40\" class=\"pip-img\">\\n' +\n    '\\n' +\n    '    <md-progress-circular md-diameter=\"96\"\\n' +\n    '                          class=\"fix-ie\"></md-progress-circular>\\n' +\n    '\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('time_edit/time_edit.html',\n    '<!--\\n' +\n    '@file Time edit control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div layout=\"row\" class=\"event-edit\" layout-xs=\"column\" flex layout-align=\"start start\">\\n' +\n    '    <div flex=\"47\" class=\"w-stretch rm24-flex0\">\\n' +\n    '        <p class=\"text-caption text-grey tm0\">{{startLabel}}</p>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"space-between center\">\\n' +\n    '            <div class=\"rm16 pip-datepicker-container\" flex=\"49\">\\n' +\n    '                <md-datepicker ng-model=\"data.startDate\"\\n' +\n    '                               xmd-placeholder=\"{{startLabel}}\"\\n' +\n    '                               ng-change=\"onChangeStartDate()\"\\n' +\n    '                               ng-disabled=\"isDisabled()\"\\n' +\n    '                               aria-label=\"START-DATE\">\\n' +\n    '                </md-datepicker>\\n' +\n    '            </div>\\n' +\n    '            <div flex>\\n' +\n    '                <md-input-container class=\"w-stretch tm0\">\\n' +\n    '                    <md-select aria-label=\"START-TIME\" class=\"tm0 bm0\" ng-model=\"data.startTime\" ng-disabled=\"isDisabled()\"\\n' +\n    '                               ng-change=\"onChangeStartTime()\">\\n' +\n    '                        <md-option ng-value=\"opt.id\" ng-repeat=\"opt in intervalTimeCollection track by opt.id\">{{ opt.time }}\\n' +\n    '                        </md-option>\\n' +\n    '                    </md-select>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div flex=\"47\" class=\"w-stretch\">\\n' +\n    '        <p class=\"text-caption text-grey tm0\">{{endLabel}}</p>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" layout-align=\"space-between center\">\\n' +\n    '            <div class=\"rm16 pip-datepicker-container\" flex=\"49\">\\n' +\n    '                <md-datepicker ng-model=\"data.endDate\"\\n' +\n    '                               xmd-placeholder=\"{{endLabel}}\"\\n' +\n    '                               ng-disabled=\"isDisabled()\"\\n' +\n    '                               ng-change=\"onChangeEndDate()\"\\n' +\n    '                               aria-label=\"END-DATE\">\\n' +\n    '                </md-datepicker>\\n' +\n    '            </div>\\n' +\n    '            <div flex>\\n' +\n    '                <md-input-container class=\"w-stretch tm0\">\\n' +\n    '                    <md-select aria-label=\"END-TIME\" class=\"tm0 bm0\" ng-model=\"data.endTime\" ng-change=\"onChangeEndTime()\"\\n' +\n    '                               ng-disabled=\"isDisabled()\">\\n' +\n    '                        <md-option ng-value=\"opt.id\" ng-repeat=\"opt in intervalTimeCollection track by opt.id\">{{\\n' +\n    '                            opt.time }}\\n' +\n    '                        </md-option>\\n' +\n    '                    </md-select>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('time_view/time_view.html',\n    '<p>\\n' +\n    '    <span ng-if=\"data.start != null\">{{data.start | formatShortDateTime}}</span>\\n' +\n    '    <span  class=\"rm4 lm4\" ng-if=\"data.start && data.end\"> - </span>\\n' +\n    '    <span ng-if=\"data.end != null\">{{data.end | formatShortDateTime}}</span>\\n' +\n    '</p>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('toast/toast.html',\n    '<md-toast class=\"md-action pip-toast\"\\n' +\n    '          ng-class=\"{\\'pip-error\\': toast.type==\\'error\\'}\"\\n' +\n    '          style=\"height:initial; max-height: initial; \">\\n' +\n    '    <!--\\'pip-column-toast\\': toast.type == \\'error\\' || toast.actions.length > 1-->\\n' +\n    '\\n' +\n    '    <span class=\"flex-var m0 pip-text\" ng-bind-html=\"message\"></span>\\n' +\n    '    <div layout=\"row\" layout-align=\"end start\" class=\"pip-actions\">\\n' +\n    '        <md-button class=\"flex-fixed m0 lm8\" ng-if=\"toast.type==\\'error\\' && toast.error\" ng-click=\"onDetails()\">Details</md-button>\\n' +\n    '        <md-button class=\"flex-fixed m0 lm8\"\\n' +\n    '                   ng-click=\"onAction(action)\"\\n' +\n    '                   ng-repeat=\"action in actions\"\\n' +\n    '                   aria-label=\"{{::action| translate}}\">\\n' +\n    '            {{::action| translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '</md-toast>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipBasicControls.Templates');\n} catch (e) {\n  module = angular.module('pipBasicControls.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('toggle_buttons/toggle_buttons.html',\n    '<div class=\"pip-toggle-buttons flex layout-row {{class}}\" pip-selected=\"bufButtonIndex\" pip-enter-space-press=\"enterSpacePress($event)\"\\n' +\n    '     ng-if=\"$mdMedia(\\'gt-xs\\')\">\\n' +\n    '    <md-button tabindex=\"-1\" ng-repeat=\"button in buttons\"\\n' +\n    '               ng-class=\"{\\'md-accent md-raised selected color-accent-bg\\' : currentButtonIndex == $index}\"\\n' +\n    '               ng-attr-style=\"{{ \\'background-color:\\' + (currentButtonIndex == $index ? button.backgroundColor : \\'\\') + \\'!important\\' }}\"\\n' +\n    '               class=\"pip-selectable pip-chip-button flex\" ng-click=\"buttonSelected($index, $event)\"\\n' +\n    '               ng-disabled=\"button.disabled || disabled()\">\\n' +\n    '        {{button.name || button.title | translate}}\\n' +\n    '        <span ng-if=\"button.checked || button.complete || button.filled\" class=\"pip-tagged\">*</span>\\n' +\n    '    </md-button>\\n' +\n    '</div>\\n' +\n    '\\n' +\n    '<md-input-container class=\"md-block\" ng-if=\"$mdMedia(\\'xs\\')\">\\n' +\n    '    <md-select ng-model=\"currentButtonIndex\" ng-disabled=\"disabled()\" aria-label=\"DROPDOWN\" md-on-close=\"buttonSelected(currentButtonIndex)\">\\n' +\n    '        <md-option ng-repeat=\"action in buttons\" value=\"{{ ::$index }}\">\\n' +\n    '            {{ (action.title || action.name) | translate }}\\n' +\n    '            <span ng-if=\"action.checked || action.complete || action.filled\" class=\"pip-tagged\">*</span>\\n' +\n    '        </md-option>\\n' +\n    '    </md-select>\\n' +\n    '</md-input-container>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Registration of basic WebUI controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipControls', [        \r\n        'pipMarkdown',\r\n        'pipToggleButtons',\r\n        'pipRefreshButton',\r\n        'pipColorPicker',\r\n        'pipRoutingProgress',\r\n        'pipPopover',\r\n        'pipImageSlider',\r\n        'pipToasts',\r\n\r\n        'pipDate',\r\n        'pipDateRange',\r\n        'pipTimeEdit',\r\n        'pipTimeView',\r\n\r\n        'pipInformationDialog',\r\n        'pipConfirmationDialog',\r\n        'pipOptionsDialog',\r\n        'pipOptionsBigDialog',\r\n        'pipConversionDialog',\r\n        'pipErrorDetailsDialog'\r\n    ]);\r\n\r\n    angular.module('pipBasicControls', [ 'pipControls' ]);\r\n    \r\n})();\r\n\r\n\r\n","/**\r\n * @file Color picker control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipColorPicker\", ['pipUtils', 'pipFocused', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.directive('pipColorPicker',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    colors: '=pipColors',\r\n                    currentColor: '=ngModel',\r\n                    colorChange: '&ngChange'\r\n                },\r\n                templateUrl: 'color_picker/color_picker.html',\r\n                controller: 'pipColorPickerController'\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipColorPickerController',\r\n        ['$scope', '$element', '$attrs', '$timeout', function ($scope, $element, $attrs, $timeout) {\r\n            var\r\n                DEFAULT_COLORS = ['purple', 'lightgreen', 'green', 'darkred', 'pink', 'yellow', 'cyan'];\r\n\r\n            $scope.class = $attrs.class || '';\r\n\r\n            if (!$scope.colors || (_.isArray($scope.colors) && $scope.colors.length === 0)) {\r\n                $scope.colors = DEFAULT_COLORS;\r\n            }\r\n\r\n            $scope.currentColor = $scope.currentColor || $scope.colors[0];\r\n            $scope.currentColorIndex = $scope.colors.indexOf($scope.currentColor);\r\n\r\n            $scope.disabled = function () {\r\n                if ($scope.ngDisabled) {\r\n                    return $scope.ngDisabled();\r\n                } else {\r\n                    return true;\r\n                }\r\n            };\r\n\r\n            $scope.selectColor = function (index) {\r\n                if ($scope.disabled()) return;\r\n                $scope.currentColorIndex = index;\r\n\r\n                $scope.currentColor = $scope.colors[$scope.currentColorIndex];\r\n\r\n                $timeout(function() {\r\n                    $scope.$apply();\r\n                });\r\n\r\n                if ($scope.colorChange) {\r\n                    $scope.colorChange();\r\n                }\r\n            }\r\n\r\n            $scope.enterSpacePress = function (event) {\r\n                $scope.selectColor(event.index);\r\n            };\r\n    }])\r\n\r\n})();","/**\r\n * @file Confirmation dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipConfirmationDialog', \r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'CONFIRM_TITLE': 'Confirm'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'CONFIRM_TITLE': 'Подтвердите'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipConfirmationDialog', \r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'confirmation_dialog/confirmation_dialog.html',\r\n                        controller: 'pipConfirmationDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function () {\r\n                        if (successCallback) {\r\n                            successCallback();\r\n                        }\r\n                    }, function () {\r\n                        if (cancelCallback) {\r\n                            cancelCallback();\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipConfirmationDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'pipTranslate', 'params', function ($scope, $rootScope, $mdDialog, pipTranslate, params) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'CONFIRM_TITLE';\r\n\r\n            $scope.ok = params.ok || 'OK';\r\n            $scope.cancel = params.cancel || 'CANCEL';\r\n\r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            $scope.onOk = function () {\r\n                $mdDialog.hide();\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Convert parent dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n        \r\n    var thisModule = angular.module('pipConversionDialog',\r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'CONVERT_PARENT_TITLE': 'Choose type of the parent record',\r\n            'CONVERT_PARENT_SUBTITLE': 'The <b>%s</b> is missing and will be created from scratch. Find and clarify it later',\r\n\r\n            'CONVERT_TO_GOAL_SUBTITLE': 'Result that requires significant efforts',\r\n            'CONVERT_TO_TASK_SUBTITLE': 'Simple work that doesn\\'t need a plan',\r\n            'CONVERT_TO_AREA_SUBTITLE': 'Area of interests or actions of any kind',\r\n            'CONVERT_TO_VISION_SUBTITLE': 'Situation in specific time period',\r\n            'CONVERT_TO_CANCEL': 'Do not create a parent record',\r\n            'CONVERT_TO_CANCEL_SUBTITLE': 'The <b>%s</b> is deleted',\r\n\r\n            'CONVERT_RECORD_TO_GOAL': 'Result that requires significant efforts',\r\n            'CONVERT_RECORD_TO_TASK': 'Simple work that doesn\\'t need a pla',\r\n            'CONVERT_RECORD_TO_EVENT': 'Reminder or scheduled block of time',\r\n            'CONVERT_RECORD_TO_POST': 'Any useful information'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'CONVERT_PARENT_TITLE': 'Определите тип родительской записи',\r\n            'CONVERT_PARENT_SUBTITLE': 'Запись <b>%s</b> отсутствует и будет создана с нуля. Найдите и скорректируйте ее позже',\r\n\r\n            'CONVERT_TO_GOAL_SUBTITLE': 'Результат требующий значительных усилий',\r\n            'CONVERT_TO_TASK_SUBTITLE': 'Простая работа, для которой не нужен план',\r\n            'CONVERT_TO_AREA_SUBTITLE': 'Область интересов или какой-либо активности',\r\n            'CONVERT_TO_VISION_SUBTITLE': 'Ситуация в определенный промежуток времени',\r\n            'CONVERT_TO_CANCEL': 'Не создавать родительскую запись',\r\n            'CONVERT_TO_CANCEL_SUBTITLE': '<b>%s</b> будет удалена',\r\n\r\n            'CONVERT_RECORD_TO_GOAL': 'Результат требующий значительных усилий',\r\n            'CONVERT_RECORD_TO_TASK': 'Простая работа, для которой не нужен план',\r\n            'CONVERT_RECORD_TO_EVENT': 'Напоминание или блок времени в расписании',\r\n            'CONVERT_RECORD_TO_POST': 'Любая полезная информация'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipConversionDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    if (params.event) {\r\n                        params.event.stopPropagation();\r\n                        params.event.preventDefault();\r\n                    }\r\n                    if (!params.options || params.options.length == 0) return;\r\n\r\n                    function focusToggleControl() {\r\n                        if (params.event && params.event.currentTarget)\r\n                            params.event.currentTarget.focus();\r\n                    }\r\n\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'conversion_dialog/conversion_dialog.html',\r\n                        controller: 'pipConversionDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function (option) {\r\n                            focusToggleControl();\r\n\r\n                            if (successCallback) successCallback(option);\r\n                        }, function () {\r\n                            focusToggleControl();\r\n                            if (cancelCallback) cancelCallback();\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipConversionDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'params', 'pipUtils', 'pipTranslate', function ($scope, $rootScope, $mdDialog, params, pipUtils, pipTranslate) {\r\n\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'CONVERT_PARENT_TITLE';\r\n            $scope.recordName = params.recordName || '';\r\n            $scope.subtitle = params.subtitle || pipUtils.sprintf(pipTranslate.translate('CONVERT_PARENT_SUBTITLE'), $scope.recordName);\r\n            $scope.withoutTitle = params.deleteTitle ? params.deleteTitle : false;\r\n            $scope.deleted = !!params.deleted;\r\n            $scope.options = _.cloneDeep(params.options);\r\n            $scope.selectedIndex  = -1;\r\n            $scope.cancelConverting = $scope.recordName ? true : false;\r\n            $scope.selectedOptionName = '';\r\n\r\n            if ($scope.cancelConverting) $scope.options.push({\r\n                name: 'cancel',\r\n                title: 'CONVERT_TO_CANCEL',\r\n                subtitle: pipUtils.sprintf(pipTranslate.translate('CONVERT_TO_CANCEL_SUBTITLE'), $scope.recordName)\r\n            });\r\n\r\n            $scope.onOptionSelect = function (event, option) {\r\n                event.stopPropagation();\r\n                $scope.selectedOptionName = option.name;\r\n\r\n                $scope.onSelect();\r\n            };\r\n\r\n            $scope.onKeyPress = function(event) {\r\n                if (event.keyCode == 32 || event.keyCode == 13) {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    $scope.selectedOptionName = $scope.selectedIndex == -1 ? $scope.options[0].name : $scope.options[$scope.selectedIndex].name;\r\n                    $scope.onSelect();\r\n                    return ;\r\n                }\r\n            };\r\n\r\n            $scope.onKeyDown = function(event) {\r\n                if (event.keyCode == 40) {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    $scope.selectedIndex += 1;\r\n                    $scope.selectedIndex = $scope.selectedIndex % $scope.options.length;\r\n                    $scope.selectedOptionName = $scope.options[$scope.selectedIndex].name;\r\n                    return ;\r\n                }\r\n                if (event.keyCode == 38) {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    $scope.selectedIndex = $scope.selectedIndex <= 0 ? $scope.selectedIndex = $scope.options.length - 1 : $scope.selectedIndex - 1;\r\n                    $scope.selectedOptionName = $scope.options[$scope.selectedIndex].name;\r\n                    return ;\r\n                }\r\n            };\r\n\r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            $scope.onSelect = function () {\r\n                var option = _.find($scope.options, {name: $scope.selectedOptionName});\r\n\r\n                if (option && option.name != 'cancel') $mdDialog.hide({ option: option, deleted: $scope.deleted });\r\n                else $mdDialog.hide(null);\r\n            };\r\n\r\n            // Setting focus to input control\r\n            function focusInput() {\r\n                var list = $('.pip-conversion-dialog .pip-list');\r\n                list.focus();\r\n            };\r\n            setTimeout(focusInput, 500);\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Date control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples int sampler app\r\n * - Optimize. It is way to slow on samples\r\n */\r\n \r\n /* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDate\", ['pipBasicControls.Templates']);\r\n\r\n    thisModule.directive('pipDate',\r\n        ['$parse', function ($parse) {\r\n            return {\r\n                restrict: 'EA',\r\n                require: 'ngModel',\r\n                scope: {\r\n                    timeMode: '@pipTimeMode',\r\n                    disabled: '&ngDisabled',\r\n                    model: '=ngModel',\r\n                    ngChange: '&'\r\n                },\r\n                templateUrl: 'date/date.html',\r\n                controller: 'pipDateController'\r\n            }\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipDateController',\r\n        ['$scope', '$element', 'pipTranslate', function ($scope, $element, pipTranslate) {\r\n\r\n            function dayList(month, year) {\r\n                var count = 31;\r\n\r\n                if (month == 4 || month == 6 || month == 9 || month == 11) {\r\n                    count = 30;\r\n                } else if (month == 2) {\r\n                    if (year)\r\n                    // Calculate leap year (primitive)\r\n                        count = year % 4 == 0 ? 29 : 28;\r\n                    else count = 28;\r\n                }\r\n\r\n                var days = [];\r\n                for (var i = 1; i <= count; i++) {\r\n                    days.push(i);\r\n                }\r\n\r\n                return days;\r\n            };\r\n\r\n            function monthList() {\r\n                var months = [];\r\n\r\n                for (var i = 1; i <= 12; i++) {\r\n                    months.push({\r\n                        id: i,\r\n                        name: pipTranslate.translate('MONTH_' + i)\r\n                    })\r\n                }\r\n\r\n                return months;\r\n            };\r\n\r\n            function yearList() {\r\n                var\r\n                    currentYear = new Date().getFullYear(),\r\n                    startYear = $scope.timeMode == 'future' ? currentYear : currentYear - 100,\r\n                    endYear = $scope.timeMode == 'past' ? currentYear : currentYear + 100,\r\n                    years = [];\r\n\r\n                if ($scope.timeMode == 'past') {\r\n                    for (var i = endYear; i >= startYear; i--) {\r\n                        years.push(i);\r\n                    }\r\n                } else {\r\n                    for (var i = startYear; i <= endYear; i++) {\r\n                        years.push(i);\r\n                    }\r\n                }\r\n\r\n                return years;\r\n            };\r\n\r\n            function adjustDay() {\r\n                var days = dayList($scope.month, $scope.year);\r\n\r\n                if ($scope.days.length != days.length) {\r\n                    if ($scope.day > days.length) {\r\n                        $scope.day = days.length;\r\n                    }\r\n\r\n                    $scope.days = days;\r\n                }\r\n            };\r\n\r\n            function getValue(value) {\r\n                value = value ? (_.isDate(value) ? value : new Date(value)) : null;\r\n\r\n                // Define values\r\n                var day = value ? value.getDate() : null;\r\n                var month = value ? value.getMonth() + 1 : null;\r\n                var year = value ? value.getFullYear() : null;\r\n\r\n                // Update day list if month and year were changed\r\n                if ($scope.month != month\r\n                    && $scope.year != year) {\r\n                    $scope.days = dayList($scope.month, $scope.year);\r\n                }\r\n\r\n                // Assign values to scope\r\n                $scope.day = day;\r\n                $scope.month = month;\r\n                $scope.year = year;\r\n            };\r\n\r\n            function setValue() {\r\n                if ($scope.day && $scope.month && $scope.year) {\r\n                    var value = new Date($scope.year, $scope.month - 1, $scope.day, 0, 0, 0, 0);\r\n                    $scope.model = value;\r\n                    $scope.ngChange();\r\n                }\r\n            };\r\n\r\n            $scope.onDayChanged = function () {\r\n                setValue();\r\n            };\r\n\r\n            $scope.onMonthChanged = function () {\r\n                adjustDay();\r\n                setValue();\r\n            };\r\n\r\n            $scope.onYearChanged = function () {\r\n                adjustDay();\r\n                setValue();\r\n            };\r\n\r\n            // Set initial values\r\n            var value = $scope.model ? (_.isDate($scope.model) ? $scope.model : new Date($scope.model)) : null;\r\n            $scope.day = value ? value.getDate() : null;\r\n            $scope.month = value ? value.getMonth() + 1 : null;\r\n            $scope.year = value ? value.getFullYear() : null;\r\n\r\n            $scope.dayLabel = pipTranslate.translate('DAY');\r\n            $scope.monthLabel = pipTranslate.translate('MONTH');\r\n            $scope.yearLabel = pipTranslate.translate('YEAR');\r\n\r\n            $scope.days = dayList($scope.month, $scope.year);\r\n            $scope.months = monthList();\r\n            $scope.years = yearList();\r\n\r\n            $scope.disableControls = $scope.disabled ? $scope.disabled() : false;\r\n\r\n            // React on changes\r\n            $scope.$watch('model', function (newValue, oldValue) {\r\n                getValue(newValue);\r\n            });\r\n\r\n            $scope.$watch($scope.disabled, function (newValue) {\r\n                $scope.disableControls = newValue;\r\n            });\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Date range control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples int sampler app\r\n * - Optimize. It is way to slow on samples\r\n */\r\n\r\n/* global angular */\r\n\r\n/*\r\n pip-date-range-type\r\n [ daily,  weekly,  monthly,  yearly ]\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDateRange\", []);\r\n\r\n    thisModule.directive('pipDateRange',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                require: 'ngModel',\r\n                scope: {\r\n                    timeMode: '@pipTimeMode',\r\n                    disabled: '&ngDisabled',\r\n                    model: '=ngModel',\r\n                    pipChanged: '&',\r\n                    pipDateRangeType: '@',\r\n                    pipDateFormat: '@',\r\n                    pipNoLine: '@'\r\n                },\r\n                templateUrl: 'date_range/date_range.html',\r\n                controller: 'pipDateRangeController'\r\n            }\r\n        });\r\n\r\n    thisModule.controller('pipDateRangeController',\r\n        ['$scope', '$element', 'pipTranslate', '$mdMedia', '$rootScope', function ($scope, $element, pipTranslate, $mdMedia, $rootScope) {\r\n            var bufMonth,\r\n                currentDate = new Date(),\r\n                currentYear = currentDate.getUTCFullYear(),\r\n                currentMonth = currentDate.getUTCMonth() + 1,\r\n                currentDay = currentDate.getUTCDate(),\r\n                prevState = {}, currentState = {};\r\n            $scope.daysWeek = {\r\n                en: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\r\n                ru: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб']\r\n            };\r\n\r\n            $scope.onDayChanged = function () {\r\n                setValue();\r\n            };\r\n\r\n            $scope.onMonthChanged = function () {\r\n                if ($scope.pipDateRangeType == 'weekly') {\r\n                    var date = new Date(Date.UTC($scope.year, $scope.month - 1, 1));\r\n                    var dayOfWeek = date.getUTCDay() ? date.getUTCDay() : 7;\r\n                    $scope.week = getWeekByDate(dayOfWeek, $scope.month - 1, $scope.year);\r\n                    correctWeek();\r\n                    adjustWeek();\r\n                } else {\r\n                    adjustDay();\r\n                }\r\n                setValue();\r\n            };\r\n\r\n            $scope.onYearChanged = function () {\r\n                if ($scope.pipDateRangeType == 'weekly') {\r\n                    var date = new Date(Date.UTC($scope.year, $scope.month - 1, 1));\r\n                    var dayOfWeek = date.getUTCDay() ? date.getUTCDay() : 7;\r\n                    $scope.week = getWeekByDate(dayOfWeek, $scope.month - 1, $scope.year);\r\n                    adjustWeek();\r\n                    correctWeek();\r\n                } else {\r\n                    adjustDay();\r\n                }\r\n                setValue();\r\n            };\r\n\r\n            $scope.onWeekChange = function () {\r\n                if ($scope.pipDateRangeType == 'weekly') {\r\n                    adjustWeek();\r\n                    correctWeek();\r\n                } else {\r\n                    adjustDay();\r\n                }\r\n                setValue();\r\n            };\r\n\r\n            // visibility\r\n            $scope.isDay = function () {\r\n                return $scope.pipDateRangeType == 'daily';\r\n            };\r\n\r\n            $scope.isWeek = function () {\r\n                return $scope.pipDateRangeType == 'weekly';\r\n            };\r\n\r\n            $scope.isMonth = function () {\r\n                return (($scope.pipDateRangeType == 'daily') ||\r\n                ($scope.pipDateRangeType == 'weekly') ||\r\n                ($scope.pipDateRangeType == 'monthly'));\r\n            };\r\n\r\n            $scope.onChange = function () {\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged();\r\n                }\r\n            };\r\n\r\n            function setCurrent() {\r\n                currentState.day = $scope.day;\r\n                currentState.month = $scope.month;\r\n                currentState.year = $scope.year;\r\n                currentState.week = $scope.week;\r\n                currentState.dateRangeType = $scope.pipDateRangeType;\r\n                currentState.model = $scope.model;\r\n            }\r\n\r\n            function fillLists() {\r\n                $scope.days = dayList($scope.month, $scope.year);\r\n                $scope.weeks = weekList($scope.month, $scope.year);\r\n                $scope.months = monthList();\r\n                $scope.shortMonths = monthList(true);\r\n                $scope.years = yearList();\r\n\r\n            };\r\n\r\n            function correctWeek() {\r\n                if (!prevState.model || (prevState.model && prevState.model.getTime() >= $scope.model.getTime())) {\r\n                    // if shift week -> increase month\r\n                    if ($scope.weeks && $scope.weeks[$scope.week] && $scope.weeks[$scope.week].id <= 0) {\r\n                        if ($scope.month < 12) $scope.month += 1;\r\n                        else {\r\n                            $scope.month = 1;\r\n                            $scope.year += 1;\r\n                        }\r\n                        fillLists();\r\n                    }\r\n                }\r\n            };\r\n\r\n            function init() {\r\n                var value = $scope.model ? new Date($scope.model) : null;\r\n                $scope.day = value ? value.getUTCDate() : null;\r\n                $scope.month = value ? value.getUTCMonth() + 1 : null;\r\n                $scope.year = value ? value.getUTCFullYear() : null;\r\n                $scope.week = value ? getWeekByDate($scope.day, $scope.month - 1, $scope.year) : null;\r\n\r\n                fillLists();\r\n\r\n                if ($scope.pipDateRangeType == 'weekly') {\r\n                    correctWeek();\r\n                    adjustWeek();\r\n                } else {\r\n                    adjustDay();\r\n                }\r\n                setValue();\r\n            }\r\n\r\n            // Set initial values\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n            init();\r\n\r\n            $scope.disableControls = $scope.disabled ? $scope.disabled() : false;\r\n\r\n            // React on changes\r\n            $scope.$watch('model', function (newValue, oldValue) {\r\n                if (newValue != oldValue) {\r\n                    getValue(newValue);\r\n                }\r\n            });\r\n\r\n            $scope.$watch($scope.disabled, function (newValue) {\r\n                $scope.disableControls = newValue;\r\n            });\r\n\r\n            $scope.$watch('pipDateRangeType', function (newValue, oldValue) {\r\n                if ((newValue != oldValue) && (oldValue)) {\r\n                    init();\r\n                }\r\n            });\r\n\r\n            $scope.onYearClick = function () {\r\n                if ($scope.year == null) $scope.year = currentYear;\r\n            };\r\n\r\n            $scope.onMonthClick = function () {\r\n                if ($scope.month == null) $scope.month = currentMonth;\r\n            };\r\n\r\n            $scope.onDayClick = function () {\r\n                if ($scope.year == null) $scope.day = currentDay;\r\n            };\r\n\r\n            return;\r\n\r\n            // ---------------------------------------------------------------------------------------\r\n\r\n            function getCountDay(month, year) {\r\n                var count = 31;\r\n\r\n                if (month == 4 || month == 6 || month == 9 || month == 11) {\r\n                    count = 30;\r\n                } else if (month == 2) {\r\n                    if (year)\r\n                    // Calculate leap year (primitive)\r\n                        count = year % 4 == 0 ? 29 : 28;\r\n                    else count = 28;\r\n                }\r\n                return count;\r\n            }\r\n\r\n            function dayList(month, year) {\r\n                var count = getCountDay(month, year);\r\n\r\n                $scope.nameDays = [];\r\n                var days = [];\r\n                for (var i = 1; i <= count; i++) {\r\n                    days.push(i);\r\n\r\n                    $scope.nameDays.push($scope.daysWeek[$rootScope.$language || 'en'][new Date(year, month - 1, i).getDay()]);\r\n                }\r\n                return days;\r\n            }\r\n\r\n            function getWeekByDate(day, month, year) {\r\n                var date = new Date(Date.UTC(year, month, day));\r\n                var dayOfWeek = date.getUTCDay() ? date.getUTCDay() : 7;\r\n                var startWeek;\r\n\r\n                if (dayOfWeek == 1) {\r\n                    startWeek = day;\r\n                } else {\r\n                    startWeek = day + 1 - dayOfWeek;\r\n                }\r\n\r\n                return startWeek;\r\n            }\r\n\r\n            function getWeek(day, countDay, countPrevMonthDay) {\r\n                var endDay = (day + 6) > countDay ? countDay - day - 6 : day + 6;\r\n                var startDay = (day > 0) ? day : countPrevMonthDay + day;\r\n                return (startDay).toString() + ' - ' + (Math.abs(endDay)).toString();\r\n            }\r\n\r\n            function weekList(month, year) { // возвращает список начала надели\r\n                var weeks = [];  // в массиве первые дни недели в текущем месяце\r\n                var countDay = getCountDay(month, year);\r\n                var countPrevMonthDay;\r\n                var startWeek = getWeekByDate(1, month - 1, year);\r\n\r\n                countPrevMonthDay = month - 1 ? getCountDay(month - 1, year) : getCountDay(12, year - 1);\r\n                while (startWeek < countDay + 1) {\r\n                    weeks.push({\r\n                        id: startWeek,\r\n                        name: getWeek(startWeek, countDay, countPrevMonthDay)\r\n                    });\r\n                    startWeek = startWeek + 7;\r\n                }\r\n\r\n                return weeks;\r\n            }\r\n\r\n            function monthList(isShort) {\r\n                var months = [];\r\n\r\n                for (var i = 1; i <= 12; i++) {\r\n                    months.push({\r\n                        id: i,\r\n                        name: pipTranslate.translate('MONTH_' + i)\r\n                    })\r\n                }\r\n\r\n                return months;\r\n            }\r\n\r\n            function yearList() {\r\n                var\r\n                    startYear,\r\n                    endYear,\r\n                    years = [];\r\n\r\n                switch ($scope.timeMode) {\r\n                    case 'future':\r\n                        startYear = currentYear;\r\n                        endYear = currentYear + 100;\r\n                        break;\r\n                    case 'past':\r\n                        startYear = currentYear - 100;\r\n                        endYear = currentYear;\r\n                        break;\r\n                    case 'now':\r\n                        startYear = currentYear - 50;\r\n                        endYear = currentYear + 100;\r\n                        break;\r\n                    default:\r\n                        startYear = currentYear - 50;\r\n                        endYear = currentYear + 50;\r\n                        break;\r\n                }\r\n                if ($scope.timeMode == 'future') {\r\n                    for (var i = startYear; i <= endYear; i++) {\r\n                        years.push(i);\r\n                    }\r\n                } else {\r\n                    for (var i = endYear; i >= startYear; i--) {\r\n                        years.push(i);\r\n                    }\r\n                }\r\n                return years;\r\n            }\r\n\r\n            function adjustDay() {\r\n                var days = dayList($scope.month, $scope.year);\r\n\r\n                switch ($scope.pipDateRangeType) {\r\n                    case 'monthly':\r\n                        $scope.day = 1;\r\n                        break;\r\n                    case 'yearly':\r\n                        $scope.month = 1;\r\n                        $scope.day = 1;\r\n                        break;\r\n                    default:\r\n                        if ($scope.days.length != days.length) {\r\n                            if ($scope.day > days.length) {\r\n                                $scope.day = days.length;\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n                $scope.days = days;\r\n            }\r\n\r\n            function adjustWeek() {\r\n                var weeks = weekList($scope.month, $scope.year);\r\n                $scope.week = getWeekByDate($scope.week, $scope.month - 1, $scope.year);\r\n                $scope.weeks = weeks;\r\n            }\r\n\r\n            function getValue(value) {\r\n                value = value ? new Date(value) : null;\r\n                // Define values\r\n                var day = value ? value.getUTCDate() : null;\r\n                var month = value ? value.getUTCMonth() + 1 : null;\r\n                var year = value ? value.getUTCFullYear() : null;\r\n                var week = value ? getWeekByDate(day, month - 1, year) : null;\r\n                // Exit if nothing to update\r\n                if ($scope.day == day && $scope.month == month\r\n                    && $scope.year == year && $scope.week == week)\r\n                    return;\r\n                // Assign values to scope\r\n                $scope.day = day;\r\n                $scope.month = month;\r\n                $scope.year = year;\r\n                $scope.week = week;\r\n\r\n                // Define data sources\r\n                $scope.days = dayList($scope.month, $scope.year);\r\n                $scope.weeks = weekList($scope.month, $scope.year);\r\n            }\r\n\r\n            function setValue() {\r\n                var value;\r\n                if ($scope.pipDateRangeType == 'weekly') {\r\n                    value = new Date($scope.year, $scope.month - 1, $scope.week, 0, 0, 0, 0);\r\n                    value = new Date(value.getTime() - value.getTimezoneOffset() * 60000);\r\n                    $scope.model = value;\r\n                } else {\r\n                    value = new Date($scope.year, $scope.month - 1, $scope.day, 0, 0, 0, 0);\r\n                    value = new Date(value.getTime() - value.getTimezoneOffset() * 60000);\r\n                    $scope.model = value;\r\n                }\r\n\r\n                prevState = _.cloneDeep(currentState);\r\n                setCurrent();\r\n                $scope.onChange();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Confirmation dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrorDetailsDialog',\r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'ERROR_DETAILS': 'Error details',\r\n            'CODE': 'Code',\r\n            'PATH': 'Path',\r\n            'ERROR': \"Error code\",\r\n            'METHOD': 'Method',\r\n            'MESSAGE':\"Message\"\r\n\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'ERROR_DETAILS': 'Детали ошибки',\r\n            'CODE': 'Код',\r\n            'PATH': 'Путь',\r\n            'ERROR': \"Код ошибки\",\r\n            'METHOD': 'Метод',\r\n            'MESSAGE':\"Сообщение\"\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipErrorDetailsDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'error_details_dialog/error_details_dialog.html',\r\n                        controller: 'pipErrorDetailsDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function () {\r\n                        if (successCallback) {\r\n                            successCallback();\r\n                        }\r\n                    }, function () {\r\n                        if (cancelCallback) {\r\n                            cancelCallback();\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipErrorDetailsDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'pipTranslate', 'params', function ($scope, $rootScope, $mdDialog, pipTranslate, params) {\r\n           $scope.error = params.error;\r\n            $scope.ok = params.ok || 'OK';\r\n            $scope.cancel = params.cancel || 'CANCEL';\r\n\r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            $scope.onOk = function () {\r\n                $mdDialog.hide();\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Image slider control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipImageSlider\", []);\r\n\r\n    thisModule.directive('pipImageSlider',\r\n        function () {\r\n            return {\r\n                scope: false,\r\n                controller: ['$scope', '$element', '$attrs', '$parse', '$timeout', '$interval', '$pipImageSlider', function ($scope, $element, $attrs, $parse, $timeout, $interval, $pipImageSlider/*, $swipe*/) {\r\n                    var blocks,\r\n                        indexSetter = $parse($attrs.pipImageSliderIndex).assign,\r\n                        index = 0, newIndex,\r\n                        direction,\r\n                        type = $parse($attrs.pipAnimationType)($scope),\r\n                        DEFAULT_INTERVAL = 4500,\r\n                        interval = $parse($attrs.pipAnimationInterval)($scope),\r\n                        timePromises;\r\n\r\n                    $element.addClass('pip-image-slider');\r\n                    $element.addClass('pip-animation-' + type);\r\n\r\n                    $scope.swipeStart = 0;\r\n/*\r\n                    if ($swipe)\r\n                        $swipe.bind($element, {\r\n                            'start': function(coords) {\r\n                                if (coords) $scope.swipeStart = coords.x;\r\n                                else $scope.swipeStart = 0;\r\n                                console.log('function1', coords);\r\n                            },\r\n                            'end': function(coords) {\r\n                                var delta;\r\n                                if (coords) {\r\n                                    delta = $scope.swipeStart - coords.x;\r\n                                    if (delta > 150)  $scope.nextBlock();\r\n                                    if (delta < -150)  $scope.prevBlock();\r\n                                    $scope.swipeStart = 0;\r\n                                } else $scope.swipeStart = 0;\r\n                            }\r\n                        });\r\n*/\r\n                    setIndex();\r\n\r\n                    $timeout(function () {\r\n                        blocks = $element.find('.pip-animation-block');\r\n                        if (blocks.length > 0) $(blocks[0]).addClass('pip-show');\r\n                    });\r\n\r\n                    startInterval();\r\n\r\n                    var throttled = _.throttle(function () {\r\n                        $pipImageSlider.toBlock(type, blocks, index, newIndex, direction);\r\n                        index = newIndex;\r\n                        setIndex();\r\n                    }, 600);\r\n\r\n                    $scope.nextBlock = function() {\r\n                        restartInterval();\r\n                        newIndex = index + 1 == blocks.length ? 0 : index + 1;\r\n                        direction = 'next';\r\n                        throttled();\r\n                    };\r\n\r\n                    $scope.prevBlock = function() {\r\n                        restartInterval();\r\n                        newIndex = index - 1 < 0 ? blocks.length - 1 : index - 1;\r\n                        direction = 'prev';\r\n                        throttled();\r\n                    };\r\n\r\n                    $scope.slideTo = function (nextIndex) {\r\n                        if (nextIndex == index || nextIndex > blocks.length - 1) return;\r\n\r\n                        restartInterval();\r\n                        newIndex = nextIndex;\r\n                        direction = nextIndex > index ? 'next' : 'prev';\r\n                        throttled();\r\n                    };\r\n\r\n                    function setIndex() {\r\n                        if (indexSetter) indexSetter($scope, index);\r\n                    }\r\n\r\n                    function startInterval() {\r\n                        timePromises = $interval(function () {\r\n                            newIndex = index + 1 == blocks.length ? 0 : index + 1;\r\n                            direction = 'next';\r\n                            throttled();\r\n                        }, interval || DEFAULT_INTERVAL);\r\n                    }\r\n\r\n                    function stopInterval() {\r\n                        $interval.cancel(timePromises);\r\n                    }\r\n\r\n                    $element.on('$destroy', function() {\r\n                        stopInterval();\r\n                    });\r\n\r\n                    function restartInterval() {\r\n                        stopInterval();\r\n                        startInterval();\r\n                    }\r\n                }]\r\n            };\r\n        }\r\n    );\r\n\r\n    thisModule.directive('pipSliderButton',\r\n        function () {\r\n            return {\r\n                scope: {},\r\n                controller: ['$scope', '$element', '$parse', '$attrs', function ($scope, $element, $parse, $attrs) {\r\n                    var type = $parse($attrs.pipButtonType)($scope),\r\n                        sliderId = $parse($attrs.pipSliderId)($scope);\r\n\r\n                    $element.on('click', function () {\r\n                        if (!sliderId || !type) return;\r\n\r\n                        angular.element(document.getElementById(sliderId)).scope()[type + 'Block']();\r\n                    });\r\n                }]\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.directive('pipSliderIndicator',\r\n        function () {\r\n            return {\r\n                scope: false,\r\n                controller: ['$scope', '$element', '$parse', '$attrs', function ($scope, $element, $parse, $attrs) {\r\n                    var sliderId = $parse($attrs.pipSliderId)($scope),\r\n                        slideTo = $parse($attrs.pipSlideTo)($scope);\r\n\r\n                    $element.css('cursor', 'pointer');\r\n                    $element.on('click', function () {\r\n                        if (!sliderId || (slideTo && slideTo < 0)) return;\r\n\r\n                        angular.element(document.getElementById(sliderId)).scope().slideTo(slideTo);\r\n                    });\r\n                }]\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.service('$pipImageSlider',\r\n        ['$timeout', function ($timeout) {\r\n\r\n            var ANIMATION_DURATION = 550;\r\n\r\n            return {\r\n                nextCarousel: nextCarousel,\r\n                prevCarousel: prevCarousel,\r\n                toBlock: toBlock\r\n            };\r\n\r\n            function nextCarousel(nextBlock, prevBlock) {\r\n                nextBlock.removeClass('animated').addClass('pip-next');\r\n\r\n                $timeout(function () {\r\n                    nextBlock.addClass('animated').addClass('pip-show').removeClass('pip-next');\r\n                    prevBlock.addClass('animated').removeClass('pip-show');\r\n                }, 100);\r\n            }\r\n\r\n            function prevCarousel (nextBlock, prevBlock) {\r\n                nextBlock.removeClass('animated');\r\n\r\n                $timeout(function () {\r\n                    nextBlock.addClass('animated').addClass('pip-show');\r\n                    prevBlock.addClass('animated').addClass('pip-next').removeClass('pip-show');\r\n\r\n                    $timeout(function () {\r\n                        prevBlock.removeClass('pip-next').removeClass('animated');\r\n                    }, ANIMATION_DURATION - 100);\r\n                }, 100);\r\n            }\r\n\r\n            function toBlock(type, blocks, oldIndex, nextIndex, direction) {\r\n                var prevBlock = $(blocks[oldIndex]),\r\n                    blockIndex = nextIndex;\r\n                var nextBlock = $(blocks[blockIndex]);\r\n\r\n                if (type == 'carousel') {\r\n                    $(blocks).removeClass('pip-next').removeClass('pip-prev');\r\n\r\n                    if (direction && direction == 'prev')\r\n                        prevCarousel(nextBlock, prevBlock);\r\n                    else {\r\n                        if (direction && direction == 'next') {\r\n                            nextCarousel(nextBlock, prevBlock);\r\n                        } else {\r\n                            if (nextIndex && nextIndex < oldIndex)\r\n                                prevCarousel(nextBlock, prevBlock);\r\n                            else\r\n                                nextCarousel(nextBlock, prevBlock);\r\n                        }\r\n                    }\r\n                } else {\r\n                    prevBlock.addClass('animated').removeClass('pip-show');\r\n                    nextBlock.addClass('animated').addClass('pip-show');\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Information dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipInformationDialog', \r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'INFORMATION_TITLE': 'Information'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'INFORMATION_TITLE': 'Информация'\r\n        });\r\n    }]);\r\n        \r\n    thisModule.factory('pipInformationDialog', \r\n        ['$mdDialog', '$timeout', function ($mdDialog, $timeout) {\r\n            return {\r\n                show: function (params, callback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'information_dialog/information_dialog.html',\r\n                        controller: 'pipInformationDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function () {\r\n                        if (callback) callback();\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipInformationDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'pipTranslate', 'params', 'pipUtils', function ($scope, $rootScope, $mdDialog, pipTranslate, params, pipUtils) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'INFORMATION_TITLE';\r\n\r\n            var content = pipTranslate.translate(params.message);\r\n            if (params.item) {\r\n                var item = _.truncate(params.item, 25);\r\n                content = pipUtils.sprintf(content, item);\r\n            }\r\n            $scope.content = content;\r\n            $scope.ok = params.ok || 'OK';\r\n\r\n            $scope.onOk = function () {\r\n                $mdDialog.hide();\r\n            };\r\n        }]        \r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Markdown control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Move css styles under control\r\n * - Improve samples in sampler app\r\n */\r\n\r\n/* global angular, pip, marked */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipMarkdown\", ['ngSanitize', 'pipUtils', 'pipTranslate']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'MARKDOWN_ATTACHMENTS': 'Attachments:',\r\n            'checklist': 'Checklist',\r\n            'documents': 'Documents',\r\n            'pictures': 'Pictures',\r\n            'location': 'Location',\r\n            'time': 'Time'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'MARKDOWN_ATTACHMENTS': 'Вложения:',\r\n            'checklist': 'Список',\r\n            'documents': 'Документы',\r\n            'pictures': 'Изображения',\r\n            'location': 'Местонахождение',\r\n            'time': 'Время'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipMarkdown',\r\n        ['$parse', 'pipUtils', 'pipTranslate', function($parse, pipUtils, pipTranslate) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: false,\r\n                link: function ($scope, $element, $attrs) {\r\n                    var\r\n                        textGetter = $parse($attrs.pipText),\r\n                        listGetter = $parse($attrs.pipList),\r\n                        clampGetter = $parse($attrs.pipLineCount);\r\n\r\n                    function describeAttachments(array) {\r\n                        var attachString = '',\r\n                            attachTypes = [];\r\n\r\n                        _.each(array, function(attach) {\r\n                            if (attach.type && attach.type != 'text') {\r\n                                if (attachString.length == 0) attachString = pipTranslate.translate('MARKDOWN_ATTACHMENTS');\r\n\r\n                                if (attachTypes.indexOf(attach.type) < 0) {\r\n                                    attachTypes.push(attach.type);\r\n                                    attachString += (attachTypes.length > 1 ? ', ' : ' ') + pipTranslate.translate(attach.type);\r\n                                }\r\n                            }\r\n                        })\r\n\r\n                        return attachString;\r\n                    }\r\n\r\n                    function bindText(value) {\r\n                        var textString;\r\n\r\n                        if (_.isArray(value)) {\r\n                            var obj = _.find(value, function(item) {\r\n                                return item.type == 'text' && item.text;\r\n                            });\r\n\r\n                            textString =  obj ? obj.text : describeAttachments(value);\r\n                        } else {\r\n                            textString = value;\r\n                        }\r\n\r\n                        var isClamped = $attrs.pipLineCount && _.isNumber(clampGetter()) && (textString && textString.length > 0),\r\n                            height,\r\n                            options = {\r\n                                gfm: true,\r\n                                tables: true,\r\n                                breaks: true,\r\n                                sanitize: true,\r\n                                pedantic: true,\r\n                                smartLists: true,\r\n                                smartypents: false\r\n                            };\r\n                        textString = marked(textString || '', options);\r\n                        if (isClamped) height = 1.5 * clampGetter();\r\n                        // Assign value as HTML\r\n                        $element.html('<div' + (isClamped ? ' class=\"pip-markdown-content\" style=\"max-height: ' + height + 'em\">' : '>') + textString + '</div>');\r\n                        $element.find('a').attr('target', 'blank');\r\n                        if (!listGetter() && isClamped) $element.append('<div class=\"pip-gradient-block\"></div>');\r\n                    }\r\n\r\n                    // Fill the text\r\n                    bindText(textGetter($scope));\r\n\r\n                    // Also optimization to avoid watch if it is unnecessary\r\n                    if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                        $scope.$watch(textGetter, function(newValue) {\r\n                            bindText(newValue);\r\n                        });\r\n                    }\r\n\r\n                    $scope.$on('pipWindowResized', function () {\r\n                        bindText(textGetter($scope));\r\n                    });\r\n\r\n                    // Add class\r\n                    $element.addClass('pip-markdown');\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Options dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n * - Remove deleted hack in the controller\r\n */\r\n \r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipOptionsDialog', \r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'OPTIONS_TITLE': 'Choose Option'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'OPTIONS_TITLE': 'Выберите опцию'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipOptionsDialog', \r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    if (params.event) {\r\n                        params.event.stopPropagation();\r\n                        params.event.preventDefault();\r\n                    }\r\n\r\n                    function focusToggleControl() {\r\n                        if (params.event && params.event.currentTarget)\r\n                            params.event.currentTarget.focus();\r\n                    }\r\n\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'options_dialog/options_dialog.html',\r\n                        controller: 'pipOptionsDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function (option) {\r\n                        focusToggleControl();\r\n\r\n                        if (successCallback) successCallback(option);\r\n                    }, function () {\r\n                        focusToggleControl();\r\n                        if (cancelCallback) cancelCallback();\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipOptionsDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'params', function ($scope, $rootScope, $mdDialog, params) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'OPTIONS_TITLE';\r\n            $scope.options = params.options;\r\n            $scope.selectedOption = _.find(params.options, {active: true}) || {};\r\n            $scope.selectedOptionName = $scope.selectedOption.name;\r\n            $scope.applyButtonTitle = params.appleButtonTitle || 'SELECT';\r\n            \r\n            $scope.deleted = params.deleted;\r\n            $scope.deletedTitle = params.deletedTitle;\r\n    \r\n            $scope.onOptionSelect = function (event, option) {\r\n                event.stopPropagation();\r\n                $scope.selectedOptionName = option.name;\r\n            };\r\n    \r\n            $scope.onKeyPress = function(event) {\r\n                if (event.keyCode == 32 || event.keyCode == 13) {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    $scope.onSelect();\r\n                }\r\n            };\r\n    \r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n            \r\n            $scope.onSelect = function () {\r\n                var option = _.find(params.options, {name: $scope.selectedOptionName});\r\n                $mdDialog.hide({ option: option, deleted: $scope.deleted });\r\n            };\r\n    \r\n            // Setting focus to input control\r\n            function focusInput() {\r\n                var list = $('.pip-options-dialog .pip-list');\r\n                list.focus();\r\n            };\r\n            setTimeout(focusInput, 500);\r\n    \r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Options dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n * - Remove deleted hack in the controller\r\n */\r\n \r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipOptionsBigDialog',\r\n        ['ngMaterial', 'pipUtils', 'pipTranslate', 'pipBasicControls.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'OPTIONS_TITLE': 'Choose Option'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'OPTIONS_TITLE': 'Выберите опцию'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipOptionsBigDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    if (params.event) {\r\n                        params.event.stopPropagation();\r\n                        params.event.preventDefault();\r\n                    }\r\n\r\n                    function focusToggleControl() {\r\n                        if (params.event && params.event.currentTarget)\r\n                            params.event.currentTarget.focus();\r\n                    }\r\n\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'options_dialog/options_dialog_big.html',\r\n                        controller: 'pipOptionsDialogBigController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function (option) {\r\n                        focusToggleControl();\r\n\r\n                        if (successCallback) successCallback(option);\r\n                    }, function () {\r\n                        focusToggleControl();\r\n                        if (cancelCallback) cancelCallback();\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipOptionsDialogBigController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'params', function ($scope, $rootScope, $mdDialog, params) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'OPTIONS_TITLE';\r\n            $scope.options = params.options;\r\n            $scope.noActions = params.noActions || false;\r\n            $scope.noTitle = params.noTitle || false;\r\n            $scope.hint = params.hint || '';\r\n            $scope.selectedOption = _.find(params.options, {active: true}) || {};\r\n            $scope.selectedOptionName = $scope.selectedOption.name;\r\n            $scope.optionIndex  = _.findIndex(params.options,$scope.selectedOption);\r\n            $scope.applyButtonTitle = params.applyButtonTitle || 'SELECT';\r\n            \r\n            $scope.deleted = params.deleted;\r\n            $scope.deletedTitle = params.deletedTitle;\r\n    \r\n            $scope.onOptionSelect = function (event, option) {\r\n                event.stopPropagation();\r\n                $scope.selectedOptionName = option.name;\r\n\r\n                if ($scope.noActions) {\r\n                    $scope.onSelect();\r\n                }\r\n            };\r\n\r\n            $scope.onSelected = function (event) {\r\n                $scope.selectedOptionName = $scope.options[$scope.optionIndex].name;\r\n\r\n                if ($scope.noActions) {\r\n                    // $scope.onSelect();\r\n                }\r\n            };\r\n    \r\n            $scope.onKeyUp = function(event, index) {\r\n                if (event.keyCode == 32 || event.keyCode == 13) {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    if (index != undefined && index > -1 && index < $scope.options.length) {\r\n                        $scope.selectedOptionName = $scope.options[index].name;\r\n                        $scope.onSelect();\r\n                    }\r\n                }\r\n            };\r\n    \r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n            \r\n            $scope.onSelect = function () {\r\n                var option = _.find($scope.options, {name: $scope.selectedOptionName});\r\n                $mdDialog.hide({ option: option, deleted: $scope.deleted });\r\n            };\r\n    \r\n            // Setting focus to input control\r\n            function focusInput() {\r\n                var list = $('.pip-options-dialog .pip-list');\r\n                list.focus();\r\n            };\r\n            setTimeout(focusInput, 500);\r\n    \r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Popover control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n *\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipPopover\", ['pipAssert']);\r\n\r\n    thisModule.directive('pipPopover', function () {\r\n        return {\r\n            restrict: 'EA',\r\n            scope: true,\r\n            templateUrl: 'popover/popover.template.html',\r\n            controller:\r\n                ['$scope', '$rootScope', '$element', '$timeout', '$compile', function ($scope, $rootScope, $element, $timeout, $compile) {\r\n                    var backdropElement = $('.pip-popover-backdrop');\r\n                    backdropElement.on('click keydown scroll', backdropClick);\r\n                    backdropElement.addClass($scope.params.responsive !== false ? 'pip-responsive' : '');\r\n\r\n                    $timeout(function () {\r\n                        position();\r\n                        if ($scope.params.template) {\r\n                            var content = $compile($scope.params.template)($scope);\r\n                            $element.find('.pip-popover').append(content);\r\n                        }\r\n\r\n                        init();\r\n                    });\r\n\r\n                    $timeout(function() {\r\n                        calcHeight();\r\n                    }, 200);\r\n\r\n                    $scope.onPopoverClick = onPopoverClick;\r\n                    $scope = _.defaults($scope, $scope.$parent);\r\n\r\n                    $rootScope.$on('pipPopoverResize', onResize);\r\n                    $(window).resize(onResize);\r\n\r\n                    function init() {\r\n                        backdropElement.addClass('opened');\r\n                        $('.pip-popover-backdrop').focus();\r\n                        if ($scope.params.timeout) {\r\n                            $timeout(function () {\r\n                                closePopover();\r\n                            }, $scope.params.timeout);\r\n                        }\r\n                    }\r\n\r\n                    function backdropClick() {\r\n                        if ($scope.params.cancelCallback)\r\n                            $scope.params.cancelCallback();\r\n\r\n                        closePopover();\r\n                    }\r\n\r\n                    function closePopover () {\r\n                        backdropElement.removeClass('opened');\r\n                        $timeout(function () {\r\n                            backdropElement.remove();\r\n                        }, 100);\r\n                    }\r\n\r\n                    function onPopoverClick ($e) {\r\n                        $e.stopPropagation();\r\n                    }\r\n\r\n                    function position() {\r\n                        if ($scope.params.element) {\r\n                            var element = $($scope.params.element),\r\n                                pos = element.offset(),\r\n                                width = element.width(),\r\n                                height = element.height(),\r\n                                docWidth = $(document).width(),\r\n                                docHeight = $(document).height(),\r\n                                popover = backdropElement.find('.pip-popover');\r\n\r\n                            if (pos)\r\n                                popover\r\n                                    .css('max-width', docWidth - (docWidth - pos.left))\r\n                                    .css('max-height', docHeight - (pos.top + height) - 32, 0)\r\n                                    .css('left', pos.left - popover.width() + (width / 2))\r\n                                    .css('top', pos.top + height + 16);\r\n                        }\r\n                    }\r\n\r\n                    function calcHeight () {\r\n                        if ($scope.params.calcHeight === false) return;\r\n\r\n                        var popover = backdropElement.find('.pip-popover'),\r\n                            title = popover.find('.pip-title'),\r\n                            footer = popover.find('.pip-footer'),\r\n                            content = popover.find('.pip-content'),\r\n                            contentHeight = popover.height() - title.outerHeight(true) - footer.outerHeight(true);\r\n\r\n                        content.css('max-height', Math.max(contentHeight, 0) + 'px').css('box-sizing', 'border-box');\r\n                    }\r\n\r\n                    function onResize () {\r\n                        console.log('resized func');\r\n\r\n                        backdropElement.find('.pip-popover').find('.pip-content').css('max-height', '100%');\r\n                        position();\r\n                        calcHeight();\r\n                    }\r\n                }]\r\n        };\r\n    });\r\n\r\n    thisModule.service('$pipPopover',\r\n        ['$compile', '$rootScope', '$timeout', function ($compile, $rootScope, $timeout) {\r\n            var popoverTemplate = \"<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'>\" +\r\n                                    \"<pip-popover pip-params='params'>\" +\r\n                                    \"</pip-popover>\" +\r\n                                  \"</div>\";\r\n\r\n            return {\r\n                show: onShow,\r\n                hide: onHide,\r\n                resize: onResize\r\n            };\r\n\r\n            function onShow(params) {\r\n                var element = $('body');\r\n\r\n                if (element.find('md-backdrop').length > 0) return;\r\n                onHide();\r\n\r\n                var scope = $rootScope.$new(),\r\n                    params = params && _.isObject(params) ? params : {},\r\n                    content;\r\n\r\n                scope.params = params;\r\n                scope.locals = params.locals;\r\n                content = $compile(popoverTemplate)(scope);\r\n                element.append(content);\r\n            }\r\n\r\n            function onHide () {\r\n                var backdropElement = $('.pip-popover-backdrop');\r\n\r\n                backdropElement.removeClass('opened');\r\n                $timeout(function () {\r\n                    backdropElement.remove();\r\n                }, 100);\r\n            }\r\n\r\n            function onResize () {\r\n                $rootScope.$broadcast('pipPopoverResize');\r\n            }\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Routing progress control\r\n * @description \r\n * This progress control is enabled by ui router \r\n * while switching between pages\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipRoutingProgress\", ['ngMaterial']);\r\n\r\n    thisModule.directive('pipRoutingProgress', function() {\r\n       return {\r\n           restrict: 'EA',\r\n           replace: true,\r\n           templateUrl: 'progress/routing_progress.html'\r\n       };\r\n    });\r\n   \r\n})();","/**\r\n * @file Refresh button control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipRefreshButton\", ['ngMaterial']);\r\n\r\n    thisModule.directive('pipRefreshButton',  \r\n        ['$parse', function($parse) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: false,\r\n                template: String()\r\n                    + '<md-button class=\"pip-refresh-button\" tabindex=\"-1\" ng-click=\"onClick($event)\" aria-label=\"REFRESH\">'\r\n                    + '<md-icon md-svg-icon=\"icons:refresh\"></md-icon>'\r\n                    + ' <span class=\"pip-refresh-text\"></span>'\r\n                    + '</md-button>',\r\n                replace: false,\r\n                link: function ($scope, $element, $attrs) {\r\n                    var\r\n                        textGetter = $parse($attrs.pipText),\r\n                        visibleGetter = $parse($attrs.pipVisible),\r\n                        refreshGetter = $parse($attrs.pipRefresh),\r\n                        $button = $element.children('.md-button'),\r\n                        $text = $button.children('.pip-refresh-text');\r\n\r\n                    var show = function() {\r\n                        // Set a new text\r\n                        var text = textGetter($scope);\r\n                        $text.text(text);\r\n\r\n                        // Show button\r\n                        $button.show();\r\n                        \r\n                        // Adjust position\r\n                        var width = $button.width();\r\n                        $button.css('margin-left', '-' + (width / 2) + 'px');\r\n                    };\r\n\r\n                    function hide() {\r\n                        $button.hide();  \r\n                    };\r\n\r\n                    $scope.onClick = function(event) {\r\n                        refreshGetter($scope);  \r\n                    };\r\n\r\n                    $scope.$watch(visibleGetter, function(newValue) {\r\n                        if (newValue == true) show();\r\n                        else hide();\r\n                    });\r\n\r\n                    $scope.$watch(textGetter, function(newValue) {\r\n                        $text.text(newValue);\r\n                    });\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Time control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipTimeEdit\", ['pipUtils', 'pipTranslate']);\r\n\r\n    thisModule.directive('pipTimeEdit',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipStartDate: '=',\r\n                    pipChanged: '&',\r\n                    pipEndDate: '=',\r\n                    pipStartLabel: '@',\r\n                    pipEndLabel: '@',\r\n                    disabled: '&ngDisabled',\r\n                    pipSize: '='\r\n                },\r\n                templateUrl: 'time_edit/time_edit.html',\r\n                controller: 'pipTimeEditController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipTimeEditController',\r\n        ['$scope', '$element', '$attrs', 'pipDates', 'pipTranslate', function ($scope, $element, $attrs, pipDates, pipTranslate) {\r\n\r\n            function getDateJSON(value) {\r\n                var date = value ? new Date(value) : null;\r\n                return date;\r\n            };\r\n\r\n            function setDuration() {\r\n                if (!$scope.data.startDate || !$scope.data.endDate)\r\n                    return null;\r\n\r\n                var start, end;\r\n                start = new Date($scope.data.startDate.getTime() + $scope.data.startTime * 60 * 1000);\r\n                end = new Date($scope.data.endDate.getTime() + $scope.data.endTime * 60 * 1000);\r\n                return end - start;\r\n            };\r\n\r\n            function validateStartDate() {\r\n                // если начальная дата не задана, обнуляем и выходим\r\n                if (!$scope.data.startDate) {\r\n                    $scope.data.startTime = null;\r\n                    return;\r\n                }\r\n                // еcли не задано начальное время - задаем его\r\n                if (!$scope.data.startTime) {\r\n                    if (!$scope.data.endTime) {\r\n                        var date = new Date();\r\n                        $scope.data.startTime = Math.floor((date.getTime() -  pipDates.toStartDay(date)) / (30 * 60 * 1000)) * 30;\r\n                    } else {\r\n                        $scope.data.startTime = $scope.data.endTime == 0 ? 0 : $scope.data.endTime - 30;\r\n                    }\r\n                }\r\n\r\n                // если конечная дата не задана, обнуляем и выходим\r\n                if (!$scope.data.endDate) {\r\n                    $scope.data.endTime = null;\r\n                    return;\r\n                }\r\n\r\n                var start, end;\r\n                start = new Date($scope.data.startDate.getTime() + $scope.data.startTime * 60 * 1000);\r\n                // Если есть длительность, то сохраняем ее. Длительность можно изменить только изменяя конечную дату\r\n                if ($scope.data.duration) {\r\n                    end = new Date(start.getTime() + $scope.data.duration);\r\n                    $scope.data.endDate = pipDates.toStartDay(end);\r\n                    $scope.data.endTime = Math.floor((end.getTime() - $scope.data.endDate.getTime()) / (30 * 60 * 1000)) * 30;\r\n                } else {\r\n                    // Если нет длительности сравниваем даты\r\n                    end = new Date($scope.data.endDate.getTime() + $scope.data.endTime * 60 * 1000);\r\n                    if (start >= end) {\r\n                        // Если начальная дата больше, то двигаем конечную дату\r\n                        $scope.data.endDate = pipDates.toStartDay(new Date(start.getTime() + (30 * 60000)));\r\n                        $scope.data.endTime = ($scope.data.startTime + 30) % 1440;\r\n                    }\r\n                }\r\n            };\r\n\r\n            function validateEndDate() {\r\n                // если начальная дата не задана, обнуляем и выходим\r\n                if (!$scope.data.endDate) {\r\n                    $scope.data.endTime = null;\r\n                    return;\r\n                }\r\n                // еcли не задано конечное время - задаем его\r\n                if (!$scope.data.endTime) {\r\n                    if (!$scope.data.startTime) {\r\n                        var date = new Date();\r\n                        $scope.data.endTime = Math.floor((date.getTime() -  pipDates.toStartDay(date)) / (30 * 60 * 1000)) * 30;\r\n                    } else {\r\n                        $scope.data.endTime = $scope.data.startTime == 1410 ? 1410 : $scope.data.startTime + 30;\r\n                    }\r\n                }\r\n\r\n                // если yачальная дата не задана, обнуляем и выходим\r\n                if (!$scope.data.startDate) {\r\n                    $scope.data.startTime = null;\r\n                    return;\r\n                }\r\n\r\n                var start, end;\r\n                start = new Date($scope.data.startDate.getTime() + $scope.data.startTime * 60 * 1000);\r\n                end = new Date($scope.data.endDate.getTime() + $scope.data.endTime * 60 * 1000);\r\n                if (start >= end) {\r\n                    // Если начальная дата больше, то двигаем начальную дату\r\n                    $scope.data.startDate = pipDates.toStartDay(new Date(end.getTime() - 30 * 60000));\r\n                    $scope.data.startTime = ($scope.data.endTime % 1440 == 0) ? 1410 : $scope.data.endTime - 30;\r\n                }\r\n\r\n                $scope.data.duration = setDuration();\r\n            };\r\n\r\n            function setDate() {\r\n                $scope.data.bind = false;\r\n                if($scope.data.startDate) {\r\n                    var time = $scope.data.startTime ? $scope.data.startTime * 60 * 1000 : 0;\r\n                    $scope.pipStartDate = new Date($scope.data.startDate.getTime() + time);\r\n                }\r\n                if($scope.data.endDate) {\r\n                    var time = $scope.data.endTime ? $scope.data.endTime * 60 * 1000 : 0;\r\n                    $scope.pipEndDate = new Date($scope.data.endDate.getTime() + time);\r\n                }\r\n                $scope.data.bind = true;\r\n            };\r\n\r\n            function defineDate() {\r\n                var start, end;\r\n                if (($scope.pipStartDate !== null) && ($scope.pipStartDate !== undefined)) {\r\n                    var start = _.isDate($scope.pipStartDate) ?  $scope.pipStartDate : null;\r\n                    if (!start) {\r\n                        start = getDateJSON($scope.pipStartDate);\r\n                    }\r\n                    $scope.data.startDate = pipDates.toStartDay(start);\r\n                    $scope.data.startTime = (new Date(start) - $scope.data.startDate) / (60 * 1000);\r\n                }\r\n\r\n                if (($scope.pipEndDate !== null) && ($scope.pipEndDate !== undefined)) {\r\n                    var end = _.isDate($scope.pipEndDate) ?  $scope.pipEndDate : null;\r\n                    if (!start) {\r\n                        end = getDateJSON($scope.pipEndDate);\r\n                    }\r\n                    $scope.data.endDate = pipDates.toStartDay(end);\r\n                    $scope.data.endTime = (new Date(end) - $scope.data.endDate) / (60 * 1000);\r\n                }\r\n                validateStartDate();\r\n                $scope.data.duration = setDuration();\r\n                setDate();\r\n            };\r\n\r\n            function getTimeInterval() {\r\n                var result = [];\r\n\r\n                for (var i = 0; i < 24; i++) {\r\n                    for (var j = 0; j < 2; j++) {\r\n                        var minutes = j * 30;\r\n                        result.push({\r\n                            id: (i * 60 + minutes),\r\n                            time: _.pad(i.toString(),3,'0').substr(0, 2) + ':' + _.pad(minutes.toString(),2,'0')\r\n                        });\r\n                    }\r\n                }\r\n\r\n                return result;\r\n            };\r\n\r\n            function initDate() {\r\n                $scope.data.startDate = null;\r\n                $scope.data.startTime = null;\r\n                $scope.data.endDate = null;\r\n                $scope.data.endTime = null;\r\n                $scope.data.duration = null;\r\n            };\r\n\r\n            // initialize data\r\n            $scope.intervalTimeCollection = getTimeInterval();\r\n            $scope.data = {};\r\n            $scope.startLabel = $scope.pipStartLabel ? pipTranslate.translate($scope.pipStartLabel) : pipTranslate.translate('EVENT_NEW_START_TIME');\r\n            $scope.endLabel = $scope.pipEndLabel ? pipTranslate.translate($scope.pipEndLabel) : pipTranslate.translate('EVENT_NEW_END_TIME');\r\n            initDate();\r\n            defineDate();\r\n\r\n            // process function\r\n            $scope.onChangeStartDate = function () {\r\n                validateStartDate();\r\n                $scope.data.duration = setDuration();\r\n                setDate();\r\n                $scope.pipChanged();\r\n            };\r\n\r\n            $scope.onChangeEndDate = function () {\r\n                validateEndDate();\r\n                $scope.data.duration = setDuration();\r\n                setDate();\r\n                $scope.pipChanged();\r\n            };\r\n\r\n            $scope.onChangeStartTime = function () {\r\n                if (!$scope.data.startDate)\r\n                    $scope.data.startDate = pipDates.toStartDay(new Date());\r\n                validateStartDate();\r\n                $scope.data.duration = setDuration();\r\n                setDate();\r\n                $scope.pipChanged();\r\n            };\r\n\r\n            $scope.onChangeEndTime = function () {\r\n                if (!$scope.data.endDate)\r\n                    $scope.data.endDate = pipDates.toStartDay(new Date());\r\n                validateEndDate();\r\n                $scope.data.duration = setDuration();\r\n                setDate();\r\n                $scope.pipChanged();\r\n            };\r\n\r\n            $scope.isDisabled = function () {\r\n                if ($scope.disabled){\r\n                    return $scope.disabled();\r\n                } else {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            $scope.$watchGroup([$scope.pipStartDate, $scope.pipEndDate], function() {\r\n                if ($scope.data.bind) {\r\n                    initDate();\r\n                    defineDate();\r\n                }\r\n            });\r\n\r\n            $scope.$watch($scope.disabled, function(newValue) {\r\n                $scope.disableControls = newValue;\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-time-edit');\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Time control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipTimeView\", ['pipUtils']);\r\n\r\n    thisModule.directive('pipTimeView',\r\n        ['pipUtils', function (pipUtils) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipStartDate: '=',\r\n                    pipEndDate: '='\r\n                },\r\n                templateUrl:  'time_view/time_view.html',\r\n                link: function ($scope, $element, $attrs) {\r\n\r\n                    function getDateJSON(value) {\r\n                        var date = value ? new Date(value) : null;\r\n                        return date;\r\n                    };\r\n\r\n                    function defineStartDate() {\r\n                        if (($scope.pipStartDate !== null) && ($scope.pipStartDate !== undefined)) {\r\n                            $scope.data.start = _.isDate($scope.pipStartDate) ?  $scope.pipStartDate : getDateJSON($scope.pipStartDate);\r\n                        }\r\n                    };\r\n\r\n                    function defineEndDate() {\r\n                        if (($scope.pipEndDate !== null) && ($scope.pipEndDate !== undefined)) {\r\n                            $scope.data.end = _.isDate($scope.pipEndDate) ?  $scope.pipEndDate : getDateJSON($scope.pipEndDate);\r\n                        }\r\n                    };\r\n\r\n                    $scope.data = {};\r\n                    $scope.data.start = null;\r\n                    $scope.data.end = null;\r\n                    defineStartDate();\r\n                    defineEndDate();\r\n\r\n                    if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                        $scope.$watch('pipStartDate',\r\n                            function (newValue) {\r\n                                $scope.data.start = null;\r\n                                defineStartDate();\r\n                            }\r\n                        );\r\n                        $scope.$watch('pipEndDate',\r\n                            function (newValue) {\r\n                                $scope.data.end = null;\r\n                                defineEndDate();\r\n                            }\r\n                        );\r\n                    }\r\n\r\n                    // Add class\r\n                    $element.addClass('pip-time-view');\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Toasts management service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo Replace ngAudio with alternative service\r\n */\r\n \r\n /* global _, angular */\r\n \r\n(function () {\r\n    'use strict';\r\n    \r\n    var thisModule = angular.module('pipToasts', ['pipTranslate', 'ngMaterial', 'pipAssert']);\r\n\r\n    thisModule.controller('pipToastController',\r\n        ['$scope', '$mdToast', 'toast', 'pipErrorDetailsDialog', 'sounds', function ($scope, $mdToast, toast, pipErrorDetailsDialog, sounds) {\r\n            // if (toast.type && sounds['toast_' + toast.type]) {\r\n            //     sounds['toast_' + toast.type].play();\r\n            // }\r\n\r\n            $scope.message = toast.message;\r\n            $scope.actions = toast.actions;\r\n            $scope.toast = toast;\r\nconsole.log($scope.toast);\r\n\r\n            $scope.onDetails =  function(event) {\r\n                $mdToast.hide();\r\n                pipErrorDetailsDialog.show(\r\n                    {\r\n                        error: $scope.toast.error,\r\n                        ok: 'Ok'\r\n                    },\r\n                    function () {\r\n                        console.log('You agreed');\r\n                    },\r\n                    function () {\r\n                        console.log('You disagreed');\r\n                    }\r\n                );\r\n            };\r\n\r\n            $scope.onAction = function (action) {\r\n                $mdToast.hide({ action: action });\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.service('pipToasts', \r\n        ['$rootScope', '$mdToast', 'pipAssert', function ($rootScope, $mdToast, pipAssert) {\r\n            var \r\n                SHOW_TIMEOUT = 20000,\r\n                SHOW_TIMEOUT_NOTIFICATIONS = 20000,\r\n                toasts = [], \r\n                currentToast,\r\n                sounds = {};\r\n\r\n            /** pre-load sounds for notifications */\r\n            // sounds['toast_error'] = ngAudio.load('sounds/fatal.mp3');\r\n            // sounds['toast_notification'] = ngAudio.load('sounds/error.mp3');\r\n            // sounds['toast_message'] = ngAudio.load('sounds/warning.mp3');\r\n\r\n            // Remove error toasts when page is changed\r\n            $rootScope.$on('$stateChangeSuccess', onStateChangeSuccess);\r\n            $rootScope.$on('pipSessionClosed', onClearToasts);\r\n\r\n            return {\r\n                showNotification: showNotification,\r\n                showMessage: showMessage,\r\n                showError: showError,\r\n                hideAllToasts: hideAllToasts,\r\n                clearToasts: clearToasts,\r\n                removeToastsById: removeToastsById,\r\n                getToastById: getToastById\r\n            };\r\n\r\n            //---------------------------\r\n\r\n            // Take the next from queue and show it\r\n            function showNextToast() {\r\n                if (toasts.length > 0) {\r\n                    var toast = toasts[0];\r\n                    toasts.splice(0, 1);\r\n                    showToast(toast);\r\n                }\r\n            }\r\n    \r\n            // Show toast\r\n            function showToast(toast) {\r\n                console.log(toast);\r\n                currentToast = toast;\r\n    \r\n                $mdToast.show({\r\n                    templateUrl: 'toast/toast.html',\r\n                    hideDelay: toast.duration || SHOW_TIMEOUT,\r\n                    position: 'bottom left',\r\n                    controller: 'pipToastController',\r\n                    locals: {\r\n                        toast: currentToast,\r\n                        sounds: sounds\r\n                    }\r\n                })\r\n                .then(\r\n                    function showToastOkResult(action) {\r\n                        if (currentToast.successCallback) {\r\n                            currentToast.successCallback(action);\r\n                        }\r\n                        currentToast = null;\r\n                        showNextToast();\r\n                    }, \r\n                    function showToastCancelResult(action) {\r\n                        if (currentToast.cancelCallback) {\r\n                            currentToast.cancelCallback(action);\r\n                        }\r\n                        currentToast = null;\r\n                        showNextToast();\r\n                    }\r\n                );\r\n            }\r\n    \r\n            function addToast(toast) {\r\n\r\n                if (currentToast && toast.type !='error')\r\n                    toasts.push(toast);\r\n                else showToast(toast);\r\n            }\r\n    \r\n            function removeToasts(type) {\r\n                var result = [];\r\n                _.each(toasts, function (toast) {\r\n                    if (!toast.type || toast.type != type)\r\n                        result.push(toast);\r\n                });\r\n                toasts = _.cloneDeep(result);\r\n            }\r\n\r\n            function removeToastsById(id) {\r\n                _.remove(toasts, {id: id});\r\n            }\r\n\r\n            function getToastById(id) {\r\n                return _.find(toasts, {id: id});\r\n            }\r\n    \r\n            function onStateChangeSuccess(event, toState, toParams, fromState, fromParams) {\r\n                toasts = _.reject(toasts, function(toast) {\r\n                    return toast.type == 'error'; \r\n                });\r\n\r\n                if (currentToast && currentToast.type == 'error') {\r\n                    $mdToast.cancel();\r\n                    showNextToast();\r\n                }\r\n            }\r\n\r\n            function onClearToasts(event) {\r\n                clearToasts();\r\n            }\r\n    \r\n            // Show new notification toast at the top right\r\n            function showNotification(message, actions, successCallback, cancelCallback, id) {\r\n                pipAssert.isDef(message, 'pipToasts.showNotification: message should be defined');\r\n                pipAssert.isString(message, 'pipToasts.showNotification: message should be a string');\r\n                pipAssert.isArray(actions || [], 'pipToasts.showNotification: actions should be an array');\r\n                if (successCallback) pipAssert.isFunction(successCallback, 'pipToasts.showNotification: successCallback should be a function');\r\n                if (cancelCallback) pipAssert.isFunction(cancelCallback, 'pipToasts.showNotification: cancelCallback should be a function');\r\n\r\n                addToast({\r\n                    id: id || null,\r\n                    type: 'notification',\r\n                    message: message,\r\n                    actions: actions || ['ok'],\r\n                    successCallback: successCallback,\r\n                    cancelCallback: cancelCallback,\r\n                    duration: SHOW_TIMEOUT_NOTIFICATIONS\r\n                });\r\n            }\r\n\r\n            // Show new message toast at the top right\r\n            function showMessage(message, successCallback, cancelCallback, id) {\r\n                pipAssert.isDef(message, 'pipToasts.showMessage: message should be defined');\r\n                pipAssert.isString(message, 'pipToasts.showMessage: message should be a string');\r\n                if (successCallback) pipAssert.isFunction(successCallback, 'pipToasts.showMessage: successCallback should be a function');\r\n                if (cancelCallback) pipAssert.isFunction(cancelCallback, 'pipToasts.showMessage: cancelCallback should be a function');\r\n\r\n                addToast({\r\n                    id: id || null,\r\n                    type: 'message',\r\n                    message: message,\r\n                    actions: ['ok'],\r\n                    successCallback: successCallback,\r\n                    cancelCallback: cancelCallback\r\n                });\r\n            }\r\n\r\n            // Show error toast at the bottom right after error occured\r\n            function showError(message, successCallback, cancelCallback, id, error) {\r\n                pipAssert.isDef(message, 'pipToasts.showError: message should be defined');\r\n                pipAssert.isString(message, 'pipToasts.showError: message should be a string');\r\n                if (successCallback) pipAssert.isFunction(successCallback, 'pipToasts.showError: successCallback should be a function');\r\n                if (cancelCallback) pipAssert.isFunction(cancelCallback, 'pipToasts.showError: cancelCallback should be a function');\r\n\r\n                addToast({\r\n                    id: id || null,\r\n                    error: error,\r\n                    type: 'error',\r\n                    message: message,\r\n                    actions: ['ok'],\r\n                    successCallback: successCallback,\r\n                    cancelCallback: cancelCallback\r\n                });\r\n            }\r\n\r\n            // Hide and clear all toast when user signs out\r\n            function hideAllToasts() {\r\n                $mdToast.cancel();\r\n                toasts = [];\r\n            }\r\n\r\n            // Clear toasts by type\r\n            function clearToasts(type) {\r\n                if (type) {\r\n                    pipAssert.isString(type, 'pipToasts.clearToasts: type should be a string');\r\n\r\n                    removeToasts(type);\r\n                } else {\r\n                    $mdToast.cancel();\r\n                    toasts = [];\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Toggle buttons control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipToggleButtons\", ['pipBasicControls.Templates']);\r\n\r\n    thisModule.directive('pipToggleButtons',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    buttons: '=pipButtons',\r\n                    currentButtonValue: '=ngModel',\r\n                    currentButton: '=?pipButtonObject',\r\n                    change: '&ngChange'\r\n                },\r\n                templateUrl: 'toggle_buttons/toggle_buttons.html',\r\n                controller: \r\n                    ['$scope', '$element', '$attrs', '$mdMedia', '$timeout', function ($scope, $element, $attrs, $mdMedia, $timeout) {\r\n                        $scope.$mdMedia = $mdMedia;\r\n                        $scope.class = $attrs.class || '';\r\n\r\n                        if (!$scope.buttons || (_.isArray($scope.buttons) && $scope.buttons.length === 0)) {\r\n                            $scope.buttons = [];\r\n                            console.error('PipToggleButtons: attribute pipButtons should take array of buttons');\r\n                        }\r\n\r\n                        var index = _.indexOf($scope.buttons, _.find($scope.buttons, {id: $scope.currentButtonValue}));\r\n                        $scope.currentButtonIndex = index < 0 ? 0 : index;\r\n                        $scope.currentButton = $scope.buttons.length > 0 ? $scope.buttons[$scope.currentButtonIndex] : $scope.currentButton;\r\n\r\n                        $scope.buttonSelected = function (index, $event) {\r\n                            if ($scope.disabled()) return;\r\n\r\n                            $scope.currentButtonIndex = index;\r\n                            $scope.currentButton = $scope.buttons[$scope.currentButtonIndex];\r\n                            $scope.currentButtonValue = $scope.currentButton.id || index;\r\n\r\n                            $timeout(function() {\r\n                                $scope.$apply();\r\n\r\n                                if ($scope.change) {\r\n                                    $scope.change();\r\n                                }\r\n                            });\r\n                        };\r\n\r\n                        $scope.enterSpacePress = function (event) {\r\n                            $scope.buttonSelected(event.index);\r\n                        };\r\n\r\n                        $scope.disabled = function () {\r\n                            if ($scope.ngDisabled) {\r\n                                return $scope.ngDisabled();\r\n                            }\r\n                        };\r\n                    }],\r\n                link:\r\n                    function (scope, elem, attr) {\r\n                        elem\r\n                            .on('focusin', function () {\r\n                                elem.addClass('focused-container');\r\n                            })\r\n                            .on('focusout', function () {\r\n                                elem.removeClass('focused-container')\r\n                            })\r\n                }\r\n            };\r\n        }\r\n    );\r\n\r\n})();","/**\r\n * @file Registration of navigation WebUI controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipNav', [        \r\n        'pipDropdown',\r\n        'pipTabs',\r\n\r\n        'pipAppBar',\r\n        'pipSideNav'\r\n    ]);\r\n    \r\n})();\r\n\r\n\r\n","(function(module) {\ntry {\n  module = angular.module('pipNav.Templates');\n} catch (e) {\n  module = angular.module('pipNav.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('appbar/appbar.html',\n    '<!--\\n' +\n    '@file App Bar component\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-toolbar md-theme-watch=\"true\" ng-if=\"!$partialReset\" ng-class=\"config.ngClasses\" class=\"{{ config.cssClass }}\">\\n' +\n    '\\n' +\n    '    <div class=\"md-toolbar-tools rp24-flex lp24-flex\" ng-if=\"!searchEnabled\">\\n' +\n    '        <!-- Navigation Icon -->\\n' +\n    '        <md-button class=\"md-icon-button flex-fixed p0\"\\n' +\n    '                   ng-if=\"config.navIconType != \\'none\\'\"\\n' +\n    '                   ng-class=\"{ \\'pip-third-party\\': getParty() && !getUser(\\'owner\\') }\"\\n' +\n    '                   ng-click=\"onNavIconClick()\"\\n' +\n    '                   aria-label=\"menu\">\\n' +\n    '            <!-- Menu icon -->\\n' +\n    '            <md-icon ng-if=\"config.navIconType==\\'menu\\' && (!getParty() || getUser(\\'owner\\'))\"\\n' +\n    '                md-svg-icon=\"icons:menu\"></md-icon>\\n' +\n    '            <!-- Party avatar -->\\n' +\n    '            <pip-avatar ng-if=\"config.navIconType==\\'menu\\' && (getParty() && !getUser(\\'owner\\'))\"\\n' +\n    '                        pip-rebind-avatar=\"true\"\\n' +\n    '                        pip-rebind=\"true\"\\n' +\n    '                        pip-party-id=\"getParty(\\'id\\')\" class=\"pip-face\"\\n' +\n    '                        pip-party-name=\"getParty(\\'name\\')\">\\n' +\n    '            </pip-avatar>\\n' +\n    '            <!-- Back icon -->\\n' +\n    '            <md-icon ng-if=\"config.navIconType==\\'back\\'\"\\n' +\n    '                md-svg-icon=\"icons:arrow-left\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '        \\n' +\n    '        <!-- Title -->            \\n' +\n    '        <div class=\"flex-var text-overflow\">\\n' +\n    '            <!-- Logo -->\\n' +\n    '            <img class=\"pip-appbar-logo\" \\n' +\n    '                ng-if=\"config.titleType == \\'logo\\'\"\\n' +\n    '                ng-src=\"{{config.titleLogo}}\"/>\\n' +\n    '                \\n' +\n    '            <!-- Title --> \\n' +\n    '            <div ng-if=\"config.titleType == \\'text\\'\" class=\"text-overflow pip-appbar-text\">\\n' +\n    '                <!-- Search criteria -->\\n' +\n    '                <span ng-if=\"config.searchCriteria\"\\n' +\n    '                    ng-click=\"onSearchEnable()\">{{config.searchCriteria}} -</span>\\n' +\n    '                <!-- Text title -->\\n' +\n    '                <span class=\"text-overflow\">{{config.titleText | translate}}</span>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <!-- Title with or without breadcrumb -->\\n' +\n    '            <div ng-if=\"config.titleType==\\'breadcrumb\\'\">\\n' +\n    '                <div class=\"hide-xs text-overflow\">\\n' +\n    '                    <!-- Search criteria -->\\n' +\n    '                    <span ng-if=\"config.searchCriteria\"\\n' +\n    '                      ng-click=\"onSearchEnable()\">{{config.searchCriteria}} -</span>\\n' +\n    '                    <!-- Breadcrumb navigation -->\\n' +\n    '                    <span class=\"pip-appbar-breadcrumb\"\\n' +\n    '                        ng-repeat-start=\"item in config.titleBreadcrumb\"\\n' +\n    '                        ng-click=\"onBreadcrumbClick(item)\"\\n' +\n    '                        ng-init=\"stepWidth = 100/(config.titleBreadcrumb.length + 1)\"\\n' +\n    '                        ng-style=\"{\\'max-width\\': stepWidth + \\'%\\'}\">\\n' +\n    '                        {{item.title | translate}}\\n' +\n    '                    </span>\\n' +\n    '                    <md-icon ng-repeat-end md-svg-icon=\"icons:chevron-right\"></md-icon>\\n' +\n    '                    <!-- Text title -->\\n' +\n    '                    <span class=\"pip-title\">{{config.titleText | translate}}</span>\\n' +\n    '                </div>\\n' +\n    '\\n' +\n    '                <!-- Mobile breadcrumb dropdown -->\\n' +\n    '                <md-menu xmd-offset=\"0 48\" class=\"hide-gt-xs\">\\n' +\n    '                    <span class=\"pip-appbar-mobile-breadcrumb\" layout=\"row\"\\n' +\n    '                        ng-click=\"$mdOpenMenu()\"\\n' +\n    '                        md-ink-ripple\\n' +\n    '                        aria-label=\"open breadcrumb\">\\n' +\n    '                        <span class=\"text-overflow\">\\n' +\n    '                            <!-- Search criteria -->\\n' +\n    '                            <span ng-if=\"config.searchCriteria\"\\n' +\n    '                                ng-click=\"onSearchEnable()\">{{config.searchCriteria}} -</span>\\n' +\n    '                            {{config.titleText | translate}}\\n' +\n    '                        </span>\\n' +\n    '                        <md-icon class=\"m0 flex-none\" md-svg-icon=\"icons:triangle-down\"></md-icon>\\n' +\n    '                    </span>\\n' +\n    '                    <md-menu-content width=\"3\">\\n' +\n    '                        <md-menu-item  ng-repeat=\"item in config.titleBreadcrumb\" >\\n' +\n    '                            <md-button ng-click=\"onBreadcrumbClick(item)\"><span>{{item.title | translate}}</span></md-button>\\n' +\n    '                        </md-menu-item>\\n' +\n    '                        <md-menu-item  >\\n' +\n    '                            <md-button><span class=\"text-grey\">{{config.titleText | translate}}</span></md-button>\\n' +\n    '                        </md-menu-item>\\n' +\n    '                    </md-menu-content>\\n' +\n    '                </md-menu>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '\\n' +\n    '        <div class=\"flex-fixed pip-appbar-actions\" layout=\"row\"\\n' +\n    '             ng-class=\"{ \\'pip-language-action\\': config.actionsType==\\'language\\' }\">\\n' +\n    '            <!-- Laguage picker -->\\n' +\n    '            <md-menu ng-if=\"config.actionsType==\\'language\\'\"\\n' +\n    '                md-position-mode=\"target-right target\">\\n' +\n    '                <span class=\"pip-appbar-language\"\\n' +\n    '                    ng-click=\"$mdOpenMenu()\"\\n' +\n    '                    aria-label=\"language selection\">\\n' +\n    '                    {{language() | translate}}\\n' +\n    '                    <md-icon md-svg-icon=\"icons:triangle-down\"></md-icon>\\n' +\n    '                </span>\\n' +\n    '                <md-menu-content width=\"3\">\\n' +\n    '                    <md-menu-item ng-repeat=\"lang in config.languages\">\\n' +\n    '                        <md-button ng-click=\"onLanguageClick(lang)\">{{lang | translate}}</md-button>\\n' +\n    '                    </md-menu-item>\\n' +\n    '                </md-menu-content>\\n' +\n    '            </md-menu>\\n' +\n    '\\n' +\n    '            <!-- Search toggle -->\\n' +\n    '            <md-button class=\"md-icon-button m0\"\\n' +\n    '                       ng-if=\"config.searchVisible\"\\n' +\n    '                       ng-click=\"onSearchEnable()\"\\n' +\n    '                       aria-label=\"open search\">\\n' +\n    '                <!--<md-tooltip>{{::\\'APPBAR_SEARCH\\' | translate}}</md-tooltip>-->\\n' +\n    '                <md-icon md-svg-icon=\"icons:search\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <!-- Actions -->\\n' +\n    '            <div ng-if=\"config.actionsType==\\'list\\'\">\\n' +\n    '\\n' +\n    '                <!-- Global primary actions -->\\n' +\n    '                <md-menu md-position-mode=\"target-right target\" ng-repeat=\"action in config.primaryGlobalActions\">\\n' +\n    '                    <md-button class=\"pip-appbar-action md-icon-button m0\"\\n' +\n    '                               ng-class=\"{ \\'pip-appbar-hide-sm\\': action.hideSmall }\"\\n' +\n    '                               ng-click=\"onActionClick(action, $mdOpenMenu);\"\\n' +\n    '                               ng-hide=\"actionHidden(action)\"\\n' +\n    '                               aria-label=\"{{action.tooltip | translate}}\">\\n' +\n    '                        <!--<md-tooltip ng-if=\"action.tooltip\">{{action.tooltip | translate}}</md-tooltip>-->\\n' +\n    '                        <div class=\"pip-appbar-badge color-badge-bg\" ng-if=\"action.count > 0\">\\n' +\n    '                            {{actionCount(action)}}\\n' +\n    '                        </div>\\n' +\n    '                        <md-icon md-svg-icon=\"{{action.icon}}\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                    <md-menu-content width=\"3\" ng-show=\"action.menu\">\\n' +\n    '                        <md-menu-item ng-repeat-start=\"subAction in action.subActions\"\\n' +\n    '                                      ng-if=\"!subAction.divider\"\\n' +\n    '                                      ng-hide=\"actionHidden(subAction)\">\\n' +\n    '                            <md-button ng-hide=\"subAction.divider\"\\n' +\n    '                                       ng-click=\"onActionClick(subAction)\">\\n' +\n    '                                {{subAction.title | translate}}\\n' +\n    '                            </md-button>\\n' +\n    '                        </md-menu-item>\\n' +\n    '                        <md-menu-divider ng-if=\"subAction.divider\" ng-repeat-end></md-menu-divider>\\n' +\n    '                    </md-menu-content>\\n' +\n    '                </md-menu>\\n' +\n    '\\n' +\n    '                <!-- Local primary actions -->\\n' +\n    '                <md-menu md-position-mode=\"target-right target\" ng-repeat=\"action in config.primaryLocalActions\">\\n' +\n    '                    <md-button class=\"pip-appbar-action md-icon-button m0\"\\n' +\n    '                               ng-class=\"{ \\'pip-appbar-hide-sm\\': action.hideSmall }\"\\n' +\n    '                               ng-click=\"onActionClick(action, $mdOpenMenu);\"\\n' +\n    '                               ng-hide=\"actionHidden(action)\"\\n' +\n    '                               aria-label=\"{{action.tooltip | translate}}\">\\n' +\n    '                        <!--<md-tooltip ng-if=\"action.tooltip\">{{action.tooltip | translate}}</md-tooltip>-->\\n' +\n    '                        <div class=\"pip-appbar-badge\" ng-show=\"action.count > 0\">\\n' +\n    '                            {{actionCount(action)}}\\n' +\n    '                        </div>\\n' +\n    '                        <md-icon md-svg-icon=\"{{action.icon}}\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                    <md-menu-content width=\"3\" >\\n' +\n    '                        <md-menu-item ng-repeat-start=\"subAction in action.subActions\"\\n' +\n    '                                      ng-if=\"!subAction.divider\"\\n' +\n    '                                      ng-hide=\"actionHidden(subAction)\">\\n' +\n    '                            <md-button ng-hide=\"subAction.divider\"\\n' +\n    '                                       ng-click=\"onActionClick(subAction)\">\\n' +\n    '                                {{subAction.title | translate}}\\n' +\n    '                            </md-button>\\n' +\n    '                        </md-menu-item>\\n' +\n    '                        <md-menu-divider ng-if=\"subAction.divider\" ng-repeat-end></md-menu-divider>\\n' +\n    '                    </md-menu-content>\\n' +\n    '                </md-menu>\\n' +\n    '\\n' +\n    '                <!-- Secondary actions dropdown -->\\n' +\n    '                <md-menu ng-if=\"secondaryActionsVisible()\"\\n' +\n    '                    md-position-mode=\"target-right target\">\\n' +\n    '                    <md-button class=\"md-icon-button m0\"\\n' +\n    '                        ng-click=\"onSecondaryActionClick(); openMenu($mdOpenMenu, $event);\"\\n' +\n    '                        aria-label=\"open actions\">\\n' +\n    '                        <md-icon md-svg-icon=\"icons:vdots\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                    <md-menu-content width=\"3\">\\n' +\n    '                        <!-- Local secondary actions -->\\n' +\n    '                        <md-menu-item ng-repeat-start=\"action in config.secondaryLocalActions\"\\n' +\n    '                            ng-if=\"!action.divider\"\\n' +\n    '                            ng-hide=\"actionHidden(action)\">\\n' +\n    '                            <md-button ng-hide=\"action.divider\"\\n' +\n    '                                ng-click=\"onActionClick(action)\">\\n' +\n    '                                {{action.title | translate}}\\n' +\n    '                            </md-button>\\n' +\n    '                        </md-menu-item>\\n' +\n    '                        <md-menu-divider ng-if=\"action.divider\" ng-repeat-end></md-menu-divider>\\n' +\n    '\\n' +\n    '                        <md-menu-divider ng-if=\"secondaryDividerVisible()\" >\\n' +\n    '\\n' +\n    '                        </md-menu-divider>\\n' +\n    '                        <!-- Global secondary actions -->\\n' +\n    '                        <md-menu-item ng-repeat-start=\"action in config.secondaryGlobalActions\"\\n' +\n    '                            ng-if=\"!action.divider\"\\n' +\n    '                            ng-hide=\"actionHidden(action)\">\\n' +\n    '                            <md-button ng-hide=\"action.divider\"\\n' +\n    '                                ng-click=\"onActionClick(action)\">\\n' +\n    '                                {{action.title | translate}}\\n' +\n    '                            </md-button>                    \\n' +\n    '                        </md-menu-item>\\n' +\n    '                        <md-menu-divider ng-if=\"action.divider\" ng-repeat-end>\\n' +\n    '                        </md-menu-divider>                        \\n' +\n    '                    </md-menu-content>\\n' +\n    '                </md-menu>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <div class=\"md-toolbar-tools\" layout=\"row\" ng-if=\"searchEnabled\">\\n' +\n    '        <md-button class=\"md-icon-button\" \\n' +\n    '            aria-label=\"start search\" \\n' +\n    '            ng-click=\"onSearchClick()\">\\n' +\n    '            <md-icon md-svg-icon=\"icons:search\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '        <input class=\"pip-search-text\" \\n' +\n    '            type=\"search\" flex \\n' +\n    '            ng-model=\"search.text\" \\n' +\n    '            ng-keydown=\"onSearchKeyDown($event)\" />\\n' +\n    '        <md-button class=\"md-icon-button\" \\n' +\n    '            aria-label=\"clear search\" \\n' +\n    '            ng-click=\"onSearchClear()\">\\n' +\n    '            <md-icon md-svg-icon=\"icons:cross-circle\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '</md-toolbar>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipNav.Templates');\n} catch (e) {\n  module = angular.module('pipNav.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('dropdown/dropdown.html',\n    '<md-content class=\"md-subhead md-hue-1 {{class}}\" ng-if=\"show()\" ng-class=\"{\\'md-whiteframe-3dp\\': $mdMedia(\\'xs\\')}\">\\n' +\n    '    <div class=\"pip-divider position-top m0\"></div>\\n' +\n    '        <md-select ng-model=\"selectedIndex\" ng-disabled=\"disabled()\" md-container-class=\"pip-full-width-dropdown\" aria-label=\"DROPDOWN\" md-ink-ripple md-on-close=\"onSelect(selectedIndex)\">\\n' +\n    '            <md-option ng-repeat=\"action in actions\" value=\"{{ ::$index }}\" ng-selected=\"activeIndex == $index ? true : false\">\\n' +\n    '                {{ (action.title || action.name) | translate }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '</md-content>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipNav.Templates');\n} catch (e) {\n  module = angular.module('pipNav.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('sidenav/sidenav.html',\n    '<!--\\n' +\n    '@file Side Nav component\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-sidenav class=\"md-sidenav-left md-whiteframe-z2 pip-sidenav\" \\n' +\n    '    md-component-id=\"pip-sidenav\" \\n' +\n    '    ng-if=\"!$partialReset\" \\n' +\n    '    pip-focused>\\n' +\n    '\\n' +\n    '    <md-toolbar class=\"pip-sidenav-header\"\\n' +\n    '                ng-class=\"{\\'pip-sidenav-owner\\': $user.owner}\"\\n' +\n    '                md-theme=\"{{ $theme|| $user.theme || config.theme }}\"\\n' +\n    '                ng-hide=\"!$party\">\\n' +\n    '\\n' +\n    '            <md-button class=\"pip-sidenav-party md-icon-button\"\\n' +\n    '                       ng-click=\"onPartyClick()\"\\n' +\n    '                       aria-label=\"current party\">\\n' +\n    '                <pip-avatar ng-if=\"!$avatarReset\"\\n' +\n    '                            pip-party-id=\"$party.id\"\\n' +\n    '                            pip-default-icon=\"icon-person\"\\n' +\n    '                            pip-party-name=\"$party.name\"\\n' +\n    '                            pip-rebind-avatar=\"true\"\\n' +\n    '                            pip-rebind=\"true\">\\n' +\n    '                </pip-avatar>\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-button class=\"pip-sidenav-user md-icon-button\"\\n' +\n    '                       ng-click=\"onUserClick()\"\\n' +\n    '                       ng-hide=\"$user.owner\"\\n' +\n    '                       aria-label=\"current user\">\\n' +\n    '                <pip-avatar class=\"pic-pic pip-face-ld\"\\n' +\n    '                            ng-if=\"!$avatarReset\"\\n' +\n    '                            pip-default-icon=\"icon-person\"\\n' +\n    '                            pip-rebind=\"true\"\\n' +\n    '                            pip-rebind-avatar=\"true\"\\n' +\n    '                            pip-party-id=\"$user.id\"\\n' +\n    '                            pip-party-name=\"$user.name\">\\n' +\n    '                </pip-avatar>\\n' +\n    '            </md-button>\\n' +\n    '        \\n' +\n    '        <div class=\"pip-sidenav-party-text\">\\n' +\n    '            <a class=\"pip-sidenav-party-pri cursor-pointer\"\\n' +\n    '                ng-click=\"onPartyClick()\">{{$party.name}}</a>\\n' +\n    '            <div class=\"pip-sidenav-party-sec\"\\n' +\n    '                ng-show=\"$connection && !$user.owner\">\\n' +\n    '                {{$connection.relation | translate}}\\n' +\n    '                <span ng-show=\"$connection.relation_since\">\\n' +\n    '                    {{::\\'SIDENAV_SINCE\\' | translate}}\\n' +\n    '                    {{$connection.relation_since | formatLongDate}}\\n' +\n    '                </span>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </md-toolbar>\\n' +\n    '\\n' +\n    '    <md-list>\\n' +\n    '        <div class=\"pip-section\" ng-repeat=\"section in config.sections\"\\n' +\n    '            ng-hide=\"section.access && !section.access($party, $user, section)\">\\n' +\n    '            \\n' +\n    '            <md-divider ng-show=\"$index > 0 && !isSectionEmpty(section.links)\"></md-divider>\\n' +\n    '            <md-subheader ng-show=\"section.title\">{{::section.title | translate}}</md-subheader>\\n' +\n    '            \\n' +\n    '            <md-list-item class=\"pip-focusable no-border\" \\n' +\n    '                ng-repeat=\"link in section.links\"\\n' +\n    '                ng-click=\"onLinkClick($event, link)\"\\n' +\n    '                ng-hide=\"link.access && !link.access($party, $user, link)\">\\n' +\n    '                <md-icon md-svg-icon=\"{{link.icon}}\" \\n' +\n    '                    ng-hide=\"!link.icon\" \\n' +\n    '                    class=\"tm0 bm0\"></md-icon>\\n' +\n    '                <p>{{::link.title | translate}}</p>\\n' +\n    '            </md-list-item>\\n' +\n    '        </div>\\n' +\n    '    </md-list>\\n' +\n    '\\n' +\n    '</md-sidenav>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipNav.Templates');\n} catch (e) {\n  module = angular.module('pipNav.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('tabs/tabs.html',\n    '<md-toolbar class=\"pip-nav {{ class }}\" ng-class=\"{\\'pip-visible\\': show(), \\'pip-shadow\\': showShadow()}\">\\n' +\n    '    <md-tabs class=\"hide-xs\" md-selected=\"activeTab\" ng-class=\"{\\'disabled\\': disabled()}\" md-stretch-tabs=\"true\" md-dynamic-height=\"true\">\\n' +\n    '        <md-tab ng-repeat=\"tab in tabs\"  ng-disabled=\"tabDisabled($index)\" md-on-select=\"onSelect($index)\">\\n' +\n    '            <md-tab-label>\\n' +\n    '                {{ (tab.title || tab.name) | translate }}\\n' +\n    '                <div class=\"pip-tabs-badge color-badge-bg\" ng-if=\"tab.newCounts > 0 && tab.newCounts <= 99\">{{ tab.newCounts }}</div>\\n' +\n    '                <div class=\"pip-tabs-badge color-badge-bg\" ng-if=\"tab.newCounts > 99\">!</div>\\n' +\n    '            </md-tab-label>\\n' +\n    '        </md-tab>\\n' +\n    '    </md-tabs>\\n' +\n    '    <md-content class=\"md-subhead md-hue-1 show-xs hide-sm hide-gt-sm\">\\n' +\n    '        <div class=\"pip-divider position-top m0\"></div>\\n' +\n    '        <md-select ng-model=\"activeIndex\" ng-disabled=\"disabled()\"\\n' +\n    '                   md-container-class=\"pip-full-width-dropdown\" aria-label=\"SELECT\" md-ink-ripple md-on-close=\"onSelect(activeIndex)\">\\n' +\n    '            <md-option ng-repeat=\"tab in tabs\" value=\"{{ ::$index }}\" >\\n' +\n    '                {{ (tab.title || tab.name) | translate }}\\n' +\n    '                <div class=\"pip-tabs-badge color-badge-bg\" ng-if=\"tab.newCounts > 0 && tab.newCounts <= 99\">{{ tab.newCounts }}</div>\\n' +\n    '                <div class=\"pip-tabs-badge color-badge-bg\" ng-if=\"tab.newCounts > 99\">!</div>\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-content>\\n' +\n    '</md-toolbar>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Application App Bar component\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipAppBar', \r\n        ['ngMaterial', 'pipTranslate', 'pipNav.Templates', 'pipAppBar.Service']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n\r\n        pipTranslateProvider.translations('en', {\r\n            'APPBAR_SEARCH': 'Search'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'APPBAR_SEARCH': 'Поиск'\r\n        });\r\n\r\n    }]);\r\n\r\n    // Main application header directive\r\n    thisModule.directive('pipAppbar', function() {\r\n       return {\r\n           restrict: 'E',\r\n           scope: {\r\n               title: '=pipTitle',\r\n               showMenu: '=pipShowMenu',\r\n               localActions: '=pipLocalActions',\r\n               globalActions: '=pipGlobalActions'\r\n           },\r\n           replace: false,\r\n           templateUrl: function(element, attr) {\r\n               return 'appbar/appbar.html';\r\n           },\r\n           controller: 'pipAppBarController'\r\n       };\r\n    });\r\n\r\n    thisModule.controller('pipAppBarController',\r\n        ['$scope', '$element', '$attrs', '$rootScope', '$window', '$state', '$location', 'pipTranslate', 'pipAppBar', 'localStorageService', function ($scope, $element, $attrs, $rootScope, $window, $state, $location, pipTranslate, pipAppBar, localStorageService) {\r\n            // Initialize default application title\r\n            if ($scope.title)\r\n                pipAppBar.showTitleText($scope.title);                \r\n            if ($scope.showMenu)\r\n                pipAppBar.showMenuNavIcon();\r\n\r\n\r\n            // Apply class and call resize\r\n            $element.addClass('pip-appbar');\r\n            $scope.$emit('pipResizeWindow');\r\n\r\n            $scope.config = pipAppBar.config();\r\n\r\n            if ($scope.localActions) {\r\n                pipAppBar.showLocalActions();\r\n                $scope.config.primaryLocalActions = $scope.localActions[0];\r\n                $scope.config.secondaryLocalActions = $scope.localActions[1];\r\n            }\r\n\r\n            if ($scope.globalActions) {\r\n                pipAppBar.showLocalActions();\r\n                $scope.config.primaryGlobalActions = $scope.globalActions[0];\r\n                $scope.config.secondaryGlobalActions = $scope.globalActions[0];\r\n            }\r\n\r\n            $scope.searchEnabled = false;\r\n            $scope.search = { text: '' };\r\n\r\n            $rootScope.$on('pipAppBarChanged', onAppBarChanged);\r\n\r\n            $scope.language = getLanguage;\r\n            $scope.actionHidden = actionHidden;\r\n            $scope.actionCount = actionCount;\r\n            $scope.secondaryActionsVisible = secondaryActionsVisible;\r\n            $scope.secondaryDividerVisible = secondaryDividerVisible;\r\n\r\n            $scope.onNavIconClick = onNavIconClick;\r\n            $scope.onBreadcrumbClick = onBreadcrumbClick;\r\n            $scope.onLanguageClick = onLanguageClick;\r\n            $scope.onActionClick = onActionClick;\r\n\r\n            $scope.onSearchEnable = onSearchEnable;\r\n            $scope.onSearchClick = onSearchClick;\r\n            $scope.onSearchClear = onSearchClear;\r\n            $scope.onSearchKeyDown = onSearchKeyDown;\r\n\r\n            $scope.getParty = getParty;\r\n            $scope.getUser = getUser;\r\n\r\n            $scope.openMenu = openMenu;\r\n\r\n            return;\r\n            //---------------------------\r\n\r\n             function openMenu ($mdOpenMenu, ev) {\r\n                $scope.originatorEv = ev;\r\n                $mdOpenMenu(ev);\r\n            };\r\n\r\n            function getParty(prop) {\r\n                if (!$rootScope.$party) return;\r\n                else {\r\n                    if (prop) return $rootScope.$party[prop];\r\n                    else return $rootScope.$party;\r\n                }\r\n            }\r\n\r\n            function getUser(prop) {\r\n                if (!$rootScope.$user) return;\r\n                else {\r\n                    if (prop) return $rootScope.$user[prop];\r\n                    else return $rootScope.$user;\r\n                }\r\n            }\r\n\r\n            function onAppBarChanged(event, config) {\r\n                $scope.config = config;\r\n                $scope.searchEnabled = false;\r\n                $scope.search.text = '';\r\n            }\r\n\r\n            function getLanguage() {\r\n                return pipTranslate.use();\r\n            }\r\n\r\n            function actionHidden(action) {\r\n                return action.access\r\n                    && !action.access($rootScope.$party, $rootScope.$user, action);\r\n            }\r\n\r\n            function actionCount(action) {\r\n                if (action.count == null || action.count <= 0)\r\n                    return '';\r\n                if (action.count > 99)\r\n                    return '!';\r\n                return action.count;\r\n            }\r\n\r\n            function calcActions(actions) {\r\n                var count = 0;\r\n                _.each(actions, function(action) {\r\n                    if (!actionHidden(action)) count++;\r\n                });\r\n                return count;\r\n            }\r\n\r\n            function secondaryActionsVisible() {\r\n                return calcActions($scope.config.secondaryGlobalActions) > 0\r\n                    || calcActions($scope.config.secondaryLocalActions) > 0;\r\n            }\r\n\r\n            function secondaryDividerVisible() {\r\n                return calcActions($scope.config.secondaryGlobalActions) > 0\r\n                    && calcActions($scope.config.secondaryLocalActions) > 0;\r\n            }\r\n\r\n            function onNavIconClick() {\r\n                if (_.isFunction($scope.config.navIconCallback)) {\r\n                    // Execute nav icon callback\r\n                    $scope.config.navIconCallback();\r\n                } else {\r\n                    if ($scope.config.navIconType != 'back') {\r\n                        // Raise an event\r\n                        $rootScope.$broadcast('pipAppBarNavIconClicked');\r\n                    }\r\n                    else if ($scope.config.titleType == 'breadcrumb') {\r\n                        var breadcrumb = $scope.config.titleBreadcrumb;\r\n                        // Go to the last breadcrumb item\r\n                        if (_.isArray(breadcrumb) && breadcrumb.length > 0) {\r\n                            var backCallback = breadcrumb[breadcrumb.length - 1].click;\r\n                            if (_.isFunction(backCallback)) backCallback();\r\n                            else $window.history.back();\r\n                        } else {\r\n                            $window.history.back();\r\n                        }\r\n                    } else {\r\n                        // Go back in history\r\n                        $window.history.back();\r\n                    }\r\n                }\r\n            }\r\n\r\n            function onBreadcrumbClick(item) {\r\n                if (_.isFunction(item.click))\r\n                    item.click(item);\r\n            }\r\n\r\n            function onLanguageClick(language) {\r\n                setTimeout(function () {\r\n                    pipTranslate.use(language);\r\n                    $rootScope.$apply();\r\n                }, 0);\r\n            }\r\n\r\n            function processStateParams(params) {\r\n                if (params == null) return null;\r\n\r\n                var result = {};\r\n                var prop;\r\n                for (prop in params) {\r\n                    if (params.hasOwnProperty(prop)) {\r\n                        if (params[prop] == ':party_id') {\r\n                            result[prop] = $rootScope.$party ? $rootScope.$party.id : null;\r\n                        } else if (params[prop] == ':user_id') {\r\n                            result[prop] = $rootScope.$user ? $rootScope.$user.id : null;\r\n                        } else {\r\n                            result[prop] = params[prop];\r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            }\r\n\r\n            function processUrlParams(url) {\r\n                if (url == null) return null;\r\n\r\n                var result = url.replace(':party_id', $rootScope.$party ? $rootScope.$party.id : '');\r\n                result = result.replace(':user_id', $rootScope.user ? $rootScope.$user.id : '');\r\n                return result;\r\n            }\r\n\r\n            function focusSearchText() {\r\n                setTimeout(function() {\r\n                    var element = $('.pip-search-text');\r\n                    if (element.length > 0)\r\n                        element.focus();\r\n                }, 0);\r\n            }\r\n\r\n            function onActionClick(action, $mdOpenMenu) {\r\n                if (action == null || action.divider) {\r\n                    return;\r\n                }\r\n\r\n                console.log('aaa',action, $scope.originatorEv);\r\n                if(action.close){\r\n                    $scope.originatorEv = null\r\n                }\r\n\r\n                console.log('bb', $scope.originatorEv);\r\n                if (action.menu)\r\n                    $mdOpenMenu($scope.originatorEv);\r\n                else if (action.callback)\r\n                    action.callback();\r\n                else if (action.href)\r\n                    $window.location.href = processUrlParams(action.href);\r\n                else if (action.url)\r\n                    $location.url(processUrlParams(action.url));\r\n                else if (action.state)\r\n                    $state.go(action.state, processStateParams(action.stateParams));\r\n                else if (action.event)\r\n                    $rootScope.$broadcast(action.event);\r\n                else\r\n                    // Otherwise raise notification\r\n                    $rootScope.$broadcast('pipAppBarActionClicked', action.name);\r\n\r\n\r\n            }\r\n\r\n            function onSearchEnable() {\r\n                $scope.search.text = $scope.config.searchCriteria;\r\n                $scope.searchEnabled = true;\r\n                focusSearchText();\r\n            }\r\n\r\n            function onSearchClick() {\r\n                var searchText = $scope.search.text;\r\n                \r\n                $scope.search.text = '';\r\n                $scope.searchEnabled = false;\r\n\r\n                if ($scope.config.searchCallback)\r\n                    $scope.config.searchCallback(searchText);\r\n                else\r\n                    $rootScope.$broadcast('pipAppBarSearchClicked', searchText);\r\n            }\r\n\r\n            function onSearchClear() {\r\n                if ($scope.search.text) {\r\n                    $scope.search.text = '';\r\n\r\n                    focusSearchText();\r\n                } else {\r\n                    $scope.searchEnabled = false;\r\n                    onSearchClick();\r\n                }\r\n            }\r\n\r\n            function onSearchKeyDown(event) {\r\n                // Enter pressed\r\n                if (event.keyCode == 13)\r\n                    $scope.onSearchClick();\r\n                // ESC pressed\r\n                else if (event.keyCode == 27) \r\n                    $scope.searchEnabled = false;\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Application App Bar service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipAppBar.Service', []);\r\n\r\n    thisModule.provider('pipAppBar', function () {\r\n        var config = {\r\n            appTitleText: null,\r\n            appTitleLogo: 'images/piplife_logo.svg',\r\n            \r\n            // Theme to be applied to the header\r\n            theme: 'blue',\r\n            cssClass: '',\r\n            ngClasses: {},\r\n\r\n            // Type of nav icon: 'back', 'menu' or 'none'\r\n            navIconType: 'none',\r\n            // Handle nav icon click event\r\n            navIconCallback: false,\r\n\r\n            // Type of title: 'logo', 'text', 'breadcrumb' or 'none'\r\n            titleType: 'none',\r\n            // URL to logo\r\n            titleLogo: null,\r\n            // Title text\r\n            titleText: null,\r\n            // Navigation breadcrumb [{ title, click }],\r\n            titleBreadcrumb: null,\r\n\r\n            // Type of actions: 'language', 'list' or 'none'\r\n            actionsType: 'none',\r\n            \r\n            // Language options\r\n            languages: ['en', 'ru'],\r\n\r\n            // Search visible\r\n            searchVisible: false,\r\n            // Search criteria\r\n            searchCriteria: '',\r\n            // History for search autocomplete\r\n            searchHistory: [],\r\n            // Callback for search\r\n            searchCallback: null,\r\n            \r\n            // Primary global actions visible on the screen\r\n            primaryGlobalActions: [],\r\n            // Primary local actions visible on the screen\r\n            primaryLocalActions: [],\r\n\r\n            // Secondary global actions available in popup\r\n            secondaryGlobalActions: [],\r\n            // Secondary local actions available in popup\r\n            secondaryLocalActions: []\r\n        };\r\n\r\n        // Configure global parameters\r\n        this.appTitleText = appTitleText;\r\n        this.appTitleLogo = appTitleLogo;\r\n        this.theme = theme;\r\n        this.globalActions = globalActions;\r\n        this.globalPrimaryActions = globalPrimaryActions;\r\n        this.globalSecondaryActions = globalSecondaryActions;\r\n\r\n        // Get the service instance\r\n        this.$get = ['$rootScope', function ($rootScope) {            \r\n            return {\r\n                config: getConfig,                \r\n                cssClass: cssClass,\r\n\r\n                hideNavIcon: hideNavIcon,\r\n                showMenuNavIcon: showMenuNavIcon,\r\n                showBackNavIcon: showBackNavIcon,\r\n\r\n                showAppTitleLogo: showAppTitleLogo,\r\n                showAppTitleText: showAppTitleText,\r\n                showTitleLogo: showTitleLogo,\r\n                showTitleText: showTitleText,\r\n                showTitleBreadcrumb: showTitleBreadcrumb,\r\n                hideTitle: hideTitle,\r\n\r\n                showLanguage: showLanguage,\r\n                showLocalActions: showLocalActions,\r\n                hideLocalActions: hideLocalActions,\r\n                updateActionCount: updateActionCount,\r\n\r\n                showSearch: showSearch,\r\n                hideSearch: hideSearch,\r\n                updateSearchCriteria: updateSearchCriteria,\r\n                updateSearchHistory: updateSearchHistory,\r\n\r\n                showShadow: showShadow,\r\n                showShadowSm: showShadowSm,\r\n                hideShadow: hideShadow\r\n            };\r\n            // ----------------------\r\n\r\n            function getConfig() {\r\n                return config;  \r\n            };\r\n\r\n            function cssClass(newCssClass) {\r\n                if (newCssClass != undefined) {\r\n                    config.cssClass = newCssClass;\r\n                    sendConfigEvent();\r\n                }\r\n                return config.cssClass;\r\n            };\r\n\r\n            // Show, hide appbar shadow\r\n            //-------------------------\r\n\r\n            function showShadowSm() {\r\n                config.ngClasses['pip-shadow'] = false;\r\n                config.ngClasses['pip-shadow-sm'] = true;\r\n                sendConfigEvent();\r\n            }\r\n\r\n            function showShadow() {\r\n                config.ngClasses['pip-shadow'] = true;\r\n                sendConfigEvent();\r\n            }\r\n\r\n            function hideShadow() {\r\n                config.ngClasses['pip-shadow'] = false;\r\n                config.ngClasses['pip-shadow-sm'] = false;\r\n                sendConfigEvent();\r\n            }\r\n\r\n            // Show navigation icon\r\n            //----------------------\r\n    \r\n            function hideNavIcon() {\r\n                config.navIconType = 'none';\r\n                config.navIconCallback = null;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showMenuNavIcon(click) {\r\n                config.navIconType = 'menu';\r\n                config.navIconCallback = click;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showBackNavIcon(click) {\r\n                config.navIconType = 'back';\r\n                config.navIconCallback = click;\r\n\r\n                sendConfigEvent();\r\n            }\r\n\r\n            // Show title\r\n            //---------------\r\n    \r\n            function hideTitle() {\r\n                config.titleType = 'none';\r\n                config.titleLogo = null;\r\n                config.titleText = null;\r\n                config.titleBreadcrumb = null;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showTitleLogo(titleLogo) {\r\n                config.titleType = 'logo';\r\n                config.titleLogo = titleLogo;\r\n                config.titleText = null;\r\n                config.titleBreadcrumb = null;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showTitleText(titleText) {\r\n                config.titleType = 'text';\r\n                config.titleLogo = null;\r\n                config.titleText = titleText;\r\n                config.titleBreadcrumb = null;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showTitleBreadcrumb(titleText, titleBreadcrumb) {\r\n                if (_.isArray(titleText)) {\r\n                    titleBreadcrumb = titleText;\r\n                    titleText = titleBreadcrumb[titleBreadcrumb.length - 1].title;\r\n                    titleBreadcrumb.splice(titleBreadcrumb.length - 1, 1);\r\n                }\r\n                            \r\n                config.titleType = 'breadcrumb';\r\n                config.titleLogo = null;\r\n                config.titleText = titleText;\r\n                config.titleBreadcrumb = titleBreadcrumb;\r\n    \r\n                if (titleBreadcrumb.length > 0) {\r\n                    config.navIconType = config.navIconType == 'none' ? 'back' : config.navIconType;\r\n                    config.navIconCallback = titleBreadcrumb[titleBreadcrumb.length - 1];\r\n                } else {\r\n                    config.navIconType = 'menu';\r\n                    config.navIconCallback = null;\r\n                }\r\n\r\n                sendConfigEvent();\r\n            }\r\n\r\n            function showAppTitleLogo() {\r\n                showTitleLogo(config.appTitleLogo);\r\n            }\r\n    \r\n            function showAppTitleText() {\r\n                showTitleText(config.appTitleText);  \r\n            }\r\n        \r\n            // Show actions\r\n            //---------------\r\n    \r\n            function hideLocalActions() {\r\n                config.actionsType = 'none';\r\n                config.primaryLocalActions = [];\r\n                config.secondaryLocalActions = [];\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showLanguage(languages) {\r\n                config.actionsType = 'language';\r\n                config.languages = languages || config.languages;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function showLocalActions(primaryActions, secondaryActions) {            \r\n                config.actionsType = 'list';\r\n                config.primaryLocalActions = primaryActions || [];  \r\n                config.secondaryLocalActions = secondaryActions || [];  \r\n\r\n                sendConfigEvent();\r\n            }\r\n            \r\n            function updateActionCount(actionName, count) {\r\n                // Update global actions\r\n                _.each(config.primaryGlobalActions, function(action) {\r\n                    if (action.name == actionName) {\r\n                        action.count = count;\r\n                    }\r\n                });\r\n                // Update local action\r\n                _.each(config.primaryLocalActions, function(action) {\r\n                    if (action.name == actionName) {\r\n                        action.count = count; \r\n                    }\r\n                });\r\n                \r\n                sendConfigEvent();\r\n            }\r\n    \r\n            // Show actions\r\n            //---------------\r\n    \r\n            function showSearch(callback, criteria, history) {\r\n                config.searchVisible = true;\r\n                config.searchCallback = callback;\r\n                config.searchCriteria = criteria;\r\n                config.searchHistory = history;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function hideSearch() {\r\n                config.searchVisible = false;\r\n                config.searchCallback = null;\r\n                config.searchCriteria = null;\r\n\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function updateSearchCriteria(criteria) {\r\n                config.searchCriteria = criteria;\r\n                sendConfigEvent();\r\n            }\r\n    \r\n            function updateSearchHistory(history) {\r\n                config.searchHistory = history;\r\n                sendConfigEvent();\r\n            }\r\n\r\n            function sendConfigEvent() {\r\n                $rootScope.$broadcast('pipAppBarChanged', config);\r\n            }\r\n        }];\r\n        \r\n        return;        \r\n        //-----------------\r\n        \r\n        function appTitleText(newTitleText) {\r\n            if (newTitleText != null)\r\n                config.appTitleText = newTitleText;\r\n            return config.appTitleText;\r\n        }\r\n\r\n        function appTitleLogo(newTitleLogo) {\r\n            if (newTitleLogo != null)\r\n                config.appTitleLogo = newTitleLogo;\r\n            return config.appTitleLogo;\r\n        }\r\n        \r\n        function theme(theme) {\r\n            config.theme = theme || config.theme;\r\n            return config.theme;            \r\n        }\r\n\r\n        function globalActions(primaryActions, secondaryActions) {\r\n            config.primaryGlobalActions = primaryActions || [];  \r\n            config.secondaryGlobalActions = secondaryActions || [];  \r\n        }\r\n\r\n        function globalPrimaryActions(primaryActions) {\r\n            config.primaryGlobalActions = primaryActions || [];\r\n        }\r\n\r\n        function globalSecondaryActions(secondaryActions) {\r\n            config.secondaryGlobalActions = secondaryActions || [];\r\n        }\r\n        \r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Dropdown control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n *\r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDropdown\", ['pipAssert', 'pipNav.Templates']);\r\n\r\n    thisModule.directive('pipDropdown',\r\n        ['$mdMedia', 'pipAssert', function ($mdMedia, pipAssert) {\r\n            return {\r\n                restrict: 'E',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    actions: '=pipActions',\r\n                    showDropdown: '&pipShow',\r\n                    activeIndex: '=pipActiveIndex',\r\n                    select: '=pipDropdownSelect'\r\n                },\r\n                templateUrl: 'dropdown/dropdown.html',\r\n                controller:\r\n                    ['$scope', '$element', '$attrs', 'localStorageService', function ($scope, $element, $attrs, localStorageService) {\r\n                        $scope.class = ($attrs.class || '') + ' md-' + localStorageService.get('theme') + '-theme';\r\n                        pipAssert.isArray($scope.actions, 'pipDropdown: pip-actions attribute should take an array, but take ' + typeof $scope.actions);\r\n                        $scope.$mdMedia = $mdMedia;\r\n                        $scope.actions = ($scope.actions && _.isArray($scope.actions)) ? $scope.actions : [];\r\n                        $scope.activeIndex = $scope.activeIndex || 0;\r\n\r\n                        $scope.disabled = function () {\r\n                            if ($scope.ngDisabled()) {\r\n                                return $scope.ngDisabled();\r\n                            } else {\r\n                                return false;\r\n                            }\r\n                        };\r\n\r\n                        $scope.onSelect = function (index) {\r\n                            $scope.activeIndex = index;\r\n                            if ($scope.select) {\r\n                                $scope.select($scope.actions[index], $scope.activeIndex);\r\n                            }\r\n                        };\r\n\r\n                        $scope.show = function () {\r\n                            if ($scope.showDropdown()) {\r\n                                return $scope.showDropdown();\r\n                            } else {\r\n                                return true;\r\n                            }\r\n                        };\r\n\r\n                    }]\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Application Side Nav component\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSideNav', \r\n        ['ngMaterial', 'pipTranslate', 'pipFocused', 'pipNav.Templates', 'pipSideNav.Service']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n\r\n        pipTranslateProvider.translations('en', {\r\n            'SIDENAV_SINCE': 'since'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'SIDENAV_SINCE': 'с'\r\n        });\r\n\r\n    }]);\r\n\r\n    // Main application sidenav directive\r\n    thisModule.directive('pipSidenav', function() {\r\n       return {\r\n           restrict: 'EA',\r\n           scope: false,\r\n           replace: false,\r\n           templateUrl: 'sidenav/sidenav.html',\r\n           controller: 'pipSideNavController'\r\n       };\r\n    });\r\n\r\n    thisModule.controller('pipSideNavController', \r\n        ['$scope', '$element', '$state', '$rootScope', '$window', '$location', '$timeout', 'pipState', 'pipTranslate', 'pipSideNav', function ($scope, $element, $state, $rootScope, $window, $location, $timeout, pipState, pipTranslate, pipSideNav) {\r\n\r\n            // Apply class and call resize\r\n            $element.addClass('pip-sidenav');\r\n\r\n            $scope.config = pipSideNav.config();\r\n            $scope.$avatarReset = false;\r\n\r\n            $rootScope.$on('pipAppBarNavIconClicked', onAppBarNavIconClick);\r\n            $rootScope.$on('pipSideNavChanged', onConfigChanged);\r\n\r\n            $scope.itemVisible = itemVisible;\r\n            $scope.onUserClick = onUserClick;\r\n            $scope.onPartyClick = onPartyClick;\r\n            $scope.onLinkClick = onLinkClick;\r\n            $scope.isSectionEmpty = isSectionEmpty;\r\n\r\n            return;\r\n            \r\n            //------------------------\r\n\r\n            function itemVisible(item) {\r\n                return item && item.access && !item.access($rootScope.$party, $rootScope.$user, item);\r\n            }\r\n\r\n            function isSectionEmpty(linkCollection) {\r\n                var result = true;\r\n                _.each(linkCollection, function(link){\r\n                    if (!itemVisible(link))\r\n                        result = false;\r\n                });\r\n                return result;\r\n            }\r\n\r\n            function onAppBarNavIconClick(event) {\r\n                pipSideNav.open();\r\n            }\r\n\r\n            function onConfigChanged(event, config) {\r\n                $scope.config = config; \r\n            }\r\n\r\n            function onUserClick() {\r\n                $rootScope.$broadcast('pipSideNavUserClicked');\r\n                pipSideNav.close();\r\n            }\r\n\r\n            function onPartyClick() {\r\n                $rootScope.$broadcast('pipSideNavPartyClicked');\r\n                pipSideNav.close();\r\n            }\r\n\r\n            function processStateParams(params) {\r\n                if (params == null) return null;\r\n\r\n                var result = {};\r\n                for (var prop in params) {\r\n                    if (params.hasOwnProperty(prop)) {\r\n                        if (params[prop] == ':party_id') {\r\n                            result[prop] = $rootScope.$party ? $rootScope.$party.id : null;\r\n                        } else if (params[prop] == ':user_id') {\r\n                            result[prop] = $rootScope.$user ? $rootScope.$user.id : null;\r\n                        } else {\r\n                            result[prop] = params[prop];   \r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            }\r\n\r\n            function processUrlParams(url) {\r\n                if (url == null) return null;\r\n\r\n                var result = url.replace(':party_id', $rootScope.$party ? $rootScope.$party.id : '');\r\n                result = result.replace(':user_id', $rootScope.$user ? $rootScope.$user.id : '');\r\n\r\n                return result;\r\n            }\r\n\r\n            function onLinkClick(event, link) {\r\n                event.stopPropagation();\r\n\r\n                if (!link) {\r\n                    pipSideNav.close();\r\n                    return;\r\n                }\r\n\r\n                if (link.href) {\r\n                    if (link.href.split('?')[0] === $window.location.href.split('?')[0]) {\r\n                        pipSideNav.close();\r\n                        return;\r\n                    }\r\n\r\n                    $window.location.href = processUrlParams(link.href);\r\n                }\r\n                else if (link.url) {\r\n                    if (link.url.split(/[\\s/?]+/)[1] === $location.url().split(/[\\s/?]+/)[1]) {\r\n                        pipSideNav.close();\r\n                        return;\r\n                    }\r\n\r\n                    $location.url(processUrlParams(link.url));\r\n                }\r\n                else if (link.state) {\r\n                    if ($state.current.name === link.state) {\r\n                        pipSideNav.close();\r\n                        return;\r\n                    }\r\n\r\n                    pipState.go(link.state, processStateParams(link.stateParams));\r\n                }\r\n                else if (link.event)\r\n                    $rootScope.$broadcast('pipSideNavLinkClicked', link.event);\r\n\r\n                pipSideNav.close();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Application Side Nav service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSideNav.Service', ['pipAssert', 'pipDebug']);\r\n\r\n    thisModule.provider('pipSideNav', ['pipAssertProvider', 'pipDebugProvider', function (pipAssertProvider, pipDebugProvider) {\r\n        var config = {\r\n            // Theme to be applied to the header\r\n            theme: 'blue',\r\n            // Sections with navigation links\r\n            sections: []\r\n        };\r\n\r\n        this.theme = theme;\r\n        this.sections = sections;\r\n\r\n        this.$get = ['$rootScope', '$mdSidenav', function ($rootScope, $mdSidenav) {\r\n            $rootScope.$on('pipSideNavOpen', open);\r\n            $rootScope.$on('pipSideNavClose', close);\r\n\r\n            return {\r\n                config: getConfig,\r\n                theme: setTheme,\r\n                sections: setSections,\r\n                open: open,\r\n                close: close,\r\n                toggle: toggle\r\n            };\r\n            //---------------------\r\n\r\n            function getConfig() {\r\n                return config;  \r\n            };\r\n                            \r\n            function setTheme(newTheme) {\r\n                theme(newTheme);\r\n                sendConfigEvent();  \r\n                return config.theme;\r\n            };\r\n                            \r\n            function setSections(newSections) {\r\n                sections(newSections);\r\n                sendConfigEvent();\r\n                return config.sections;  \r\n            };\r\n                            \r\n            function sendConfigEvent() {\r\n                $rootScope.$broadcast('pipSideNavChanged', config);\r\n            };\r\n\r\n            function open(event) {\r\n                $mdSidenav('pip-sidenav').open();   \r\n            };\r\n                 \r\n            function close(event) {\r\n                $mdSidenav('pip-sidenav').close();   \r\n            };                \r\n\r\n            function toggle() {\r\n                $mdSidenav('pip-sidenav').toggle();   \r\n            };                   \r\n        }];\r\n\r\n        function theme(newTheme) {\r\n            config.theme = newTheme || config.theme;\r\n            return config.theme;            \r\n        };\r\n\r\n        function validateSections(sections) {\r\n            pipAssertProvider.isArray(sections, 'pipSideNavProvider.sections or pipSideNav.sections: sections should be an array');\r\n            _.each(sections, function (section, number) {\r\n                if (section.access) {\r\n                    pipAssertProvider.isFunction(section.access, 'pipSideNavProvider.sections or pipSideNav.sections: in section number '\r\n                        + number + \" with title \" + section.title + ' access should be a function');\r\n                }\r\n                if (section.links) {\r\n                    pipAssertProvider.isArray(section.links, 'pipSideNavProvider.sections or pipSideNav.sections: in section number '\r\n                        + number + \" with title \" + section.title + ' links should be an array');\r\n                    _.each(section.links, function (link) {\r\n                        if (link.access) pipAssertProvider.isFunction(link.access, 'pipSideNavProvider.sections or pipSideNav.sections: in section number '\r\n                            + number + \" with title \" + section.title + ' in link with title ' + link.title + ' access should be a function');\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        function sections(newSections) {\r\n            if (pipDebugProvider.enabled()) validateSections(newSections);\r\n\r\n            if (_.isArray(newSections))\r\n                config.sections = newSections;\r\n            return config.sections;\r\n        };\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Tabs control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * \r\n */\r\n\r\n/* global _, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipTabs\", ['pipAssert', 'pipNav.Templates']);\r\n\r\n    thisModule.directive('pipTabs',\r\n        ['$mdMedia', 'pipAssert', function ($mdMedia, pipAssert) {\r\n            return {\r\n                restrict: 'E',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    tabs: '=pipTabs',\r\n                    showTabs: '&pipShowTabs',\r\n                    showTabsShadow: '&pipTabsShadow',\r\n                    activeIndex: '=pipActiveIndex',\r\n                    select: '=pipTabsSelect'\r\n                },\r\n                templateUrl: 'tabs/tabs.html',\r\n                controller:\r\n                    ['$scope', '$element', '$attrs', 'localStorageService', function ($scope, $element, $attrs, localStorageService) {\r\n                        $scope.class = ($attrs.class || '') + ' md-' + localStorageService.get('theme') + '-theme';\r\n                        pipAssert.isArray($scope.tabs, 'pipTabs: pipTabs attribute should take an array');\r\n                        $scope.$mdMedia = $mdMedia;\r\n                        $scope.tabs = ($scope.tabs && _.isArray($scope.tabs)) ? $scope.tabs : [];\r\n                        $scope.activeIndex = $scope.activeIndex || 0;\r\n                        $scope.activeTab = $scope.activeIndex;\r\n\r\n                        $scope.disabled = function () {\r\n                            if ($scope.ngDisabled) {\r\n                                return $scope.ngDisabled();\r\n                            }\r\n                        };\r\n\r\n                        $scope.tabDisabled = function (index) {\r\n                            return ($scope.disabled() && $scope.activeIndex != index);\r\n                        };\r\n\r\n                        $scope.onSelect = function (index) {\r\n                            if ($scope.disabled()) return;\r\n\r\n                            $scope.activeIndex = index;\r\n                            $scope.activeTab = $scope.activeIndex;\r\n                            if ($scope.select) {\r\n                                $scope.select($scope.tabs[$scope.activeIndex], $scope.activeIndex);\r\n                            }\r\n                        };\r\n\r\n                        $scope.showShadow = function () {\r\n                            if ($scope.showTabsShadow) {\r\n                                return $scope.showTabsShadow();\r\n                            } else {\r\n                                return false;\r\n                            }\r\n                        };\r\n\r\n                        $scope.show = function () {\r\n                            if ($scope.showTabs) {\r\n                                return $scope.showTabs();\r\n                            } else {\r\n                                return true;\r\n                            }\r\n                        };\r\n                    }]\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","(function(module) {\ntry {\n  module = angular.module('pipLocations.Templates');\n} catch (e) {\n  module = angular.module('pipLocations.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('location_dialog/location_dialog.html',\n    '<!--\\n' +\n    '@file Location edit dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-location-edit-dialog\" layout=\"column\"md-theme=\"{{theme}}\">\\n' +\n    '\\n' +\n    '    <div class=\"pip-header\" layout=\"column\" layout-align=\"start start\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '        <h3 class=\"m0 w-stretch\" flex>{{ \\'LOCATION_SET_LOCATION\\' | translate }}</h3>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div layout=\"row\" layout-align=\"start center\">\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onAddPin()\" ng-show=\"locationPos == null\"\\n' +\n    '                ng-disabled=\"transaction.busy()\" aria-label=\"{{ ::\\'LOCATION_ADD_PIN\\' | translate }}\">\\n' +\n    '                {{ ::\\'LOCATION_ADD_PIN\\' | translate }}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onRemovePin()\" ng-show=\"locationPos != null\"\\n' +\n    '                ng-disabled=\"transaction.busy()\" aria-label=\"{{ ::\\'LOCATION_REMOVE_PIN\\' | translate }}\">\\n' +\n    '                {{ ::\\'LOCATION_REMOVE_PIN\\' | translate }}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '        <div flex></div>\\n' +\n    '        <div layout=\"row\" layout-align=\"end center\">\\n' +\n    '            <md-button ng-click=\"onCancel()\" aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '                {{ ::\\'CANCEL\\' | translate }}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onApply()\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                aria-label=\"{{ ::\\'APPLY\\' | translate }}\">\\n' +\n    '                {{ ::\\'APPLY\\' | translate }}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"pip-location-container\"></div>\\n' +\n    '        <md-button class=\"md-icon-button md-fab pip-zoom-in\" ng-click=\"onZoomIn()\"\\n' +\n    '                   aria-label=\"{{ ::\\'LOCATION_ZOOM_IN\\' | translate }}\">\\n' +\n    '            <!--span class=\"icon-plus\"></span-->\\n' +\n    '            <md-icon md-svg-icon=\"icons:plus\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '        <md-button class=\"md-icon-button md-fab pip-zoom-out\" ng-click=\"onZoomOut()\"\\n' +\n    '                   aria-label=\"{{ ::\\'LOCATION_ZOOM_OUT\\' | translate }}\">\\n' +\n    '            <!--span class=\"icon-minus\"></span-->\\n' +\n    '            <md-icon md-svg-icon=\"icons:minus\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '        <md-button class=\"md-icon-button md-fab pip-set-location\" ng-click=\"onSetLocation()\"\\n' +\n    '                   aria-label=\"{{ ::\\'LOCATION_SET_LOCATION\\' | translate }}\"\\n' +\n    '                   ng-show=\"supportSet\" ng-disabled=\"transaction.busy()\">\\n' +\n    '            <!--span class=\"icon-target\"></span-->\\n' +\n    '            <md-icon md-svg-icon=\"icons:target\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Registration of location WebUI controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipLocations', [        \r\n        'pipLocation',\r\n        'pipLocationMap',\r\n        'pipLocationIp',\r\n        'pipLocationEdit',\r\n        'pipLocationEditDialog'\r\n    ]);\r\n    \r\n})();\r\n\r\n\r\n","/**\r\n * @file Location control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n\r\n/* global angular, google */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipLocation\", ['pipUtils']);\r\n\r\n    thisModule.directive('pipLocation', \r\n        ['pipUtils', function (pipUtils) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipLocationName: '&',\r\n                    pipLocationPos: '&',\r\n                    pipLocationResize: '&',\r\n                    pipShowLocationIcon: '='\r\n                },\r\n                template: \r\n                    function($element, $attrs) {\r\n                        if (pipUtils.toBoolean($attrs.pipCollapse)) {\r\n                            return String()\r\n                                + '<div class=\"pip-location-name bm0\" ng-click=\"pipLocationResize()\" ng-hide=\"!pipLocationName()\"'\r\n                                + 'ng-class=\"pipShowLocationIcon ? \\'lp24-flex rp16\\' : \\'\\'\">'\r\n                                + '<md-icon md-svg-icon=\"icons:location\" class=\"flex-fixed pip-icon\" ng-if=\"pipShowLocationIcon\"></md-icon>'\r\n                                + '<span class=\"pip-location-text\">{{pipLocationName()}}</span> '\r\n                                + '</div>'\r\n                                + '<div class=\"pip-location-container bm8\" ng-hide=\"!pipLocationPos()\"></div>';\r\n                        } else {\r\n                            return String()\r\n                                + '<md-button class=\"pip-location-name\" ng-click=\"pipLocationResize()\" '\r\n                                + 'ng-class=\"pipShowLocationIcon ? \\'lp24-flex rp16\\' : \\'\\'\">'\r\n                                + '<div class=\"layout-align-start-center layout-row w-stretch\">'\r\n                                + '<md-icon md-svg-icon=\"icons:location\" class=\"flex-fixed pip-icon\" ng-if=\"pipShowLocationIcon\"></md-icon>'\r\n                                + '<span class=\"pip-location-text flex\">{{pipLocationName()}}</span>'\r\n                                + '<md-icon md-svg-icon=\"icons:triangle-down\" class=\"flex-fixed\" ng-if=\"!showMap\"></md-icon>'\r\n                                + '<md-icon md-svg-icon=\"icons:triangle-up\" class=\"flex-fixed\" ng-if=\"showMap\"></md-icon>'\r\n                                + '</div></md-button>'\r\n                                + '<div class=\"pip-location-container bm8\"'\r\n                                + 'ng-class=\"pipShowLocationIcon ? \\'lm24-flex rm24-flex\\' : \\'\\'\"></div>';\r\n                        }\r\n                    },\r\n                controller: 'pipLocationController'\r\n            }\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipLocationController',\r\n        ['$scope', '$element', '$attrs', 'pipUtils', function ($scope, $element, $attrs, pipUtils) {\r\n            var \r\n                $name = $element.children('.pip-location-name'),\r\n                $mapContainer = $element.children('.pip-location-container'),\r\n                $mapControl = null,\r\n                $up = $element.find('.icon-up'),\r\n                $down = $element.find('.icon-down'),\r\n                collapsable = pipUtils.toBoolean($attrs.pipCollapse);\r\n\r\n            function clearMap() {\r\n                // Remove map control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = null;\r\n                $mapContainer.hide();\r\n            };\r\n\r\n            function generateMap() {\r\n                var location = $scope.pipLocationPos();\r\n                \r\n                // Safeguard for bad coordinates\r\n                if ($scope.showMap == false || location == null\r\n                    || location.coordinates == null\r\n                    || location.coordinates.length < 0) {\r\n                    clearMap();\r\n                    return;\r\n                }\r\n\r\n                // Determine map coordinates\r\n                var coordinates = new google.maps.LatLng(\r\n                    location.coordinates[0],\r\n                    location.coordinates[1]\r\n                );\r\n\r\n                // Clean up the control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = $('<div></div>');\r\n                $mapContainer.show();\r\n                $mapControl.appendTo($mapContainer);\r\n\r\n                // Create the map with point marker\r\n                var \r\n                    mapOptions = {\r\n                        center: coordinates,\r\n                        zoom: 12,\r\n                        mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n                        disableDefaultUI: true,\r\n                        disableDoubleClickZoom: true,\r\n                        scrollwheel: false,\r\n                        draggable: false\r\n                    },\r\n                    map = new google.maps.Map($mapControl[0], mapOptions);\r\n                    \r\n                new google.maps.Marker({\r\n                    position: coordinates,\r\n                    map: map\r\n                });\r\n            };\r\n\r\n            // Process user actions\r\n            if (!collapsable) {\r\n                $scope.showMap = false;\r\n                $up.hide();\r\n                $mapContainer.hide();\r\n\r\n                $name.click(function (event) {\r\n                    event.stopPropagation();\r\n                    if ($attrs.disabled) return;\r\n                    $scope.showMap = !$scope.showMap;\r\n                    $up[$scope.showMap ? 'show' : 'hide']();\r\n                    $down[!$scope.showMap ? 'show' : 'hide']();\r\n                    generateMap();\r\n                });\r\n            }\r\n\r\n            // Watch for location changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch($scope.pipLocationPos,\r\n                    function (newValue) {\r\n                        generateMap();\r\n                    }\r\n                );\r\n            }\r\n\r\n            // Add class\r\n            $element.addClass('pip-location');\r\n\r\n            // Visualize map\r\n            if ($scope.pipLocationPos()) generateMap();\r\n            else clearMap();\r\n        }]    \r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Location edit dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve sample in sampler app\r\n */\r\n \r\n/* global angular, google */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipLocationEditDialog', \r\n        ['ngMaterial', 'pipTranslate', 'pipTransactions', 'pipLocations.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'LOCATION_ADD_LOCATION': 'Add location',\r\n            'LOCATION_SET_LOCATION': 'Set location',\r\n            'LOCATION_ADD_PIN': 'Add pin',\r\n            'LOCATION_REMOVE_PIN': 'Remove pin'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'LOCATION_ADD_LOCATION': 'Добавить местоположение',\r\n            'LOCATION_SET_LOCATION': 'Определить положение',\r\n            'LOCATION_ADD_PIN': 'Добавить точку',\r\n            'LOCATION_REMOVE_PIN': 'Убрать точку'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipLocationEditDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        controller: 'pipLocationEditDialogController',\r\n                        templateUrl: 'location_dialog/location_dialog.html',\r\n                        locals: {\r\n                            locationName: params.locationName,\r\n                            locationPos: params.locationPos\r\n                        },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function (result) {\r\n                        if (successCallback) {\r\n                            successCallback(result);\r\n                        }\r\n                    }, function () {\r\n                        if (cancelCallback) {\r\n                            cancelCallback();\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipLocationEditDialogController', \r\n        ['$scope', '$rootScope', '$timeout', '$mdDialog', 'pipTransaction', 'locationPos', 'locationName', function ($scope, $rootScope, $timeout, $mdDialog, pipTransaction, locationPos, locationName) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.locationPos = locationPos && locationPos.type == 'Point'\r\n                && locationPos.coordinates && locationPos.coordinates.length == 2\r\n                ? locationPos : null;\r\n            $scope.locationName = locationName;\r\n            $scope.supportSet = navigator.geolocation != null;\r\n\r\n            $scope.transaction = pipTransaction('location_edit_dialog', $scope);\r\n\r\n            var map = null, marker = null;\r\n\r\n            var createMarker = function(coordinates) {\r\n                if (marker) marker.setMap(null);\r\n                \r\n                if (coordinates) {\r\n                    marker = new google.maps.Marker({ \r\n                        position: coordinates, \r\n                        map: map,\r\n                        draggable: true,\r\n                        animation: google.maps.Animation.DROP\r\n                    });\r\n\r\n                    var thisMarker = marker;\r\n                    google.maps.event.addListener(thisMarker, 'dragend', function() {\r\n                       var coordinates = thisMarker.getPosition(); \r\n                       changeLocation(coordinates);\r\n                    });\r\n                } else {\r\n                    marker = null;\r\n                }\r\n\r\n                return marker;\r\n            };\r\n\r\n            var changeLocation = function(coordinates, tid) {\r\n                $scope.locationPos = {\r\n                    type: 'Point',\r\n                    coordinates: [coordinates.lat(), coordinates.lng()]\r\n                };\r\n                $scope.locationName = null;\r\n\r\n                if (tid == null) {\r\n                    tid = $scope.transaction.begin();\r\n                    if (tid == null) return;\r\n                }\r\n\r\n                // Read address\r\n                var geocoder = new google.maps.Geocoder();\r\n                geocoder.geocode({ location: coordinates }, function(results, status) {\r\n                    if ($scope.transaction.aborted(tid)) return;\r\n\r\n                    // Process positive response\r\n                    if (status == google.maps.GeocoderStatus.OK\r\n                        && results && results.length > 0) {\r\n                        $scope.locationName = results[0].formatted_address;\r\n                    }\r\n\r\n                    $scope.transaction.end();\r\n                    $scope.$apply();\r\n                });\r\n            };\r\n\r\n            // Wait until dialog is initialized\r\n            $timeout(function () {\r\n                var mapContainer = $('.pip-location-edit-dialog .pip-location-container');\r\n\r\n                // Calculate coordinate of the center\r\n                var coordinates = $scope.locationPos ?\r\n                    new google.maps.LatLng(\r\n                        $scope.locationPos.coordinates[0],\r\n                        $scope.locationPos.coordinates[1]\r\n                    ) : null;\r\n\r\n                // Create the map with point marker\r\n                var mapOptions = {\r\n                    center: new google.maps.LatLng(0, 0),\r\n                    zoom: 1,\r\n                    mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n                    disableDefaultUI: true\r\n                };\r\n                if (coordinates != null) {\r\n                    mapOptions.center = coordinates;\r\n                    mapOptions.zoom = 12;\r\n                }\r\n\r\n                map = new google.maps.Map(mapContainer[0], mapOptions);\r\n                marker = createMarker(coordinates);\r\n\r\n                // Fix resizing issue\r\n                setTimeout(function () {\r\n                    google.maps.event.trigger(map, 'resize');\r\n                }, 1000);\r\n            }, 0);\r\n\r\n            $scope.$on('pipLayoutResized', function (event) {\r\n                if (map == null) return;\r\n                google.maps.event.trigger(map, 'resize');\r\n            });\r\n\r\n            $scope.onAddPin = function () {\r\n                if (map == null) return;\r\n\r\n                var coordinates = map.getCenter();\r\n                marker = createMarker(coordinates);\r\n                changeLocation(coordinates);\r\n            };\r\n\r\n            $scope.onRemovePin = function () {\r\n                if (map == null) return;\r\n                marker = createMarker(null);\r\n                $scope.locationPos = null;\r\n                $scope.locationName = null;\r\n            };\r\n\r\n            $scope.onZoomIn = function () {\r\n                if (map == null) return;\r\n                var zoom = map.getZoom();\r\n                map.setZoom(zoom + 1);\r\n            };\r\n\r\n            $scope.onZoomOut = function () {\r\n                if (map == null) return;\r\n                var zoom = map.getZoom();\r\n                map.setZoom(zoom > 1 ? zoom - 1 : zoom);\r\n            };\r\n\r\n            $scope.onSetLocation = function () {\r\n                if (map == null) return;\r\n\r\n                var tid = $scope.transaction.begin();\r\n                if (tid == null) return;\r\n\r\n                navigator.geolocation.getCurrentPosition(\r\n                    function (position) {\r\n                        if ($scope.transaction.aborted(tid)) return;\r\n\r\n                        var coordinates = new google.maps.LatLng(\r\n                            position.coords.latitude, position.coords.longitude);\r\n\r\n                        marker = createMarker(coordinates);\r\n                        map.setCenter(coordinates);\r\n                        map.setZoom(12);\r\n\r\n                        changeLocation(coordinates, tid);\r\n                    },\r\n                    function () {\r\n                        $scope.transaction.end();\r\n                        $scope.$apply();\r\n                    },\r\n                    {\r\n                        maximumAge: 0,\r\n                        enableHighAccuracy: true,\r\n                        timeout: 5000\r\n                    }\r\n                );\r\n            };\r\n\r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            $scope.onApply = function () {\r\n                $mdDialog.hide({\r\n                    location: $scope.locationPos,\r\n                    locationPos: $scope.locationPos,\r\n                    locationName: $scope.locationName   \r\n                });\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Location edit control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipLocationEdit\", ['pipLocationEditDialog']);\r\n\r\n    thisModule.directive('pipLocationEdit',\r\n        ['$parse', '$http', 'pipLocationEditDialog', function ($parse, $http, pipLocationEditDialog) {\r\n            return {\r\n                restrict: 'EAC',\r\n                scope: {\r\n                    pipLocationName: '=',\r\n                    pipLocationPos: '=',\r\n                    pipLocationHolder: '=',\r\n                    ngDisabled: '&',\r\n                    pipChanged: '&'\r\n                },\r\n                template: String()\r\n                    + '<md-input-container class=\"md-block\">'\r\n                    + '<label>{{ \\'LOCATION\\' | translate }}</label>'\r\n                    + '<input ng-model=\"pipLocationName\"'\r\n                    + 'ng-disabled=\"ngDisabled()\"/></md-input-container>'\r\n                    + '<div class=\"pip-location-empty\" layout=\"column\" layout-align=\"center center\">'\r\n                    + '<md-button class=\"md-raised\" ng-disabled=\"ngDisabled()\" ng-click=\"onSetLocation()\"'\r\n                    + 'aria-label=\"LOCATION_ADD_LOCATION\">'\r\n                    + '<span class=\"icon-location\"></span> {{::\\'LOCATION_ADD_LOCATION\\' | translate}}'\r\n                    + '</md-button></div>'\r\n                    + '<div class=\"pip-location-container\" tabindex=\"{{ ngDisabled() ? -1 : 0 }}\"'\r\n                    + ' ng-click=\"onMapClick($event)\" ng-keypress=\"\"onMapKeyPress($event)\"></div>',\r\n                controller: ['$scope', '$element', function ($scope, $element) {\r\n                    $element.find('md-input-container').attr('md-no-float', !!$scope.pipLocationHolder);\r\n                }],\r\n                link: function ($scope, $element) {\r\n\r\n                    var \r\n                        $empty = $element.children('.pip-location-empty'),\r\n                        $mapContainer = $element.children('.pip-location-container'),\r\n                        $mapControl = null;\r\n\r\n                    var clearMap = function () {\r\n                        // Remove map control\r\n                        if ($mapControl) $mapControl.remove();\r\n                        $mapControl = null;\r\n\r\n                        // Toggle control visibility\r\n                        $mapContainer.hide();\r\n                        $empty.show();\r\n                    };\r\n\r\n                    var generateMap = function () {\r\n                        // Safeguard for bad coordinates\r\n                        var location = $scope.pipLocationPos;\r\n                        if (location == null || location.coordinates == null || location.coordinates.length < 0) {\r\n                            clearMap();\r\n                            return;\r\n                        }\r\n\r\n                        // Determine map coordinates\r\n                        var coordinates = new google.maps.LatLng(\r\n                            location.coordinates[0],\r\n                            location.coordinates[1]\r\n                        );\r\n\r\n                        // Clean up the control\r\n                        if ($mapControl) $mapControl.remove();\r\n\r\n                        // Toggle control visibility\r\n                        $mapContainer.show();\r\n                        $empty.hide();\r\n\r\n                        // Add a new map\r\n                        $mapControl = $('<div></div>');\r\n                        $mapControl.appendTo($mapContainer);\r\n\r\n                        // Create the map with point marker\r\n                        var mapOptions = {\r\n                            center: coordinates,\r\n                            zoom: 12,\r\n                            mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n                            disableDefaultUI: true,\r\n                            disableDoubleClickZoom: true,\r\n                            scrollwheel: false,\r\n                            draggable: false\r\n                        };\r\n                        var map = new google.maps.Map($mapControl[0], mapOptions);\r\n                        var marker = new google.maps.Marker({\r\n                            position: coordinates,\r\n                            map: map\r\n                        });\r\n                    };\r\n\r\n                    var defineCoordinates = function () {\r\n                        var locationName = $scope.pipLocationName;\r\n\r\n                        if (locationName == '') {\r\n                            $scope.pipLocationPos = null;\r\n                            clearMap();\r\n                            $scope.$apply();\r\n                            return;\r\n                        }\r\n\r\n                    //    $http.get('http://maps.googleapis.com/maps/api/geocode/json?address=' + locationName)\r\n                    //    .success(function (response) { ... })\r\n                    //    .error(function (response) {... });\r\n\r\n                        var geocoder = new google.maps.Geocoder();\r\n                        geocoder.geocode({ address: locationName }, function(results, status) {\r\n                            $scope.$apply(function() {\r\n                                // Process response\r\n                                if (status == google.maps.GeocoderStatus.OK) {\r\n                                    // Check for empty results\r\n                                    if (results == null || results.length == 0) {\r\n                                        $scope.pipLocationPos = null;\r\n                                        clearMap();\r\n                                        return;\r\n                                    }\r\n\r\n                                    var \r\n                                        geometry = results[0].geometry || {},\r\n                                        location = geometry.location || {};\r\n\r\n                                    // Check for empty results again\r\n                                    if (location.lat == null || location.lng == null) {\r\n                                        $scope.pipLocationPos = null;\r\n                                        clearMap();\r\n                                        return;\r\n                                    }\r\n\r\n                                    $scope.pipLocationPos = {\r\n                                        type: 'Point',\r\n                                        coordinates: [\r\n                                            location.lat(),\r\n                                            location.lng()\r\n                                        ]\r\n                                    };\r\n\r\n                                    //generateMap();                                \r\n                                } \r\n                                // Process error...\r\n                                else {\r\n                                    console.error(response);\r\n                                    $scope.pipLocationPos = null;\r\n                                    //clearMap();                                \r\n                                }\r\n                            });\r\n                        });\r\n\r\n                    };\r\n                    var defineCoordinatesDebounced = _.debounce(defineCoordinates, 2000);\r\n\r\n                    // Process user actions\r\n                    \r\n                    $scope.onSetLocation = function() {\r\n                        if ($scope.ngDisabled()) return;\r\n                          \r\n                        pipLocationEditDialog.show(\r\n                            {\r\n                                locationName: $scope.pipLocationName,\r\n                                locationPos: $scope.pipLocationPos\r\n                            },\r\n                            function (result) {\r\n                                var \r\n                                    location = result.location,\r\n                                    locationName = result.locationName;\r\n\r\n                                // Do not change anything if location is about the same\r\n                                if ($scope.pipLocationPos && $scope.pipLocationPos.type == 'Point'\r\n                                    && $scope.pipLocationPos.coordinates.length == 2\r\n                                    && location && location.coordinates.length == 2\r\n                                    && ($scope.pipLocationPos.coordinates[0] - location.coordinates[0]) < 0.0001\r\n                                    && ($scope.pipLocationPos.coordinates[1] - location.coordinates[1]) < 0.0001\r\n                                    && (locationName == $scope.pipLocationName)) {\r\n                                    return;        \r\n                                }\r\n\r\n                                $scope.pipLocationPos = location;\r\n                                $scope.pipLocationName = locationName;\r\n\r\n                                if (locationName == null && location != null) {\r\n                                    $scope.pipLocationName = \r\n                                        '(' + result.location.coordinates[0]\r\n                                        + ',' + result.location.coordinates[1] + ')';\r\n                                }\r\n                                $scope.pipChanged();\r\n                                $mapContainer[0].focus();\r\n                            }\r\n                        );\r\n                    };\r\n\r\n                    $scope.onMapClick = function ($event) {\r\n                        if ($scope.ngDisabled()) return;\r\n\r\n                        $mapContainer[0].focus();\r\n                        $scope.onSetLocation();\r\n                        //$event.stopPropagation();\r\n                    };\r\n\r\n                    $scope.onMapKeyPress = function($event) {\r\n                        if ($scope.ngDisabled()) return;\r\n\r\n                        if ($event.keyCode == 13 || $event.keyCode == 32) {\r\n                            $scope.onSetLocation();\r\n                            //$event.stopPropagation();\r\n                        }  \r\n                    };\r\n\r\n                    // Watch for location name changes\r\n                    $scope.$watch(\r\n                        function () {\r\n                            return $scope.pipLocationName\r\n                        },\r\n                        function (newValue, oldValue) {\r\n                            if (newValue != oldValue)\r\n                                defineCoordinatesDebounced();\r\n                        }\r\n                    );\r\n\r\n                    $scope.$watch(\r\n                        function () {\r\n                            return $scope.pipLocationPos\r\n                        },\r\n                        function () {\r\n                            console.log('pipLocationPos watched');\r\n                            generateMap();\r\n                        }\r\n                    );\r\n\r\n                    // Add class\r\n                    $element.addClass('pip-location-edit');\r\n\r\n                    // Visualize map\r\n                    if ($scope.pipLocationPos) generateMap();\r\n                    else clearMap();\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Location IP control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n \r\n/* global angular, google */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipLocationIp\", ['pipUtils']);\r\n\r\n    thisModule.directive('pipLocationIp',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipIpaddress: '&',\r\n                    pipExtraInfo: '&'\r\n                },\r\n                template: '<div class=\"pip-location-container\"></div>',\r\n                controller: 'pipLocationIpController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipLocationIpController',\r\n        ['$scope', '$element', '$attrs', '$http', 'pipUtils', function ($scope, $element, $attrs, $http, pipUtils) {\r\n            var \r\n                $mapContainer = $element.children('.pip-location-container'),\r\n                $mapControl = null;\r\n\r\n            function clearMap() {\r\n                // Remove map control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = null;\r\n            };\r\n\r\n            function generateMap(latitude, longitude) {\r\n                // Safeguard for bad coordinates\r\n                if (latitude == null || longitude == null) {\r\n                    clearMap();\r\n                    return;\r\n                }\r\n\r\n                // Determine map coordinates\r\n                var coordinates = new google.maps.LatLng(\r\n                    latitude,\r\n                    longitude\r\n                );\r\n\r\n                // Clean up the control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = $('<div></div>');\r\n                $mapControl.appendTo($mapContainer);\r\n\r\n                // Create the map with point marker\r\n                var \r\n                    mapOptions = {\r\n                        center: coordinates,\r\n                        zoom: 12,\r\n                        mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n                        disableDefaultUI: true,\r\n                        disableDoubleClickZoom: true,\r\n                        scrollwheel: false,\r\n                        draggable: false\r\n                    },\r\n                    map = new google.maps.Map($mapControl[0], mapOptions);\r\n                    \r\n                new google.maps.Marker({\r\n                    position: coordinates,\r\n                    map: map\r\n                });\r\n            };\r\n\r\n            function defineCoordinates() {\r\n                var ipAddress = $scope.pipIpaddress();\r\n\r\n                if (ipAddress == '') {\r\n                    clearMap();\r\n                    return;\r\n                }\r\n\r\n                // Todo: Find more reliable geocoding service to locate ip addresses\r\n                $http.jsonp('http://www.geoplugin.net/json.gp?ip=' + ipAddress + '&jsoncallback=JSON_CALLBACK')\r\n                .success(function (response) {\r\n                    if (response != null \r\n                        && response.geoplugin_latitude != null\r\n                        && response.geoplugin_longitude != null) {\r\n                        \r\n                        generateMap(response.geoplugin_latitude, response.geoplugin_longitude);\r\n\r\n                        if ($scope.pipExtraInfo) {\r\n                            var extraInfo = {\r\n                                city: response.geoplugin_city,  \r\n                                regionCode: response.geoplugin_regionCode,  \r\n                                region: response.geoplugin_regionName,  \r\n                                areaCode: response.geoplugin_areaCode,  \r\n                                countryCode: response.geoplugin_countryCode,  \r\n                                country: response.geoplugin_countryName,  \r\n                                continentCode: response.geoplugin_continentCode\r\n                            };\r\n                            $scope.pipExtraInfo({ extraInfo: extraInfo });\r\n                        }\r\n                    } else {\r\n                        clearMap();\r\n                    }\r\n                })\r\n                .error(function (response) {\r\n                    console.error(response);\r\n                    clearMap();\r\n                });\r\n            };\r\n\r\n            // Watch for location changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch(\r\n                    function () {\r\n                        return $scope.pipIpaddress()\r\n                    },\r\n                    function (newValue) {\r\n                        defineCoordinates();\r\n                    }\r\n                );\r\n            }\r\n\r\n            // Add class\r\n            $element.addClass('pip-location-ip');\r\n\r\n            // Visualize map\r\n            defineCoordinates();\r\n        }]        \r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Location map control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n \r\n/* global angular, google */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipLocationMap\", ['pipUtils']);\r\n\r\n    thisModule.directive('pipLocationMap', \r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipLocationPos: '&'\r\n                },\r\n                template: '<div class=\"pip-location-container\"></div>',\r\n                controller: 'pipLocationMapController' \r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipLocationMapController',\r\n        ['$scope', '$element', '$attrs', '$parse', 'pipUtils', function ($scope, $element, $attrs, $parse, pipUtils) {\r\n            var \r\n                $mapContainer = $element.children('.pip-location-container'),\r\n                $mapControl = null;\r\n    \r\n            function clearMap() {\r\n                // Remove map control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = null;\r\n            };\r\n    \r\n            function generateMap() {\r\n                var location = $scope.pipLocationPos();\r\n                \r\n                // Safeguard for bad coordinates\r\n                if (location == null\r\n                    || location.coordinates == null\r\n                    || location.coordinates.length < 0) {\r\n                    clearMap();\r\n                    return;\r\n                }\r\n    \r\n                // Determine map coordinates\r\n                var coordinates = new google.maps.LatLng(\r\n                    location.coordinates[0],\r\n                    location.coordinates[1]\r\n                );\r\n    \r\n                // Clean up the control\r\n                if ($mapControl) $mapControl.remove();\r\n                $mapControl = $('<div></div>');\r\n                $mapControl.appendTo($mapContainer);\r\n    \r\n                // Create the map with point marker\r\n                var \r\n                    mapOptions = {\r\n                        center: coordinates,\r\n                        zoom: 12,\r\n                        mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n                        disableDefaultUI: true,\r\n                        disableDoubleClickZoom: true,\r\n                        scrollwheel: false,\r\n                        draggable: false\r\n                    },\r\n                    map = new google.maps.Map($mapControl[0], mapOptions);\r\n                    \r\n                new google.maps.Marker({\r\n                    position: coordinates,\r\n                    map: map\r\n                });\r\n            };\r\n    \r\n            // Watch for location changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch(\r\n                    function () {\r\n                        return $scope.pipLocationPos()\r\n                    },\r\n                    function (newValue) {\r\n                        generateMap();\r\n                    }\r\n                );\r\n            }\r\n    \r\n            // Add class\r\n            $element.addClass('pip-location-map');\r\n    \r\n            // Visualize map\r\n            if ($scope.pipLocationPos()) generateMap();\r\n            else clearMap();\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Registration of WebUI documents controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipDocuments', [        \r\n        'pipDocumentList',\r\n        'pipDocumentListEdit'\r\n    ]);\r\n    \r\n})();\r\n\r\n\r\n","(function(module) {\ntry {\n  module = angular.module('pipDocuments.Templates');\n} catch (e) {\n  module = angular.module('pipDocuments.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('document_list_edit/document_list_edit.html',\n    '<!--\\n' +\n    '@file Document list edit control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '<div pip-focusable>\\n' +\n    '\t<div class=\"pip-document-upload pointer md-primary \"\\n' +\n    '\t\t ng-class=\"{\\'pip-focusable\\' : !ngDisabled(), \\'pip-item-error\\' : item.state == \\'error\\'}\"\\n' +\n    '\t\t ng-keydown=\"onKeyDown($event, item)\"\\n' +\n    '\t\t tabindex=\"{{ ngDisabled() ? -1 : 0 }}\"\\n' +\n    '\t\t ng-repeat=\"item in control.items | filter: filterItem\">\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-default-icon\"\\n' +\n    '\t\t\t ng-class=\"{ \\'pip-document-new\\': item.id == null }\">\\n' +\n    '\t\t\t<md-icon pip-cancel-drag=\"true\" class=\"md-primary\" ng-if=\"item.state == \\'original\\' || item.state == \\'added\\'\"\\n' +\n    '\t\t\t\t\t md-svg-icon=\"icons:{{::documentList.icon}}\">\\n' +\n    '\t\t\t</md-icon>\\n' +\n    '\t\t\t<md-icon pip-cancel-drag=\"true\" class=\"md-warn\" ng-if=\"item.state == \\'error\\'\"\\n' +\n    '\t\t\t\t\t md-svg-icon=\"icons:{{::documentList.iconError}}\">\\n' +\n    '\t\t\t</md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-document-title\" pip-cancel-drag=\"true\">\\n' +\n    '\t\t\t{{::item.name}}\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<md-button ng-click=\"onDelete(item)\"\\n' +\n    '\t\t\t\t   ng-disabled=\"ngDisabled() || control.uploading\"\\n' +\n    '\t\t\t\t   tabindex=\"-1\"\\n' +\n    '\t\t\t\t   ng-hide=\"ngDisabled()\"\\n' +\n    '\t\t\t\t   class=\"md-icon-button\" aria-label=\"DELETE\">\\n' +\n    '\\n' +\n    '\t\t\t<md-icon md-svg-icon=\"icons:cross\" pip-cancel-drag=\"true\"></md-icon>\\n' +\n    '\t\t</md-button>\\n' +\n    '\t\t<md-progress-linear ng-show=\"item.uploading\" ng-value=\"item.progress\"></md-progress-linear>\\n' +\n    '\t</div>\\n' +\n    '\t\\n' +\n    '\t<button class=\"pip-document-upload pip-document-drop \"\\n' +\n    '\t\t\tng-class=\"{\\'pip-focusable\\' : !ngDisabled()}\"\\n' +\n    '\t\t\tng-keydown=\"onKeyDown($event)\" tabindex=\"0\"\\n' +\n    '\t\t\tng-file-drop ng-file-select ng-file-change=\"onSelect($files)\"\\n' +\n    '\t\t\tng-multiple=\"true\"\\n' +\n    '\t\t\tng-disabled=\"ngDisabled() || control.uploading\"\\n' +\n    '\t\t\taria-label=\"UPLOAD\">\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-default-icon\">\\n' +\n    '\t\t\t<md-icon pip-cancel-drag=\"true\" md-svg-icon=\"icons:{{::documentList.icon}}\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<div class=\"pip-default-text\">\\n' +\n    '\t\t\t<span>\\n' +\n    '\t\t\t\t{{documentList.text | translate}}\\n' +\n    '\t\t\t</span>\\n' +\n    '\t\t</div>\\n' +\n    '\t</button>\\n' +\n    '\t<div class=\"clearfix\"></div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipDocuments.Templates');\n} catch (e) {\n  module = angular.module('pipDocuments.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('document_list/document_list.html',\n    '<!--\\n' +\n    '@file Document list control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-button class=\"pip-documents-name\"\\n' +\n    '\t\t   ng-class=\"{\\'lp24-flex rp16\\': pipDocumentIcon}\"\\n' +\n    '\t\t   ng-click=\"onTitleClick($event); onResize()\"\\n' +\n    '\t\t   aria-label=\"RESIZE\">\\n' +\n    '\\n' +\n    '\t<div class=\"layout-align-start-center layout-row w-stretch\">\\n' +\n    '\t\t<md-icon md-svg-icon=\"icons:document\" ng-class=\"{\\'pip-icon\\': pipDocumentIcon}\" ng-if=\"pipDocumentIcon\"></md-icon>\\n' +\n    '\t\t<span class=\"pip-documents-text\">\\n' +\n    '\t\t\t{{documents.length}} {{::\\'DOCUMENTS_ATTACHED\\' | translate}}\\n' +\n    '\t\t</span>\\n' +\n    '\\n' +\n    '\t\t<md-icon class=\"icon-up\" md-svg-icon=\"icons:triangle-up\"></md-icon>\\n' +\n    '\t\t<md-icon class=\"icon-down\" md-svg-icon=\"icons:triangle-down\"></md-icon>\\n' +\n    '\t</div>\\n' +\n    '</md-button>\\n' +\n    '<div pip-focused class=\"pip-documents-container bm8\"  ng-class=\"{\\'lp24-flex rp24-flex\\': pipDocumentIcon}\">\\n' +\n    '\t<md-button class=\"pip-document-download md-primary\"\\n' +\n    '\t\t\t   ng-class=\"{\\'pip-focusable\\' : !ngDisabled()}\"\\n' +\n    '\t\t\t   href=\"{{::documentUrl(document)}}\"\\n' +\n    '\t\t\t   target=\"_blank\"\\n' +\n    '\t\t\t   ng-disabled=\"ngDisabled() || document.error\"\\n' +\n    '\t\t\t   ng-repeat=\"document in documents track by document.file_id\"\\n' +\n    '\t\t\t   aria-label=\"DOCUMENT\">\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-default-icon\">\\n' +\n    '\t\t\t<md-icon md-svg-icon=\"icons:{{::documentList.icon}}\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<div class=\"pip-document-title\">\\n' +\n    '\t\t\t{{::document.file_name}}\\n' +\n    '\t\t</div>\\n' +\n    '\t</md-button>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipDocuments.Templates');\n} catch (e) {\n  module = angular.module('pipDocuments.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('document_list/document_list_collapse.html',\n    '<!--\\n' +\n    '@file Document list control content (collapsable version)\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '<div class=\"pip-documents-name\" ng-click=\"onTitleClick($event); onResize()\">\\n' +\n    '\t<span class=\"pip-documents-text\">\\n' +\n    '\t\t{{documents.length}} {{::\\'DOCUMENTS_ATTACHED\\' | translate}}\\n' +\n    '\t</span>\\n' +\n    '\\n' +\n    '\t<md-icon class=\"icon-up\" md-svg-icon=\"icons:triangle-up\"></md-icon>\\n' +\n    '\t<md-icon class=\"icon-down\" md-svg-icon=\"icons:triangle-down\"></md-icon>\\n' +\n    '</div>\\n' +\n    '<div pip-focused class=\"pip-documents-container bm8\">\\n' +\n    '\t<md-button class=\"pip-document-download pip-focusable md-primary\"\\n' +\n    '\t\t\t   href=\"{{::document.url}}\"\\n' +\n    '\t\t\t   target=\"_blank\"\\n' +\n    '\t\t\t   ng-repeat=\"document in documents track by document.file_id\"\\n' +\n    '\t\t\t   aria-label=\"DOCUMENT\">\\n' +\n    '\t\t<div class=\"pip-default-icon\">\\n' +\n    '\t\t\t<md-icon md-svg-icon=\"icons:{{::icon}}\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<div class=\"pip-document-title\">\\n' +\n    '\t\t\t{{::document.file_name}}\\n' +\n    '\t\t</div>\\n' +\n    '\t</md-button>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Document list control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDocumentList\", ['pipCore', 'pipRest', 'pipFocused', 'pipDocuments.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'DOCUMENTS_ATTACHED': 'document(s) attached',\r\n            'ERROR_DOCUMENTS_LOADED': 'Error: <%= error_number %> document(s) are not loaded'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'DOCUMENTS_ATTACHED': 'документов добавлено',\r\n            'ERROR_DOCUMENTS_LOADED': 'Ошибка: <%= error_number %> документ(ов) не загружено'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipDocumentList',\r\n        ['$parse', '$rootScope', 'pipUtils', 'pipRest', '$http', 'pipToasts', 'pipTranslate', function ($parse, $rootScope, pipUtils, pipRest, $http, pipToasts, pipTranslate) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: true,\r\n                templateUrl:'document_list/document_list.html',\r\n                link: function ($scope, $element, $attrs) {\r\n                    var documentsGetter = $parse($attrs.pipDocuments);\r\n\r\n                    var \r\n                        $documentsContainer = $element.children('.pip-documents-container'),\r\n                        $up = $element.find('.icon-up'),\r\n                        $down = $element.find('.icon-down'),\r\n                        collapsable = pipUtils.toBoolean($attrs.pipCollapse);\r\n\r\n                    $scope.documentList = {};\r\n                    $scope.documentList.icon = 'document';\r\n                    $scope.documents = documentsGetter($scope);\r\n                    if($attrs.pipDocumentIcon) {\r\n                        $scope.pipDocumentIcon = true;\r\n                    }\r\n\r\n                    $scope.showDocuments = collapsable;\r\n                    if (!collapsable) {\r\n                        $up.hide();\r\n                        $documentsContainer.hide();\r\n                    } else {\r\n                        $down.hide();\r\n                    }\r\n\r\n                    if ($attrs.disabled) {\r\n                        $up.hide();\r\n                        $down.hide();\r\n                    }\r\n\r\n                    // Also optimization to avoid watch if it is unnecessary\r\n                    if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                        $scope.$watch(documentsGetter, function(newValue) {\r\n                            if (differentDocumentList(newValue)) {\r\n                                $scope.documents = newValue;\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    $scope.onTitleClick = onTitleClick;\r\n                    $scope.documentUrl = documentUrl;\r\n\r\n                    // Add class\r\n                    $element.addClass('pip-document-list');\r\n\r\n                    return ;\r\n\r\n                    function differentDocumentList(newList) {\r\n                        if (!$scope.documents && newList) return true;\r\n                        if ($scope.documents && !newList) return true;\r\n\r\n                        if ($scope.documents.length != newList.length) return true;\r\n\r\n                        for (var i = 0; i < newList.length; i ++) {\r\n                            var obj = _.find($scope.documents, {file_id: newList[i].file_id});\r\n                            if (obj === undefined) return true;\r\n                        }\r\n\r\n                        return false;\r\n                    };\r\n\r\n                    function onTitleClick(event) {\r\n                        if (event) event.stopPropagation();\r\n\r\n                        if ($attrs.disabled) return;\r\n\r\n                        $scope.showDocuments = !$scope.showDocuments;\r\n                        $up[$scope.showDocuments ? 'show' : 'hide']();\r\n                        $down[!$scope.showDocuments ? 'show' : 'hide']();\r\n                        $documentsContainer[$scope.showDocuments ? 'show' : 'hide']();\r\n                    };\r\n\r\n                    function documentUrl(document) {\r\n                        var\r\n                            serverUrl = pipRest.serverUrl(),\r\n                            userId = ($rootScope.$user || {}).id,\r\n                            partyId = ($rootScope.$party || {}).id || userId;\r\n\r\n                        return serverUrl + '/api/parties/' + partyId + '/files/' + document.file_id + '/content';\r\n                    };\r\n\r\n                }\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Document list edit control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Add add/remove/hover animations\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipDocumentListEdit\", \r\n        ['ui.event', 'angularFileUpload', 'pipCore', 'pipFocused', 'pipRest', 'pipDocuments.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'DOCUMENT_LIST_EDIT_TEXT':'Click here to add a document',\r\n            'ERROR_TRANSACTION_IN_PROGRESS': 'Transaction is in progress. Please, wait until it\\'s finished or abort'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'DOCUMENT_LIST_EDIT_TEXT': 'Нажмите сюда, чтобы добавить документ',\r\n            'ERROR_TRANSACTION_IN_PROGRESS': 'Транзакция еще не завершена. Подождите окончания или прервите её'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipDocumentListEdit',\r\n        function() {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipDocuments: '=',\r\n                    pipAddedDocument: '=',\r\n                    ngDisabled: '&',\r\n                    pipCreated: '&',\r\n                    pipChanged: '&'\r\n                },\r\n                templateUrl: 'document_list_edit/document_list_edit.html', \r\n                controller: 'pipDocumentListEditController'\r\n            };\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipDocumentListEditController',\r\n        ['$scope', '$rootScope', '$element', '$attrs', '$parse', '$http', '$upload', '$timeout', 'pipRest', 'pipUtils', function($scope, $rootScope, $element, $attrs, $parse, $http, $upload, $timeout, pipRest, pipUtils) {\r\n            var\r\n                $control = $element.children('.pip-picture-drop');\r\n\r\n            $scope.documentList = {};\r\n            $scope.documentList.text = $attrs.pipDefaultText || 'DOCUMENT_LIST_EDIT_TEXT';\r\n            $scope.documentList.icon = $attrs.pipDefaultIcon || 'document';\r\n            $scope.documentList.iconError = 'warn-circle';\r\n            $scope.documentStartState = pipUtils.toBoolean($scope.pipAddedDocument) ? 'copied' : 'original';\r\n            $scope.cancelDrag = pipUtils.toBoolean($attrs.pipCanselDrag) === true;\r\n\r\n            var itemPin = 0;\r\n\r\n            $scope.control = {\r\n                uploading: 0,\r\n                items: getItems(),\r\n                reset: resetDocument,\r\n                save: saveDocument,\r\n                abort: onAbort\r\n            };\r\n\r\n            $scope.filterItem = filterItem;\r\n            $scope.onDelete = onDelete;\r\n            $scope.onKeyDown = onKeyDown;\r\n            $scope.onChange = onChange;\r\n            $scope.onSelect = onSelect;\r\n\r\n            // Add class\r\n            $element.addClass('pip-document-list-edit');\r\n\r\n            // Initialize control\r\n            $scope.control.reset();\r\n\r\n            executeCallback();\r\n\r\n            // Watch for changes\r\n            $scope.$watchCollection(\r\n                function () {\r\n                    // Todo: Optimize change tracking\r\n                    return $scope.pipDocuments;\r\n                },\r\n                function(newValue) {\r\n                    if (!_.isEqual(newValue, $scope.pipDocuments)) {\r\n                        $scope.control.reset();\r\n                    }\r\n                }\r\n            );\r\n\r\n            return ;\r\n\r\n            function getItems() {\r\n                var\r\n                    documents = $scope.pipDocuments,\r\n                    items = [];\r\n\r\n                if (documents == null || documents.length == 0)\r\n                    return items;\r\n\r\n                for (var i = 0; i < documents.length; i++) {\r\n                    items.push({\r\n                        pin: itemPin++,\r\n                        id: documents[i].file_id,\r\n                        name: documents[i].file_name,\r\n                        uploading: false,\r\n                        uploaded: false,\r\n                        progress: 0,\r\n                        file: null,\r\n                        state: $scope.documentStartState //'original'\r\n                    });\r\n                }\r\n\r\n                return items;\r\n            };\r\n\r\n            function setItems() {\r\n                // Clean the array\r\n                if ($scope.pipDocuments && $scope.pipDocuments.length > 0)\r\n                    $scope.pipDocuments.splice(0, $scope.pipDocuments.length);\r\n\r\n                for (var i = 0; i < $scope.control.items.length; i++) {\r\n                    var item = $scope.control.items[i];\r\n                    if (item.id) {\r\n                        $scope.pipDocuments.push({\r\n                            file_id: item.id,\r\n                            file_name: item.name\r\n                        });\r\n                    }\r\n                }\r\n            };\r\n\r\n            function resetDocument() {\r\n                $scope.control.uploading = 0;\r\n                $scope.control.items = getItems();\r\n            };\r\n\r\n            function getItemIdUrl(item) {\r\n                var\r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $rootScope.$party ? $rootScope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files/' + item.id;\r\n            };\r\n\r\n            function addItemUrl(item) {\r\n                var \r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $rootScope.$party ? $rootScope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files?name=' + item.file.name\r\n            };\r\n\r\n            function addItem(item, callback) {\r\n                var \r\n                    control = $scope.control,\r\n                    file = item.file;\r\n\r\n                // Avoid double transactions\r\n                if (item.uploading || item.file == null || item.state != 'added') \r\n                    return;\r\n\r\n                var fileReader = new FileReader();\r\n                fileReader.onload = function (e) {\r\n                    if (item.uploading) return;\r\n\r\n                    item.uploading = true;\r\n\r\n                    item.upload = $upload.http({\r\n                        url: addItemUrl(item),\r\n                        headers: { 'Content-Type': file.type },\r\n                        data: e.target.result\r\n                    })\r\n                    .then(\r\n                        function (response) {\r\n                            item.id = response.data.id;\r\n                            item.name = response.data.filename || item.name;\r\n                            item.uploaded = true;\r\n                            item.uploading = false;\r\n                            item.progress = 0;\r\n                            item.upload = null;\r\n                            item.file = null;\r\n                            item.state = 'original';\r\n                            callback();\r\n                        },\r\n                        function (error) {\r\n                            item.uploaded = false;\r\n                            item.uploading = false;\r\n                            item.progress = 0;\r\n                            item.upload = null;\r\n                            item.state = 'error';\r\n                            callback();\r\n                        },\r\n                        function (e) {\r\n                            // Math.min is to fix IE which reports 200% sometimes\r\n                            item.progress = Math.min(100, parseInt(100.0 * e.loaded / e.total));\r\n                        }\r\n                    );\r\n                };\r\n\r\n                fileReader.readAsArrayBuffer(file);  \r\n            };\r\n\r\n            function deleteItem(item, callback) {\r\n                var control = $scope.control;\r\n\r\n                // Avoid double transactions\r\n                if (item.upload) {\r\n                    item.upload.abort();\r\n                    item.upload = null;\r\n                }\r\n\r\n                if (item.state != 'deleted') \r\n                    return;\r\n\r\n                $http['delete'](getItemIdUrl(item))\r\n                .success(function (data) {\r\n                    _.remove(control.items, {pin: item.pin});\r\n                    callback();\r\n                })\r\n                .error(function (data, status) {\r\n                    // Todo: perform a better processing\r\n                    if (data == null) {\r\n                        _.remove(control.items, {pin: item.pin});\r\n                    } else {\r\n                        item.uploaded = false;\r\n                        item.uploading = false;\r\n                        item.progress = 0;\r\n                        item.upload = null;\r\n                    }\r\n\r\n                    callback(data);\r\n                });\r\n            };\r\n\r\n            function saveDocument(successCallback, errorCallback) {\r\n                var control = $scope.control;\r\n\r\n                if (control.uploading) {\r\n                    if (errorCallback) errorCallback('ERROR_TRANSACTION_IN_PROGRESS');\r\n                    return;\r\n                }\r\n\r\n                control.error = null;\r\n                control.uploading = 0;\r\n\r\n                var onItemCallback = function(error) {\r\n                    // Storing only the first error \r\n                    if (error && !control.error) {\r\n                        control.error = error;\r\n                    }\r\n\r\n                    control.uploading--;\r\n\r\n                    // Finished uploading\r\n                    if (control.uploading == 0) {\r\n                        if (control.error) {\r\n                            if (errorCallback) errorCallback(control.error);\r\n                            else console.error(control.error);\r\n                        } else {\r\n                            setItems();\r\n                            if (successCallback) successCallback();\r\n                        }\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i < control.items.length; i++) {\r\n                    var item = control.items[i];\r\n\r\n                    if (item.state == 'added') {\r\n                        control.uploading++;\r\n                        addItem(item, onItemCallback);\r\n                    } else if (item.state == 'deleted') {\r\n                        control.uploading++;\r\n                        deleteItem(item, onItemCallback);\r\n                    }\r\n                }\r\n\r\n                // Nothing was uploaded\r\n                if (control.uploading == 0) {\r\n                    if (successCallback) successCallback();\r\n                }\r\n            };\r\n\r\n            function onAbort() {\r\n                var control = $scope.control;\r\n\r\n                for (var i = 0; i < control.items.length; i++) {\r\n                    var item = control.items[i];\r\n\r\n                    if (item.uploading) {\r\n                        if (item.upload) item.upload.abort();\r\n\r\n                        item.uploaded = false;\r\n                        item.uploading = false;\r\n                        item.progress = 0;\r\n                        item.upload = null;\r\n                    }\r\n                }\r\n\r\n                // Abort transaction\r\n                control.uploading = 0;\r\n            };\r\n\r\n            // Visualization functions\r\n\r\n            function filterItem(item) {\r\n                return item.state != 'deleted';  \r\n            };\r\n\r\n            // Process user actions\r\n            function onSelect($files) {\r\n                $control.focus();\r\n\r\n                if ($files == null || $files.length == 0)\r\n                    return;\r\n\r\n                for (var i = 0; i < $files.length; i++) {\r\n                    var file = $files[i];\r\n\r\n                    $scope.control.items.push({\r\n                        pin: itemPin++,\r\n                        id: null,\r\n                        name: file.name,\r\n                        uploading: false,\r\n                        uploaded: false,\r\n                        progress: 0,\r\n                        file: file,\r\n                        state: 'added'\r\n                    });\r\n                }\r\n\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onDelete(item) {\r\n                if (item.state == 'added' || item.state == 'copied' ) {\r\n                    _.remove($scope.control.items, {pin: item.pin});\r\n                } else {\r\n                    item.state = 'deleted';\r\n                }\r\n\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onKeyDown($event, item) {\r\n                if (item) {\r\n                    if ($event.keyCode == 46 || $event.keyCode == 8) {\r\n                        if (item.state == 'added') {\r\n                            _.remove($scope.control.items, {pin: item.pin});\r\n                        } else {\r\n                            item.state = 'deleted';\r\n                        }\r\n\r\n                        $scope.onChange();\r\n                    }                        \r\n                } else {\r\n                    if ($event.keyCode == 13 || $event.keyCode == 32) {\r\n                        // !! Avoid clash with $apply()\r\n                        setTimeout(function() {\r\n                            $control.trigger('click');\r\n                        }, 0);\r\n                    } \r\n                }\r\n            };\r\n\r\n            // On change event\r\n            function onChange() {\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged({\r\n                        $event: { sender: $scope.control },\r\n                        $control: $scope.control\r\n                    });\r\n                }\r\n            };\r\n\r\n            function executeCallback() {\r\n                // Execute callback\r\n                if ($scope.pipCreated) {\r\n                    $scope.pipCreated({\r\n                        $event: { sender: $scope.control },\r\n                        $control: $scope.control\r\n                    });\r\n                }\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Registration of pictures WebUI controls\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipPictures', [        \r\n        'pipAddImage',\r\n        'pipAvatar',\r\n        'pipAvatarEdit',\r\n        'pipPicture',\r\n        'pipPictureEdit',\r\n        'pipCollage',\r\n        'pipPictureListEdit',        \r\n        'pipCameraDialog',        \r\n        'pipPictureUrlDialog'\r\n    ]);\r\n    \r\n})();\r\n\r\n\r\n","(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('add_image/add_image.html',\n    ' <!--\\n' +\n    '@file Add image directive content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2015\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-menu>\\n' +\n    '        <ng-transclude class=\"pip-add-image-open-button\" ng-click=\"ngDisabled() ? \\'\\' : $mdOpenMenu()\"></ng-transclude>\\n' +\n    '        <md-menu-content width=\"4\">\\n' +\n    '            <md-menu-item>\\n' +\n    '                <md-button layout=\"row\" layout-align=\"start center\" accept=\"image/*\"\\n' +\n    '                           ng-keydown=\"onKeyDown($event)\" ng-multiple=\"isMulti()\"\\n' +\n    '                           ng-file-select ng-file-change=\"onFileChange($files)\" ng-click=\"hideMenu()\" ng-file-drop>\\n' +\n    '\\n' +\n    '                    <md-icon class=\"text-headline text-grey rm24-flex\" md-svg-icon=\"icons:folder\"></md-icon>\\n' +\n    '                    <!--<span class=\"icon-folder text-headline text-grey tp8 rm24-flex\"></span>-->\\n' +\n    '                    <span class=\"text-grey\">{{::\\'FILE\\' | translate}}</span>\\n' +\n    '                </md-button>\\n' +\n    '            </md-menu-item>\\n' +\n    '            <md-menu-item>\\n' +\n    '                <md-button layout=\"row\" layout-align=\"start center\" ng-click=\"onWebLinkClick()\">\\n' +\n    '                    <md-icon class=\"text-headline text-grey rm24-flex\" md-svg-icon=\"icons:weblink\"></md-icon>\\n' +\n    '                    <!--<span class=\"icon-weblink text-headline text-grey tp8 rm24-flex\"></span>-->\\n' +\n    '                    <span class=\"text-grey\">{{::\\'WEB_LINK\\' | translate}}</span>\\n' +\n    '                </md-button>\\n' +\n    '            </md-menu-item>\\n' +\n    '            <md-menu-item>\\n' +\n    '                <md-button layout=\"row\" layout-align=\"start center\" ng-click=\"onCameraClick()\">\\n' +\n    '                    <md-icon class=\"text-headline text-grey rm24-flex\" md-svg-icon=\"icons:camera\"></md-icon>\\n' +\n    '                    <!--<span class=\"icon-camera text-headline text-grey tp8 rm24-flex\"></span>-->\\n' +\n    '                    <span class=\"text-grey\">{{::\\'CAMERA\\' | translate}}</span>\\n' +\n    '                </md-button>\\n' +\n    '            </md-menu-item>\\n' +\n    '            <md-menu-item>\\n' +\n    '                <md-button layout=\"row\" layout-align=\"start center\" ng-click=\"onGalleryClick()\">\\n' +\n    '                    <md-icon class=\"text-headline text-grey rm24-flex\" md-svg-icon=\"icons:images\"></md-icon>\\n' +\n    '                    <!--<span class=\"icon-images text-headline text-grey tp8 rm24-flex\"></span>-->\\n' +\n    '                    <span class=\"text-grey\">{{::\\'IMAGE_GALLERY\\' | translate}}</span>\\n' +\n    '                </md-button>\\n' +\n    '            </md-menu-item>\\n' +\n    '        </md-menu-content>\\n' +\n    '    </md-menu>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('camera_dialog/camera_dialog.html',\n    '<!--\\n' +\n    '@file Camera dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2015\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-picture-dialog pip-camera-dialog\" layout=\"column\" md-theme=\"{{theme}}\">\\n' +\n    '    <div class=\"pip-header\"  layout=\"row\" layout-align=\"start center\">\\n' +\n    '        <md-button  ng-click=\"onCancelClick()\" class=\"md-icon-button\"\\n' +\n    '                    aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '            <md-icon class=\"text-grey\" md-svg-icon=\"icons:arrow-left\"></md-icon>\\n' +\n    '        </md-button>\\n' +\n    '        <h3 class=\"m0 text-title\">{{ ::\\'TAKE_PICTURE\\' | translate }}</h3>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"camera-stream\" ng-hide=\"webCamError\"></div>\\n' +\n    '        <div class=\"camera-error\"\\n' +\n    '             ng-show=\"webCamError\"\\n' +\n    '             layout=\"row\" layout-align=\"center center\">\\n' +\n    '            <span>{{ ::\\'WEB_CAM_ERROR\\' | translate }}</span>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div class=\"w48\">\\n' +\n    '            <md-button ng-click=\"onResetPicture()\"\\n' +\n    '                       ng-hide=\"!$freeze || webCamError\"\\n' +\n    '                       class=\"md-icon-button\"\\n' +\n    '                       ng-disabled=\"transaction.busy()\"\\n' +\n    '                       aria-label=\"{{ ::\\'REMOVE_PICTURE\\' | translate }}\">\\n' +\n    '                <md-icon class=\"text-grey\" md-svg-icon=\"icons:refresh\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '        <div flex></div>\\n' +\n    '        <div class=\"w48\">\\n' +\n    '            <md-button ng-click=\"onTakePictureClick()\"\\n' +\n    '                       ng-hide=\"webCamError\"\\n' +\n    '                       class=\"md-icon-button\"\\n' +\n    '                       aria-label=\"{{ ::\\'TAKE_PICTURE\\' | translate }}\">\\n' +\n    '                <md-icon class=\"text-grey icon-button\" md-svg-icon=\"icons:{{$freeze ? \\'check\\' : \\'camera\\'}}\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '        </div>\\n' +\n    '        <div flex></div>\\n' +\n    '        <div class=\"w48\">\\n' +\n    '            <md-button  ng-click=\"onCancelClick()\" class=\"md-icon-button\"\\n' +\n    '                        aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '                <md-icon class=\"text-grey\" md-svg-icon=\"icons:cross\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('gallery_search_dialog/gallery_search_dialog.html',\n    '<md-dialog class=\"pip-dialog pip-gallery-search-dialog pip-picture-dialog\"\\n' +\n    '           layout=\"column\"  md-theme=\"{{theme}}\">\\n' +\n    '    <md-progress-linear\\n' +\n    '            ng-show=\"transaction.busy()\" md-mode=\"indeterminate\">\\n' +\n    '    </md-progress-linear>\\n' +\n    '\\n' +\n    '    <md-dialog-content class=\"pip-body lp0 rp0 tp0 pip-scroll\" layout=\"row\" flex  >\\n' +\n    '        <div layout=\"column\" layout-align=\"start start\" flex>\\n' +\n    '            <div class=\"pip-header w-stretch\" layout=\"column\" layout-align=\"start start\">\\n' +\n    '                <h3 class=\"w-stretch text-title m0 bp8\">\\n' +\n    '                    <md-button  class=\"md-icon-button m0\"\\n' +\n    '                                ng-click=\"onCancelClick()\"\\n' +\n    '                                aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '                        <md-icon class=\"text-grey\" md-svg-icon=\"icons:arrow-left\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                    {{::\\'IMAGE_GALLERY\\' | translate}}\\n' +\n    '                </h3>\\n' +\n    '                <div class=\"w-stretch divider-bottom \" layout=\"row\" layout=\"start center\">\\n' +\n    '                    <input class=\"no-divider rm8 text-subhead1\" flex\\n' +\n    '                           ng-disabled=\"transaction.busy()\"\\n' +\n    '                           ng-model=\"$search\" ng-keypress=\"onKeyPress($event)\"\\n' +\n    '                           placeholder=\"{{::\\'SEARCH_PICTURES\\' | translate}}\"\\n' +\n    '                           type=\"text\" tabindex=\"1\">\\n' +\n    '\\n' +\n    '                    <md-button class=\"md-icon-button md-icon-button-square p0 pip-search-button md-primary\"\\n' +\n    '                               ng-click=\"onSearchClick()\"\\n' +\n    '                               ng-hide=\"optionDefault\"\\n' +\n    '                               tabindex=\"-1\" aria-label=\"SEARCH\">\\n' +\n    '                        <md-icon class=\"text-opacity md-primary\" md-svg-icon=\"icons:search-square \"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-content\" flex\\n' +\n    '                 ng-show=\"$images.length > 0\">\\n' +\n    '                <div class=\"pip-image-container\"\\n' +\n    '                     ng-click=\"onImageClick(image)\"\\n' +\n    '                     ng-repeat=\"image in $images track by $index\"\\n' +\n    '                     ng-class=\"{\\'checked\\': image.checked}\"\\n' +\n    '                     tabindex=\"{{ $index + 2 }}\">\\n' +\n    '\\n' +\n    '                    <pip-picture pip-src=\"image.thumbnail\"\\n' +\n    '                                 pip-default-icon=\"icon-images\"\\n' +\n    '                                 pip-rebind=\"true\">\\n' +\n    '                    </pip-picture>\\n' +\n    '                    <div class=\"pip-checked-cover\"></div>\\n' +\n    '                    <div class=\"pip-checkbox-backdrop\">\\n' +\n    '                        <md-checkbox md-no-ink\\n' +\n    '                                     ng-model=\"image.checked\"\\n' +\n    '                                     ng-click=\"image.checked = !image.checked\"\\n' +\n    '                                     aria-label=\"CHECKED\">\\n' +\n    '                        </md-checkbox>\\n' +\n    '                    </div>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-no-images w-stretch\" layout=\"column\" layout-align=\"center center\" flex\\n' +\n    '                 ng-show=\"$images.length == 0\">\\n' +\n    '                <md-icon class=\"text-grey\" md-svg-icon=\"icons:images\"></md-icon>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </md-dialog-content>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <md-button  ng-click=\"onCancelClick()\"\\n' +\n    '                    ng-hide=\"transaction.busy()\"\\n' +\n    '                    aria-label=\"{{ ::\\'CANCEL\\' | translate }}\"\\n' +\n    '                    tabindex=\"{{ $images.length + 3 }}\">\\n' +\n    '                <span class=\"text-grey\">\\n' +\n    '                    {{ ::\\'CANCEL\\' | translate }}\\n' +\n    '                </span>\\n' +\n    '        </md-button>\\n' +\n    '        <md-button ng-if=\"transaction.busy()\" ng-click=\"onStopSearchClick()\" class=\"md-raised md-warn m0\"\\n' +\n    '                   tabindex=\"5\" aria-label=\"ABORT\"\\n' +\n    '                   pip-test=\"button-cancel\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '        <md-button  class=\"md-accent\"\\n' +\n    '                    ng-hide=\"transaction.busy()\"\\n' +\n    '                    ng-disabled=\"addButtonDisabled()\"\\n' +\n    '                    ng-click=\"onAddClick()\"\\n' +\n    '                    aria-label=\"{{ ::\\'ADD\\' | translate }}\"\\n' +\n    '                    tabindex=\"{{ $images.length + 4 }}\">\\n' +\n    '\\n' +\n    '            {{ ::\\'ADD\\' | translate }}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('picture_edit/picture_edit.html',\n    '<div class=\"pip-picture-upload pip-picture-drop md-focused\"\\n' +\n    '\t ng-keydown=\"onKeyDown($event)\"\\n' +\n    ' \t tabindex=\"{{ ngDisabled() || control.uploading ? -1 : 0 }}\"\\n' +\n    '\t pip-add-image\\n' +\n    '\t pip-changed=\"readItemLocally(url, file)\"\\n' +\n    '\t ng-disabled=\"ngDisabled()\"\\n' +\n    '\t pip-multi=\"false\">\\n' +\n    '\\n' +\n    '\t<div class=\"pip-default-icon\" ng-show=\"empty()\">\\n' +\n    '\t\t<md-icon  class=\"pip-picture-icon\" md-svg-icon=\"icons:{{icon}}\"></md-icon>\\n' +\n    '\t</div>\\n' +\n    '\t<div class=\"pip-default-text\" ng-show=\"empty()\">\\n' +\n    '\t\t<span>{{text | translate}}</span>\\n' +\n    '\t</div>\\n' +\n    '\\n' +\n    '\t<img class=\"pip-picture-image\"\\n' +\n    '\t\t ng-src=\"{{control.url}}\"\\n' +\n    '\t\t ng-show=\"!empty()\"\\n' +\n    '\t\t ng-class=\"{ \\'pip-image-new\\': isUpdated(), \\'cursor-default\\' : ngDisabled() || control.uploading }\"\\n' +\n    ' \t\t ui-event=\"{ error: \\'onImageError($event)\\', load: \\'onImageLoad($event)\\' }\">\\n' +\n    '\\n' +\n    '\t<md-button class=\"md-icon-button\"\\n' +\n    '\t\t\t   ng-click=\"onDeleteClick($event)\"\\n' +\n    '\t\t\t   tabindex=\"-1\" aria-label=\"delete\"\\n' +\n    '\t\t\t   ng-hide=\"empty() || ngDisabled()\"\\n' +\n    '\t\t\t   ng-disabled=\"ngDisabled() || control.uploading\">\\n' +\n    '\t\t<md-icon  md-svg-icon=\"icons:cross\"></md-icon>\\n' +\n    '\t</md-button>\\n' +\n    '\\n' +\n    '\t<md-progress-linear ng-show=\"control.uploading\"\\n' +\n    '\t\t\t\t\t\tng-value=\"control.progress\">\\n' +\n    '\t</md-progress-linear>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('picture_list_edit/picture_list_edit.html',\n    '<div pip-focused>\\n' +\n    '\t<div class=\"pip-picture-upload pointer pip-focusable\"\\n' +\n    '\t\t ng-class=\"{\\'pip-picture-error\\': item.error}\"\\n' +\n    '\t\t ng-keydown=\"onKeyDown($event, item)\"\\n' +\n    '\t\t tabindex=\"{{ ngDisabled() ? -1 : 0 }}\"\\n' +\n    '\t\t ng-repeat=\"item in control.items | filter: filterItem\">\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-default-icon\" ng-hide=\"item.loaded || item.error\">\\n' +\n    '\t\t\t<md-icon  pip-cancel-drag=\"true\" class=\"pip-picture-icon\" md-svg-icon=\"icons:{{icon}}\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<div class=\"pip-default-text\" ng-show=\"item.error\">\\n' +\n    '\t\t\t<!--span style=\"color: red\">{{ \\'ERROR_IMAGE_PRELOADING\\' | translate}}</span-->\\n' +\n    '\t\t\t<md-icon  pip-cancel-drag=\"true\" md-svg-icon=\"icons:warn-circle\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<img ng-src=\"{{::item.url}}\"\\n' +\n    '\t\t\t pip-cancel-drag=\"true\"\\n' +\n    '\t\t\t ng-hide=\"item.error\"\\n' +\n    '\t\t\t ng-class=\"{ \\'pip-image-new\\': item.state == \\'added\\' }\"\\n' +\n    '\t\t\t ui-event=\"{ error: \\'onImageError($event, item)\\', load: \\'onImageLoad($event, item)\\' }\">\\n' +\n    '\\n' +\n    '\t\t<md-button ng-click=\"onDeleteClick(item)\"\\n' +\n    '\t\t\t\t   ng-disabled=\"ngDisabled() || control.uploading\" tabindex=\"-1\"\\n' +\n    '\t\t\t\t   aria-label=\"delete\"\\n' +\n    '\t\t\t\t   class=\"md-icon-button\">\\n' +\n    '\\n' +\n    '\t\t\t<md-icon  pip-cancel-drag=\"true\" md-svg-icon=\"icons:cross\"></md-icon>\\n' +\n    '\t\t</md-button>\\n' +\n    '\t\t<md-progress-linear md-mode=\"indeterminate\" ng-show=\"item.uploading\" value=\"{{ item.progress }}\">\\n' +\n    '\t\t</md-progress-linear>\\n' +\n    '\t</div>\\n' +\n    '\\n' +\n    '\t<button class=\"pip-picture-upload pip-picture-drop pip-focusable\"\\n' +\n    '\t\t\tpip-add-image\\n' +\n    '\t\t\tpip-changed=\"readItemLocally(url, file)\"\\n' +\n    '\t\t\tng-disabled=\"ngDisabled() || control.uploading\">\\n' +\n    '\\n' +\n    '\t\t<div class=\"pip-default-icon\">\\n' +\n    '\t\t\t<md-icon  pip-cancel-drag=\"true\" class=\"pip-picture-icon\" md-svg-icon=\"icons:{{icon}}\"></md-icon>\\n' +\n    '\t\t</div>\\n' +\n    '\t\t<div class=\"pip-default-text\">\\n' +\n    '\t\t\t<span>{{text | translate}}</span>\\n' +\n    '\t\t</div>\\n' +\n    '\t</button>\\n' +\n    '\t<div class=\"clearfix\"></div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipPictures.Templates');\n} catch (e) {\n  module = angular.module('pipPictures.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('picture_url_dialog/picture_url_dialog.html',\n    '<!--\\n' +\n    '@file Picture URL dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-picture-url-dialog pip-picture-dialog\"\\n' +\n    '           layout=\"column\" md-theme=\"{{theme}}\">\\n' +\n    '\\n' +\n    '    <md-dialog-content class=\"pip-body lp0 rp0 tp0 pip-scroll\">\\n' +\n    '        <div class=\"pip-header bm16\"  layout=\"row\" layout-align=\"start center\">\\n' +\n    '            <md-button  ng-click=\"onCancelClick()\" class=\"md-icon-button lm0\"\\n' +\n    '                        aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '                <md-icon class=\"text-grey\" md-svg-icon=\"icons:arrow-left\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '            <h3 class=\"text-title m0\">\\n' +\n    '                {{ ::\\'PICTURE_FROM_WEBLINK\\' | translate}}\\n' +\n    '            </h3>\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <md-input-container md-no-float class=\"w-stretch text-subhead1\">\\n' +\n    '                <input type=\"text\" ng-model=\"url\" ng-change=\"checkUrl()\" placeholder=\"{{:: \\'LINK_PICTURE\\' | translate}}\"/>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <div class=\"w-stretch\"\\n' +\n    '                 ng-hide=\"invalid\"\\n' +\n    '                 layout=\"row\" layout-align=\"center center\">\\n' +\n    '                <img id=\"url_image\"/>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"pip-no-images\" ng-show=\"invalid\"\\n' +\n    '                 layout=\"row\" layout-align=\"center center\">\\n' +\n    '                <md-icon class=\"text-grey\" md-svg-icon=\"icons:images\"></md-icon>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '        </div>\\n' +\n    '    </md-dialog-content>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <md-button ng-click=\"onCancelClick()\" aria-label=\"{{ ::\\'CANCEL\\' | translate }}\">\\n' +\n    '            {{ ::\\'CANCEL\\' | translate }}\\n' +\n    '        </md-button>\\n' +\n    '\\n' +\n    '        <md-button class=\"md-accent\" ng-click=\"onAddClick()\" ng-disabled=\"invalid\"\\n' +\n    '                   aria-label=\"{{ ::\\'ADD\\' | translate }}\">\\n' +\n    '            {{ ::\\'ADD\\' | translate }}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>');\n}]);\n})();\n","/**\r\n * @file Avatar control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Replace placeholder with default image generated on server\r\n * - Fix resizing problem\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipAvatar\", ['pipCore', 'pipRest', 'pipImageUtils']);\r\n\r\n    thisModule.directive('pipAvatar',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: false,\r\n                template: '<md-icon></md-icon><img/>'\r\n                + '<div><md-icon class=\"default_icon\" id=\"icon-film\" md-svg-icon=\"icons:film\"></md-icon>'\r\n                + '<md-icon class=\"default_icon\" id=\"icon-task\" md-svg-icon=\"icons:task\"></md-icon>'\r\n                + '<md-icon class=\"default_icon\" id=\"icon-folder\" md-svg-icon=\"icons:folder\"></md-icon></div>',\r\n                controller: 'pipAvatarController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipAvatarController',\r\n        ['$scope', '$rootScope', '$element', '$attrs', '$parse', 'pipUtils', 'pipStrings', 'pipRest', '$http', 'pipImageUtils', function ($scope, $rootScope, $element, $attrs, $parse, pipUtils, pipStrings, pipRest, $http, pipImageUtils) {\r\n            var\r\n                $svg = $element.children('md-icon'),\r\n                $image = $element.children('img'),\r\n                $defaultBlock = $element.children('div'),\r\n                $iconFilm = $element.find('#icon-film'),\r\n                $iconTask = $element.find('#icon-task'),\r\n                $iconFolder = $element.find('#icon-folder'),\r\n                image = null,\r\n\r\n                partyIdGetter = $parse($attrs.pipPartyId),\r\n                partyNameGetter = $parse($attrs.pipPartyName),\r\n                typeGetter = $parse($attrs.pipEntityType),\r\n                idGetter = $parse($attrs.pipId),\r\n\r\n                colors = pipImageUtils.getAvatarColors(),\r\n                colorClasses = pipImageUtils.getColorClasses(),\r\n                entityTypes = pipImageUtils.getEntityTypes();\r\n\r\n            // When image is loaded resize/reposition it\r\n            $image.load(function ($event) {\r\n                image = $($event.target);\r\n                pipImageUtils.setImageMarginCSS($element, image);\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-avatar flex-fixed');\r\n\r\n            if ($attrs.ngClass) {\r\n                $scope.$watch($attrs.ngClass, function () {\r\n                    setTimeout(function () {\r\n                        pipImageUtils.setImageMarginCSS($element, image);\r\n                    }, 50);\r\n                });\r\n            }\r\n\r\n            // Optimization to avoid binding\r\n            bindControl();\r\n\r\n            if (pipUtils.toBoolean($attrs.pipRebindAvatar)) {\r\n                $rootScope.$on('pipPartyAvatarUpdated', refreshAvatar);\r\n            }\r\n\r\n            // Also optimization to avoid watch if it is unnecessary\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch(partyIdGetter, function (newValue, oldValue) {\r\n                    if (oldValue !== newValue)\r\n                        bindControl();\r\n                });\r\n\r\n                $scope.$watch(idGetter, function (newValue, oldValue) {\r\n                    if (oldValue !== newValue)\r\n                        bindControl();\r\n                });\r\n            }\r\n\r\n            return;\r\n\r\n            function refreshAvatar() {\r\n                $iconTask.css('display', 'none');\r\n                $iconFilm.css('display', 'none');\r\n                $iconFolder.css('display', 'none');\r\n                $defaultBlock.css('display', 'none');\r\n                $image.attr('src', '');\r\n                $svg.css('display', 'none');\r\n                $image.css('display', 'inline-block');\r\n                bindControl();\r\n            };\r\n\r\n            function bindControl() {\r\n                var\r\n                    partyName = partyNameGetter($scope),\r\n                    partyId = partyIdGetter($scope),\r\n                    id = idGetter($scope),\r\n                    type = typeGetter($scope);\r\n\r\n                $iconTask.css('display', 'none');\r\n                $iconFilm.css('display', 'none');\r\n                $iconFolder.css('display', 'none');\r\n                $defaultBlock.css('display', 'none');\r\n\r\n                // Timestamp to avoid caching images for too long\r\n                var url = pipImageUtils.getAvatarUrl(partyId, partyName, id, type, false, false);\r\n\r\n                if ((type && id && partyId) || (partyId && partyName)) {\r\n                    if (type && id && partyId) {\r\n                        if (type == 'category') return;\r\n\r\n                        if (entityTypes[type] == 'goals' || entityTypes[type] == 'areas' ) {\r\n                            $image.attr('src', url);\r\n                            $svg.css('display', 'none');\r\n                            $image.css('display', 'inline-block');\r\n                        } else {\r\n                            $defaultBlock.css('display', 'block');\r\n                            var colorClassIndex = pipStrings.hashCode(id) % colors.length;\r\n                            $element.addClass(colorClasses[colorClassIndex]);\r\n                            switch(type) {\r\n                                case 'vision':\r\n                                    $svg.css('display', 'none');\r\n                                    $iconFilm.css('display', 'inline-block');\r\n                                    $iconTask.css('display', 'none');\r\n                                    $iconFolder.css('display', 'none');\r\n                                    $image.css('display', 'none');\r\n                                    break;\r\n                                case 'event':\r\n                                    $svg.css('display', 'none');\r\n                                    $iconTask.css('display', 'inline-block');\r\n                                    $iconFilm.css('display', 'none');\r\n                                    $iconFolder.css('display', 'none');\r\n                                    $image.css('display', 'none');\r\n                                    break;\r\n                                case 'note':\r\n                                    $svg.css('display', 'none');\r\n                                    $iconFolder.css('display', 'inline-block');\r\n                                    $iconTask.css('display', 'none');\r\n                                    $iconFilm.css('display', 'none');\r\n                                    $image.css('display', 'none');\r\n                                    break;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        $image.attr('src', url);\r\n                        $svg.css('display', 'none');\r\n                        $image.css('display', 'inline-block');\r\n                    }\r\n                }\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Add image control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipAddImage\", ['pipCameraDialog', 'pipPictureUrlDialog', 'pipGallerySearchDialog', 'pipCore']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'IMAGE_GALLERY': 'Image gallery',\r\n            'FILE' : 'File',\r\n            'WEB_LINK' : 'Web link',\r\n            'CAMERA' : 'Camera'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'IMAGE_GALLERY': 'Галерея изображений',\r\n            'FILE' : 'Файл',\r\n            'WEB_LINK' : 'Веб ссылка',\r\n            'CAMERA' : 'Камера'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipAddImage', \r\n        function() {\r\n            return {\r\n                restrict: 'AC',\r\n                scope: {\r\n                    $images: '=pipImages',\r\n                    onChange: '&pipChanged',\r\n                    multi: '&pipMulti',\r\n                    ngDisabled: '&'\r\n                },\r\n                transclude: true,\r\n                templateUrl: 'add_image/add_image.html',\r\n                controller: 'pipAddImageController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipAddImageController',\r\n        ['$scope', '$element', '$mdMenu', '$timeout', 'pipCameraDialog', 'pipPictureUrlDialog', 'pipGallerySearchDialog', 'pipUtils', function ($scope, $element, $mdMenu, $timeout, pipCameraDialog, pipPictureUrlDialog, pipGallerySearchDialog, pipUtils) {\r\n\r\n            $scope.hideMenu = hideMenu;\r\n            $scope.onFileChange = onFileChange;\r\n            $scope.onWebLinkClick = onWebLinkClick;\r\n            $scope.onCameraClick = onCameraClick;\r\n            $scope.onGalleryClick = onGalleryClick;\r\n            $scope.isMulti = isMulti;\r\n\r\n            $element.click(function () {\r\n                if (!$scope.ngDisabled()) openMenu();\r\n            });\r\n\r\n            return;\r\n\r\n            function openMenu() {\r\n                $($element).find('.pip-add-image-open-button').scope().$mdOpenMenu();\r\n            }\r\n\r\n            function isMulti() {\r\n                if ($scope.multi() !== undefined)\r\n                    return  pipUtils.toBoolean($scope.multi());\r\n                else return true;\r\n            }\r\n\r\n            function hideMenu () {\r\n                $mdMenu.hide();\r\n            }\r\n\r\n            function dataURItoBlob(dataURI) {\r\n                var byteString;\r\n                \r\n                if (dataURI.split(',')[0].indexOf('base64') >= 0)\r\n                    byteString = atob(dataURI.split(',')[1]);\r\n                else\r\n                    byteString = unescape(dataURI.split(',')[1]);\r\n\r\n                var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\r\n\r\n                var ia = new Uint8Array(byteString.length);\r\n                for (var i = 0; i < byteString.length; i++) {\r\n                    ia[i] = byteString.charCodeAt(i);\r\n                }\r\n\r\n                return new Blob([ia], {type:mimeString});\r\n            }\r\n\r\n            function addImages(images) {\r\n                if (images === undefined) return;\r\n\r\n                if (Array.isArray(images)) {\r\n                    images.forEach(function (img) {\r\n                        if ($scope.onChange)\r\n                            $scope.onChange({url: img.url, file: img.file});\r\n                    });\r\n                } else {\r\n                    if ($scope.onChange)\r\n                        $scope.onChange({url: images.url, file: images.file});\r\n                }\r\n\r\n                if ($scope.$images === undefined || !Array.isArray($scope.$images))\r\n                    return;\r\n\r\n                if (Array.isArray(images)) {\r\n                    images.forEach(function (img) {\r\n                        $scope.$images.push(img.url);\r\n                    });\r\n                } else {\r\n                    $scope.$images.push(images.url);\r\n                }\r\n            }\r\n\r\n            // Process user actions\r\n\r\n            function onFileChange ($files) {\r\n                if ($files == null || $files.length == 0)\r\n                    return;\r\n\r\n                $files.forEach(function (file) {\r\n                    if (file.type.indexOf('image') > -1) {\r\n                        $timeout(function() {\r\n                            var fileReader = new FileReader();\r\n                            fileReader.readAsDataURL(file);\r\n                            fileReader.onload = function(e) {\r\n                                $timeout(function() {\r\n                                    addImages({url: e.target.result, file: file});\r\n                                });\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            function onWebLinkClick () {\r\n                pipPictureUrlDialog.show(function (result) {\r\n                    var blob = null;\r\n                    if (result.substring(0, 10) == 'data:image') {\r\n                        blob = dataURItoBlob(result);\r\n                        blob.name = result.slice(result.lastIndexOf('/') + 1, result.length).split('?')[0];\r\n                    }\r\n                    addImages({url: result, file: blob});\r\n                });\r\n            }\r\n\r\n            function onCameraClick () {\r\n                pipCameraDialog.show(function (result) {\r\n                    var blob = dataURItoBlob(result);\r\n                    blob.name = 'camera';\r\n                    addImages({url: result, file: blob});\r\n                });\r\n            }\r\n\r\n            function onGalleryClick () {\r\n                pipGallerySearchDialog.show(function (result) {\r\n                    var imgs = [];\r\n                    result.forEach(function (url) {\r\n                        imgs.push({url: url, file: null});\r\n                    });\r\n                    addImages(imgs);\r\n                }, $scope.isMulti());\r\n            }\r\n    }]);\r\n\r\n})();\r\n\r\n\r\n","/**\r\n * @file Avatar control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Replace placeholder with default image generated on server\r\n * - Generate file url based on entity type, do not set it as full url via pipSrc\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipAvatarEdit\", ['ui.event', 'angularFileUpload', 'pipPicturePaste', 'pipRest',\r\n        'pipImageUtils', 'pipPictures.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'PICTURE_EDIT_TEXT': 'Click here to upload a picture'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'PICTURE_EDIT_TEXT': 'Нажмите сюда для загрузки картинки'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipAvatarEdit',\r\n        function() {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipPartyId: '&',\r\n                    pipEntityType: '&',\r\n                    pipId: '&',\r\n                    pipCreated: '&',\r\n                    pipChanged: '&',\r\n                    pipReset: '&'\r\n                },\r\n                templateUrl: 'picture_edit/picture_edit.html',\r\n                controller: 'pipAvatarEditController' \r\n            };\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipAvatarEditController',\r\n        ['$scope', '$element', '$attrs', '$http', '$upload', '$rootScope', 'pipPicturePaste', 'pipRest', 'pipImageUtils', function($scope, $element, $attrs, $http, $upload, $rootScope, pipPicturePaste, pipRest, pipImageUtils) {\r\n            var \r\n                $control = $element.children('.pip-picture-upload'),\r\n                $input = $control.children('input[type=file]'),\r\n                entityTypes = pipImageUtils.getEntityTypes(),\r\n                serverUrl = pipRest.serverUrl();\r\n            \r\n            $scope.text = $attrs.pipDefaultText || 'PICTURE_EDIT_TEXT'; \r\n            $scope.icon = $attrs.pipDefaultIcon || 'picture-no-border';\r\n            $scope.control = {\r\n                url: '',\r\n                progress: 0,\r\n                uploaded: false,\r\n                uploading: false,\r\n                loaded: false,\r\n\r\n                file: null,\r\n                state: 'original'\r\n            };\r\n\r\n            $scope.control.reset = reset;\r\n            $scope.control.save = save;\r\n            $scope.empty = empty;\r\n            $scope.isUpdated = isUpdated;\r\n            $scope.readItemLocally = readItemLocally;\r\n            $scope.onDeleteClick = onDeleteClick;\r\n            $scope.onKeyDown = onKeyDown;\r\n            $scope.onImageError = onImageError;\r\n            $scope.onImageLoad = onImageLoad;\r\n            $scope.onChange = onChange;\r\n\r\n            // Watching for changes\r\n            $scope.$watch($scope.pipId, function(newValue) {\r\n                if ($scope.pipReset() !== false)\r\n                    $scope.control.reset();\r\n            });\r\n\r\n            $scope.$watch($scope.pipPartyId, function(newValue) {\r\n                if ($scope.pipReset() !== false)\r\n                    $scope.control.reset();\r\n            });\r\n\r\n            $scope.$watch($scope.ngDisabled, function(newValue) {\r\n                $input.attr('disabled', $scope.control.disabled);\r\n            });\r\n\r\n            // Add paste listener\r\n            $element.children('.pip-picture-upload').focus(function () {\r\n                pipPicturePaste.addPasteListener(function (item) {\r\n                    $scope.readItemLocally(item.url, item.file);\r\n                });\r\n            });\r\n\r\n            $element.children('.pip-picture-upload').blur(function () {\r\n                pipPicturePaste.removePasteListener();\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-picture-edit');\r\n\r\n            // Execute callback\r\n            if ($scope.pipCreated) {\r\n                $scope.pipCreated({\r\n                    $event: { sender: $scope.control },\r\n                    $control: $scope.control\r\n                });\r\n            }\r\n\r\n            // Initialize control\r\n            $scope.control.reset();\r\n\r\n            return;\r\n\r\n            // --------------------------------\r\n\r\n            // Utility functions\r\n\r\n            function reset(afterDeleting) {\r\n                $scope.control.progress = 0;\r\n                $scope.control.uploading = false;\r\n                $scope.control.uploaded = false;\r\n\r\n                $scope.control.file = null;\r\n                $scope.control.state = 'original';\r\n                $scope.control.url = '';\r\n\r\n                if (!afterDeleting) {\r\n                    var url = pipImageUtils.getAvatarUrl($scope.pipPartyId(), '',\r\n                        $scope.pipId(), $scope.pipEntityType(), false, true);\r\n\r\n                    if (!url) return;\r\n\r\n                    //pipImageUtils.addHttpHeaders();\r\n                    $scope.control.progress = 0;\r\n\r\n                    $scope.control.url = url;\r\n                    $scope.control.uploaded = $scope.control.url != '';\r\n                    $scope.onChange();\r\n\r\n                } else $scope.onChange();\r\n            };\r\n\r\n            function generateUrl() {\r\n                if ($scope.pipEntityType() && $scope.pipId() && $scope.pipPartyId()) {\r\n                    return serverUrl + '/api/parties/' + $scope.pipPartyId() + '/'\r\n                        + entityTypes[$scope.pipEntityType()] + '/' + $scope.pipId() + '/avatar';\r\n                } else {\r\n                    if ($scope.pipPartyId() && !$scope.pipEntityType()) {\r\n                        if ($attrs.pipEntityType || $attrs.pipId)\r\n                            return '';\r\n                        return serverUrl + '/api/parties/' + $scope.pipPartyId()\r\n                            + '/avatar';\r\n                    }\r\n                }\r\n\r\n                return '';\r\n            }\r\n\r\n            function saveItemUrl() {\r\n                var url = $scope.control.url,\r\n                    FILE_URL = generateUrl();\r\n                var name = url.slice(url.lastIndexOf('/') + 1, url.length).split('?')[0];\r\n\r\n                return FILE_URL + '?name=' + name + '&url=' + url\r\n            };\r\n\r\n            function savePicture(successCallback, errorCallback) {\r\n                var\r\n                    control = $scope.control,\r\n                    file = control.file;\r\n\r\n                if ($scope.control.file !== null) {\r\n                    var \r\n                        fileReader = new FileReader(),\r\n                        FILE_URL = generateUrl();\r\n                        \r\n                    fileReader.onload = function (e) {\r\n                        control.uploading = true;\r\n                        var upload = $upload.http({\r\n                                url: FILE_URL + '?name=' + file.name,\r\n                                headers: { 'Content-Type': file.type },\r\n                                data: e.target.result\r\n                            })\r\n                            .then(\r\n                            function (response) {\r\n                                control.reset();\r\n                                if (successCallback) successCallback(response);\r\n                            },\r\n                            function (error) {\r\n                                control.uploading = false;\r\n                                control.upload = false;\r\n                                control.progress = 0;\r\n\r\n                                if (errorCallback) errorCallback(error);\r\n                                else console.error(error);\r\n                            },\r\n                            function (e) {\r\n                                // Math.min is to fix IE which reports 200% sometimes\r\n                                control.progress = Math.min(100, parseInt(100.0 * e.loaded / e.total));\r\n                            }\r\n                        );\r\n                    };\r\n\r\n                    fileReader.readAsArrayBuffer(file);\r\n                } else {\r\n                     var url = saveItemUrl();\r\n                     control.uploading = true;\r\n \r\n                     $http['post'](url)\r\n                         .success(function (response) {\r\n                             control.reset();\r\n \r\n                             if (successCallback) successCallback(response);\r\n                         })\r\n                         .error(function (error) {\r\n                             control.uploading = false;\r\n                             control.upload = false;\r\n \r\n                             if (errorCallback) errorCallback(error);\r\n                             else console.error(error);\r\n                         });\r\n                }\r\n            };\r\n\r\n            function deletePicture(successCallback, errorCallback) {\r\n                var control = $scope.control;\r\n                $http['delete'](generateUrl())\r\n                .success(function (data) {\r\n                    control.reset(true);\r\n\r\n                    if (successCallback) successCallback();\r\n                })\r\n                .error(function (error) {\r\n                    control.uploading = false;\r\n                    control.upload = false;\r\n                    control.progress = 0;\r\n                    //$scope.$apply();\r\n\r\n                    if (errorCallback) errorCallback(error);\r\n                    else console.error(error);\r\n                });\r\n            };\r\n\r\n            function save(successCallback, errorCallback) {\r\n                // Process changes of the image\r\n                if ($scope.control.state == 'changed') {\r\n                    savePicture(successCallback, errorCallback);\r\n                } \r\n                // Process deletion of the image\r\n                else if ($scope.control.state == 'deleted') {\r\n                    deletePicture(successCallback, errorCallback);\r\n                }\r\n                // Process if no changes were made \r\n                else {\r\n                    if (successCallback) successCallback();                            \r\n                }\r\n            };\r\n\r\n\r\n            // Visual functions\r\n            function empty() {\r\n                return $scope.control.url == '' && !$scope.control.uploading;\r\n            };\r\n\r\n            function isUpdated() {\r\n                return $scope.control.state != 'original';\r\n            };\r\n\r\n            // Process user events\r\n\r\n            function readItemLocally(url, file) {\r\n                $scope.control.file = file;\r\n                $scope.control.url = url;\r\n                $scope.control.state = 'changed';\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onDeleteClick($event) {\r\n                $event.stopPropagation();\r\n\r\n                $control.focus();\r\n\r\n                $scope.control.file = null;\r\n                $scope.control.url = '';\r\n                $scope.control.state = 'deleted';\r\n\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onKeyDown($event) {\r\n                if ($event.keyCode == 13 || $event.keyCode == 32) {\r\n                    setTimeout(function() {\r\n                        $control.trigger('click');\r\n                    }, 0);\r\n                } else if ($event.keyCode == 46 || $event.keyCode == 8) {\r\n                    $scope.control.file = null;\r\n                    $scope.control.url = '';\r\n\r\n                    $scope.control.state = 'deleted';\r\n\r\n                    $scope.onChange();\r\n                } else if ($event.keyCode == 27) {\r\n                    $scope.control.reset();\r\n                }\r\n            };\r\n\r\n            // Clean up url to remove broken icon\r\n            function onImageError($event) {\r\n                $scope.$apply(function() {\r\n                    $scope.control.url = '';\r\n                    var image = $($event.target);\r\n\r\n                    pipImageUtils.setErrorImageCSS(image, {width: 'auto', height: '100%'});\r\n                });\r\n            };\r\n\r\n            // When image is loaded resize/reposition it\r\n            function onImageLoad($event) {\r\n                var image = $($event.target);\r\n                pipImageUtils.setImageMarginCSS({clientWidth: 80, clientHeight: 80}, image);\r\n                $scope.control.uploading = false;\r\n            };\r\n\r\n            // On change event\r\n            function onChange() {\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged({\r\n                        $event: { sender: $scope.control },\r\n                        $control: $scope.control\r\n                    });\r\n                }\r\n            };\r\n        }]        \r\n    );\r\n    \r\n})();\r\n\r\n","/**\r\n * @file Camera dialog\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Add sample to sampler app\r\n */\r\n\r\n/* global angular, Webcam */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipCameraDialog',\r\n        ['ngMaterial', 'pipCore', 'pipPictures.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'TAKE_PICTURE': 'Take a picture',\r\n            'WEB_CAM_ERROR': 'Webcam is missing or was not found'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'TAKE_PICTURE': 'Сделать фото',\r\n            'WEB_CAM_ERROR': 'Web-камера отсутствует или не найдена'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipCameraDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (successCallback) {\r\n                    $mdDialog.show({\r\n                        templateUrl: 'camera_dialog/camera_dialog.html',\r\n                        clickOutsideToClose: true,\r\n                        controller: 'pipCameraController'\r\n                    }).then(function (result) {\r\n                        Webcam.reset();\r\n                        if (successCallback) {\r\n                            successCallback(result);\r\n                        }\r\n                    }, function () {\r\n                        Webcam.reset();\r\n                    });\r\n                }\r\n            };\r\n        }]);\r\n\r\n    thisModule.controller('pipCameraController',\r\n        ['$scope', '$rootScope', '$timeout', '$mdMenu', '$mdDialog', function ($scope, $rootScope, $timeout, $mdMenu, $mdDialog) {\r\n\r\n            $scope.theme = $rootScope.$theme;\r\n            Webcam.init();\r\n\r\n            setTimeout(function () {\r\n                Webcam.attach('.camera-stream');\r\n            },0);\r\n\r\n            Webcam.on('error', function (err) {\r\n                $scope.webCamError = true;\r\n                console.error(err);\r\n            });\r\n\r\n            Webcam.set({\r\n                width: 400,\r\n                height: 300,\r\n\r\n                dest_width: 400,\r\n                dest_height: 300,\r\n\r\n                crop_width: 400,\r\n                crop_height: 300,\r\n\r\n                image_format: 'jpeg',\r\n                jpeg_quality: 90\r\n            });\r\n\r\n            //Webcam.setSWFLocation('../../../dist/webcam.swf');\r\n            Webcam.setSWFLocation('webcam.swf');\r\n\r\n            $scope.$freeze = false;\r\n\r\n            $scope.onTakePictureClick = onTakePictureClick;\r\n            $scope.onResetPicture = onResetPicture;\r\n            $scope.onCancelClick = onCancelClick;\r\n\r\n            return;\r\n\r\n            function onTakePictureClick() {\r\n                if ($scope.$freeze) {\r\n                    Webcam.snap(function(dataUri) {\r\n                        $scope.$freeze = false;\r\n                        $mdDialog.hide(dataUri);\r\n                    });\r\n                } else {\r\n                    $scope.$freeze = true;\r\n                    Webcam.freeze();\r\n                }\r\n            };\r\n\r\n            function onResetPicture() {\r\n                $scope.$freeze = false;\r\n                Webcam.unfreeze();\r\n            };\r\n\r\n            function onCancelClick() {\r\n                $mdDialog.cancel();\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Collage control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Replace placeholder with default image generated on server\r\n * - Fix resizing problem\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCollage\", ['pipCore', 'pipRest']);\r\n\r\n    thisModule.directive('pipCollage',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: false,\r\n                controller: 'pipCollageController' \r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipCollageController',\r\n        ['$scope', '$element', '$attrs', '$parse', '$rootScope', 'pipUtils', 'pipStrings', 'pipRest', 'pipImageUtils', function ($scope, $element, $attrs, $parse, $rootScope, pipUtils, pipStrings, pipRest, pipImageUtils) {\r\n            var                         \r\n                pictureIdsGetter = $attrs.pipPictureIds ? $parse($attrs.pipPictureIds) : null,\r\n                srcsGetter = $attrs.pipSrcs ? $parse($attrs.pipSrcs) : null,\r\n                uniqueCodeGetter = $attrs.pipUniqueCode ? $parse($attrs.pipUniqueCode) : null,\r\n                multipleGetter = $attrs.pipMultiple ? $parse($attrs.pipMultiple) : null,\r\n                allowOpen = pipUtils.toBoolean($attrs.pipOpen),\r\n                collageSchemes = pipImageUtils.getCollageSchemes(),\r\n                resized = 0,\r\n                $svgData = '<?xml version=\"1.0\" encoding=\"utf-8\"?>'+\r\n                    '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">'+\r\n                    '<svg version=\"1.1\"'+\r\n                    'xmlns=\"http://www.w3.org/2000/svg\"'+\r\n                    'xmlns:xlink=\"http://www.w3.org/1999/xlink\"'+\r\n                    'x=\"0px\" y=\"0px\"'+\r\n                    'viewBox=\"0 0 510 510\"'+\r\n                    'style=\"enable-background:new 0 0 515 515;\"'+\r\n                    'xml:space=\"preserve\">'+\r\n                    '<defs>'+\r\n                    '<style type=\"text/css\"><![CDATA['+\r\n                    '#symbol-picture-no-border {'+\r\n                    '        transform-origin: 50% 50%;'+\r\n                    '        transform: scale(0.6, -0.6);'+\r\n                    '    }'+\r\n                    '        ]]></style>'+\r\n                    '        </defs>'+\r\n                    '<rect x=\"0\" width=\"515\" height=\"515\"/>'+\r\n                    '<path id=\"symbol-picture-no-border\" d=\"M120 325l136-102 69 33 136-82 0-54-410 0 0 136z m341 15c0-28-23-51-51-51-29 0-52 23-52 51 0 29 23 52 52 52 28 0 51-23 51-52z\" />'+\r\n                    '</svg>';\r\n\r\n            // Add class\r\n            $element.addClass('pip-collage');\r\n\r\n            // Also optimization to avoid watch if it is unnecessary\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                if (srcsGetter) {\r\n                    $scope.$watch(srcsGetter, function (newValue) {\r\n                        //getImageUrls();\r\n                        generateContent();\r\n                    });\r\n                    $scope.$watchCollection(srcsGetter, function (newValue) {\r\n                        //getImageUrls();\r\n                        generateContent();\r\n                    });\r\n                }\r\n                else if (pictureIdsGetter) {\r\n                    $scope.$watch(pictureIdsGetter, function (newValue) {\r\n                        //getImageUrls();\r\n                        generateContent();\r\n                    });\r\n                }\r\n            }\r\n\r\n            $scope.getElementDimensions = getElementDimensions;\r\n\r\n            var update = _.debounce(calculateResize, 50);\r\n\r\n            function calculateResize() {\r\n                var ims = $element.find('img');\r\n                var i = 0;\r\n                for ( i; i < ims.length; i++ ) {\r\n                    var container = angular.element(ims[i].parentElement),\r\n                        image = angular.element(ims[i]);\r\n\r\n                    if (image.css('display') != 'none')\r\n                        pipImageUtils.setImageMarginCSS(container, image);\r\n                }\r\n\r\n                var icns = $element.find('md-icon');\r\n\r\n                var i = 0;\r\n                for ( i; i < icns.length; i++ ) {\r\n                    var container = angular.element(icns[i].parentElement),\r\n                        icn = angular.element(icns[i]);\r\n                    if (container.css('display') != 'none') {\r\n                        pipImageUtils.setIconMarginCSS(container[0], icn);\r\n                    }\r\n\r\n                }\r\n            };\r\n\r\n            $scope.$watch($scope.getElementDimensions, function (newValue, oldValue) {\r\n                if (newValue && oldValue && oldValue.h == newValue.h && oldValue.w == newValue.w) return;\r\n                calculateResize();\r\n            }, true);\r\n\r\n            generateContent();\r\n            //getImageUrls();\r\n\r\n            return;\r\n\r\n            function getElementDimensions() {\r\n                var dimension = {\r\n                    'h': $element.height(),\r\n                    'w': $element.width()\r\n                };\r\n\r\n                return dimension;\r\n            };\r\n\r\n            // Clean up url to remove broken icon\r\n            function onImageError(event) {\r\n                var \r\n                    image = $(event.target),\r\n                    container = image.parent(),\r\n                    defaultBlock = container.children('div'),\r\n                    defaultIcon = image.parent().find('md-icon');\r\n\r\n                defaultBlock.css('display', 'block');\r\n                image.css('display', 'none');\r\n                pipImageUtils.setIconMarginCSS(container[0], defaultIcon);\r\n                defaultIcon.empty().append($svgData);\r\n            };\r\n\r\n            // When image is loaded resize/reposition it\r\n            function onImageLoad($event) {\r\n                var image = $($event.target),\r\n                    container =  image.parent(),\r\n                    defaultBlock = container.children('div');\r\n\r\n                pipImageUtils.setImageMarginCSS(container, image);\r\n\r\n                defaultBlock.css('display', 'none');\r\n            };\r\n\r\n            function getScheme(count) {\r\n                var schemes = collageSchemes[count - 1];\r\n\r\n                // If nothing to choose from then return\r\n                if (schemes.length == 1) return schemes[0];\r\n\r\n                // Calculate unique had code\r\n                var uniqueCode = uniqueCodeGetter ? '' + uniqueCodeGetter($scope) : '';\r\n                var hash = pipStrings.hashCode(uniqueCode);\r\n\r\n                // Return reproducable scheme by hashcode\r\n                return schemes[hash % schemes.length];\r\n            };\r\n\r\n            function getImageUrls() {\r\n                // Simply return sources\r\n                if (srcsGetter) {\r\n                    var srcs = srcsGetter($scope);\r\n                    //generateContent();\r\n                    return _.clone(srcs);\r\n                }\r\n\r\n                // Calculate urls if picture ids are specified\r\n                if (pictureIdsGetter) {\r\n                    var\r\n                        ids = pictureIdsGetter($scope) || [],\r\n                        serverUrl = pipRest.serverUrl(),\r\n                        userId = ($rootScope.$user || {}).id,\r\n                        partyId = ($rootScope.$party || {}).id || userId,\r\n                        result = [];\r\n\r\n                    for (var i = 0; i < ids.length; i++) {\r\n                        result.push(\r\n                            serverUrl + '/api/parties/' + partyId + '/files/' + ids[i] + '/content'\r\n                        );\r\n                    }\r\n\r\n                    return result;\r\n                }\r\n\r\n                // Return an empty array otherwise\r\n                return [];\r\n            };\r\n\r\n            function generatePicture(urls, scheme) {\r\n                var \r\n                    url = urls[0],\r\n                    containerClasses = '',\r\n                    pictureClasses = '';\r\n\r\n                urls.splice(0, 1);\r\n\r\n                containerClasses += scheme.fullWidth ? ' pip-full-width' : '';\r\n                containerClasses += scheme.fullHeight ? ' pip-full-height' : '';\r\n                containerClasses += ' flex-' + scheme.flex;\r\n\r\n                pictureClasses += scheme.leftPadding ? ' pip-left' : '';\r\n                pictureClasses += scheme.rightPadding ? ' pip-right' : '';\r\n                pictureClasses += scheme.topPadding ? ' pip-top' : '';\r\n                pictureClasses += scheme.bottomPadding ? ' pip-bottom' : '';\r\n\r\n                if (allowOpen) {\r\n                    return '<a class=\"pip-picture-container' + containerClasses + '\" flex=\"' + scheme.flex + '\" '\r\n                        + 'href=\"' + url + '\"  target=\"_blank\">'\r\n                        + '<div class=\"pip-picture' + pictureClasses + '\"><img src=\"' + url + '\"/>'\r\n                        + '<div><md-icon></md-icon></div></div></a>';\r\n                }\r\n\r\n                return '<div class=\"pip-picture-container' + containerClasses + '\" flex=\"' + scheme.flex + '\">'\r\n                    + '<div class=\"pip-picture' + pictureClasses + '\"><img src=\"' + url + '\"/>'\r\n                    + '<div><md-icon></md-icon></div></div></div>';\r\n            };\r\n\r\n            function generatePictureGroup(urls, scheme) {\r\n                var classes = '', result;\r\n\r\n                classes += scheme.fullWidth ? ' pip-full-width' : '';\r\n                classes += scheme.fullHeight ? ' pip-full-height' : '';\r\n                classes += ' flex-' + scheme.flex;\r\n                classes += ' layout-' + scheme.layout;\r\n\r\n                result = '<div class=\"pip-picture-group layout' + classes + '\" flex=\"'\r\n                    + scheme.flex + '\" layout=\"' + scheme.layout + '\">';\r\n\r\n                // Generate content for children recursively\r\n                for (var i = 0; i < scheme.children.length; i++) {\r\n                    result += generate(urls, scheme.children[i]);\r\n                }\r\n\r\n                result += '</div>';\r\n                return result;\r\n            };\r\n\r\n            function generate(urls, scheme) {\r\n                if (scheme.group)\r\n                    return generatePictureGroup(urls, scheme);\r\n                return generatePicture(urls, scheme);\r\n            };\r\n\r\n            function generateContent(urls) {\r\n                // Unbind previously defined actions handlers\r\n                $element.find('img')\r\n                    .unbind('error')\r\n                    .unbind('load');\r\n\r\n                // Clean up content\r\n                $element.empty();\r\n\r\n                // Calculate list of image urls\r\n                var urls = getImageUrls();\r\n\r\n                // And exit if nothing to show\r\n                if (urls.length == 0) {\r\n                    $element.hide();\r\n                    return;\r\n                }\r\n\r\n                // Limit collage only to one element if not specified otherwise\r\n                if (urls.length > 8) {\r\n                    var multiple = multipleGetter ? multipleGetter($scope) : false;\r\n\r\n                    if (!multiple) {\r\n                        urls.length = 8;\r\n                    }\r\n                }\r\n\r\n                if (urls.length <= 8) {\r\n                    // Get scheme for visualization\r\n                    var scheme = getScheme(urls.length);\r\n\r\n                    // Generate and add content\r\n                    var html = '<div class=\"pip-collage-section\">' + generate(urls, scheme) + '</div>';\r\n                    html += '<div class=\"clearfix\"></div>';\r\n                    $element.html(html);\r\n                } else {\r\n                    var html = '';\r\n\r\n                    while (urls.length > 0) {\r\n                        var partialUrls = urls.splice(0, 8);\r\n\r\n                        // Get scheme for visualization\r\n                        var scheme = getScheme(partialUrls.length);\r\n\r\n                        // Generate and add content\r\n                        html += '<div class=\"pip-collage-section\">' + generate(partialUrls, scheme) + '</div>';\r\n                    }\r\n\r\n                    html += '<div class=\"clearfix\"></div>';\r\n                    $element.html(html);\r\n                }\r\n\r\n                // Bind events to images...\r\n                $element.find('img')\r\n                    .bind('error', onImageError)\r\n                    .bind('load', onImageLoad);\r\n\r\n                // Show the new element\r\n                $element.show();\r\n            };\r\n\r\n        }]\r\n\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Camera dialog\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Add sample to sampler app\r\n */\r\n\r\n/* global angular, Webcam */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipGallerySearchDialog',\r\n        ['ngMaterial', 'pipCore', 'pipPictures.Templates', 'pipRest']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function (pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'IMAGE_GALLERY': 'Add from image gallery',\r\n            'SEARCH_PICTURES': 'Search for pictures...'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'IMAGE_GALLERY': 'Добавить из галереи изображений',\r\n            'SEARCH_PICTURES': 'Поиск изображений...'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipGallerySearchDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (successCallback, multiple) {\r\n                    $mdDialog.show({\r\n                        templateUrl: 'gallery_search_dialog/gallery_search_dialog.html',\r\n                        clickOutsideToClose: true,\r\n                        controller: 'pipGallerySearchController',\r\n                        locals: {\r\n                            multiple: multiple\r\n                        }\r\n                    }).then(function (result) {\r\n                        if (successCallback) {\r\n                            successCallback(result);\r\n                        }\r\n                    }, function () {\r\n\r\n                    });\r\n                }\r\n            };\r\n        }]);\r\n\r\n    thisModule.controller('pipGallerySearchController',\r\n        ['$scope', '$rootScope', '$timeout', '$mdMenu', '$mdDialog', '$http', 'pipRest', 'multiple', 'pipTransaction', function ($scope, $rootScope, $timeout, $mdMenu, $mdDialog, $http, pipRest, multiple, pipTransaction) {\r\n\r\n            var prevSearch = '',\r\n                url = pipRest.serverUrl() + '/api/images/search',\r\n                images = [];\r\n\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.$serverUrl = pipRest.serverUrl();\r\n            $scope.$search = '';\r\n            $scope.$images = [];\r\n            $scope.transaction = pipTransaction('search', $scope);\r\n\r\n            $scope.onSearchClick = onSearchClick;\r\n            $scope.onKeyPress = onKeyPress;\r\n            $scope.onImageClick = onImageClick;\r\n            $scope.onAddClick = onAddClick;\r\n            $scope.onCancelClick = onCancelClick;\r\n            $scope.addButtonDisabled = addButtonDisabled;\r\n            $scope.onStopSearchClick = onStopSearchClick;\r\n\r\n            focusSearchText();\r\n\r\n            return;\r\n\r\n            function onSearchClick() {\r\n                if ($scope.transaction.busy()) return;\r\n\r\n                if ($scope.$search == '' || $scope.$search == prevSearch) return;\r\n\r\n                prevSearch = $scope.$search;\r\n                $scope.$images = [];\r\n                $scope.stop = null;\r\n                var requestUrl = url + '?q=' + $scope.$search;\r\n\r\n                var transactionId = $scope.transaction.begin('ENTERING');\r\n                if (!transactionId) return;\r\n\r\n                $http['get'](requestUrl)\r\n                    .success(function (results) {\r\n                        if ($scope.transaction.aborted(transactionId))return;\r\n\r\n\r\n                        for (var i = 0; i < results.length; i++) {\r\n                            $scope.$images.push({\r\n                                checked: false,\r\n                                url: results[i].link,\r\n                                thumbnail: results[i].thumbnail\r\n                            });\r\n                        }\r\n                        $scope.transaction.end();\r\n\r\n\r\n                    }).\r\n                    error(function (error) {\r\n                        console.error(error)\r\n                    });\r\n            }\r\n\r\n            function onStopSearchClick() {\r\n                $scope.transaction.abort();\r\n                prevSearch = '';\r\n            }\r\n\r\n            function onKeyPress($event) {\r\n                if ($event.keyCode === 13)\r\n                    $scope.onSearchClick();\r\n            }\r\n\r\n            function onImageClick(image) {\r\n                if ($scope.transaction.busy()) return;\r\n\r\n                image.checked = !image.checked;\r\n\r\n                if (multiple) {\r\n                    if (image.checked) {\r\n                        images.push(image);\r\n                    } else {\r\n                        _.remove(images, {url: image.url});\r\n                    }\r\n                } else {\r\n                    if (image.checked) {\r\n                        if (images.length > 0) {\r\n                            images[0].checked = false;\r\n                            images[0] = image;\r\n                        } else {\r\n                            images.push(image);\r\n                        }\r\n                    } else {\r\n                        images = [];\r\n                    }\r\n                }\r\n            }\r\n\r\n            function onAddClick() {\r\n                if ($scope.transaction.busy()) return;\r\n\r\n                var result = [];\r\n                images.forEach(function (image) {\r\n                    if (image.checked)\r\n                        result.push(image.url);\r\n                });\r\n                $mdDialog.hide(result);\r\n            }\r\n\r\n            function onCancelClick() {\r\n                $mdDialog.cancel();\r\n            }\r\n\r\n            function addButtonDisabled() {\r\n                return images.length == 0 || $scope.transaction.busy();\r\n            }\r\n\r\n            function focusSearchText() {\r\n                setTimeout(function () {\r\n                    var element = $('.pip-gallery-search-dialog .search-images');\r\n                    if (element.length > 0)\r\n                        element.focus();\r\n                }, 0);\r\n            }\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Picture control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Replace placeholder with default image generated on server\r\n * - Fix resizing problem\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipPicture\", ['pipCore']);\r\n\r\n    thisModule.directive('pipPicture', \r\n        function() {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    src: '&pipSrc',\r\n                    pictureId: '=pipPictureId',\r\n                    defaultIcon: '=pipDefaultIcon'\r\n                },\r\n                template: '<img ui-event=\"{ error: \\'onImageError($event)\\', load: \\'onImageLoad($event)\\' }\"/>'\r\n                          + '<div><span></span></div>',\r\n                controller: 'pipPictureController' \r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipPictureController',\r\n        ['$scope', '$element', '$attrs', '$rootScope', 'pipUtils', 'pipImageUtils', 'pipRest', function ($scope, $element, $attrs, $rootScope, pipUtils, pipImageUtils, pipRest) {\r\n            var \r\n                image = $element.children('img'),\r\n                defaultBlock = $element.children('div');\r\n\r\n            $scope.onImageError = onImageError;\r\n            $scope.onImageLoad = onImageLoad;\r\n\r\n            // Add class\r\n            $element.addClass('pip-picture');\r\n\r\n            bindControl();\r\n\r\n            // Also optimization to avoid watch if it is unnecessary\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch($scope.pictureId, function(newValue) {\r\n                    if ($scope.pictureId != newValue) bindControl();\r\n                });\r\n            }\r\n\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch($scope.src, function(newValue) {\r\n                    if ($scope.src != newValue)\r\n                      bindControl();\r\n                });\r\n            }\r\n\r\n            return;\r\n\r\n            // Clean up url to remove broken icon\r\n            function onImageError($event) {\r\n                $scope.$apply(function() {\r\n                    var image = $($event.target);\r\n\r\n                    pipImageUtils.setErrorImageCSS(image);\r\n                    defaultBlock.css('display', 'block');\r\n                });\r\n            };\r\n\r\n            // When image is loaded resize/reposition it\r\n            function onImageLoad($event) {\r\n                var image = $($event.target);\r\n                pipImageUtils.setImageMarginCSS($element, image);\r\n                defaultBlock.css('display', 'none');\r\n            };\r\n\r\n            function bindControl() {\r\n                if ($scope.pictureId) {\r\n                    var serverUrl = pipRest.serverUrl(),\r\n                        userId = ($rootScope.$user || {}).id,\r\n                        partyId = ($rootScope.$party || {}).id || userId,\r\n                        url = serverUrl + '/api/parties/' + partyId + '/files/' + $scope.pictureId + '/content';\r\n\r\n                    image.attr('src', url);\r\n                } else {\r\n                    if ($scope.src) image.attr('src', $scope.src());\r\n                    else image.attr('src', '');\r\n                }\r\n            };\r\n        }]        \r\n    ); \r\n\r\n})();\r\n\r\n","/**\r\n * @file Picture control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipPictureEdit\", ['ui.event', 'angularFileUpload', 'pipRest', 'pipPicturePaste',\r\n        'pipTranslate', 'pipPictures.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'ERROR_WRONG_IMAGE_FILE':'Incorrect image file. Please, choose another one',\r\n            'PICTURE_EDIT_TEXT': 'Click here to upload a picture'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'ERROR_WRONG_IMAGE_FILE': 'Неправильный файл с изображением. Выберете другой файл',\r\n            'PICTURE_EDIT_TEXT': 'Нажмите сюда для загрузки картинки'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipPictureEdit',\r\n        function() {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipCreated: '&',\r\n                    pipChanged: '&',\r\n                    pipReset: '&',\r\n                    pipPictureId: '=',\r\n                    pipAddedPicture: '='\r\n\r\n                },\r\n                templateUrl: 'picture_edit/picture_edit.html',\r\n                controller: 'pipPictureEditController' \r\n            };\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipPictureEditController',\r\n        ['$scope', '$element', '$attrs', '$http', '$upload', '$timeout', '$rootScope', '$parse', 'pipRest', 'pipPicturePaste', 'pipImageUtils', 'pipUtils', function($scope, $element, $attrs, $http, $upload, $timeout, $rootScope, $parse, pipRest, pipPicturePaste,\r\n                 pipImageUtils, pipUtils) {\r\n            var\r\n                $control = $element.children('.pip-picture-upload'),\r\n                $input = $control.children('input[type=file]'),\r\n                serverUrl = pipRest.serverUrl(),\r\n                fileUrl = serverUrl + \"/api/parties/\" + $rootScope.$party.id + \"/files\";\r\n\r\n            $scope.text = $attrs.pipDefaultText || 'PICTURE_EDIT_TEXT'; \r\n            $scope.icon = $attrs.pipDefaultIcon || 'picture-no-border';\r\n            $scope.pictureStartState = pipUtils.toBoolean($scope.pipAddedPicture) ? 'copied' : 'original';\r\n\r\n            $scope.control = {\r\n                url: '',\r\n                progress: 0,\r\n                uploaded: false,\r\n                uploading: false,\r\n                loaded: false,\r\n                file: null,\r\n                state: $scope.pictureStartState //'original'\r\n            };\r\n\r\n            $scope.control.reset = resetImage;\r\n            $scope.control.save = saveImage;\r\n            $scope.empty = empty;\r\n            $scope.isUpdated = isUpdated;\r\n            $scope.readItemLocally = readItemLocally;\r\n            $scope.onDeleteClick = onDeleteClick;\r\n            $scope.onKeyDown = onKeyDown;\r\n            $scope.onImageError = onImageError;\r\n            $scope.onImageLoad = onImageLoad;\r\n            $scope.onChange = onChange;\r\n\r\n            // Also optimization to avoid watch if it is unnecessary\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watch('pipPictureId', function(newValue) {\r\n                        $scope.control.reset();\r\n                });\r\n            }\r\n\r\n            $scope.$watch($scope.ngDisabled, function(newValue) {\r\n                $input.attr('disabled', $scope.control.disabled);\r\n            });\r\n\r\n            // Add paste listener\r\n            $element.children('.pip-picture-upload').focus(function () {\r\n                pipPicturePaste.addPasteListener(function (item) {\r\n                    $scope.readItemLocally(item.url, item.file);\r\n                });\r\n            });\r\n\r\n            $element.children('.pip-picture-upload').blur(function () {\r\n                pipPicturePaste.removePasteListener();\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-picture-edit');\r\n\r\n            // Initialize control\r\n            $scope.control.reset();\r\n\r\n            // Execute callback\r\n            if ($scope.pipCreated) {\r\n                $scope.pipCreated({\r\n                    $event: { sender: $scope.control },\r\n                    $control: $scope.control\r\n                });\r\n            }\r\n\r\n            return ;\r\n\r\n            function resetImage(afterDeleting) {\r\n                $scope.control.progress = 0;\r\n                $scope.control.uploading = false;\r\n                $scope.control.uploaded = false;\r\n                $scope.control.file = null;\r\n                $scope.control.state = $scope.pictureStartState; //'original';\r\n                $scope.control.url = '';\r\n                var url = '';\r\n\r\n                if (!afterDeleting) {\r\n                    if ($rootScope.$party && $rootScope.$party.id && $scope.pipPictureId) {\r\n                        url = fileUrl + '/' + $scope.pipPictureId + '/content';\r\n                    }\r\n                    if (!url) return;\r\n\r\n                    $scope.control.url = url;\r\n                    $scope.control.uploaded = true;\r\n                    $scope.onChange();\r\n                } else $scope.onChange();\r\n            };\r\n\r\n            function saveItemUrl() {\r\n                var \r\n                    url = $scope.control.url,\r\n                    name = url.slice(url.lastIndexOf('/') + 1, url.length).split('?')[0];\r\n                return fileUrl + '?name=' + name + '&url=' + url;\r\n            };\r\n\r\n            function savePicture(successCallback, errorCallback) {\r\n                var\r\n                    control = $scope.control,\r\n                    file = control.file;\r\n\r\n                if ($scope.control.file !== null) {\r\n                    var fileReader = new FileReader();\r\n                        \r\n                    fileReader.onload = function (e) {\r\n                        control.uploading = true;\r\n                //        pipImageUtils.addHttpHeaders();\r\n                        var upload = $upload.http({\r\n                                url: fileUrl + '?name=' + file.name,\r\n                                headers: { 'Content-Type': file.type },\r\n                                data: e.target.result\r\n                            })\r\n                            .then(\r\n                            function (response) {\r\n                                $scope.pipPictureId = response.data.id;\r\n                                control.reset();\r\n                                if (successCallback) successCallback(response);\r\n                            },\r\n                            function (error) {\r\n                                control.uploading = false;\r\n                                control.upload = false;\r\n                                control.progress = 0;\r\n\r\n                                if (errorCallback) errorCallback(error);\r\n                                else console.error(error);\r\n                            },\r\n                            function (e) {\r\n                                // Math.min is to fix IE which reports 200% sometimes\r\n                                control.progress = Math.min(100, parseInt(100.0 * e.loaded / e.total));\r\n                            }\r\n                        );\r\n                    };\r\n\r\n                    fileReader.readAsArrayBuffer(file);\r\n                } else {\r\n                    var url = saveItemUrl();\r\n                    control.uploading = true;\r\n\r\n     //               pipImageUtils.addHttpHeaders();\r\n                    $http['post'](url)\r\n                        .success(function (response) {\r\n                            $scope.pipPictureId = response.id;\r\n                            control.reset();\r\n\r\n                            if (successCallback) successCallback(response);\r\n                        })\r\n                        .error(function (error) {\r\n                            control.uploading = false;\r\n                            control.upload = false;\r\n\r\n                            if (errorCallback) errorCallback(error);\r\n                            else console.error(error);\r\n                        });\r\n                }\r\n\r\n            };\r\n\r\n            function deletePicture(successCallback, errorCallback) {\r\n                var control = $scope.control;\r\n                $http['delete'](fileUrl + '/' + $scope.pipPictureId)\r\n                .success(function (data) {\r\n                    $scope.pipPictureId = null;\r\n                    control.reset(true);\r\n\r\n                    if (successCallback) successCallback();\r\n                })\r\n                .error(function (error) {\r\n                    control.uploading = false;\r\n                    control.upload = false;\r\n                    control.progress = 0;\r\n\r\n                    if (errorCallback) errorCallback(error);\r\n                    else console.error(error);\r\n                });\r\n            };\r\n\r\n            function saveImage(successCallback, errorCallback) {\r\n                // Process changes of the image\r\n                if ($scope.control.state == 'changed') {\r\n                    savePicture(successCallback, errorCallback);\r\n                } \r\n                // Process deletion of the image\r\n                else if ($scope.control.state == 'deleted') {\r\n                    deletePicture(successCallback, errorCallback);\r\n                }\r\n                // Process if no changes were made \r\n                else {\r\n                    if (successCallback) successCallback();                            \r\n                }\r\n            };\r\n\r\n            // Visual functions\r\n            function empty() {\r\n                return $scope.control.url == '' && !$scope.control.uploading;\r\n            };\r\n\r\n            function isUpdated() {\r\n                return $scope.control.state != 'original';\r\n            };\r\n\r\n            // Process user events\r\n            function readItemLocally(url, file) {\r\n                $scope.control.file = file;\r\n                $scope.control.url = url;\r\n                $scope.control.state = 'changed';\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onDeleteClick($event) {\r\n                $event.stopPropagation();\r\n\r\n                $control.focus();\r\n\r\n                $scope.control.file = null;\r\n                $scope.control.url = '';\r\n                if ($scope.control.state != 'copied') $scope.control.state = 'deleted';\r\n\r\n                $scope.onChange();\r\n            };\r\n\r\n            function onKeyDown($event) {\r\n                if ($event.keyCode == 13 || $event.keyCode == 32) {\r\n                    // !! Avoid clash with $apply()\r\n                    setTimeout(function() {\r\n                        $control.trigger('click');\r\n                    }, 0);\r\n                } else if ($event.keyCode == 46 || $event.keyCode == 8) {\r\n                    $scope.control.file = null;\r\n                    $scope.control.url = '';\r\n\r\n                    $scope.control.state = 'deleted';\r\n\r\n                    $scope.onChange();\r\n                } else if ($event.keyCode == 27) {\r\n                    $scope.control.reset();\r\n                }\r\n            };\r\n\r\n            // Clean up url to remove broken icon\r\n            function onImageError($event) {\r\n                $scope.$apply(function() {\r\n                    $scope.control.url = '';\r\n\r\n                    var image = $($event.target);\r\n\r\n                    pipImageUtils.setErrorImageCSS(image, {width: 'auto', height: '100%'});\r\n                });\r\n            };\r\n\r\n            // When image is loaded resize/reposition it\r\n            function onImageLoad($event) {\r\n                var image = $($event.target);\r\n                pipImageUtils.setImageMarginCSS({clientWidth: 80, clientHeight: 80}, image);\r\n                $scope.control.uploading = false;\r\n            };\r\n\r\n            // On change event\r\n            function onChange() {\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged({\r\n                        $event: { sender: $scope.control },\r\n                        $control: $scope.control\r\n                    });\r\n                }\r\n            };\r\n\r\n        }]\r\n    );\r\n    \r\n})();\r\n\r\n","/**\r\n * @file Picture list edit control\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n * @todo\r\n * - Improve samples in sampler app\r\n * - Add animations to add/remove pictures\r\n * - ?? Replace placeholder with default image generated on server?\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipPictureListEdit\", \r\n        ['ui.event', 'angularFileUpload', 'pipCore', 'pipFocused', 'pipRest', 'pipPicturePaste']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'PICTURE_LIST_EDIT_TEXT': 'Click here to add a picture',\r\n            'ERROR_TRANSACTION_IN_PROGRESS': 'Transaction is in progress. Please, wait until it is finished or abort',\r\n            'ERROR_IMAGE_PRELOADING': 'Image loading error. The picture can not be saved'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'PICTURE_LIST_EDIT_TEXT': 'Нажмите сюда чтобы добавить картинку',\r\n            'ERROR_TRANSACTION_IN_PROGRESS': 'Транзакция еще не завершена. Подождите окончания или прервите её',\r\n            'ERROR_IMAGE_PRELOADING': 'Ошибка при загрузки картинки. Картинка не сохранена.'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipPictureListEdit', \r\n        function() {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipPictureIds: '=',\r\n                    pipAddedPicture: '=',\r\n                    ngDisabled: '&',\r\n                    pipCreated: '&',\r\n                    pipChanged: '&'\r\n                },\r\n                templateUrl: 'picture_list_edit/picture_list_edit.html',\r\n                controller: 'pipPictureListEditController' \r\n            };\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipPictureListEditController',\r\n        ['$scope', '$rootScope', '$element', '$attrs', '$parse', '$http', '$upload', '$timeout', 'pipUtils', 'pipRest', 'pipPicturePaste', 'pipImageUtils', function($scope, $rootScope, $element, $attrs, $parse, $http, $upload, $timeout, pipUtils,\r\n                 pipRest, pipPicturePaste, pipImageUtils) {\r\n                \r\n            var\r\n                $control = $element.children('.pip-picture-drop'),\r\n                itemPin = 0;\r\n\r\n            $scope.text = $attrs.pipDefaultText || 'PICTURE_LIST_EDIT_TEXT';\r\n            $scope.icon = $attrs.pipDefaultIcon || 'picture-no-border';\r\n            $scope.pipRebind = pipUtils.toBoolean($attrs.pipRebind);\r\n            $scope.pictureStartState = pipUtils.toBoolean($scope.pipAddedPicture) ? 'copied' : 'original';\r\n\r\n            $scope.control = {\r\n                uploading: 0,\r\n                items: []\r\n            };\r\n\r\n            $scope.control.reset = reset;\r\n            $scope.control.save = save;\r\n            $scope.control.abort = abort;\r\n            $scope.filterItem = function(item) {\r\n                return item.state != 'deleted';\r\n            };\r\n            $scope.readItemLocally = readItemLocally;\r\n            $scope.onSelectClick = onSelectClick;\r\n            $scope.onDeleteClick = onDeleteClick;\r\n            $scope.onKeyDown = onKeyDown;\r\n            $scope.onImageError = onImageError;\r\n            $scope.onImageLoad = onImageLoad;\r\n            $scope.onChange = onChange;\r\n\r\n            // Watch for changes\r\n            if ($scope.pipRebind) {\r\n                $scope.$watch(\r\n                    function () {\r\n                        // Todo: Optimize change tracking\r\n                        return $scope.pipPictureIds;\r\n                    },\r\n                    function (newValue) {\r\n                        $scope.control.reset();\r\n                    }\r\n                );\r\n            }\r\n\r\n            // Add paste listeners\r\n            $element.find('.pip-picture-upload').focus(function () {\r\n                pipPicturePaste.addPasteListener(function (item) {\r\n                    $scope.readItemLocally(item.url, item.file);\r\n                });\r\n            });\r\n            $element.find('.pip-picture-upload').blur(function () {\r\n                pipPicturePaste.removePasteListener();\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-picture-list-edit');\r\n\r\n            // Initialize control\r\n            $scope.control.reset();\r\n\r\n            // Execute callback\r\n            if ($scope.pipCreated) {\r\n                $scope.pipCreated({\r\n                    $event: { sender: $scope.control },\r\n                    $control: $scope.control\r\n                });\r\n            }\r\n\r\n            return;\r\n\r\n            function contentUrl(id) {\r\n                var\r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $scope.$party ? $scope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files/' + id + '/content';\r\n            }\r\n\r\n            function onImageError($event, item) {\r\n                item.error = true;\r\n            };\r\n\r\n            function getItems() {\r\n                var\r\n                    pictureIds = $scope.pipPictureIds,\r\n                    items = [];\r\n\r\n                if (pictureIds == null || pictureIds.length == 0)\r\n                    return items;\r\n\r\n                for (var i = 0; i < pictureIds.length; i++) {\r\n                    items.push({\r\n                        pin: itemPin++,\r\n                        id: pictureIds[i],\r\n                        uploading: false,\r\n                        uploaded: false,\r\n                        progress: 0,\r\n                        file: null,\r\n                        url: contentUrl(pictureIds[i]),\r\n                        state: $scope.pictureStartState //'original'\r\n                    });\r\n                }\r\n\r\n                return items;\r\n            }\r\n\r\n            function setItems() {\r\n                // Clean the array\r\n                if ($scope.pipPictureIds && $scope.pipPictureIds.length > 0)\r\n                    $scope.pipPictureIds.splice(0, $scope.pipPictureIds.length);\r\n\r\n                for (var i = 0; i < $scope.control.items.length; i++) {\r\n                    var item = $scope.control.items[i];\r\n                    if (item.id)\r\n                        $scope.pipPictureIds.push(item.id);\r\n                }\r\n            }\r\n\r\n            function reset() {\r\n                $scope.control.uploading = 0;\r\n                $scope.control.items = getItems();\r\n\r\n            }\r\n\r\n            function addItemUrl(item) {\r\n                var name = item.url.slice(item.url.lastIndexOf('/') + 1, item.url.length).split('?')[0];\r\n                var\r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $scope.$party ? $scope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files?name=' + name + '&url=' + item.url\r\n            }\r\n\r\n            function addItemUrlWithFile(item) {\r\n                var\r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $scope.$party ? $scope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files?name=' + item.file.name\r\n            }\r\n\r\n            function addItem(item, callback) {\r\n                if (item.file !== null) {\r\n                    var file = item.file;\r\n\r\n                    var fileReader = new FileReader();\r\n                    fileReader.onload = function (e) {\r\n                        if (item.uploading) return;\r\n                        item.uploading = true;\r\n                        item.upload = $upload.http({\r\n                            url: addItemUrlWithFile(item),\r\n                            headers: {'Content-Type': file.type},\r\n                            data: e.target.result\r\n                        })\r\n                            .then(\r\n                            function (response) {\r\n                                item.id = response.data ? response.data.id : null;\r\n                                item.uploaded = true;\r\n                                item.uploading = false;\r\n                                item.progress = 0;\r\n                                item.upload = null;\r\n                                item.file = null;\r\n                                item.url = contentUrl(item.id);\r\n                                item.state = 'original';\r\n\r\n                                callback();\r\n                            },\r\n                            function (error) {\r\n                                item.uploaded = false;\r\n                                item.uploading = false;\r\n                                item.progress = 0;\r\n                                item.upload = null;\r\n                                //$scope.$apply();\r\n//\r\n                                callback(error);\r\n                            },\r\n                            function (e) {\r\n                                // Math.min is to fix IE which reports 200% sometimes\r\n                                item.progress = Math.min(100, parseInt(100.0 * e.loaded / e.total));\r\n                            }\r\n                        );\r\n                    };\r\n\r\n                    fileReader.readAsArrayBuffer(file);\r\n                } else {\r\n                    var url = addItemUrl(item);\r\n                    item.uploading = true;\r\n                    $http['post'](url)\r\n                        .success(function (response) {\r\n                            item.id = response.data ? response.data.id : response.id || null;\r\n                            item.uploaded = true;\r\n                            item.uploading = false;\r\n                            item.progress = 0;\r\n                            item.upload = null;\r\n                            item.file = null;\r\n                            item.url = contentUrl(item.id);\r\n                            item.state = 'original';\r\n\r\n                            callback();\r\n                        })\r\n                        .error(function (error) {\r\n                            item.uploaded = false;\r\n                            item.uploading = false;\r\n                            item.progress = 0;\r\n                            item.upload = null;\r\n\r\n                            callback();\r\n                        });\r\n                }\r\n            }\r\n\r\n            function deleteItemUrl(item) {\r\n                var\r\n                    serverUrl = pipRest.serverUrl(),\r\n                    partyId = $scope.$party ? $scope.$party.id : pipRest.userId();\r\n\r\n                return serverUrl + '/api/parties/' + partyId + '/files/' + item.id;\r\n            }\r\n\r\n            function deleteItem(item, callback) {\r\n                var control = $scope.control;\r\n\r\n                // Avoid double transactions\r\n                if (item.upload) {\r\n                    item.upload.abort();\r\n                    item.upload = null;\r\n                }\r\n\r\n                if (item.state != 'deleted')\r\n                    return;\r\n\r\n                //pipImageUtils.addHttpHeaders();\r\n                $http['delete'](deleteItemUrl(item))\r\n                .success(function (data) {\r\n                    _.remove(control.items, {pin: item.pin});\r\n                    callback();\r\n                })\r\n                .error(function (data, status) {\r\n                    // Todo: perform a better processing\r\n                    if (data == null) {\r\n                        _.remove(control.items, {pin: item.pin});\r\n                    } else {\r\n                        item.uploaded = false;\r\n                        item.uploading = false;\r\n                        item.progress = 0;\r\n                        item.upload = null;\r\n                    }\r\n\r\n                    callback(data);\r\n                });\r\n            }\r\n\r\n            function save(successCallback, errorCallback) {\r\n                var control = $scope.control;\r\n\r\n                if (control.uploading) {\r\n                    if (errorCallback) errorCallback('ERROR_TRANSACTION_IN_PROGRESS');\r\n                    return;\r\n                }\r\n\r\n                control.error = null;\r\n                control.uploading = 0;\r\n\r\n                var onItemCallback = function(error) {\r\n                    // Storing only the first error\r\n                    if (error && !control.error) {\r\n                        control.error = error;\r\n                    }\r\n\r\n                    control.uploading--;\r\n\r\n                    // Finished uploading\r\n                    if (control.uploading == 0) {\r\n                        if (control.error) {\r\n                            if (errorCallback) errorCallback(control.error);\r\n                            else console.error(control.error);\r\n                        } else {\r\n                            setItems();\r\n                            if (successCallback) successCallback();\r\n                        }\r\n                    }\r\n                };\r\n\r\n                for (var i = 0; i < control.items.length; i++) {\r\n                    var item = control.items[i];\r\n                    if (item.state == 'added' && !item.error) {\r\n                        control.uploading++;\r\n                        addItem(item, onItemCallback);\r\n                    } else if (item.state == 'deleted') {\r\n                        control.uploading++;\r\n                        deleteItem(item, onItemCallback);\r\n                    }\r\n                }\r\n\r\n                // Nothing was uploaded\r\n                if (control.uploading == 0) {\r\n                    if (successCallback) successCallback();\r\n                }\r\n            }\r\n\r\n            function abort() {\r\n                var control = $scope.control;\r\n\r\n                for (var i = 0; i < control.items.length; i++) {\r\n                    var item = control.items[i];\r\n\r\n                    if (item.uploading) {\r\n                        if (item.upload) item.upload.abort();\r\n\r\n                        item.uploaded = false;\r\n                        item.uploading = false;\r\n                        item.progress = 0;\r\n                        item.upload = null;\r\n                    }\r\n                }\r\n\r\n                // Abort transaction\r\n                control.uploading = 0;\r\n            }\r\n\r\n            function readItemLocally(url, file) {\r\n                $scope.control.items.push({\r\n                    pin: itemPin++,\r\n                    id: null,\r\n                    uploading: false,\r\n                    uploaded: false,\r\n                    progress: 0,\r\n                    file: file,\r\n                    url: url,\r\n                    state: 'added'\r\n                });\r\n\r\n                $scope.onChange();\r\n            }\r\n\r\n            function onSelectClick($files) {\r\n                $control.focus();\r\n\r\n                if ($files == null || $files.length == 0)\r\n                    return;\r\n                for (var i = 0; i < $files.length; i++) {\r\n                    var file = $files[i];\r\n\r\n                    if (file.type.indexOf('image') > -1) {\r\n                        readItemLocally(file);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function onDeleteClick(item) {\r\n                if (item.state == 'added' || item.state == 'copied') {\r\n                    _.remove($scope.control.items, {pin: item.pin});\r\n                } else {\r\n                    item.state = 'deleted';\r\n                }\r\n\r\n                $scope.onChange();\r\n            }\r\n\r\n            function onKeyDown($event, item) {\r\n                if (item) {\r\n                    if ($event.keyCode == 46 || $event.keyCode == 8) {\r\n                        if (item.state == 'added') {\r\n                            _.remove($scope.control.items, {pin: item.pin});\r\n                        } else {\r\n                            item.state = 'deleted';\r\n                        }\r\n\r\n                        $scope.onChange();\r\n                    }\r\n                } else {\r\n                    if ($event.keyCode == 13 || $event.keyCode == 32) {\r\n                        // !! Avoid clash with $apply()\r\n                        setTimeout(function() {\r\n                            $control.trigger('click');\r\n                        }, 0);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function onImageLoad($event, item) {\r\n                item.error = false;\r\n                setTimeout(function () {\r\n                    var image = $($event.target);\r\n                    pipImageUtils.setImageMarginCSS({clientWidth: 80, clientHeight: 80}, image);\r\n                }, 250);\r\n\r\n                item.loaded = true;\r\n            }\r\n\r\n            // On change event\r\n            function onChange() {\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged({\r\n                        $event: { sender: $scope.control },\r\n                        $control: $scope.control\r\n                    });\r\n                }\r\n            }\r\n        }]\r\n        \r\n    ); \r\n\r\n})();\r\n\r\n","/**\r\n * @file Picture URL dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Add sample to sampler app\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipPictureUrlDialog',\r\n        ['ngMaterial', 'pipCore', 'pipPictures.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'PICTURE_FROM_WEBLINK': 'Add from web link',\r\n            'LINK_PICTURE': 'Link to the picture...'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'PICTURE_FROM_WEBLINK': 'Добавить из веб ссылки',\r\n            'LINK_PICTURE': 'Ссылка на изображение...'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipPictureUrlDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (successCallback) {\r\n                    $mdDialog.show({\r\n                        templateUrl: 'picture_url_dialog/picture_url_dialog.html',\r\n                        clickOutsideToClose: true,\r\n                        controller: 'pipPictureUrlDialogController'\r\n                    }).then(function (result) {\r\n                        if (successCallback) {\r\n                            successCallback(result);\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n    }]);\r\n\r\n    thisModule.controller('pipPictureUrlDialogController', \r\n        ['$scope', '$rootScope', '$timeout', '$mdMenu', '$mdDialog', 'pipImageUtils', function ($scope, $rootScope, $timeout, $mdMenu, $mdDialog, pipImageUtils) {\r\n            $scope.url = '';\r\n            $scope.invalid = true;\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.checkUrl = checkUrl;\r\n            $scope.onCancelClick = onCancelClick;\r\n            $scope.onAddClick = onAddClick;\r\n\r\n            return;\r\n\r\n            function setImageSize(img) {\r\n                var imageWidth = img.width(),\r\n                    imageHeight = img.height();\r\n\r\n                var cssParams = {};\r\n\r\n                if ((imageWidth) > (imageHeight)) {\r\n                    cssParams['width'] = '250px';\r\n                    cssParams['height'] = 'auto';\r\n                } else {\r\n                    cssParams['width'] = 'auto';\r\n                    cssParams['height'] = '250px';\r\n                }\r\n\r\n                img.css(cssParams);\r\n            }\r\n\r\n            function checkUrl() {\r\n                var img = $(\"img#url_image\")\r\n                    .on('error', function () {\r\n                        $scope.invalid = true;\r\n                        $scope.$apply();\r\n                    })\r\n                    .on('load', function () {\r\n                        $scope.invalid = false;\r\n                        setImageSize(img);\r\n                        $scope.$apply();\r\n                    })\r\n                    .attr(\"src\", $scope.url);\r\n            };\r\n            \r\n            function onCancelClick() {\r\n                $mdDialog.cancel();\r\n            };\r\n            \r\n            function onAddClick() {\r\n                $mdDialog.hide($scope.url);\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Picture paste service\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global $, angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipPicturePaste', []);\r\n\r\n    thisModule.factory('pipPicturePaste', ['$timeout', function ($timeout) {\r\n        var paste = {};\r\n        var pasteCatcher = null;\r\n\r\n        paste.addPasteListener = function (onPaste) {\r\n            if (!window.Clipboard) {\r\n                if (pasteCatcher !== null) this.removePasteElement();\r\n\r\n                pasteCatcher = document.createElement(\"div\");\r\n\r\n                // Firefox allows images to be pasted into contenteditable elements\r\n                pasteCatcher.setAttribute(\"contenteditable\", \"true\");\r\n\r\n                // We can hide the element and append it to the body,\r\n                //pasteCatcher.style.opacity = 0;\r\n                $(pasteCatcher).css({\r\n                    \"position\": \"absolute\",\r\n                    \"left\": \"-999\",\r\n                    width: \"0\",\r\n                    height: \"0\",\r\n                    \"overflow\": \"hidden\",\r\n                    outline: 0\r\n                });\r\n\r\n                document.body.appendChild(pasteCatcher);\r\n            }\r\n\r\n            $(document).on('paste', function (event) {\r\n                if (event.clipboardData == null && event.originalEvent) {\r\n                    event = event.originalEvent;\r\n                }\r\n\r\n                // Paste for chrome\r\n                if (event.clipboardData) {\r\n                    var items = event.clipboardData.items;\r\n\r\n                    _.each(items, function (item) {\r\n                        if (item.type.indexOf(\"image\") != -1) {\r\n                            var file = item.getAsFile();\r\n\r\n                            var fileReader = new FileReader();\r\n                            fileReader.onload = function (e) {\r\n                                $timeout(function () {\r\n                                    onPaste({url: e.target.result, file: file});\r\n                                });\r\n                            };\r\n                            fileReader.readAsDataURL(file);\r\n                        }\r\n                    });\r\n                }\r\n                // Paste for IE\r\n                else if (window.clipboardData && window.clipboardData.files) {\r\n                    _.each(window.clipboardData.files, function (file) {\r\n                        var fileReader = new FileReader();\r\n                        fileReader.onload = function (e) {\r\n                            $timeout(function () {\r\n                                onPaste({url: e.target.result, file: file});\r\n                            });\r\n                        };\r\n                        fileReader.readAsDataURL(file);\r\n                    });\r\n                }\r\n            });\r\n        };\r\n\r\n        paste.removePasteListener = function () {\r\n            if (!window.Clipboard) {\r\n                if (pasteCatcher !== null) {\r\n                    document.body.removeChild(pasteCatcher);\r\n                    pasteCatcher = null;\r\n                }\r\n            }\r\n            $(document).off('paste');\r\n        };\r\n\r\n        return paste;\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Areas data cache\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipImageUtils', []);\r\n\r\n    thisModule.service('pipImageUtils',\r\n        ['$http', 'pipStrings', '$rootScope', 'pipRest', function($http, pipStrings, $rootScope, pipRest) {\r\n\r\n            var\r\n                colorClasses = [\r\n                    'pip-avatar-color-0', 'pip-avatar-color-1', 'pip-avatar-color-2', 'pip-avatar-color-3',\r\n                    'pip-avatar-color-4', 'pip-avatar-color-5', 'pip-avatar-color-6', 'pip-avatar-color-7',\r\n                    'pip-avatar-color-8', 'pip-avatar-color-9', 'pip-avatar-color-10', 'pip-avatar-color-11',\r\n                    'pip-avatar-color-12', 'pip-avatar-color-13', 'pip-avatar-color-14', 'pip-avatar-color-15'\r\n                ],\r\n\r\n                colors = [\r\n                    'rgba(239,83,80,1)', 'rgba(236,64,122,1)', 'rgba(171,71,188,1)',\r\n                    'rgba(126,87,194,1)', 'rgba(92,107,192,1)', 'rgba(3,169,244,1)',\r\n                    'rgba(0,188,212,1)', 'rgba(0,150,136,1)', 'rgba(76,175,80,1)',\r\n                    'rgba(139,195,74,1)', 'rgba(205,220,57,1)', 'rgba(255,193,7,1)',\r\n                    'rgba(255,152,0,1)', 'rgba(255,87,34,1)', 'rgba(121,85,72,1)',\r\n                    'rgba(96,125,139,1)'\r\n                ],\r\n\r\n                entityTypes = {\r\n                    goal: 'goals',\r\n                    objective: 'goals',\r\n                    dream: 'goals',\r\n                    accomplishment: 'goals',\r\n                    area: 'areas',\r\n                    overall: 'visions',\r\n                    vision: 'visions',\r\n                    event: 'events',\r\n                    instance: 'events'\r\n                },\r\n\r\n                collageSchemes = [\r\n                    // 1\r\n                    [\r\n                        { flex: 100, fullWidth: true, fullHeight: true }\r\n                    ],\r\n                    // 2\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 50, fullHeight: true, rightPadding: true },\r\n                                { flex: 50, fullHeight: true, leftPadding: true }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 3\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 33, fullHeight: true, rightPadding: true },\r\n                                { flex: 33, fullHeight: true, leftPadding: true, rightPadding: true },\r\n                                { flex: 33, fullHeight: true, leftPadding: true }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 50, fullHeight: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, leftPadding: true, bottomPadding: true },\r\n                                        { flex: 50, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 70, fullHeight: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 30,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, leftPadding: true, bottomPadding: true },\r\n                                        { flex: 50, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 50, fullWidth: true, bottomPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, rightPadding: true, topPadding: true },\r\n                                        { flex: 50, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 4\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 50, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 30, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 70,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 100, fullWidth: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 33, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 5\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 33, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 50, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                            ]\r\n                                        },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 33, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 67,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                            ]\r\n                                        },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 100, fullWidth: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 6\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 33, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 33, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 33, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 67,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                                { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                            ]\r\n                                        },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 50, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 7\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 33, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 33, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 50, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            group: true,\r\n                            layout: 'row',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            children: [\r\n                                { flex: 25, fullWidth: true, rightPadding: true },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'column',\r\n                                    flex: 75,\r\n                                    fullHeight: true,\r\n                                    children: [\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                            ]\r\n                                        },\r\n                                        {\r\n                                            group: true,\r\n                                            layout: 'row',\r\n                                            flex: 50,\r\n                                            fullHeight: true,\r\n                                            children: [\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                                { flex: 33, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                            ]\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    // 8\r\n                    [\r\n                        {\r\n                            group: true,\r\n                            layout: 'column',\r\n                            flex: 100,\r\n                            fullHeight: true,\r\n                            fullWidth: true,\r\n                            children: [\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullWidth: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, bottomPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, bottomPadding: true }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    group: true,\r\n                                    layout: 'row',\r\n                                    flex: 50,\r\n                                    fullWidth: true,\r\n                                    children: [\r\n                                        { flex: 25, fullWidth: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, rightPadding: true, topPadding: true },\r\n                                        { flex: 25, fullWidth: true, leftPadding: true, topPadding: true }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                ];\r\n\r\n\r\n            return {\r\n                getColorClasses: getColorClasses,\r\n                getAvatarColors: getAvatarColors,\r\n                getEntityTypes: getEntityTypes,\r\n                setErrorImageCSS: setErrorImageCSS,\r\n                setImageMarginCSS: setImageMarginCSS,\r\n                setIconMarginCSS: setIconMarginCSS,\r\n                getAvatarUrl: getAvatarUrl,\r\n                bindFile: bindFile,\r\n                getCollageSchemes: getCollageSchemes\r\n            };\r\n\r\n            function getEntityTypes() {\r\n                return entityTypes;\r\n            };\r\n\r\n            function getColorClasses() {\r\n                return colorClasses;\r\n            };\r\n\r\n            function getAvatarColors() {\r\n                return colors;\r\n            };\r\n\r\n            function getCollageSchemes() {\r\n                return collageSchemes;\r\n            };\r\n\r\n            function getAvatarUrl(partyId, partyName, id, type, noRedirect, noDefault) {\r\n                var\r\n                    timestamp = Math.floor(new Date().getTime() / 1000) * 1000,\r\n                    colorClassIndex = pipStrings.hashCode(id) % colors.length,\r\n                    chr = null,\r\n                    url = null, default_template = '',\r\n                    serverUrl = pipRest.serverUrl();\r\n\r\n                noRedirect = noRedirect && noRedirect === true ? '&no_redirect=true' : '';\r\n                if ((type && id && partyId) || (partyId)) {\r\n                    if (type && id && partyId) {\r\n                        if (type == 'category') return;\r\n                        if (!noDefault) default_template = 'default_template='\r\n                        + type + '&bg=' + colors[colorClassIndex]\r\n                        + '&fg=white&';\r\n                        if (entityTypes[type] == 'goals' || entityTypes[type] == 'areas' ) {\r\n                            url = serverUrl + '/api/parties/' + partyId + '/' + entityTypes[type]\r\n                            + '/' + id + '/avatar?' + default_template + 'timestamp=' + timestamp\r\n                            + '&obj_id=' + id + noRedirect;\r\n                        }\r\n                    } else if (partyId && partyName) {\r\n                        colorClassIndex = pipStrings.hashCode(partyId) % colors.length;\r\n                        chr = (partyName[0] || '?').toUpperCase();\r\n                        if (!noDefault) default_template = 'default_template=letter&bg=' + colors[colorClassIndex]\r\n                        + '&fg=white&chr=' + chr + '&';\r\n                        url = serverUrl + '/api/parties/' + partyId\r\n                        + '/avatar?' + default_template + 'timestamp=' + timestamp + '&obj_id=' + partyId + noRedirect;\r\n                    } else if (partyId && (!type && !id)) {\r\n                        url = serverUrl + '/api/parties/' + partyId\r\n                        + '/avatar?timestamp=' + timestamp + '&obj_id=' + partyId + noRedirect;\r\n                    }\r\n                }\r\n\r\n                return url;\r\n            };\r\n\r\n            function bindFile(imageId, successCallback, errorCallback) {\r\n                var url,\r\n                    userId = ($rootScope.$user || {}).id,\r\n                    partyId = ($rootScope.$party || {}).id || userId,\r\n                    fileUrl = pipRest.serverUrl() + \"/api/parties/\" + partyId + \"/files/\" + imageId;\r\n\r\n                //if (addHttpHeaders() && fileUrl)\r\n                if (fileUrl)\r\n                    $http.get(fileUrl)\r\n                        .success(function (response) {\r\n                            url = response && response.url ? response.url : '';\r\n\r\n                            if (successCallback) successCallback(url);\r\n                        })\r\n                        .error(function (error) {\r\n                            if (errorCallback) errorCallback(error);\r\n                        });\r\n            };\r\n\r\n            function setErrorImageCSS(image, params) {\r\n                var cssParams = {\r\n                    'width': '',\r\n                    'margin-left': '',\r\n                    'height': '',\r\n                    'margin-top': ''\r\n                };\r\n\r\n                if (params) cssParams = _.assign(cssParams, params);\r\n\r\n                if (image)  image.css(cssParams);\r\n            };\r\n\r\n            function setImageMarginCSS($element, image, params) {\r\n                var\r\n                    containerWidth = $element.width ? $element.width() : $element.clientWidth, // || 80,\r\n                    //containerWidth = $element.clientWidth ? $element.clientWidth : $element.width, // || 80,\r\n                    //containerHeight = $element.clientHeight ? $element.clientHeight : $element.height, // || 80,\r\n                    containerHeight = $element.height ? $element.height() : $element.clientHeight, // || 80,\r\n                    imageWidth = image[0].naturalWidth || image.width,\r\n                    imageHeight = image[0].naturalHeight || image.height,\r\n                    margin = 0;\r\n                var cssParams = {};\r\n\r\n                if ((imageWidth / containerWidth) > (imageHeight / containerHeight)) {\r\n                    margin = -((imageWidth / imageHeight * containerHeight - containerWidth) / 2);\r\n                    cssParams['margin-left'] = '' + margin + 'px';\r\n                    cssParams['height'] = '' + containerHeight + 'px';//'100%';\r\n                    cssParams['width'] = '' + imageWidth * containerHeight/imageHeight + 'px';//'100%';\r\n                    cssParams['margin-top'] = '';\r\n                } else {\r\n                    margin = -((imageHeight / imageWidth * containerWidth - containerHeight) / 2);\r\n                    cssParams['margin-top'] = '' + margin + 'px';\r\n                    cssParams['height'] = '' + imageHeight * containerWidth/imageWidth + 'px';//'100%';\r\n                    cssParams['width'] = '' + containerWidth + 'px';//'100%';\r\n                    cssParams['margin-left'] = '';\r\n                }\r\n\r\n                if (params) cssParams = _.assign(cssParams, params);\r\n\r\n                image.css(cssParams);\r\n            };\r\n\r\n            function setIconMarginCSS(container, icon) {\r\n                var\r\n                    containerWidth = container.clientWidth ? container.clientWidth : container.width,\r\n                    containerHeight = container.clientHeight ? container.clientHeight : container.height,\r\n                    margin = 0,\r\n                    iconSize = containerWidth > containerHeight ? containerHeight : containerWidth;\r\n\r\n                var cssParams = {\r\n                    'width': '' + iconSize + 'px',\r\n                    'margin-left': '',\r\n                    'height': '' + iconSize + 'px',\r\n                    'margin-top': ''\r\n                };\r\n\r\n                if ((containerWidth) > (containerHeight)) {\r\n                    margin = ((containerWidth - containerHeight) / 2);\r\n                    cssParams['margin-left'] = '' + margin + 'px';\r\n                } else {\r\n                    margin = ((containerHeight - containerWidth) / 2);\r\n                    cssParams['margin-top'] = '' + margin + 'px';\r\n                }\r\n\r\n                icon.css(cssParams);\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Registration of composite WebUI controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipComposite', [        \r\n        'pipContentSwitch',\r\n        'pipChecklistEdit',\r\n        'pipChecklistView',\r\n        'pipCompositeEdit',\r\n        'pipCompositeView',\r\n        'pipCompositeSummary',\r\n        'pipCompositeToolbar',\r\n        'pipCompositeFocused',\r\n\r\n        'pipMobileMouseup',\r\n        'pipMobileMousedown'\r\n    ]);\r\n    \r\n})();\r\n\r\n\r\n","(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('checklist_edit/checklist_edit.html',\n    '<!--\\n' +\n    '@file Checklist edit control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div ng-class=\"{\\'pip-checklist-draggable\\': selected.drag}\" id=\"{{\\'checklist-\\'  + selected.id}}\">\\n' +\n    '    <div ng-repeat=\"item in checklistContent\"\\n' +\n    '         ng-mousedown=\"onClick($event, $index)\"\\n' +\n    '         class=\"pip-checklist-item\"\\n' +\n    '         id=\"{{\\'check-item-\\'  + selected.id + \\'-\\' +  $index}}\"\\n' +\n    '         pip-drag=\"checklistContent.length > 1 && selected.drag && !item.empty\"\\n' +\n    '         pip-drag-data=\"item\"\\n' +\n    '         pip-force-touch = \"true\"\\n' +\n    '         pip-touch-delay=\"30\"\\n' +\n    '         pip-drop=\"true\"\\n' +\n    '         pip-drag-stop=\"onStop(selected.id)\"\\n' +\n    '         pip-drag-start=\"onStart(selected.id)\"\\n' +\n    '         pip-scroll-container=\"pipScrollContainer\"\\n' +\n    '         pip-drop-success=\"onDropComplete($index, $data, $event, selected.id)\">\\n' +\n    '\\n' +\n    '        <div ng-class=\"{\\'put_place\\': selected.drag}\"></div>\\n' +\n    '        <div class=\"pip-checklist-item-body\"\\n' +\n    '             pip-cancel-drag=\"true\"\\n' +\n    '             ng-class=\"{ \\'select-active-item\\': isSelectedItem($index) }\"\\n' +\n    '                layout=\"row\" layout-align=\"start start\">\\n' +\n    '\\n' +\n    '            <div class=\"pip-checklist-button\"  pip-cancel-drag=\"true\">\\n' +\n    '                <md-button pip-drag-handle\\n' +\n    '                           class=\"pip-icon-checklist-button md-icon-button no-ripple-container\"\\n' +\n    '                           aria-label=\"REARRANGE\"\\n' +\n    '                           tabindex=\"-1\"\\n' +\n    '                           pip-mobile-mousedown=\"onDownDragg(item)\"\\n' +\n    '                           pip-mobile-mouseup=\"onDraggEnd()\"\\n' +\n    '                           ng-if=\"pipDraggable && checklistContent.length > 2 && !item.empty\"\\n' +\n    '                           ng-class=\"checklistContent.length > 1 ? \\'cursor-move\\' : \\'cursor-default\\'\"\\n' +\n    '                           ng-disabled=\"ngDisabled()\">\\n' +\n    '                    <md-icon class=\"text-grey\" md-svg-icon=\"icons:vhandle\"></md-icon>\\n' +\n    '                </md-button>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-checklist-button\" style=\"overflow: hidden\"  pip-cancel-drag=\"true\">\\n' +\n    '                <div class=\"pip-checklist-button-container\">\\n' +\n    '                    <md-button class=\"pip-icon-checklist-button md-icon-button\"\\n' +\n    '                               ng-show=\"item.empty\"\\n' +\n    '                               ng-disabled=\"ngDisabled()\"\\n' +\n    '                               md-ink-ripple\\n' +\n    '                               ng-click=\"onAddItem()\"\\n' +\n    '                               tabindex=\"-1\"\\n' +\n    '                               aria-label=\"PLUS\">\\n' +\n    '                        <md-icon class=\"text-grey\" md-svg-icon=\"icons:plus\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                    <md-checkbox ng-model=\"item.checked\"\\n' +\n    '                                 ng-show=\"!item.empty\"\\n' +\n    '                                 aria-label=\"COMPLETE\"\\n' +\n    '                                 pip-cancel-drag=\"true\"\\n' +\n    '                                 ng-focus=\"onItemFocus($index)\"\\n' +\n    '                                 ng-change=\"onChecked(item)\"\\n' +\n    '                                 ng-disabled=\"ngDisabled()\">\\n' +\n    '                    </md-checkbox>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-checklist-text\" flex  pip-cancel-drag=\"true\">\\n' +\n    '                <md-input-container md-no-float flex >\\n' +\n    '                    <textarea ng-model=\"item.text\"\\n' +\n    '                              name=\"{{\\'text\\' + $index}}\"\\n' +\n    '                              aria-label=\"TEXT\"\\n' +\n    '                              class=\"pip-text-checkbox\"\\n' +\n    '                              ng-focus=\"onItemFocus($index)\"\\n' +\n    '                              ng-change=\"onChangeItem($index)\"\\n' +\n    '                              ng-keydown=\"onTextareaKeyDown($event, $index, item)\"\\n' +\n    '                              placeholder=\"{{::\\'TEXT\\' | translate}}\"\\n' +\n    '                              id=\"{{\\'check-item-text-\\' + selected.id + \\'-\\' + $index}}\"\\n' +\n    '                              ng-disabled=\"ngDisabled()\">\\n' +\n    '                    </textarea>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-checklist-button\"  pip-cancel-drag=\"true\">\\n' +\n    '                <md-button class=\"pip-icon-checklist-button md-icon-button\" md-ink-ripple\\n' +\n    '                           ng-click=\"onDeleteItem($index, item)\"\\n' +\n    '                           ng-disabled=\"ngDisabled()\"\\n' +\n    '                           tabindex=\"-1\"\\n' +\n    '                           ng-focus=\"onItemFocus($index)\"\\n' +\n    '                           ng-show=\"isSelectedItem($index)\"\\n' +\n    '                           aria-label=\"DELETE-ITEM\">\\n' +\n    '                    <md-icon class=\"text-grey\" md-svg-icon=\"icons:cross-circle\"></md-icon>\\n' +\n    '                </md-button>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '\\n' +\n    '    <div id=\"{{\\'check-item-empty-\\' + selected.id}}\"\\n' +\n    '         class=\"pip-empty-text\"\\n' +\n    '         pip-drag=\"false\"\\n' +\n    '         pip-drop=\"true\"\\n' +\n    '         pip-drop-success=\"onDropComplete(checklistContent.length, $data, $event, selected.id)\">\\n' +\n    '        <div ng-class=\"{\\'put_place\\': selected.drag}\"></div>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('checklist_view/checklist_view.html',\n    '<div ng-repeat=\"item in checklistContent track by $index\">\\n' +\n    '    <div class=\"pip-checklist-item\" layout=\"row\" layout-align=\"start start\">\\n' +\n    '        <div class=\"pip-checklist-icon\">\\n' +\n    '            <md-checkbox  ng-model=\"item.checked\"\\n' +\n    '                          ng-click=\"onClick($event, item)\"\\n' +\n    '                          aria-label=\"COMPLETE\"\\n' +\n    '                          ng-disabled=\"ngDisabled()\">\\n' +\n    '            </md-checkbox>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-checklist-text\"  flex>\\n' +\n    '            <pip-markdown pip-text=\"item.text\"\\n' +\n    '                          pip-rebind=\"true\"\\n' +\n    '                          ng-disabled=\"true\">\\n' +\n    '            </pip-markdown>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('composite_edit/composite_edit.html',\n    '<!--\\n' +\n    '@file Composite edit control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"divider-top\">\\n' +\n    '    <div class=\"pip-composite-body\"\\n' +\n    '         ng-show=\"compositeContent.length != 0\"\\n' +\n    '         ng-class=\"{\\'drag-active\\': selected.drag}\">\\n' +\n    '\\n' +\n    '        <div class=\"pip-composite-item\"\\n' +\n    '             ng-repeat=\"obj in compositeContent track by obj.id\"\\n' +\n    '             ng-mousedown=\"onClick($event, $index, obj)\"\\n' +\n    '             ng-class=\"{\\'selected-content\\': isSelectedSection($index, obj),\\n' +\n    '                        \\'composite-animate\\': !obj.empty && compositeContent.length > 1}\"\\n' +\n    '             ng-keyup=\"onKeyUp($event)\"\\n' +\n    '             ng-keydown=\"onKeyDown($event, $index, obj)\"\\n' +\n    '             pip-drag=\"compositeContent.length > 1 && selected.drag\"\\n' +\n    '             pip-touch-delay=\"10\"\\n' +\n    '             pip-drag-data=\"obj\"\\n' +\n    '             pip-scroll-container=\"pipScrollContainer\"\\n' +\n    '             pip-drop=\"true\"\\n' +\n    '             pip-force-touch = \"true\"\\n' +\n    '             pip-drag-stop=\"onStop(selected.id)\"\\n' +\n    '             pip-drag-start=\"onStart(selected.id)\"\\n' +\n    '             pip-drop-success=\"onDropComplete($index, $data, $event, selected.id)\"\\n' +\n    '             id=\"{{\\'composite-item-\\' + selected.id + \\'-\\' + $index}}\">\\n' +\n    '\\n' +\n    '            <!--<div ng-class=\"{\\'putt_box\\': selected.drag}\"></div>-->\\n' +\n    '            <div class=\"putt_box\"></div>\\n' +\n    '            <div class=\"pip-section-header\"\\n' +\n    '                 ng-if=\"!obj.empty\"\\n' +\n    '                 layout=\"row\" layout-align=\"start center\">\\n' +\n    '                <div class=\"w38\"></div>\\n' +\n    '                <md-button class=\"md-icon-button md-icon-button-little icon-rearrange-btn no-ripple-container rm8 cursor-move\"\\n' +\n    '                           ng-if=\"!ngDisabled() && compositeContent.length > 1\"\\n' +\n    '                           pip-drag-handle\\n' +\n    '                           pip-mobile-mousedown=\"onDownDragg($event, obj)\"\\n' +\n    '                           pip-mobile-mouseup=\"onDraggEnd()\"\\n' +\n    '                           tabindex=\"-1\"\\n' +\n    '                           aria-label=\"COMPOSITE-DRAGG\"\\n' +\n    '                           ng-hide=\"compositeContent.length == 1\">\\n' +\n    '                    <md-icon class=\"composite-icon cursor-move\" md-svg-icon=\"icons:handle\"></md-icon>\\n' +\n    '                </md-button>\\n' +\n    '                <div>\\n' +\n    '                    <md-button class=\"md-icon-button md-icon-button-little rm8\"\\n' +\n    '                               ng-click=\"onDeleteItem($index)\"\\n' +\n    '                               ng-disabled=\"ngDisabled()\"\\n' +\n    '                               aria-label=\"COMPOSITE-DELETE\">\\n' +\n    '                        <md-icon class=\"composite-icon\" md-svg-icon=\"icons:cross\"></md-icon>\\n' +\n    '                    </md-button>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <!--pip-prevent-drag-->\\n' +\n    '            <!-- for text -->\\n' +\n    '            <div class=\"pip-section-content rp24-flex lp24-flex tp16 bp16\"\\n' +\n    '                 ng-if=\"obj.type == \\'text\\'\" pip-cancel-drag=\"true\">\\n' +\n    '                <md-input-container class=\"p0 m0 w-stretch\" md-no-float>\\n' +\n    '                            <textarea ng-model=\"obj.text\" aria-label=\"text\"\\n' +\n    '                                      placeholder=\"{{ isFirst ? compositePlaceholder : \\'TEXT\\' | translate}}\"\\n' +\n    '                                      id=\"{{\\'composite-item-text-\\' + selected.id + \\'-\\' + $index}}\"\\n' +\n    '                                      ng-change=\"onContentChange(obj)\"\\n' +\n    '                                      pip-cancel-drag=\"true\"\\n' +\n    '                                      ng-disabled=\"ngDisabled()\">\\n' +\n    '                            </textarea>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '            <!-- -->\\n' +\n    '            <div class=\"pip-section-content rp24-flex lp24-flex vp20\"\\n' +\n    '                 ng-if=\"obj.type == \\'pictures\\'\" pip-cancel-drag=\"true\">\\n' +\n    '                <pip-picture-list-edit class=\"w-stretch\"\\n' +\n    '                                       pip-cancel-drag=\"true\"\\n' +\n    '                                       pip-picture-ids=\"obj.pic_ids\"\\n' +\n    '                                       pip-changed=\"onContentChange(obj)\"\\n' +\n    '                                       pip-created=\"obj.pictures = $event.sender\"\\n' +\n    '                                       pip-cancel-drag=\"true\"\\n' +\n    '                                       pip-added-picture=\"addedContent\"\\n' +\n    '                                       ng-disabled=\"ngDisabled()\">\\n' +\n    '                </pip-picture-list-edit>\\n' +\n    '            </div>\\n' +\n    '            <!-- -->\\n' +\n    '            <div class=\"pip-section-content rp24-flex lp24-flex vp20\"\\n' +\n    '                 ng-if=\"obj.type == \\'documents\\'\" pip-cancel-drag=\"true\">\\n' +\n    '                <pip-document-list-edit class=\"w-stretch\"\\n' +\n    '                                        pip-documents=\"obj.docs\"\\n' +\n    '                                        pip-cancel-drag=\"true\"\\n' +\n    '                                        pip-changed=\"onContentChange(obj)\"\\n' +\n    '                                        pip-cancel-drag=\"true\"\\n' +\n    '                                        pip-created=\"obj.documents = $event.sender\"\\n' +\n    '                                        pip-added-document=\"addedContent\"\\n' +\n    '                                        ng-disabled=\"ngDisabled()\">\\n' +\n    '                </pip-document-list-edit>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"pip-section-content\"\\n' +\n    '                 ng-if=\"obj.type == \\'checklist\\'\" pip-cancel-drag=\"true\"\\n' +\n    '                 layout=\"row\" layout-align=\"start center\">\\n' +\n    '                <pip-checklist-edit pip-options=\"obj.checklist\"\\n' +\n    '                                    pip-draggable=\"isActiveChecklist(obj)\"\\n' +\n    '                                    pip-changed=\"onContentChange(obj)\"\\n' +\n    '                                    ng-disabled=\"ngDisabled()\"\\n' +\n    '                                    pip-scroll-container=\"{{pipScrollContainer}}\"\\n' +\n    '                                    pip-rebind=\"true\">\\n' +\n    '                </pip-checklist-edit>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"pip-section-content vp20 rp24-flex lp24-flex\"\\n' +\n    '                 ng-if=\"obj.type == \\'location\\'\" pip-cancel-drag=\"true\">\\n' +\n    '                <pip-location-edit class=\"pip-location-attachments w-stretch\"\\n' +\n    '                                   pip-location-name=\"obj.loc_name\"\\n' +\n    '                                   pip-location-pos=\"obj.loc_pos\"\\n' +\n    '                                   pip-cancel-drag=\"true\"\\n' +\n    '                                   pip-location-holder=\"pipLocationHolder\"\\n' +\n    '                                   pip-changed=\"onContentChange(obj)\"\\n' +\n    '                                   ng-disabled=\"ngDisabled()\">\\n' +\n    '                </pip-location-edit>\\n' +\n    '            </div>\\n' +\n    '            <!-- -->\\n' +\n    '            <div class=\"pip-section-content bp16-flex rp24-flex lp24-flex tp20\"\\n' +\n    '                 ng-if=\"obj.type == \\'time\\'\" pip-cancel-drag=\"true\">\\n' +\n    '                <pip-time-edit class=\"w-stretch\"\\n' +\n    '                               pip-start-date=\"obj.start\"\\n' +\n    '                               pip-end-date=\"obj.end\"\\n' +\n    '                               pip-size=\"$sizeGtSmall\"\\n' +\n    '                               pip-changed=\"onContentChange(obj)\"\\n' +\n    '                               ng-disabled=\"ngDisabled()\"\\n' +\n    '                               pip-start-label=\"{{ \\'COMPOSITE_START_TIME\\' | translate }}\"\\n' +\n    '                               pip-end-label=\"{{ \\'COMPOSITE_END_TIME\\' | translate }}\">\\n' +\n    '                </pip-time-edit>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-composite-item w-stretch\"\\n' +\n    '             pip-drag=\"false\"\\n' +\n    '             pip-drop=\"true\"\\n' +\n    '             pip-drop-success=\"onDropComplete(compositeContent.length, $data, $event, selected.id)\"\\n' +\n    '             pip-drag-stop=\"onStop(selected.id)\"\\n' +\n    '             pip-drag-start=\"onStart(selected.id)\"\\n' +\n    '             id=\"{{\\'pip-composite-last-\\' + selected.id}}\">\\n' +\n    '\\n' +\n    '            <!--<div ng-class=\"{\\'putt_box\\': selected.drag}\"></div>-->\\n' +\n    '            <div class=\"putt_box\"></div>\\n' +\n    '            <div class=\"pip-section-content h24\" style=\"border: 0px!important;\">\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('composite_summary/composite_summary.html',\n    '<div ng-repeat=\"item in compositeContent track by $index\">\\n' +\n    '\\n' +\n    '    <!-- for text -->\\n' +\n    '    <div class=\"pip-composite-text\" ng-if=\"item.type == \\'text\\' && item.text\">\\n' +\n    '        <pip-markdown pip-text=\"item.text\"\\n' +\n    '                      pip-line-count=\"{{textSize}}\"\\n' +\n    '                      pip-rebind=\"true\"\\n' +\n    '                      ng-disabled=\"true\">\\n' +\n    '        </pip-markdown>\\n' +\n    '    </div>\\n' +\n    '    <!-- for pictures -->\\n' +\n    '    <div ng-if=\"item.type == \\'pictures\\' && item.pic_ids.length > 0\"\\n' +\n    '         ng-class=\" compositeContent[$index - 1].type != \\'pictures\\' ?\\n' +\n    '                    compositeContent[$index + 1].type != \\'pictures\\' ? \\'tm16 bm16\\' : \\'tm16 bm0\\' :\\n' +\n    '                    compositeContent[$index + 1].type != \\'pictures\\' ? \\'tm8 bm16\\' : \\'tm8 bm0\\' \"\\n' +\n    '         class=\"pip-composite-pictures\">\\n' +\n    '        <pip-collage ng-if=\"rebind\"\\n' +\n    '                     pip-picture-ids=\"item.pic_ids\"\\n' +\n    '                     pip-unique-code=\"item.id\"\\n' +\n    '                     pip-multiple=\"true\"\\n' +\n    '                     pip-open=\"disableControl\"\\n' +\n    '                     pip-rebind=\"true\"\\n' +\n    '                     ng-disabled=\"disableControl\">\\n' +\n    '        </pip-collage>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!-- for documents -->\\n' +\n    '    <div ng-if=\"item.type == \\'documents\\' && item.docs.length > 0\"\\n' +\n    '         class=\"pip-composite-documents\" layout=\"row\" flex>\\n' +\n    '        <pip-document-list flex\\n' +\n    '                           pip-documents=\"item.docs\"\\n' +\n    '                           pip-rebind=\"true\"\\n' +\n    '                           pip-document-icon=\"true\"\\n' +\n    '                           pip-collapse=\"true\"\\n' +\n    '                           ng-disabled=\"disableControl\">\\n' +\n    '        </pip-document-list>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!--for checklist -->\\n' +\n    '    <div ng-if=\"item.type == \\'checklist\\' && item.checklist.length > 0\"\\n' +\n    '         class=\"pip-composite-checklist\">\\n' +\n    '        <pip-checklist-view pip-options=\"item.checklist\"\\n' +\n    '                            pip-changed=\"onContentChange()\"\\n' +\n    '                            pip-rebind=\"true\"\\n' +\n    '                            pip-collapse=\"true\"\\n' +\n    '                            ng-disabled=\"disabledChecklist\">\\n' +\n    '        </pip-checklist-view>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!--for location -->\\n' +\n    '    <div class=\"pip-composite-location\" layout=\"row\" layout-align=\"start center\" flex\\n' +\n    '         ng-if=\"item.type == \\'location\\' && (item.loc_pos || item.loc_name)\">\\n' +\n    '\\n' +\n    '        <pip-location pip-location-name=\"item.loc_name\"\\n' +\n    '                      pip-location-pos=\"item.loc_pos\"\\n' +\n    '                      pip-collapse=\"true\"\\n' +\n    '                      pip-show-location-icon=\"true\"\\n' +\n    '                      ng-disabled=\"disableControl\"\\n' +\n    '                      pip-rebind=\"true\" flex>\\n' +\n    '        </pip-location>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!-- for time -->\\n' +\n    '    <div class=\"pip-composite-time\"\\n' +\n    '         ng-if=\"item.type == \\'time\\' && (item.start || item.end)\"\\n' +\n    '         layout=\"row\" layout-align=\"start center\" flex>\\n' +\n    '\\n' +\n    '        <md-icon md-svg-icon=\"icons:time\" class=\"rm24 lm0\"></md-icon>\\n' +\n    '        <pip-time-view\\n' +\n    '                pip-start-date=\"item.start\"\\n' +\n    '                pip-end-date=\"item.end\"\\n' +\n    '                pip-rebind=\"true\"\\n' +\n    '                ng-disabled=\"disableControl\">\\n' +\n    '        </pip-time-view>\\n' +\n    '    </div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('composite_toolbar/composite_toolbar.html',\n    '<!--\\n' +\n    '@file Composite toolbar control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div layout=\"row\" layout-align=\"start start\" flex>\\n' +\n    '    <md-button class=\"pip-composite-button\"\\n' +\n    '               ng-if=\"!emptyState\"\\n' +\n    '               ng-class=\"{ \\'remove-item\\': !emptyState ,\\n' +\n    '                                \\'new-item\\': !emptyState }\"\\n' +\n    '               ng-click=\"onAddItem(\\'text\\');\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-TEXT\"\\n' +\n    '               ng-disabled=\"ngDisabled()\">\\n' +\n    '        <md-icon class=\"icon-text-block\" md-svg-icon=\"icons:text\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'TEXT\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '    <md-button ng-if=\"toolbarButton.checklist\"\\n' +\n    '               ng-click=\"onAddItem(\\'checklist\\')\"\\n' +\n    '               ng-disabled=\"ngDisabled()\"\\n' +\n    '               class=\"pip-composite-button\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-CHECKLIST\">\\n' +\n    '        <md-icon class=\"icon-checkbox-on\" md-svg-icon=\"icons:checkbox-on\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'CHECKLIST\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '    <md-button ng-if=\"toolbarButton.picture\"\\n' +\n    '               ng-click=\"onAddItem(\\'pictures\\')\"\\n' +\n    '               ng-disabled=\"ngDisabled()\"\\n' +\n    '               class=\"pip-composite-button\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-PICTURES\">\\n' +\n    '        <md-icon class=\"icon-camera\" md-svg-icon=\"icons:camera\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'PICTURE\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '    <md-button ng-click=\"onAddItem(\\'documents\\')\"\\n' +\n    '               ng-if=\"toolbarButton.document\"\\n' +\n    '               ng-disabled=\"ngDisabled()\"\\n' +\n    '               class=\"pip-composite-button\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-DOCUMENTS\">\\n' +\n    '        <md-icon class=\"icon-document\" md-svg-icon=\"icons:document\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'DOCUMENT\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '    <md-button ng-click=\"onAddItem(\\'location\\')\"\\n' +\n    '               ng-if=\"toolbarButton.location\"\\n' +\n    '               ng-disabled=\"ngDisabled()\"\\n' +\n    '               class=\"pip-composite-button\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-LOCATIONS\">\\n' +\n    '        <md-icon class=\"icon-location\" md-svg-icon=\"icons:location\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'LOCATION\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '    <md-button ng-click=\"onAddItem(\\'time\\')\"\\n' +\n    '               ng-if=\"toolbarButton.event\"\\n' +\n    '               ng-disabled=\"ngDisabled()\"\\n' +\n    '               class=\"pip-composite-button\"\\n' +\n    '               aria-label=\"COMPOSITE-BUTTON-TIME\">\\n' +\n    '        <md-icon class=\"icon-time\" md-svg-icon=\"icons:time\"></md-icon>\\n' +\n    '        <md-tooltip>{{::\\'TIME\\'| translate}}</md-tooltip>\\n' +\n    '    </md-button>\\n' +\n    '\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('composite_view/composite_view.html',\n    '<div ng-repeat=\"item in compositeContent track by $index\">\\n' +\n    '\\n' +\n    '    <!-- for text -->\\n' +\n    '    <div class=\"pip-composite-text lp24-flex rp24-flex\" ng-if=\"item.type == \\'text\\' && item.text\" ng-class=\"{\\'bm16\\': $last}\">\\n' +\n    '        <pip-markdown pip-text=\"item.text\"\\n' +\n    '                      pip-rebind=\"true\"\\n' +\n    '                      ng-disabled=\"true\">\\n' +\n    '        </pip-markdown>\\n' +\n    '    </div>\\n' +\n    '    <!-- for pictures -->\\n' +\n    '    <div ng-if=\"item.type == \\'pictures\\' && item.pic_ids.length > 0\"\\n' +\n    '         ng-class=\" compositeContent[$index - 1].type != \\'pictures\\' ?\\n' +\n    '                    compositeContent[$index + 1].type != \\'pictures\\' ? \\'tm16 bm16\\' : \\'tm16 bm0\\' :\\n' +\n    '                    compositeContent[$index + 1].type != \\'pictures\\' ? \\'tm8 bm16\\' : \\'tm8 bm0\\' \"\\n' +\n    '         class=\"pip-composite-pictures lp24-flex rp24-flex\">\\n' +\n    '        <pip-collage ng-if=\"rebind\"\\n' +\n    '                pip-picture-ids=\"item.pic_ids\"\\n' +\n    '                pip-unique-code=\"item.id\"\\n' +\n    '                pip-multiple=\"true\"\\n' +\n    '                pip-open=\"true\"\\n' +\n    '                pip-rebind=\"true\"\\n' +\n    '                ng-disabled=\"ngDisabled()\">\\n' +\n    '        </pip-collage>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!-- for documents -->\\n' +\n    '    <div ng-if=\"item.type == \\'documents\\' && item.docs.length > 0\"\\n' +\n    '         class=\"pip-composite-documents\" layout=\"row\" layout-align=\"start start\" flex>\\n' +\n    '        <pip-document-list pip-documents=\"item.docs\"\\n' +\n    '                           pip-document-icon=\"true\"\\n' +\n    '                           pip-rebind=\"true\"\\n' +\n    '                           ng-disabled=\"ngDisabled()\">\\n' +\n    '        </pip-document-list>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!--for checklist -->\\n' +\n    '    <div ng-if=\"item.type == \\'checklist\\' && item.checklist.length > 0\"\\n' +\n    '         class=\"pip-composite-checklist lp24-flex rp24-flex\">\\n' +\n    '        <pip-checklist-view pip-options=\"item.checklist\"\\n' +\n    '                            pip-changed=\"onContentChange()\"\\n' +\n    '                            pip-rebind=\"true\"\\n' +\n    '                            ng-disabled=\"isDisabled()\">\\n' +\n    '        </pip-checklist-view>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!--for location -->\\n' +\n    '    <div class=\"pip-composite-location\" layout=\"row\" layout-align=\"start start\" flex\\n' +\n    '         ng-if=\"item.type == \\'location\\' && (item.loc_pos || item.loc_name)\">\\n' +\n    '\\n' +\n    '        <pip-location pip-location-name=\"item.loc_name\"\\n' +\n    '                      pip-location-pos=\"item.loc_pos\"\\n' +\n    '                      pip-show-location-icon=\"true\"\\n' +\n    '                      pip-collapse=\"false\"\\n' +\n    '                      ng-disabled=\"ngDisabled()\"\\n' +\n    '                      pip-rebind=\"true\" flex>\\n' +\n    '        </pip-location>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <!-- for time -->\\n' +\n    '    <div class=\"pip-composite-time lp24-flex rp24-flex\"\\n' +\n    '         ng-if=\"item.type == \\'time\\'\" layout=\"row\" layout-align=\"start center\"  flex>\\n' +\n    '\\n' +\n    '        <md-icon md-svg-icon=\"icons:time\" class=\"lm0\"></md-icon>\\n' +\n    '        <pip-time-view\\n' +\n    '                pip-start-date=\"item.start\"\\n' +\n    '                pip-end-date=\"item.end\"\\n' +\n    '                pip-rebind=\"true\"\\n' +\n    '                ng-disabled=\"ngDisabled()\">\\n' +\n    '        </pip-time-view>\\n' +\n    '    </div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipComposite.Templates');\n} catch (e) {\n  module = angular.module('pipComposite.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('content_switch/content_switch.html',\n    '<!--\\n' +\n    '@file Content switch control content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-button ng-click=\"showPictures = !showPictures; onButtonClick(\\'pictures\\')\"\\n' +\n    '           aria-label=\"showPictures\"\\n' +\n    '           class=\"md-icon-button\"\\n' +\n    '           ng-show=\"showIconPicture\"\\n' +\n    '           ng-disabled=\"transaction.busy()\">\\n' +\n    '        <md-icon class=\"active-camera\"\\n' +\n    '                 xng-class=\"{ \\'active-camera\\': showPictures }\"\\n' +\n    '                 md-svg-icon=\"icons:camera\"></md-icon>\\n' +\n    '</md-button>\\n' +\n    '<md-button ng-click=\"showDocuments = !showDocuments; onButtonClick(\\'documents\\')\"\\n' +\n    '           aria-label=\"showDocuments\"\\n' +\n    '           class=\"md-icon-button\"\\n' +\n    '           ng-show=\"showIconDocument\"\\n' +\n    '           ng-disabled=\"transaction.busy()\">\\n' +\n    '    <md-icon ng-class=\"{ \\'active-document\\': showDocuments }\" md-svg-icon=\"icons:document\"></md-icon>\\n' +\n    '</md-button>\\n' +\n    '<md-button ng-click=\"showEvent = !showEvent; onButtonClick(\\'event\\')\"\\n' +\n    '           aria-label=\"showEvent\"\\n' +\n    '           class=\"md-icon-button\"\\n' +\n    '           ng-show=\"showIconEvent\"\\n' +\n    '           ng-disabled=\"transaction.busy()\">\\n' +\n    '    <md-icon ng-class=\"{ \\'active-time\\': showEvent }\" md-svg-icon=\"icons:time\"></md-icon>\\n' +\n    '</md-button>\\n' +\n    '<md-button ng-click=\"showLocation = !showLocation; onButtonClick(\\'location\\')\"\\n' +\n    '           aria-label=\"showLocation\"\\n' +\n    '           class=\"md-icon-button\"\\n' +\n    '           ng-show=\"showIconLocation\"\\n' +\n    '           ng-disabled=\"transaction.busy()\">\\n' +\n    '    <md-icon ng-class=\"{ \\'active-location\\': showLocation }\" md-svg-icon=\"icons:location\"></md-icon>\\n' +\n    '</md-button>\\'');\n}]);\n})();\n","/**\r\n * @file Checklist edit control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * + Improve samples in sampler app\r\n * + Renamed to pip-checklist-edit and implement pip-checklist (pip-checklist-view) control\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipChecklistEdit\", ['pipCore', 'pipComposite.Templates']);\r\n\r\n    /**\r\n     * ngDisabled: '&',\r\n     * pipChanged: '=',\r\n     * pipDraggable: '=',\r\n     * pipOptions: '=',\r\n     * pipScrollContainer: '@'\r\n     */\r\n    thisModule.directive('pipChecklistEdit',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: false,\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipChanged: '=',\r\n                    pipDraggable: '=',\r\n                    pipOptions: '=',\r\n                    pipScrollContainer: '@'\r\n                },\r\n                templateUrl: 'checklist_edit/checklist_edit.html',\r\n                controller: 'pipChecklistEditController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipChecklistEditController',\r\n        ['$scope', '$element', '$attrs', '$document', 'pipUtils', '$rootScope', function ($scope, $element, $attrs, $document,pipUtils, $rootScope) {\r\n\r\n            $scope.selected = {};\r\n            $scope.selected.index = 0;\r\n            $scope.selected.drag = $scope.pipDraggable;\r\n            $scope.selected.dragInit = $scope.pipDraggable;\r\n            $scope.selected.dragId = 0;\r\n            $scope.selected.id = now();\r\n            $scope.selected.isChanged = false;\r\n\r\n            generateList($scope.pipOptions);\r\n\r\n            $scope.onTextareaKeyDown = onTextareaKeyDown;\r\n            $scope.onAddItem = onAddItem;\r\n            $scope.onChangeItem = onChangeItem;\r\n            $scope.onClick = onClick;\r\n            $scope.onTextAreaClick = onTextAreaClick;\r\n            $scope.onDropComplete = onDropComplete;\r\n            $scope.onDeleteItem = onDeleteItem;\r\n            $scope.onChecked = onChecked;\r\n            $scope.updateContents = updateContents;\r\n            $scope.onItemFocus = onItemFocus;\r\n            $scope.onMove = onMove;\r\n            $scope.onStart = onStart;\r\n            $scope.onStop = onStop;\r\n            $scope.isDisabled = isDisabled;\r\n            $scope.onDownDragg = onDownDragg;\r\n\r\n            $scope.isSelectedItem = isSelectedItem;\r\n\r\n            // Watch for options changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipOptions', function (newValue) {\r\n                    if (!$scope.selected.isChanged) {\r\n                        generateList($scope.pipOptions);\r\n                    } else {\r\n                        $scope.selected.isChanged = false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipDraggable', function (newValue) {\r\n                    $scope.pipDraggable = newValue;\r\n                });\r\n            }\r\n\r\n            $scope.onChecklistChange = _.debounce(onChecklistChange , 200);\r\n\r\n            // Add class\r\n            $element.addClass('pip-checklist-edit');\r\n\r\n            return;\r\n\r\n            function getCaret(el) {\r\n                if (el.selectionStart) {\r\n                    return el.selectionStart;\r\n                } else if ($document.selection) {\r\n                    el.focus();\r\n\r\n                    var r = $document.selection.createRange();\r\n                    if (r == null) {\r\n                        return 0;\r\n                    }\r\n\r\n                    var re = el.createTextRange(),\r\n                        rc = re.duplicate();\r\n                    re.moveToBookmark(r.getBookmark());\r\n                    rc.setEndPoint('EndToStart', re);\r\n\r\n                    return rc.text.length;\r\n                }\r\n                return 0;\r\n            }\r\n\r\n            function isDisabled() {\r\n                if ($scope.ngDisabled) {\r\n                    return $scope.ngDisabled();\r\n                } else {\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            function onItemFocus(index) {\r\n                if (isDisabled()) return;\r\n                $scope.selected.index = index;\r\n            };\r\n\r\n            function isSelectedItem(index) {\r\n                var empty;\r\n                try {\r\n                    empty = $scope.checklistContent[index].empty;\r\n                } catch (err) {\r\n                    empty = true;\r\n                }\r\n\r\n                return $scope.selected.index == index && $scope.pipDraggable && !empty;\r\n            };\r\n\r\n            function setSelectionRange(input, selectionStart, selectionEnd) {\r\n                if (input.setSelectionRange) {\r\n                    input.focus();\r\n                    input.setSelectionRange(selectionStart, selectionEnd);\r\n                }\r\n                else if (input.createTextRange) {\r\n                    var range = input.createTextRange();\r\n                    range.collapse(true);\r\n                    range.moveEnd('character', selectionEnd);\r\n                    range.moveStart('character', selectionStart);\r\n                    range.select();\r\n                }\r\n            }\r\n\r\n            function setCaretToPos (input, pos) {\r\n                setSelectionRange(input, pos, pos);\r\n            }\r\n\r\n            function onTextareaKeyDown($event, index, item) {\r\n                if (isDisabled()) return;\r\n                if ($scope.selected.index == -1) return;\r\n\r\n                if (item.text == '' && ($event.keyCode == 8 || $event.keyCode == 46) && !$event.ctrlKey && !$event.shiftKey) {\r\n                    if (!item.empty) onDeleteItem(index, item);\r\n                    if ($event) $event.stopPropagation();\r\n                    return false;\r\n                }\r\n\r\n                if ($event && $event.target) {\r\n                    // calculate caret position\r\n                    var posCaret = getCaret($event.target);\r\n                    // calculate textarea length\r\n                    if ($event.target.value !== undefined)\r\n                        var textareaLength = $event.target.value.length;\r\n                }\r\n\r\n                //press enter - create new item\r\n                if (($event.keyCode == 13 || $event.keyCode == 45) && !$event.ctrlKey && !$event.shiftKey) {  // insert\r\n                    if (posCaret !== undefined && posCaret == 0) {\r\n                        // add item before current item\r\n                        if ($scope.selected.index > 0) addItem('', $scope.selected.index - 1);\r\n                        else  {\r\n                            $scope.selected.index = -1;\r\n                            addItem('', -1);\r\n                        }\r\n                        if ($event) $event.stopPropagation();\r\n                        if ($event) $event.preventDefault();\r\n\r\n                        return false;\r\n                    }\r\n\r\n                    if (textareaLength && posCaret && textareaLength == posCaret) {\r\n                        // add item after current item\r\n                        if (!item.empty) {\r\n                            addItem('', $scope.selected.index);\r\n                        }\r\n                        if ($event) $event.stopPropagation();\r\n                        if ($event) $event.preventDefault();\r\n                        return false;\r\n                    }\r\n\r\n                    if ($event) $event.preventDefault();\r\n                    return false;\r\n                }\r\n\r\n                // move cursor up\r\n                if ($scope.checklistContent.length > 1 && $event.keyCode == 38 && !$event.ctrlKey && !$event.shiftKey) {  // insert\r\n                    if ($event) $event.stopPropagation();\r\n                    if ($event) $event.preventDefault();\r\n\r\n                    if (posCaret !== undefined && textareaLength !== undefined && posCaret == textareaLength) {\r\n                        // move to new item\r\n                        if ($scope.selected.index == 0) {\r\n                            $scope.selected.index = $scope.checklistContent.length - 1;\r\n                            setFocus(0);\r\n                        } else {\r\n                            $scope.selected.index -= 1;\r\n                            setFocus(0);\r\n                        }\r\n                    } else {\r\n                        // move caret to text end\r\n                        setFocus(textareaLength);\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n\r\n                // move cursor down\r\n                if ($scope.checklistContent.length > 1 && $event.keyCode == 40 && !$event.ctrlKey && !$event.shiftKey) {  // insert\r\n                    if ($event) $event.stopPropagation();\r\n                    if ($event) $event.preventDefault();\r\n\r\n                    if (posCaret !== undefined && textareaLength !== undefined && posCaret == textareaLength) {\r\n                        // move to new item\r\n                        if ($scope.selected.index >= $scope.checklistContent.length - 1) {\r\n                            $scope.selected.index = 0;\r\n                            setFocus(0);\r\n                        } else {\r\n                            $scope.selected.index += 1;\r\n                            setFocus(0);\r\n                        }\r\n                    } else {\r\n                        // move caret to text end\r\n                        setFocus(textareaLength);\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n\r\n                // delete item\r\n                if (!item.empty && $event.keyCode == 46 && $event.ctrlKey && !$event.shiftKey) {\r\n                    if ($event) $event.stopPropagation();\r\n                    if ($event) $event.preventDefault();\r\n                    onDeleteItem(index, item);\r\n                    return false;\r\n                }\r\n\r\n                // check/uncheck item\r\n                if ($event.keyCode == 32 && $event.ctrlKey && !$event.shiftKey) {\r\n                    if ($event) $event.stopPropagation();\r\n                    if ($event) $event.preventDefault();\r\n                    if (item) {\r\n                        item.checked = !item.checked\r\n                        $scope.onChecklistChange();\r\n                    }\r\n                    return false;\r\n                }\r\n            }\r\n\r\n\r\n            function onAddItem() {\r\n                addItem('', $scope.selected.index - 1);\r\n            };\r\n\r\n            function onChangeItem(index) {\r\n                if (index > -1 && $scope.checklistContent[index] && $scope.checklistContent[index].empty) {\r\n                    if ($scope.checklistContent[index].empty) {\r\n                        $scope.checklistContent[index].empty = false;\r\n                        $scope.checklistContent.push(getNewItem('', true));\r\n                    }\r\n                }\r\n                $scope.onChecklistChange();\r\n            };\r\n\r\n            function onClick($event, index) {\r\n                if (isDisabled()) return;\r\n                $scope.selected.index = index;\r\n\r\n               // if ($event) $event.preventDefault();\r\n            };\r\n\r\n            function onTextAreaClick($event, index) {\r\n                if (isDisabled()) return;\r\n                $scope.selected.index = index;\r\n              //  if ($event) $event.stopPropagation();\r\n            };\r\n\r\n            function onDropComplete(placeIndex, obj, event, componentId) {\r\n                if ($scope.selected.id != componentId) return;\r\n                if (!$scope.selected.drag) return;\r\n                var index = placeIndex;\r\n\r\n                var tmpIndex = $scope.selected.index;\r\n\r\n                var checklist = _.cloneDeep($scope.checklistContent);\r\n\r\n                if (!(tmpIndex == 0 && placeIndex == 1)) {\r\n                    if (tmpIndex > index) {\r\n                        if (index > checklist.length - 1) index = checklist.length - 1;\r\n                        // move up\r\n                        for (var i = 0; i < tmpIndex - index; i++) {\r\n                            checklist[tmpIndex - i] = checklist[tmpIndex - i - 1];\r\n                        }\r\n                        checklist[index] = obj;\r\n                    }\r\n                    if (tmpIndex < index) {\r\n                        index -= 1;\r\n                        //move down\r\n                        for (var i = 0; i < index - tmpIndex; i++) {\r\n                            checklist[tmpIndex + i] = checklist[tmpIndex + i + 1];\r\n                        }\r\n                        checklist[index] = obj;\r\n                    }\r\n\r\n                    $scope.selected.index = index;\r\n                }\r\n\r\n                $scope.checklistContent = checklist;\r\n\r\n                $scope.onChecklistChange();\r\n            };\r\n\r\n            function onMove() {\r\n                setWidth();\r\n                $scope.isWidth = true;\r\n            };\r\n\r\n\r\n            function onStop(id) {\r\n                setTimeout(function () {\r\n                    $scope.selected.drag = $scope.selected.dragInit;\r\n                    $scope.selected.dragId = 0;\r\n                    $scope.$apply();\r\n                },  50);\r\n\r\n                if($scope.isWidth) {\r\n                    setWidth100();\r\n                    $scope.isWidth  = false;\r\n                }\r\n            };\r\n\r\n            function onStart(id) {\r\n                $scope.selected.isChanged = true;\r\n                if (id && id != $scope.selected.dragId) $scope.selected.drag = false;\r\n            };\r\n\r\n            function onDownDragg(item) {\r\n                if ($scope.pipDraggable && $scope.checklistContent.length > 2 && !item.empty) {\r\n                    $rootScope.$broadcast('onChecklistDrag');\r\n                    $scope.selected.dragId = $scope.selected.id;\r\n                }\r\n            };\r\n\r\n            function onDeleteItem(index, item) {\r\n                var nextElement;\r\n                if ($scope.checklistContent.length == 1) {\r\n                    $scope.checklistContent[0].text = '';\r\n                    $scope.checklistContent[0].checked = false;\r\n                    $scope.checklistContent[0].empty = true;\r\n                    $scope.selected.index = 0;\r\n                } else {\r\n                    if (index >= 0 && index <= $scope.checklistContent.length)\r\n                        $scope.checklistContent.splice(index, 1);\r\n                    else return;\r\n                }\r\n\r\n                if ($scope.selected.index >= $scope.checklistContent.length)\r\n                    $scope.selected.index = $scope.checklistContent.length - 1;\r\n\r\n                setTimeout(function () {\r\n                    if ($scope.selected.index > -1) {\r\n                        nextElement = angular.element('#check-item-text-' + $scope.selected.id + '-' + $scope.selected.index);\r\n                        if (nextElement) nextElement.focus();\r\n                    }\r\n                }, 550);\r\n\r\n                $scope.onChecklistChange();\r\n            };\r\n\r\n            function onChecked(item) {\r\n                $scope.onChecklistChange();\r\n            };\r\n\r\n            function updateContents() {\r\n                $scope.selected.isChanged = true;\r\n                var content = [], i;\r\n                for (i = 0; i < $scope.checklistContent.length; i++) {\r\n                    if ($scope.checklistContent[i] && !$scope.checklistContent[i].empty) content.push({\r\n                        checked: $scope.checklistContent[i].checked,\r\n                        text: $scope.checklistContent[i].text\r\n                    })\r\n                }\r\n                $scope.pipOptions = content;\r\n            };\r\n\r\n            function onChecklistChange() {\r\n                updateContents();\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged();\r\n                }\r\n            };\r\n\r\n            function setFocus(toPos) {\r\n                setTimeout(function () {\r\n                    var nextElement = angular.element('#check-item-text-' + $scope.selected.id + '-' + $scope.selected.index);\r\n                    if (nextElement) {\r\n                        nextElement.focus();\r\n                        if (toPos !== undefined && nextElement[0]) setCaretToPos(nextElement[0], toPos);\r\n                    }\r\n                },  50);\r\n            };\r\n\r\n            function addItem(text, index) {\r\n                var newItem = getNewItem(text, false);\r\n                if (index > -1) $scope.selected.index = index;\r\n\r\n                if ($scope.checklistContent.length < 2) {\r\n                    $scope.checklistContent.unshift(newItem);\r\n                }\r\n                else {\r\n                    $scope.checklistContent.splice($scope.selected.index + 1, 0, newItem);\r\n                }\r\n                $scope.selected.index += 1;\r\n                setFocus();\r\n\r\n                $scope.onChecklistChange();\r\n            }\r\n\r\n            function getNewItem(text, isEmpty) {\r\n                return {\r\n                    checked: false,\r\n                    text: text || '',\r\n                    empty: isEmpty\r\n                }\r\n            };\r\n\r\n            function now(){\r\n                return +new Date;\r\n            }\r\n\r\n            function clearList() {\r\n                $scope.selected.index = 0;\r\n                $scope.checklistContent = [];\r\n                // push empty item\r\n                $scope.checklistContent.push(getNewItem('', true));\r\n            };\r\n\r\n            function generateList(content) {\r\n                if (!content ||  content.length < 1) {\r\n                    clearList();\r\n                } else {\r\n                    $scope.checklistContent = [];\r\n                    _.each(content, function(item){\r\n                        $scope.checklistContent.push(item);\r\n                    });\r\n                    // push empty item\r\n                    $scope.checklistContent.push(getNewItem('', true));\r\n                }\r\n            };\r\n\r\n            function setWidth100() {\r\n                var element = angular.element('#check-item-' + + $scope.selected.id + '-' + $scope.selected.index);\r\n                element.css( \"width\", 'none');\r\n                element.css( \"max-width\", 'none');\r\n            };\r\n\r\n            function setWidth() {\r\n                if ($scope.isWidth) return;\r\n\r\n                var elementEtalon = angular.element('#check-item-empty-' + $scope.selected.id);\r\n                var value = elementEtalon.width();\r\n                var element = angular.element('#check-item-' + $scope.selected.id + '-' + $scope.selected.index);\r\n                if (element) {\r\n                    element.css(\"width\", value + 'px');\r\n                    element.css(\"max-width\", value + 'px');\r\n                }\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Checklist view control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipChecklistView\", ['pipCore', 'pipComposite.Templates']);\r\n\r\n    thisModule.directive('pipChecklistView',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: false,\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipChanged: '&',\r\n                    pipOptions: '='\r\n                },\r\n                templateUrl: 'checklist_view/checklist_view.html',\r\n                controller: 'pipChecklistViewController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipChecklistViewController',\r\n        ['$scope', '$element', '$attrs', 'pipUtils', function ($scope, $element, $attrs, pipUtils) {\r\n\r\n            $scope.disableControl = pipUtils.toBoolean($scope.ngDisabled()) != false;\r\n            $scope.rebind = pipUtils.toBoolean($attrs.pipRebind);\r\n            $scope.selected = {};\r\n            $scope.selected.isChanged = false;\r\n\r\n            generateList($scope.pipOptions);\r\n\r\n            // Add class\r\n            $element.addClass('pip-checklist-view');\r\n\r\n            // Watch for options changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipOptions', function (newValue) {\r\n                    if (!$scope.selected.isChanged) {\r\n                        generateList($scope.pipOptions);\r\n                    } else {\r\n                        $scope.selected.isChanged = false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            $scope.updateContents = updateContents;\r\n            $scope.onClick = onClick;\r\n\r\n            return;\r\n\r\n            function updateContents() {\r\n                $scope.selected.isChanged = true;\r\n                $scope.pipOptions = $scope.checklistContent;\r\n            };\r\n\r\n            function onChecklistChange() {\r\n                updateContents();\r\n                if ($scope.pipChanged) {\r\n                    $scope.pipChanged();\r\n                }\r\n            };\r\n\r\n            function clearList() {\r\n                $scope.checklistContent = [];\r\n            };\r\n\r\n            function generateList(content) {\r\n                if (!content ||  content.length < 1) {\r\n                    clearList();\r\n                    return;\r\n                } else {\r\n                    $scope.checklistContent = [];\r\n                    _.each(content, function(item){\r\n                        $scope.checklistContent.push(item);\r\n                    });\r\n                }\r\n            };\r\n\r\n            function onClick($event, item) {\r\n                if ($event) $event.stopPropagation();\r\n                if ($scope.ngDisabled && $scope.ngDisabled()) return;\r\n\r\n                onChecklistChange();\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Composite summary control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCompositeSummary\", [\r\n        'pipCore', 'pipDocuments', 'pipLocations', 'pipPictures', 'pipComposite.Templates']);\r\n\r\n    thisModule.directive('pipCompositeSummary',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    pipContents: '=',\r\n                    pipChecklistSize: '=',\r\n                    pipTextSize: '=',\r\n                    pipPrimaryBlockLimit: '=',\r\n                    pipSecondaryBlockLimit: '=',\r\n                    pipSecondaryBlockTypes: '='\r\n                },\r\n                templateUrl: 'composite_summary/composite_summary.html',\r\n                controller: 'pipCompositeSummaryController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipCompositeSummaryController',\r\n        ['$scope', '$element', '$attrs', 'pipUtils', function ($scope, $element, $attrs, pipUtils) {\r\n\r\n            $scope.rebind = pipUtils.toBoolean($attrs.pipRebind);\r\n            $scope.disableControl = true;\r\n            $scope.disabledChecklist = true;\r\n\r\n            $scope.secondaryBlockTypes = $scope.pipSecondaryBlockTypes !== undefined &&\r\n                Array.isArray($scope.pipSecondaryBlockTypes) ? $scope.pipSecondaryBlockTypes :\r\n                 ['checklist', 'documents', 'location', 'time'];\r\n            $scope.textSize = $scope.pipTextSize !== undefined && $scope.pipTextSize > 0 ? $scope.pipTextSize : 0;\r\n            $scope.secondaryBlockLimit = $scope.pipSecondaryBlockLimit !== undefined && $scope.pipSecondaryBlockLimit > 0 ? $scope.pipSecondaryBlockLimit : -1;\r\n            $scope.checklistSize = $scope.pipChecklistSize !== undefined && $scope.pipChecklistSize > 0 ? $scope.pipChecklistSize : 0;\r\n            $scope.primaryBlockLimit = $scope.pipPrimaryBlockLimit !== undefined ? $scope.pipPrimaryBlockLimit : -1;\r\n\r\n            generateList($scope.pipContents);\r\n\r\n            // Watch for options changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipContents', function (newValue) {\r\n                    if (!Array.isArray($scope.pipContents)) {\r\n                        throw new Error('Error: Attribute pip-contents must be array!');\r\n                        return;\r\n                    }\r\n                    generateList($scope.pipContents);\r\n                });\r\n            }\r\n\r\n            // Add class\r\n            $element.addClass('pip-composite-summary');\r\n\r\n            return;\r\n\r\n            // усекаем чеклист до 3\r\n            function limitChecklist(content, val) {\r\n                if (!val) return;\r\n                _.each(content, function(item) {\r\n                    if (item && item.type == 'checklist') {\r\n                        item.checklist =_.take(item.checklist, val);\r\n                    }\r\n                });\r\n            };\r\n\r\n            // отбираем текст и картинки\r\n            function selectSummary(content) {\r\n                var result = [],\r\n                    i = 0;\r\n\r\n                _.each(content, function(item) {\r\n                    if ($scope.primaryBlockLimit >= 0 && i >= $scope.primaryBlockLimit) return result;\r\n\r\n                    //if (item.type == 'text' || item.type == 'pictures' ) {\r\n                    if ($scope.secondaryBlockTypes.indexOf(item.type) < 0) {\r\n                        result.push(item);\r\n                        i += 1;\r\n                    }\r\n                });\r\n\r\n                return result;\r\n            };\r\n\r\n            // отбираем остальные блоки если они есть\r\n            function selectSummarySecondary(content, types) {\r\n                var i, limit =  $scope.secondaryBlockLimit < 0 ? content.length : $scope.secondaryBlockLimit;\r\n                var result = [];\r\n\r\n                for (i = 0; i < content.length; i++ ) {\r\n                    if (types.indexOf(content[i].type) > -1) {\r\n                        result.push(content[i]);\r\n                        if (result.length >= limit) break;\r\n                    }\r\n                }\r\n\r\n                return result;\r\n            };\r\n\r\n            function generateList(content) {\r\n                if (!content ||  content.length < 1) {\r\n                    clearList();\r\n                    return;\r\n                } else {\r\n                    var result = selectSummary(content);\r\n                    if (result.length == 0) {\r\n                        result = selectSummarySecondary(content, $scope.secondaryBlockTypes);\r\n                    }\r\n\r\n                    limitChecklist(result, $scope.checklistSize);\r\n\r\n                    var id = 0;\r\n                    _.each(result, function(item){\r\n                        item.id = id;\r\n                        id ++;\r\n                    });\r\n                    $scope.compositeContent = result;\r\n                }\r\n            };\r\n\r\n            function clearList() {\r\n                $scope.compositeContent = [];\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Composite edit control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCompositeEdit\", [\r\n        'pipCore', 'pipDocuments', 'pipLocations', 'pipPictures', 'pipComposite.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'COMPOSITE_TITLE': 'What\\'s on your mind?',\r\n            'COMPOSITE_PLACEHOLDER': 'Type text ...',\r\n            'COMPOSITE_START_TIME': 'Start time',\r\n            'COMPOSITE_END_TIME': 'End time'\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'COMPOSITE_TITLE': 'Что у вас на уме?',\r\n            'COMPOSITE_PLACEHOLDER': 'Введите текст ...',\r\n            'COMPOSITE_START_TIME': 'Время начала',\r\n            'COMPOSITE_END_TIME': 'Время окончания'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipCompositeEdit',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: false,\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipChanged: '&',\r\n                    pipContents: '=',\r\n                    compositeId: '=pipCompositeId',\r\n                    pipCompositePlaceholder: '=',\r\n                    pipScrollContainer: '@',\r\n                    pipAddedContent: '&'\r\n                },\r\n                templateUrl: 'composite_edit/composite_edit.html',\r\n                controller: 'pipCompositeEditController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipCompositeEditController',\r\n        ['$scope', '$element', '$attrs', '$rootScope', 'pipUtils', 'pipTranslate', '$document', function ($scope, $element, $attrs, $rootScope, pipUtils, pipTranslate, $document) {\r\n\r\n            var CONTENT_TYPES = ['time', 'text', 'pictures', 'documents', 'checklist', 'location'];\r\n\r\n            $scope.selected = {};\r\n            $scope.selected.id = now();\r\n            $scope.selected.index = 0;\r\n            $scope.selected.drag = true;\r\n            $scope.selected.dragId = 0;\r\n\r\n            $scope.selected.isChanged = false;\r\n            $scope.toolbarButton = {};\r\n            $scope.rebind = pipUtils.toBoolean($attrs.pipRebind);\r\n            $scope.disableControl = pipUtils.toBoolean($scope.ngDisabled()) != false;\r\n            $scope.addedContent = pipUtils.toBoolean($scope.pipAddedContent()) == true;\r\n\r\n            generateList($scope.pipContents);\r\n            setPlaceholder();\r\n\r\n            $rootScope.$on('pipAddCompositeItem', function(event, args) {\r\n                if ($scope.compositeId) {\r\n                    if (args.id && args.id == $scope.compositeId) addItem(args.type);\r\n                } else addItem(args.type);\r\n            });\r\n\r\n            // Watch for options changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipContents', function (newValue, oldValue) {\r\n                    if (!$scope.selected.isChanged || ($scope.pipContents\r\n                        && $scope.pipContents.length != $scope.compositeContent.length)) {\r\n                        generateList($scope.pipContents);\r\n                        $scope.selected.isChanged = false;\r\n                    }\r\n                });\r\n\r\n                $scope.$watch('pipCompositePlaceholder', function (newValue, oldValue) {\r\n                    if ( newValue !== oldValue ) {\r\n                        setPlaceholder();\r\n                    }\r\n                });\r\n            }\r\n\r\n            $element.addClass('pip-composite-edit');\r\n\r\n            $scope.onDeleteItem = onDeleteItem;\r\n            $scope.onContentChange = onContentChange;\r\n            $scope.isSelectedSection = isSelectedSection;\r\n            $scope.onClick = onClick;\r\n            $scope.onDownDragg = onDownDragg;\r\n            $scope.onDraggEnd = onDraggEnd;\r\n            $scope.onDropComplete = onDropComplete;\r\n            $scope.onKeyUp = onKeyUp;\r\n            $scope.onKeyDown = onKeyDown;\r\n            $scope.onStart = onStart;\r\n            $scope.onStop = onStop;\r\n\r\n            $scope.isActiveChecklist = isActiveChecklist;\r\n\r\n            $rootScope.$on('onChecklistDrag', function () {\r\n                $scope.selected.drag = false;\r\n                setTimeout(function () {\r\n                    $scope.selected.drag = false;\r\n                    $scope.$apply();\r\n                },  0);\r\n            });\r\n\r\n            $rootScope.$on('focusedComposite', function () {\r\n                if ($scope.isFirst) {\r\n                    setTimeout(function () {\r\n                        var nextElement = angular.element('#composite-item-text-' + $scope.selected.id + '-0');\r\n                        if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                    },  50);\r\n                }\r\n            });\r\n\r\n            $scope.onCompositeChange = _.debounce(onCompositeChange , 200);\r\n\r\n            return;\r\n\r\n            function isActiveChecklist(obj) {\r\n                //return obj.id == $scope.selected.index  && !$scope.selected.drag;\r\n                return obj.id == $scope.selected.index;\r\n            };\r\n\r\n            function updateContents() {\r\n                $scope.selected.isChanged = true;\r\n                $scope.pipContents = $scope.compositeContent;\r\n            };\r\n\r\n            function getParentIndex(el) {\r\n                if (el.length < 1) return null;\r\n                var elParent = el.parent();\r\n                if (elParent[0] && elParent[0].id && elParent[0].id.indexOf('composite-item-' + $scope.selected.id) > -1) {\r\n                    var strs = elParent[0].id.split('-');\r\n\r\n                    var parentIndex = parseInt(strs[strs.length - 1], 10);\r\n                    return parentIndex;\r\n                } else return getParentIndex(elParent);\r\n            };\r\n\r\n            function onKeyUp($event) {\r\n                if ($event.keyCode == 9) {\r\n                    setTimeout(function () {\r\n                        var focusedElement = angular.element($document[0].activeElement);\r\n                        var parentIndex = getParentIndex(focusedElement);\r\n                        if (parentIndex != null) $scope.selected.index = parentIndex;\r\n                        $scope.$apply($scope.selected.index = $scope.compositeContent[parentIndex].id);\r\n                    },  50);\r\n                }\r\n            };\r\n\r\n            function onKeyDown($event, index, item) {\r\n                if ($scope.ngDisabled()) return;\r\n                // delete item\r\n                if (item && !item.empty && $event.keyCode == 46 && !$event.ctrlKey && $event.shiftKey) {\r\n                    if ($event) $event.stopPropagation();\r\n                    if ($event) $event.preventDefault();\r\n                    if (index > -1) {\r\n                        onDeleteItem(index);\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            function onCompositeChange() {\r\n                updateContents();\r\n                if ($scope.pipChanged) $scope.pipChanged();\r\n            };\r\n\r\n            function onDeleteItem(index) {\r\n                if (index < 0 || $scope.compositeContent.length == 0) return;\r\n\r\n                // delete last element in composite\r\n                if ($scope.compositeContent.length == 1) {\r\n                    $scope.compositeContent[0] = {\r\n                        empty: true,\r\n                        id: getId(),\r\n                        type: 'text',\r\n                        text: '', docs: [], pic_ids: [], loc_pos: null, loc_name: '',\r\n                        start: null, end: null, checklist: []\r\n                    };\r\n                    $scope.selected.index = $scope.compositeContent[0].id;\r\n                    onSelect(0);\r\n                    $scope.isFirst = true;\r\n                    setToolbar();\r\n                } else {\r\n                    if (index >= 0 && index < $scope.compositeContent.length)\r\n                        $scope.compositeContent.splice(index, 1);\r\n\r\n                    if (index == $scope.compositeContent.length)\r\n                        $scope.selected.index = $scope.compositeContent[$scope.compositeContent.length - 1].id;\r\n                    else\r\n                        $scope.selected.index = $scope.compositeContent[index].id;\r\n\r\n                    onSelect();\r\n                }\r\n\r\n                setToolbar();\r\n                $scope.onCompositeChange();\r\n            };\r\n\r\n            function onContentChange(obj) {\r\n                if (obj && obj.empty && obj.text) {\r\n                    obj.empty = false;\r\n                    $scope.isFirst = false;\r\n                    setToolbar();\r\n                }\r\n                if (!$scope.ngDisabled()) $scope.onCompositeChange();\r\n            };\r\n\r\n            function isSelectedSection(index, obj) {\r\n                return $scope.selected.index == obj.id && !obj.empty;// && $scope.compositeContent.length > 1;\r\n            };\r\n\r\n            function onDraggEnd() {\r\n                $scope.selected.drag = true;\r\n            };\r\n\r\n            function onStart(id) {\r\n                if (id && id != $scope.selected.dragId) $scope.selected.drag = false;\r\n            };\r\n\r\n            function onStop(id) {\r\n                setTimeout(function () {\r\n                    $scope.selected.drag = true;\r\n                    $scope.selected.dragId = 0;\r\n                    $scope.$apply();\r\n                },  500);\r\n            };\r\n\r\n            function onDownDragg($event, obj) {\r\n                if ($scope.ngDisabled && $scope.ngDisabled()) return;\r\n                $scope.selected.dragId = $scope.selected.id;\r\n                $scope.selected.drag = true;\r\n                $scope.selected.index = obj.id;\r\n            };\r\n\r\n            function onClick($event, index, obj) {\r\n                if ($scope.ngDisabled && $scope.ngDisabled()) return;\r\n                $scope.selected.event = 'onClick';\r\n                if ($event && $event.target && $event.target.tagName &&\r\n                    ($event.target.tagName == 'INPUT' || $event.target.tagName == 'TEXTAREA' )) {\r\n                    $scope.selected.index = obj.id;\r\n                    return;\r\n                }\r\n\r\n                if ( $scope.selected.index == obj.id && obj.type == 'checklist' && obj.checklist.length > 0) return;\r\n                if ( $scope.selected.index == obj.id && obj.type == 'location' ) return;\r\n\r\n                $scope.selected.index = obj.id;\r\n                onSelect();\r\n            };\r\n\r\n            function onDropComplete(placeIndex, obj, event, componentId) {\r\n                if (componentId != $scope.selected.id || !obj || !obj.type) {\r\n                    $scope.compositeContent = _.cloneDeep($scope.pipContents);\r\n                    return;\r\n                }\r\n\r\n                var index = placeIndex;\r\n                var tmpIndex = _.findIndex($scope.compositeContent, {id: obj.id}); //$scope.selected.index});\r\n\r\n                if (!(tmpIndex == 0 && placeIndex == 1)) {\r\n                    if (tmpIndex > index) {\r\n                        if (index > $scope.compositeContent.length - 1) index = $scope.compositeContent.length - 1;\r\n                        // move up\r\n                        for (var i = 0; i < tmpIndex - index; i++) {\r\n                            $scope.compositeContent[tmpIndex - i] = $scope.compositeContent[tmpIndex - i - 1];\r\n                        }\r\n                        $scope.compositeContent[index] = obj;\r\n                    }\r\n                    if (tmpIndex < index) {\r\n                        index -= 1;\r\n                        //move down\r\n                        for (var i = 0; i < index - tmpIndex; i++) {\r\n                            $scope.compositeContent[tmpIndex + i] = $scope.compositeContent[tmpIndex + i + 1];\r\n                        }\r\n                        $scope.compositeContent[index] = obj;\r\n                    }\r\n                    $scope.selected.index = $scope.compositeContent[index].id;\r\n                }\r\n\r\n                onSelect();\r\n                $scope.onCompositeChange();\r\n            };\r\n\r\n            function onSelect(index) {\r\n                if (!index) index = _.findIndex($scope.compositeContent, {id: $scope.selected.index});\r\n                if (index < 0) return;\r\n\r\n                var item = $scope.compositeContent[index];\r\n                if (_.isEmpty(item)) return;\r\n\r\n                switch (item.type) {\r\n                    //case 'text':\r\n                    //        setTimeout(function () {\r\n                    //            var nextElement = angular.element('#composite-item-text-' + $scope.selected.id + '-' + index);\r\n                    //            //var nextElement = angular.element('#composite-item-text-' + $scope.selected.id + '-' + $scope.selected.index);\r\n                    //            if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                    //            //$scope.selected.stopKey = false;\r\n                    //        },  50);\r\n                    //    break;\r\n                    case 'pictures':\r\n                            setTimeout(function () {\r\n                                var nextElement = angular.element(\r\n                                    '#composite-item-' + $scope.selected.id + '-' + index + ' button.pip-picture-upload');\r\n                                if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                                //$scope.selected.stopKey = false;\r\n                            },  50);\r\n                        break;\r\n                    case 'documents':\r\n                            setTimeout(function () {\r\n                                var nextElement = angular.element(\r\n                                    '#composite-item-' + $scope.selected.id + '-' + index + ' button.pip-document-upload');\r\n                                if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                                //$scope.selected.stopKey = false;\r\n                            },  50);\r\n                        break;\r\n                    //case 'checklist':\r\n                    //        setTimeout(function () {\r\n                    //            var nextElement = angular.element(\r\n                    //                '#composite-item-' + $scope.selected.id + '-' + index + ' textarea[id^=\\'empty-item-\\'');\r\n                    //            if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                    //            //$scope.selected.stopKey = false;\r\n                    //        },  50);\r\n                    //    break;\r\n                    case 'location':\r\n                        setTimeout(function () {\r\n                            var nextElement = angular.element(\r\n                                '#composite-item-' + $scope.selected.id + '-' + index + ' .pip-location-empty  button');\r\n                            if (nextElement && !nextElement.is(':focus')) nextElement.focus();\r\n                            //$scope.selected.stopKey = false;\r\n                        },  50);\r\n                        break;\r\n                    case 'time':\r\n                        break;\r\n                }\r\n            };\r\n\r\n            // set element responsive width when element places\r\n            //function setWidth100(index) {\r\n            //    var element = angular.element('#composite-item-' + $scope.selected.id + '-' + index);\r\n            //    element.css( \"width\", 'none');\r\n            //    element.css( \"max-width\", 'none');\r\n            //};\r\n            //\r\n            //// set draggable element width when your dragg\r\n            //function setWidth(index) {\r\n            //    if ($scope.selected.isWidth) return;\r\n            //    var elementEtalon = angular.element('#pip-composite-last-' + + $scope.selected.id);\r\n            //    var value = elementEtalon.width();\r\n            //    var element = angular.element('#composite-item-' + $scope.selected.id + '-' + index);\r\n            //    if (element) {\r\n            //        element.css(\"width\", value + 'px');\r\n            //        element.css(\"max-width\", value + 'px');\r\n            //    }\r\n            //};\r\n\r\n            function setPlaceholder() {\r\n                $scope.compositePlaceholder =\r\n                    ($scope.pipCompositePlaceholder === undefined || $scope.pipCompositePlaceholder ===  null) ?\r\n                            pipTranslate.translate('COMPOSITE_PLACEHOLDER') :\r\n                            pipTranslate.translate($scope.pipCompositePlaceholder);\r\n            };\r\n\r\n            function addItem (contentType, value) {\r\n                if (_.indexOf(CONTENT_TYPES, contentType) < 0) return;\r\n\r\n                // generate new item\r\n                var newItem = {\r\n                    id: getId(),\r\n                    type: contentType,\r\n                    text: contentType == 'text' ? value : '',\r\n                    docs: contentType == 'documents' && value ? value : [],\r\n                    pic_ids: contentType == 'pictures' && value ? value : [],\r\n                    loc_pos: contentType == 'location' && value ? value.loc_pos : null,\r\n                    loc_name: contentType == 'location' && value ? value.loc_name : '',\r\n                    start: contentType == 'time' && value ? value.start : null,\r\n                    end: contentType == 'time' && value ? value.end : null,\r\n                    checklist: contentType == 'checklist' && value ? value : []\r\n                };\r\n\r\n                // calculate current index\r\n                var index = _.findIndex($scope.compositeContent, {id: $scope.selected.index});\r\n                index = index < 0 ? 0 : index;\r\n\r\n                // insert new element and select it\r\n                if ($scope.compositeContent.length == 1 && $scope.compositeContent[0].empty) {\r\n                    //newItem.id = $scope.compositeContent[0].id;\r\n                    $scope.compositeContent[0] = newItem;\r\n                } else {\r\n                    $scope.compositeContent.splice(index + 1, 0, newItem);\r\n                    index += 1;\r\n                }\r\n\r\n                // insert new element and select it\r\n                $scope.selected.index = newItem.id;\r\n                onSelect();\r\n\r\n                // focus to new element\r\n                setTimeout(scrollTo($scope.pipScrollContainer, '#composite-item-' + $scope.selected.id + '-' + index), 1000);\r\n\r\n                // set toolbar\r\n                $scope.isFirst = false;\r\n                setToolbar();\r\n                $scope.onCompositeChange();\r\n            };\r\n\r\n            function getId() {\r\n                var id = -1;\r\n                _.each($scope.compositeContent, function(item) {\r\n                    if ( id < item.id ) id = item.id;\r\n                });\r\n                return id + 1;\r\n            };\r\n\r\n            function scrollTo(parentElement, childElement) {\r\n                if(!parentElement || !childElement) return;\r\n                setTimeout(function () {\r\n                    if (!$(childElement).position()) return;\r\n                    var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n                    if (modDiff < 20) return;\r\n                    var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n                    $(parentElement).animate({\r\n                        scrollTop: scrollTo + 'px'\r\n                    }, 300);\r\n                }, 100);\r\n            };\r\n\r\n            function generateList(content) {\r\n                if (!content ||  content.length < 1) {\r\n                    clearList();\r\n                    return;\r\n                } else {\r\n                    $scope.compositeContent = [];\r\n                    _.each(content, function(item){\r\n                        item.id = getId();\r\n                        $scope.compositeContent.push(item);\r\n                    });\r\n                    $scope.isFirst = false;\r\n                }\r\n\r\n                setToolbar();\r\n            };\r\n\r\n            function setToolbar(){\r\n                if ($scope.compositeContent.length > 2) return;\r\n                $rootScope.$emit('pipCompositeNotEmpty', !$scope.isFirst);\r\n            };\r\n\r\n            function clearList() {\r\n                $scope.compositeContent = [];\r\n                $scope.compositeContent.push({\r\n                    empty: true,\r\n                    id: getId(),\r\n                    type: 'text',\r\n                    text: '', docs: [], pic_ids: [], loc_pos: null, loc_name: '',\r\n                    start: null, end: null, checklist: []\r\n                });\r\n                $scope.isFirst = true;\r\n            };\r\n\r\n            function now(){\r\n                return +new Date;\r\n            }\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Composite view control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCompositeView\", [\r\n        'pipCore', 'pipDocuments', 'pipLocations', 'pipPictures', 'pipComposite.Templates']);\r\n\r\n    thisModule.directive('pipCompositeView',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipDisabledChecklist: '&',\r\n                    pipChanged: '&',\r\n                    pipContents: '='\r\n                },\r\n                templateUrl: 'composite_view/composite_view.html',\r\n                controller: 'pipCompositeViewController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipCompositeViewController',\r\n        ['$scope', '$element', '$attrs', 'pipUtils', function ($scope, $element, $attrs, pipUtils) {\r\n\r\n            $scope.rebind = pipUtils.toBoolean($attrs.pipRebind);\r\n            $scope.disableControl = pipUtils.toBoolean($scope.ngDisabled()) != false;\r\n            $scope.disabledChecklist = pipUtils.toBoolean($scope.pipDisabledChecklist()) != false;\r\n            $scope.selected = {};\r\n            $scope.selected.isChanged = false;\r\n            generateList($scope.pipContents);\r\n\r\n            $scope.onContentChange = onContentChange;\r\n            $scope.isDisabled = isDisabled;\r\n\r\n            // Watch for options changes\r\n            if (pipUtils.toBoolean($attrs.pipRebind)) {\r\n                $scope.$watchCollection('pipContents', function (newValue) {\r\n                    if (!Array.isArray($scope.pipContents)) {\r\n                        // throw new Error('Error: Attribute pip-contents must be array!');\r\n                        return;\r\n                    }\r\n                    if (!$scope.selected.isChanged) {\r\n                        generateList($scope.pipContents);\r\n                    } else {\r\n                        $scope.selected.isChanged = false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Add class\r\n            $element.addClass('pip-composite-view');\r\n\r\n            return;\r\n\r\n            function isDisabled() {\r\n                return pipUtils.toBoolean($scope.pipDisabledChecklist()) == true ||\r\n                    pipUtils.toBoolean($scope.ngDisabled()) == true;\r\n            };\r\n\r\n            function updateContents() {\r\n                $scope.selected.isChanged = true;\r\n                $scope.pipContents = $scope.compositeContent;\r\n            };\r\n\r\n            function onContentChange() {\r\n                onCompositeChange();\r\n            };\r\n\r\n            function onCompositeChange() {\r\n                updateContents();\r\n                if ($scope.pipChanged)\r\n                    $scope.pipChanged();\r\n            };\r\n\r\n            function generateList(content) {\r\n                if (!content ||  content.length < 1) {\r\n                    clearList();\r\n                    return;\r\n                } else {\r\n                    $scope.compositeContent = [];\r\n                    var id = 0;\r\n                    _.each(content, function(item){\r\n                        if (typeof(item) != 'object' || item == null) {\r\n                            throw new Error('Error: content error!');\r\n                        }\r\n                        item.id = id;\r\n                        id ++;\r\n                        $scope.compositeContent.push(item);\r\n                    });\r\n                }\r\n            };\r\n\r\n            function clearList() {\r\n                $scope.compositeContent = [];\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Composite toolbar control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCompositeToolbar\", ['pipCore', 'pipComposite.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'TEXT':'Text',\r\n            'CHECKLIST':'Checklist',\r\n            'LOCATION':'Location',\r\n            'PICTURE':'Picture',\r\n            'TIME':'Time',\r\n            'DOCUMENT':'Document'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'TEXT':'Текст',\r\n            'CHECKLIST':'Список',\r\n            'LOCATION':'Локация',\r\n            'PICTURE':'Изображение',\r\n            'TIME':'Время',\r\n            'DOCUMENT':'Document'\r\n        });\r\n    }]);\r\n\r\n    thisModule.directive('pipCompositeToolbar',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: false,\r\n                scope: {\r\n                    ngDisabled: '&',\r\n                    pipCompositeEmpty: '&',  // set init state of toolbar\r\n                    pipToolbarButton: '=',  // set visibility toolbar button, true by default\r\n                    compositeId: '=pipCompositeId' // set pip-composite-id, for some composite in one scope\r\n                },\r\n                templateUrl: 'composite_toolbar/composite_toolbar.html',\r\n                controller: 'pipCompositeToolbarController'\r\n            }\r\n        }\r\n    );\r\n\r\n    thisModule.controller('pipCompositeToolbarController',\r\n        ['$scope', '$element', '$attrs', '$rootScope', 'pipUtils', function ($scope, $element, $attrs, $rootScope, pipUtils) {\r\n\r\n            $scope.toolbarButton = {};\r\n            $scope.emptyState = pipUtils.toBoolean($scope.pipCompositeEmpty()) != false;\r\n            $scope.disableControl = pipUtils.toBoolean($scope.ngDisabled()) != false;\r\n\r\n            setOption();\r\n\r\n            $scope.onAddItem = onAddItem;\r\n\r\n            $rootScope.$on('pipCompositeNotEmpty', function(event, value) {\r\n                $scope.emptyState = !value;\r\n            });\r\n\r\n            // Add class\r\n            $element.addClass('pip-composite-toolbar');\r\n\r\n            return;\r\n\r\n            function onAddItem(contentType) {\r\n                $rootScope.$emit('pipAddCompositeItem', {type: contentType, id: $scope.compositeId});\r\n            };\r\n\r\n            function setOption() {\r\n                if ($scope.pipToolbarButton !== null && $scope.pipToolbarButton !== undefined) {\r\n                    $scope.toolbarButton.picture = $scope.pipToolbarButton.picture === false ? $scope.pipToolbarButton.picture : true;\r\n                    $scope.toolbarButton.document = $scope.pipToolbarButton.document === false ? $scope.pipToolbarButton.document : true;\r\n                    $scope.toolbarButton.location = $scope.pipToolbarButton.location === false ? $scope.pipToolbarButton.location : true;\r\n                    $scope.toolbarButton.event = $scope.pipToolbarButton.event === false ? $scope.pipToolbarButton.event : true;\r\n                    $scope.toolbarButton.checklist = $scope.pipToolbarButton.checklist === false ? $scope.pipToolbarButton.checklist : true;\r\n                } else {\r\n                    $scope.toolbarButton.picture = true;\r\n                    $scope.toolbarButton.document = true;\r\n                    $scope.toolbarButton.location = true;\r\n                    $scope.toolbarButton.event = true;\r\n                    $scope.toolbarButton.checklist = true;\r\n                }\r\n                $scope.toolbarButton.text = true;\r\n            };\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Content switch control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Remove after composite content control is ready\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipContentSwitch\", ['pipComposite.Templates']);\r\n\r\n    thisModule.directive('pipContentSwitch', \r\n        ['$parse', function($parse) {\r\n            return {\r\n                restrict: 'EA',\r\n                scope: false,\r\n                templateUrl: 'content_switch/content_switch.html',\r\n                link: function($scope, $element, $attrs) {\r\n    \r\n                    var parentElementNameGetter = $parse($attrs.pipParentElementName);\r\n                    var parentElement = parentElementNameGetter($scope);\r\n\r\n                    $scope.onButtonClick = onButtonClick;\r\n\r\n                    // Initialization\r\n                    setOption();\r\n                    $element.addClass('pip-content-switch');\r\n\r\n                    return ;\r\n\r\n                    function scrollTo(childElement) {\r\n                        setTimeout(function () {\r\n                            var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n                            if (modDiff < 20) return;\r\n                            var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n                            $(parentElement).animate({\r\n                                scrollTop: scrollTo + 'px'\r\n                            }, 300);\r\n                        }, 100);\r\n                    };\r\n    \r\n                    function setOption() {\r\n                        if ($scope.contentSwitchOption !== null && $scope.contentSwitchOption !== undefined) {\r\n                            $scope.showIconPicture = $scope.contentSwitchOption.picture ? $scope.contentSwitchOption.picture : $scope.showIconPicture;\r\n                            $scope.showIconDocument = $scope.contentSwitchOption.document ? $scope.contentSwitchOption.document : $scope.showIconDocument;\r\n                            $scope.showIconLocation = $scope.contentSwitchOption.location ? $scope.contentSwitchOption.location : $scope.showIconLocation;\r\n                            $scope.showIconEvent = $scope.contentSwitchOption.event ? $scope.contentSwitchOption.event : $scope.showIconEvent;\r\n                        } else {\r\n                            $scope.showIconPicture = true;\r\n                            $scope.showIconDocument = true;\r\n                            $scope.showIconLocation = true;\r\n                            $scope.showIconEvent = true;\r\n                        }\r\n                    };\r\n    \r\n                    function onButtonClick(type) {\r\n                        if (!parentElement) return;\r\n    \r\n                        switch(type){\r\n                            case 'event':\r\n                                // On Event click action\r\n                                if ($scope.showEvent)\r\n                                    scrollTo('.event-edit');\r\n                                break;\r\n                            case 'documents':\r\n                                // On Documents click action\r\n                                if ($scope.showDocuments)\r\n                                    scrollTo('.pip-document-list-edit');\r\n                                break;\r\n                            case 'pictures':\r\n                                // On Pictures click action\r\n                                if ($scope.showPictures)\r\n                                    scrollTo('.pip-picture-list-edit');\r\n                                break;\r\n                            case 'location':\r\n                                // On Location click action\r\n                                if ($scope.showLocation)\r\n                                    scrollTo('.pip-location-edit');\r\n                                break;\r\n                        };\r\n                    };\r\n\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Touch start control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipMobileMousedown\", []);\r\n\r\n    thisModule.directive('pipMobileMousedown',\r\n        function () {\r\n            return function (scope, elem, attrs) {\r\n                elem.bind(\"touchstart mousedown\", function (e) {\r\n            //        e.preventDefault();\r\n            //        e.stopPropagation();\r\n                    scope.$apply(attrs[\"pipMobileMousedown\"]);\r\n            //        e.preventDefault();\r\n                });\r\n            }\r\n        }\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Touch start control\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipMobileMouseup\", []);\r\n\r\n    thisModule.directive('pipMobileMouseup',\r\n        function () {\r\n            return function (scope, elem, attrs) {\r\n                elem.bind(\"touchend mouseup\", function (e) {\r\n                //    e.preventDefault();\r\n         //           e.stopPropagation();\r\n                    scope.$apply(attrs[\"pipMobileMouseup\"]);\r\n                });\r\n            }\r\n        }\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Keyboard navigation with scrolling over non-focusable controls\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipCompositeFocused\", []);\r\n\r\n    thisModule.directive('pipCompositeFocused', function () {\r\n        return {\r\n            restrict: 'A',\r\n            scope: false,\r\n            controller: 'pipCompositeFocusedController'\r\n        };\r\n    });\r\n\r\n    thisModule.controller('pipCompositeFocusedController',\r\n        ['$scope', '$element', '$rootScope', function ($scope, $element, $rootScope) {\r\n            $element.bind(\"touchstart mousedown\", function (e) {\r\n                $rootScope.$broadcast('focusedComposite');\r\n            });\r\n        }]\r\n    );\r\n\r\n})();\r\n\r\n","/**\r\n * @file Entry pages (signin, signup) logic\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry', \r\n        [\r\n            'ui.router', 'ngMessages', \r\n            \r\n            'pipCore', 'pipRest', 'pipBasicControls', 'pipLocations', 'pipPictures', 'pipRest.State',\r\n            'pipEntry.Strings', 'pipEntry.Common', 'pipEntry.Signin', 'pipEntry.Signup', 'pipEntry.PostSignup', \r\n            'pipEntry.RecoverPassword', 'pipEntry.ResetPassword', 'pipEntry.VerifyEmail', 'pipEntry.Templates'\r\n        ]);\r\n\r\n    thisModule.config(\r\n        ['$stateProvider', '$locationProvider', '$httpProvider', 'pipAuthStateProvider', function ($stateProvider, $locationProvider, $httpProvider, pipAuthStateProvider) {\r\n\r\n            // Switch to HTML5 routing mode\r\n            //$locationProvider.html5Mode(true);\r\n\r\n\r\n            // Configure module routes for all users\r\n            $stateProvider\r\n                .state('signin', {\r\n                    url: '/signin?email&server_url&redirect_to',\r\n                    auth: false,\r\n                    controller: 'pipSigninController',\r\n                    templateUrl: 'signin/signin.html'\r\n                })\r\n                .state('recover_password', {\r\n                    url: '/recover_password?server_url&email',\r\n                    auth: false,\r\n                    controller: 'pipRecoverPasswordController',\r\n                    templateUrl: 'recover_password/recover_password.html'\r\n                })\r\n                .state('reset_password', {\r\n                    url: '/reset_password?server_url&email&code',\r\n                    auth: false,\r\n                    controller: 'pipResetPasswordController',\r\n                    templateUrl: 'reset_password/reset_password.html'\r\n                })\r\n                .state('signout', { \r\n                    url: '/signout',\r\n                    auth: false\r\n                })\r\n                .state('signup', {\r\n                    url: '/signup?name&email&server_url',\r\n                    auth: false,\r\n                    controller: 'pipSignupController',\r\n                    templateUrl: 'signup/signup.html'\r\n                })\r\n                .state('post_signup', {\r\n                    url: '/post_signup?party_id',\r\n                    auth: false,\r\n                    controller: 'pipPostSignupController',\r\n                    templateUrl: 'post_signup/post_signup.html',\r\n                    resolve: {\r\n                        $party: /* @ngInject */ ['$rootScope', '$stateParams', 'pipRest', 'pipSession', function ($rootScope, $stateParams, pipRest, pipSession) {\r\n                            var userId = pipSession.userId();\r\n                            var partyId = $stateParams.party_id || userId;\r\n\r\n                            if (partyId != userId)\r\n                                throw('ERROR_NOT_ALLOWED');\r\n                            return pipRest.parties().get({ id: partyId }).$promise;\r\n                        }]\r\n                    }\r\n                })\r\n                .state('verify_email', {\r\n                    url: '/verify_email?server_url&email&code',\r\n                    auth: false,\r\n                    controller: 'pipVerifyEmailController',\r\n                    templateUrl: 'verify_email/verify_email.html'\r\n                })\r\n                .state('verify_email_success', {\r\n                    url: '/verify_email_success',\r\n                    auth: false,\r\n                    controller: 'pipVerifyEmailSuccessController',\r\n                    templateUrl: 'verify_email/verify_email_success.html'\r\n                });\r\n\r\n            // Set default paths and states\r\n            pipAuthStateProvider.signinState('signin');\r\n            pipAuthStateProvider.signoutState('signout');\r\n        }]\r\n    );\r\n    \r\n})();","(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('post_signup/post_signup.html',\n    '<!--\\n' +\n    '@file Post-signup page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <pip-post-signup-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\"\\n' +\n    '                pip-party=\"$party\">\\n' +\n    '\\n' +\n    '        </pip-post-signup-panel>\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" class=\"md-accent\"\\n' +\n    '                       ng-click=\"onPostSignupSubmit()\" aria-label=\"CONTINUE\">\\n' +\n    '                {{::\\'CONTINUE\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-button ng-show=\"transaction.busy()\" class=\"md-warn\"\\n' +\n    '                       ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('post_signup/post_signup_dialog.html',\n    '<!--\\n' +\n    '@file Post signup dialog\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-entry lp0 rp0\">\\n' +\n    '    <md-dialog-content>\\n' +\n    '        <pip-post-signup-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\"\\n' +\n    '                pip-party=\"$party\">\\n' +\n    '\\n' +\n    '        </pip-post-signup-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '    <md-dialog-actions layout=\"row\" layout-align=\"end center\">\\n' +\n    '        <md-button ng-hide=\"transaction.busy()\" class=\"md-accent\"\\n' +\n    '                   ng-click=\"onPostSignupSubmit()\" aria-label=\"CONTINUE\">\\n' +\n    '            {{::\\'CONTINUE\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '\\n' +\n    '        <md-button ng-show=\"transaction.busy()\" class=\"md-warn\"\\n' +\n    '                   ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </md-dialog-actions>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('post_signup/post_signup_panel.html',\n    '<div class=\"pip-body\">\\n' +\n    '    <div class=\"pip-content\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '\\n' +\n    '        <h2 class=\"text-overflow\">{{\\'POST_SIGNUP_TITLE\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '        <p class=\"bm0 line-height-string\">\\n' +\n    '            {{\\'POST_SIGNUP_TEXT_1\\' | translate}}\\n' +\n    '        </p>\\n' +\n    '\\n' +\n    '        <p class=\"line-height-string m0\">\\n' +\n    '            {{\\'POST_SIGNUP_TEXT_2\\' | translate}}\\n' +\n    '        </p>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate>\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8\"  md-auto-hide=\"false\">\\n' +\n    '                <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1002\">{{::\\'ERROR_1002\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                    {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"pip-ref-item\">\\n' +\n    '                <pip-avatar-edit ng-disabled=\"transaction.busy()\"\\n' +\n    '                                 pip-reset=\"false\" pip-party-id=\"data.id\"\\n' +\n    '                                 pip-created=\"onPictureCreated($event)\"\\n' +\n    '                                 pip-changed=\"onPictureChanged($control, $event)\"\\n' +\n    '                                 class=\"rm16 flex-fixed\">\\n' +\n    '                </pip-avatar-edit>\\n' +\n    '\\n' +\n    '                <div class=\"pip-content\">\\n' +\n    '                    <p class=\"pip-title\">{{data.name}}</p>\\n' +\n    '                    <p class=\"pip-subtitle\">{{data.email}}</p>\\n' +\n    '                </div>\\n' +\n    '\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"pip-no-hint bp4\">\\n' +\n    '                <label>{{\\'HINT_ABOUT\\' | translate}}</label>\\n' +\n    '                        <textarea ng-model=\"data.about\"  ng-initial ng-disabled=\"transaction.busy()\" pip-clear-errors>\\n' +\n    '                        </textarea>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <div class=\"tm2\">\\n' +\n    '                <p class=\"text-caption bm0\">{{\\'GENDER\\' | translate}}</p>\\n' +\n    '                <md-select class=\"w-stretch tm0 tp0 bp8\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                           ng-model=\"data.gender\" label=\"{{\\'GENDER\\' | translate}}\"\\n' +\n    '                           ng-change=\"onStatusChange(data)\" pip-clear-errors>\\n' +\n    '                    <md-option ng-value=\"opt.id\" ng-repeat=\"opt in genders track by opt.id\">\\n' +\n    '                        {{ opt.name }}\\n' +\n    '                    </md-option>\\n' +\n    '                </md-select>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"tm2\">\\n' +\n    '                <p class=\"text-caption bm0\">{{::\\'BIRTHDAY\\' | translate}}</p>\\n' +\n    '                <pip-date ng-disabled=\"transaction.busy()\"\\n' +\n    '                          ng-model=\"data.birthday\"\\n' +\n    '                          pip-time-mode=\"past\"\\n' +\n    '                          pip-clear-errors time-mode=\"past\">\\n' +\n    '                </pip-date>\\n' +\n    '            </div>\\n' +\n    '           <md-input-container>\\n' +\n    '               <label>{{::\\'LANGUAGE\\' | translate}}</label>\\n' +\n    '               <md-select class=\"w-stretch tm0 tp0  bp16\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                          ng-model=\"data.language\"\\n' +\n    '                          ng-change=\"onStatusChange(data)\" pip-clear-errors>\\n' +\n    '                   <md-option ng-value=\"opt.id\" ng-repeat=\"opt in languages track by opt.id\">\\n' +\n    '                       {{ opt.name }}\\n' +\n    '                   </md-option>\\n' +\n    '               </md-select>\\n' +\n    '           </md-input-container>\\n' +\n    '\\n' +\n    '\\n' +\n    '        </form>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('recover_password/recover_password.html',\n    '<!--\\n' +\n    '@file Password recovery page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <pip-recover-password-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\">\\n' +\n    '\\n' +\n    '        </pip-recover-password-panel>\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\" class=\"rm8\" aria-label=\"CANCEL\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" class=\"md-accent\" ng-click=\"onRecover()\"\\n' +\n    '                       aria-label=\"RECOVER_PWD_RECOVER\"\\n' +\n    '                       ng-disabled=\"(form.$pristine && !data.email) || data.serverUrl.length == 0 || data.email.length == 0\">\\n' +\n    '                {{::\\'RECOVER_PWD_RECOVER\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-button ng-show=\"transaction.busy()\" class=\"md-warn\" ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('recover_password/recover_password_dialog.html',\n    '<!--\\n' +\n    '@file Recover password dialog\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-entry lp0 rp0\">\\n' +\n    '    <md-dialog-content>\\n' +\n    '        <pip-recover-password-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\"\\n' +\n    '                pip-goto-reset=\"pipGotoReset\">\\n' +\n    '\\n' +\n    '        </pip-recover-password-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '\\n' +\n    '    <md-dialog-actions layout=\"row\" layout-align=\"end center\">\\n' +\n    '        <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\" class=\"rm8\" aria-label=\"CANCEL\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '\\n' +\n    '        <md-button ng-hide=\"transaction.busy()\" class=\"md-accent\" ng-click=\"onRecover()\"\\n' +\n    '                   aria-label=\"RECOVER_PWD_RECOVER\"\\n' +\n    '                   ng-disabled=\"(form.$pristine && !data.email) || data.email== undefined ||\\n' +\n    '                           || data.serverUrl.length == 0 || data.email.length == 0\">\\n' +\n    '            {{::\\'RECOVER_PWD_RECOVER\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '\\n' +\n    '        <md-button ng-show=\"transaction.busy()\" class=\"md-warn\" ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </md-dialog-actions>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('recover_password/recover_password_panel.html',\n    '<div class=\"pip-body\">\\n' +\n    '    <div class=\"pip-content\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '\\n' +\n    '        <h2>{{\\'RECOVER_PWD_TITLE\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '        <p class=\"text-primary tm0 bm16\">{{\\'RECOVER_PWD_TEXT_1\\' | translate}} </p>\\n' +\n    '\\n' +\n    '        <p class=\"text-primary tm0 bm16\">{{\\'RECOVER_PWD_TEXT_2\\' | translate}}</p>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate>\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8\"  md-auto-hide=\"false\">\\n' +\n    '                <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                    {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <a ng-hide=\"showServerUrl || fixedServerUrl\" ng-click=\"showServerUrl = true\" href=\"\">\\n' +\n    '                {{\\'ENTRY_CHANGE_SERVER\\' | translate}}\\n' +\n    '            </a>\\n' +\n    '\\n' +\n    '            <div ng-show=\"showServerUrl\">\\n' +\n    '                <md-autocomplete\\n' +\n    '                        ng-initial autofocus tabindex=\"1\"\\n' +\n    '                        class=\"pip-combobox w-stretch bm8\"\\n' +\n    '                        name=\"server\"\\n' +\n    '                        ng-enabled=\"!transaction.busy()\"\\n' +\n    '                        placeholder=\"{{::\\'ENTRY_SERVER_URL\\' | translate}}\"\\n' +\n    '                        md-no-cache=\"true\"\\n' +\n    '                        md-selected-item=\"data.serverUrl\"\\n' +\n    '                        md-search-text=\"selected.searchURLs\"\\n' +\n    '                        md-items=\"item in getMatches()\"\\n' +\n    '                        md-item-text=\"item\"\\n' +\n    '                        md-selected-item-change=\"onServerUrlChanged()\"\\n' +\n    '                        md-delay=\"200\"\\n' +\n    '                        ng-model=\"data.serverUrl\"\\n' +\n    '                        pip-clear-errors>\\n' +\n    '                    <span md-highlight-text=\"selected.searchURLs\">{{item}}</span>\\n' +\n    '                </md-autocomplete>\\n' +\n    '            </div>\\n' +\n    '            <md-input-container class=\"pip-no-hint\" style=\"padding-bottom: 4px!important;\">\\n' +\n    '                <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                <input name=\"email\" type=\"email\"\\n' +\n    '                       ng-model=\"data.email\"\\n' +\n    '                       pip-email-unique=\"data.email\"\\n' +\n    '                       required step=\"any\" pip-clear-errors\\n' +\n    '                       ng-disabled=\"transaction.busy()\" tabindex=\"2\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.email).hint\">\\n' +\n    '                    {{::\\'HINT_EMAIL\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.email)\"\\n' +\n    '                     class=\"md-input-error\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"emailUnique\">{{::\\'ERROR_1104\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1100\">{{::\\'ERROR_1100\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1106\">{{::\\'ERROR_1106\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '        </form>\\n' +\n    '\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('reset_password/reset_password.html',\n    '<!--\\n' +\n    '@file Password reset page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '\\n' +\n    '        <pip-reset-password-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\">\\n' +\n    '\\n' +\n    '        </pip-reset-password-panel>\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\" class=\"rm8\" aria-label=\"CANCEL\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" ng-click=\"onReset()\" aria-label=\"ENTRY_SET_PASSWORD\"\\n' +\n    '                       ng-disabled=\"(form.$pristine && !data.email) || data.serverUrl.length == 0 ||\\n' +\n    '                       data.email.length == 0 || data.code.length == 0 || data.password.length < 6\"\\n' +\n    '                       class=\"md-accent\" type=\"submit\">\\n' +\n    '                {{::\\'ENTRY_SET_PASSWORD\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-warn\" ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('reset_password/reset_password_dialog.html',\n    '<!--\\n' +\n    '@file Reset password\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-entry  lp0 rp0\">\\n' +\n    '    <md-dialog-content>\\n' +\n    '        <pip-reset-password-panel\\n' +\n    '                pip-data=\"data\"\\n' +\n    '                pip-created=\"$panel = $control\">\\n' +\n    '\\n' +\n    '        </pip-reset-password-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '\\n' +\n    '    <md-dialog-actions layout=\"row\" layout-align=\"end center\">\\n' +\n    '        <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\" class=\"rm8\" aria-label=\"CANCEL\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '        <md-button ng-hide=\"transaction.busy()\" ng-click=\"onReset()\" aria-label=\"ENTRY_SET_PASSWORD\"\\n' +\n    '                   ng-disabled=\"(form.$pristine && !data.email) || data.serverUrl.length == 0 ||\\n' +\n    '                       data.email.length == 0 || data.code.length == 0 || data.password.length < 6\"\\n' +\n    '                   class=\"md-accent\" type=\"submit\">\\n' +\n    '            {{::\\'ENTRY_SET_PASSWORD\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '        <md-button class=\"md-warn\" ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '            {{::\\'CANCEL\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </md-dialog-actions>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('reset_password/reset_password_panel.html',\n    '<div class=\"pip-body\">\\n' +\n    '    <div class=\"pip-content\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()  && showServerError\" md-mode=\"indeterminate\"\\n' +\n    '                            class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '\\n' +\n    '        <h2>{{::\\'RESET_PWD_PASSWORD\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '        <p class=\"title-padding bm16\">\\n' +\n    '            {{::\\'RESET_PWD_TEXT\\' | translate}}\\n' +\n    '        </p>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate>\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8\"  md-auto-hide=\"false\">\\n' +\n    '                <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                    {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <a ng-hide=\"showServerUrl || fixedServerUrl\" ng-click=\"showServerUrl = true\" href=\"\">\\n' +\n    '                {{::\\'ENTRY_CHANGE_SERVER\\' | translate}}\\n' +\n    '            </a>\\n' +\n    '\\n' +\n    '            <div ng-show=\"showServerUrl\">\\n' +\n    '                <md-autocomplete\\n' +\n    '                        ng-initial autofocus tabindex=\"1\"\\n' +\n    '                        class=\"pip-combobox w-stretch bm8\"\\n' +\n    '                        name=\"server\"\\n' +\n    '                        ng-enabled=\"!transaction.busy()\"\\n' +\n    '                        placeholder=\"{{::\\'ENTRY_SERVER_URL\\' | translate}}\"\\n' +\n    '                        md-no-cache=\"true\"\\n' +\n    '                        md-selected-item=\"data.serverUrl\"\\n' +\n    '                        md-search-text=\"selected.searchURLs\"\\n' +\n    '                        md-items=\"item in getMatches()\"\\n' +\n    '                        md-item-text=\"item\"\\n' +\n    '                        md-selected-item-change=\"onServerUrlChanged()\"\\n' +\n    '                        md-delay=\"200\"\\n' +\n    '                        ng-model=\"data.serverUrl\"\\n' +\n    '                        pip-clear-errors>\\n' +\n    '                    <span md-highlight-text=\"selected.searchURLs\">{{item}}</span>\\n' +\n    '                </md-autocomplete>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"pip-no-hint\" style=\"padding-bottom: 4px!important;\">\\n' +\n    '                <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                <input name=\"email\" type=\"email\" ng-model=\"data.email\" required step=\"any\" pip-clear-errors\\n' +\n    '                       ng-disabled=\"transaction.busy()\" tabindex=\"2\" pip-email-unique=\"data.email\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.email).hint\">\\n' +\n    '                    {{::\\'HINT_EMAIL\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.email)\" class=\"md-input-error\"  md-auto-hide=\"false\">\\n' +\n    '\\n' +\n    '                    <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"emailUnique\">{{::\\'ERROR_1104\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1100\">{{::\\'ERROR_1100\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1106\">{{::\\'ERROR_1106\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"pip-no-hint\">\\n' +\n    '                <label>{{::\\'ENTRY_RESET_CODE\\' | translate}}</label>\\n' +\n    '                <input name=\"code\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                       ng-model=\"data.code\" required tabindex=\"3\" pip-clear-errors/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.code).hint\">\\n' +\n    '                    {{::\\'ENTRY_RESET_CODE\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.code)\" class=\"md-input-error\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'ERROR_CODE_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1108\">{{::\\'ERROR_1108\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1109\">{{::\\'ERROR_1109\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"pip-no-hint\" style=\"padding-bottom: 4px!important;\">\\n' +\n    '                <label>{{::\\'PASSWORD\\' | translate}}</label>\\n' +\n    '                <input name=\"password\" ng-disabled=\"transaction.busy()\" pip-clear-errors\\n' +\n    '                       type=\"password\" tabindex=\"4\" ng-model=\"data.password\"\\n' +\n    '                       required minlength=\"6\"/>\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.password).hint\">\\n' +\n    '                    {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.password)\"\\n' +\n    '                     class=\"md-input-error\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'MINLENGTH_PASSWORD\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"minlength\">{{::\\'MINLENGTH_PASSWORD\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1102\">{{::\\'ERROR_1102\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1103\">{{::\\'ERROR_1103\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1105\">{{::\\'ERROR_1105\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '        </form>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signin/signin.html',\n    '<!--\\n' +\n    '@file Signin page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <pip-signin-panel pipfixedServerUrl=\"fixedServerUrl\"></pip-signin-panel>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signin/signin_dialog.html',\n    '<!--\\n' +\n    '@file Signin dialog\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-entry\">\\n' +\n    '    <md-dialog-content>\\n' +\n    '        <pip-signin-panel pip-goto-signup-dialog=\"pipGotoSignupDialog\"\\n' +\n    '                          pip-goto-recover-password-dialog=\"pipGotoRecoverPasswordDialog\">\\n' +\n    '        </pip-signin-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signin/signin_panel.html',\n    '<div class=\"pip-body\">\\n' +\n    '    <div class=\"pip-content\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '\\n' +\n    '        <h2 pip-translate=\"SIGNIN_TITLE\"></h2>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate>\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8 color-error\"  md-auto-hide=\"false\">\\n' +\n    '                <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                    {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <a ng-hide=\"showServerUrl || fixedServerUrl\"\\n' +\n    '               ng-click=\"showServerUrl = true\" href=\"\"\\n' +\n    '               id=\"link-server-url\"\\n' +\n    '               pip-test=\"link-server-url\">\\n' +\n    '                {{::\\'ENTRY_CHANGE_SERVER\\' | translate}}\\n' +\n    '            </a>\\n' +\n    '\\n' +\n    '            <div ng-show=\"showServerUrl\">\\n' +\n    '                <md-autocomplete\\n' +\n    '                        ng-initial autofocus tabindex=\"1\"\\n' +\n    '                        class=\"pip-combobox w-stretch bm8\"\\n' +\n    '                        name=\"server\"\\n' +\n    '                        placeholder=\"{{::\\'ENTRY_SERVER_URL\\' | translate}}\"\\n' +\n    '                        md-no-cache=\"true\"\\n' +\n    '                        md-selected-item=\"data.serverUrl\"\\n' +\n    '                        md-search-text=\"selected.searchURLs\"\\n' +\n    '                        md-items=\"item in getMatches()\"\\n' +\n    '                        md-item-text=\"item\"\\n' +\n    '                        md-selected-item-change=\"onServerUrlChanged()\"\\n' +\n    '                        md-delay=\"200\"\\n' +\n    '                        ng-model=\"data.serverUrl\"\\n' +\n    '                        ng-disabled=\"transaction.busy()\"\\n' +\n    '                        pip-clear-errors\\n' +\n    '                        pip-test=\"autocomplete-server\">\\n' +\n    '                    <span md-highlight-text=\"selected.searchURLs\">{{item}}</span>\\n' +\n    '                </md-autocomplete>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"display  bp4\">\\n' +\n    '                <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                <input name=\"email\" type=\"email\" ng-model=\"data.email\" required step=\"any\"\\n' +\n    '                       ng-keypress=\"onEnter($event)\"\\n' +\n    '                       pip-clear-errors\\n' +\n    '                       ng-disabled=\"transaction.busy()\" tabindex=\"2\"\\n' +\n    '                       pip-test=\"input-email\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.email).hint\">\\n' +\n    '                    {{::\\'HINT_EMAIL\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.email)\" md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1100\">{{::\\'ERROR_1100\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1106\">{{::\\'ERROR_1106\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1114\">{{::\\'ERROR_1114\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '            <md-input-container class=\"display bp4\">\\n' +\n    '                <label>{{::\\'PASSWORD\\' | translate}}</label>\\n' +\n    '                <input name=\"password\" ng-disabled=\"transaction.busy()\" pip-clear-errors\\n' +\n    '                       type=\"password\" tabindex=\"3\" ng-model=\"data.password\"\\n' +\n    '                       ng-keypress=\"onEnter($event)\"\\n' +\n    '                       required minlength=\"6\"\\n' +\n    '                       pip-test=\"input-password\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.password).hint\">\\n' +\n    '                    {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.password)\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'HINT_PASSWORD\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"minlength\">{{::\\'HINT_PASSWORD\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1102\">{{::\\'ERROR_1102\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1107\">{{::\\'ERROR_1107\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '            <a href=\"\" class=\"display bm16\"\\n' +\n    '               ng-click=\"gotoRecoverPassword()\"\\n' +\n    '               tabindex=\"4\">\\n' +\n    '                {{::\\'SIGNIN_FORGOT_PASSWORD\\' | translate}}</a>\\n' +\n    '\\n' +\n    '            <md-checkbox ng-disabled=\"transaction.busy()\" md-no-ink class=\"lm0\"\\n' +\n    '                         aria-label=\"{{\\'SIGNIN_REMEMBER\\' | translate}}\" tabindex=\"5\"\\n' +\n    '                         ng-model=\"data.remember\"\\n' +\n    '                         pip-test-checkbox=\"remember\">\\n' +\n    '                <label class=\"label-check\">{{::\\'SIGNIN_REMEMBER\\' | translate}}</label>\\n' +\n    '            </md-checkbox>\\n' +\n    '\\n' +\n    '            <div style=\"height: 36px; overflow: hidden;\">\\n' +\n    '                <md-button ng-if=\"!transaction.busy()\" ng-click=\"onSignin()\" aria-label=\"SIGNIN\"\\n' +\n    '                           class=\"md-raised md-accent w-stretch m0\" tabindex=\"6\"\\n' +\n    '                           ng-disabled=\"(data.email == undefined) || data.email.length == 0 || data.serverUrl == \\'\\' ||\\n' +\n    '                                   data.serverUrl == undefined || data.serverUrl.length == 0 || (data.password == undefined)\"\\n' +\n    '                           pip-test=\"button-signin\">\\n' +\n    '                    {{::\\'SIGNIN_TITLE\\' | translate}}\\n' +\n    '                </md-button>\\n' +\n    '                <md-button ng-if=\"transaction.busy()\" ng-click=\"transaction.abort()\" class=\"md-raised md-warn m0 w-stretch\"\\n' +\n    '                           tabindex=\"5\" aria-label=\"ABORT\"\\n' +\n    '                           pip-test=\"button-cancel\">\\n' +\n    '                    {{::\\'CANCEL\\' | translate}}\\n' +\n    '                </md-button>\\n' +\n    '            </div>\\n' +\n    '            <div layout=\"row\" class=\"tm24\" ng-if=\"!adminOnly && $mdMedia(\\'gt-xs\\')\">\\n' +\n    '                <p class=\"m0 text-small\"> <!--  <p class=\"a-question-text\">  -->\\n' +\n    '                    {{::\\'SIGNIN_NOT_MEMBER\\' | translate}}\\n' +\n    '                    <a href=\"\"\\n' +\n    '                       ng-click=\"gotoSignup()\"\\n' +\n    '                       tabindex=\"6\">\\n' +\n    '                        {{::\\'SIGNIN_SIGNUP_HERE\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                </p>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"tm24 divider-top\"\\n' +\n    '                 style=\"margin-right: -16px; margin-left: -16px; background-color: rgb(238, 238, 238);\"\\n' +\n    '                 ng-if=\"!adminOnly && $mdMedia(\\'xs\\')\">\\n' +\n    '                <div class=\"h48\" layout=\"row\" layout-align=\"center end\">\\n' +\n    '                    <p class=\"m0 text-small\">{{::\\'SIGNIN_NOT_MEMBER\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '                <div class=\"h48\" layout=\"row\" layout-align=\"center start\">\\n' +\n    '                    <a class=\"text-small\" ng-click=\"gotoSignup()\" href=\"\" tabindex=\"6\">\\n' +\n    '                        {{::\\'SIGNIN_SIGNUP_HERE\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '        </form>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signup/signup.html',\n    '<!--\\n' +\n    '@file Signup page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <pip-signup-panel>\\n' +\n    '        </pip-signup-panel>\\n' +\n    '    </pip-card>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signup/signup_dialog.html',\n    '<!--\\n' +\n    '@file Signup page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-entry\">\\n' +\n    '    <md-dialog-content>\\n' +\n    '        <pip-signup-panel pip-goto-signin-dialog=\"pipGotoSigninDialog\"\\n' +\n    '                          pip-post-signup=\"pipPostSignup\"></pip-signup-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '</md-dialog>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('signup/signup_panel.html',\n    '<div class=\"pip-body \">\\n' +\n    '    <div class=\"pip-content\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '        </md-progress-linear>\\n' +\n    '\\n' +\n    '        <h2 pip-translate=\"SIGNUP_TITLE\"></h2>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate autocomplete=\"off\">\\n' +\n    '            <input type=\"email\" style=\"display:none\">\\n' +\n    '            <input type=\"password\" style=\"display:none\">\\n' +\n    '\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8\"  md-auto-hide=\"false\">\\n' +\n    '                <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                    {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <a ng-hide=\"showServerUrl || fixedServerUrl\" ng-click=\"showServerUrl = true\" href=\"\">\\n' +\n    '                {{::\\'ENTRY_CHANGE_SERVER\\' | translate}}\\n' +\n    '            </a>\\n' +\n    '\\n' +\n    '            <div ng-show=\"showServerUrl\">\\n' +\n    '                <md-autocomplete\\n' +\n    '                        ng-initial autofocus tabindex=\"1\"\\n' +\n    '                        class=\"pip-combobox w-stretch bm8\"\\n' +\n    '                        name=\"server\"\\n' +\n    '                        ng-enabled=\"!transaction.busy()\"\\n' +\n    '                        placeholder=\"{{::\\'ENTRY_SERVER_URL\\' | translate}}\"\\n' +\n    '                        md-no-cache=\"true\"\\n' +\n    '                        md-selected-item=\"data.serverUrl\"\\n' +\n    '                        md-search-text=\"selected.searchURLs\"\\n' +\n    '                        md-items=\"item in getMatches()\"\\n' +\n    '                        md-item-text=\"item\"\\n' +\n    '                        md-selected-item-change=\"onServerUrlChanged()\"\\n' +\n    '                        md-delay=\"200\"\\n' +\n    '                        ng-model=\"data.serverUrl\"\\n' +\n    '                        ng-disabled=\"transaction.busy()\"\\n' +\n    '                        pip-clear-errors>\\n' +\n    '                    <span md-highlight-text=\"selected.searchURLs\">{{item}}</span>\\n' +\n    '                </md-autocomplete>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '\\n' +\n    '            <md-input-container class=\"display bp4\">\\n' +\n    '                <label>{{::\\'FULLNAME\\' | translate}}</label>\\n' +\n    '                <input name=\"signupFullName\"\\n' +\n    '                       ng-disabled=\"transaction.busy()\" autocomplete=\"off\"\\n' +\n    '                       ng-model=\"data.name\" ng-init=\"data.name = \\'\\'\"\\n' +\n    '                       required tabindex=\"2\" pip-clear-errors\\n' +\n    '                       ng-keypress=\"onEnter($event)\">\\n' +\n    '\\n' +\n    '                <div class=\"hint text-overflow w-stretch\"\\n' +\n    '                     ng-if=\"touchedErrorsWithHint(form, form.signupFullName).hint\">\\n' +\n    '                    {{::\\'HINT_FULLNAME\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.signupFullName)\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">\\n' +\n    '                        {{::\\'HINT_FULLNAME\\' | translate}} {{::\\'ERROR_FULLNAME_INVALID\\' | translate }}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"ERROR_1101\">{{::\\'ERROR_1101\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"display bp4\">\\n' +\n    '                <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                <input name=\"userEmail\" ng-disabled=\"transaction.busy()\" pip-clear-errors\\n' +\n    '                       type=\"email\" tabindex=\"3\" ng-model=\"data.email\"\\n' +\n    '                       xxng-pattern=\"/^[_a-z0-9]+(\\\\.[_a-z0-9]+)*@[a-z0-9-]+(\\\\.[a-z0-9-]+)*(\\\\.[a-z]{2,4})$/\"\\n' +\n    '                       required\\n' +\n    '                       pip-email-unique=\"data.email\"\\n' +\n    '                       ng-keypress=\"onEnter($event)\"\\n' +\n    '                       pip-test=\"input-password\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.userEmail).hint\">\\n' +\n    '                    {{::\\'HINT_EMAIL\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.userEmail)\" md-auto-hide=\"false\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"emailUnique\">{{::\\'ERROR_1104\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1100\">{{::\\'ERROR_1100\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1106\">{{::\\'ERROR_1106\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1104\">{{::\\'ERROR_1104\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1300\">{{::\\'ERROR_1300\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1305\">{{::\\'ERROR_1305\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1301\">{{::\\'ERROR_1301\\' | translate}}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1114\">{{::\\'ERROR_1114\\' | translate}}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"display bp4\">\\n' +\n    '                <label>{{::\\'PASSWORD_SET\\' | translate}}</label>\\n' +\n    '                <input name=\"password\" ng-disabled=\"transaction.busy()\" pip-clear-errors\\n' +\n    '                       type=\"password\" tabindex=\"4\" ng-model=\"data.password\"\\n' +\n    '                       required minlength=\"6\"\\n' +\n    '                       ng-keypress=\"onEnter($event)\"\\n' +\n    '                       pip-test=\"input-password\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.password).hint\">\\n' +\n    '                    {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.password)\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"required\">\\n' +\n    '                        {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"minlength\">\\n' +\n    '                        {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"ERROR_1102\" ng-if=\"!form.password.$pristine\">\\n' +\n    '                        {{::\\'ERROR_1102\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"ERROR_1107\" ng-if=\"!form.password.$pristine\">\\n' +\n    '                        {{::\\'ERROR_1107\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"display bp4\">\\n' +\n    '                <label>{{::\\'PASSWORD_CONFIRM\\' | translate}}</label>\\n' +\n    '                <input name=\"passwordConfirm\"\\n' +\n    '                       type=\"password\" tabindex=\"4\"\\n' +\n    '                       required minlength=\"6\"\\n' +\n    '                       ng-model=\"confirmPassword\"\\n' +\n    '                       ng-disabled=\"transaction.busy()\" pip-clear-errors\\n' +\n    '                       compare-to=\"data.password\"\\n' +\n    '                       ng-keypress=\"onEnter($event)\"\\n' +\n    '                       pip-test=\"input-password\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"touchedErrorsWithHint(form, form.passwordConfirm).hint\">\\n' +\n    '                    {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                </div>\\n' +\n    '                <div ng-messages=\"touchedErrorsWithHint(form, form.passwordConfirm)\"  md-auto-hide=\"false\">\\n' +\n    '                    <div ng-message=\"compareTo\">\\n' +\n    '                        {{::\\'PASSWORD_MATCH\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"required\">\\n' +\n    '                        {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                    <div ng-message=\"minlength\">\\n' +\n    '                        {{::\\'HINT_PASSWORD\\' | translate}}\\n' +\n    '                    </div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <p class=\"text-small-secondary\">\\n' +\n    '                {{::\\'SIGNUP_TEXT_11\\' | translate}}\\n' +\n    '                <a href=\"#/legal/privacy\">{{::\\'SIGNUP_PRIVACY\\' | translate}}</a>\\n' +\n    '                {{::\\'SIGNUP_TEXT_12\\' | translate}}\\n' +\n    '                <a href=\"#/legal/services\">{{::\\'SIGNUP_SERVICES\\' | translate}}</a>\\n' +\n    '            </p>\\n' +\n    '\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" class=\"md-raised m0  md-accent w-stretch\"\\n' +\n    '                       ng-click=\"onSignup()\" aria-label=\"SIGNUP\"\\n' +\n    '                       ng-disabled=\"form.$invalid || (form.$pristine && !data.email) || data.serverUrl.length == 0\\n' +\n    '                               || data.email.length == 0 || (!data.password)\\n' +\n    '                               || (!data.name) || data.name.length == 0 || data.password.length == 0\">\\n' +\n    '                {{::\\'SIGNUP_TITLE\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-button ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\"\\n' +\n    '                       class=\"md-raised md-warn m0 w-stretch\" aria-label=\"ABORT\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <div layout=\"row\" class=\"tm24\" ng-if=\"$mdMedia(\\'gt-xs\\')\">\\n' +\n    '                <p class=\"text-small m0\">\\n' +\n    '                    {{::\\'SIGNUP_TEXT_2\\' | translate}}\\n' +\n    '                    <a href=\"\" ng-click=\"gotoSignin()\">\\n' +\n    '                        {{::\\'SIGNUP_SIGNIN_HERE\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                </p>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"tm24 divider-top\" ng-if=\"$mdMedia(\\'xs\\')\"\\n' +\n    '                 style=\"margin-right: -16px; margin-left: -16px; background-color: rgb(238, 238, 238);\">\\n' +\n    '                <div class=\"h48\" layout=\"row\" layout-align=\"center end\">\\n' +\n    '                    <p class=\"bm0 text-small\">{{::\\'SIGNUP_TEXT_2\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '                <div class=\"h48\" layout=\"row\" layout-align=\"center start\">\\n' +\n    '                    <p class=\"bm0 text-small\"><a href=\"\" ng-click=\"gotoSignin()\">\\n' +\n    '                        {{::\\'SIGNUP_SIGNIN_HERE\\' | translate}}</a></p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '        </form>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('verify_email/verify_email.html',\n    '<!--\\n' +\n    '@file Verify email page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <div class=\"pip-body\">\\n' +\n    '            <div class=\"pip-content\">\\n' +\n    '                <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\" >\\n' +\n    '                </md-progress-linear>\\n' +\n    '\\n' +\n    '                <h2>{{\\'VERIFY_EMAIL_TITLE\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '                <p class=\"title-padding\">{{\\'VERIFY_EMAIL_TEXT_1\\' | translate}} </p>\\n' +\n    '\\n' +\n    '                <form name=\\'form\\' novalidate>\\n' +\n    '                    <div ng-messages=\"form.$serverError\" class=\"text-error bm8\">\\n' +\n    '                        <div ng-message=\"ERROR_1000\">{{::\\'ERROR_1000\\' | translate}}</div>\\n' +\n    '                        <div ng-message=\"ERROR_1110\">{{::\\'ERROR_1110\\' | translate}}</div>\\n' +\n    '                        <div ng-message=\"ERROR_1111\">{{::\\'ERROR_1111\\' | translate}}</div>\\n' +\n    '                        <div ng-message=\"ERROR_1112\">{{::\\'ERROR_1112\\' | translate}}</div>\\n' +\n    '                        <div ng-message=\"ERROR_-1\">{{::\\'ERROR_SERVER\\' | translate}}</div>\\n' +\n    '                        <div ng-message=\"ERROR_UNKNOWN\">\\n' +\n    '                            {{ form.$serverError.ERROR_UNKNOWN | translate }}\\n' +\n    '                        </div>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                    <a ng-hide=\"showServerUrl || fixedServerUrl\" ng-click=\"showServerUrl = true\" href=\"\">      \\n' +\n    '                        {{\\'ENTRY_CHANGE_SERVER\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                    <div ng-show=\"showServerUrl\">\\n' +\n    '                        <md-autocomplete\\n' +\n    '                                ng-initial autofocus tabindex=\"1\"\\n' +\n    '                                class=\"pip-combobox w-stretch bm8\"\\n' +\n    '                                name=\"server\"\\n' +\n    '                                ng-enabled=\"!transaction.busy()\"\\n' +\n    '                                placeholder=\"{{::\\'ENTRY_SERVER_URL\\' | translate}}\"\\n' +\n    '                                md-no-cache=\"true\"\\n' +\n    '                                md-selected-item=\"data.serverUrl\"\\n' +\n    '                                md-search-text=\"selected.searchURLs\"\\n' +\n    '                                md-items=\"item in getMatches()\"\\n' +\n    '                                md-item-text=\"item\"\\n' +\n    '                                md-selected-item-change=\"onServerUrlChanged()\"\\n' +\n    '                                md-delay=\"200\"\\n' +\n    '                                ng-model=\"data.serverUrl\"\\n' +\n    '                                pip-clear-errors>\\n' +\n    '                            <span md-highlight-text=\"selected.searchURLs\">{{item}}</span>\\n' +\n    '                        </md-autocomplete>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                    <md-input-container class=\"pip-no-hint\" style=\"padding-bottom: 4px!important;\">\\n' +\n    '                        <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                        <input name=\"email\" type=\"email\" ng-model=\"data.email\" required step=\"any\"  pip-clear-errors\\n' +\n    '                               ng-disabled=\"transaction.busy()\" tabindex=\"2\" />\\n' +\n    '\\n' +\n    '                        <div ng-messages=\"touchedErrorsWithHint(form, form.email)\" ng-if=\"!form.email.$pristine\" class=\"md-input-error\">\\n' +\n    '                            <div ng-message=\"hint\" class=\"pip-input-hint\">{{::\\'HINT_EMAIL\\' | translate}}</div>\\n' +\n    '                            <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                            <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1100\">{{::\\'ERROR_1100\\' | translate}}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1104\">{{::\\'ERROR_1104\\' | translate}}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1305\">{{::\\'ERROR_1305\\' | translate}}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1106\">{{::\\'ERROR_1106\\' | translate}}</div>\\n' +\n    '                        </div>\\n' +\n    '                    </md-input-container>\\n' +\n    '\\n' +\n    '                    <md-input-container class=\"pip-no-hint\">\\n' +\n    '                        <label>{{::\\'ENTRY_RESET_CODE\\' | translate}}</label>\\n' +\n    '                        <input name=\"code\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                               ng-model=\"data.code\" required tabindex=\"3\" />\\n' +\n    '\\n' +\n    '                        <div ng-messages=\"touchedErrorsWithHint(form, form.code)\" ng-if=\"!form.fullName.$pristine\" class=\"md-input-error\">\\n' +\n    '                            <div ng-message=\"hint\" class=\"pip-input-hint\">{{::\\'ENTRY_RESET_CODE\\' | translate}}</div>\\n' +\n    '                            <div ng-message=\"required\">{{::\\'ERROR_CODE_INVALID\\' | translate }}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1108\">{{::\\'ERROR_1108\\' | translate}}</div>\\n' +\n    '                        </div>\\n' +\n    '                    </md-input-container>\\n' +\n    '\\n' +\n    '                    <p> \\n' +\n    '                        {{\\'VERIFY_EMAIL_TEXT_21\\' | translate}} \\n' +\n    '                        <a ng-click=\"onRecover()\" class=\"pointer\" href=\"\">{{\\'VERIFY_EMAIL_RESEND\\' | translate}}</a>\\n' +\n    '                        {{\\'VERIFY_EMAIL_TEXT_22\\' | translate}} \\n' +\n    '                    </p>\\n' +\n    '                </form>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-click=\"goBack()\" ng-hide=\"transaction.busy()\" class=\"rm8\" aria-label=\"CANCEL\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onVerify()\" ng-hide=\"transaction.busy()\" aria-label=\"VERIFY\"\\n' +\n    '                ng-disabled=\"data.code.length == 0 || data.email.length == 0 || (!data.email && form.$pristine) || (!data.code)\">\\n' +\n    '                {{::\\'VERIFY\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-warn \" ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" aria-label=\"ABORT\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipEntry.Templates');\n} catch (e) {\n  module = angular.module('pipEntry.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('verify_email/verify_email_success.html',\n    '<!--\\n' +\n    '@file Email verification success page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<div class=\"pip-card-container pip-outer-scroll pip-entry\">\\n' +\n    '    <pip-card width=\"400\">\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-click=\"onContinue()\" class=\"md-accent\">\\n' +\n    '                {{\\'CONTINUE\\' | translate}} \\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-body\">\\n' +\n    '            <div class=\"pip-content\">\\n' +\n    '                <h2>{{\\'VERIFY_EMAIL_TITLE\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '                <p class=\"title-padding\">\\n' +\n    '                    {{\\'VERIFY_EMAIL_SUCCESS_TEXT\\' | translate}} \\n' +\n    '                </p>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </pip-card>\\n' +\n    '</div>');\n}]);\n})();\n","/**\r\n * @file Checking uniqueness of email in input control\r\n * @description\r\n * Email validation is performed on server via /api/signup_validate REST operation\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEmailUnique', ['ngResource', 'pipRest']);\r\n\r\n    thisModule.directive('pipEmailUnique',\r\n        ['$http', 'pipRest', function ($http, pipRest) {\r\n            return {\r\n                restrict: 'A',\r\n                require: 'ngModel',\r\n                link: function ($scope, $element, $attrs, ngModel) {\r\n                    var oldEmail = $attrs.pipEmailUnique;\r\n\r\n                    $scope.$watch($attrs.ngModel, _.throttle(function (newValue) {\r\n                        var oldHint = ngModel.$validators.emailUnique;\r\n                        if (!newValue || newValue.length == 0 || oldEmail == newValue) {\r\n                            ngModel.$setValidity('emailUnique', oldHint);\r\n                            return;\r\n                        }\r\n\r\n                        if (!newValue) ngModel.$setValidity('emailUnique', true);\r\n\r\n                        pipRest.signupValidate().call(\r\n                            {\r\n                                email: newValue\r\n                            },\r\n                            function (data) {\r\n                                ngModel.$setValidity('emailUnique', true);\r\n                            },\r\n                            function (err) {\r\n                                ngModel.$setValidity('emailUnique', false);\r\n                            }\r\n                        );\r\n                    }, 500));\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Entry common logic\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.Common', []);\r\n\r\n    thisModule.provider('pipEntry', function() {\r\n        var\r\n            adminOnly = false,\r\n            fixedServerUrl = null;\r\n        \r\n        this.adminOnly = function(newAdminOnly) {\r\n            adminOnly = newAdminOnly;  \r\n        };\r\n\r\n        this.fixedServerUrl = function(newFixedServerUrl) {\r\n            fixedServerUrl  = newFixedServerUrl; \r\n        };\r\n\r\n        this.$get = function () {\r\n            return {\r\n                adminOnly: function() {\r\n                    return adminOnly;\r\n                },\r\n                \r\n                fixedServerUrl: function() {\r\n                    return fixedServerUrl;\r\n                }\r\n            };\r\n        }\r\n    });\r\n\r\n    thisModule.factory('pipEntryCommon',\r\n        ['$rootScope', '$state', '$window', 'pipAppBar', 'pipSession', 'pipRest', 'pipEntry', function ($rootScope, $state, $window, pipAppBar, pipSession, pipRest, pipEntry) {\r\n            return {\r\n                configureAppBar: configureAppBar,\r\n                initScope: initScope\r\n            };\r\n            \r\n            //---------------------\r\n            \r\n            function configureAppBar() {\r\n                pipAppBar.hideNavIcon();\r\n                if (pipAppBar.appLogo) {\r\n                    pipAppBar.showTitleLogo(pipAppBar.appLogo);\r\n                }\r\n                else {\r\n                    pipAppBar.showTitleLogo('images/piplife_logo.svg');\r\n                }\r\n                pipAppBar.showLanguage();\r\n                pipAppBar.showShadow();\r\n                pipAppBar.hideSearch();\r\n            };\r\n\r\n            function initScope($scope) {\r\n                $scope.adminOnly = pipEntry.adminOnly();\r\n                $scope.data = {\r\n                    serverUrl: pipRest.serverUrl(), //$state.params.server_url || 'http://alpha.pipservices.net',\r\n                    email: ($state.name != 'signup' && $state.params.email) ? $state.params.email : null,\r\n                    password: '',\r\n                    remember: false,\r\n                    adminOnly: $scope.adminOnly,\r\n                    name: $state.params.name || null, // signout\r\n                    code: $state.params.code || null\r\n                };\r\n        \r\n                $scope.showServerUrl = false;\r\n                $scope.fixedServerUrl = false;\r\n                $scope.data.serverUrl = $scope.data.serverUrl || pipSession.usedServerUrls();\r\n        \r\n                // Fixed server url shall disable changing URL by the user\r\n                if (pipEntry.fixedServerUrl()) {\r\n                    $scope.data.serverUrl = pipEntry.fixedServerUrl();\r\n                    $scope.fixedServerUrl = true;  \r\n                }\r\n                        \r\n                if ($state.name != 'signup') {\r\n                    $scope.data.email = $scope.data.email || pipSession.lastUsedEmail($scope.data.serverUrl);\r\n                    // $scope.data.password = $scope.data.password || pipSession.lastUsedPassword($scope.data.serverUrl);\r\n                }\r\n                $scope.serverUrls = pipSession.usedServerUrls();\r\n                $scope.servers = pipSession.usedServers();\r\n        \r\n                $scope.selected = {};\r\n                $scope.selected.searchURLs = $scope.data.serverUrl;\r\n        \r\n                // Set email from history\r\n                if ($scope.data.serverUrl && !$scope.data.email && $state.name != 'signup') {\r\n                    var server = $scope.servers[$scope.data.serverUrl];\r\n                    $scope.data.email = (server || {}).email;\r\n                }\r\n\r\n                $scope.filterItem = filterItem;\r\n                $scope.getMatches = getMatches;\r\n                $scope.onServerUrlChanged = onServerUrlChanged;\r\n                $scope.isEmpty = _.isEmpty;\r\n\r\n                return;\r\n                \r\n                //---------------------------\r\n        \r\n                function filterItem(item) {\r\n                    var result = ($scope.selected.searchURLs\r\n                        && item\r\n                        && item.toLowerCase().indexOf($scope.selected.searchURLs.toLowerCase()) >= 0);\r\n                    return result;\r\n                };\r\n        \r\n                function getMatches() {\r\n                    if (!$scope.selected.searchURLs)\r\n                        return $scope.showServerUrl;\r\n                    $scope.data.serverUrl = $scope.selected.searchURLs;\r\n                    return _.filter($scope.serverUrls, $scope.filterItem);\r\n                };\r\n        \r\n                function onServerUrlChanged() {\r\n                    // Change server url for REST API\r\n                    pipRest.serverUrl($scope.data.serverUrl);\r\n                    \r\n                    if (!$scope.selected.searchURLs) return;\r\n                    var server = $scope.servers[$scope.data.serverUrl];\r\n        \r\n                    if (server && $state.name != 'signup') {\r\n                        $scope.data.email = server.email;\r\n                        $scope.data.password = server.password;\r\n                    }\r\n                };\r\n            };            \r\n        }]\r\n    );\r\n   \r\n})();","/**\r\n * @file String resources for entry pages\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n    \r\n    var thisModule = angular.module('pipEntry.Strings', []);\r\n\r\n    thisModule.config(['pipTranslateProvider', function (pipTranslateProvider) {\r\n\r\n        // Set translation strings for the module\r\n        pipTranslateProvider.translations('en', {\r\n            // Common labels\r\n            'FULLNAME': 'First and last name',\r\n            'EMAIL': 'Email',\r\n            'PASSWORD': 'Password',\r\n            'LANGUAGE': 'Language',\r\n            'GENDER': 'Gender',\r\n            'BIRTHDAY': 'Birthday',\r\n            'LOCATION': 'Location',\r\n\r\n            // Common hints\r\n            'HINT_FULLNAME': \"Use your real name, so others know who you are\",\r\n            'HINT_PASSWORD': 'Minimum 6 characters',\r\n            'HINT_ABOUT': 'Few words about yourself',\r\n            'VERIFY_EMAIL': 'Please, verify your email address. ',\r\n            'HINT_EMAIL': 'Please, type your email address.',\r\n\r\n            // Sign In page\r\n            'SIGNIN_TITLE': 'Sign in',\r\n            'SIGNIN_NOT_MEMBER': 'Not a member?',\r\n            'SIGNIN_REMEMBER': 'Remember',\r\n            'SIGNIN_FORGOT_PASSWORD': 'Forgot password?',\r\n            'SIGNIN_SIGNUP_HERE': ' Sign up here',\r\n\r\n            // Sign Up page\r\n            'SIGNUP_TITLE': 'Sign up',\r\n            'SIGNUP_NOT_MEMBER': 'Not a member? Sign up now',\r\n            'SIGNUP_TEXT_11': 'By clicking Sign up, you agree to the',\r\n            'SIGNUP_PRIVACY': 'privacy statement',\r\n            'SIGNUP_TEXT_12': 'and',\r\n            'SIGNUP_SERVICES': 'services agreement',\r\n            'SIGNUP_TEXT_2': 'Do you have an account?',\r\n            'SIGNUP_SIGNIN_HERE': ' Sign in here',\r\n            'SIGNUP_EMAIL_REGISTERED': 'This email is already registered',\r\n            'SIGNUP_FULLNAME_WRONG': 'xxxx',\r\n            'SIGNUP_EMAIL_WRONG': 'xxxx',\r\n\r\n            // Sign Up Details page\r\n            'POST_SIGNUP_TITLE': 'Welcome to Pip.Life',\r\n            'POST_SIGNUP_TEXT_1': 'Your account was successfully created.',\r\n            'POST_SIGNUP_TEXT_2': 'Tell us some more about yourself.',\r\n\r\n            // Recover Password page\r\n            'RECOVER_PWD_TITLE': 'Forgot password?',\r\n            'RECOVER_PWD_TEXT_1': \"Enter the email address you used when you joined and we'll send you instructions to reset your password.\",\r\n            'RECOVER_PWD_TEXT_2': 'For security reasons, we do NOT store your password. So rest assured that we will never send your password via email.',\r\n            'RECOVER_PWD_RECOVER': 'Recover password',\r\n\r\n            // Reset Password page\r\n            'RESET_PWD_PASSWORD': 'Reset password',\r\n            'RESET_PWD_TEXT': 'Enter the email address together with the reset code you received in email from PipLife. Remember the code is only active for 24 hours.',\r\n            'RESET_PWD_SUCCESS_TEXT': 'Your password was successfully changed',\r\n\r\n            // Verify Email page\r\n            'VERIFY_EMAIL_TITLE': 'Email verification',\r\n            'VERIFY_EMAIL_TEXT_1': 'Confirm your email address using verification code',\r\n            'VERIFY_EMAIL_TEXT_21': \"If you haven't received the code, press \",\r\n            'VERIFY_EMAIL_RESEND': 'resend',\r\n            'VERIFY_EMAIL_TEXT_22': 'to send it again.',\r\n            'VERIFY_EMAIL_SUCCESS_TEXT': 'Your email address was successfully verified. Thank you!',\r\n\r\n            'PASSWORD_MATCH': 'Passwords don\\'t match',\r\n            'PASSWORD_CONFIRM': 'Confirm the password',\r\n            'PASSWORD_SET': 'Set a password',\r\n\r\n            // Common entry resources\r\n            'ENTRY_CHANGE_SERVER': 'Change server',\r\n            'ENTRY_SERVER_URL': 'Server URL',\r\n            'ENTRY_RESET_CODE': 'Reset code',\r\n            'ENTRY_VERIFICATION_CODE': 'Verification code',\r\n            'ENTRY_NEW_PASSWORD': 'New password',\r\n            'ENTRY_SET_PASSWORD': 'Set Password',\r\n            'ENTRY_FREE': 'Free',\r\n            'ENTRY_REPEAT': 'Repeat',\r\n\r\n            // Validation errors\r\n            'ERROR_EMAIL_INVALID': 'Enter a valid email',\r\n            'ERROR_PASSWORD_INVALID': 'Enter a valid password',\r\n            'ERROR_FULLNAME_INVALID': 'Enter full name',\r\n            'ERROR_CODE_INVALID': 'Enter a code from mail',\r\n            'ERROR_ACCOUNT_NOT_FOUND': 'User name or password are incorrect',\r\n            'ERROR_WRONG_PASSWORD': 'User name or password are incorrect', //'Wrong password',\r\n            'ERROR_CODE_WRONG': 'Wrong recovery code',\r\n            'ERROR_SERVER': 'Server is not responding',\r\n            'ERROR_SERVER_INVALID': 'Enter server URL',\r\n\r\n            //Languages\r\n            'LANGUAGE_RUSSIAN': 'Russian',\r\n            'LANGUAGE_ENGLISH': 'English'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            // Common labels\r\n            'FULLNAME': 'Имя и фамилия',\r\n            'EMAIL': 'Адрес эл.почты',\r\n            'PASSWORD': 'Пароль',\r\n            'LANGUAGE': 'Язык',\r\n            'GENDER': 'Пол',\r\n            'BIRTHDAY': 'Дата рождения',\r\n            'LOCATION': 'Местонахождение',\r\n\r\n            // Common hints\r\n            'HINT_FULLNAME': \"Используйте своё настоящее имя, чтобы другие знали с кем имеют дело\",\r\n            'HINT_PASSWORD': 'Минимум 6 символов',\r\n            'HINT_ABOUT': 'Несколько слов о себе',\r\n            'VERIFY_EMAIL': 'Подтвердите адрес своей эл.почты',\r\n            'HINT_EMAIL': 'Введите адрес своей эл.почты',\r\n\r\n            // Sign In page\r\n            'SIGNIN_TITLE': 'Вход в систему',\r\n            'SIGNIN_NOT_MEMBER': 'Еще не зарегистрировались?',\r\n            'SIGNIN_REMEMBER': 'Запомнить',\r\n            'SIGNIN_FORGOT_PASSWORD': 'Забыли пароль?',\r\n            'SIGNIN_SIGNUP_HERE': ' Зарегистрироваться здесь',\r\n\r\n            // Sign Up page\r\n            'SIGNUP_TITLE': 'Регистрация',\r\n            'SIGNUP_NOT_MEMBER': 'Новенький? Зарегистрируйтесь сейчас',\r\n            'SIGNUP_TEXT_11': 'Нажимая кнопку регистрация, я соглашаюсь с',\r\n            'SIGNUP_SERVICES': 'договором об услугах',\r\n            'SIGNUP_TEXT_12': 'и',\r\n            'SIGNUP_PRIVACY': 'соглашением о личных данных',\r\n            'SIGNUP_TEXT_2': 'Уже зарегистрировались?',\r\n            'SIGNUP_SIGNIN_HERE': ' Вход здесь',\r\n            'SIGNUP_EMAIL_REGISTERED': 'Данный адрес эл.почты уже занят',\r\n\r\n            // Sign Up Details page\r\n            'POST_SIGNUP_TITLE': 'Добро пожаловать в Pip.Life',\r\n            'POST_SIGNUP_TEXT_1': 'Ваша учетная запись создана.',\r\n            'POST_SIGNUP_TEXT_2': 'Несклько слов о о себе',\r\n\r\n            // Recover Password page\r\n            'RECOVER_PWD_TITLE': 'Забыли пароль?',\r\n            'RECOVER_PWD_TEXT_1': 'Введите адрес эл.почты, который вы использовали при регистрации и мы вышлем вам инструкции как изменить пароль.',\r\n            'RECOVER_PWD_TEXT_2': 'По соображениям безопасности мы НЕ храним пароли. Таким образом, мы никогда не пошлем ваш пароль по электронной почте.',\r\n            'RECOVER_PWD_RECOVER': 'Восстановить пароль',\r\n\r\n            // Reset Password page\r\n            'RESET_PWD_PASSWORD': 'Изменить пароль',\r\n            'RESET_PWD_TEXT': 'Введите адрес эл.почты вместе с кодом, который вы получили в почтовом сообщении от PipLife. Помните, что код действителен только 24 часа.',\r\n            'RESET_PWD_SUCCESS_TEXT': 'Ваш пароль успешно изменён',\r\n\r\n            // Verify Email page\r\n            'VERIFY_EMAIL_TITLE': 'Подтверждение адреса эл.почты',\r\n            'VERIFY_EMAIL_TEXT_1': 'Введите код, который вы получили по эл.почте',\r\n            'VERIFY_EMAIL_TEXT_21': \"Если вы не получили почтовое сообщение с кодом, нажмите \",\r\n            'VERIFY_EMAIL_RESEND': 'отправить снова',\r\n            'VERIFY_EMAIL_TEXT_22': '.',\r\n            'VERIFY_EMAIL_SUCCESS_TEXT': 'Адрес вашей электронной почты успешно подтвержден. Спасибо!',\r\n\r\n            'PASSWORD_MATCH': 'Пароли не совпадают',\r\n            'PASSWORD_CONFIRM': 'Подтвердите пароль',\r\n            'PASSWORD_SET': 'Задайте пароль',\r\n\r\n            // Common entry resources\r\n            'ENTRY_CHANGE_SERVER': 'Изменить сервер',\r\n            'ENTRY_SERVER_URL': 'URL сервера',\r\n            'ENTRY_RESET_CODE': 'Код подтверждения',\r\n            'ENTRY_VERIFICATION_CODE': 'Код проверки',\r\n            'ENTRY_NEW_PASSWORD': 'Новый пароль',\r\n            'ENTRY_SET_PASSWORD': 'Изменить пароль',\r\n            'ENTRY_FREE': 'бесплатно',\r\n            'ENTRY_REPEAT': 'Повторить',\r\n\r\n            // Validation errors\r\n            'ERROR_EMAIL_INVALID': 'Введите адрес электронной почты',\r\n            'ERROR_PASSWORD_INVALID': 'Введите пароль',\r\n            'ERROR_FULLNAME_INVALID': 'Введите полное имя',\r\n            'ERROR_CODE_INVALID': 'Введите код',\r\n            'ERROR_ACCOUNT_NOT_FOUND': 'Введено неверное имя пользователя или пароль',//'Такой пользователь не зарегистрирован',\r\n            'ERROR_WRONG_PASSWORD': 'Введено неверное имя пользователя или пароль', //'Неправильный пароль',\r\n            'ERROR_CODE_WRONG': 'Неправильный код',\r\n            'ERROR_SERVER': 'Сервер не отвечает. Проверьте URL сервера.',\r\n            'ERROR_SERVER_INVALID': 'Введите URL сервера',\r\n\r\n            //Languages\r\n            'LANGUAGE_RUSSIAN': 'Русский',\r\n            'LANGUAGE_ENGLISH': 'Английский'\r\n        });\r\n\r\n    }]);\r\n\r\n})();","/**\r\n * @file Checking uniqueness of email in input control\r\n * @description\r\n * Email validation is performed on server via /api/signup_validate REST operation\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipPasswordMatch', []);\r\n\r\n    thisModule.directive('compareTo',function() {\r\n        return {\r\n            require: \"ngModel\",\r\n            scope: {\r\n                otherModelValue: \"=compareTo\"\r\n            },\r\n            link: function(scope, element, attributes, ngModel) {\r\n\r\n                ngModel.$validators.compareTo = function(modelValue) {\r\n                    return modelValue == scope.otherModelValue;\r\n                };\r\n\r\n                scope.$watch(\"otherModelValue\", function() {\r\n                    ngModel.$validate();\r\n                });\r\n            }\r\n        };\r\n    });\r\n\r\n})();\r\n","/**\r\n * @file Entry post signup controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Fix error handling\r\n * - Make a better post-signup. Redo it with document layout\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n\r\n\r\n    var thisModule = angular.module('pipEntry.PostSignup', ['pipEntry.Common', \"pipPostSignupPanel\"]);\r\n\r\n    thisModule.controller('pipPostSignupController',\r\n        ['$scope', '$rootScope', 'pipAuthState', '$party', function ($scope, $rootScope, pipAuthState, $party) {\r\n\r\n            $scope.$party = $party;\r\n            $scope.onPostSignupSubmit = onPostSignupSubmit;\r\n\r\n            if ($scope.$panel) $scope.transaction = $scope.$panel.transacton;\r\n\r\n            return\r\n\r\n            function onPostSignupSubmit() {\r\n                if ($scope.$panel)  $scope.$panel.onPostSignupSubmit();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Post signup dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.PostSignupDialog', ['pipEntry.Common', \"pipPostSignupPanel\"]);\r\n\r\n    thisModule.factory('pipPostSignupDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'post_signup/post_signup_dialog.html',\r\n                        controller: 'pipPostSignupDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipPostSignupDialogController',\r\n        ['$scope', '$rootScope', '$location', 'pipSession', 'params', function ($scope, $rootScope, $location, pipSession, params) {\r\n            $scope.$party = params.$party;\r\n\r\n            $scope.onPostSignupSubmit = onPostSignupSubmit;\r\n\r\n            if ($scope.$panel) $scope.transaction = $scope.$panel.transacton;\r\n\r\n            return\r\n\r\n            function onPostSignupSubmit() {\r\n                if ($scope.$panel)  $scope.$panel.onPostSignupSubmit();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Post signup panel\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipPostSignupPanel\", ['pipUtils', 'pipFocused', 'pipEntry.Strings']);\r\n\r\n    thisModule.directive('pipPostSignupPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    data:'=pipData',\r\n                    created:'&pipCreated',\r\n                    $party:'=pipParty'\r\n\r\n                },\r\n                templateUrl: 'post_signup/post_signup_panel.html',\r\n                controller: 'pipPostSignupPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipPostSignupPanelController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipFormErrors', 'pipEntryCommon', '$state', '$mdMedia', 'pipTranslate', 'pipEnums', 'pipRest', 'pipUtils', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession,\r\n                  pipFormErrors, pipEntryCommon, $state, $mdMedia, pipTranslate, pipEnums, pipRest, pipUtils) {\r\n\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n            pipEntryCommon.initScope($scope);\r\n            $scope.showServerError = true;\r\n            $scope.genders = pipTranslate.translateSet(pipEnums.GENDERS);\r\n            $scope.languages = pipTranslate.translateSet(pipEnums.LANGUAGES);\r\n\r\n            $scope.data = {\r\n                id: $scope.$party.id,\r\n                name: $scope.$party.name,\r\n                email: $scope.$party.email,\r\n                about: $scope.$party.about,\r\n                language: pipTranslate.use(),\r\n                birthday: $scope.$party.birthday,\r\n                gender: $scope.$party.gender || pipEnums.GENDER.NOT_SPECIFIED,\r\n                location: $scope.$party.location\r\n            };\r\n\r\n            $scope.transaction = pipTransaction('entry.post_signup', $scope);\r\n\r\n            $scope.$control = {};\r\n            $scope.$control.onPostSignupSubmit = onPostSignupSubmit;\r\n            $scope.$control.transaction =  $scope.transaction;\r\n\r\n            if ($scope.created){\r\n                $scope.created({\r\n                    $control: $scope.$control\r\n                });\r\n            }\r\n\r\n            $scope.onPictureChanged = onPictureChanged;\r\n            $scope.onPictureCreated = onPictureCreated;\r\n            $scope.onPostSignupSubmit = onPostSignupSubmit;\r\n\r\n            return;\r\n\r\n            //---------------------------\r\n\r\n            function onPictureChanged($control) {\r\n                if($scope.picture)\r\n                    $scope.picture.save(\r\n                        // Success callback\r\n                        function() {},\r\n                        // Error callback\r\n                        function(error) {\r\n                            console.error(error);\r\n                        }\r\n                    );\r\n            };\r\n\r\n            function onPictureCreated($event) {\r\n                $scope.picture = $event.sender;\r\n            };\r\n\r\n            function onPostSignupSubmit() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n\r\n                var transactionId = $scope.transaction.begin('PROCESSING');\r\n                if (!transactionId) return;\r\n\r\n                pipRest.parties().update(\r\n                    $scope.data,\r\n\r\n                    function (party) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId)) return;\r\n\r\n                        $scope.transaction.end();\r\n\r\n                        if (!pipUtils.checkSupported()) {\r\n                            pipSession.signout();\r\n                            $state.go('errors_unsupported');\r\n                            return ;\r\n                        }\r\n\r\n                        pipAuthState.goToAuthorized({ party_id: party.id });\r\n                    },\r\n                    function (error) {\r\n                        $scope.error = error;\r\n                        $scope.transaction.end($scope.error);\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            {\r\n                                1000 : 'form', // Unknown error\r\n                                1110 : 'form', // Account is locked\r\n                                1111 : 'form', // Number of attempts exceeded. Account was locked\r\n                                1112 : 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                    }\r\n                );\r\n            };\r\n\r\n        }])\r\n\r\n})();","/**\r\n * @file Entry recover password controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.RecoverPassword', ['pipEntry.Common', \"pipRecoverPasswordPanel\"]);\r\n\r\n    thisModule.controller('pipRecoverPasswordController',\r\n        ['$scope', '$rootScope', 'pipUtils', 'pipAuthState', 'pipTransaction', 'pipRest', 'pipFormErrors', 'pipEntryCommon', '$window', function ($scope, $rootScope, pipUtils, pipAuthState, pipTransaction, pipRest, \r\n            pipFormErrors, pipEntryCommon, $window) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n            $scope.goBack = goBack;\r\n\r\n            $scope.onRecover = onRecover;\r\n\r\n            $scope.transaction = pipTransaction('entry.recover_password', $scope);\r\n\r\n            return\r\n\r\n            function goBack(){\r\n                $window.history.back();\r\n            }\r\n            function onRecover() {\r\n                if ($scope.$panel)  $scope.$panel.onRecover();\r\n            }\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Recover password dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.RecoverPasswordDialog', ['pipEntry.Common', \"pipRecoverPasswordPanel\",\r\n        'pipEntry.ResetPasswordDialog']);\r\n\r\n    thisModule.factory('pipRecoverPasswordDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'recover_password/recover_password_dialog.html',\r\n                        controller: 'pipRecoverPasswordDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipRecoverPasswordDialogController',\r\n        ['$scope', '$rootScope', '$location', 'pipSession', 'params', '$mdDialog', 'pipResetPasswordDialog', function ($scope, $rootScope, $location, pipSession, params, $mdDialog, pipResetPasswordDialog){\r\n\r\n            $scope.onRecover = onRecover;\r\n\r\n            if ($scope.$panel) $scope.transaction = $scope.$panel.transacton;\r\n\r\n            $scope.goBack = $mdDialog.cancel;\r\n            $scope.pipGotoReset = pipGotoResetPasswordDialog;\r\n\r\n            return;\r\n\r\n            function onRecover() {\r\n                if ($scope.$panel)  $scope.$panel.onRecover();\r\n            }\r\n\r\n            function pipGotoResetPasswordDialog(){\r\n                pipResetPasswordDialog.show({});\r\n            }\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Recover password panel\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipRecoverPasswordPanel\", ['pipUtils', 'pipFocused', 'pipEntry.Strings']);\r\n\r\n    thisModule.directive('pipRecoverPasswordPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    data: '=pipData',\r\n                    created: '&pipCreated',\r\n                    gotoReset: '=pipGotoReset'\r\n\r\n                },\r\n                templateUrl: 'recover_password/recover_password_panel.html',\r\n                controller: 'pipRecoverPasswordPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipRecoverPasswordPanelController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipFormErrors', 'pipEntryCommon', '$state', '$mdMedia', 'pipTranslate', 'pipEnums', 'pipRest', 'pipUtils', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession,\r\n                  pipFormErrors, pipEntryCommon, $state, $mdMedia, pipTranslate, pipEnums, pipRest, pipUtils) {\r\n\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n            pipEntryCommon.initScope($scope);\r\n\r\n            $scope.showServerError = true;\r\n\r\n            $scope.touchedErrorsWithHint = pipFormErrors.touchedErrorsWithHint;\r\n            $scope.onRecover = onRecover;\r\n            $scope.transaction = pipTransaction('entry.recover_password', $scope);\r\n\r\n            $scope.$control = {};\r\n            $scope.$control.onRecover = onRecover;\r\n\r\n            if ($scope.created) {\r\n                $scope.created({\r\n                    $control: $scope.$control\r\n                });\r\n            }\r\n\r\n            return;\r\n\r\n            //-----------------------------\r\n\r\n            function onRecover() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n\r\n                var transactionId = $scope.transaction.begin('PROCESSING');\r\n                if (!transactionId) return;\r\n\r\n                pipRest.recoverPassword($scope.data.serverUrl).call(\r\n                    {\r\n                        email: $scope.data.email\r\n                    },\r\n                    function (data) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId)) return;\r\n\r\n                        $scope.transaction.end();\r\n                        if (!$scope.gotoReset)\r\n                            pipAuthState.go('reset_password', {\r\n                                server_url: $scope.data.serverUrl,\r\n                                email: $scope.data.email\r\n                            });\r\n                        else\r\n                            $scope.gotoReset();\r\n                    },\r\n                    function (error) {\r\n                        $scope.error = error;\r\n                        $scope.transaction.end($scope.error);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, $scope.error,\r\n                            {\r\n                                1100: 'email', // Missing email\r\n                                1106: 'email', // User was not found\r\n                                1000: 'form', // Unknown error\r\n                                1110: 'form', // Account is locked\r\n                                1111: 'form', // Number of attempts exceeded. Account was locked\r\n                                1112: 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                    }\r\n                );\r\n            };\r\n\r\n        }])\r\n\r\n})();","/**\r\n * @file Entry reset password controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Fix error handling\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.ResetPassword', ['pipEntry.Common', 'pipResetPasswordPanel',\r\n        'pipEmailUnique']);\r\n\r\n    thisModule.controller('pipResetPasswordController',\r\n        ['$scope', '$rootScope', 'pipUtils', 'pipAuthState', 'pipTransaction', 'pipRest', 'pipToasts', 'pipTranslate', 'pipFormErrors', 'pipEntryCommon', '$window', function ($scope, $rootScope, pipUtils, pipAuthState, pipTransaction, pipRest, pipToasts, \r\n            pipTranslate, pipFormErrors, pipEntryCommon, $window) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n            $scope.goBack = goBack;\r\n\r\n            $scope.onReset = onReset;\r\n\r\n            $scope.transaction = pipTransaction('entry.reset_password', $scope);\r\n\r\n            return\r\n\r\n\r\n            function goBack(){\r\n                $window.history.back();\r\n            }\r\n\r\n            function onReset() {\r\n                if ($scope.$panel)  $scope.$panel.onReset();\r\n            }\r\n\r\n\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Reset password dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.ResetPasswordDialog', ['pipEntry.Common', \"pipResetPasswordPanel\"]);\r\n\r\n    thisModule.factory('pipResetPasswordDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'entry/dialogs/reset_password.html',\r\n                        controller: 'pipResetPasswordDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipResetPasswordDialogController',\r\n        ['$scope', '$rootScope', '$location', 'pipSession', 'params', '$mdDialog', function ($scope, $rootScope, $location, pipSession, params, $mdDialog){\r\n\r\n            $scope.onReset = onReset;\r\n\r\n            if ($scope.$panel) $scope.transaction = $scope.$panel.transacton;\r\n\r\n            $scope.goBack = $mdDialog.cancel;\r\n\r\n\r\n            return\r\n\r\n            function onReset() {\r\n                if ($scope.$panel)  $scope.$panel.onReset();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Reset password panel\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipResetPasswordPanel\", ['pipUtils', 'pipFocused', 'pipEntry.Strings']);\r\n\r\n    thisModule.directive('pipResetPasswordPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    data: '=pipData',\r\n                    created: '&pipCreated'\r\n\r\n                },\r\n                templateUrl: 'reset_password/reset_password_panel.html',\r\n                controller: 'pipResetPasswordPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipResetPasswordPanelController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipToasts', 'pipFormErrors', 'pipEntryCommon', '$state', '$mdMedia', 'pipTranslate', 'pipEnums', 'pipRest', 'pipUtils', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession, pipToasts,\r\n                  pipFormErrors, pipEntryCommon, $state, $mdMedia, pipTranslate, pipEnums, pipRest, pipUtils) {\r\n\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n            pipEntryCommon.initScope($scope);\r\n\r\n            $scope.showServerError = true;\r\n\r\n            $scope.touchedErrorsWithHint = pipFormErrors.touchedErrorsWithHint;\r\n            $scope.onReset = onReset;\r\n            $scope.transaction = pipTransaction('entry.recover_password', $scope);\r\n\r\n            $scope.$control = {};\r\n            $scope.$control.onReset = onReset;\r\n\r\n            if ($scope.created) {\r\n                $scope.created({\r\n                    $control: $scope.$control\r\n                });\r\n            }\r\n\r\n            return;\r\n\r\n            //-----------------------------\r\n\r\n            function onShowToast(message, type) {\r\n                if (!message) return;\r\n                message = pipTranslate.translate(message);\r\n                type = type || 'message';\r\n\r\n                if (type == 'message') {\r\n                    pipToasts.showMessage(message);\r\n                    return;\r\n                }\r\n                if (type == 'error') {\r\n                    pipToasts.showError(message);\r\n                    return;\r\n                }\r\n            };\r\n\r\n            function onReset() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n\r\n                var transactionId = $scope.transaction.begin('PROCESSING');\r\n                if (!transactionId) return;\r\n\r\n                pipRest.resetPassword($scope.data.serverUrl).call(\r\n                    {\r\n                        email: $scope.data.email,\r\n                        code: $scope.data.code,\r\n                        password: $scope.data.password\r\n                    },\r\n                    function (data) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId)) return;\r\n\r\n                        var message = String() + 'RESET_PWD_SUCCESS_TEXT';\r\n                        onShowToast(message, 'message');\r\n                        $scope.transaction.end();\r\n                        pipAuthState.go('signin', {\r\n                            server_url: $scope.data.serverUrl,\r\n                            email: $scope.data.email\r\n                        });\r\n                    },\r\n                    function (error) {\r\n                        $scope.error = error;\r\n                        $scope.transaction.end($scope.error);\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            {\r\n                                1100 : 'email', // Missing email\r\n                                1106 : 'email', // User was not found\r\n                                1102 : 'password', // Missing password\r\n                                1103 : 'password', // Password should be 5 to 20 symbols long\r\n                                1105 : 'password', // Old and new passwords are identical\r\n                                1108 : 'code', // Invalid password recovery code\r\n                                1109 : 'code', // Password recovery code expired\r\n                                1000 : 'form', // Unknown error\r\n                                1110 : 'form', // Account is locked\r\n                                1111 : 'form', // Number of attempts exceeded. Account was locked\r\n                                1112 : 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                    }\r\n                );\r\n            };\r\n\r\n        }])\r\n\r\n})();","/**\r\n * @file Entry signin controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n * @todo\r\n * - Remove hack with guide_intro redirect\r\n * - Fix error handling\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.Signin', ['pipEntry.Common', \"pipSigninPanel\"]);\r\n\r\n    thisModule.controller('pipSigninController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipFormErrors', 'pipEntryCommon', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession,\r\n            pipFormErrors, pipEntryCommon) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n            if (!$rootScope.isSignin) pipSession.signout(); // hak for set language\r\n\r\n            $rootScope.isSignin = false;\r\n            return;\r\n\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Entry signin dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.SigninDialog', ['pipEntry.Common', \"pipSigninPanel\",  'pipEntry.SignupDialog',\r\n        'pipEntry.RecoverPasswordDialog']);\r\n\r\n    thisModule.factory('pipSigninDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'signin/signin_dialog.html',\r\n                        controller: 'pipSigninDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipSigninDialogController',\r\n        ['$scope', '$rootScope', '$location', 'pipSession', 'pipSignupDialog', 'pipRecoverPasswordDialog', function ($scope, $rootScope, $location, pipSession,  pipSignupDialog, pipRecoverPasswordDialog) {\r\n\r\n            //pipEntryCommon.configureAppBar();\r\n            pipSession.signout();\r\n\r\n            $scope.pipGotoSignupDialog = pipGotoSignupDialog;\r\n            $scope.pipGotoRecoverPasswordDialog = pipGotoRecoverPasswordDialog;\r\n\r\n            return;\r\n\r\n            function pipGotoSignupDialog(){\r\n                pipSignupDialog.show({});\r\n            }\r\n\r\n            function pipGotoRecoverPasswordDialog(){\r\n                pipRecoverPasswordDialog.show({});\r\n            }\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Signin panel\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipSigninPanel\", ['pipUtils', 'pipFocused', 'pipEntry.Strings']);\r\n\r\n    thisModule.directive('pipSigninPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    gotoSignupPage: '=pipGotoSignupPage',\r\n                    gotoSignupDialog: '=pipGotoSignupDialog',\r\n                    gotoRecoverPasswordDialog:'=pipGotoRecoverPasswordDialog'\r\n                },\r\n                templateUrl: 'signin/signin_panel.html',\r\n                controller: 'pipSigninPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipSigninPanelController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipFormErrors', 'pipEntryCommon', '$state', '$mdMedia', 'pipTheme', 'pipUtils', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession,\r\n                  pipFormErrors, pipEntryCommon, $state, $mdMedia, pipTheme, pipUtils) {\r\n\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n\r\n            $scope.showServerError = true;\r\n            $scope.transaction = pipTransaction('entry.signin', $scope);\r\n\r\n            $scope.touchedErrorsWithHint = pipFormErrors.touchedErrorsWithHint;\r\n\r\n            $scope.onSignin = onSignin;\r\n            $scope.gotoSignup = gotoSignup;\r\n            $scope.gotoRecoverPassword = gotoRecoverPassword;\r\n            $scope.onEnter = onEnter;\r\n\r\n            pipEntryCommon.initScope($scope);\r\n\r\n            return;\r\n\r\n            function gotoSignup(){\r\n                if(!$scope.gotoSignupPage &&  !$scope.gotoSignupDialog){\r\n                    $state.go('signup',{ server_url: $scope.data.serverUrl, email: $scope.data.email });\r\n                    return;\r\n                }\r\n                if($scope.gotoSignupPage){\r\n                    $state.go($scope.gotoSignupPage);\r\n                    return;\r\n                }\r\n                if($scope.gotoSignupDialog){\r\n                    $scope.gotoSignupDialog();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            function gotoRecoverPassword(){\r\n\r\n                if(!$scope.gotoRecoverPasswordDialog){\r\n                    $state.go('recover_password',{ server_url: $scope.data.serverUrl, email: $scope.data.email });\r\n                    return;\r\n                }\r\n                if($scope.gotoRecoverPasswordDialog){\r\n                    $scope.gotoRecoverPasswordDialog();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            function onSignin() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n\r\n                var transactionId = $scope.transaction.begin('ENTERING');\r\n                if (!transactionId) return;\r\n\r\n                $rootScope.isSignin = true;\r\n                pipSession.signin($scope.data,\r\n                    function (user) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId))return;\r\n                        $scope.transaction.end();\r\n\r\n                        if (!pipUtils.checkSupported()) {\r\n                            pipSession.signout();\r\n                            $state.go('errors_unsupported');\r\n                            return ;\r\n                        }\r\n\r\n                        if (pipAuthState.params.redirect_to) {\r\n                            $location.url(pipAuthState.params.redirect_to);\r\n\r\n                        } else {\r\n                            pipAuthState.goToAuthorized();\r\n                        }\r\n\r\n\r\n                    },\r\n                    function (error) {\r\n                        $rootScope.isSignin = false;\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                        console.log(error);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            {\r\n                                1100 : 'email', // Missing email\r\n                                1106 : 'email', // User was not found\r\n                                1114 : 'email', // Invalid email\r\n                                1102 : 'password', // Missing password\r\n                                1107 : 'password', // Invalid password\r\n                                1000 : 'form', // Unknown error\r\n                                1110 : 'form', // Account is locked\r\n                                1111 : 'form', // Number of attempts exceeded. Account was locked\r\n                                1112 : 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                        $scope.transaction.end({message:error});\r\n\r\n                    }\r\n                );\r\n            };\r\n\r\n            function onEnter(event) {\r\n                if(event.keyCode === 13) {\r\n                    onSignin();\r\n                }\r\n            }\r\n\r\n        }])\r\n\r\n})();","/**\r\n * @file Entry verify email controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.VerifyEmail', ['pipEntry.Common']);\r\n\r\n    thisModule.controller('pipVerifyEmailController',\r\n        ['$scope', '$rootScope', 'pipAuthState', 'pipTransaction', 'pipRest', 'pipFormErrors', 'pipEntryCommon', function ($scope, $rootScope, pipAuthState, pipTransaction, pipRest, \r\n            pipFormErrors, pipEntryCommon) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n            pipEntryCommon.initScope($scope);\r\n\r\n            $scope.showServerError = true;\r\n            $scope.transaction = pipTransaction('entry.verify_email', $scope);\r\n\r\n            $scope.touchedErrorsWithHint = pipFormErrors.touchedErrorsWithHint;\r\n            $scope.onVerify = onVerify;\r\n            $scope.onRecover = onRecover;\r\n\r\n            return;\r\n\r\n            //-----------------------------\r\n\r\n            function onVerify() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n\r\n                var transactionId = $scope.transaction.begin('PROCESSING');\r\n                if (!transactionId) return;\r\n\r\n                pipRest.verifyEmail($scope.data.serverUrl).call(\r\n                    {\r\n                        email: $scope.data.email,\r\n                        code: $scope.data.code\r\n                    },\r\n                    function (data) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId)) return;\r\n\r\n                        $scope.transaction.end();\r\n                        pipAuthState.go('verify_email_success', {});\r\n                    },\r\n                    function (error) {\r\n                        $scope.error = error;\r\n                        $scope.transaction.end($scope.error);\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, $scope.error,\r\n                            {\r\n                                1100 : 'email', // Missing email\r\n                                1106 : 'email', // User was not found\r\n                                1104 : 'email', // Email is already registered\r\n                                1305 : 'email', // Email is already registered\r\n                                1108 : 'code', // Invalid password recovery code\r\n                                1000 : 'form', // Unknown error\r\n                                1110 : 'form', // Account is locked\r\n                                1111 : 'form', // Number of attempts exceeded. Account was locked\r\n                                1112 : 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                    }\r\n                );\r\n            };\r\n\r\n            function onRecover() {\r\n                if (!$rootScope.$user || !$rootScope.$user.id) {\r\n                    return ;\r\n                }\r\n\r\n                var tid = $scope.transaction.begin('PROCESSING');\r\n                if (!tid) return;\r\n                pipRest.requestEmailVerification($scope.data.serverUrl).get(\r\n                    {\r\n                        party_id: $rootScope.$user.id,\r\n                        email: $scope.data.email\r\n                    },\r\n                    function (data) {\r\n                        if ($scope.transaction.aborted(tid)) return;\r\n\r\n                        $scope.transaction.end();\r\n                        pipAuthState.go('reset_password', {\r\n                            server_url: $scope.data.serverUrl,\r\n                            email: $scope.data.email\r\n                        });\r\n                    },\r\n                    function (error) {\r\n                        $scope.transaction.end(error);\r\n                    }\r\n                );\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipVerifyEmailSuccessController',\r\n        ['$scope', 'pipAuthState', 'pipEntryCommon', function ($scope, pipAuthState, pipEntryCommon) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n\r\n            $scope.onContinue = onContinue;\r\n\r\n            return;\r\n            \r\n            //-----------------------------\r\n\r\n            function onContinue() {\r\n                pipAuthState.goToAuthorized({});\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Entry signup controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.Signup', ['pipEntry.Common', 'pipEmailUnique',  'pipSignupPanel',\r\n        'pipPasswordMatch']);\r\n\r\n    thisModule.controller('pipSignupController',\r\n        ['$scope', '$rootScope', 'pipAuthState', 'pipTransaction', 'pipRest', 'pipSession', 'pipFormErrors', 'pipEntryCommon', function ($scope, $rootScope, pipAuthState, pipTransaction, pipRest, pipSession, //pipAuth,\r\n            pipFormErrors, pipEntryCommon) {\r\n\r\n            pipEntryCommon.configureAppBar();\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Entry signup controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipEntry.SignupDialog', ['pipEntry.Common', \"pipSignupPanel\", 'pipEntry.SigninDialog',\r\n        'pipEntry.PostSignupDialog']);\r\n\r\n    thisModule.factory('pipSignupDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'signup/signup_dialog.html',\r\n                        controller: 'pipSignupDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipSignupDialogController',\r\n        ['$scope', '$rootScope', '$location', 'pipSession', 'pipSigninDialog', 'pipPostSignupDialog', function ($scope, $rootScope, $location, pipSession, pipSigninDialog, pipPostSignupDialog) {\r\n\r\n            pipSession.signout();\r\n            $scope.pipGotoSigninDialog = pipGotoSigninDialog;\r\n            $scope.pipPostSignup = pipPostSignup;\r\n\r\n            return;\r\n\r\n            function pipGotoSigninDialog(){\r\n                pipSigninDialog.show({});\r\n            }\r\n\r\n            function pipPostSignup(user){\r\n                pipPostSignupDialog.show({\r\n                    $party:user\r\n                });\r\n            }\r\n\r\n\r\n        }]\r\n    );\r\n\r\n})();","/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipSignupPanel\", ['pipUtils', 'pipFocused', 'pipEntry.Strings']);\r\n\r\n    thisModule.directive('pipSignupPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    gotoPostSignup:'=pipPostSignup',\r\n                    gotoSigninPage:'=pipGotoSigninPage',\r\n                    gotoSigninDialog:'=pipGotoSigninDialog'\r\n                },\r\n                templateUrl: 'signup/signup_panel.html',\r\n                controller: 'pipSignupPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    thisModule.controller('pipSignupPanelController',\r\n        ['$scope', '$rootScope', '$location', 'pipTransaction', 'pipAuthState', 'pipSession', 'pipFormErrors', 'pipEntryCommon', 'pipRest', '$mdMedia', '$state', function ($scope, $rootScope, $location, pipTransaction, pipAuthState, pipSession,\r\n                  pipFormErrors, pipEntryCommon, pipRest, $mdMedia, $state) {\r\n\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n\r\n            pipEntryCommon.initScope($scope);\r\n\r\n            $scope.confirmPassword = '';\r\n\r\n            $scope.isEmpty = _.isEmpty;\r\n            $scope.onEnter = onEnter;\r\n            $scope.showServerError = true;\r\n            $scope.transaction = pipTransaction('entry.signup', $scope);\r\n\r\n            // фильтр по серверам\r\n            $scope.filterItem = filterItem;\r\n            $scope.getMatches = getMatches;\r\n            $scope.touchedErrorsWithHint = pipFormErrors.touchedErrorsWithHint;\r\n            $scope.onServerUrlChanged = function () {};\r\n            $scope.onSignup = onSignup;\r\n            $scope.gotoSignin =  gotoSignin;\r\n\r\n            return;\r\n\r\n            function gotoSignin(){\r\n                if(!$scope.gotoSigninPage &&  !$scope.gotoSigninDialog){\r\n                    $state.go('signin',{});\r\n                    return;\r\n                }\r\n                if($scope.gotoSigninPage){\r\n                    $state.go($scope.gotoSigninPage);\r\n                    return;\r\n                }\r\n                if($scope.gotoSigninDialog){\r\n                    $scope.gotoSigninDialog();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            function filterItem(item) {\r\n                var result = ($scope.selected.searchURLs\r\n                && item\r\n                && item.toLowerCase().indexOf($scope.selected.searchURLs.toLowerCase()) >= 0);\r\n                return result;\r\n            };\r\n\r\n            function getMatches() {\r\n                if (!$scope.selected.searchURLs)\r\n                    return $scope.showServerUrl;\r\n                $scope.data.serverUrl = $scope.selected.searchURLs;\r\n                return _.filter($scope.serverUrls, $scope.filterItem);\r\n            };\r\n\r\n            function onSignup() {\r\n                if ($scope.form.$invalid) {\r\n                    pipFormErrors.resetFormErrors($scope.form, true);\r\n                    return;\r\n                }\r\n                var transactionId = $scope.transaction.begin('PROCESSING');\r\n                if (!transactionId) return;\r\n                pipRest.signup($scope.data.serverUrl).call(\r\n                    {\r\n                        name: $scope.data.name,\r\n                        email: $scope.data.email,\r\n                        password: $scope.data.password,\r\n                        language: $rootScope.$language || 'en',\r\n                        theme: $rootScope.theme || 'blue'\r\n                    },\r\n                    function (user) {\r\n                        pipFormErrors.resetFormErrors($scope.form, false);\r\n                        if ($scope.transaction.aborted(transactionId)) return;\r\n                        $scope.transaction.end();\r\n\r\n                        pipSession.open($scope.data.serverUrl, user, $scope.data.password, false);\r\n                        if(!$scope.gotoPostSignup)\r\n                            pipAuthState.go('post_signup', { party_id: user.id });\r\n                        else\r\n                            $scope.gotoPostSignup(user);\r\n\r\n                    },\r\n                    function (error) {\r\n                        $scope.error = error;\r\n                        pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            {\r\n                                1101 : 'signupFullName', // Missing name\r\n                                1100 : 'userEmail', // Missing email\r\n                                1106 : 'userEmail', // User was not found\r\n                                1104 : 'userEmail', // Email is already registered\r\n                                1305 : 'userEmail', // Email is already registered\r\n                                1114 : 'userEmail', // Invalid email\r\n                                1301 : 'userEmail', // Invalid email\r\n                                1300 : 'userEmail', // Missing email\r\n                                1102 : 'password', // Missing password\r\n                                1103 : 'password', // Password should be 5 to 20 symbols long\r\n                                1000 : 'form', // Unknown error\r\n                                1110 : 'form', // Account is locked\r\n                                1111 : 'form', // Number of attempts exceeded. Account was locked\r\n                                1112 : 'form', // Account is not active\r\n                                '-1' : 'form' // server not response\r\n                            }\r\n                        );\r\n                        $scope.transaction.end(error);\r\n                    }\r\n                );\r\n            };\r\n\r\n            function onEnter(event) {\r\n                if(event.keyCode === 13) {\r\n                    onSignup();\r\n                }\r\n            }\r\n\r\n        }])\r\n\r\n})();","(function(module) {\ntry {\n  module = angular.module('pipErrors.Templates');\n} catch (e) {\n  module = angular.module('pipErrors.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('maintenance/maintenance.html',\n    '<div class=\"pip-error pip-empty layout-column flex layout-align-center-center\">\\n' +\n    '    <div style=\"background-image: url(\\'../../dist/images/maintenance.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '    <div class=\"pip-error-text\">{{::\\'ERROR_AVAILABLE_TITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\">{{::\\'ERROR_AVAILABLE_SUBTITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\" ng-if=\"timeoutInterval\">\\n' +\n    '        {{::\\'ERROR_AVAILABLE_TRY_AGAIN\\' | translate}} {{timeoutInterval}} sec.\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-error-actions h48\"\\n' +\n    '         ng-if=\"isCordova\"\\n' +\n    '         layout=\"column\"\\n' +\n    '         layout-align=\"center center\">\\n' +\n    '        <md-button class=\"md-accent\" ng-click=\"onClose($event)\" aria-label=\"CLOSE\" >\\n' +\n    '            {{::\\'ERROR_AVAILABLE_CLOSE\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipErrors.Templates');\n} catch (e) {\n  module = angular.module('pipErrors.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('missing_route/missing_route.html',\n    '<div class=\"pip-error pip-empty layout-column flex layout-align-center-center\">\\n' +\n    '    <div style=\"background-image: url(\\'../../dist/images/invalid_route.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '    <div class=\"pip-error-text\">{{::\\'ERROR_ROUTE_TITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\">{{::\\'ERROR_ROUTE_SUBTITLE\\' | translate}}</div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-error-actions h48\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '        <md-button aria-label=\"CONTINUE\" class=\"md-accent\" ng-click=\"onContinue($event)\">\\n' +\n    '            {{::\\'ERROR_ROUTE_CONTINUE\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"h48\" ng-if=\"url\"><a ng-href=\"{{url}}\">\\n' +\n    '        {{::\\'ERROR_ROUTE_TRY_AGAIN\\' | translate }}: {{url}}\\n' +\n    '    </a></div>\\n' +\n    '    <div class=\"h48\" ng-if=\"urlBack\"><a ng-href=\"{{urlBack}}\">\\n' +\n    '        {{::\\'ERROR_ROUTE_GO_BACK\\' | translate }}: {{urlBack}}\\n' +\n    '    </a></div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipErrors.Templates');\n} catch (e) {\n  module = angular.module('pipErrors.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('no_connection/no_connection.html',\n    '<div class=\"pip-error pip-empty layout-column flex layout-align-center-center\">\\n' +\n    '    <div style=\"background-image: url(\\'../../dist/images/no_response.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '    <div class=\"pip-error-text\">{{::\\'ERROR_RESPONDING_TITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\">{{::\\'ERROR_RESPONDING_SUBTITLE\\' | translate}}</div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-error-actions h48\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '        <md-button aria-label=\"RETRY\" class=\"md-accent\" ng-click=\"onRetry($event)\">\\n' +\n    '            {{::\\'ERROR_RESPONDING_RETRY\\' | translate}}\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipErrors.Templates');\n} catch (e) {\n  module = angular.module('pipErrors.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('unknown/unknown.html',\n    '<div class=\"pip-error pip-empty layout-column flex layout-align-center-center\">\\n' +\n    '    <div style=\"background-image: url(\\'../../dist/images/unknown_error.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '    <div class=\"pip-error-text\">{{::\\'ERROR_UNKNOWN_TITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\">{{::\\'ERROR_UNKNOWN_SUBTITLE\\' | translate}}</div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-error-subtext\" ng-if=\"error_details && error_details.status\">\\n' +\n    '        <div>Code: {{error_details.code}}</div>\\n' +\n    '        <div>Description: {{error_details.description}}</div>\\n' +\n    '        <div>HTTP status: {{error_details.status}}</div>\\n' +\n    '        <div>Server stacktrace: {{error_details.server_stacktrace}}</div>\\n' +\n    '        <div>Client stacktrace stacktrace: {{error_details.client_stacktrace}}</div>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-error-actions\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '        <div class=\"h48\" ng-if=\"isCordova\">\\n' +\n    '            <md-button aria-label=\"CLOSE\" class=\"md-accent\" ng-click=\"onClose($event)\">\\n' +\n    '                {{::\\'ERROR_UNKNOWN_CLOSE\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"h48\">\\n' +\n    '            <md-button aria-label=\"DETAILS\" class=\"md-accent\" ng-click=\"onDetails($event)\">\\n' +\n    '                {{::\\'ERROR_UNKNOWN_DETAILS\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</div>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipErrors.Templates');\n} catch (e) {\n  module = angular.module('pipErrors.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('unsupported/unsupported.html',\n    '<div class=\"pip-error pip-empty layout-column flex layout-align-center-center\">\\n' +\n    '\\n' +\n    '    <div class=\"pip-error-text\">{{::\\'ERROR_UNSUPPORTED_TITLE\\' | translate}}</div>\\n' +\n    '    <div class=\"pip-error-subtext\">\\n' +\n    '        {{::\\'ERROR_UNSUPPORTED_SUBTITLE\\' | translate}}\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-error-details\" layout=\"row\" layout-align=\"center center\" ng-if=\"$mdMedia(\\'gt-xs\\')\">\\n' +\n    '        <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '            <div style=\"background-image: url(\\'../../dist/images/ie.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '            <div class=\"h64 tp16 bp16\">\\n' +\n    '                <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                   href=\"https://www.microsoft.com/en-us/download/internet-explorer-11-for-windows-7-details.aspx\">\\n' +\n    '                    {{::\\'ERROR_UNSUPPORTED_IE\\' | translate}}\\n' +\n    '                </a>\\n' +\n    '                <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_IE_VER\\' | translate}}</p>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '            <div style=\"background-image: url(\\'../../dist/images/fm.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '            <div class=\"h64 tp16 bp16\">\\n' +\n    '                <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                   href=\"https://www.mozilla.org/ru/firefox/new/\">\\n' +\n    '                    {{::\\'ERROR_UNSUPPORTED_FM\\' | translate}}\\n' +\n    '                </a>\\n' +\n    '                <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_FM_VER\\' | translate}}</p>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '            <div style=\"background-image: url(\\'../../dist/images/gc.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '            <div class=\"h64 tp16 bp16\">\\n' +\n    '                <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                   href=\"https://www.google.com/chrome/browser/desktop/index.html?platform=win64#\">\\n' +\n    '                    {{::\\'ERROR_UNSUPPORTED_GC\\' | translate}}\\n' +\n    '                </a>\\n' +\n    '                <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_GC_VER\\' | translate}}</p>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '            <div style=\"background-image: url(\\'../../dist/images/o.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '            <div class=\"h64 tp16 bp16\">\\n' +\n    '                <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                   href=\"http://www.opera.com/ru/download\">\\n' +\n    '                    {{::\\'ERROR_UNSUPPORTED_O\\' | translate}}\\n' +\n    '                </a>\\n' +\n    '                <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_O_VER\\' | translate}}</p>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <div class=\"pip-error-details\" ng-if=\"$mdMedia(\\'xs\\')\">\\n' +\n    '        <div layout=\"row\" layout-align=\"center center\">\\n' +\n    '            <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '                <div style=\"background-image: url(\\'../../dist/images/ie.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '                <div class=\"h64 tp16 bp16\">\\n' +\n    '                    <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                       href=\"https://www.microsoft.com/en-us/download/internet-explorer-11-for-windows-7-details.aspx\">\\n' +\n    '                        {{::\\'ERROR_UNSUPPORTED_IE\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                    <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_IE_VER\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '                <div style=\"background-image: url(\\'../../dist/images/fm.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '                <div class=\"h64 tp16 bp16\">\\n' +\n    '                    <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                       href=\"https://www.mozilla.org/ru/firefox/new/\">\\n' +\n    '                        {{::\\'ERROR_UNSUPPORTED_FM\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                    <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_FM_VER\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"tm16\" layout=\"row\" layout-align=\"center center\">\\n' +\n    '            <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '                <div style=\"background-image: url(\\'../../dist/images/gc.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '                <div class=\"h64 tp16 bp16\">\\n' +\n    '                    <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                       href=\"https://www.google.com/chrome/browser/desktop/index.html?platform=win64#\">\\n' +\n    '                        {{::\\'ERROR_UNSUPPORTED_GC\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                    <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_GC_VER\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <div class=\"pip-error-details-item\" layout=\"column\" layout-align=\"center center\">\\n' +\n    '                <div style=\"background-image: url(\\'../../dist/images/o.svg\\');\" class=\"pip-pic\"></div>\\n' +\n    '                <div class=\"h64 tp16 bp16\">\\n' +\n    '                    <a class=\"text-body2 m0\" target=\"_blank\"\\n' +\n    '                       href=\"http://www.opera.com/ru/download\">\\n' +\n    '                        {{::\\'ERROR_UNSUPPORTED_O\\' | translate}}\\n' +\n    '                    </a>\\n' +\n    '                    <p class=\"text-body1 m0\"> {{::\\'ERROR_UNSUPPORTED_O_VER\\' | translate}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Registration of all error handling components\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipErrorHandling', [\r\n        'pipErrors.Pages'\r\n    ]);\r\n    \r\n})();","/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.Pages', [\r\n        'pipAppBar', 'pipRest.State', 'pipTransactions', 'pipRest', 'ngMaterial', \r\n        'pipErrors.Strings', 'pipErrors.NoConnection', 'pipErrors.MissingRoute', 'pipErrors.Unsupported',\r\n        'pipErrors.Unknown', 'pipErrors.Maintenance', 'pipErrors.Templates'\r\n    ]);\r\n\r\n    thisModule.config(\r\n        ['pipAuthStateProvider', function (pipAuthStateProvider) {\r\n            // Configure module routes\r\n            pipAuthStateProvider\r\n                .state('errors_no_connection', {\r\n                    url: '/errors/no_connection',\r\n                    params: {\r\n                        error: null\r\n                    },\r\n                    auth: false,\r\n                    controller: 'pipErrorNoConnectionController',\r\n                    templateUrl: 'no_connection/no_connection.html'\r\n                })\r\n                .state('errors_maintenance', {\r\n                    url: '/errors/maintenance',\r\n                    params: {\r\n                        error: null\r\n                    },\r\n                    auth: false,\r\n                    controller: 'pipErrorMaintenanceController',\r\n                    templateUrl: 'maintenance/maintenance.html'\r\n                })\r\n                .state('errors_missing_route', {\r\n                    url: '/errors/missing_route',\r\n                    params: {\r\n                        unfoundState: null,\r\n                        fromState: null\r\n                    },\r\n                    auth: true,\r\n                    controller: 'pipErrorMissingRouteController',\r\n                    templateUrl: 'missing_route/missing_route.html'\r\n                })\r\n                .state('errors_unsupported', {\r\n                    url: '/errors/unsupported',\r\n                    params: {\r\n                        error: null\r\n                    },\r\n                    auth: false,\r\n                    controller: 'pipErrorUnsupportedController',\r\n                    templateUrl: 'unsupported/unsupported.html'\r\n                })\r\n                .state('errors_unknown', {\r\n                    url: '/errors/unknown',\r\n                    params: {\r\n                        error: null\r\n                    },\r\n                    auth: false,\r\n                    controller: 'pipErrorUnknownController',\r\n                    templateUrl: 'unknown/unknown.html'\r\n                });\r\n        }]);\r\n\r\n})();","/**\r\n * @file Errors string resources\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.Strings', ['pipTranslate']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n\r\n        // Set translation strings for the module\r\n        pipTranslateProvider.translations('en', {\r\n            'ERROR_ROUTE_TITLE': 'Sorry, the page isn\\'t available',\r\n            'ERROR_ROUTE_SUBTITLE': 'The link you followed may be broken, or the page may have been removed.',\r\n            'ERROR_ROUTE_CONTINUE': 'Continue',\r\n            'ERROR_ROUTE_TRY_AGAIN': 'Try again',\r\n            'ERROR_ROUTE_GO_BACK': 'Go Back',\r\n            'ERROR_ROUTE_PAGE_TITLE': 'Wrong page',\r\n\r\n            'ERROR_UNKNOWN_TITLE': 'Oops. Something went wrong',\r\n            'ERROR_UNKNOWN_SUBTITLE': 'Unknown error occurred, but don\\'t worry we already have been notified.',\r\n            'ERROR_UNKNOWN_CLOSE': 'Close',\r\n            'ERROR_UNKNOWN_DETAILS': 'Details',\r\n\r\n            'ERROR_AVAILABLE_TITLE': 'The server is on maintenance',\r\n            'ERROR_AVAILABLE_SUBTITLE': 'Sorry for the inconvenience. This application is undergoing maintenance for ' +\r\n                                            'a short period. We\\'ll be back soon. Thank for your patience.',\r\n            'ERROR_AVAILABLE_CLOSE': 'Close',\r\n            'ERROR_AVAILABLE_TRY_AGAIN': 'Try after',\r\n\r\n            'ERROR_RESPONDING_TITLE': 'No connection to the server',\r\n            'ERROR_RESPONDING_SUBTITLE': 'Unable to connect to the server. Check your Internet connection and try again.',\r\n            'ERROR_RESPONDING_RETRY': 'Retry',\r\n\r\n            'ERROR_UNSUPPORTED_TITLE': 'This browser is not supported',\r\n            'ERROR_UNSUPPORTED_SUBTITLE': 'Our application using the latest technology. This makes the application faster ' +\r\n                                          'and easier to use. Unfortunately, your browser doesn\\'t support those ' +\r\n                                          'technologies. Download on of these great browsers and you\\'ll be on your way:',\r\n            'ERROR_UNSUPPORTED_O': 'Opera',\r\n            'ERROR_UNSUPPORTED_O_VER': 'Version 36+',\r\n            'ERROR_UNSUPPORTED_IE': 'Internet Explorer',\r\n            'ERROR_UNSUPPORTED_IE_VER': 'Version 11+',\r\n            'ERROR_UNSUPPORTED_GC': 'Google Chrome',\r\n            'ERROR_UNSUPPORTED_GC_VER': 'Version 48+',\r\n            'ERROR_UNSUPPORTED_FM': 'Mozilla Firefox',\r\n            'ERROR_UNSUPPORTED_FM_VER': 'Version 45+'\r\n\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'ERROR_ROUTE_TITLE': 'Sorry, the page isn\\'t available',\r\n            'ERROR_ROUTE_SUBTITLE': 'The link you followed may be broken, or the page may have been removed.',\r\n            'ERROR_ROUTE_CONTINUE': 'Continue',\r\n            'ERROR_ROUTE_TRY_AGAIN': 'Try again',\r\n            'ERROR_ROUTE_GO_BACK': 'Go Back',\r\n            'ERROR_ROUTE_PAGE_TITLE': 'Wrong page',\r\n\r\n            'ERROR_UNKNOWN_TITLE': 'Oops. Something went wrong',\r\n            'ERROR_UNKNOWN_SUBTITLE': 'Unknown error occurred, but don\\'t worry we already have been notified.',\r\n            'ERROR_UNKNOWN_CLOSE': 'Close',\r\n            'ERROR_UNKNOWN_DETAILS': 'Details',\r\n\r\n            'ERROR_AVAILABLE_TITLE': 'The server is on maintenance',\r\n            'ERROR_AVAILABLE_SUBTITLE': 'Sorry for the inconvenience. This application is undergoing maintenance for ' +\r\n            'a short period. We\\'ll be back soon. Thank for your patience.',\r\n            'ERROR_AVAILABLE_CLOSE': 'Close',\r\n            'ERROR_AVAILABLE_TRY_AGAIN': 'Try after',\r\n\r\n            'ERROR_RESPONDING_TITLE': 'No connection to the server',\r\n            'ERROR_RESPONDING_SUBTITLE': 'Unable to connect to server. Check your Internet connection and try again.',\r\n            'ERROR_RESPONDING_RETRY': 'Retry',\r\n\r\n            'ERROR_UNSUPPORTED_TITLE': 'This browser is not supported',\r\n            'ERROR_UNSUPPORTED_SUBTITLE': 'Our application using the latest technology. This makes the application faster ' +\r\n            'and easier to use. Unfortunately, your browser doesn\\'t support those ' +\r\n            'technologies. Download on of these great browsers and you\\'ll be on your way:',\r\n            'ERROR_UNSUPPORTED_O': 'Opera',\r\n            'ERROR_UNSUPPORTED_O_VER': 'Version 35+',\r\n            'ERROR_UNSUPPORTED_IE': 'Internet Explorer',\r\n            'ERROR_UNSUPPORTED_IE_VER': 'Version 11+',\r\n            'ERROR_UNSUPPORTED_GC': 'Google Chrome',\r\n            'ERROR_UNSUPPORTED_GC_VER': 'Version 47+',\r\n            'ERROR_UNSUPPORTED_FM': 'Mozilla Firefox',\r\n            'ERROR_UNSUPPORTED_FM_VER': 'Version 43+'\r\n\r\n        });\r\n    }]);\r\n\r\n})();","/**\r\n * @file Maintenance error controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.Maintenance', []);\r\n\r\n    thisModule.controller('pipErrorMaintenanceController', ['$scope', '$state', '$rootScope', 'pipAppBar', function ($scope, $state, $rootScope, pipAppBar) {\r\n\r\n        $rootScope.$routing = false;\r\n        $scope.isCordova = false;\r\n        appHeader();\r\n\r\n        $scope.error = $state && $state.params && $state.params.error ?  $state.params.error : {};\r\n        $scope.timeoutInterval = $scope.error && $scope.error.config &&\r\n                        $scope.error.config.params && $scope.error.config.params.interval ? $scope.error.config.params.interval : 0;\r\n\r\n        $scope.onClose = onClose;\r\n\r\n        return;\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleBreadcrumb('ERROR_AVAILABLE_TITLE', []);\r\n            pipAppBar.showLocalActions(null, []);\r\n        };\r\n\r\n        function onClose() {\r\n\r\n        };\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Missing route error controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.MissingRoute', []);\r\n\r\n    thisModule.controller('pipErrorMissingRouteController', ['$scope', '$state', '$rootScope', 'pipAppBar', 'pipAuthState', function ($scope, $state, $rootScope, pipAppBar, pipAuthState) {\r\n\r\n        appHeader();\r\n        $rootScope.$routing = false;\r\n\r\n        $scope.error = $state && $state.params && $state.params.error ?  $state.params.fromState : {};\r\n        $scope.unfoundState = $state && $state.params ?  $state.params.unfoundState : {};\r\n        $scope.url = $scope.unfoundState && $scope.unfoundState.to ? $state.href($scope.unfoundState.to, $scope.unfoundState.toParams, {absolute: true}) : '';\r\n        $scope.urlBack = $scope.fromState && $scope.fromState.to ? $state.href($scope.fromState.to, $scope.fromState.fromParams, {absolute: true}) : '';\r\n\r\n        $scope.onContinue = onContinue;\r\n\r\n        return;\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleBreadcrumb('ERROR_ROUTE_PAGE_TITLE', []);\r\n            pipAppBar.showLocalActions(null, []);\r\n        };\r\n\r\n        function onContinue() {\r\n            pipAuthState.goToAuthorized();\r\n        };\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file No connection error controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.NoConnection', []);\r\n\r\n    thisModule.controller('pipErrorNoConnectionController', ['$scope', '$state', '$rootScope', '$window', 'pipAppBar', function ($scope, $state, $rootScope, $window, pipAppBar) {\r\n\r\n        $rootScope.$routing = false;\r\n        appHeader();\r\n\r\n        $scope.error = $state && $state.params && $state.params.error ?  $state.params.error : {};\r\n\r\n        $scope.onRetry = onRetry;\r\n\r\n        return;\r\n\r\n        function onRetry() {\r\n            $window.history.back();\r\n        };\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleBreadcrumb('ERROR_RESPONDING_TITLE', []);\r\n            pipAppBar.showLocalActions(null, []);\r\n        };\r\n\r\n    }]);\r\n\r\n\r\n})();\r\n","/**\r\n * @file Unknown error controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.Unknown', []);\r\n\r\n    thisModule.controller('pipErrorUnknownController', ['$scope', '$state', '$rootScope', 'pipAppBar', function ($scope, $state, $rootScope, pipAppBar) {\r\n\r\n        $rootScope.$routing = false;\r\n        $scope.isCordova = false;\r\n        appHeader();\r\n\r\n        $scope.error = $state && $state.params && $state.params.error ?  $state.params.error : {};\r\n        $scope.error_details = null;\r\n\r\n        $scope.onDetails = onDetails;\r\n        $scope.onClose = onClose;\r\n\r\n        parseError();\r\n\r\n        return;\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleBreadcrumb('ERROR_UNKNOWN_TITLE', []);\r\n            pipAppBar.showLocalActions(null, []);\r\n        };\r\n\r\n        function parseError() {\r\n            $scope.error_details = {};\r\n            $scope.error_details.code = $scope.error.code;\r\n            $scope.error_details.description = $scope.error.message;\r\n            $scope.error_details.status = $scope.error.status;\r\n\r\n            $scope.error_details.server_stacktrace = function () {\r\n\r\n            };\r\n\r\n            $scope.error_details.client_stacktrace = function () {\r\n\r\n            };\r\n        };\r\n\r\n        function onDetails() {\r\n\r\n        };\r\n\r\n        function onClose() {\r\n\r\n        };\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Unsupported error controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipErrors.Unsupported', []);\r\n\r\n    thisModule.controller('pipErrorUnsupportedController', ['$scope', '$state', '$rootScope', '$mdMedia', 'pipAppBar', function ($scope, $state, $rootScope, $mdMedia, pipAppBar) {\r\n\r\n        $scope.$mdMedia = $mdMedia;\r\n        $rootScope.$routing = false;\r\n        appHeader();\r\n\r\n        $scope.error = $state && $state.params && $state.params.error ?  $state.params.error : {};\r\n\r\n        return;\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleBreadcrumb('ERROR_UNSUPPORTED_TITLE', []);\r\n            pipAppBar.showLocalActions(null, []);\r\n        };\r\n\r\n    }]);\r\n\r\n})();\r\n","/**\r\n * @file Registration of settings components\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipSettings', [\r\n        'pipSettings.Service',\r\n        'pipSettings.Page',\r\n        'pipUserSettings'\r\n    ]);\r\n    \r\n})();","(function(module) {\ntry {\n  module = angular.module('pipSettings.Templates');\n} catch (e) {\n  module = angular.module('pipSettings.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('settings_page/settings_page.html',\n    '<md-toolbar class=\"pip-appbar-ext\"></md-toolbar>\\n' +\n    '<pip-document width=\"800\" min-height=\"400\" class=\"pip-settings\">\\n' +\n    '\\n' +\n    '    <div class=\"pip-menu-container\" ng-hide=\"manager === false || !pages || pages.length < 1\">\\n' +\n    '        <md-list class=\"pip-menu pip-simple-list hide-xs\" pip-selected=\"selected.pageIndex\"\\n' +\n    '                 pip-selected-watch=\"selected.navId\" pip-select=\"onNavigationSelect($event.id)\">\\n' +\n    '            <md-list-item class=\"pip-simple-list-item pip-selectable flex\" md-ink-ripple pip-id=\"{{ page.state }}\"\\n' +\n    '                          ng-repeat=\"page in pages track by page.state\" ng-if=\"$party.id == $user.id ||\\n' +\n    '                          page.state == \\'settings.basic_info\\'|| page.state ==\\'settings.contact_info\\'\\n' +\n    '                          || page.state ==\\'settings.blacklist\\'\">\\n' +\n    '                <p> {{page.title | translate}}</p>\\n' +\n    '            </md-list-item>\\n' +\n    '        </md-list>\\n' +\n    '\\n' +\n    '        <div class=\"pip-content-container\" ng-if=\"selected.page\" style=\"min-height: 100%;\">\\n' +\n    '            <pip-dropdown pip-actions=\"pages\" class=\"hide-gt-xs\" pip-dropdown-select=\"onDropdownSelect\"\\n' +\n    '                          pip-active-index=\"selected.pageIndex\"></pip-dropdown>\\n' +\n    '\\n' +\n    '            <div class=\"pip-body tp24-flex\" ui-view layout=\"column\"  style=\"max-width: none !important; min-height: 100%\"></div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div ng-show=\"manager === false || !pages || pages.length < 1\" layout=\"column\" layout-align=\"center center\" flex>\\n' +\n    '        {{::\\'ERROR_400\\' | translate}}\\n' +\n    '    </div>\\n' +\n    '</pip-document>');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSettings.Templates');\n} catch (e) {\n  module = angular.module('pipSettings.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('user_settings/user_settings_basic_info.html',\n    '<form name=\"form\" style=\"width:100%;\" novalidate>\\n' +\n    '    <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '    </md-progress-linear>\\n' +\n    '    <div layout=\"row\" class=\"bm12\">\\n' +\n    '        <div class=\"md-tile-left\" style=\"position: relative; margin-right: 16px; height: 80px; width: 80px\">\\n' +\n    '            <pip-avatar-edit pip-party-id=\"$party.id\"\\n' +\n    '                             pip-created=\"onPictureCreated($event)\" pip-changed=\"onPictureChanged($control, $event)\">\\n' +\n    '            </pip-avatar-edit>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"md-tile-content tp0\" layout-align=\"center\">\\n' +\n    '            <h3 class=\"tm16 bm8 text-one-line\">{{ nameCopy }}</h3>\\n' +\n    '\\n' +\n    '            <p class=\"text-primary text-overflow m0\"> {{::\\'SETTINGS_BASIC_INFO_FROM\\' | translate}}\\n' +\n    '                {{$user.signup | formatLongDate }}</p>\\n' +\n    '\\n' +\n    '            <!--<p class=\"text-primary text-one-line\"> {{::\\'SETTINGS_BASIC_INFO_USER_ID\\' | translate}} {{$party.id}} </p>-->\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <md-input-container class=\"md-block\">\\n' +\n    '        <label>{{::\\'SETTINGS_BASIC_INFO_FULL_NAME\\' | translate}}</label>\\n' +\n    '        <input name=\"fullName\" ng-model=\"$party.name\" ng-disabled=\"transaction.busy()\"\\n' +\n    '               step=\"any\" type=\"text\" tabindex=\"0\"\\n' +\n    '               required\\n' +\n    '               ng-change=\"onChangeBasicInfo()\"/>\\n' +\n    '\\n' +\n    '        <div class=\"hint\" ng-if=\"errorsWithHint(form, form.fullName).hint\">{{::\\'ERROR_FULLNAME_INVALID\\' | translate}}\\n' +\n    '        </div>\\n' +\n    '    </md-input-container>\\n' +\n    '\\n' +\n    '    <md-input-container class=\"md-block bm0\">\\n' +\n    '        <label>{{::\\'SETTINGS_BASIC_INFO_PRIMARY_EMAIL\\' | translate}}</label>\\n' +\n    '        <input name=\"email\" pip-email-unique=\"{{$party.email}}\" ng-model=\"$party.email\"\\n' +\n    '               type=\"email\" required\\n' +\n    '               ng-change=\"onChangeBasicInfo()\"/>\\n' +\n    '\\n' +\n    '        <div class=\"hint\" ng-if=\"errorsWithHint(form, form.email).hint && !$user.email_ver\">{{::\\'SETTINGS_BASIC_INFO_VERIFY_HINT\\' |\\n' +\n    '            translate}}\\n' +\n    '        </div>\\n' +\n    '        <div ng-messages=\"errorsWithHint(form.email)\" ng-hide=\" $party.type ==\\'team\\'\">\\n' +\n    '            <div ng-message=\"email\">{{::\\'ERROR_EMAIL_INVALID\\' | translate}}</div>\\n' +\n    '            <div ng-message=\"emailUnique\">{{::\\'ERROR_EMAIL_INVALID\\' | translate}}</div>\\n' +\n    '        </div>\\n' +\n    '    </md-input-container>\\n' +\n    '\\n' +\n    '    <md-button ng-click=\"onVerifyEmail($event)\" ng-hide=\"$user.email_ver || $party.type ==\\'team\\'\"\\n' +\n    '               class=\"md-raised bm16 tm8 rm8\">\\n' +\n    '        {{::\\'SETTINGS_BASIC_INFO_VERIFY_CODE\\' | translate}}\\n' +\n    '    </md-button>\\n' +\n    '\\n' +\n    '    <md-button ng-click=\"onChangePassword($event)\" class=\"md-raised bm16 tm8\" ng-hide=\"$party.type ==\\'team\\'\">\\n' +\n    '        {{::\\'SETTINGS_BASIC_INFO_CHANGE_PASSWORD\\' | translate}}\\n' +\n    '    </md-button>\\n' +\n    '\\n' +\n    '    <md-input-container flex class=\"md-block\">\\n' +\n    '        <label>{{::\\'SETTINGS_BASIC_INFO_WORDS_ABOUT_ME\\' | translate }}</label>\\n' +\n    '        <textarea ng-model=\"$party.about\" columns=\"1\"\\n' +\n    '                  ng-change=\"onChangeBasicInfo()\"></textarea>\\n' +\n    '    </md-input-container>\\n' +\n    '\\n' +\n    '    <md-input-container class=\"md-block\" ng-hide=\"$party.type ==\\'team\\'\">\\n' +\n    '        <label>{{::\\'GENDER\\' | translate}}</label>\\n' +\n    '        <md-select ng-model=\"$party.gender\" ng-change=\"onChangeBasicInfo()\"\\n' +\n    '                   placeholder=\"{{\\'GENDER\\' | translate}}\">\\n' +\n    '            <md-option ng-value=\"gender.id\" ng-repeat=\"gender in genders\">{{gender.name}}</md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '\\n' +\n    '    <div ng-hide=\"$party.type ==\\'team\\'\">\\n' +\n    '        <p class=\"text-caption text-grey tm0 bm0\">{{::\\'SETTINGS_BASIC_INFO_BIRTHDAY\\' | translate}}</p>\\n' +\n    '        <pip-date ng-model=\"$party.birthday\" time-mode=\"past\" ng-change=\"onChangeBasicInfo()\"\\n' +\n    '                  pip-time-mode=\"past\"></pip-date>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '    <md-input-container class=\"md-block\" ng-hide=\"$party.type ==\\'team\\'\">\\n' +\n    '        <label>{{::\\'LANGUAGE\\' | translate}}</label>\\n' +\n    '        <md-select ng-model=\"$user.language\" ng-change=\"onChangeUser()\"\\n' +\n    '                   placeholder=\"{{\\'LANGUAGE\\' | translate}}\">\\n' +\n    '            <md-option ng-value=\"language.id\" ng-repeat=\"language in languages\">{{language.name}}</md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '\\n' +\n    '    <md-input-container class=\"md-block\" ng-if=\"$party.type !=\\'team\\'\">\\n' +\n    '        <label>{{::\\'THEME\\' | translate}}</label>\\n' +\n    '        <md-select ng-model=\"$user.theme\" ng-change=\"onChangeUser()\" class=\"w-stretch theme-text-primary\"\\n' +\n    '                   ng-disabled=\"transaction.busy()\">\\n' +\n    '            <md-option ng-value=\"theme\" ng-repeat=\"theme in themes\" ng-selected=\"$theme == theme ? true : false\">{{\\n' +\n    '                theme | translate }}\\n' +\n    '            </md-option>\\n' +\n    '        </md-select>\\n' +\n    '    </md-input-container>\\n' +\n    '    <pip-location-edit class=\"map-edit bm24-flex\"\\n' +\n    '                       ng-hide=\"$party.type ==\\'team\\'\"\\n' +\n    '                       pip-changed=\"onChangeBasicInfo()\"\\n' +\n    '                       pip-location-name=\"$party.loc_name\"\\n' +\n    '                       pip-location-pos=\"loc_pos\">\\n' +\n    '    </pip-location-edit>\\n' +\n    '</form>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSettings.Templates');\n} catch (e) {\n  module = angular.module('pipSettings.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('user_settings/user_settings_change_password.html',\n    '<md-dialog class=\"pip-dialog\" layout=\"column\"  width=\"440\">\\n' +\n    '    <form name=\"form\" ng-submit=\"onApply()\" >\\n' +\n    '    <div class=\"pip-header\">\\n' +\n    '        <h3 class=\"m0\">{{\\'SETTINGS_CHANGE_PASSWORD_TITLE\\' | translate : module}}</h3>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <div ng-messages=\"form.$serverError\" class=\"text-error bm8\">\\n' +\n    '                <div ng-message=\"ERROR_UNKNOWN\">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"md-block\">\\n' +\n    '                <label>{{ \\'SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD\\' | translate }}</label>\\n' +\n    '                <input name=\"oldPassword\" ng-model=\"changePasData.old_password\"\\n' +\n    '                       type=\"password\" ng-required=\"change_password.$submitted\" pip-clear-errors/>\\n' +\n    '\\n' +\n    '                <div ng-messages=\"errorsWithHint(form, form.oldPassword)\">\\n' +\n    '                    <div ng-message=\"required\">{{ \\'ERROR_REQUIRED\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1107\">{{ \\'ERROR_WRONG_PASSWORD\\' | translate }}</div>\\n' +\n    '                </div>\\n' +\n    '\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"md-block\">\\n' +\n    '                <label>{{ \\'SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD\\' | translate }}</label>\\n' +\n    '                <input name=\"newPassword\" ng-model=\"changePasData.new_password\"\\n' +\n    '                       ng-change=\"onCheckRepeatPassword()\"\\n' +\n    '                       ng-minlength=\"6\" type=\"password\" ng-required=\"change_password.$submitted\" pip-clear-errors/>\\n' +\n    '                <div class=\"hint\" ng-if=\"errorsWithHint(form, form.newPassword).hint\">{{ \\'HINT_PASSWORD\\' | translate }}</div>\\n' +\n    '                <div ng-messages=\"errorsWithHint(form, form.newPassword)\">\\n' +\n    '                    <div ng-message=\"required\">{{ \\'ERROR_REQUIRED\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"minlength\">{{ \\'HINT_PASSWORD\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"ERROR_1105\">{{ \\'ERROR_IDENTICAL_PASSWORDS\\' | translate }}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <md-input-container class=\"md-block\">\\n' +\n    '                <label>{{ \\'SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD\\' | translate }}</label>\\n' +\n    '                <input name=\"repeat\" ng-model=\"repeat\" ng-change=\"onCheckRepeatPassword()\"\\n' +\n    '                       ng-minlength=\"6\" type=\"password\" ng-required=\"change_password.$submitted\"/>\\n' +\n    '\\n' +\n    '                <div class=\"hint\" ng-if=\"errorsRepeatWithHint(form.repeat).hint\">{{ \\'HINT_REPEAT_PASSWORD\\' | translate }}</div>\\n' +\n    '                <div ng-messages=\"errorsRepeatWithHint(form.repeat)\">\\n' +\n    '                    <div ng-message=\"required\">{{ \\'ERROR_REQUIRED\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"minlength\">{{ \\'HINT_PASSWORD\\' | translate }}</div>\\n' +\n    '                    <div ng-message=\"repeat\">{{ \\'REPEAT_PASSWORD_INVALID\\' | translate }}</div>\\n' +\n    '                </div>\\n' +\n    '            </md-input-container>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <div>\\n' +\n    '            <md-button ng-click=\"onCancel()\" aria-label=\"xxx\">{{ \\'CANCEL\\' | translate }} </md-button>\\n' +\n    '            <md-button type=\"submit\" class=\"md-accent\" aria-label=\"xxx\">{{ \\'APPLY\\' | translate : module}}  </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    </form>\\n' +\n    '</md-dialog>\\n' +\n    '\\n' +\n    '\\n' +\n    '\\n' +\n    '\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSettings.Templates');\n} catch (e) {\n  module = angular.module('pipSettings.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('user_settings/user_settings_sessions.html',\n    '\\n' +\n    '    <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\">\\n' +\n    '    </md-progress-linear>\\n' +\n    '    <div class=\"pip-details-title\">\\n' +\n    '        <p class=\"pip-title bm16\">{{\\'SETTINGS_ACTIVE_SESSIONS_TITLE\\' | translate}}</p>\\n' +\n    '\\n' +\n    '        <p class=\"pip-subtitle\">{{\\'SETTINGS_ACTIVE_SESSIONS_SUBTITLE\\' | translate}}</p>\\n' +\n    '    </div>\\n' +\n    '\\n' +\n    '\\n' +\n    '<md-list class=\"w-stretch\">\\n' +\n    '    <md-item ng-repeat=\"session in sessions\" >\\n' +\n    '        <div layout=\"row\" ng-init=\"session.id != sessionId ? showBlock = true : showBlock = false\"\\n' +\n    '                          ng-click=\"showBlock = !showBlock\" >\\n' +\n    '            <p class=\"m0 text-subhead2 text-overflow max-w50-stretch\" >{{session.client}}</p>\\n' +\n    '            <p class=\"m0 lp4 text-body1 color-secondary-text \" flex>{{\\'SETTINGS_ACTIVE_SESSION_ACTIVE\\' | translate}} </p>\\n' +\n    '            <p class=\"m0 text-body1 color-secondary-text \">\\n' +\n    '                {{country}}\\n' +\n    '                <md-icon ng-if=\"showBlock\" md-svg-icon=\"icons:triangle-up\"></md-icon>\\n' +\n    '                <md-icon ng-if=\"!showBlock\" md-svg-icon=\"icons:triangle-down\"></md-icon>\\n' +\n    '            </p>\\n' +\n    '        </div>\\n' +\n    '        <div layout=\"row\" class=\"bm8 bp8\" ng-class=\"{\\' divider-bottom\\':!$last}\" >\\n' +\n    '            <div flex=\"50\">\\n' +\n    '                <p class=\"m0 bm4 text-body1 text-overflow color-secondary-text \" >{{ session.last_req | date : \\'medium\\' }}</p>\\n' +\n    '                <p class=\"m0 bm4 text-body1 text-overflow color-secondary-text \" ng-show=\"showBlock\">{{\\'SETTINGS_ACTIVE_SESSION_OS\\' | translate}}{{session.platform}}</p>\\n' +\n    '                <p class=\"m0 bm4 text-body1 text-overflow color-secondary-text \" ng-show=\"showBlock\">{{\\'SETTINGS_ACTIVE_SESSION_IP\\' | translate}}{{session.address}}</p>\\n' +\n    '                <md-button class=\"md-raised\" ng-show=\"showBlock && session.id != sessionId\" ng-click=\"onRemove(session)\">\\n' +\n    '                    {{\\'SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION\\' | translate}}\\n' +\n    '                </md-button>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <pip-location-ip class=\"map-edit\" ng-if=\"showBlock\" flex=\"50\"\\n' +\n    '                             pip-ipaddress=\"session.address\"\\n' +\n    '                             pip-extra-info=\"country = extraInfo.country\">\\n' +\n    '            </pip-location-ip>\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '    </md-item>\\n' +\n    '</md-list>\\n' +\n    '<div layout=\"row\" layout-align=\"end center\">\\n' +\n    '    <md-button class=\"md-raised\" ng-show=\"sessions.length > 1\" ng-click=\"onRemoveAll()\">\\n' +\n    '        {{\\'SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS\\' | translate}}\\n' +\n    '    </md-button>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSettings.Templates');\n} catch (e) {\n  module = angular.module('pipSettings.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('user_settings/user_settings_verify_email.html',\n    '<md-dialog class=\"pip-dialog\" layout=\"column\"  width=\"440\">\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '                <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\" class=\"pip-progress-top\" >\\n' +\n    '                </md-progress-linear>\\n' +\n    '\\n' +\n    '                <h2>{{\\'VERIFY_EMAIL_TITLE\\' | translate}}</h2>\\n' +\n    '\\n' +\n    '                <p class=\"title-padding\">{{\\'VERIFY_EMAIL_TEXT_1\\' | translate}} </p>\\n' +\n    '\\n' +\n    '                <form name=\\'form\\' novalidate>\\n' +\n    '                    <div ng-messages=\"form.$serverError\" class=\"text-error bm8\">\\n' +\n    '                        <div ng-message=\"ERROR_UNKNOWN\">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div>\\n' +\n    '                    </div>\\n' +\n    '\\n' +\n    '                    <md-input-container class=\"display  bp4 md-block\" >\\n' +\n    '                        <label>{{::\\'EMAIL\\' | translate}}</label>\\n' +\n    '                        <input name=\"email\" type=\"email\" ng-model=\"data.email\" required step=\"any\"\\n' +\n    '                               pip-clear-errors  tabindex=\"1\"\\n' +\n    '                               ng-disabled=\"transaction.busy()\"\\n' +\n    '                               pip-test=\"input-email\"/>\\n' +\n    '                        <div class=\"hint\" ng-if=\"errorsWithHint(form, form.email).hint\">{{::\\'HINT_EMAIL\\' | translate}}</div>\\n' +\n    '                        <div ng-messages=\"errorsWithHint(form, form.email)\"\\n' +\n    '                             xng-if=\"!form.email.$pristine\">\\n' +\n    '                            <div ng-message=\"required\">{{::\\'ERROR_EMAIL_INVALID\\' | translate }}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1106\">{{::\\'ERROR_USER_NOT_FOUND\\' | translate}}</div>\\n' +\n    '                        </div>\\n' +\n    '                    </md-input-container>\\n' +\n    '\\n' +\n    '                    <md-input-container class=\"md-block\">\\n' +\n    '                        <label>{{\\'ENTRY_VERIFICATION_CODE\\' | translate}}</label>\\n' +\n    '                        <input name=\"code\" ng-disabled=\"transaction.busy()\" tabindex=\"0\"\\n' +\n    '                               ng-model=\"data.code\" required pip-clear-errors/>\\n' +\n    '                        <div ng-messages=\"errorsWithHint(form, form.code)\">\\n' +\n    '                            <div ng-message=\"required\"> {{ \\'ERROR_CODE_INVALID\\' | translate }}</div>\\n' +\n    '                            <div ng-message=\"ERROR_1103\"> {{ \\'ERROR_CODE_WRONG\\' | translate }}</div>\\n' +\n    '                        </div>\\n' +\n    '                    </md-input-container>\\n' +\n    '\\n' +\n    '                    <p>\\n' +\n    '                        {{\\'VERIFY_EMAIL_TEXT_21\\' | translate}} \\n' +\n    '                        <a ng-click=\"onRequestVerificationClick()\" class=\"pointer\" tabindex=\"0\">{{\\'VERIFY_EMAIL_RESEND\\' | translate}}</a>\\n' +\n    '                        {{\\'VERIFY_EMAIL_TEXT_22\\' | translate}} \\n' +\n    '                    </p>\\n' +\n    '                </form>\\n' +\n    '            </div>\\n' +\n    '        </div>\\n' +\n    '        <div class=\"pip-footer\">\\n' +\n    '            <md-button ng-click=\"onCancel()\" ng-hide=\"transaction.busy()\" aria-label=\"xxx\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-click=\"onVerify()\" ng-hide=\"transaction.busy()\" tabindex=\"0\" aria-label=\"xxx\"\\n' +\n    '                ng-disabled=\"data.code.length == 0 || data.email.length == 0 || (!data.email && form.$pristine) || (!data.code)\">\\n' +\n    '                {{::\\'VERIFY\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-warn\" ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" tabindex=\"0\" aria-label=\"xxx\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '        </div>\\n' +\n    '</md-dialog>');\n}]);\n})();\n","/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSettings.Page', [\r\n        'pipState', 'pipSettings.Service', 'pipAppBar', 'pipSelected', 'pipTranslate',\r\n        'pipSettings.Templates'\r\n    ]);\r\n\r\n    thisModule.config(['pipAuthStateProvider', function (pipAuthStateProvider) {\r\n        pipAuthStateProvider.state('settings', {\r\n            url: '/settings?party_id',\r\n            auth: true,\r\n            controller: 'pipSettingsPageController',\r\n            templateUrl: 'settings_page/settings_page.html'\r\n        });\r\n    }]);\r\n\r\n    thisModule.controller('pipSettingsPageController', ['$scope', '$state', '$rootScope', 'pipAppBar', 'pipSettings', function ($scope, $state, $rootScope, pipAppBar, pipSettings) {\r\n\r\n        $scope.pages = _.filter(pipSettings.getPages(), function (page) {\r\n            if (page.visible === true && (page.access ? page.access($rootScope.$user, page) : true)) {\r\n                return page;\r\n            }\r\n        });\r\n\r\n        $scope.pages =_.sortBy($scope.pages, function(page){\r\n            return page.index;\r\n        });\r\n\r\n        $scope.selected = {};\r\n        if ($state.current.name != 'settings')\r\n            initSelect($state.current.name);\r\n        else {\r\n            if (pipSettings.getDefaultPage())\r\n                initSelect(pipSettings.getDefaultPage().state);\r\n            else {\r\n                setTimeout(function () {\r\n                    if (pipSettings.getDefaultPage())\r\n                        initSelect(pipSettings.getDefaultPage().state);\r\n                    else {\r\n                        if($scope.pages.length >0)\r\n                            initSelect($scope.pages[0].state);\r\n\r\n                    }\r\n                }, 0);\r\n\r\n            }\r\n\r\n        }\r\n\r\n        appHeader();\r\n\r\n        $scope.onNavigationSelect = onNavigationSelect;\r\n        $scope.onDropdownSelect = onDropdownSelect;\r\n\r\n        return;\r\n\r\n        function appHeader() {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleText('SETTINGS_TITLE');\r\n            pipAppBar.showLocalActions(null, []);\r\n            pipAppBar.hideShadow();\r\n            pipAppBar.hideSearch();\r\n        };\r\n\r\n        function onDropdownSelect(state) {\r\n            onNavigationSelect(state.state);\r\n        }\r\n\r\n        function onNavigationSelect(state) {\r\n            initSelect(state);\r\n\r\n            if ($scope.selected.page) {\r\n\r\n                $state.go(state);\r\n\r\n            }\r\n        };\r\n\r\n        function initSelect(state) {\r\n            $scope.selected.page = _.find($scope.pages, function (page) {\r\n                return page.state == state;\r\n            });\r\n            $scope.selected.pageIndex = _.indexOf($scope.pages, $scope.selected.page);\r\n            $scope.selected.pageId = state;\r\n        }\r\n    }]);\r\n\r\n\r\n})();","(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipSettings.Service', []);\r\n\r\n    thisModule.provider('pipSettings', ['pipAuthStateProvider', function (pipAuthStateProvider) {\r\n\r\n        var defaultPage,\r\n            pages = [];\r\n\r\n        return {\r\n            addPage: addPage,\r\n            getPages: getPages,\r\n            setDefaultPage: setDefaultPage,\r\n            getDefaultPage: getDefaultPage,\r\n\r\n            $get: function () {\r\n                return {\r\n                    getPages: getPages,\r\n                    addPage: addPage,\r\n                    getDefaultPage: getDefaultPage,\r\n                    setDefaultPage: setDefaultPage\r\n                }\r\n            }\r\n        };\r\n\r\n        function getFullStateName(state) {\r\n            return 'settings.' + state;\r\n        }\r\n\r\n        function getPages() {\r\n            return _.clone(pages, true);\r\n        }\r\n\r\n        function getDefaultPage() {\r\n            var defaultPage = _.find(pages, function(p) { return p.state == defaultPage; })\r\n            return _.clone(defaultPage, true);\r\n        }\r\n\r\n        function addPage(pageObj) {\r\n            validatePage(pageObj);\r\n\r\n            var existingPage = _.find(pages, function (p) { return p.state == getFullStateName(pageObj.state); });\r\n            if (existingPage) {\r\n                throw new Error('Page with state name \"' + pageObj.state + '\" is already registered');\r\n            }\r\n\r\n            pages.push({\r\n                state: getFullStateName(pageObj.state),\r\n                title: pageObj.title,\r\n                index: pageObj.index || 100000,\r\n                access: pageObj.access,\r\n                visible: pageObj.visible !== false,\r\n                stateConfig: _.clone(pageObj.stateConfig, true)\r\n            });\r\n\r\n            pipAuthStateProvider.state(getFullStateName(pageObj.state), pageObj.stateConfig);\r\n\r\n            // if we just added first state and no default state is specified\r\n            if (typeof defaultPage === 'undefined' && pages.length === 1) {\r\n                setDefaultPage(pageObj.state);\r\n            }\r\n        }\r\n\r\n        function setDefaultPage(name) {\r\n            if (!_.find(pages, function(page) { return page.state == getFullStateName(name); })) {\r\n                throw new Error('Page with state name \"' + name + '\" is not registered');\r\n            }\r\n\r\n            defaultPage = getFullStateName(name);\r\n\r\n            pipAuthStateProvider.redirect('settings', getFullStateName(name));\r\n        }\r\n\r\n        function validatePage(pageObj) {\r\n            if (!pageObj || !_.isObject(pageObj)) {\r\n                throw new Error('Invalid object');\r\n            }\r\n\r\n            if (pageObj.state == null || pageObj.state == '') {\r\n                throw new Error('Page should have valid Angular UI router state name');\r\n            }\r\n\r\n            if (pageObj.access && !_.isFunction(pageObj.access)) {\r\n                throw new Error('\"access\" should be a function');\r\n            }\r\n\r\n            if (!pageObj.stateConfig || !_.isObject(pageObj.stateConfig)) {\r\n                throw new Error('Invalid state configuration object');\r\n            }\r\n        }\r\n    }]);\r\n\r\n})();","/**\r\n * @file Settings page logic\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings', [\r\n        'ngMaterial', 'pipData', 'pipSettings.Service', 'pipSettings.Page',\r\n        'pipUserSettings.Data', 'pipUserSettings.Strings',  //'pipUserSettings.Blacklist',\r\n        'pipUserSettings.BasicInfo',\r\n        //'pipUserSettings.ContactInfo',\r\n        'pipUserSettings.Sessions', 'pipSettings.Templates'\r\n\r\n    ]);\r\n\r\n})();","/**\r\n * @file Settings basic info controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.BasicInfo', ['pipUserSettings.ChangePassword', 'pipUserSettings.VerifyEmail']);\r\n\r\n    thisModule.config(['pipSettingsProvider', 'pipUserSettingsPageDataProvider', 'pipAuthStateProvider', function (pipSettingsProvider, pipUserSettingsPageDataProvider, pipAuthStateProvider) {\r\n        pipSettingsProvider.addPage({\r\n            state: 'basic_info',\r\n            index: 1,\r\n            title: 'SETTINGS_BASIC_INFO_TITLE',\r\n            stateConfig: {\r\n                url: '/basic_info',\r\n                controller: 'pipUserSettingsBasicInfoController',\r\n                templateUrl: 'user_settings/user_settings_basic_info.html',\r\n                auth: true\r\n            }\r\n        });\r\n\r\n        pipSettingsProvider.setDefaultPage('basic_info');\r\n    }]);\r\n\r\n    thisModule.controller('pipUserSettingsBasicInfoController',\r\n        ['$scope', '$rootScope', '$mdDialog', '$state', 'pipTranslate', 'pipTransaction', 'pipFormErrors', 'pipUserSettingsPageData', 'pipToasts', '$window', 'pipTheme', '$mdTheming', function ($scope, $rootScope, $mdDialog, $state, pipTranslate, pipTransaction, pipFormErrors,\r\n                  pipUserSettingsPageData, pipToasts, $window, pipTheme, $mdTheming) {\r\n\r\n            $scope.originalParty = angular.toJson($rootScope.$party);\r\n\r\n            $scope.nameCopy = $rootScope.$party.name;\r\n            setTimeout(function () {\r\n                $scope.loc_pos = $rootScope.$party.loc_pos;\r\n                $scope.$apply();\r\n            });\r\n\r\n            $scope.genders = pipTranslate.translateSet(['male', 'female', 'n/s']);\r\n            $scope.languages = pipTranslate.translateSet(['ru', 'en']);\r\n\r\n            $scope.transaction = pipTransaction('settings.basic_info', $scope);\r\n\r\n            $scope.themes = _.keys(_.omit($mdTheming.THEMES, 'default'));\r\n\r\n            $state.get('settings.basic_info').onExit = saveChanges;\r\n\r\n            $scope.errorsWithHint = pipFormErrors.errorsWithHint;\r\n            $scope.onChangePassword = onChangePassword;\r\n            $scope.onVerifyEmail = onVerifyEmail;\r\n            $scope.onPictureCreated = onPictureCreated;\r\n            $scope.onPictureChanged = onPictureChanged;\r\n            $scope.onChangeUser = _.debounce(updateUser, 2000);\r\n            $scope.onChangeBasicInfo = _.debounce(saveChanges, 2000);\r\n\r\n            return;\r\n\r\n            //-----------------------------\r\n\r\n            function onPictureChanged($control) {\r\n                $scope.picture.save(\r\n                    function () {\r\n                        $rootScope.$broadcast('pipPartyAvatarUpdated');\r\n\r\n                    },\r\n                    function (error) {\r\n                        console.error(error);\r\n                    }\r\n                );\r\n            };\r\n\r\n            function onPictureCreated($event) {\r\n                $scope.picture = $event.sender;\r\n                $scope.picture.save(\r\n                    function () {\r\n                        $rootScope.$broadcast('pipPartyAvatarUpdated');\r\n                    },\r\n                    function (error) {\r\n                        console.error(error);\r\n                    }\r\n                );\r\n            };\r\n\r\n\r\n            function saveChanges() {\r\n                if ($scope.form)\r\n                    $scope.form.$setSubmitted();\r\n\r\n                console.log('aa', $rootScope.$party);\r\n                if ($rootScope.$party) {\r\n\r\n                    if ($rootScope.$party.type == 'person')\r\n                        if ($scope.form.$invalid)\r\n                            return;\r\n\r\n                    // Check to avoid unnecessary savings\r\n                    $rootScope.$party.loc_pos = $scope.loc_pos;\r\n                    var party = angular.toJson($rootScope.$party);\r\n\r\n                    if (party != $scope.originalParty) {\r\n                        pipUserSettingsPageData.updateParty($scope.transaction, $rootScope.$party,\r\n                            function (data) {\r\n                                $scope.originalParty = party;\r\n                                $scope.nameCopy = data.name;\r\n                            }, function (error) {\r\n                                $scope.message = String() + 'ERROR_' + error.status || error.data.status_code;\r\n                                //pipToasts.showNotification(pipTranslate.translate($scope.message), null, null, null);\r\n                                $rootScope.$party = angular.fromJson($scope.originalParty);\r\n                            }\r\n                        );\r\n                    }\r\n                }\r\n\r\n            };\r\n\r\n            function updateUser() {\r\n\r\n                //if ($rootScope.$user.theme)\r\n                //pipTheme.setCurrentTheme($rootScope.$user.theme);\r\n\r\n                if ($rootScope.$user.id == $rootScope.$party.id) {\r\n                    pipUserSettingsPageData.updateUser($scope.transaction, $rootScope.$user,\r\n                        function (data) {\r\n                            pipTranslate.use(data.language);\r\n                            $rootScope.$user.language = data.language;\r\n                            $rootScope.$user.theme = data.theme;\r\n                            if ($rootScope.$user.theme)\r\n                                pipTheme.setCurrentTheme($rootScope.$user.theme, true);\r\n\r\n\r\n                            // $window.location.reload();\r\n\r\n                        }, function (error) {\r\n                            var message = String() + 'ERROR_' + error.status || error.data.status_code;\r\n                            pipToasts.showNotification(pipTranslate.translate(message), null, null, null);\r\n                            //$scope.user.language =  angular.fromJson($scope.originalParty).language;\r\n                            //$scope.user.theme = angular.fromJson($scope.originalParty).theme;\r\n                        }\r\n                    );\r\n                }\r\n\r\n\r\n            };\r\n\r\n            function onChangePassword(event) {\r\n                $mdDialog.show({\r\n                    templateUrl: 'user_settings/user_settings_change_password.html',\r\n                    controller: 'pipUserSettingsChangePasswordController',\r\n                    targetEvent: event,\r\n                    locals: {email: $rootScope.$party.email}\r\n                }).then(\r\n                    function (answer) {\r\n                        if (answer) {\r\n                            var message = String() + 'RESET_PWD_SUCCESS_TEXT';\r\n                            pipToasts.showNotification(pipTranslate.translate(message), null, null, null);\r\n                        }\r\n                    });\r\n            };\r\n\r\n            function onVerifyEmail(event) {\r\n                $mdDialog.show({\r\n                    templateUrl: 'user_settings/user_settings_verify_email.html',\r\n                    controller: 'pipUserSettingsVerifyEmailController',\r\n                    targetEvent: event,\r\n                    locals: {email: $rootScope.$party.email}\r\n                }).then(\r\n                    function (answer) {\r\n                        $scope.user.email_ver = answer;\r\n                        if (answer) {\r\n                            var message = String() + 'VERIFY_EMAIL_SUCCESS_TEXT';\r\n                            pipToasts.showNotification(pipTranslate.translate(message), null, null, null);\r\n\r\n                        }\r\n                    }\r\n                );\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Settings change password controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.ChangePassword', []);\r\n\t\r\n    thisModule.controller('pipUserSettingsChangePasswordController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'pipRest', 'pipTransaction', 'pipFormErrors', 'email', function($scope, $rootScope, $mdDialog, pipRest, pipTransaction, pipFormErrors, email) {\r\n        \r\n            $scope.transaction = pipTransaction('settings.change_password', $scope);\r\n            $scope.errorsRepeatWithHint = function (form,formPart) {\r\n                if ($scope.showRepeatHint)  \r\n                    return pipFormErrors.errorsWithHint(form, formPart);\r\n                else return { };\r\n            };\r\n            $scope.showRepeatHint = true;\r\n            $scope.changePasData = {};\r\n            \r\n            $scope.errorsWithHint = pipFormErrors.errorsWithHint;\r\n            $scope.onCancel = onCancel;\r\n            $scope.onCheckRepeatPassword = onCheckRepeatPassword;\r\n            $scope.onApply = onApply;\r\n    \r\n            return;\r\n            \r\n            //-----------------------------\r\n            \r\n            function onCancel() {\r\n                $mdDialog.cancel();\r\n            };\r\n    \r\n            function onCheckRepeatPassword() {\r\n                if ($scope.changePasData)\r\n                    if ($scope.repeat === $scope.changePasData.new_password || $scope.repeat == \"\" || !$scope.repeat) {\r\n                        $scope.form.repeat.$setValidity('repeat', true);\r\n                        if ($scope.repeat === $scope.changePasData.new_password)\r\n                            $scope.showRepeatHint = false;\r\n                        else\r\n                            $scope.showRepeatHint = true;\r\n                    }\r\n                    else {\r\n                        $scope.showRepeatHint = true;\r\n                        $scope.form.repeat.$setValidity('repeat', false);\r\n                    }\r\n            };\r\n    \r\n            function onApply() {\r\n                $scope.onCheckRepeatPassword();\r\n    \r\n                if ($scope.form.$invalid) return;\r\n    \r\n                if (!$scope.transaction.begin('CHANGE_PASSWORD')) return;\r\n    \r\n                $scope.changePasData.email = email;\r\n    \r\n                pipRest.changePassword().call(\r\n                    $scope.changePasData,\r\n                    function (data) {\r\n                        $scope.transaction.end();\r\n                        $mdDialog.hide(true);\r\n                    },\r\n                    function (error) {\r\n                        $scope.transaction.end(error);\r\n    \r\n                        //pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            { \r\n                                1107 : 'oldPassword', \r\n                                1105 : 'newPassword' \r\n                            }\r\n                        );\r\n                    }\r\n                );\r\n            };\r\n        }]\r\n    );\r\n\t\r\n})();\r\n","/**\r\n * @file Settings data model\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.Data', ['pipDataModel']);\r\n\r\n    thisModule.provider('pipUserSettingsPageData', function () {\r\n\r\n        this.readContactsResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.getOwnContacts().get({\r\n                    party_id: pipRest.partyId($stateParams),\r\n                    session_id: pipRest.sessionId()\r\n                }).$promise;\r\n            }];\r\n\r\n        this.readBlocksResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.connectionBlocks().query({\r\n                    party_id: pipRest.partyId($stateParams)\r\n                }).$promise;\r\n            }];\r\n\r\n        this.readSessionsResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.userSessions().query({\r\n                    party_id: pipRest.partyId($stateParams)\r\n                }).$promise;\r\n            }];\r\n\r\n        this.readActivitiesResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.partyActivities().page({\r\n                    party_id: pipRest.partyId($stateParams),\r\n                    paging: 1,\r\n                    skip: 0,\r\n                    take: 25\r\n                }).$promise;\r\n            }];\r\n\r\n        this.readSettingsResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.partySettings().get({\r\n                    party_id: pipRest.partyId($stateParams)\r\n                }).$promise;\r\n            }];\r\n\r\n        this.readSessionIdResolver = /* @ngInject */\r\n            ['$stateParams', 'pipRest', function ($stateParams, pipRest) {\r\n                return pipRest.sessionId();\r\n            }];\r\n\r\n        // CRUD operations and other business methods\r\n\r\n        this.$get = ['pipRest', '$stateParams', function (pipRest, $stateParams) {\r\n            return {\r\n                partyId: pipRest.partyId,\r\n\r\n                updateParty: function (transaction, party, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('UPDATING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.parties().update(\r\n                        party,\r\n                        function (updatedParty) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(updatedParty);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                saveContacts: function (transaction, contacts, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('SAVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.contacts().save(\r\n                        contacts,\r\n                        function (savedContacts) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(savedContacts);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                updateContact: function (transaction, contact, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('UPDATING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.contacts().update(\r\n                        contact,\r\n                        function (updatedContact) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n                            if (successCallback) successCallback(updatedContact);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                updateUser: function (transaction, user, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('UPDATING');\r\n                    if (!tid) return;\r\n                    pipRest.users().update(\r\n                        user,\r\n                        function (updatedUser) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(updatedUser);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                removeBlock: function (transaction, block, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('REMOVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.connectionBlocks().remove(\r\n                        block,\r\n                        function (removedBlock) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(removedBlock);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                removeSession: function (transaction, session, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('REMOVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.userSessions().remove(\r\n                        {\r\n                            id: session.id,\r\n                            party_id: pipRest.partyId($stateParams)\r\n                        },\r\n                        function (removedSession) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(removedSession);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                requestEmailVerification: function (transaction) {\r\n                    var tid = transaction.begin('RequestEmailVerification');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.requestEmailVerification().get(\r\n                        {\r\n                            party_id: pipRest.partyId($stateParams)\r\n                        }, function () {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n                        }, function (error) {\r\n                            transaction.end(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                verifyEmail: function (transaction, verifyData, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('Verifying');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.verifyEmail().call(\r\n                        verifyData,\r\n                        function (verifyData) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(verifyData);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                saveSettings: function (transaction, settings, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('SAVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.partySettings().save(\r\n                        settings,\r\n                        function (savedSettings) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(savedSettings);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                getPreviousActivities: function (transaction, start, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('SAVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.partyActivities().page(\r\n                        {\r\n                            party_id: pipRest.partyId($stateParams),\r\n                            paging: 1,\r\n                            skip: start,\r\n                            take: 25\r\n                        },\r\n                        function (pagedActivities) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(pagedActivities);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                },\r\n\r\n                getRefPreviousEventsActivities: function (transaction, start, ref_type, item, successCallback, errorCallback) {\r\n                    var tid = transaction.begin('SAVING');\r\n                    if (!tid) return;\r\n\r\n                    pipRest.partyActivities().page(\r\n                        {\r\n                            party_id: pipRest.partyId($stateParams),\r\n                            paging: 1,\r\n                            skip: start,\r\n                            ref_type: ref_type,\r\n                            ref_id: item.id,\r\n                            take: 25\r\n                        },\r\n                        function (pagedActivities) {\r\n                            if (transaction.aborted(tid)) return;\r\n                            else transaction.end();\r\n\r\n                            if (successCallback) successCallback(pagedActivities);\r\n                        },\r\n                        function (error) {\r\n                            transaction.end(error);\r\n                            if (errorCallback) errorCallback(error);\r\n                        }\r\n                    );\r\n                }\r\n            }\r\n        }];\r\n    });\r\n\r\n})();","/**\r\n * @file Settings sessions controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.Sessions', []);\r\n\r\n    thisModule.config(['pipSettingsProvider', 'pipUserSettingsPageDataProvider', 'pipAuthStateProvider', function (pipSettingsProvider, pipUserSettingsPageDataProvider,  pipAuthStateProvider) {\r\n        pipSettingsProvider.addPage({\r\n            state: 'sessions',\r\n            index: 3,\r\n            title: 'SETTINGS_ACTIVE_SESSIONS_TITLE',\r\n            stateConfig: {\r\n                url: '/sessions',\r\n                controller: 'pipUserSettingsSessionsController',\r\n                templateUrl: 'user_settings/user_settings_sessions.html',\r\n                auth: true,\r\n                resolve: {\r\n                    sessions: pipUserSettingsPageDataProvider.readSessionsResolver,\r\n                    sessionId: pipUserSettingsPageDataProvider.readSessionIdResolver\r\n                }\r\n            }\r\n        });\r\n    }]);\r\n\r\n    thisModule.controller('pipUserSettingsSessionsController',\r\n        ['$scope', 'pipTransaction', 'pipUserSettingsPageData', 'sessions', 'sessionId', function ($scope, pipTransaction, pipUserSettingsPageData, sessions, sessionId) {\r\n\r\n            $scope.sessionId = sessionId;\r\n            $scope.transaction = pipTransaction('settings.sessions', $scope);\r\n            $scope.sessions = sessions;\r\n\r\n            $scope.onRemoveAll = onRemoveAll;\r\n            $scope.onRemove = onRemove;\r\n\r\n            return;\r\n            //-----------------------------\r\n\r\n            function onRemoveAll() {\r\n                async.each($scope.sessions, function (session) {\r\n                    if (session.id != $scope.sessionId)\r\n                        $scope.onRemove(session);\r\n                });\r\n            }\r\n\r\n            function onRemove(session) {\r\n                if (session.id == $scope.sessionId) return;\r\n\r\n                pipUserSettingsPageData.removeSession($scope.transaction, session,\r\n                    function () {\r\n                        $scope.sessions = _.without($scope.sessions, session);\r\n                    }, \r\n                    function (error) {\r\n                        $scope.message = 'ERROR_' + error.status || error.data.status_code;\r\n\r\n                        //$scope.onShowToast(message, 'error');\r\n                    }\r\n                );\r\n            }\r\n        }]\r\n    );\r\n\t\r\n})();\r\n","/**\r\n * @file Settings string resources\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.Strings', ['pipTranslate']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n\r\n        // Set translation strings for the module\r\n        pipTranslateProvider.translations('en', {\r\n            'SETTINGS_TITLE': 'Settings',\r\n            'SETTINGS_BASIC_INFO_TITLE': 'Basic info',\r\n            'SETTINGS_ACTIVE_SESSIONS_TITLE': 'Active sessions',\r\n\r\n            'SETTINGS_BASIC_INFO_FULL_NAME': 'Full name',\r\n            'SETTINGS_BASIC_INFO_VERIFY_HINT': 'Please, verify your email address.',\r\n            'SETTINGS_BASIC_INFO_VERIFY_CODE': 'Verify email address',\r\n            'SETTINGS_BASIC_INFO_DATE_CHANGE_PASSWORD': 'Your password was changed on ',\r\n            'SETTINGS_BASIC_INFO_CHANGE_PASSWORD': 'Change your password',\r\n            'SETTINGS_BASIC_INFO_NAME_HINT': 'Please, use your real name to let other people know who you are.',\r\n            'SETTINGS_BASIC_INFO_WORDS_ABOUT_ME': 'Few words about yourself',\r\n\r\n            'SETTINGS_BASIC_INFO_GENDER': 'Gender', \r\n            'SETTINGS_BASIC_INFO_BIRTHDAY': 'Birthday',\r\n            'SETTINGS_BASIC_INFO_LOCATION': 'Current location', \r\n            'SETTINGS_BASIC_INFO_PRIMARY_EMAIL':'Primary email',\r\n            'SETTINGS_BASIC_INFO_FROM':'User since ',\r\n            'SETTINGS_BASIC_INFO_USER_ID':'User ID',\r\n\r\n            'SETTINGS_CHANGE_PASSWORD_TITLE':'Change password',\r\n            'SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD':'New password',\r\n            'SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD':'Repeat password',\r\n            'SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD':'Current password',\r\n\r\n            'SETTINGS_ACTIVE_SESSIONS_SUBTITLE':\" If you notice any unfamiliar devices or locations, click 'Close Session' to end the session.\",\r\n            'SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION':'Close session',\r\n            'SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS':'Close active sessions',\r\n            'SETTINGS_ACTIVE_SESSION_OS' : 'OS: ',\r\n            'SETTINGS_ACTIVE_SESSION_IP' : 'IP: ',\r\n            'SETTINGS_ACTIVE_SESSION_ACTIVE':'active',\r\n\r\n            'SETTINGS_BLACKLIST_TITLE': 'Blacklist',\r\n            'SETTINGS_BLACKLIST_SUBTITLE': 'Parties from blacklist will not be able to send you invitations and private messages.',\r\n            'SETTINGS_BLACKLIST_UNBLOCK': 'Unblock',\r\n            'SETTINGS_BLACKLIST_EMPTY':'You have no blocked parties',\r\n\r\n            'SETTINGS_CONTACT_INFO_TITLE': 'Contact info',\r\n            'SETTINGS_CONTACT_INFO_EMAIL':'Email',\r\n            'SETTINGS_CONTACT_INFO_ADD_EMAIL':'Add email',\r\n            'SETTINGS_CONTACT_INFO_ADD_PHONE' : 'Add phone',\r\n            'SETTINGS_CONTACT_INFO_ADD_ADDRESS' : 'Add address',\r\n            'SETTINGS_CONTACT_INFO_ADD_ACCOUNT' : 'Add account',\r\n            'SETTINGS_CONTACT_INFO_ADD_URL' : 'Add URL',\r\n            'SETTINGS_CONTACT_INFO_ADDRESS':'Address',\r\n            'SETTINGS_CONTACT_INFO_PHONE':'Phone',\r\n            'SETTINGS_CONTACT_INFO_ACCOUNT_NAME':'Account name',\r\n            'SETTINGS_CONTACT_INFO_URL':'URL',\r\n\r\n            'THEME':'Theme',\r\n                        \r\n            //Hints\r\n// определено в entry           'HINT_PASSWORD' : 'Minimum 6 characters',\r\n            'HINT_REPEAT_PASSWORD' : 'Repeat password',\r\n\r\n            //Errors\r\n            'ERROR_WRONG_PASSWORD' : 'Wrong password',\r\n            'ERROR_IDENTICAL_PASSWORDS' : 'Old and new passwords are identical',\r\n            'REPEAT_PASSWORD_INVALID' : 'Password does not match',\r\n            'ERROR_EMAIL_INVALID' : 'Please, enter a valid email'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'SETTINGS_TITLE': 'Настройки',\r\n            'SETTINGS_BASIC_INFO_TITLE': 'Основные данные',\r\n            'SETTINGS_ACTIVE_SESSIONS_TITLE': 'Активные сессии',\r\n\r\n            'SETTINGS_BASIC_INFO_FULL_NAME': 'Полное имя',\r\n            'SETTINGS_BASIC_INFO_NAME_HINT': 'Пожалуйста, используйте реальное имя, чтоб люди могли вас узнать',\r\n            'SETTINGS_BASIC_INFO_VERIFY_HINT': 'Пожалуйста, подтвердите адрес своей электронной почты',\r\n            'SETTINGS_BASIC_INFO_VERIFY_CODE': 'Подтвердите адрес эл.почты',\r\n            'SETTINGS_BASIC_INFO_DATE_CHANGE_PASSWORD': 'Ваш пароль был изменен ',\r\n            'SETTINGS_BASIC_INFO_CHANGE_PASSWORD': 'Поменять пароль',\r\n\r\n            'SETTINGS_BASIC_INFO_WORDS_ABOUT_ME': 'Несколько слов о себе',\r\n            'SETTINGS_BASIC_INFO_GENDER': 'Пол',\r\n            'SETTINGS_BASIC_INFO_BIRTHDAY': 'Дата рождения',\r\n            'SETTINGS_BASIC_INFO_LOCATION': 'Текущее местонахождение',\r\n            'SETTINGS_BASIC_INFO_PRIMARY_EMAIL':'Основной адрес эл. почты',\r\n            'SETTINGS_BASIC_INFO_FROM':'Начиная с',\r\n            'SETTINGS_BASIC_INFO_USER_ID':'Личный код',\r\n\r\n            'SETTINGS_CHANGE_PASSWORD_TITLE':'Изменить пароль',\r\n            'SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD':'Новый пароль',\r\n            'SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD':'Повтор',\r\n            'SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD':'Текущий пароль',\r\n\r\n            'SETTINGS_ACTIVE_SESSIONS_SUBTITLE':'Если вы заметили какие-либо незнакомые устройства или месторасположение, нажмите кнопку \"Закончить сеанс\", чтобы завершить сеанс.',\r\n            'SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION':'Закрыть сессию',\r\n            'SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS':'Закрыть активные сессии',\r\n            'SETTINGS_ACTIVE_SESSION_OS' : 'ОС: ',\r\n            'SETTINGS_ACTIVE_SESSION_IP' : 'IP: ',\r\n            'SETTINGS_ACTIVE_SESSION_ACTIVE': 'Активно',\r\n\r\n            'SETTINGS_BLACKLIST_TITLE': 'Блокировки',\r\n            'SETTINGS_BLACKLIST_SUBTITLE': 'Участники из черного списка не смогут посылать вам приглашения и личные сообщения.',\r\n            'SETTINGS_BLACKLIST_UNBLOCK': 'Разблокировать',\r\n            'SETTINGS_BLACKLIST_EMPTY':'У вас нет заблокированных участников',\r\n\r\n            'SETTINGS_CONTACT_INFO_TITLE': 'Контакты',\r\n            'SETTINGS_CONTACT_INFO_EMAIL':'Адрес электронной почты',\r\n            'SETTINGS_CONTACT_INFO_ADD_EMAIL':'Добавить адрес эл. почты',\r\n            'SETTINGS_CONTACT_INFO_ADD_PHONE' : 'Добавить телефон',\r\n            'SETTINGS_CONTACT_INFO_ADD_ADDRESS' : 'Добавить адрес',\r\n            'SETTINGS_CONTACT_INFO_ADD_ACCOUNT' : 'Добавить аккаунт',\r\n            'SETTINGS_CONTACT_INFO_ADD_URL' : 'Добавить веб-сайт',\r\n            'SETTINGS_CONTACT_INFO_ADDRESS': 'Адрес',\r\n            'SETTINGS_CONTACT_INFO_PHONE': 'Телефон',\r\n            'SETTINGS_CONTACT_INFO_ACCOUNT_NAME': 'Учетка в мессенджере',\r\n            'SETTINGS_CONTACT_INFO_URL': 'Веб сайт',\r\n\r\n            'THEME':'Тема',\r\n\r\n            //Hints\r\n// определено в entry               'HINT_PASSWORD' : 'Минимум 6 знаков',\r\n            'HINT_REPEAT_PASSWORD' : 'Повторите пароль',\r\n            \r\n            //Errors\r\n            'ERROR_WRONG_PASSWORD' : 'Неправильный пароль',\r\n            'ERROR_IDENTICAL_PASSWORDS' : 'Старый и новый пароли идентичны',\r\n            'REPEAT_PASSWORD_INVALID' : 'Пароль не совпадает',\r\n            'ERROR_EMAIL_INVALID' : 'Пожалуйста, введите правильный почт.адрес'\r\n        });\r\n    }]);\r\n\r\n})();","/**\r\n * @file Settings verify email controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipUserSettings.VerifyEmail', []);\r\n\r\n    thisModule.controller('pipUserSettingsVerifyEmailController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'pipTransaction', 'pipFormErrors', 'pipUserSettingsPageData', 'email', function ($scope, $rootScope, $mdDialog, pipTransaction, pipFormErrors, pipUserSettingsPageData, email) {\r\n\r\n            $scope.emailVerified = false;\r\n            $scope.data = {\r\n                email: email,\r\n                code: ''\r\n            };\r\n            $scope.transaction = pipTransaction('settings.verify_email', $scope);\r\n\r\n            $scope.onAbort = onAbort;\r\n            $scope.onRequestVerificationClick = onRequestVerificationClick;\r\n            $scope.errorsWithHint = pipFormErrors.errorsWithHint;\r\n            $scope.onVerify = onVerify;\r\n            $scope.onCancel = onCancel;\r\n\r\n            return;\r\n            //-----------------------------\r\n\r\n            function onAbort() {\r\n                $scope.transaction.abort();\r\n            };\r\n\r\n            function onCancel() {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            function onRequestVerificationClick() {\r\n                pipUserSettingsPageData.requestEmailVerification($scope.transaction);\r\n            };\r\n\r\n            function onVerify() {\r\n                $scope.form.$setSubmitted();\r\n\r\n                if ($scope.form.$invalid) return;\r\n\r\n                pipUserSettingsPageData.verifyEmail(\r\n                    $scope.transaction,\r\n                    $scope.data,\r\n                    function (verifyData) {\r\n                        $mdDialog.hide(true);\r\n                    },\r\n                    function (error) {\r\n                        //pipFormErrors.resetFormErrors($scope.form, true);\r\n                        pipFormErrors.setFormError(\r\n                            $scope.form, error,\r\n                            {\r\n                                1106: 'email',\r\n                                1103: 'code'\r\n                            }\r\n                        );\r\n\r\n                    }\r\n                )\r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Registration of all guidance components\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipGuidance', [\r\n        'pipTips.Service',\r\n        'pipIntroGuidance.Service',\r\n        'pipGuidance.Dialog',\r\n        'pipReleaseIntroDialog'\r\n    ]);\r\n    \r\n})();","(function(module) {\ntry {\n  module = angular.module('pipGuidance.Templates');\n} catch (e) {\n  module = angular.module('pipGuidance.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('guidance/guidance_dialog.html',\n    '<!--\\n' +\n    '@file Guidance dialog content\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog class=\"pip-dialog pip-guidance-dialog\" layout=\"column\" width=\"768\" md-theme=\"{{theme}}\">\\n' +\n    '    <div class=\"pip-header\" layout=\"row\">\\n' +\n    '        <h3 flex class=\"rm16\">{{title | translate}}</h3>\\n' +\n    '        <md-button class=\"pip-dialog-close\" ng-click=\"onCancel()\" \\n' +\n    '            aria-label=\"{{::\\'CLOSE\\' | translate}}\">\\n' +\n    '            <span class=\"icon-cross\"></span>\\n' +\n    '        </md-button>\\n' +\n    '    </div>\\n' +\n    '    <div class=\"pip-body\">\\n' +\n    '        <div class=\"pip-content\">\\n' +\n    '            <pip-picture pip-src=\"imageUrl\" ng-hide=\"!imageUrl || imageUrl == \\'\\'\" class=\"bm16 center-block\"\\n' +\n    '                ng-style=\"{ width: imageWidth, height: imageHeight, display: \\'block\\' }\">\\n' +\n    '            </pip-picture>\\n' +\n    '\\n' +\n    '            <div class=\"bm16\" pip-translate-html=\"{{::content}}\"></div>\\n' +\n    '\\n' +\n    '            <md-button class=\"md-raised md-accent w-stretch\" ng-click=\"onAction()\"\\n' +\n    '                       ng-hide=\"!action || action==\\'\\'\"\\n' +\n    '                       arial-label=\"{{::action | translate}}\">\\n' +\n    '                {{::action | translate}}\\n' +\n    '            </md-button>\\n' +\n    '\\n' +\n    '            <md-checkbox aria-label=\"{{\\'DO_NOT_SHOW\\' | translate}}\" class=\"w-stretch m0 tm16 regular_14\"\\n' +\n    '                         ng-model=\"hideToggle\" ng-change=\"onHideToggle()\" ng-show=\"showHideToggle\"\\n' +\n    '                         aria-label=\"{{::\\'GUIDANCE_DO_NOT_SHOW\\' | translate}}\">\\n' +\n    '                {{::\\'GUIDANCE_DO_NOT_SHOW\\' | translate}}\\n' +\n    '            </md-checkbox>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipGuidance.Templates');\n} catch (e) {\n  module = angular.module('pipGuidance.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('intro_guidance/intro_guidance_dialog.html',\n    '<md-dialog class=\"pip-dialog pip-guidance-dialog pip-guide-preview \" layout=\"column\" md-theme=\"{{theme}}\">\\n' +\n    '    <div ng-if=\"!$routing\" flex ng-swipe-left=\"onNextPage()\" ng-swipe-right=\"onBackPage()\"\\n' +\n    '         class=\"h-stretch layout layout-column {{\\'bg-\\' + data.pages[number].color}} \">\\n' +\n    '        <div class=\"layout layout-row layout-align-space-between-center layout-align-xs-center-center w-stretch pip-guide-page\">\\n' +\n    '            <md-button ng-click=\"onBackPage()\" class=\" lm16 hide-xs\" aria-label=\"BACK\"\\n' +\n    '                       ng-disabled=\"transaction.busy() || number == 0\">\\n' +\n    '                <md-icon md-svg-icon=\"icons:arrow-left\" class=\"pip-arrow-button\"\\n' +\n    '                         ng-class=\"{\\'opacity-disabled\\' :number == 0}\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '            <div class=\"layout layout-column layout-align-center-center bm16\">\\n' +\n    '                <pip-collage class=\"flex-fixed\" ng-if=\"data.pages[number].pic_id && (!data.pictures || !data.pictures[number])\"\\n' +\n    '                             pip-picture-ids=\"data.pages[number].picId\" pip-unique-code=\"data.id\"\\n' +\n    '                             pip-multiple=\"false\" pip-open=\"false\" pip-rebind=\"true\">\\n' +\n    '                </pip-collage>\\n' +\n    '                <div class=\"pip-pic\" ng-if=\"!data.pages[number].pic_id || data.pictures[number]\"\\n' +\n    '                     style=\"background-image: url({{data.pictures[number]}})\"></div>\\n' +\n    '\\n' +\n    '                <div class=\"layout layout-column layout-align-center-center pip-text\">\\n' +\n    '                    <p class=\"pip-preview-title\" ng-if=\"data.pages[number].title[ln]\">\\n' +\n    '                        {{data.pages[number].title[ln]}}</p>\\n' +\n    '\\n' +\n    '                    <p class=\"pip-preview-content\" ng-if=\"data.pages[number].content[ln]\">\\n' +\n    '                        {{data.pages[number].content[ln]}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '            <md-button ng-click=\"onNextPage()\" class=\"rm16 hide-xs\" aria-label=\"DOWN\"\\n' +\n    '                       ng-disabled=\"transaction.busy() || number == data.pages.length - 1\">\\n' +\n    '                <md-icon md-svg-icon=\"icons:arrow-right\" class=\"pip-arrow-button\"\\n' +\n    '                         ng-class=\"{\\'opacity-disabled\\' : number == data.pages.length - 1}\"></md-icon>\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '        <div class=\" flex-fixed flex w-stretch pip-guide-page-footer\">\\n' +\n    '\\n' +\n    '\\n' +\n    '            <div  layout=\"row\" layout-align=\"center center\" ng-if=\"data.pages.length > 1\">\\n' +\n    '                <md-icon ng-repeat=\"radio in data.pages\" ng-click=\"onChangePage($index)\" class=\"pip-radio-button \"\\n' +\n    '                         md-svg-icon=\"{{radio != data.pages[number] ? \\'icons:radio-off\\' : \\'icons:circle\\'}}\">\\n' +\n    '                </md-icon>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"h64\" layout=\"row\" layout-align-xs=\"space-between center\"\\n' +\n    '                 layout-align=\"center center\">\\n' +\n    '\\n' +\n    '                <md-button ng-click=\"onBackPage()\" class=\"lm16\" ng-if=\"$mdMedia(\\'xs\\')\" aria-label=\"BACK\"\\n' +\n    '                           ng-disabled=\"transaction.busy() || number == 0\">\\n' +\n    '                    <md-icon md-svg-icon=\"icons:arrow-left\" class=\"pip-arrow-button\"\\n' +\n    '                             ng-class=\"{\\'opacity-disabled\\' :number == 0}\"></md-icon>\\n' +\n    '                </md-button>\\n' +\n    '\\n' +\n    '                <md-button ng-click=\"onClose()\"\\n' +\n    '                           class=\"pip-button-got rm8 lm8\\n' +\n    '                                       {{number == data.pages.length - 1  ? \\'fg-\\' + data.pages[number].color : \\'bg-\\' + data.pages[number].color}}\"\\n' +\n    '                           ng-class=\"{\\'md-raised\\':  number == data.pages.length - 1}\"\\n' +\n    '                           aria-label=\"NEXT\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\">\\n' +\n    '                    GOT IT !\\n' +\n    '                </md-button>\\n' +\n    '\\n' +\n    '                <md-button ng-click=\"onNextPage()\" class=\"rm16 \"  ng-if=\"$mdMedia(\\'xs\\')\"  aria-label=\"DOWN\"\\n' +\n    '                           ng-disabled=\"transaction.busy() || number == data.pages.length - 1\">\\n' +\n    '                    <md-icon md-svg-icon=\"icons:arrow-right\" class=\"pip-arrow-button\"\\n' +\n    '                             ng-class=\"{\\'opacity-disabled\\' : number == data.pages.length - 1}\"></md-icon>\\n' +\n    '                </md-button>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '\\n' +\n    '        </div>\\n' +\n    '\\n' +\n    '    </div>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipGuidance.Templates');\n} catch (e) {\n  module = angular.module('pipGuidance.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('tips/tip.template.html',\n    '<div ng-if=\"title\" class=\\'pip-title p24-flex flex-fixed bp16\\'>\\n' +\n    '    {{ title | translate }}\\n' +\n    '</div>\\n' +\n    '\\n' +\n    '<div class=\\'pip-content pip-popover-content lp24-flex rp24-flex text-body1 bm64\\'\\n' +\n    '     ng-class=\"{\\'tm24\\' : !title }\">\\n' +\n    '    <div ng-if=\"image && $mdMedia(\\'gt-xs\\')\" class=\"pip-pic\"></div>\\n' +\n    '    <pip-markdown pip-text=\"content\" pip-rebind=\"true\"></pip-markdown>\\n' +\n    '</div>\\n' +\n    '\\n' +\n    '<div class=\\'pip-footer lm24-flex rm24-flex position-bottom\\'\\n' +\n    '     layout=\"row\" layout-align=\"start center\">\\n' +\n    '    <a ng-if=\"link\" target=\"_blank\" href=\"{{ link }}\" class=\"text-body2\" flex>\\n' +\n    '        {{ \\'MORE_URL\\' | translate }}\\n' +\n    '    </a>\\n' +\n    '    <div  ng-if=\"!link\" flex></div>\\n' +\n    '\\n' +\n    '    <md-button ng-click=\\'onNextClick()\\' class=\"rm0\">\\n' +\n    '        {{ \\'NEXT\\' | translate }}\\n' +\n    '    </md-button>\\n' +\n    '\\n' +\n    '</div>');\n}]);\n})();\n","/**\r\n * @file Guidance dialog\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n \r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipGuidance.Dialog', ['ngMaterial', 'pipTranslate', 'pipGuidance.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function(pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'GUIDANCE_TITLE': 'What should you do here?',\r\n            'GUIDANCE_ACTION': 'Do it now!',\r\n            'GUIDANCE_DO_NOT_SHOW': \"Don't show it again\"\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'GUIDANCE_TITLE': 'Что здесь делать?',\r\n            'GUIDANCE_ACTION': 'Сделать это сейчас!',\r\n            'GUIDANCE_DO_NOT_SHOW': 'Не показывать это снова'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipGuidanceDialog', \r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'guidance/guidance_dialog.html',\r\n                        controller: 'pipGuidanceDialogController',\r\n                        locals: { params: params },\r\n                        clickOutsideToClose: true\r\n                    })\r\n                    .then(function () {\r\n                        if (successCallback) {\r\n                            successCallback();\r\n                        }\r\n                    }, function () {\r\n                        if (cancelCallback) {\r\n                            cancelCallback();\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipGuidanceDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', 'params', function ($scope, $rootScope, $mdDialog, params) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.title = params.title || 'GUIDANCE_TITLE';\r\n\r\n            $scope.imageUrl = params.imageUrl || '';\r\n            $scope.imageWidth = params.imageWidth || '100%';\r\n            $scope.imageHeight = params.imageHeight || '150px';\r\n\r\n            $scope.content = params.content;\r\n            $scope.action = params.action || 'GUIDANCE_ACTION';\r\n            $scope.hideToggle = params.hideToggle;\r\n            $scope.showHideToggle = params.hideToggleCallback != null;\r\n\r\n            $scope.onCancel = function () {\r\n                $mdDialog.cancel();\r\n            };\r\n\r\n            $scope.onAction = function () {\r\n                $mdDialog.hide();\r\n            };\r\n\r\n            $scope.onHideToggle = function(event) {\r\n                if (params.hideToggleCallback) {\r\n                    params.hideToggleCallback($scope.hideToggle);\r\n                } \r\n            };\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Guidance dialog\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipReleaseIntroDialog', ['ngMaterial', 'pipTranslate', 'pipGuidance.Templates']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function (pipTranslateProvider) {\r\n        pipTranslateProvider.translations('en', {\r\n            'GUIDANCE_TITLE': 'What should you do here?',\r\n            'GUIDANCE_ACTION': 'Do it now!',\r\n            'GUIDANCE_DO_NOT_SHOW': \"Don't show it again\"\r\n        });\r\n        pipTranslateProvider.translations('ru', {\r\n            'GUIDANCE_TITLE': 'Что здесь делать?',\r\n            'GUIDANCE_ACTION': 'Сделать это сейчас!',\r\n            'GUIDANCE_DO_NOT_SHOW': 'Не показывать это снова'\r\n        });\r\n    }]);\r\n\r\n    thisModule.factory('pipReleaseIntroDialog',\r\n        ['$mdDialog', function ($mdDialog) {\r\n            return {\r\n                show: function (params, successCallback, cancelCallback) {\r\n                    $mdDialog.show({\r\n                        targetEvent: params.event,\r\n                        templateUrl: 'intro_guidance/intro_guidance_dialog.html',\r\n                        controller: 'pipReleaseIntroDialogController',\r\n                        locals: {params: params},\r\n                        clickOutsideToClose: true\r\n                    })\r\n                        .then(function () {\r\n                            if (successCallback) {\r\n                                successCallback();\r\n                            }\r\n                        }, function () {\r\n                            if (cancelCallback) {\r\n                                cancelCallback();\r\n                            }\r\n                        });\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('pipReleaseIntroDialogController',\r\n        ['$scope', '$rootScope', '$mdDialog', '$mdMedia', 'params', '$state', function ($scope, $rootScope, $mdDialog, $mdMedia, params, $state) {\r\n            $scope.theme = $rootScope.$theme;\r\n            $scope.settings = params.settings;\r\n            $scope.admin = params.admin;\r\n            $scope.$mdMedia = $mdMedia;\r\n\r\n            var guide = params.guide;\r\n\r\n            if (!$scope.admin)\r\n                if ($scope.settings[params.settingsName] && $scope.settings[params.settingsName].lastId) {\r\n                    params.settingsName = 'release';\r\n                }\r\n\r\n            $scope.number = 0;\r\n            $scope.ln = params.ln || $rootScope.$language || 'en';\r\n            $scope.data = guide;\r\n\r\n            _.each($scope.data.pages, function (page) {\r\n                if (page.pic_id) {\r\n                    var picId = page.pic_id;\r\n                    page.picId = [];\r\n                    page.picId.push(picId);\r\n                }\r\n            });\r\n\r\n            // Process user actions\r\n            // --------------------\r\n\r\n            $scope.onChangePage = function (newNumber) {\r\n                $scope.number = newNumber;\r\n            };\r\n\r\n            $scope.onBackPage = function () {\r\n                if ($scope.number != 0)\r\n                    $scope.number -= 1;\r\n            };\r\n\r\n            $scope.onNextPage = function () {\r\n                if ($scope.number != $scope.data.pages.length - 1)\r\n                    $scope.number += 1;\r\n            };\r\n\r\n            $scope.onClose = function () {\r\n                if (!$scope.admin) {\r\n                    $scope.settings[params.settingsName].lastId = $scope.data.id;\r\n                    $scope.settings[params.settingsName].date = new Date();\r\n\r\n                    params.pipSettingsData.saveSettings($scope.settings, params.settingsName);\r\n                }\r\n\r\n\r\n                $mdDialog.cancel();\r\n            }\r\n        }]\r\n    );\r\n\r\n})();\r\n","/**\r\n * @file Guidance service\r\n * @copyright Digital Living Software Corp. 2014-2015\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipIntroGuidance.Service', ['pipReleaseIntroDialog']);\r\n\r\n    thisModule.factory('pipGuidance', ['pipReleaseIntroDialog', 'pipSettingsData', '$rootScope', function ( pipReleaseIntroDialog, pipSettingsData, $rootScope) {\r\n\r\n            return {\r\n                showIntroReleaseGuide: showIntroReleaseGuide,\r\n                findIntroReleaseGuide: findIntroReleaseGuide\r\n            }\r\n\r\n            function showIntroReleaseGuide(guide, settings, admin, ln, party, user) {\r\n                if (guide && party.id == user.id)\r\n                    pipReleaseIntroDialog.show(\r\n                        {\r\n                            guide: guide,\r\n                            settings: settings,\r\n                            settingsName: guide.type == 'intro' ? 'intro': 'release',\r\n                            pipSettingsData: pipSettingsData,\r\n                            admin: admin,\r\n                            ln: ln\r\n\r\n                        }\r\n                    );\r\n\r\n            };\r\n\r\n            function findIntroReleaseGuide(guides, settings) {\r\n                var guidesSort;\r\n\r\n                if (!settings.intro || !settings.intro.lastId) {\r\n                    guidesSort = _.filter(guides, function (guide) {\r\n                        return guide.type == 'intro' && guide.status == 'completed';\r\n                    });\r\n                    guidesSort = _.sortBy(guidesSort, function (guide) {\r\n                        return -new Date(guide.created).getTime();\r\n                    });\r\n                    return guidesSort[0];\r\n                }\r\n                else {\r\n                    guidesSort = _.filter(guides, function (guide) {\r\n                        return guide.type == 'new release' && guide.status == 'completed';\r\n                    });\r\n\r\n                    guidesSort = _.sortBy(guidesSort, function (guide) {\r\n                        return -new Date(guide.created).getTime();\r\n                    });\r\n\r\n                    if (!settings.intro.date || (guidesSort.length > 0 && new Date(settings.intro.date) < new Date(guidesSort[0].created)\r\n                        && guidesSort[0].id != settings.release.lastId)) {\r\n                        return guidesSort[0];\r\n                    } else {\r\n                        return null;\r\n                    }\r\n                }\r\n            };\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Tips service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipTips.Service', ['pipGuidance.Templates']);\r\n\r\n    thisModule.factory('pipTips', ['$pipPopover', 'pipTipsData', 'pipRest', '$timeout', '$rootScope', 'pipSettingsData', function ($pipPopover, pipTipsData, pipRest, $timeout, $rootScope, pipSettingsData) {\r\n            var tips;\r\n            \r\n            return {\r\n                getTips: getTips,\r\n                filterTips: filterTips,\r\n                showTips: showTips,\r\n                firstShowTips: firstShowTips,\r\n            }\r\n\r\n            function checkStatus(item) {\r\n                return item.status == 'completed' ? true : false;\r\n            }\r\n\r\n            function compareRandom(a, b) {\r\n                return Math.random() - 0.5;\r\n            }\r\n\r\n            function filterTips(data, topic) {\r\n                tips = [];\r\n                var tipsCollection = _.filter(data, checkStatus);\r\n                for (var index = 0; index < tipsCollection.length; index++) {\r\n                    var topic = _.find(tipsCollection[index].topics, function (t) { return t == topic; });                    \r\n                    if (topic) {\r\n                        tips.push(tipsCollection[index]);\r\n                    }\r\n                }\r\n                tips.sort(compareRandom);\r\n                return tips;\r\n\r\n            }\r\n            \r\n            function tipController($scope, $timeout, $mdMedia) {\r\n\r\n                $scope.index = 0;\r\n\r\n                $scope.$mdMedia = $mdMedia;\r\n\r\n                init();\r\n\r\n                $scope.onNextClick = function () {\r\n                    $scope.index++;\r\n                    if ($scope.index == $scope.locals.tips.length)\r\n                        $pipPopover.hide();\r\n                    else {\r\n                        init();\r\n                        $pipPopover.resize();\r\n                        //$rootScope.$broadcast('pipWindowResized');\r\n                    }\r\n\r\n                };\r\n\r\n                $scope.$on('pipWindowResized', init);\r\n\r\n                function init() {\r\n\r\n                    $scope.title = $scope.locals.tips[$scope.index].title[$scope.locals.ln];\r\n                    $scope.content = $scope.locals.tips[$scope.index].content[$scope.locals.ln];\r\n                    if ($scope.locals.tips[$scope.index].pic_id) {\r\n                        $scope.image = pipRest.serverUrl() + '/api/parties/' + $scope.locals.tips[$scope.index].creator_id \r\n                            + '/files/' + $scope.locals.tips[$scope.index].pic_id + '/content';\r\n                    }\r\n\r\n                    $scope.link = $scope.locals.tips[$scope.index].more_url;\r\n\r\n\r\n                    if ($scope.image)\r\n                        $timeout(function () {\r\n                            var backdropElement = $('.pip-popover-backdrop'),\r\n                                popover = backdropElement.find('.pip-popover');\r\n                            popover.find('.pip-pic').css('background-image', 'url(' + $scope.image + ')');\r\n\r\n                        }, 100);\r\n\r\n                }\r\n            }\r\n\r\n            function showTips(tips, ln, $event) {\r\n\r\n                if (tips && tips.length > 0) {\r\n                    $pipPopover.hide();\r\n                    $pipPopover.show({\r\n                        element: $event ? $event.currentTarget : null,\r\n                        class: 'pip-tip',\r\n                        cancelCallback: function () {\r\n                            console.log('backdrop clicked');\r\n                        },\r\n                        locals: {\r\n                            tips: tips,\r\n                            ln: ln || 'en'\r\n                        },\r\n                        controller: ['$scope', '$timeout', '$mdMedia', tipController],\r\n                        templateUrl: 'tips/tip.template.html'\r\n                    });\r\n                }\r\n\r\n\r\n            }\r\n          \r\n            function firstShowTips(tips, ln, topic, settings, kolDay) {\r\n                var ln = ln || 'en';\r\n                var kolDay = kolDay || 2;\r\n                var now = new Date();\r\n                var show;\r\n                if (settings && settings[topic].tips) {\r\n                    show = (now.getTime() - new Date(settings[topic].tips).getTime()) / (1000 * 60 * 60 * 24);\r\n                    if (show > kolDay) {\r\n                        $pipPopover.hide();\r\n                        showTips(tips, ln);\r\n                        settings[topic].tips = new Date();\r\n                        pipSettingsData.saveSettings(settings, topic);\r\n                    }\r\n                } else {\r\n                    if (settings[topic]) {\r\n                        $pipPopover.hide();\r\n                        showTips(tips, ln);\r\n                        settings[topic].tips = new Date();\r\n                        pipSettingsData.saveSettings(settings, topic);\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            function getTips(party, ln, topic, callBack) {\r\n\r\n                pipTipsData.readTips(\r\n                    {item: {}},\r\n                    null,\r\n                    function (result) {\r\n\r\n                        filterTips(result.data, topic);\r\n\r\n                        if (callBack) callBack(tips);\r\n\r\n                        return tips;\r\n                    },\r\n                    function (error) {\r\n                        console.log('cc', error);\r\n                        return null;\r\n                    }\r\n                );\r\n            }\r\n\r\n\r\n        }]\r\n    );\r\n\r\n})();","/**\r\n * @file Registration of all help components\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipHelp', [\r\n        'pipHelp.Service',\r\n        'pipHelp.Page'\r\n    ]);\r\n    \r\n})();","(function(module) {\ntry {\n  module = angular.module('pipHelp.Templates');\n} catch (e) {\n  module = angular.module('pipHelp.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('help_page/help_page.html',\n    '<md-toolbar class=\"pip-appbar-ext\"></md-toolbar>\\n' +\n    '\\n' +\n    '<pip-document width=\"800\" min-height=\"400\">\\n' +\n    '    <div class=\"pip-menu-container pip-help\" ng-hide=\"manager === false\">\\n' +\n    '        <md-list class=\"pip-menu pip-simple-list hide-xs\" pip-selected=\"selected.pageIndex\"\\n' +\n    '                 pip-selected-watch=\"selected.navId\" pip-select=\"onNavigationSelect($event.id)\">\\n' +\n    '            <md-list-item class=\"pip-simple-list-item pip-selectable\" md-ink-ripple pip-id=\"{{ page.state }}\"\\n' +\n    '                          ng-repeat=\"page in pages track by page.state\">\\n' +\n    '                <p> {{page.title | translate}} </p>\\n' +\n    '            </md-list-item>\\n' +\n    '        </md-list>\\n' +\n    '\\n' +\n    '        <div class=\"pip-content-container\">\\n' +\n    '            <pip-dropdown pip-actions=\"pages\" class=\"hide-gt-xs\" pip-dropdown-select=\"onDropdownSelect\"\\n' +\n    '                          pip-active-index=\"selected.pageIndex\"></pip-dropdown>\\n' +\n    '            <div class=\"pip-body p24-flex\" ui-view layout=\"column\" flex style=\"max-width: none !important\"></div>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '    <div ng-show=\"manager === false\" layout=\"column\" layout-align=\"center center\" flex>\\n' +\n    '        {{::\\'ERROR_400\\' | translate}}\\n' +\n    '    </div>\\n' +\n    '</pip-document>');\n}]);\n})();\n","// ==========================================================\r\n//  Title: help_page.js\r\n//  Description: Application help page module\r\n//  Copyright (c) 2004-2015 Modular Mining Systems, Inc.\r\n//  All Rights Reserved\r\n// ==========================================================\r\n//  The information described in this document is furnished as proprietary\r\n//  information and may not be copied or sold without the written permission\r\n//  of Modular Mining Systems, Inc.\r\n// ==========================================================\r\n\r\n(function (angular, _) {\r\n    'use strict';\r\n\r\n    config.$inject = ['pipStateProvider'];\r\n    HelpPageController.$inject = ['$scope', '$rootScope', '$state', '$mdMedia', 'pipAppBar', 'pipHelp'];\r\n    angular.module('pipHelp.Page', ['pipState', 'pipHelp.Service',  'pipAppBar', 'pipSelected', 'pipTranslate', 'pipHelp.Templates'])\r\n        .config(config)\r\n        .controller('pipHelpPageController', HelpPageController);\r\n\r\n    function config(pipStateProvider) {\r\n        pipStateProvider.state('help', {\r\n            url: '/help',\r\n            auth: true,\r\n            controller: 'pipHelpPageController',\r\n            templateUrl: 'help_page/help_page.html'\r\n        });\r\n    }\r\n\r\n    function HelpPageController($scope, $rootScope, $state, $mdMedia, pipAppBar, pipHelp) {\r\n        $scope.$mdMedia = $mdMedia;\r\n\r\n        $scope.pages = _.filter(pipHelp.getPages(), function (page) {\r\n            if (page.visible === true && (page.access ? page.access($rootScope.$user, page) : true)) {\r\n                return page;\r\n            }\r\n        });\r\n\r\n        $scope.selected = {};\r\n\r\n        if ($state.current.name != 'help')\r\n            initSelect($state.current.name);\r\n        else\r\n            initSelect(pipHelp.getDefaultPage().state);\r\n        appHeader();\r\n\r\n        $scope.onNavigationSelect = onNavigationSelect;\r\n\r\n        return;\r\n\r\n        function appHeader () {\r\n            pipAppBar.showMenuNavIcon();\r\n            pipAppBar.showTitleText('Help');\r\n            pipAppBar.hideShadow();\r\n            pipAppBar.showLocalActions(null,[]);\r\n        };\r\n\r\n        function onNavigationSelect  (state) {\r\n            initSelect(state);\r\n\r\n            if ($scope.selected.page) {\r\n                $state.go(state);\r\n            }\r\n        };\r\n\r\n        function initSelect(state) {\r\n            $scope.selected.page = _.find($scope.pages, function(page) { return page.state == state; });\r\n            $scope.selected.pageIndex = _.indexOf($scope.pages, $scope.selected.page);\r\n            $scope.selected.pageId = state;\r\n        }\r\n    }\r\n})(window.angular, window._);","(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipHelp.Service', ['pipState'])\r\n        .provider('pipHelp',\r\n        ['pipAuthStateProvider', function(pipAuthStateProvider) {\r\n            var defaultPage,\r\n                pages = [];\r\n\r\n            /** @see addPage */\r\n            this.addPage = addPage;\r\n\r\n            /** @see setDefaultPage */\r\n            this.setDefaultPage = setDefaultPage;\r\n\r\n            /** @see getPages */\r\n            this.getPages = getPages;\r\n\r\n            /** @see getDefaultPage */\r\n            this.getDefaultPage = getDefaultPage;\r\n\r\n            this.$get = function () {\r\n                return {\r\n                    /** @see getPages */\r\n                    getPages: getPages,\r\n\r\n                    /** @see getDefaultPage */\r\n                    getDefaultPage: getDefaultPage,\r\n\r\n                    /** @see addPage */\r\n                    addPage: addPage,\r\n\r\n                    /** @see setDefaultPage */\r\n                    setDefaultPage: setDefaultPage\r\n                }\r\n            }\r\n\r\n            function getFullStateName(state) {\r\n                return 'help.' + state;\r\n            }\r\n\r\n            function getPages () {\r\n                return _.clone(pages, true);\r\n            }\r\n\r\n            function getDefaultPage() {\r\n                return _.clone(_.find(pages, function(page) { return page.state == defaultPage; }), true);\r\n            }\r\n\r\n\r\n            function addPage(pageObj) {\r\n                validatePage(pageObj);\r\n\r\n                if (_.find(pages, function(page) { return page.state == getFullStateName(pageObj.state); })) {\r\n                    throw new Error('Page with state name \"' + pageObj.state + '\" is already registered');\r\n                }\r\n\r\n                pages.push({\r\n                    state: getFullStateName(pageObj.state),\r\n                    title: pageObj.title,\r\n                    access: pageObj.access,\r\n                    visible: pageObj.visible !== false,\r\n                    stateConfig: _.clone(pageObj.stateConfig, true)\r\n                });\r\n\r\n                pipAuthStateProvider.state(getFullStateName(pageObj.state), pageObj.stateConfig);\r\n\r\n                // if we just added first state and no default state is specified\r\n                if (typeof defaultPage === 'undefined' && pages.length === 1) {\r\n                    setDefaultPage(pageObj.state);\r\n                }\r\n            }\r\n\r\n            function setDefaultPage(name) {\r\n                if (!_.find(pages, function(page) { return page.state == getFullStateName(name); })) {\r\n                    throw new Error('Page with state name \"' + name + '\" is not registered');\r\n                }\r\n\r\n                defaultPage = getFullStateName(name);\r\n\r\n                pipAuthStateProvider.redirect('help', getFullStateName(name));\r\n            }\r\n\r\n            function validatePage(pageObj) {\r\n                if (!pageObj || !_.isObject(pageObj)) {\r\n                    throw new Error('Invalid object');\r\n                }\r\n\r\n                if (pageObj.state == null || pageObj.state == '') {\r\n                    throw new Error('Page should have valid Angular UI router state name');\r\n                }\r\n\r\n                if (pageObj.access && !_.isFunction(pageObj.access)) {\r\n                    throw new Error('\"access\" should be a function');\r\n                }\r\n\r\n                if (!pageObj.stateConfig || !_.isObject(pageObj.stateConfig )) {\r\n                    throw new Error('Invalid state configuration object');\r\n                }\r\n            }\r\n        }]);\r\n\r\n\r\n})();","/**\r\n * @file Registration of support all pages\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    angular.module('pipSupport', [\r\n        'pipFeedback',\r\n        'pipAnalytics'\r\n    ]);\r\n})();","(function(module) {\ntry {\n  module = angular.module('pipSupport.Templates');\n} catch (e) {\n  module = angular.module('pipSupport.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('feedback/feedback.html',\n    '<!--\\n' +\n    '@file Feedback page\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-toolbar class=\"pip-appbar-ext\"></md-toolbar>\\n' +\n    '<pip-document width=\"800\">\\n' +\n    '\\n' +\n    '    <pip-feedback-panel data=\"data\" pip-created=\"$panel = $control\"\\n' +\n    '                        show-pictures=\"showPictures\"\\n' +\n    '                        show-documents=\"showDocuments\"\\n' +\n    '                        save-callback=\"saveCallback\"\\n' +\n    '                        type-collection=\"typeCollection\"></pip-feedback-panel>\\n' +\n    '\\n' +\n    '    <div class=\"pip-footer\">\\n' +\n    '        <pip-content-switch class=\"hide-xs\"></pip-content-switch>\\n' +\n    '\\n' +\n    '        <div flex></div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" class=\"flex-fixed\">\\n' +\n    '            <md-button ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" class=\"md-raised md-warn\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-hide=\"transaction.busy()\" ng-click=\"onSave()\"\\n' +\n    '                       ng-disabled=\"data.content == \\'\\' && data.title == \\'\\'\">\\n' +\n    '                {{::\\'SEND\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </div>\\n' +\n    '</pip-document>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSupport.Templates');\n} catch (e) {\n  module = angular.module('pipSupport.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('feedback/feedback_dialog.html',\n    '<!--\\n' +\n    '@file Feedback dialog\\n' +\n    '@copyright Digital Living Software Corp. 2014-2016\\n' +\n    '-->\\n' +\n    '\\n' +\n    '<md-dialog width=\"800\" class=\"pip-feedback-dialog\">\\n' +\n    '    <md-dialog-content class=\"lp24-flex rp24-flex\">\\n' +\n    '        <pip-feedback-panel data=\"data\" pip-created=\"$panel = $control\"\\n' +\n    '                            show-pictures=\"showPictures\"\\n' +\n    '                            show-documents=\"showDocuments\"\\n' +\n    '                            save-callback=\"saveCallback\"\\n' +\n    '                            type-collection=\"typeCollection\"></pip-feedback-panel>\\n' +\n    '    </md-dialog-content>\\n' +\n    '    <md-dialog-actions layout=\"row\">\\n' +\n    '        <pip-content-switch class=\"show-gt-sm\"></pip-content-switch>\\n' +\n    '\\n' +\n    '        <div flex></div>\\n' +\n    '\\n' +\n    '        <div layout=\"row\" class=\"flex-fixed\">\\n' +\n    '            <md-button ng-show=\"transaction.busy()\" ng-click=\"transaction.abort()\" class=\"md-raised md-warn\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button ng-hide=\"transaction.busy()\" ng-click=\"goBack()\">\\n' +\n    '                {{::\\'CANCEL\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '            <md-button class=\"md-accent\" ng-hide=\"transaction.busy()\" ng-click=\"onSave()\"\\n' +\n    '                       ng-disabled=\"data.content == \\'\\' && data.title == \\'\\'\">\\n' +\n    '                {{::\\'SEND\\' | translate}}\\n' +\n    '            </md-button>\\n' +\n    '        </div>\\n' +\n    '    </md-dialog-actions>\\n' +\n    '</md-dialog>\\n' +\n    '');\n}]);\n})();\n\n(function(module) {\ntry {\n  module = angular.module('pipSupport.Templates');\n} catch (e) {\n  module = angular.module('pipSupport.Templates', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('feedback/feedback_panel.html',\n    '<div class=\"pip-body tp24-flex\">\\n' +\n    '    <div class=\"pip-content\" layout=\"column\">\\n' +\n    '        <md-progress-linear ng-show=\"transaction.busy()\" md-mode=\"indeterminate\"\\n' +\n    '                            class=\"pip-progress-ontop\"></md-progress-linear>\\n' +\n    '\\n' +\n    '        <form name=\"form\" novalidate>\\n' +\n    '            <md-input-container class=\"md-block hide-gt-xs\">\\n' +\n    '                <md-select ng-model=\"typeIndex\" ng-disabled=\"transaction.busy()\" aria-label=\"DROPDOWN\">\\n' +\n    '\\n' +\n    '                    <md-option ng-repeat=\"action in typeCollection\" value=\"{{ ::$index }}\">\\n' +\n    '                        {{ (action.title || action.name) | translate }}\\n' +\n    '                    </md-option>\\n' +\n    '                </md-select>\\n' +\n    '            </md-input-container>\\n' +\n    '\\n' +\n    '            <pip-toggle-buttons ng-model=\"data.type\"\\n' +\n    '                                pip-buttons=\"typeCollection\"\\n' +\n    '                                class=\"bm16 hide-xs\">\\n' +\n    '            </pip-toggle-buttons>\\n' +\n    '            <p class=\"tm0 bm16 text-small text-grey line-height-string\"\\n' +\n    '               ng-if=\"data.type==\\'feedback\\' || data.type==\\'support\\'\">\\n' +\n    '                {{::\\'FEEDBACK_HINT_FEEDBACK\\' | translate}}\\n' +\n    '            </p>\\n' +\n    '\\n' +\n    '            <div ng-if=\"data.type==\\'copyright\\'\">\\n' +\n    '                <p class=\"tm0 bm16 text-small text-grey line-height-string\">\\n' +\n    '                    {{::\\'FEEDBACK_HINT_COPYRIGHT\\' | translate}}\\n' +\n    '                </p>\\n' +\n    '\\n' +\n    '                <p class=\"tm0 bm16 text-small text-grey line-height-string\">\\n' +\n    '                    {{::\\'FEEDBACK_HINT_COPYRIGHT2\\' | translate }}\\n' +\n    '                </p>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div class=\"pip-ref-item\">\\n' +\n    '                <pip-avatar pip-party-id=\"$party.id\"\\n' +\n    '                            pip-party-name=\"$party.name\"\\n' +\n    '                            class=\"pip-pic pip-face\"></pip-avatar>\\n' +\n    '                <div class=\"pip-content\">\\n' +\n    '                    <p class=\"pip-title\">{{$party.name}} </p>\\n' +\n    '\\n' +\n    '                    <p class=\"pip-subtitle\">{{$party.email}}</p>\\n' +\n    '                </div>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div ng-if=\"data.type!=\\'copyright\\'\">\\n' +\n    '                <md-input-container class=\"md-block\" md-no-float>\\n' +\n    '                    <input type=\"text\" ng-model=\"data.title\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\"\\n' +\n    '                           placeholder=\"{{:: \\'SUBJECT\\' | translate}}\"/>\\n' +\n    '                </md-input-container>\\n' +\n    '                <md-input-container class=\"md-block\" md-no-float>\\n' +\n    '                        <textarea ng-model=\"data.content\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                                  placeholder=\"{{::\\'FEEDBACK_MESSAGE\\'|translate}}\">\\n' +\n    '                        </textarea>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <div ng-if=\"data.type==\\'copyright\\'\">\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_COMPANY\\'|translate}}</label>\\n' +\n    '                    <input type=\"text\" ng-model=\"data.company_name\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\" placeholder=\"Company Name\"/>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_ADDRESS\\'|translate}}</label>\\n' +\n    '                    <input type=\"text\" ng-model=\"data.company_addr\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\"/>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_COPYRIGHT_HOLDER\\' | translate}}</label>\\n' +\n    '                    <input name=\"data.copyright_holder\" ng-model=\"data.copyright_holder\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\"\\n' +\n    '                           step=\"any\" type=\"text\" tabindex=\"0\"\\n' +\n    '                           required/>\\n' +\n    '\\n' +\n    '                    <div ng-messages=\"errorsWithHint(form.data.copyright_holder)\">\\n' +\n    '                        <div ng-message=\"hint\">\\n' +\n    '                            {{::\\'FEEDBACK_COPYRIGHT_HOLDER_HINT\\' | translate}}\\n' +\n    '                        </div>\\n' +\n    '                    </div>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\" flex>\\n' +\n    '                    <label>{{::\\'FEEDBACK_ORIGINAL_LOCATION\\'|translate}}</label>\\n' +\n    '                    <input type=\"text\" ng-model=\"data.original_loc\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\"/>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_DESCRIBE_COPYRIGHTED\\' | translate}}</label>\\n' +\n    '                    <input name=\"data.copyrighted_work\" ng-model=\"data.copyrighted_work\"\\n' +\n    '                           ng-disabled=\"transaction.busy()\"\\n' +\n    '                           step=\"any\" type=\"text\" tabindex=\"0\"\\n' +\n    '                           required/>\\n' +\n    '\\n' +\n    '                    <div ng-messages=\"errorsWithHint(form.data.copyrighted_work)\">\\n' +\n    '                        <div ng-message=\"hint\">\\n' +\n    '                            {{::\\'FEEDBACK_DESCRIBE_COPYRIGHTED_HINT\\'| translate}}\\n' +\n    '                        </div>\\n' +\n    '                    </div>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_UNAUTHORIZE_LOCATION\\' | translate}}</label>\\n' +\n    '                        <textarea name=\"data.unauth_loc\" ng-model=\"data.unauth_loc\"\\n' +\n    '                                  ng-disabled=\"transaction.busy()\"\\n' +\n    '                                  step=\"any\" type=\"text\" tabindex=\"0\"\\n' +\n    '                                  required></textarea>\\n' +\n    '\\n' +\n    '                    <div ng-messages=\"errorsWithHint(form.data.unauth_loc)\">\\n' +\n    '                        <div ng-message=\"hint\">\\n' +\n    '                            {{::\\'FEEDBACK_UNAUTHORIZE_LOCATION_HINT\\' | translate}}\\n' +\n    '                        </div>\\n' +\n    '                    </div>\\n' +\n    '                </md-input-container>\\n' +\n    '\\n' +\n    '                <div layout=\"row\" class=\"bm16\">\\n' +\n    '                    <md-checkbox ng-model=\"data.copyright_conc\" class=\"lm0 bm0 flex-fixed\"\\n' +\n    '                                 aria-label=\\'FEEDBACK_COPYRIGHT_CONC\\' style=\"min-width: 24px; margin-top: -2px\">\\n' +\n    '                    </md-checkbox>\\n' +\n    '                    <p class=\"m0 text-small text-grey line-height-string\">\\n' +\n    '                        {{::\\'FEEDBACK_COPYRIGHT_CONC\\'|translate}}\\n' +\n    '                    </p>\\n' +\n    '                </div>\\n' +\n    '\\n' +\n    '                <div layout=\"row\" class=\"bm16\">\\n' +\n    '                    <md-checkbox ng-model=\"data.request_conc\" class=\"lm0 bm0 flex-fixed\"\\n' +\n    '                                 aria-label=\"FEEDBACK_REGUEST_CONC\" style=\"min-width: 24px; margin-top: -2px\">\\n' +\n    '                    </md-checkbox>\\n' +\n    '                    <p class=\"m0 text-small text-grey line-height-string\">\\n' +\n    '                        {{::\\'FEEDBACK_REGUEST_CONC\\'|translate}}\\n' +\n    '                    </p>\\n' +\n    '                </div>\\n' +\n    '\\n' +\n    '                <md-input-container class=\"md-block\">\\n' +\n    '                    <label>{{::\\'FEEDBACK_SIGNATURE\\' | translate}}</label>\\n' +\n    '                    <input name=\"data.signature\" ng-model=\"data.signature\" ng-disabled=\"transaction.busy()\"\\n' +\n    '                           step=\"any\" type=\"text\" tabindex=\"0\"\\n' +\n    '                           required/>\\n' +\n    '\\n' +\n    '                    <div ng-messages=\"errorsWithHint(form.data.signature)\">\\n' +\n    '                        <div ng-message=\"hint\">{{::\\'FEEDBACK_SIGNATURE_HINT\\' | translate}}</div>\\n' +\n    '                    </div>\\n' +\n    '                </md-input-container>\\n' +\n    '            </div>\\n' +\n    '\\n' +\n    '            <pip-picture-list-edit class=\"bm8\" ng-show=\"showPictures\"\\n' +\n    '                                   pip-picture-ids=\"data.pic_ids\" pip-created=\"pictures = $event.sender\"\\n' +\n    '                                   ng-disabled=\"transaction.busy()\">\\n' +\n    '            </pip-picture-list-edit>\\n' +\n    '\\n' +\n    '            <pip-document-list-edit ng-show=\"showDocuments\"\\n' +\n    '                                    pip-documents=\"data.docs\" pip-created=\"docs = $event.sender\"\\n' +\n    '                                    ng-disabled=\"transaction.busy()\">\\n' +\n    '            </pip-document-list-edit>\\n' +\n    '        </form>\\n' +\n    '    </div>\\n' +\n    '</div>\\n' +\n    '');\n}]);\n})();\n","/**\r\n * @file Web analytics service\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipAnalytics', []);\r\n\r\n    thisModule.run(['$rootScope', '$location', 'pipAnalytics', function ($rootScope, $location, pipAnalytics) {\r\n        $rootScope.$on('$stateChangeSuccess',\r\n            function (event, toState, toParams, fromState, fromParams) {\r\n                var\r\n                    url = $location.url(),\r\n                    user = ($rootScope.$user || {}).id,\r\n                    language = ($rootScope.$language || 'en');\r\n\r\n                // Remove query parameters from URL\r\n                var pos = url.indexOf('?');\r\n                if (pos > 0) url = url.substring(0, pos);\r\n\r\n                // Record web analytics (if enabled)\r\n                pipAnalytics.pageView(url, user, language);\r\n            }\r\n        );\r\n    }]);\r\n\r\n    thisModule.provider('pipAnalytics', function () {\r\n        var\r\n            enabled = false,\r\n            trackingId = null;\r\n\r\n        this.enable = enable;\r\n\r\n        this.$get = function () {\r\n            return {\r\n                enabled: enabled,\r\n                trackingId: trackingId,\r\n                pageView: pageView,\r\n                event: event\r\n            };\r\n        };\r\n\r\n        return;\r\n\r\n        //--------------------------------\r\n\r\n        function enable(newTrackingId) {\r\n            if (newTrackingId) {\r\n                trackingId = newTrackingId;\r\n                enabled = true;\r\n\r\n                window['GoogleAnalyticsObject'] = 'ga';\r\n                window.ga = window.ga || function () {\r\n                        (window.ga.q = window.ga.q || []).push(arguments)\r\n                    };\r\n                window.ga.l = 1 * new Date();\r\n\r\n                window.ga('create', newTrackingId);\r\n                //window.ga('send', 'pageview');\r\n            }\r\n            return enabled;\r\n        };\r\n\r\n        function pageView(url, user, language) {\r\n            if (enabled && window.ga) {\r\n                //window.ga('set', 'page', url);\r\n\r\n                window.ga('send', 'pageview', {\r\n                    page: url,\r\n                    userId: user,\r\n                    language: language\r\n                });\r\n            }\r\n        };\r\n\r\n        function event(category, action, value, user, language) {\r\n            if (enabled && window.ga) {\r\n                window.ga('send', 'event', {\r\n                    eventCategory: category,\r\n                    eventAction: action,\r\n                    eventValue: value,\r\n                    userId: user,\r\n                    language: language\r\n                });\r\n            }\r\n        };\r\n    });\r\n})();","/**\r\n * @file Feedback controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipFeedback', [\r\n        'pipAppBar', 'pipRest.State', 'pipTransactions', 'pipRest', 'pipDropdown',\r\n        'ngMaterial', 'pipTranslate', 'pipFeedbacksData', 'pipToasts', \r\n        'pipFeedback.Strings', \"pipFeedbackPanel\", 'pipSupport.Templates'\r\n    ]);\r\n\r\n    thisModule.config(\r\n        ['pipAuthStateProvider', function (pipAuthStateProvider) {\r\n            // Configure module routes\r\n            pipAuthStateProvider\r\n                .state('feedback', {\r\n                    url: '/feedback',\r\n                    controller: 'FeedbackController',\r\n                    templateUrl: 'feedback/feedback.html',\r\n                    auth: true\r\n                });\r\n        }]\r\n    );\r\n\r\n    thisModule.controller('FeedbackController',\r\n        ['$scope', '$rootScope', '$state', 'pipUtils', 'pipAppBar', 'pipToasts', 'pipTranslate', function ($scope, $rootScope, $state, pipUtils, pipAppBar, pipToasts, pipTranslate) {\r\n\r\n            showAppBar();\r\n            $scope.data = {};\r\n            $scope.contentSwitchOption = {\r\n                picture: true,\r\n                document: true,\r\n                location: false,\r\n                event: false\r\n            };\r\n\r\n            $scope.goBack = pipUtils.goBack;\r\n            $scope.onSave = onSave;\r\n            $scope.onTypeChange = onTypeChange;\r\n            $scope.saveCallback = saveCallback;\r\n\r\n            return;\r\n\r\n            function showAppBar() {\r\n\r\n                pipAppBar.showBackNavIcon();\r\n                pipAppBar.showTitleText(\"FEEDBACK_TITLE\");\r\n                pipAppBar.showLocalActions([\r\n                    {\r\n                        class: 'icon-send', hideSmall: true,\r\n                        callback: onSave\r\n                    }\r\n                ], []);\r\n\r\n                pipAppBar.showShadowSm();\r\n            }\r\n\r\n            function onSave() {\r\n                if ($scope.$panel) $scope.$panel.onSave();\r\n            }\r\n            function onTypeChange() {\r\n                if ($scope.$panel) $scope.$panel.onTypeChange($scope.item);\r\n            }\r\n\r\n            function saveCallback () {\r\n                pipUtils.goBack();\r\n                //$mdDialog.close();\r\n                pipToasts.showNotification(pipTranslate.translate('FEEDBACK_SUCCESS'), null, null, null);\r\n            }\r\n\r\n        }]\r\n    );\r\n    \r\n})();","/**\r\n * @file Feedback dialog controller\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipFeedbackDialog', [\r\n        'pipAppBar', 'pipRest.State', 'pipTransactions', 'pipRest', 'pipDropdown',\r\n        'ngMaterial', 'pipTranslate', 'pipFeedbacksData', 'pipToasts', \r\n        'pipFeedback.Strings', \"pipFeedbackPanel\", 'pipSupport.Templates'\r\n    ]);\r\n\r\n    thisModule.controller('FeedbackDialogController',\r\n        ['$scope', '$rootScope', '$state', 'pipUtils', 'party', '$mdDialog', 'pipToasts', 'pipTranslate', function ($scope, $rootScope, $state, pipUtils, party, $mdDialog, pipToasts, pipTranslate) {\r\n\r\n            $rootScope.$party = party;\r\n\r\n            $scope.data = {};\r\n            $scope.contentSwitchOption = {\r\n                picture: true,\r\n                document: true,\r\n                location: false,\r\n                event: false\r\n            };\r\n\r\n            $scope.goBack = $mdDialog.cancel;\r\n            $scope.onSave = onSave;\r\n            $scope.onTypeChange = onTypeChange;\r\n            $scope.saveCallback = saveCallback;\r\n\r\n            return;\r\n\r\n            function onSave() {\r\n                if ($scope.$panel) $scope.$panel.onSave();\r\n            }\r\n            function onTypeChange() {\r\n                if ($scope.$panel) $scope.$panel.onTypeChange($scope.item);\r\n            }\r\n\r\n            function saveCallback () {\r\n                $mdDialog.cancel();\r\n                pipToasts.showNotification(pipTranslate.translate('FEEDBACK_SUCCESS'), null, null, null);\r\n            }\r\n\r\n\r\n        }]\r\n    );\r\n    \r\n})();","/**\r\n * @file Announcement details module\r\n * @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module(\"pipFeedbackPanel\", ['pipUtils', 'pipFocused', 'pipSupport.Templates']);\r\n\r\n    thisModule.directive('pipFeedbackPanel',\r\n        function () {\r\n            return {\r\n                restrict: 'EA',\r\n                replace: true,\r\n                scope: {\r\n                    data: '=',\r\n                    created:'&pipCreated',\r\n                    showPictures: '=',\r\n                    showDocuments: '=',\r\n                    typeCollection:'=typeCollection',\r\n                    saveCallback:'='\r\n                },\r\n                templateUrl: 'feedback/feedback_panel.html',\r\n                controller: 'pipFeedbackPanelController'\r\n\r\n            };\r\n        }\r\n    );\r\n    \r\n    thisModule.controller('pipFeedbackPanelController',\r\n        ['$scope', '$rootScope', '$state', 'pipUtils', 'pipAppBar', 'pipTranslate', 'pipFeedbacksData', 'pipTransaction', 'pipToasts', 'pipFormErrors', '$mdDialog', function ($scope, $rootScope, $state, pipUtils, pipAppBar, pipTranslate,\r\n                  pipFeedbacksData, pipTransaction, pipToasts, pipFormErrors, $mdDialog) {\r\n\r\n            $scope.$party = $rootScope.$party;\r\n            $scope.typeCollection = [\r\n                {id: 'support', name: 'SUPPORT'},\r\n                {id: 'feedback', name: 'FEEDBACK'},\r\n                {id: 'copyright', name: 'COPYRIGHT'},\r\n                {id: 'business', name: 'BUSINESS'},\r\n                {id: 'advertising', name: 'ADVERTISING'}\r\n            ];\r\n            pipTranslate.translateObjects($scope.typeCollection, 'name', 'name');\r\n\r\n            $scope.transaction = pipTransaction('feedback', $scope);\r\n\r\n            $scope.type = pipTranslate.translate('FEEDBACK');\r\n            $scope.data.sender_id = $rootScope.$party.id;\r\n            $scope.data.sender_name = $rootScope.$party.name;\r\n            $scope.data.sender_email = $rootScope.$party.email;\r\n            $scope.data.pic_ids = [];\r\n            $scope.data.docs = [];\r\n            $scope.data.type =  $scope.typeCollection[0].id;\r\n\r\n\r\n            $scope.$control = {};\r\n            $scope.$control.goBack = pipUtils.goBack;\r\n            $scope.$control.onSave = onSave;\r\n            $scope.$control.onTypeChange = onTypeChange;\r\n\r\n            if ($scope.created){\r\n                $scope.created({\r\n                    $control: $scope.$control\r\n                });\r\n            }\r\n\r\n            $scope.errorsWithHint = pipFormErrors.errorsWithHint;\r\n            $scope.onTypeChange = onTypeChange;\r\n\r\n            return;\r\n            //-----------------------\r\n\r\n            function onSave() {\r\n                $scope.form.$setSubmitted();\r\n                if ($scope.form.$invalid) return;\r\n\r\n                pipFeedbacksData.createFeedbackWithFiles(\r\n                    {\r\n                        transaction: $scope.transaction,\r\n                        pictures: $scope.pictures,\r\n                        documents: $scope.docs,\r\n                        item: $scope.data\r\n                    },\r\n                    $scope.saveCallback\r\n\r\n                )\r\n            };\r\n\r\n            function onTypeChange(type) {\r\n                $scope.data.type = $scope.typeCollection[$scope.typeIndex];\r\n                $scope.type = type.name;\r\n            }\r\n\r\n\r\n        }])\r\n\r\n})();","/**\r\n *  @file String resources for Feedback page\r\n *  @copyright Digital Living Software Corp. 2014-2016\r\n */\r\n\r\n/* global angular */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var thisModule = angular.module('pipFeedback.Strings', ['pipTranslate']);\r\n\r\n    thisModule.config(['pipTranslateProvider', function (pipTranslateProvider) {\r\n\r\n        // Set translation strings for the module\r\n        pipTranslateProvider.translations('en', {\r\n            'FEEDBACK_TITLE': 'Contact us',\r\n            'FEEDBACK_HINT_FEEDBACK': 'If you need help or you have some ideas or suggestions to improve Pip.Life just use form below',\r\n            'FEEDBACK_HINT_COPYRIGHT': 'If you believe that content available on Pip.Life infringes one or more of your copyrights, you can use the form below to submit a DMCA notice. Upon receipt of a valid notice, we are required by law to respond to it by disabling access to the allegedly infringing content. Your Infringement Notice may be forwarded to the party that made the content available, or to third parties such as ChillingEffects.org.',\r\n            'FEEDBACK_HINT_COPYRIGHT2': 'If you choose to request removal of content by submitting an infringement notification, please remember that you are initiating a legal process. Do not make false claims. Please be advised that under 17 U.S.C. § 512(f), you may be liable for damages (including costs and attorneys’ fees) if you knowingly misrepresent that a product or activity is infringing your copyrights. Thus, if you are not sure content located on or linked-to by Dribbble infringes your copyright, you should consider first contacting an attorney.',\r\n            'FEEDBACK_COMPANY': 'Company name',\r\n            'FEEDBACK_MESSAGE': 'Message',\r\n            'FEEDBACK_ADDRESS': 'Address',\r\n            'FEEDBACK_COPYRIGHT_HOLDER': 'Copyright holder you represent',\r\n            'FEEDBACK_COPYRIGHT_HOLDER_HINT': 'If representing someone other than yourself',\r\n            'FEEDBACK_ORIGINAL_LOCATION': 'Location of original copyrighted work',\r\n            'FEEDBACK_DESCRIBE_COPYRIGHTED': 'Describe the copyrighted work',\r\n            'FEEDBACK_DESCRIBE_COPYRIGHTED_HINT': 'Helps us identify the specific referenced work',\r\n            'FEEDBACK_UNAUTHORIZE_LOCATION': 'Location of unauthorized material',\r\n            'FEEDBACK_UNAUTHORIZE_LOCATION_HINT': 'Please provide specific page URLs, one per line',\r\n            'FEEDBACK_COPYRIGHT_CONC': 'I have a good faith belief that use of the copyrighted materials described above as allegedly infringing is not authorized by the copyright owner, its agent, or the law',\r\n            'FEEDBACK_REGUEST_CONC': 'I swear, under penalty of perjury, that the information in the notification is accurate and that I am the copyright owner or am authorized to act on behalf of the owner of an exclusive right that is allegedly infringed.',\r\n            'FEEDBACK_SIGNATURE': 'You first and last name',\r\n            'FEEDBACK_SIGNATURE_HINT': 'Signature',\r\n            'FEEDBACK_SUBJECT':'Subject',\r\n            'FEEDBACK_SUCCESS': 'Your message was sent to Pip.Life support team. They will contact you via personal messaging soon. Thanks for your interest in PipLife!'\r\n        });\r\n\r\n        pipTranslateProvider.translations('ru', {\r\n            'FEEDBACK_TITLE': 'Обратная связь',\r\n            'FEEDBACK_HINT_FEEDBACK': 'Если Вам нужна помощь или у вас есть идеи или предложения по улучшению Pip.Life используйте рассположенную ниже форму',\r\n            'FEEDBACK_HINT_COPYRIGHT': 'Если вы считаете, что контент, доступный на Pip.Life нарушает одно или более ваших авторских прав, вы можете использовать форму ниже, чтобы представить уведомление DMCA. После получения уведомления, мы по закону обязаны ответить на него, отключив доступ к контенту, который предположительно нарушает авторские права. Уведомление может быть направлено со стороны, представившей контент или третьих сторон, таких как ChillingEffects.org.',\r\n            'FEEDBACK_HINT_COPYRIGHT2': 'Если вы решите запросить удаление содержания, подав уведомление о нарушении, пожалуйста, помните, что вы инициируете судебный процесс. Пожалуйста, обратите внимание, что исодя из статьи 17 U.S.C. § 512 (F), вы можете нести ответственность за убытки (включая расходы и гонорары адвокатам), если вы сознательно искажаете действительность, что продукт или деятельность нарушает ваши авторские права. Таким образом, если вы не уверены, что содержание, расположенное на PipLife нарушает Ваши авторские права посоветуйтесь с адвокатом.',\r\n            'FEEDBACK_COMPANY': 'Название компании',\r\n            'FEEDBACK_MESSAGE': 'Сообщение',\r\n            'FEEDBACK_ADDRESS': 'Адрес',\r\n            'FEEDBACK_COPYRIGHT_HOLDER': 'Владелец авторского права',\r\n            'FEEDBACK_COPYRIGHT_HOLDER_HINT': 'Заполните поле, если Вы  представляете кого-то кроме себя',\r\n            'FEEDBACK_ORIGINAL_LOCATION': 'Расположение оригинальной авторской работы',\r\n            'FEEDBACK_DESCRIBE_COPYRIGHTED': 'Опишите авторские права на произведение',\r\n            'FEEDBACK_DESCRIBE_COPYRIGHTED_HINT': 'Это поможет нам идентифицировать ссылки на работу',\r\n            'FEEDBACK_UNAUTHORIZE_LOCATION': 'Расположение несанкционированного материала',\r\n            'FEEDBACK_UNAUTHORIZE_LOCATION_HINT': 'Пожалуйста, укажите конкретную страницу URL, по одной в строке',\r\n            'FEEDBACK_COPYRIGHT_CONC': 'У меня есть добросовестное предположение, что использование защищенных авторским правом материалов, описанных выше, в качестве якобы нарушает авторские права, не разрешено владельцем авторского права, его агентом или законом',\r\n            'FEEDBACK_REGUEST_CONC': 'Я клянусь под страхом наказания за лжесвидетельство, что содержащаяся в уведомлении информация верна и что я являюсь владельцем авторского права или имею право действовать от имени владельца эксклюзивных прав, которые якобы нарушены.',\r\n            'FEEDBACK_SIGNATURE': 'Ваше имя и фамилия',\r\n            'FEEDBACK_SIGNATURE_HINT': 'Подпись',\r\n            'FEEDBACK_SUBJECT':'Заголовок',\r\n            'FEEDBACK_SUCCESS': 'Ваш запрос передан команде технической поддержки Pip.Life. C вами свяжутся в ближайшее время по электронной почте. Спасибо за ваш интерес и поддержку PipLife.'\r\n        });\r\n\r\n    }]);\r\n\r\n})();"],"sourceRoot":"/source/"}