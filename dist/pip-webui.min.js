!function(){"use strict";angular.module("pipCore",["pipUtils","pipErrors","pipTransactions","pipTranslate","pipState","pipTimer","pipAssert","pipDebug","pipDateFormat","pipDateTimeFilters","pipTranslateFilters","pipClearErrors","pipTheme","pipFocused","pipSelected","pipInfiniteScroll","pipDraggable","pipUnsavedChanges","pipFabTooltipVisibility"])}(),function(){"use strict";var e=angular.module("pipClearErrors",[]);e.directive("pipClearErrors",function(){return{restrict:"A",require:["ngModel","^?form"],link:function(e,t,r,n){function a(){var e=o.$error;for(var t in e)e.hasOwnProperty(t)&&"ERROR_"==t.substring(0,6)&&o.$setValidity(t,!0)}function i(){u.$serverError={}}var o=n[0],u=n[1];e.$watch(r.ngModel,function(e){a(),i()})}}})}(),function(){"use strict";var e=angular.module("pipDraggable",["pipUtils"]);e.service("pipDraggable",function(){var e=this;e.inputEvent=function(e){return angular.isDefined(e.touches)?e.touches[0]:angular.isDefined(e.originalEvent)&&angular.isDefined(e.originalEvent.touches)?e.originalEvent.touches[0]:e}}),e.directive("pipDrag",["$rootScope","$parse","$document","$window","pipDraggable","pipUtils",function(e,t,r,n,a,i){return{restrict:"A",link:function(o,u,l){o.value=l.ngDrag;var s,c,p,f,d,g,m,h,v=!1,_="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,D="touchstart mousedown",b="touchmove mousemove",T="touchend mouseup",S=o.$id,E=null,y=null,M=!1,O=null,A=t(l.pipDragStart)||null,w=t(l.pipDragStop)||null,$=t(l.pipDragSuccess)||null,N=angular.isDefined(l.allowTransform)?o.$eval(l.allowTransform):!1,P=t(l.pipDragData),H=i.toBoolean(l.pipVerticalScroll)||!0,C=i.toBoolean(l.pipHorizontalScroll)||!0,L=parseFloat(l.pipActivationDistance)||75,R=parseFloat(l.pipScrollDistance)||50,k=!1,U=angular.element(window),F=t(l.pipScrollContainer),Y=angular.noop,x=function(){if(u.attr("pip-draggable","false"),u[0].querySelectorAll)var e=angular.element(u[0].querySelectorAll("[pip-drag-handle]"));else var e=u.find("[pip-drag-handle]");e.length&&(h=e),I(!0),U=k?angular.element($element.parent()):l.pipScrollContainer?angular.element(F(o)):angular.element(window)},I=function(e){e&&(o.$on("$destroy",G),o.$watch(l.pipDrag,W),o.$watch(l.pipCenterAnchor,B),h?h.on(D,q):u.on(D,q),_||"img"!=u[0].nodeName.toLowerCase()||u.on("mousedown",function(){return!1}))},G=function(e){I(!1)},W=function(e,t){M=e},B=function(e,t){angular.isDefined(e)&&(v=e||"true")},j=function(e){return angular.isDefined(angular.element(e.target).attr("pip-cancel-drag"))},q=function(e){M&&(j(e)||"mousedown"==e.type&&0!=e.button||(_?(K(),O=setTimeout(function(){K(),V(e)},100),r.on(b,K),r.on(T,K)):V(e)))},K=function(){clearTimeout(O),r.off(b,K),r.off(T,K)},V=function(t){M&&(t.preventDefault(),s=u[0].getBoundingClientRect(),y=N?s:{left:document.body.scrollLeft,top:document.body.scrollTop},u.centerX=u[0].offsetWidth/2,u.centerY=u[0].offsetHeight/2,c=a.inputEvent(t).pageX,p=a.inputEvent(t).pageY,g=c-s.left,m=p-s.top,v?(f=c-u.centerX-n.pageXOffset,d=p-u.centerY-n.pageYOffset):(f=c-g-n.pageXOffset,d=p-m-n.pageYOffset),r.on(b,z),r.on(T,J),Y=e.$on("draggable:_triggerHandlerMove",function(e,t){z(t)}))},z=function(t){M&&(t.preventDefault(),u.hasClass("pip-dragging")||(E=P(o),u.addClass("pip-dragging"),e.$broadcast("draggable:start",{x:c,y:p,tx:f,ty:d,event:t,element:u,data:E}),A&&o.$apply(function(){A(o,{$data:E,$event:t})})),c=a.inputEvent(t).pageX,p=a.inputEvent(t).pageY,(C||H)&&ee(),v?(f=c-u.centerX-y.left,d=p-u.centerY-y.top):(f=c-g-y.left,d=p-m-y.top),Z(f,d),e.$broadcast("draggable:move",{x:c,y:p,tx:f,ty:d,event:t,element:u,data:E,uid:S,dragOffset:y}))},J=function(t){M&&(t.preventDefault(),e.$broadcast("draggable:end",{x:c,y:p,tx:f,ty:d,event:t,element:u,data:E,callback:X,uid:S}),u.removeClass("pip-dragging"),u.parent().find(".pip-drag-enter").removeClass("pip-drag-enter"),Q(),r.off(b,z),r.off(T,J),w&&o.$apply(function(){w(o,{$data:E,$event:t})}),Y())},X=function(e){$&&o.$apply(function(){$(o,{$data:E,$event:e})})},Q=function(){N?u.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):u.css({position:"",top:"",left:"","z-index":"",width:""})},Z=function(e,t){var r=u.css("width");N?u.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+t+")"}):u.css({left:e+"px",top:t+"px",position:"fixed","z-index":100,width:r})},ee=function(){var e=0,t=0,r=function(e){return e.offset()||{left:0,top:0}};if(C){var n=r(U).left,a=U.innerWidth(),i=n+a;L>c-n?e=-R:L>i-c&&(e=R)}if(H){var o=r(U).top,u=U.innerHeight(),l=o+u;L>p-o?t=-R+30:L>l-p&&(t=R-30)}if(0!==e||0!==t){var s=U.scrollLeft(),f=U.scrollTop();U.scrollLeft(s+e),U.scrollTop(f+t)}};x()}}}]),e.directive("pipDrop",["$parse","$timeout","$window","$document","pipDraggable",function(e,t,r,n,a){return{restrict:"A",link:function(r,a,i){r.value=i.pipDrop,r.isTouching=!1;var o=null,u=r.$id,l=!1,s=e(i.pipDropSuccess),c=e(i.pipDragStart),p=e(i.pipDragStop),f=e(i.pipDragMove),d=function(){g(!0)},g=function(e){e&&(r.$watch(i.pipDrop,h),r.$on("$destroy",m),r.$on("draggable:start",v),r.$on("draggable:move",_),r.$on("draggable:end",D))},m=function(e){g(!1)},h=function(e,t){l=e},v=function(e,n){l&&(b(n.x,n.y,n.element),i.pipDragStart&&t(function(){c(r,{$data:n.data,$event:n})}))},_=function(e,n){l&&(b(n.x,n.y,n.element),i.pipDragMove&&t(function(){f(r,{$data:n.data,$event:n})}))},D=function(e,n){return l&&u!==n.uid?(b(n.x,n.y,n.element)&&(n.callback&&n.callback(n),i.pipDropSuccess&&t(function(){s(r,{$data:n.data,$event:n,$target:r.$eval(r.value)})})),i.pipDragStop&&t(function(){p(r,{$data:n.data,$event:n})}),void T(!1,n.element)):void T(!1,n.element)},b=function(e,t,n){var i=S(e,t);return r.isTouching=i,i&&(o=a),T(i,n),i},T=function(e,t){e?(a.addClass("pip-drag-enter"),t.addClass("pip-drag-over")):o==a&&(o=null,a.removeClass("pip-drag-enter"),t.removeClass("pip-drag-over"))},S=function(e,t){var r=a[0].getBoundingClientRect();return e-=n[0].body.scrollLeft+n[0].documentElement.scrollLeft,t-=n[0].body.scrollTop+n[0].documentElement.scrollTop,e>=r.left&&e<=r.right&&t<=r.bottom&&t>=r.top};d()}}}]),e.directive("pipPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,r){var n=function(){t.attr("pip-draggable","false"),a(!0)},a=function(e){e&&t.on("mousedown touchstart touchmove touchend touchcancel",i)},i=function(e){var t=e.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};n()}}}]),e.directive("pipCancelDrag",function(){return{restrict:"A",link:function(e,t,r){t.find("*").attr("pip-cancel-drag","pip-cancel-drag")}}})}(),function(){"use strict";var e=angular.module("pipFabTooltipVisibility",[]);e.directive("pipFabTooltipVisibility",["$parse","$timeout",function(e,t){return{restrict:"A",scope:!1,controller:["$scope","$attrs",function(r,n){var a=e(n.pipFabTooltipVisibility),i=e(n.pipFabShowTooltip),o=i.assign;r.$watch(a,function(e){e?t(function(){o(r,e)},600):o(r,e)})}]}}])}(),function(){"use strict";var e=angular.module("pipFocused",[]);e.directive("pipFocused",["$timeout","$mdConstant",function(e,t){return{require:"?ngModel",link:function(r,n,a){function i(){var e=s?".pip-focusable":".pip-focusable:visible";u=n.find(e),l=u.length,u.on("focus",function(){n.addClass("pip-focused-container"),$(this).addClass("md-focused")}).on("focusout",function(){n.removeClass("pip-focused-container")})}function o(e){var r=e.which||e.keyCode;if(r==t.KEY_CODE.LEFT_ARROW||r==t.KEY_CODE.UP_ARROW||r==t.KEY_CODE.RIGHT_ARROW||r==t.KEY_CODE.DOWN_ARROW){e.preventDefault();var n=r==t.KEY_CODE.RIGHT_ARROW||r==t.KEY_CODE.DOWN_ARROW?1:-1,a=u.index(u.filter(".md-focused"))+n;a>=0&&l>a&&u[a].focus()}}var u,l,s=a.pipWithHidden;e(i),n.on("keydown",o),r.$watch(a.ngModel,function(){e(i)},!0)}}}])}(),function(){"use strict";var e=angular.module("pipInfiniteScroll",[]);e.directive("pipInfiniteScroll",["$rootScope","$window","$interval","$parse",function(e,t,r,n){var a=500;return{scope:{pipInfiniteScroll:"&",pipScrollContainer:"=",pipScrollDistance:"=",pipScrollDisabled:"=",pipScrollUseDocumentBottom:"=",pipScrollListenForEvent:"@"},link:function(n,i,o){function u(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight}function l(e){return e[0].getBoundingClientRect&&!e.css("none")?e[0].getBoundingClientRect().top+s(e):void 0}function s(e){return e=e[0]||e,isNaN(window.pageYOffset)?e.document.documentElement.scrollTop:e.ownerDocument.defaultView.pageYOffset}function c(e){return D=parseFloat(e)||0}function p(e){return b=!e,b&&h?(h=!1,y()):void 0}function f(e){return S=e}function d(e){return null!=m&&m.unbind("scroll",y),m=e,null!=e?m.bind("scroll",y):void 0}function g(e){if(null!=e&&0!==e.length){if(e instanceof HTMLElement?e=angular.element(e):"function"==typeof e.append?e=angular.element(e[e.length-1]):"string"==typeof e&&(e=i.parents().find(e)),null!=e&&(!Array.isArray(e)||Array.isArray(e)&&e.length>0))return d(e);throw new Error("Invalid pip-scroll-container attribute.")}}var m,h=null,v=!0,D=null,b=null,T=null,S=!1,E=angular.element(t),y=function(){var t,r,a,o,c;return m===E?(t=u(m)+s(m[0].document.documentElement),a=l(i)+u(i)):(t=u(m),r=0,void 0!==l(m)&&(r=l(m)),a=l(i)-r+u(i)),S&&(a=u((i[0].ownerDocument||i[0].document).documentElement)),o=a-t,c=o<=u(m)*D+1,c?(h=!0,b?n.$$phase||e.$$phase?n.pipInfiniteScroll():n.$apply(n.pipInfiniteScroll):void 0):h=!1};return null!=a&&(y=_.throttle(y,a)),n.$on("$destroy",function(){return m.unbind("scroll",y),null!=T?(T(),T=null):void 0}),n.$watch("pipScrollDistance",c),c(n.pipScrollDistance),n.$watch("pipScrollDisabled",p),p(n.pipScrollDisabled),n.$watch("pipScrollUseDocumentBottom",f),f(n.pipScrollUseDocumentBottom),d(E),n.pipScrollListenForEvent&&(T=e.$on(n.pipScrollListenForEvent,y)),n.$watch("pipScrollContainer",function(e){e!==m&&g(e)}),g(n.pipScrollContainer||[]),null!=o.pipScrollParent&&d(angular.element(i.parent())),null!=o.pipScrolImmediateCheck&&(v=n.$eval(o.pipScrolImmediateCheck)),r(function(){return v?y():void 0},0,1)}}}])}(),function(){"use strict";var e=angular.module("pipSelected",["pipUtils"]);e.directive("pipSelected",["$parse","pipUtils","$mdConstant","$timeout",function(e,t,r,n){return{restrict:"A",scope:!1,link:function(n,a,i){function o(e){var t=e.itemIndex,r=e.itemId,n=e.items||a.find(v+h),i=n.length,o=function(){return e.item?e.item:(void 0===t&&-1===t&&(t=n.index(n.filter("[pip-id="+r+"]"))),t>=0&&i>t?n[t]:void 0)}(),s=e.raiseEvent;o&&(a.find(v).removeClass("selected md-focused"),o=angular.element(o).addClass("selected md-focused").focus(),m||l(o),s&&u(n))}function u(e){function t(){var t=angular.element(e[_]),i=t.attr("pip-id");c&&c(n,_),f&&f(n,i),d&&d(n,{$event:{target:a,item:t,index:_,id:i,newIndex:_,oldIndex:r}})}var r=_;_=-1;for(var i=0;i<e.length;i++)if($(e[i]).hasClass("selected")){_=i;break}r!=_&&-1!==_&&n.$apply(t)}function l(e){if(!m){var t=a.offset().top,r=a.height(),n=t+r,i=e.offset().top,o=e.outerHeight(!0),u=i+o,l=a.scrollTop();t>i?a.scrollTop(l+i-t):u>n&&a.scrollTop(l+u-n)}}var s=i.pipSelected?e(i.pipSelected):null,c=s?s.assign:null,p=i.pipSelectedId?e(i.pipSelectedId):null,f=p?p.assign:null,d=i.pipSelect?e(i.pipSelect):null,g=i.pipEnterSpacePress?e(i.pipEnterSpacePress):null,m=t.toBoolean(i.pipNoScroll),h=t.toBoolean(i.pipSkipHidden)?":visible":"",v=t.toBoolean(i.pipTreeList)?".pip-selectable-tree":".pip-selectable",_=s(n),D=a.attr("tabindex"),b=i.pipSelectedWatch;a.attr("tabindex",D||0),t.toBoolean(i.pipTreeList)?n.$watch(p,function(e){setTimeout(function(){o({itemId:e,raiseEvent:!0})},0)}):n.$watch(s,function(e){o({itemIndex:e})}),b&&n.$watch(b,function(){setTimeout(function(){_=s(n),o({itemIndex:_})},100)}),o({itemIndex:_,items:a.find(v)}),a.on("click touchstart",v,function(e){o({item:e.currentTarget,raiseEvent:!0})}),a.on("keydown",function(e){var t=e.which||e.keyCode;if(t==r.KEY_CODE.ENTER||t==r.KEY_CODE.SPACE)e.preventDefault(),e.stopPropagation(),g&&g(n,{$event:{target:a,index:_,item:a.find(".selected")}});else if(t==r.KEY_CODE.LEFT_ARROW||t==r.KEY_CODE.RIGHT_ARROW||t==r.KEY_CODE.UP_ARROW||t==r.KEY_CODE.DOWN_ARROW){e.preventDefault(),e.stopPropagation();var i=a.find(v+h),u=t==r.KEY_CODE.RIGHT_ARROW||t==r.KEY_CODE.DOWN_ARROW?1:-1,l=_+u;o({itemIndex:l,items:i,raiseEvent:!0})}}),a.on("focusin",function(e){var t,r=a.find(v+".selected");r.addClass("md-focused"),0===r.length&&(_=s(n),t=a.find(v+h),o({itemIndex:_||0,items:t,raiseEvent:!0}))}),a.on("focusout",function(e){a.find(v+".md-focused"+h).removeClass("md-focused")})}}}])}(),function(){"use strict";var e=angular.module("pipUnsavedChanges",[]);e.directive("pipUnsavedChanges",["$window","$rootScope",function(e,t){return{restrict:"AE",scope:{unsavedChangesAvailable:"&pipUnsavedChangesAvailable",unsavedChangesMessage:"@pipUnsavedChangesMessage",afterLeave:"&pipUnsavedChangesAfterLeave"},link:function(r){e.onbeforeunload=function(){return r.unsavedChangesAvailable()?(t.$routing=!1,r.unsavedChangesMessage):void 0};var n=r.$on("$stateChangeStart",function(n){r.unsavedChangesAvailable()&&!e.confirm(r.unsavedChangesMessage)?(t.$routing=!1,n.preventDefault()):_.isFunction(r.afterLeave)&&r.afterLeave()});r.$on("$destroy",function(){e.onbeforeunload=null,n()})}}}])}(),function(){"use strict";var e=angular.module("pipDateFormat",["pipUtils","pipTranslate"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{MONTH_1:"January",MONTH_2:"February",MONTH_3:"March",MONTH_4:"April",MONTH_5:"May",MONTH_6:"June",MONTH_7:"July",MONTH_8:"August",MONTH_9:"September",MONTH_10:"October",MONTH_11:"November",MONTH_12:"December",MONTH_LONG_1:"January",MONTH_LONG_2:"February",MONTH_LONG_3:"March",MONTH_LONG_4:"April",MONTH_LONG_5:"May",MONTH_LONG_6:"June",MONTH_LONG_7:"July",MONTH_LONG_8:"August",MONTH_LONG_9:"September",MONTH_LONG_10:"October",MONTH_LONG_11:"November",MONTH_LONG_12:"December",MONTH_SHORT_1:"Jan",MONTH_SHORT_2:"Feb",MONTH_SHORT_3:"Mar",MONTH_SHORT_4:"Apr",MONTH_SHORT_5:"May",MONTH_SHORT_6:"Jun",MONTH_SHORT_7:"Jul",MONTH_SHORT_8:"Aug",MONTH_SHORT_9:"Sep",MONTH_SHORT_10:"Oct",MONTH_SHORT_11:"Nov",MONTH_SHORT_12:"Dec",DAY_1:"Monday",DAY_2:"Tuesday",DAY_3:"Wednesday",DAY_4:"Thursday",DAY_5:"Friday",DAY_6:"Saturday",DAY_7:"Sunday",ELAPSED_TODAY:"Today",ELAPSED_YESTERDAY:"Yesterday",ELAPSED_YEARS:"y",ELAPSED_MONTHS:"mth",ELAPSED_WEEKS:"w",ELAPSED_DAYS:"d",ELAPSED_HOURS:"h",ELAPSED_MINUTES:"m",ELAPSED_SECONDS:"s",ELAPSED_AT:"at",ELAPSED_AGO:"ago",ELAPSED_JUST_NOW:"Just now",ELAPSED_FEW_MIN_AGO:"Few min ago",ELAPSED_MIN_AGO:"min ago",ELAPSED_HOUR_AGO:"hour ago",ELAPSED_HOURS_AGO:"hours ago",ELAPSED_HOURS_AGO_MORE_THAN_FIVE:"hours ago"}),e.translations("ru",{MONTH_1:"январь",MONTH_2:"февраль",MONTH_3:"март",MONTH_4:"апрель",MONTH_5:"май",MONTH_6:"июнь",MONTH_7:"июль",MONTH_8:"август",MONTH_9:"сентябрь",MONTH_10:"октябрь",MONTH_11:"ноябрь",MONTH_12:"декабрь",MONTH_LONG_1:"января",MONTH_LONG_2:"февраля",MONTH_LONG_3:"марта",MONTH_LONG_4:"апреля",MONTH_LONG_5:"мая",MONTH_LONG_6:"июня",MONTH_LONG_7:"июля",MONTH_LONG_8:"августа",MONTH_LONG_9:"сентября",MONTH_LONG_10:"октября",MONTH_LONG_11:"ноября",MONTH_LONG_12:"декабря",MONTH_SHORT_1:"янв",MONTH_SHORT_2:"фев",MONTH_SHORT_3:"мар",MONTH_SHORT_4:"апр",MONTH_SHORT_5:"май",MONTH_SHORT_6:"июн",MONTH_SHORT_7:"июл",MONTH_SHORT_8:"авг",MONTH_SHORT_9:"сен",MONTH_SHORT_10:"окт",MONTH_SHORT_11:"ноя",MONTH_SHORT_12:"дек",DAY_1:"понедельник",DAY_2:"вторник",DAY_3:"среда",DAY_4:"четверг",DAY_5:"пятница",DAY_6:"суббота",DAY_7:"воскресенье",ELAPSED_TODAY:"Сегодня",ELAPSED_YESTERDAY:"Вчера",ELAPSED_YEARS:"г",ELAPSED_MONTHS:"мц",ELAPSED_WEEKS:"н",ELAPSED_DAYS:"д",ELAPSED_HOURS:"ч",ELAPSED_MINUTES:"м",ELAPSED_SECONDS:"с",ELAPSED_AT:"в",ELAPSED_AGO:"тн",ELAPSED_JUST_NOW:"Только что",ELAPSED_FEW_MIN_AGO:"Несколько мин тн",ELAPSED_MIN_AGO:"мин тн",ELAPSED_HOUR_AGO:"час тн",ELAPSED_HOURS_AGO:"часа тн",ELAPSED_HOURS_AGO_MORE_THAN_FIVE:"часов тн"})}]),e.factory("pipDateFormat",["pipDates","pipTranslate","$rootScope",function(e,t,r){function n(e){return 10>e?"0"+e:e}function a(n,a,i){if(null==n)return"";var o=i||!1,n=_.isDate(n)?n:new Date(n),u=(new Date).getUTCFullYear(),l=n.getUTCFullYear(),s=n.getUTCMonth(),c=t.translate("MONTH_LONG_"+(s+1)),p=t.translate("MONTH_SHORT_"+(s+1)),f=t.translate("MONTH_"+(s+1)),d=n.getUTCDate(),g=e.toStartWeek(n),m=e.toEndWeek(n,-1);return 0==o&&"d MMMM yyyy"==a&&u===l&&(a="MMMM d"),0==o&&"d MMM yyyy"==a&&u===l&&(a="MMM d"),"MMM d"==a&&"ru"==r.$language&&(a="d MMM"),"MMMM d"==a&&"ru"==r.$language&&(a="d MMMM"),"d MMMM yyyy"==a?""+d+" "+c+" "+l:"MMMM d, yyyy"==a?""+f+" "+d+", "+l:"d MMM yyyy"==a?""+d+" "+p+" "+l:"MMM d, yyyy"==a?""+p+" "+d+", "+l:"d MMMM"==a?""+d+" "+c:"d MMM"==a?""+d+" "+p:"MMM d"==a?""+p+" "+d:"MMMM d"==a?""+c+" "+d:"yyyy/M/d"==a?""+l+"/"+s+"/"+d:"yyy-M-d"==a?""+l+"-"+s+"-"+d:"MMMM"==a?""+c+" "+l:"yyyy"==a?""+l:"ww"==a?""+g.getUTCDate()+" - "+m.getUTCDate()+" "+f+" "+l:""+d+" "+f+" "+l}function i(e){return a(e,"d MMMM yyyy")}function o(e){return a(e,"d MMM yyyy",!0)}function u(e){return a(e,"d MMMM yyyy",!0)}function l(e){return a(e,"d MMM yyyy")}function s(e){return a(e,"MMMM")}function c(e){return a(e,"yyyy")}function p(e){return a(e,"ww")}function f(e){return a(e,"d MMM")}function d(e){return"ru"==r.$language?a(e,"d MMMM"):a(e,"MMMM d")}function g(e,t){return e=e?_.isDate(e)?e:new Date(e):null,t=t?_.isDate(t)?t:new Date(t):null,null==e?"ru"==r.$language?a(t,"d MMM yyyy",!0):a(t,"MMM d, yyyy",!0):null==t||e==t?"ru"==r.$language?a(e,"d MMM yyyy",!0):a(e,"MMM d, yyyy",!0):e.getUTCFullYear()!==t.getUTCFullYear()?"ru"==r.$language?a(e,"d MMM yyyy",!0)+"-"+a(t,"d MMM yyyy",!0):a(e,"MMM d, yyyy",!0)+"-"+a(t,"MMM d, yyyy",!0):a(e,"d MMM")+" - "+a(t,"d MMM")+((new Date).getUTCFullYear()!==e.getUTCFullYear()?" "+a(e,"yyyy"):"")}function m(e,t){if(e=e?_.isDate(e)?e:new Date(e):null,t=t?_.isDate(t)?t:new Date(t):null,null==e&&null==t)return"";if(null==e)return S(t);if(null==t||e==t)return S(e);var r,n,i,o,u,l;return r=e.getUTCDate(),n=e.getUTCMonth(),i=e.getUTCFullYear(),o=t.getUTCDate(),u=t.getUTCMonth(),l=t.getUTCFullYear(),i!==l?a(e,"d MMM")+", "+i+" "+h(e,"hh:mm")+" - "+a(t,"d MMM")+", "+l+" "+h(t,"hh:mm"):n!=u&&!r!=o?a(e,"d MMM")+", "+h(e,"hh:mm")+" - "+a(t,"d MMM")+", "+h(t,"hh:mm"):h(e,"hh:mm")+" - "+h(t,"hh:mm")}function h(e,r){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var a=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),u="";return"en"==t.use()&&(u=a>=12?" PM":" AM",a%=12,0==a&&(a=12)),"hh:mm:ss"==r?""+n(a)+":"+n(i)+":"+n(o)+u:"hh:mm"==r?""+n(a)+":"+n(i)+u:""+n(a)+":"+n(i)+":"+n(o)+u}function v(e,r){return null==e?"":r?t.translate("MONTH_SHORT_"+e):t.translate("MONTH_"+e)}function D(e){return h(e,"hh:mm:ss")}function b(e){return h(e,"hh:mm")}function T(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),i(e)+" "+D(e))}function S(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),l(e)+" "+b(e))}function E(e,r){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var n=new Date,i=Math.floor((n.getTime()+n.getTimezoneOffset()-(e.getTime()+e.getTimezoneOffset()))/1e3);if(1>i)return t.translate("ELAPSED_JUST_NOW");var o,u,l,s,c,p,f;if(f=i%60,i=Math.floor(i/60),p=i%60,i=Math.floor(i/60),c=i%24,i/=24,o=Math.floor(i/365),i-=365*o,u=Math.floor(i/30),s=Math.floor(i-30*u),s%7==0?(l=Math.floor(s/7),s=0):l=0,"interval"==r){var d="";return o&&(d+=" "+o+t.translate("ELAPSED_YEARS"),l=s=c=p=f=null),u&&(d+=" "+u+t.translate("ELAPSED_MONTHS"),s=c=p=f=null),l&&(d+=" "+l+t.translate("ELAPSED_WEEKS"),c=p=f=null),s&&(d+=" "+s+t.translate("ELAPSED_DAYS"),p=f=null),c&&(d+=" "+c+t.translate("ELAPSED_HOURS"),f=null),p&&(d+=" "+p+t.translate("ELAPSED_MINUTES")),f&&(d+=" "+f+t.translate("ELAPSED_SECONDS")),""!=d?d+" "+t.translate("ELAPSED_AGO"):t.translate("ELAPSED_JUST_NOW")}return o>0?a(e,"d MMM yyyy"):u>0||l>0||s>1?a(e,"MMM d")+", "+h(e,"hh:mm"):1==s?t.translate("ELAPSED_YESTERDAY")+", "+h(e,"hh:mm"):c>10?t.translate("ELAPSED_TODAY")+", "+h(e,"hh:mm"):c>0?""+c+" "+(2>c?t.translate("ELAPSED_HOUR_AGO"):5>c?t.translate("ELAPSED_HOURS_AGO"):t.translate("ELAPSED_HOURS_AGO_MORE_THAN_FIVE")):p>10?""+p+" "+t.translate("ELAPSED_MIN_AGO"):p>0?t.translate("ELAPSED_FEW_MIN_AGO"):t.translate("ELAPSED_JUST_NOW")}function y(e){return E(e,"interval")}function M(e){return Math.floor(e/1e3)}return{formatDate:a,formatLongDate:i,formatShortDate:l,formatShortDateWithYear:o,formatLongDateWithYear:u,formatLongMonth:s,formatMonth:v,formatYear:c,formatShortWeek:p,formatShortDayAndMonth:f,formatLongDayAndMonth:d,formatDateRange:g,formatDateTimeRange:m,formatTime:h,formatLongTime:D,formatShortTime:b,formatLongDateTime:T,formatShortDateTime:S,formatElapsedTime:E,formatElapsedInterval:y,formatMillisecondsToSeconds:M}}])}(),function(){"use strict";var e=angular.module("pipDateTimeFilters",["pipDateFormat"]);e.filter("formatDate",["pipDateFormat",function(e){return function(t,r){return e.formatDate(t,r)}}]),e.filter("formatLongDate",["pipDateFormat",function(e){return function(t){return e.formatLongDate(t)}}]),e.filter("formatLongDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatLongDateWithYear(t)}}]),e.filter("formatMonth",["pipDateFormat",function(e){return function(t,r){return e.formatMonth(t,r)}}]),e.filter("formatShortDate",["pipDateFormat",function(e){return function(t){return e.formatShortDate(t)}}]),e.filter("formatShortDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatShortDateWithYear(t)}}]),e.filter("formatLongMonth",["pipDateFormat",function(e){return function(t){return e.formatLongMonth(t)}}]),e.filter("formatYear",["pipDateFormat",function(e){return function(t){return e.formatYear(t)}}]),e.filter("formatShortWeek",["pipDateFormat",function(e){return function(t){return e.formatShortWeek(t)}}]),e.filter("formatTime",["pipDateFormat",function(e){return function(t,r){return e.formatTime(t,r)}}]),e.filter("formatLongTime",["pipDateFormat",function(e){return function(t){return e.formatLongTime(t)}}]),e.filter("formatShortTime",["pipDateFormat",function(e){return function(t){return e.formatShortTime(t)}}]),e.filter("formatLongDateTime",["pipDateFormat",function(e){return function(t){return e.formatLongDateTime(t)}}]),e.filter("formatShortDateTime",["pipDateFormat",function(e){return function(t){return e.formatShortDateTime(t)}}]),e.filter("formatElapsedInterval",["pipDateFormat",function(e){return function(t){return e.formatElapsedInterval(t)}}]),e.filter("formatElapsedTime",["pipDateFormat",function(e){return function(t){return e.formatElapsedTime(t)}}]),e.filter("formatMillisecondsToSeconds",["pipDateFormat",function(e){return function(t){return e.formatMillisecondsToSeconds(t)}}]),e.filter("formatDateRange",["pipDateFormat",function(e){return function(t,r){return e.formatDateRange(t,r)}}]),e.filter("formatDateTimeRange",["pipDateFormat",function(e){return function(t,r){return e.formatDateTimeRange(t,r)}}])}(),function(){"use strict";var e=angular.module("pipTranslateFilters",["pipTranslate"]);e.filter("translate",["pipTranslate",function(e){return function(t){return e.translate(t)||t}}])}(),function(){"use strict";var e=angular.module("pipAssert",["pipDebug"]);e.provider("pipAssert",["pipDebugProvider",function(e){function t(){}function r(e){return Object.prototype.toString.call(e)}function n(e,t){if(!Array.isArray(e))throw new Error(t||e+" should be array")}function a(e,t){if("boolean"!=typeof e)throw new Error(t||e+" should be boolean")}function i(e,t){if(null===e)throw new Error(t||e+" should be not null")}function o(e,t){if("number"!=typeof e)throw new Error(t||e+" should be number")}function u(e,t){if("string"!=typeof e)throw new Error(t||e+" should be string")}function l(e,t){if("object"!=typeof e)throw new Error(t||e+" should be an object")}function s(e,t){if("object"==typeof e&&"[object Date]"!==r(e))throw new Error(t||e+" should be a date")}function c(e,t){if("object"==typeof e&&("[object Error]"!==r(e)||e instanceof Error))throw new Error(t||e+" should be an error")}function p(e,t){if("function"!=typeof e)throw new Error(t||e+" should be a function")}function f(e,t){if("undefined"==typeof e)throw new Error(t||e+" should be defined")}function d(e,t){if(null===e||void 0===e||e===!1)throw new Error(t||e+" should be not null or undefined or false")}function g(e,t,r){if("object"!=typeof e)throw new Error(e+" should be an object");if(null===e[t]||void 0===e[t])throw new Error(r||t+" should be in object "+e)}function m(e,t,r){if(e!=t)throw new Error(r||e+" should be not equal "+t)}function h(e,t,r){if(e==t)throw new Error(r||e+" should be equal "+t)}function v(e,t,r){if(e!==t)throw new Error(r||e+" should not be strict equal "+t)}function _(e,t,r){if(e===t)throw new Error(r||e+" should not strict equal "+t)}function D(e,t){var r=new RegExp("^[0-9a-fA-F]{24}$");if(!r.test(e))throw new Error(t||e+" should be an object id")}return{isEmpty:e.enabled()?d:t,isObjectId:e.enabled()?D:t,isDefined:e.enabled()?f:t,isDef:e.enabled()?f:t,contains:e.enabled()?g:t,equal:e.enabled()?m:t,notEqual:e.enabled()?h:t,strictEqual:e.enabled()?v:t,notStrictEqual:e.enabled()?_:t,isArray:e.enabled()?n:t,isBoolean:e.enabled()?a:t,isNumber:e.enabled()?o:t,isString:e.enabled()?u:t,isObject:e.enabled()?l:t,isDate:e.enabled()?s:t,isError:e.enabled()?c:t,isFunction:e.enabled()?p:t,isNotNull:e.enabled()?i:t,$get:["pipDebug",function(e){return{isEmpty:e.enabled()?d:t,isObjectId:e.enabled()?D:t,isDefined:e.enabled()?f:t,isDef:e.enabled()?f:t,contains:e.enabled()?g:t,equal:e.enabled()?m:t,notEqual:e.enabled()?h:t,strictEqual:e.enabled()?v:t,notStrictEqual:e.enabled()?_:t,isArray:e.enabled()?n:t,isBoolean:e.enabled()?a:t,isNumber:e.enabled()?o:t,isString:e.enabled()?u:t,isObject:e.enabled()?l:t,isDate:e.enabled()?s:t,isError:e.enabled()?c:t,isFunction:e.enabled()?p:t,isNotNull:e.enabled()?i:t}}]}}])}(),function(){"use strict";var e=angular.module("pipDebug",[]);e.provider("pipDebug",["$logProvider",function(e){function t(){return this.enabled}function r(){this.enabled=!0,e.debugEnabled(!0)}function n(){this.enabled=!1,e.debugEnabled(!1)}return this.enabled=!0,{enable:r,disable:n,enabled:t,$get:["$log",function(e){return{enabled:t,log:e.log,info:e.info,warn:e.warn,error:e.error,debug:e.debug}}]}}])}(),function(){"use strict";var e=angular.module("pipErrors",["pipUtils","pipAssert"]);e.factory("pipError",["$rootScope","pipAssert",function(e,t){function r(t){e.errors[t]={message:void 0,code:void 0,details:void 0}}function n(e){if(_.isNull(e))return null;if(e.message)return e.message;if(e.data){if(e.data.code)return"ERROR_"+e.data.code;if(e.data.message)return e.data.message}return e.statusText?e.statusText:e.status?"ERROR_"+e.status:e.data?e.data:e}function a(e){return _.isNull(e)?null:e.data&&e.data.code?e.data.code:e.status?e.status:null}function i(e){return e&&e.data?e.data:e}function o(o,u){o=o||"global";var l={reset:function(){r(o)},empty:function(){var t=e.errors[o];return _.isNull(t)||_.isNull(t.message)&&_.isNull(t.code)},get:function(){return e.errors[o]?e.errors[o]:""},message:function(){return e.errors[o]?e.errors[o].message:null},code:function(){return e.errors[o]?e.errors[o].code:null},details:function(){return e.errors[o]?e.errors[o].details:null},set:function(u){u?(t.isObject(u,"Setting error: error should be an object"),e.errors[o]={message:n(u),code:a(u),details:i(u)},console.error(e.errors[o])):r(o)}};return _.isObject(u)&&(u.error=l),l}return e.errors={},o}])}(),function(){"use strict";var e=angular.module("pipState",["ui.router","pipTranslate","pipAssert"]);e.config(["$locationProvider","$httpProvider","pipTranslateProvider",function(e,t,r){r.translations("en",{ERROR_SWITCHING:"Error while switching route. Try again."}),r.translations("ru",{ERROR_SWITCHING:"Ошибка при переходе. Попробуйте ещё раз."})}]),e.run(["$rootScope","pipTranslate","$state",function(e,t,r){e.$on("$stateChangeSuccess",function(t,n,a,i,o){if(e.$user&&e.$user.id&&n.params&&n.params.access&&a&&a.party_id){var u=_.find(e.$user.party_access,{party_id:a.party_id});if(u){if(("manager"==n.params.access&&!u.manager||"contributor"==n.params.access&&!u.contributor)&&n.params.toState)return t.preventDefault(),void r.go(n.params.toState,a)}else if(a.party_id!=e.$user.id&&n.params.toState)return t.preventDefault(),void r.go(n.params.toState,a)}e.$routing=!1,e.$state={name:n.name,url:n.url,params:a},e.$prevState={name:i.name,url:i.url,params:o}}),e.$on("$stateChangeError",function(t,r,n,a,i,o){e.$routing=!1,console.error("Error while switching route to "+r.name),console.error(o)}),e.$on("$stateNotFound",function(t,n,a,i){t.preventDefault(),r.go("errors_missing_route",{unfoundState:n,fromState:{to:a?a.name:"",fromParams:i}}),e.$routing=!1})}]),e.provider("pipState",["$stateProvider","pipAssertProvider",function(e,t){function r(e,r){return t.isNotNull(e,"pipState.redirect: fromState cannot be null"),t.isNotNull(r,"pipState.redirect: toState cannot be null"),n[e]=r,this}var n={};this.redirect=r,this.state=e.state,this.$get=["$state","$timeout","pipAssert",function(e,t,r){function a(a,i,o,u){r.contains(i,"name","$state.redirect: state should contains name prop"),r.isObject(o,"$state.redirect: params should be an object");var l;if(u.$routing=!0,l=n[i.name],_.isFunction(l)&&(l=l(i.name,o,u),_.isNull(l)))throw u.$routing=!1,new Error("Redirected toState cannot be null");return l?(t(function(){a.preventDefault(),e.transitionTo(l,o,{location:"replace"})}),!0):!1}return e.redirect=a,e}]}])}(),function(){"use strict";function e(e,t){function r(t){var r=e.extendPalette("blue",{contrastDefaultColor:"light",contrastDarkColors:void 0});e.definePalette("blue-primary",r);var n=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(33, 150, 243, 1)"});e.definePalette("blue-background",n);var a=e.extendPalette("green",{600:"rgba(0, 200, 83, 1)"});e.definePalette("blue-accent",a),e.theme(t).primaryPalette("blue-primary",{"default":"500","hue-1":"300"}).backgroundPalette("blue-background",{"default":"50","hue-1":"A200","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("blue-accent",{"default":"600"})}function n(t){var r=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(188, 86, 121, 1)",contrastDefaultColor:"dark",contrastLightColors:["A200","A700"]});e.definePalette("pink-background",r);var n=e.extendPalette("pink",{600:"rgba(255, 128, 171, 1)",700:"rgba(188, 86, 121, .54)",900:"rgba(188, 86, 121, 1)",contrastDefaultColor:"light"});e.definePalette("pink-primary",n),e.theme(t).primaryPalette("pink-primary",{"default":"900","hue-1":"700"}).backgroundPalette("pink-background",{"default":"50","hue-1":"A200","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("pink-primary",{"default":"600"})}function a(t){var r=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(255, 152, 0, 1)"});e.definePalette("orange-background",r);var n=e.extendPalette("orange",{800:"rgba(255, 152, 0, 1)",900:"rgba(255, 152, 0, .54);"});e.definePalette("orange-primary",n),e.theme(t).primaryPalette("orange-primary",{"default":"800","hue-1":"900"}).backgroundPalette("orange-background",{"default":"50","hue-1":"A200","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("orange",{"default":"900"})}function i(t){var r=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(255, 112, 67, 1)",contrastLightColors:["600","700","800","900","A200"]});e.definePalette("red-background",r);var n=e.extendPalette("orange",{800:"rgba(255, 112, 67, 1)",900:"rgba(255, 152, 67, .54)",A100:"rgba(255, 171, 64, 1)",contrastLightColors:["800","900","A100"]});e.definePalette("red-primary",n),e.theme(t).primaryPalette("red-primary",{"default":"800","hue-1":"900"}).backgroundPalette("red-background",{"default":"50","hue-1":"A200","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("red-primary",{"default":"A100"})}function o(t){var r=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(76, 175, 80, 1)"
});e.definePalette("green-background",r);var n=e.extendPalette("green",{300:"#9ed4a1",contrastLightColors:["500","300"]});e.definePalette("green-primary",n);var a=e.extendPalette("amber",{contrastLightColors:["A700"]});e.definePalette("green-accent",a),e.theme(t).primaryPalette("green-primary",{"default":"500","hue-1":"300"}).backgroundPalette("green-background",{"default":"50","hue-1":"A200","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("green-accent",{"default":"A700"})}function u(t){var r=e.extendPalette("grey",{700:"rgba(86, 97, 125, 1)",800:"rgba(86, 97, 125, .54)",A100:"rgba(231, 231, 231, 1)"});e.definePalette("grey",r);var n=e.extendPalette("teal",{contrastLightColors:["500","600","700","800","900","A700"]});e.definePalette("teal",n),e.theme(t).primaryPalette("grey",{"default":"700","hue-1":"800"}).backgroundPalette("grey",{"default":"50","hue-1":"700","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("teal",{"default":"A700"})}function l(t){var r=e.extendPalette("grey",{A100:"rgba(231, 231, 231, 1)",A200:"rgba(255, 152, 0, 1)",A400:"#a9b9c0",500:"#607D8B",A700:"#90A4AE",contrastDefaultColor:"dark",contrastLightColors:["300","400","500","600","700","800","900","A700"]});e.definePalette("third-party",r),e.theme(t).primaryPalette("third-party",{"default":"500","hue-1":"A400"}).backgroundPalette("third-party",{"default":"50","hue-1":"500","hue-2":"A700"}).warnPalette("red",{"default":"A200"}).accentPalette("third-party",{"default":"A700"})}t.translations("en",{THEME:"Theme",blue:"Blue",pink:"Pink",amber:"Amber",orange:"Orange",green:"Green",navy:"Navy",grey:"Grey"}),t.translations("ru",{THEME:"Тема",blue:"Голубая",pink:"Розовая",amber:"Янтарная",orange:"Оранжевая",green:"Зеленая",navy:"Сине-серая",grey:"Серая"}),r("default"),r("blue"),n("pink"),a("amber"),i("orange"),o("green"),u("navy"),l("grey"),e.setDefaultTheme("default"),e.alwaysWatchTheme(!0)}function t(e,t,r){try{var n=r.$user&&r.$user.theme?r.$user.theme:e.get("theme");t.initializeTheme(n)}catch(a){t.initializeTheme("blue")}}function r(e,t,r,n,a,i){return{setCurrentTheme:function(n){if(null==n||""===n)throw new Error("Theme is not specified");if(e.get("theme")!=n||r.$theme!=n){if(!(n in t.THEMES))throw new Error("Theme "+n+" is not registered. Please, register it first with $mdThemingProvider");e.set("theme",n),r.$theme=n}},initializeTheme:function(e){if(null==e||""===e)throw new Error("Theme is not specified");if(!(e in t.THEMES))throw new Error("Theme "+e+" is not registered. Please, register it first with $mdThemingProvider");r.$theme=e,$("body").attr("md-theme","{{ $theme }}").addClass("{{ $theme }}")}}}e.$inject=["$mdThemingProvider","pipTranslateProvider"],t.$inject=["localStorageService","pipTheme","$rootScope"],r.$inject=["localStorageService","$mdTheming","$rootScope","$timeout","$state","$stateParams"],angular.module("pipTheme",["ngMaterial"]).config(e).run(t).factory("pipTheme",r)}(),function(){"use strict";var e=angular.module("pipTimer",[]);e.service("pipTimer",["$interval","$rootScope",function(e,t){function r(){return s}function n(){s||(i=e(function(){t.$broadcast("pipAutoPullChanges")},u),o=e(function(){t.$broadcast("pipAutoUpdatePage")},l),s=!0)}function a(){i&&e.cancel(i),o&&e.cancel(o),s=!1}var i,o,u=6e4,l=15e3,s=!1;return{isStarted:r,start:n,stop:a}}])}(),function(){"use strict";var e=angular.module("pipTransactions",["pipTranslate","pipErrors"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{ENTERING:"Entering...",PROCESSING:"Processing...",LOADING:"Loading...",SAVING:"Saving..."}),e.translations("ru",{ENTERING:"Вход в систему...",PROCESSING:"Обрабатывается...",LOADING:"Загружается...",SAVING:"Сохраняется..."})}]),e.factory("pipTransaction",["$rootScope","pipError",function(e,t){function r(t){e.transactions[t]={id:void 0,operation:void 0}}function n(n,a){n=n||"global";var i=t(n),o={error:i,reset:function(){r(),i.reset()},busy:function(){var t=e.transactions[n];return null!=t&&t.id},failed:function(){return!i.empty()},aborted:function(t){var r=e.transactions[n];return _.isNull(r)||r.id!=t},get:function(){return _.isNull(e.transactions[n])&&r(n),e.transactions[n]},id:function(){var t=e.transactions[n];return t?t.id:null},operation:function(){var t=e.transactions[n];return t?t.operation:null},errorMessage:function(){return i.message()},begin:function(t){var r=e.transactions[n];return null!=r&&r.id?null:(r=e.transactions[n]={id:(new Date).getTime(),operation:t||"PROCESSING"},i.reset(),r.id)},abort:function(){var t=e.transactions[n];t&&(t.id=null),i.reset()},end:function(t){t?i.set(t):i.reset();var r=e.transactions[n];null!=r&&(r.id=null)}};return _.isObject(a)&&(a.error=i,a.transaction=o),o}return e.transactions={},n}])}(),function(){"use strict";var e=angular.module("pipTranslate",["LocalStorageModule","pipAssert"]);e.provider("pipTranslate",["pipAssertProvider",function(e){function t(t){return e.isString(t||"","pipTranslateProvider.use or pipTranslateProvider.language: argument should be a string"),null!=t&&(f=t),f}function r(t){return null!=t&&(e.isBoolean(t||"","pipTranslateProvider.persist: argument should be a boolean"),d=t),d}function n(t){return null!=t&&(e.isBoolean(t||"","pipTranslateProvider.setRoot: argument should be a boolean"),g=t),g}function a(t,r){e.isString(t,"pipTranslate.setTranslations or pipTranslateProvider.translations: first argument should be a string"),e.isObject(r,"pipTranslate.setTranslations or pipTranslateProvider.translations: second argument should be an object");var n=m[t]||{};m[t]=_.extend(n,r)}function i(e){if(_.isNull(e)||_.isUndefined(e))return"";var t=m[f]||{};return t[e]||e}function o(t){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateArray: argument should be an array");var r=[],n=m[f]||{};return _.each(t,function(e){var t=e||"";r.push(n[t]||t)}),r}function u(t,r,n){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateSet: first argument should be an array"),e.isString(r||"","pipTranslate.translateSet: second argument should be a string"),e.isString(n||"","pipTranslate.translateSet: third argument should be a string"),r=r||"id",n=n||"name";var a=[],i=m[f]||{};return _.each(t,function(e){var t={},o=e||"";t[r]=o,t[n]=i[o]||o,a.push(t)}),a}function l(t,r,n){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateObjects: first argument should be an array"),e.isString(r||"","pipTranslate.translateObjects: second argument should be a string"),e.isString(n||"","pipTranslate.translateObjects: third argument should be a string"),r=r||"name",n=n||"nameLocal";var a=m[f]||{};return _.each(t,function(e){var t=e,i=t[r]||"";t[n]=a[i]||i}),t}function s(t,r){if(e.isString(r||"","pipTranslate.translateById: second argument should be a string"),e.isString(t||"","pipTranslate.translateById: first argument should be a string"),t=t?t+"_":"",r=(t+r).replace(/ /g,"_").toUpperCase(),null==r)return"";var n=m[f]||{};return n[r]||r}function c(t,r,n,a){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateSetById: first argument should be an array"),e.isString(r||"","pipTranslate.translateSetById: second argument should be a string"),e.isString(n||"","pipTranslate.translateSetById: third argument should be a string"),e.isString(a||"","pipTranslate.translateSetById: forth argument should be a string"),r=r?r.replace(/ /g,"_").toUpperCase():"",n=n||"id",a=a||"name";var i=[],o=m[f]||{};return _.each(t,function(e){var t={},u=e||"";t[n]=u,t[a]=o[r+"_"+u]||u,i.push(t)}),i}function p(t,r,n,a){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateStringsSet: first argument should be an array"),e.isString(r||"","pipTranslate.translateStringsSet: second argument should be a string"),e.isString(n||"","pipTranslate.translateStringsSet: third argument should be a string"),e.isString(a||"","pipTranslate.translateStringsSet: forth argument should be a string"),n=n||"id",a=a||"name",r=r?r.replace(/ /g,"_").toUpperCase()+"_":"";var i=[],o=m[f]||{};return _.each(t,function(e){var t={},u=e||"";t[n]=u,t[a]=o[r+u.replace(/ /g,"_").toUpperCase()]||r+u.replace(/ /g,"_").toUpperCase(),i.push(t)}),i}var f="en",d=!0,g=!0,m={en:{en:"English",ru:"Russian",es:"Spanish",pt:"Portuguese",de:"German",fr:"French"},ru:{en:"Английский",ru:"Русский",es:"Испанский",pt:"Португальский",de:"Немецкий",fr:"Французский"}};this.translations=a,this.language=t,this.use=t,this.persist=r,this.setRoot=n,this.$get=["$rootScope","$timeout","localStorageService","pipAssert",function(e,t,r,n){function m(r,n){r=void 0!==r?!!r:!0,n=void 0!==n?!!n:!0,e.$reset=r,e.$partialReset=n,t(function(){e.$reset=!1,e.$partialReset=!1},0)}return d&&(f=r.get("language")||f),g&&(e.$language=f),{use:function(t,a,i){return n.isString(t||"","pipTranslate.use: argument should be a string"),null!=t&&t!=f&&(f=t,d&&r.set("language",f),g&&(e.$language=f),m(a,i)),f},translations:a,translate:i,translateArray:o,translateSet:u,translateObjects:l,translateById:s,translateSetById:c,translateStringsSet:p}}]}]),e.directive("pipTranslate",["pipTranslate",function(e){return{restrict:"EA",scope:{key1:"@pipTranslate",key2:"@key"},link:function(t,r,n){var a=t.key1||t.key2,i=e.translate(a);r.text(i)}}}]),e.directive("pipTranslateHtml",["pipTranslate",function(e){return{restrict:"EA",scope:{key1:"@pipTranslateHtml",key2:"@key"},link:function(t,r,n){var a=t.key1||t.key2,i=e.translate(a);r.html(i)}}}])}(),function(){"use strict";var e=angular.module("pipUtils.Collections",[]);e.factory("pipCollections",function(){var e={};return e.indexBy=function(e,t,r){if(!e||!e.length)return null;for(var n=0;n<e.length;n++)if(e[n][t]==r)return n;return null},e.findBy=function(e,t,r){if(!e||!e.length)return null;for(var n=0;n<e.length;n++)if(e[n][t]==r)return e[n];return null},e.remove=function(e,t){if(!e||!e.length)return null;for(var r=0;r<e.length;r++)e[r]==t&&(e.splice(r,1),r--)},e.removeBy=function(e,t,r){if(!e||!e.length)return null;for(var n=0;n<e.length;n++)e[n][t]==r&&(e.splice(n,1),n--)},e.replaceBy=function(e,t,r,n){if(!e||!e.length)return null;for(var a=0;a<e.length;a++)if(e[a][t]==r)return void(e[a]=n)},e.difference=function(e,t,r){var n=[];return _.each(e,function(e){var a=_.find(t,function(t){return r(e,t)});null==a&&n.push(e)}),n},e})}(),function(){"use strict";var e=angular.module("pipUtils.Dates",[]);e.factory("pipDates",function(){var e={};return e.addHours=function(e,t){e=_.isDate(e)?e:new Date(e);var r=e.getTime()+36e5*t;return new Date(r)},e.toStartDay=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),e.getDate())},e.toEndDay=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var r=new Date(e.getFullYear(),e.getMonth(),e.getDate());return new Date(r.getTime()+864e5+t)},e.toStartWeek=function(e){e=_.isDate(e)?e:new Date(e);var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()-24*(t-1)*36e5)},e.toEndWeek=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var r=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()+24*(8-r)*36e5+t)},e.toStartMonth=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),1)},e.toEndMonth=function(e,t){e=_.isDate(e)?e:new Date(e);var r=e.getMonth()+1,n=e.getFullYear();return r>11&&(n++,r=0),e=new Date(n,r,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toStartYear=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),0,1)},e.toEndYear=function(e,t){return e=_.isDate(e)?e:new Date(e),e=new Date(e.getFullYear()+1,0,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toUTCDate=function(e,t,r){return new Date(Date.UTC(e,t,r))},e.toUTCDate=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.fromUTCDate=function(e){return null==e&&(e=new Date),new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())},e.toUTCStartWeek=function(e){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())));var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=1!=t?new Date(e.getTime()-24*(t-1)*36e5):e,new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.toUTCEndWeek=function(e,t){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))),t=null!=t?t:0;var r=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=new Date(e.getTime()+24*(8-r)*36e5+t),new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e})}(),function(){"use strict";var e=angular.module("pipUtils.FormErrors",[]);e.factory("pipFormErrors",["$rootScope",function(e){function t(e){return null!=e?_.isEmpty(e.$error)?{hint:!0}:e.$error:void 0}function r(e,t){if(null!=e&&null!=t){if(e.$submitted&&(t.$touched||e.$dirty)||!e.$submitted&&(t.$touched||t.$dirty)){var r=_.isEmpty(t.$error)?{hint:!0}:t.$error;return r}return{hint:!0}}}function n(e,t){e.$setPristine(),e.$setUntouched(),t&&(e.$setDirty(),e.$setSubmitted()),e.$serverError={}}function a(e,t){if(e)if(t&&e[t]&&e[t].$error)e[t].$error={};else{for(var r in e)e[r]&&e[r].$error&&(e[r].$error={});e&&e.$error&&(e.$error={})}}function i(e,t,r){if(null!=t){e.$serverError=e.$serverError||{};var n=t.code||(t.data||{}).code||null;if(!n&&t.status&&(n=t.status),n){var a="ERROR_"+n,i=r?r[n]:null;if(i&&e[i]&&e[i].$setValidity)return void e[i].$setValidity(a,!1);if("form"==i)return void(e.$serverError[a]=!0)}if(t.data&&t.data.message)return e.$serverError.ERROR_UNKNOWN=t.data.message,void o(t);if(t.message)return e.$serverError.ERROR_UNKNOWN=t.message,void o(t);if(t.name)return e.$serverError.ERROR_UNKNOWN=t.name,void o(t);e.$serverError.ERROR_UNKNOWN=t,o(t)}}function o(t){e.$emit("pipUnhandledInternalError",{error:t})}return{errorsWithHint:t,touchedErrorsWithHint:r,resetFormErrors:n,setFormError:i,resetFieldsErrors:a}}])}(),function(){"use strict";var e=angular.module("pipUtils.General",["pipState","pipAssert"]);e.factory("pipUtils",["$rootScope","$window","$state","pipAssert",function(e,t,r,n){function a(e,t){if(1>t)return"";for(var r="";t>0;)1&t&&(r+=e),t>>=1,e+=e;return r}function i(e,t,r,n){if(!e||!e.length)return null;for(var a=0;a<e.length;a++)if(e[a][t]==r)return void(e[a]=n)}function o(e,t){if(!e||""==e)return"";var r=e.indexOf("\n");return r=r>=0?r:e.length,r=t>r?e.length:t,e.substring(0,r)}function l(e){if(null==e)return 0;for(var t=0,r=0;r<e.length;r++)t+=e.charCodeAt(r);return t}function s(e){return null==e?"":""+e}function c(e){var t=new RegExp("^[0-9a-fA-F]{24}$");return t.test(e)}function p(e,t){return null==e&&null==t?!0:null==e||null==t?!1:e.toString()==t.toString()}function f(e,t){return null==e&&null==t?!1:null==e||null==t?!0:e.toString()!=t.toString()}function d(e,t){return _.some(e,function(e){return p(e,t)})}function g(e,t,r,n){return _.isObject(t)&&"undefined"==typeof n&&(n=r,r=t,t=n),r[n]||"number"==typeof r[n]&&r[n]%1==0?(e[t]=r[n],!0):!1}function m(e,t,r){var n=e[t],a=e[r];n?e[r]=n:delete e[r],a?e[t]=a:delete e[t]}function h(e){return null==e?!1:e?(e=e.toString().toLowerCase(),"1"==e||"true"==e):!1}function v(e){return _.map(e,function(e){return e?e.toString():0})}function D(){return Math.random().toString(36).substr(2,10).toUpperCase()}function b(){t.history.back()}function T(a,i,o){if(n.isDef(a,"pipUtils.goBack: first argument should be defined"),n.isDef(i,"pipUtils.goBack: second argument should be defined"),n.isDef(o,"pipUtils.goBack: third argument should be defined"),n.isObject(a,"pipUtils.goBack: first argument should be an object"),n.isString(i,"pipUtils.goBack: second argument should a string"),n.isString(o,"pipUtils.goBack: third argument should a string"),e.$prevState&&e.$prevState.name){var u=_.cloneDeep(e.$prevState);u.params[i]=a.id,u.params[o]=a,r.go(u.name,u.params)}else t.history.back()}function S(e,t,r){e&&t&&(void 0==r&&(r=300),setTimeout(function(){if($(t).position()){var n=Math.abs($(e).scrollTop()-$(t).position().top);if(!(20>n)){var a=$(e).scrollTop()+($(t).position().top-20);r>0&&$(e).animate({scrollTop:a+"px"},r)}}},100))}function E(){var e,r=t.navigator.userAgent,n=function(){return r.search(/Edge/)>-1?"edge":r.search(/MSIE/)>-1?"ie":r.search(/Trident/)>-1?"ie11":r.search(/Firefox/)>-1?"firefox":r.search(/Opera/)>-1?"opera":r.search(/OPR/)>-1?"operaWebkit":r.search(/YaBrowser/)>-1?"yabrowser":r.search(/Chrome/)>-1?"chrome":r.search(/Safari/)>-1?"safari":r.search(/Maxthon/)>-1?"maxthon":void 0}();switch(n){case"edge":e=r.split("Edge")[1].split("/")[1];break;case"ie":e=r.split("MSIE ")[1].split(";")[0];break;case"ie11":n="ie",e=r.split("; rv:")[1].split(")")[0];break;case"firefox":e=r.split("Firefox/")[1];break;case"opera":e=r.split("Version/")[1];break;case"operaWebkit":n="opera",e=r.split("OPR/")[1];break;case"yabrowser":e=r.split("YaBrowser/")[1].split(" ")[0];break;case"chrome":e=r.split("Chrome/")[1].split(" ")[0];break;case"safari":e=r.split("Version/")[1].split(" ")[0];break;case"maxthon":e=r.split("Maxthon/")[1]}var a="desktop";/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(r.toLowerCase())&&(a="mobile");var i;try{var o=(/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(r.toLowerCase())||[u])[0].replace("sunos","solaris"),l=/(android)/.exec(r.toLowerCase())||"";i=!l||"android"!=l&&"android"!=l[0]?o:"android"}catch(s){i="unknown"}var c;try{c={platform:a,browser:n,versionFull:e,versionShort:e.split(".")[0],os:i}}catch(s){c={platform:a,browser:"unknown",versionFull:"unknown",versionShort:"unknown",os:"unknown"}}return c}function y(e){e||(e={edge:11,ie:11,firefox:43,opera:35,chrome:47});var t=E();return t&&t.browser&&e[t.browser]&&t.versionShort>=e[t.browser],!0}var M=Object.prototype.toString,O=function A(){function e(e){return M.call(e).slice(8,-1).toLowerCase()}var t=a,r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.format=function(r,n){var a,i,o,u,l,s,c,p=1,f=r.length,d="",g=[];for(i=0;f>i;i++)if(d=e(r[i]),"string"===d)g.push(r[i]);else if("array"===d){if(u=r[i],u[2])for(a=n[p],o=0;o<u[2].length;o++){if(!a.hasOwnProperty(u[2][o]))throw new Error(A('[_.sprintf] property "%s" does not exist',u[2][o]));a=a[u[2][o]]}else a=u[1]?n[u[1]]:n[p++];if(/[^s]/.test(u[8])&&"number"!=e(a))throw new Error(A("[_.sprintf] expecting number but found %s",e(a)));switch(u[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=u[7]?a.toExponential(u[7]):a.toExponential();break;case"f":a=u[7]?parseFloat(a).toFixed(u[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&u[7]?a.substring(0,u[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(u[8])&&u[3]&&a>=0?"+"+a:a,s=u[4]?"0"==u[4]?"0":u[4].charAt(1):" ",c=u[6]-String(a).length,l=u[6]?t(s,c):"",g.push(u[5]?a+l:l+a)}return g.join("")},r.cache={},r.parse=function(e){for(var t=e,r=[],n=[],a=0;t;){if(null!==(r=/^[^\x25]+/.exec(t)))n.push(r[0]);else if(null!==(r=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(r=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(r[2]){a|=1;var i=[],o=r[2],u=[];if(null===(u=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[_.sprintf] huh?");for(i.push(u[1]);""!==(o=o.substring(u[0].length));)if(null!==(u=/^\.([a-z_][a-z_\d]*)/i.exec(o)))i.push(u[1]);else{if(null===(u=/^\[(\d+)\]/.exec(o)))throw new Error("[_.sprintf] huh?");i.push(u[1])}r[2]=i}else a|=2;if(3===a)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");n.push(r)}t=t.substring(r[0].length)}return n},r}();return{copyProperty:g,copy:g,swapProperties:m,swap:m,convertToBoolean:h,toBoolean:h,toBool:h,convertObjectIdsToString:v,OidToString:v,generateVerificationCode:D,vercode:D,goBack:b,goBackAndSelect:T,scrollTo:S,equalObjectIds:p,eqOid:p,notEqualObjectIds:f,neqOid:f,containsObjectId:d,hasOid:d,isObjectId:c,sampleLine:o,hashCode:l,makeString:s,getBrowser:E,checkSupported:y,sprintf:O,replaceBy:i}}])}(),function(){"use strict";var e=angular.module("pipUtils.Strings",[]);e.factory("pipStrings",function(){var e={};return e.sampleLine=function(e,t){if(!e||""==e)return"";var r=e.indexOf("\n");return r=r>=0?r:e.length,r=t>r?e.length:t,e.substring(0,r)},e.hashCode=function(e){if(null==e)return 0;for(var t=0,r=0;r<e.length;r++)t+=e.charCodeAt(r);return t},e})}(),function(){"use strict";var e=angular.module("pipUtils.Tags",[]);e.factory("pipTags",function(){var e={},t=/#\w+/g,r=function(e){return e?_.trim(e.replace(/(_|#)+/g," ")):null};e.normalizeTag=r;var n=function(e){return e?e.replace(/( |_|#)/g,"").toLowerCase():null};e.compressTag=n;var a=function(e,t){return null==e&&null==t?!0:null==e||null==t?!1:n(e)==n(t)};e.equalTags=a;var i=function(e){return _.isString(e)&&(e=e.split(/( |,|;)+/)),e=_.map(e,function(e){return r(e)})};e.normalizeTags=i;var o=function(e){return _.isString(e)&&(e=e.split(/( |,|;)+/)),e=_.map(e,function(e){return n(e)})};e.compressTags=o;var u=function(e,r){var n=i(e.tags);return _.each(r,function(r){var a=e[r]||"";if(""!=a){var o=a.match(t);n=n.concat(i(o))}}),_.uniq(n)};return e.extractTags=u,e})}(),function(){"use strict";angular.module("pipUtils",["pipUtils.General","pipUtils.Strings","pipUtils.Dates","pipUtils.Tags","pipUtils.Collections","pipUtils.FormErrors"])}();
!function(){"use strict";var e=angular.module("pipDataCache",["pipDataModel"]);e.provider("pipDataCache",function(){function e(e){return e&&(t=e),t}var t=3e5,n={};this.timeout=e,this.$get=["$q","pipDataModel",function(r,i){function a(e){var t={};null!=e&&(t.item=e.item,t.party_id=e.party_id,t.search=e.search,t.paging=e.paging,t.take=e.take,t.skip=e.skip),t=angular.toJson(t);var n,r,i,a=0;if(null==t||0===t.length)return a;for(n=0,i=t.length;i>n;n++)r=t.charCodeAt(n),a=(a<<5)-a+r,a|=0;return a}function o(e,t){var n=a(t);return e+(0!=n?"_"+n:"")}function s(e){if(null==e)n={},console.log("****** Invalidated cache");else for(var t in n)(t==e||t.startsWith(e+"_"))&&(console.log("****** Invalidated cache "+t),delete n[t])}function u(e,r){if(null==e)throw new Error("name cannot be null");if(""==e)throw new Error("name cannot be empty");var i=o(e,r),a=n[i];return null==a?null:a.expire&&_.now()-a.expire>t?(delete n[i],null):a.data}function c(e,t,r){if(null==e)throw new Error("name cannot be null");if(""==e)throw new Error("name cannot be empty");n[o(e,r)]={expire:_.now(),data:t}}function p(e,t,r){if(null==e)throw new Error("name cannot be null");if(""==e)throw new Error("name cannot be empty");n[o(e,r)]={expire:null,data:t}}function d(e,t){if(null==e)throw new Error("name cannot be null");if(""==e)throw new Error("name cannot be empty");delete n[o(e,t)]}function E(e,t,n){if(null==e)throw new Error("name cannot be null");if(null!=t){var r=u(e,n);if(null!=r){for(var i=!1,a=0;a<r.length;a++)if(r[a].id==t.id)return r[a]=t,void(i=!0);i||r.push(t),c(e,r,n)}}}function l(e,t,n){if(null==e)throw new Error("params cannot be null");var a=e.cache||e.resource,o=e.filter,s=!!e.force,p=s?null:u(a,e),d=r.defer();return p?(console.log("***** Loaded from cache "+a,p),o&&(p=o(p)),t&&t(p),d.resolve(p),d.promise):(i[e.singleResult?"readOne":"read"](e,function(n){e.singleResult?E(a,n,e):c(a,n,e),o&&(n=o(n)),d.resolve(n),console.log("***** Loaded from server "+a,n),t&&t(n)},function(e){console.log("***** FAILED to load from server "+a),d.reject(e),n&&n(e)}),d.promise)}function T(e,t){if(null==e)throw new Error("name cannot be null");if(null!=t)for(var r in n)if(r==e||r.startsWith(e+"_")){var i=n[r].data;if(angular.isArray(i))for(var a=0;a<i.length;a++)i[a].id==t.id&&(i.splice(a,1),a--)}}function f(e,t,n){return function(r){T(e,t),n&&n(r)}}function m(e,t,r){return function(t){for(var i in n)if(i==e||i.startsWith(e+"_")){var a=n[i].data;if(angular.isArray(a))for(var o=0;o<a.length;o++)a[o].id==t.id&&(a[o]=t)}r&&r(t)}}function S(e,t,n){return function(r){t&&t.notClearedCache||s(e),n&&n(r)}}return{timeout:e,clear:s,retrieve:u,retrieveOrLoad:l,store:c,storePermanent:p,remove:d,removeItem:T,removeDecorator:f,addDecorator:S,updateDecorator:m}}]})}(),function(){"use strict";var e=angular.module("pipSessionCache",["pipCore","pipRest","pipDataCache"]);e.run(["$rootScope","pipSessionCache",function(e,t){e.$on("pipSessionOpened",t.init),e.$on("pipSessionClosed",t.clear)}]),e.service("pipSessionCache",["$rootScope","$stateParams","$q","pipTranslate","pipRest","localStorageService","pipAccess","pipEnums","pipSession","pipDataCache",function(e,t,n,r,i,a,o,s,u,c){function p(t,n){if(null==n)throw new Error("Unexpected error: issues in openning session");d(),n.serverUrl&&(e.$serverUrl=n.serverUrl),T(n.user,null)}function d(){c.clear(),delete e.$user,delete e.$party,delete e.$serverUrl,delete e.$connection,delete e.$settings}function E(t,n){t=t||c.retrieve("user"),n=n||c.retrieve("party"),null!=t&&(t=null==n?o.asOwner(t):t.id==n.id?o.asOwner(t):o.toParty(t,n),c.storePermanent("user",t),e.$user=t)}function l(t){if(t){var n=t.theme||"blue";t&&e.$party&&(n=e.$party.id==t.id?t.theme:"navy"),e.$theme=n,a.set("theme",n)}}function T(t){null!=t&&(c.storePermanent("user",t),e.$user=t,l(t),r.use(t.language,!1,!0),E(t,null))}function f(e,t){if(!u.opened())throw new Error("User is not authenticated.");var r=u.userId(),a=c.retrieve("user");if(a){if(a.id!=r)throw new Error("Unexpected error: issues in opening session");e&&e(a);var o=n.defer();return o.resolve(a),o.promise}return i.users().get({id:r},function(t){t.id!=r,T(t),e&&e(use)},t).$promise}function m(t,r,a){if(!u.opened())throw new Error("User is not authenticated.");var o=u.userId(),s=t.party_id||o,p=c.retrieve("party");if(p&&p.id==s){e.$party=p,l(e.$user),r&&r(p);var d=n.defer();return d.resolve(p),d.promise}return i.parties().get({id:s},function(t){E(null,t),c.storePermanent("party",t),e.$party=t,l(e.$user),r&&r(t)},a).$promise}function S(t,r,a){if(!u.opened())throw new Error("User is not authenticated.");var o=u.userId(),p=t.party_id||o,d=c.retrieve("connection");if(!d||d.party_id==o&&d.to_party_id==p||(d=null,c.remove("connection"),delete e.$connection),o==p){r&&r(d);var E=n.defer();return E.resolve(d),E.promise}return i.connections().query({party_id:o,to_party_id:p,accept:s.ACCEPTANCE.ACCEPTED},function(t){d=t&&t.length>0?t[0]:null,c.storePermanent("connection",d),e.$connection=d,r&&r(d)},a).$promise}function g(t,r){if(!u.opened())throw new Error("User is not authenticated.");var a=u.userId(),o=c.retrieve("settings_"+a);if(o){t&&t(o);var s=n.defer();return s.resolve(o),s.promise}return i.partySettings().get({party_id:a},function(n){n=n||{},c.storePermanent("settings_"+a,n),e.$settings=n,t&&t(n)},r).$promise}function v(t,n){if(null!=t){var r=u.userId(),i=c.retrieve("settings_"+r);i&&(i=_.extend(i,t),c.storePermanent("settings_"+r,i),e.$settings=i),n&&n(t)}}return{init:p,clear:d,readUser:f,readParty:m,readConnection:S,readSettings:g,onSettingsUpdate:v}}])}(),function(){"use strict";var e=angular.module("pipTagsCache",["pipUtils","pipDataCache"]);e.service("pipTagsCache",["pipTags","pipDataCache",function(e,t){function n(n,r){var i=r?e.extractTags(r):[];if(0!=i.length){var a="partyTags";n&&null!==n.party_id&&void 0!==n.party_id?a=a+"_"+n.party_id:n&&n.item&&null!==n.item.party_id&&void 0!==n.item.party_id&&(a=a+"_"+n.item.party_id);var o=t.retrieve(a);o&&(_.each(i,function(t){var n=_.find(o.tags,function(n){return e.equalTags(n.tag,t)});n?(n.tag=t,n.count=n.count+1,n.used=new Date):(o.tags||(o.tags=[]),o.tags.push({tag:t,count:1,used:new Date}))}),t.store(a,o))}}function r(e,t){return function(r){n(e,r),t&&t(r)}}function i(e,n,r){return e.resource="partyTags",e.singleResult=!0,t.retrieveOrLoad(e,n,r)}function a(e,t){return r(e,t)}return{readTags:i,onTagsUpdate:a,tagsUpdateDecorator:r}}])}(),function(){"use strict";var e=angular.module("pipTipsCache",["pipTipsData"]);e.service("pipTipsCache",["pipEnums","pipDataCache","pipTagsCache",function(e,t,n){function r(e,n,r){return e=e||{},e.resource="tips",e.item=e.item||{},t.retrieveOrLoad(e,n,r)}function i(e,r){return t.addDecorator("tips",e,n.tagsUpdateDecorator(e,r))}function a(e,r){return t.updateDecorator("tips",e,n.tagsUpdateDecorator(e,r))}function o(e,n){return t.removeDecorator("tips",e,n)}return{readTips:r,onTipCreate:i,onTipUpdate:a,onTipDelete:o}}])}(),function(){"use strict";var e=angular.module("pipRest.Access",["pipUtils","pipRest.Enums"]);e.factory("pipAccess",["pipUtils","pipEnums",function(e,t){function n(e){var n=_.defaults({id:e.id||e._id,party_id:null,party_name:null,type:null,owner:!1,manager:!1,contributor:!1,share_level:t.SHARE_LEVEL.WORLD},e);return delete n._id,n}function r(e){return e.manager=e.manager||e.owner,e.contributor=e.contributor||e.manager,e.contributor&&(e.share_level=t.SHARE_LEVEL.PRIVATE),e}function i(e,n){return e.party_id=n.party_id,e.party_name=n.party_name,e.type=n.type,e.owner=!!n.owner,e.manager=!!n.manager,e.contributor=!!n.contributor,e.share_level=n.share_level||t.SHARE_LEVEL.WORLD,n.party&&(e.party_id=n.party.id||n.party._id,e.party_name=n.party.name),r(e)}function a(e){if(null!=e){var r=n(e);return r.party_id=r.id,r.party_name=r.name,r.type=null,r.owner=!0,r.manager=!0,r.contributor=!0,r.share_level=t.SHARE_LEVEL.PRIVATE,r}}function o(t,i){if(null!=t){if(null==i)return a(t);var o=t.id||t._id,s=i.id||i._id||i,u=i.name||t.name;if(o==s)return a(t);var c=n(t);return c.party_id=s,c.party_name=u,_.each(c.party_access,function(t){e.equalObjectIds(s,t.party_id)&&(c.party_name=t.party_name,c.type=t.type,c.manager=c.manager||t.manager,c.contributor=c.contributor||t.contributor,c.share_level=Math.max(c.share_level,t.share_level))}),r(c)}}function s(e,t){if(null!=e){var r=n(e);return t&&i(r,t),r}}function u(e,t,n){var r=o(e,t);return n&&i(r,n),r}return{asOwner:a,toParty:o,override:s,toPartyWithOverride:u}}])}(),function(){"use strict";var e=angular.module("pipRest.State",["pipState","pipRest.Session","pipRest.Access","pipSessionCache"]);e.config(["$locationProvider","$httpProvider",function(e,t){t.interceptors.push("pipAuthHttpResponseInterceptor")}]),e.run(["$rootScope","pipState","pipSession","pipAuthState",function(e,t,n,r){function i(i,a,o,s,u){if(!r.redirect(i,a,o,e)){if((a.auth||void 0===a.auth)&&!n.opened()){i.preventDefault();var c=t.href(a.name,o);return c.length>0&&"#"==c[0]&&(c=c.substring(1)),void r.goToSignin({redirect_to:c,toState:a,toParams:o})}return a.name==r.signoutState()?(i.preventDefault(),n.signout(),void r.goToUnauthorized({})):a.name==r.unauthorizedState()&&n.opened()?(i.preventDefault(),void r.goToAuthorized({})):void 0}}function a(e,t){n.close(),r.goToSignin(t)}function o(e,t){r.goToErrors("errors_maintenance",t)}function s(e,t){r.goToErrors("errors_no_connection",t)}function u(e,t){r.goToErrors("errors_missing_route",t)}function c(e,t){r.goToErrors("errors_unknown",t)}e.$on("$stateChangeStart",i),e.$on("pipUnauthorizedRedirect",a),e.$on("pipMaintenanceError",o),e.$on("pipNoConnectionError",s),e.$on("pipMissingRouteError",u),e.$on("pipUnknownError",c)}]),e.factory("pipAuthHttpResponseInterceptor",["$q","$location","$rootScope",function(e,t,n){return{response:function(t){return 401===t.status&&console.error("Response 401"),t||e.when(t)},responseError:function(r){var i=n.$state&&n.$state.name?n.$state.name:null,a=n.$state&&n.$state.params?n.$state.params:null;switch(r.status){case 401:case 440:console.error("Response Error 401",r),n.$emit("pipUnauthorizedRedirect",{redirect_to:i&&a&&a.redirect_to?"":t.url(),toState:i,toParams:a});break;case 503:n.$emit("pipMaintenanceError",{error:r}),console.error("errors_maintenance",r);break;case-1:n.$user&&n.$party||n.$emit("pipNoConnectionError",{error:r}),console.error("errors_no_connection",r);break;default:console.error("errors_unknown",r)}return e.reject(r)}}}]),e.provider("pipAuthState",["pipStateProvider",function(e){function t(e){return e&&(p=e),p}function n(e){return e&&(d=e),d}function r(e){return e&&(E=e),E}function i(e){return e&&(l=e),l}function a(t,n){if(null==t)throw new Error("stateName cannot be null");if(null==n)throw new Error("stateConfig cannot be null");return(n.auth||n.authenticate)&&(n.resolve=n.resolve||{},n.resolve.user=o,n.resolve.party=s,n.resolve.connection=u,n.resolve.setting=c),e.state(t,n),this}function o(e){return e.readUser()}function s(e,t){return e.readParty(t)}function u(e,t){return e.readConnection(t)}function c(e){return e.readSettings()}o.$inject=["pipSessionCache"],s.$inject=["pipSessionCache","$stateParams"],u.$inject=["pipSessionCache","$stateParams"],c.$inject=["pipSessionCache"];var p=null,d=null,E="/",l="/";this.signinState=t,this.signoutState=n,this.authorizedState=r,this.unauthorizedState=i,this.redirect=e.redirect,this.state=a,this.$get=["pipState",function(e){return e.signinState=function(){return p},e.signoutState=function(){return d},e.authorizedState=function(){return E},e.unauthorizedState=function(){return l},e.goToErrors=function(t,n){if(null==t)throw new Error("Error state was not defined");e.go(t,n)},e.goToSignin=function(t){if(null==p)throw new Error("Signin state was not defined");e.go(p,t)},e.goToSignout=function(t){if(null==d)throw new Error("Signout state was not defined");e.go(d,t)},e.goToAuthorized=function(t){if(null==E)throw new Error("Authorized state was not defined");e.go(E,t)},e.goToUnauthorized=function(t){if(null==l)throw new Error("Unauthorized state was not defined");e.go(l,t)},e}]}])}(),function(){"use strict";var e=angular.module("pipRest.Enums",[]);e.factory("pipEnums",function(){function e(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}var t={};return t.SHARE_LEVEL={WORLD:0,OUTER:1,INNER:2,PRIVATE:3},t.URGENCY={LOW:1,NORMAL:500,HIGH:1e3,MIN:0,MAX:1e3},t.URGENCIES=e(t.URGENCY),t.IMPORTANCE={LOW:1,NORMAL:500,HIGH:1e3,MIN:0,MAX:1e3},t.IMPORTANCES=e(t.IMPORTANCE),t.CONFIDENTIALITY={PUBLIC:0,SENSITIVE:1,CLASSIFIED:2,SECRET:3},t.CONFIDENTIALITIES=e(t.CONFIDENTIALITY),t.LEVEL={NONE:0,LOW:1,LOW_MEDIUM:250,MEDIUM:500,MEDIUM_HIGH:750,HIGH:1e3,MIN:0,MAX:1e3},t.LANGUAGE={ENGLISH:"en",SPANISH:"es",PORTUGUESE:"pt",FRENCH:"fr",GERMAN:"de",RUSSIAN:"ru"},t.LANGUAGES=e(t.LANGUAGE),t.STAT_TYPE={DAILY:"daily",MONTHLY:"monthly",YEARLY:"yearly",TOTAL:"total"},t.STAT_TYPES=e(t.STAT_TYPE),t.STAT_BATCH_OPERATION={RECORD_SYSTEM_STATS:"record system stats",RECORD_PARTY_STATS:"record party stats"},t.SERVER_TYPE={REALTIME_DB:"r/t db master",HISTORIAN_DB:"db slave",ANALYTICS:"analytics",BUSINESS_LOGIC:"business logic",REST_API:"rest api",STATIC_CONTENT:"static content",BACKUP_STORAGE:"backup storage"},t.SERVER_TYPES=e(t.SERVER_TYPE),t.SYSTEM_LOG_TYPE={INFO:"info",STOP:"stop",START:"start",RESTART:"restart",UPGRADE:"upgrade",MAINTENANCE:"maintenance",WARNING:"warning",ERROR:"error"},t.SYSTEM_LOG_TYPES=e(t.SYSTEM_LOG_TYPE),t.ACTIVITY_TYPE={SIGNUP:"signup",SIGNIN:"signin",PASSWORD_CHANGED:"password changed",PWD_RECOVERED:"pwd recovered",EMAIL_VERIFIED:"email verified",SETTINGS_CHANGED:"settings changed",PARTNERED:"partnered",TEAMED_UP:"teamed up",FOLLOWED:"followed",DISCONNECTED:"disconnected",CREATED:"created",UPDATED:"updated",DELETED:"deleted",ACCEPTED:"accepted",REJECTED:"rejected",JOINED:"joined",COMPLETED:"completed",CANCELED:"canceled",PROGRESS:"progress",POSTED:"posted",BUZZED:"buzzed",COMMENTED:"commented",CHEERED:"cheered",BOOED:"booed"},t.ACTIVITY_TYPES=e(t.ACTIVITY_TYPE),t.REFERENCE_TYPE={PARTY:"party",CONNECTION:"connection",CONTACT:"contact",MESSAGE:"message",NOTE:"note",AREA:"area",GOAL:"goal",EVENT:"event",VISION:"vision",COLLAGE:"collage",POST:"post",SUPPORT_CASE:"support case",ANNOUNCE:"announce",IMAGE_SET:"image set",FEEDBACK:"feedback",GUIDE:"guide"},t.REFERENCE_TYPES=e(t.REFERENCE_TYPE),t.CONTENT_TYPE={TEXT:"text",CHECKLIST:"checklist",LOCATION:"location",TIME:"time",PICTURES:"pictures",DOCUMENTS:"documents"},t.CONTENT_TYPES=e(t.CONTENT_TYPE),t.PARTY_TYPE={PERSON:"person",TEAM:"team",AGENT:"agent"},t.PARTY_TYPES=e(t.PARTY_TYPE),t.GENDER={MALE:"male",FEMALE:"female",NOT_SPECIFIED:"n/s"},t.GENDERS=e(t.GENDER),t.VISION_TYPE={OVERALL:"overall",ROLE:"role",MODEL:"model",TIME:"time"},t.VISION_TYPES=e(t.VISION_TYPE),t.AREA_TYPE={CATEGORY:"category",AREA:"area"},t.AREA_TYPES=e(t.AREA_TYPE),t.GOAL_TYPE={GOAL:"goal",OBJECTIVE:"objective",DREAM:"dream",ACCOMPLISHMENT:"accomplishment",TASK:"task",ROUTINE:"routine"},t.GOAL_TYPES=e(t.GOAL_TYPE),t.PROCESS_NODE={START:"start",END:"end",EVENT:"event",AWAIT:"await",DECISION:"decision",ACTIVITY:"activity"},t.PROCESS_NODES=e(t.PROCESS_NODE),t.CALCULATION_METHOD={LAST_VALUE:"last value",SUM:"sum",MAX:"max",MIN:"min",AVERAGE:"average"},t.CALCULATION_METHODS=e(t.CALCULATION_METHOD),t.EXECUTION_STATUS={NEW:"new",ASSIGNED:"assigned",IN_PROGRESS:"in progress",VERIFYING:"verifying",ON_HOLD:"on hold",CANCELED:"canceled",COMPLETED:"completed"},t.EXECUTION_STATUSES=e(t.EXECUTION_STATUS),t.CONTRIBUTOR_ROLE={UNDEFINED:"undefined",RESPONSIBLE:"responsible",ACCOUNTABLE:"accountable",CONSULTED:"consulted",INFORMED:"informed"},t.CONSTRIBUTOR_ROLES=e(t.CONTRIBUTOR_ROLE),t.ACCEPTANCE={JOINED:"joined",INVITED:"invited",ACCEPTED:"accepted"},t.ACCEPTANCES=e(t.ACCEPTANCE),t.ACCEPT_ACTION={INVITE:"invite",JOIN:"join",ACCEPT:"accept",REJECT:"reject"},t.ACCEPT_ACTIONS=e(t.ACCEPT_ACTION),t.JOIN_METHOD={INVITE:"invite",APPROVE:"approve",OPEN:"open"},t.JOIN_METHODS=e(t.JOIN_METHOD),t.SKILL_LEVEL={NOVICE:"novice",INTERMEDIATE:"intermediate",ADVANCED:"advanced",EXPERT:"expert"},t.SKILL_LEVELS=e(t.SKILL_LEVEL),t.FEEDBACK_TYPE={SUPPORT:"support",TEAM:"team",MEETUP:"meetup",COPYRIGHT:"copyright",BUSINESS:"business",ADVERTISEMENT:"ad"},t.FEEDBACK_TYPES=e(t.FEEDBACK_TYPE),t.NOTE_CATEGORY={GENERAL:"general",UNFINISHED:"unfinished",ULTIMATE_TODO:"ultimate todo"},t.NOTE_CATEGORIES=e(t.NOTE_CATEGORY),t.CONNECTION_TYPE={PARTNER:"partner",MEMBER:"member",FOLLOW:"follow",AUTOMATION:"automation"},t.CONNECTION_TYPES=e(t.CONNECTION_TYPE),t.EVENT_TYPE={INSTANCE:"instance",RECURRENCE:"recurrence",AUTO_INSTANCE:"auto",TIME_ENTRY:"time entry"},t.EVENT_TYPES=e(t.EVENT_TYPE),t.EVENT_CATEGORY={DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",YEARLY:"yearly"},t.EVENT_CATEGORIES=e(t.EVENT_CATEGORY),t.COMMENT_TYPE={BUZZ:"buzz",CHEER:"cheer",BOO:"boo",COMMENT:"comment"},t.COMMENT_TYPES=e(t.COMMENT_TYPE),t.POST_TYPE={INFO:"info",QUESTION:"question",ISSUE:"issue",REPORT:"report",FORECAST:"forecast"},t.POST_TYPES=e(t.POST_TYPE),t.MESSAGE_TYPE={REGULAR:"regular",EMAIL:"email",INVITATION:"invitation"},t.MESSAGE_TYPES=e(t.MESSAGE_TYPE),t.NOTIFICATION_TYPE={GREETING:"greeting",MESSAGE:"message",PARTNER_INVITE:"partner invite",PARTNER_RESPONSE_ACCEPTED:"partner response accepted",PARTNER_RESPONSE_REJECTED:"partner response rejected",PARTNER_JOINED:"partner joined",MEMBER_INVITE:"member invite",MEMBER_REQUEST:"member request",MEMBER_RESPONSE_ACCEPTED:"member response accepted",MEMBER_RESPONSE_REJECTED:"member response rejected",MEMBER_JOINED:"member joined",FOLLOWER_JOINED:"follower joined",ENTITY_REQUEST:"entity request",ENTITY_REQUEST_ACCEPTED:"entity request accepted",ENTITY_REQUEST_REJECTED:"entity request rejected",ENTITY_INVITE:"entity invite",ENTITY_INVITE_ACCEPTED:"entity invite accepted",ENTITY_INVITE_REJECTED:"entity invite rejected",ENTITY_JOINED:"entity joined",VERIFY_EMAIL:"verify email",COMPLETE_PROFILE:"complete profile"},t.NOTIFICATION_TYPES=e(t.NOTIFICATION_TYPE),t.NOTIFICATION_BATCH_OPERATION={CREATE:"create",REPLY:"reply",CLOSE:"close",DELETE:"delete"},t.SUPPORT_CASE_CATEGORY={ACCOUNT:"account",BILLING:"billing",TECHNICAL:"technical",GENERAL:"general"},t.SUPPORT_CASE_CATEGORIES=e(t.SUPPORT_CASE_CATEGORY),t.ANNOUNCE_TYPE={APP:"app",EMAIL:"email",APP_AND_EMAIL:"app and email"},t.ANNOUNCE_TYPES=e(t.ANNOUNCE_TYPE),t.ANNOUNCE_CATEGORY={GENERAL:"general",MAINTENANCE:"maintenance",NEW_RELEASE:"new release",SURVEY:"survey"},t.ANNOUNCE_CATEGORIES=e(t.ANNOUNCE_CATEGORY),t.GUIDE_TYPE={INTRO:"intro",TOPIC:"topic",CONTEXT:"context",TIP:"tip",NEW_RELEASE:"new release"},t.GUIDE_TYPES=e(t.GUIDE_TYPE),t.EMAIL_TYPE={HOME:"home",WORK:"work",OTHER:"other"},t.EMAIL_TYPES=e(t.EMAIL_TYPE),t.ADDRESS_TYPE={HOME:"home",WORK:"work",OTHER:"other"},t.ADDRESS_TYPES=e(t.ADDRESS_TYPE),t.ADDRESS_TYPE={HOME:"home",WORK:"work",OTHER:"other"},t.ADDRESS_TYPES=e(t.ADDRESS_TYPE),t.PHONE_TYPE={MOBILE:"mobile",WORK:"work",HOME:"home",MAIN:"main",WORK_FAX:"work fax",HOME_FAX:"home fax",OTHER:"other"},t.PHONE_TYPES=e(t.PHONE_TYPE),t.MESSANGER_TYPE={SKYPE:"skype",GOOGLE_TALK:"google talk",AIM:"aim",YAHOO:"yahoo",QQ:"qq",MSN:"msn",ICQ:"icq",JABBER:"jabber",OTHER:"other"},t.MESSANGER_TYPES=e(t.MESSANGER_TYPE),t.WEB_ADDRESS_TYPE={PROFILE:"profile",BLOG:"blog",HOME_PAGE:"home page",WORK:"work",PORTFOLIO:"portfolio",OTHER:"other"},t.WEB_ADDRESS_TYPES=e(t.WEB_ADDRESS_TYPE),t.DASHBOARD_TILE_SIZE={SMALL:"small",WIDE:"wide",LARGE:"large"},t.DASHBOARD_TILE_SIZES=e(t.DASHBOARD_TILE_SIZE),t})}(),function(){"use strict";var e=angular.module("pipRest",["ngResource","pipRest.Enums","pipRest.Access","pipRest.Session","pipRest.State"]);e.provider("pipRest",["$httpProvider",function(e){function t(e){for(var t in e)i[t]=e[t]}var n="",r=!1,i=[];this.addApi=t,e.defaults.headers.common["api-version"]="1.0",this.version=function(t){return t&&(e.defaults.headers.common["api-version"]=t),e.defaults.headers.common["api-version"]},this.serverUrlFixed=function(e){return e!==!0&&"on"!==e||(r=e),r},this.serverUrl=function(e){return e&&(n=e),e},this.$get=["$rootScope","$http","$resource",function(t,a,o){function s(e,t,r,i){return e=e||n,o(e+t,r,i)}function u(e,t){return e=e||n,o(e+t,{},{call:{method:"POST"}})}function c(e,t,r){return e=e||n,o(e+t,r||{id:"@id"},{update:{method:"PUT"}})}function p(e,t,r){return e=e||n,o(e+t,r||{id:"@id"},{page:{method:"GET",isArray:!1},update:{method:"PUT"}})}function d(e,t,n){return p(e,t,n||{id:"@id",party_id:"@party_id"})}function E(){for(var e in i)l[e]=i[e]}var l={version:function(t){return t&&(e.defaults.headers.common["api-version"]=t),e.defaults.headers.common["api-version"]},serverUrl:function(e){return e&&(n=e),n},userId:function(){return a.defaults.headers.common["user-id"]},serverUrlFixed:function(){return r},sessionId:function(){return a.defaults.headers.common["session-id"]},partyId:function(e){return e.party_id||a.defaults.headers.common["user-id"]},about:function(e){return s(e,"/api/about")},session:function(e,t){a.defaults.headers.common["session-id"]=t,a.defaults.headers.common["user-id"]=e},signin:function(e){return u(e,"/api/signin")},signout:function(e){return u(e,"/api/signout")},signup:function(e){return u(e,"/api/signup")},recoverPassword:function(e){return u(e,"/api/recover_password")},resetPassword:function(e){return u(e,"/api/reset_password")},changePassword:function(e){return u(e,"/api/change_password")},requestEmailVerification:function(e){return c(e,"/api/users/:party_id/resend_email_verification")},verifyEmail:function(e){return u(e,"/api/verify_email")},signupValidate:function(e){return u(e,"/api/signup_validate")},users:function(e){return p(e,"/api/users/:id")},currentUser:function(e){return s(e,"/api/users/current",{},{get:{method:"GET",isArray:!1}})},userSessions:function(e){return d(e,"/api/users/:party_id/sessions/:id")},parties:function(e){return p(e,"/api/parties/:id")},partySettings:function(e){return d(e,"/api/parties/:party_id/settings")},serverActivities:function(e){return p(e,"/api/servers/activities/:id")},guides:function(e){return p(e,"/api/guides/:id")},tips:function(e){return p(e,"/api/tips/:id")},image_sets:function(e){return p(e,"/api/image_sets/:id")},images:function(e){return p(e,"/api/images/search")},feedbacks:function(e){return d(e,"/api/feedbacks/:id")},announces:function(e){return p(e,"/api/announcements/:id")},createResource:s,createOperation:u,createCollection:c,createPagedCollection:p,createPartyCollection:d};return E(),l}]}])}(),function(){"use strict";var e=angular.module("pipRest.Session",["ngCookies","pipRest"]);e.run(["pipSession",function(e){e.reopen()}]),e.factory("pipSession",["$rootScope","$http","localStorageService","$cookieStore","pipRest","pipTimer",function(e,t,n,r,i,a){function o(){return v}function s(){return _}function u(){return R||n.get("serverUrl")}function c(){var e=""!==_&&null!==_&&void 0!==_&&""!==v&&null!==v&&void 0!==v&&""!==R&&null!==R&&void 0!==R;return e}function p(e){var t=n.get("servers");return t&&t[e]?t[e].email:void 0}function d(){return n.get("servers")||{}}function E(){var e,t=n.get("servers"),r=[];for(var i in t)t.hasOwnProperty(i)&&(e=t[i].serverUrl,e&&r.push(e));return r}function l(n,r,a){var o=n.serverUrl,s=n.email,u=n.password,c=n.remember,p=!!n.adminOnly,d=(new Date).getTime();I=d,t.defaults.headers.common["session-id"]=void 0,t.defaults.headers.common["user-id"]=void 0,t.defaults.headers.common["account-id"]=void 0,i.signin(o).call({email:s,password:u,remember:c},function(t){I==d&&(I=void 0,p&&!t.admin?a("ERROR_ADMIN_ONLY_ACCESS"):(m(o,t,c),e.$broadcast("pipAutoPullChanges"),r(t)))},function(e){I==d&&(I=void 0,a(e))})}function T(){I=void 0}function f(e){c()&&i.signout().call({},e,e),g()}function m(o,s,u){if(_=s.last_session_id,v=s.id,R=o,t.defaults.headers.common["session-id"]=_,t.defaults.headers.common["user-id"]=v,u){var c=n.get("servers")||{};c[R]={serverUrl:R,email:s.email},n.set("servers",c),n.set("sessionId",_),n.set("userId",v),n.set("serverUrl",R)}r.put("user-id",v),r.put("session-id",_),r.put("server-url",R),i.serverUrlFixed()||i.serverUrl(R),e.$emit("pipSessionOpened",{serverUrl:R,sessionId:_,userId:v,user:s}),a.start()}function S(){v=r.get("user-id")||n.get("userId"),_=r.get("session-id")||n.get("sessionId"),R=r.get("server-url")||n.get("serverUrl"),t.defaults.headers.common["session-id"]=_,t.defaults.headers.common["user-id"]=v,i.serverUrlFixed()&&i.serverUrl()||i.serverUrl(R),e.$serverUrl=i.serverUrl(),e.$emit("pipSessionOpened",{serverUrl:R,sessionId:_,userId:v}),a.start()}function g(){_=void 0,v=void 0,t.defaults.headers.common["session-id"]=void 0,t.defaults.headers.common["user-id"]=void 0,n.remove("userId"),n.remove("sessionId"),r.remove("user-id"),r.remove("session-id"),a.stop(),e.$emit("pipSessionClosed")}var _,v,R,I=void 0;return{opened:c,userId:o,sessionId:s,serverUrl:u,lastUsedEmail:p,usedServers:d,usedServerUrls:E,signin:l,abort:T,signout:f,open:m,close:g,reopen:S}}])}(),function(){"use strict";var e=angular.module("pipAnnouncesData",["pipRest","pipDataModel"]);e.provider("pipAnnouncesData",function(){this.readAnnouncesResolver=function(){return["$stateParams","pipRest","pipEnums",function(e,t,n){return t.announces().query().$promise}]},this.readCompletedAnnouncesResolver=function(){return["$stateParams","pipRest","pipEnums",function(e,t,n){return t.announces().query({status:n.EXECUTION_STATUS.COMPLETED}).$promise}]},this.readAnnounceResolver=function(){return["$stateParams","pipRest",function(e,t){return t.announces().get({id:e.id}).$promise}]},this.$get=["pipRest","$stateParams","pipDataModel",function(e,t,n){return{partyId:e.partyId,updateAnnounce:function(e,t,r){e.resource="announces",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.update(e,t,r)},updateAnnounceWithFiles:function(e,t,r){e.skipTransactionEnd=!0,n.saveFiles(e,function(){e.resource="announces",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.update(e,t,r)})},createAnnounceWithFiles:function(e,t,r){e.skipTransactionEnd=!0,n.saveFiles(e,function(){e.resource="announces",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.create(e,t,r)})},createAnnounce:function(e,t,r){e.resource="announces",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.create(e,t,r)},deleteAnnounce:function(e,t,r){e.resource="announces",n.remove(e,t,r)}}}]})}(),function(){"use strict";angular.module("pipData",["pipDataModel","pipDataCache","pipUsersData","pipSettingsData","pipSessionData","pipTagsData","pipAnnouncesData","pipFeedbacksData","pipGuidesData","pipImageSetsData","pipTipsCache","pipTipsData"])}(),function(){"use strict";var e=angular.module("pipDataModel",["pipUtils","pipRest"]);e.provider("pipDataModel",function(){this.$get=["$stateParams","pipCollections","pipRest",function(e,t,n){function r(e,t,n){var r,i=e.transaction;if(!i||e.skipTransactionBegin||(r=e.transactionId=i.begin(e.transactionOperation||"PROCESSING")))return E[e.resource]()[e.operation](e.item,function(n){i&&r&&i.aborted(r)||(i&&!e.skipTransactionEnd&&i.end(),t&&t(n))},function(e){i&&i.end(e),n&&n(e)})}function i(e,t,n){return e.transactionOperation=e.transactionOperation||"SAVING",e.operation=e.operation||"save",r(e,function(n){e.itemCollection&&e.itemCollection.push(n),t&&t(n)},function(e){n&&n(e)})}function a(e,n,i){return e.transactionOperation=e.transactionOperation||"SAVING",e.operation=e.operation||"update",r(e,function(r){e.itemCollection&&t.replaceBy(e.itemCollection,"id",r.id,r),n&&n(r)},i)}function o(e,t,n){return e.transactionOperation=e.transactionOperation||"SAVING",e.operation=e.operation||"remove",r(e,function(n){e.itemCollection&&_.remove(e.itemCollection,{id:n.id||(e.object||{}).id||(e.item||{}).id}),t&&t(n)},n)}function s(e,t,n){return e.transactionOperation=e.transactionOperation||"READING",e.operation=e.operation||"query",r(e,function(e){t&&t(e)},n)}function u(e,t,n){return e.transactionOperation=e.transactionOperation||"READING",e.operation=e.operation||"page",r(e,function(n){if(e.itemCollection&&n){var r=_.findIndex(e.itemCollection,{id:n.id});r>=0?e.itemCollection[r]=n:e.itemCollection.push(n)}t&&t(n)},n)}function c(e,t,n){return e.transactionOperation=e.transactionOperation||"READING",e.operation=e.operation||"page",r(e,function(n){if(e.itemCollection&&n.data)for(var r=0;r<n.data.length;r++)e.itemCollection.push(n.data[r]);t&&t(n)},n)}function p(e,t,n){var r,i=e.transaction;if(!i||e.skipTransactionBegin||(r=e.transactionId=i.begin(e.transactionOperation||"SAVING"))){var a=[{pictures:e.pictures,documents:e.documents}];if(e.item&&e.item.content){var o=!0;async.eachSeries(_.union(e.item.content,a),function(e,t){e.pictures||e.documents?e.pictures?e.pictures.save(function(){i&&r&&i.aborted(r)&&(o=!1,t("aborted")),e.documents?e.documents.save(function(){i&&r&&i.aborted(r)&&(o=!1,t("aborted")),t()},function(e){o=!1,t(e)}):t()},function(e){o=!1,t(e)}):e.documents&&e.documents.save(function(){i&&r&&i.aborted(r)&&(o=!1,t("aborted")),t()},function(e){o=!1,t(e)}):t()},function(r){!r&&o?(i&!e.skipTransactionEnd&&i.end(),_.each(e.item.content,function(e){delete e.pictures,delete e.documents}),t&&t()):(i&&i.end(r),n&&n(r))})}else e.pictures?e.pictures.save(function(){i&&r&&i.aborted(r)||(e.documents?e.documents.save(function(){i&&r&&i.aborted(r)||(i&!e.skipTransactionEnd&&i.end(),t&&t())},function(e){i&&i.end(e),n&&n(e)}):(i&!e.skipTransactionEnd&&i.end(),t&&t()))},function(e){i&&i.end(e),n&&n(e)}):e.documents?e.documents.save(function(){i&&r&&i.aborted(r)||(i&!e.skipTransactionEnd&&i.end(),t&&t())},function(e){i&&i.end(e),n&&n(e)}):(i&!e.skipTransactionEnd&&i.end(),t&&t())}}function d(e){e.pictures&&e.pictures.abort(),e.documents&&e.documents.abort(),e.transaction&&e.transaction.abort()}var E=[];for(var l in n)E[l]=n[l];return{execute:r,create:i,update:a,save:a,"delete":o,remove:o,read:s,query:s,readOne:u,get:u,page:c,readPage:c,queryPage:c,saveFiles:p,abortFiles:d}}]})}(),function(){"use strict";var e=angular.module("pipFeedbacksData",["pipRest","pipDataModel"]);e.provider("pipFeedbacksData",function(){this.readFeedbacksResolver=function(){return["$stateParams","pipRest",function(e,t){return t.feedbacks().query().$promise}]},this.readFeedbackResolver=function(){return["$stateParams","pipRest",function(e,t){return t.feedbacks().get({id:e.id}).$promise}]},this.$get=["$stateParams","pipRest","pipDataModel",function(e,t,n){return{sendFeedback:function(e,t,r){e.resource="feedbacks",n.create(e,t,r)},createFeedbackWithFiles:function(e,t,r){e.skipTransactionEnd=!0,n.saveFiles(e,function(){e.resource="feedbacks",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.create(e,t,r)})},updateFeedback:function(e,t,r){e.resource="feedbacks",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.update(e,t,r)},deleteFeedback:function(e,t,r){e.resource="feedbacks",n.remove(e,t,r)}}}]})}(),function(){"use strict";var e=angular.module("pipGuidesData",["pipRest","pipDataModel"]);e.provider("pipGuidesData",function(){this.readGuidesResolver=function(){return["$stateParams","pipRest",function(e,t){return t.guides().query().$promise}]},this.readIntroGuidesResolver=function(){return["$stateParams","pipRest",function(e,t){return t.guides().query({type:"intro",status:"completed"}).$promise}]},this.readGuideResolver=function(){return["$stateParams","pipRest",function(e,t){return t.guides().get({id:e.id||"55bf23d3bb22aa175c3e498e"}).$promise}]},this.$get=["pipRest","$stateParams","pipDataModel",function(e,t,n){return{partyId:e.partyId,updateGuide:function(e,t,r){e.resource="guides",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.update(e,t,r)},readGuides:function(r,i,a){return r.resource="guides",r.party_id=e.partyId(t),r.type="intro",n.read(r,i,a)},createGuideWithFiles:function(e,t,r){e.skipTransactionEnd=!0,n.saveFiles(e,function(){e.resource="guides",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.create(e,t,r)})},updateGuideWithFiles:function(e,t,r){e.skipTransactionEnd=!0,n.saveFiles(e,function(){e.resource="guides",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,n.update(e,t,r)})},createGuide:function(e,t,r){e.resource="guides",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,
n.create(e,t,r)},deleteGuide:function(e,t,r){e.resource="guides",n.remove(e,t,r)}}}]})}(),function(){"use strict";var e=angular.module("pipImageSetsData",["pipRest","pipDataModel"]);e.provider("pipImageSetsData",function(){var e=15;this.readImageSetsResolver=function(){return["$stateParams","pipRest",function(t,n){return n.image_sets().get({paging:1,skip:0,take:e,search:t.search}).$promise}]},this.readImageSetResolver=function(){return["$stateParams","pipRest",function(e,t){return t.image_sets().get({id:e.id}).$promise}]},this.$get=["pipRest","$stateParams","pipDataModel",function(t,n,r){return{partyId:t.partyId,readImageSets:function(i,a,o,s){i.resource="image_sets",i.skipTransactionBegin=!0,i.skipTransactionEnd=!1,i.item.search=n.search||i.item.search,i.item.party_id=t.partyId(n),i.item.take=e,i.item.paging=1,r.page(i,o,s)},updateImageSet:function(e,t,n){e.resource="image_sets",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,r.update(e,t,n)},createImageSet:function(e,t,n){e.resource="image_sets",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,r.create(e,t,n)},createImageSetWithFiles:function(e,t,n){e.skipTransactionEnd=!0,r.saveFiles(e,function(){e.resource="image_sets",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,r.create(e,t,n)})},updateImageSetWithFiles:function(e,t,n){e.skipTransactionEnd=!0,r.saveFiles(e,function(){e.resource="image_sets",e.skipTransactionBegin=!0,e.skipTransactionEnd=!1,r.update(e,t,n)})},deleteImageSet:function(e,t,n){e.resource="image_sets",r.remove(e,t,n)}}}]})}(),function(){"use strict";var e=angular.module("pipSessionData",["pipRest","pipSessionCache"]);e.provider("pipSessionData",function(){function e(e){return e.readUser()}function t(e,t){return e.readParty(t)}function n(e,t){return e.readConnection(t)}function r(e){return e.readSettings()}function i(e,t,n){return t.userSessions().query({party_id:e.id}).$promise}function a(e,t){return t.sessionId()}e.$inject=["pipSessionCache"],t.$inject=["pipSessionCache","$stateParams"],n.$inject=["pipSessionCache","$stateParams"],r.$inject=["pipSessionCache"],i.$inject=["$stateParams","pipRest","$rootScope"],a.$inject=["$stateParams","pipSession"],this.readUserResolver=e,this.readPartyResolver=t,this.readConnectionResolver=n,this.readSettingsResolver=r,this.readSessionsUserResolver=i,this.readSessionIdResolver=a,this.$get=["$rootScope","$stateParams","pipRest",function(e,t,n){function r(e){return function(){return e.sessionId()}}function i(e,r,i,a){var o=e.begin("REMOVING");o&&n.userSessions().remove({id:r.id,party_id:t.id},function(t){e.aborted(o)||(e.end(),i&&i(t))},function(t){e.end(t),a&&a(t)})}return{getSessionId:r,removeSession:i}}]})}(),function(){"use strict";var e=angular.module("pipSettingsData",["pipRest","pipSessionData","pipSessionCache","pipDataModel"]);e.provider("pipSettingsData",["pipSessionDataProvider",function(e){this.readSettingsResolver=e.readSettingsResolver,this.$get=["$rootScope","$stateParams","pipRest","pipSessionCache","pipSession","pipDataModel",function(e,t,n,r,i,a){function o(e,t){return r.readSettings(e,t)}function s(e,t){return n.partySettings().get({party_id:i.userId()},function(t){t=t||{},r.onSettingsUpdate(t),e&&e(t)},t).$promise}function u(t,n,o,s){t=n?_.pick(t,n):t,t.party_id=i.userId();var u=_.cloneDeep(e.$settings);r.onSettingsUpdate(t);var c={};c.resource="partySettings",c.item=t,c.item.creator_id=i.userId(),a.create(c,o,function(e){r.onSettingsUpdate(u),s&&s(e)})}return{saveSettings:u,readSettings:o,reReadSettings:s}}]}])}(),function(){"use strict";var e=angular.module("pipTagsData",["pipRest","pipDataModel","pipTagsCache"]);e.provider("pipTagsData",function(){this.readTagsResolver=function(){return["$stateParams","pipRest","pipTagsCache",function(e,t,n){return n.readTags({item:{party_id:t.partyId(e)}})}]},this.$get=["$stateParams","$state","pipRest","pipDataModel","pipTagsCache",function(e,t,n,r,i){return{partyId:n.partyId,readTags:function(t,r,a){return t=t||{},t.item=t.item||{},null==t.item.party_id&&(t.item.party_id=n.partyId(e)),i.readTags(t,r,a)}}}]})}(),function(){"use strict";var e=angular.module("pipTipsData",["pipRest","pipDataModel"]);e.provider("pipTipsData",function(){this.readTipsResolver=function(){return["$stateParams","pipRest",function(e,t){return t.tips().query().$promise}]},this.readTipResolver=function(){return["$stateParams","pipRest",function(e,t){return t.tips().get({id:e.id}).$promise}]},this.$get=["pipRest","$stateParams","pipDataModel","pipTipsCache",function(e,t,n,r){return{partyId:e.partyId,readTips:function(n,i,a,o){return n.resource="tips",n.item=n.item||{},n.item.search=t.search,n.item.tags=t.search,n.item.party_id=e.partyId(t),r.readTips(n,a,o)},createTip:function(i,a,o){i.resource="tips",i.item=i.item||{},i.item.party_id=e.partyId(t),n.create(i,r.onTipCreate(i,a),o)},createTipWithFiles:function(i,a,o){i.skipTransactionEnd=!0,i.item=i.item||{},i.item.party_id=e.partyId(t),n.saveFiles(i,function(){i.resource="tips",i.skipTransactionBegin=!0,i.skipTransactionEnd=!1,i.item.party_id=e.partyId(t),n.create(i,r.onTipCreate(i,a),o)},o)},updateTip:function(i,a,o){i.resource="tips",i.item=i.item||{},i.item.party_id=e.partyId(t),n.update(i,r.onTipUpdate(i,a),o)},updateTipWithFiles:function(i,a,o){i.skipTransactionEnd=!0,i.item=i.item||{},i.item.party_id=e.partyId(t),n.saveFiles(i,function(){i.resource="tips",i.skipTransactionBegin=!0,i.skipTransactionEnd=!1,i.item.party_id=e.partyId(t),n.update(i,r.onTipUpdate(i,a),o)})},deleteTip:function(e,t,i){e.resource="tips",n.remove(e,r.onTipDelete(e,t),i)}}}]})}(),function(){"use strict";var e=angular.module("pipUsersData",["pipRest"]);e.provider("pipUsersData",function(){this.readUsersResolver=function(){return["$stateParams","pipRest",function(e,t){return t.users().page({party_id:e.id,paging:e.paging||1,skip:e.skip||0,take:e.take||15}).$promise}]},this.readUserResolver=function(){return["$stateParams","pipRest",function(e,t){return t.users().get({id:e.id,party_id:t.partyId(e)}).$promise}]},this.readActivitiesUserResolver=["$stateParams","pipRest","$rootScope",function(e,t,n){return t.partyActivities().page({party_id:n.$user.id,paging:1,skip:0,take:25}).$promise}],this.$get=["pipRest","$stateParams",function(e,t){return{partyId:e.partyId,readUsers:function(n,r,i,a){e.users().page({party_id:e.partyId(t),paging:1,skip:n.start,search:n.item.search,active:n.item.active,paid:n.item.paid,admin:n.item.admin,take:15},function(e){i&&i(e)},function(e){a(e)})},updateUser:function(t,n,r,i){e.users().update(t.item,function(e){r&&r(e)},function(e){i(e)})}}}]})}();
!function(){"use strict";angular.module("pipLayout",["pipLayout.Main","pipLayout.Simple","pipLayout.Card","pipLayout.Document","pipLayout.Tiles","pipLayout.Dialog","pipLayout.Split"])}(),function(){"use strict";var i=angular.module("pipLayout.Card",[]);i.directive("pipCard",function(){return{restrict:"EA",link:function(i,t,n){function e(){var e,r,s=$(".pip-main-body"),a=$(".pip-card-container"),l=o.width(),p=s.width(),u=s.height(),c=n.minWidth?Math.floor(n.minWidth):null,d=n.minHeight?Math.floor(n.minHeight):null,h=n.width?Math.floor(n.width):null,m=n.height?Math.floor(n.height):null;if(768>=l)c=null,d=null,h=null,m=null,p=null,u=null;else{var f=l>1200?24:16;p-=2*f,u-=2*f,c=c?Math.min(c,p):null,d=d?Math.min(d,u):null,h=h?Math.min(h,p):null,m=m?Math.min(m,u):null}if(t.css("max-width",p?p+"px":""),t.css("min-width",c?c+"px":""),t.css("width",h?h+"px":""),t.css("height",m?m+"px":""),a.hasClass("pip-outer-scroll"))a.addClass("pip-scroll"),768>=l?(e=0,r=0):(e=a.width()/2-t.width()/2-16,r=Math.max(a.height()/2-t.height()/2-16,0)),t.css("left",e),t.css("top",r),setTimeout(function(){t.css("display","flex")},100);else{t.css("max-height",u?u+"px":""),t.css("min-height",d?d+"px":"");var g=t.find(".pip-header:visible"),w=t.find(".pip-footer:visible"),v=t.find(".pip-body"),y=u||s.height();g.length>0&&(y-=g.outerHeight(!0)),w.length>0&&(y-=w.outerHeight(!0)),v.css("max-height",y+"px")}i.$broadcast("pipLayoutResized")}var o=$(window);t.addClass("pip-card"),i.$on("pipWindowResized",e),e(),setTimeout(e,100)}}})}(),function(){"use strict";var i=angular.module("pipLayout.Dialog",[]);i.directive("pipDialog",function(){return{restrict:"EA",controller:"pipDialogController"}}),i.controller("pipDialogController",["$scope","$element","$attrs",function(i,t,n){function e(){var e=o.width(),r=o.height(),s=n.minWidth?Math.floor(n.minWidth):null,a=n.minHeight?Math.floor(n.minHeight):null,l=n.width?Math.floor(n.width):null,p=n.height?Math.floor(n.height):null,u=e>1200?24:16;e-=2*u,r-=2*u,s=s&&e>s?s:null,a=a&&r>a?a:null,l=l?Math.min(l,e):null,p=p?Math.min(p,r):null,t.css("max-width",e?e+"px":""),t.css("max-height",r?r+"px":""),t.css("min-width",s?s+"px":""),t.css("min-height",a?a+"px":""),t.css("width",l?l+"px":""),t.css("height",p?p+"px":""),i.$broadcast("pipLayoutResized")}var o=$(window);t.addClass("pip-dialog"),i.$on("pipWindowResized",e),i.$on("pipResizeLayout",e),e(),o.trigger("resize")}])}(),function(){"use strict";var i=angular.module("pipLayout.Document",[]);i.directive("pipDocument",function(){return{restrict:"EA",controller:"pipDocumentController"}}),i.controller("pipDocumentController",["$scope","$element","$attrs",function(i,t,n){t.addClass("pip-document")}])}(),function(){"use strict";var i=angular.module("pipLayout.Main",[]);i.directive("pipMain",function(){return{restrict:"EA",controller:"pipMainController"}}),i.directive("pipMainBody",function(){return{restrict:"EA",link:function(i,t){t.addClass("pip-main-body")}}}),i.controller("pipMainController",["$scope","$element","$rootScope",function(i,t,n){function e(){n.$broadcast("pipWindowResized")}var o=$(window);t.addClass("pip-main"),o.bind("resize",e),i.$on("$destroy",function(){n.$size=void 0,o.unbind("resize",e)}),n.$on("pipResizeWindow",function(i){setTimeout(e,0)}),setTimeout(e,0)}])}(),function(){"use strict";var i=angular.module("pipLayout.Simple",[]);i.directive("pipSimple",function(){return{restrict:"EA",link:function(i,t,n){t.addClass("pip-simple")}}})}(),function(){"use strict";var i=angular.module("pipLayout.Split",[]);i.run(["$rootScope","pipSplit",function(i,t){i.$on("$stateChangeStart",function(i,n,e,o,r){var s=$(".pip-split");s.length>0&&(s.removeClass("pip-transition-forward"),s.removeClass("pip-transition-back"),n.name!=o.name&&(t.forwardTransition(n,o)?s.addClass("pip-transition-forward"):s.addClass("pip-transition-back")))})}]),i.provider("pipSplit",function(){function i(i){if(!_.isArray(i)||0==i.length)throw new Error("Transition sequence must be an array of state names");n.push(i)}function t(i,t){for(var e=0;e<n.length;e++){var o=n[e].indexOf(i.name),r=n[e].indexOf(t.name);if(o>-1)return o>r}return!1}var n=[];this.addTransitionSequence=i,this.$get=function(){return{forwardTransition:t}}})}(),function(){"use strict";function i(i,t,n){function e(t){var n,e=o.width();if(e>767){e-=48;var u=Math.floor(e/r);n=(r+16)*u-16,n>e&&(u--,n=(r+16)*u-16),1>u?(n=e,p.css("width",n+"px")):p.css("width",r+"px"),s.css("width",n+1+"px")}else e-=32,n=e,p.css("width",n+"px"),s.css("width",n+1+"px");(a!=n||t)&&(a=n,l.layout(),i.$broadcast("pipLayoutResized"))}var o=$(window),r=n.columnWidth?Math.floor(n.columnWidth):440,s=t.children(".pip-tiles-container"),a=null,l=Masonry.data(s[0]);t.addClass("pip-tiles");var p=$('<div class="pip-tile-sizer"></div>');p.appendTo(s),i.$on("pipWindowResized",function(){e(!1)}),i.$on("pipResizeLayout",function(){e(!0)}),e()}function t(i){return null==i?!1:i?(i=i.toString().toLowerCase(),"1"==i||"true"==i):!1}var n=angular.module("pipLayout.Tiles",["wu.masonry"]);n.directive("pipTiles",function(){return{restrict:"EA",scope:!1,transclude:!0,template:function(i,n){return t(n.pipInfinite)?String()+'<div masonry class="pip-tiles-container" load-images="false" preserve-order   ng-transclude column-width=".pip-tile-sizer" item-selector=".pip-tile" masonry-options="tilesOptions"  pip-scroll-container="\'.pip-tiles\'" pip-infinite-scroll="readScroll()" ></div>':String()+'<div masonry class="pip-tiles-container" load-images="false" preserve-order   ng-transclude column-width=".pip-tile-sizer" item-selector=".pip-tile" masonry-options="tilesOptions"></div>'},controller:["$scope",function(i){i.tilesOptions={gutter:8,isFitWidth:!1,isResizeBound:!1,transitionDuration:0}}],link:i}})}();
!function(){"use strict";angular.module("pipControls",["pipMarkdown","pipToggleButtons","pipRefreshButton","pipColorPicker","pipRoutingProgress","pipPopover","pipImageSlider","pipToasts","pipTagList","pipDate","pipDateRange","pipTimeEdit","pipTimeView","pipInformationDialog","pipConfirmationDialog","pipOptionsDialog","pipOptionsBigDialog","pipConversionDialog","pipErrorDetailsDialog"]),angular.module("pipBasicControls",["pipControls"])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("confirmation_dialog/confirmation_dialog.html",'<md-dialog class="pip-dialog pip-confirmation-dialog" layout="column" width="400" md-theme="{{theme}}"><div class="pip-header text-subhead1"><h3 class="m0">{{ title | translate }}</h3></div><div class="pip-footer"><div><md-button ng-click="onCancel()">{{ cancel | translate }}</md-button><md-button class="md-accent" ng-click="onOk()">{{ ok | translate }}</md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("conversion_dialog/conversion_dialog.html",'<md-dialog class="pip-dialog pip-conversion-dialog" layout="column" min-width="450" md-theme="{{theme}}"><md-dialog-content class="pip-body p0 pip-scroll"><div class="pip-header" ng-if="!withoutTitle || deleted" ng-class="{\'header-hint\': withoutTitle && deleted}"><h3 class="m0 text-title" ng-hide="withoutTitle">{{::title | translate}}</h3><p class="tp8 pip-subtitle" ng-hide="withoutTitle"><span pip-translate-html="{{::subtitle | translate}}"></span></p><div ng-show="withoutTitle && deleted" class="dialog-hint" layout="row" layout-align="start center"><div class="w40" flex-fixed=""><md-icon md-svg-icon="icons:info-circle-outline"></md-icon></div><div>{{::withoutTitle | translate}}</div></div></div><div class="pip-divider" ng-if="!withoutTitle"></div><div class="h8" ng-if="withoutTitle"></div><div class="pip-content"><div class="pip-list md-primary" md-no-ink="true" ng-keydown="onKeyDown($event)" ng-keypress="onKeyPress($event)" tabindex="0"><div ng-repeat="option in options" class="pip-list-item" md-ink-ripple="" ui-event="{ click: \'onOptionSelect($event, option)\' }" ng-class="{ selected: option.name == selectedOptionName, \'divider-bottom\': $index < options.length - 1 }"><div class="pip-content lp24-flex rp24-flex" flex=""><div class="pip-title" ng-if="option.title">{{::option.title | translate}}</div><div class="pip-subtitle" ng-if="option.subtitle"><span pip-translate-html="{{::option.subtitle | translate}}"></span></div><div class="pip-text" ng-if="option.text"><span pip-translate-html="{{::option.text | translate}}"></span></div></div></div></div></div><div class="h8"></div></md-dialog-content></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("color_picker/color_picker.html",'<ul class="pip-color-picker lp0 {{class}}" pip-selected="currentColorIndex" pip-enter-space-press="enterSpacePress($event)"><li tabindex="-1" ng-repeat="color in colors"><md-button tabindex="-1" class="md-icon-button pip-selectable" ng-click="selectColor($index)" aria-label="color" ng-disabled="disabled()"><md-icon ng-style="{\'color\': color}" md-svg-icon="icons:{{ color == currentColor ? \'circle\' : \'radio-off\' }}"></md-icon></md-button></li></ul>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("date/date.html",'<div class="pip-date" tabindex="-1" layout="row" flex=""><md-input-container flex="" class="tm0"><md-select class="pip-date-day tm0" ng-disabled="disableControls" ng-model="day" placeholder="{{dayLabel}}" ng-change="onDayChanged()" flex=""><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{ opt }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container flex="" class="tm0"><md-select class="pip-date-month tm0" ng-disabled="disableControls" ng-model="month" placeholder="{{monthLabel}}" ng-change="onMonthChanged()" flex=""><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container flex="" class="tm0"><md-select class="pip-date-year tm0" ng-disabled="disableControls" ng-model="year" placeholder="{{yearLabel}}" ng-change="onYearChanged()" flex=""><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{ opt }}</md-option></md-select></md-input-container></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("date_range/date_range.html",'<div class="pip-date-range" tabindex="-1" layout="row" flex=""><md-input-container flex="" ng-show="isDay()" class="tm0 pip-day" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-day w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onDayClick()" ng-model="day" ng-change="onDayChanged()" placeholder="{{dayLabel}}" aria-label="DAY"><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{nameDays[$index]}} {{ opt }}</md-option></md-select></md-input-container><md-input-container flex="" ng-show="isWeek()" class="tm0" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-week w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" ng-model="week" ng-change="onWeekChange()" placeholder="{{weekLabel}}" aria-label="WEEK"><md-option ng-value="opt.id" ng-repeat="opt in weeks track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isDay() || isWeek()"></div><md-input-container flex="" ng-show="isMonth() && !monthFormatShort" class="tm0 min-w72" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><md-input-container flex="" ng-show="isMonth() && monthFormatShort" class="tm0" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in shortMonths track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isMonth()"></div><md-input-container flex="" class="tm0" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-year w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onYearClick()" ng-model="year" ng-change="onYearChanged()" placeholder="{{yearLabel}}" aria-label="YEAR"><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{ opt }}</md-option></md-select></md-input-container></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("error_details_dialog/error_details_dialog.html",'<md-dialog class="pip-dialog pip-details-dialog" layout="column" width="400" md-theme="{{theme}}"><div class="pip-body"><div class="pip-header p0 bp8 text-subhead1">{{::\'ERROR_DETAILS\' | translate}}</div><div layout="row" layout-align="start center" class="h48 text-body2 color-secondary-text" ng-if="error.code || (error.data && error.data.code)">{{::\'CODE\' | translate}}</div><div layout="row" layout-align="start center" ng-if="error.code || (error.data && error.data.code)">{{error.code || error.data.code}}</div><div layout="row" layout-align="start center" class="h48 text-body2 color-secondary-text" ng-if="error.path || (error.data && error.data.path)">{{::\'PATH\' | translate}}</div><div layout="row" layout-align="start center" ng-if="error.path || (error.data && error.data.path)">{{error.path || error.data.path}}</div><div layout="row" layout-align="start center" class="h48 text-body2 color-secondary-text" ng-if="error.error || (error.data && error.data.error)">{{::\'ERROR\' | translate}}</div><div layout="row" layout-align="start center" ng-if="error.error || (error.data && error.data.error)">{{error.error || error.data.error}}</div><div layout="row" layout-align="start center" class="h48 text-body2 color-secondary-text" ng-if="error.method || (error.data && error.data.method)">{{::\'METHOD\' | translate}}</div><div layout="row" layout-align="start center" ng-if="error.method || (error.data && error.data.method)">{{error.method || error.data.method}}</div><div layout="row" layout-align="start center" class="h48 text-body2 color-secondary-text" ng-if="error.message || (error.data && error.data.message)">{{::\'MESSAGE\' | translate}}</div><div layout="row" layout-align="start center" ng-if="error.message || (error.data && error.data.message)">{{error.message || error.data.message}}</div></div><div class="pip-footer rp16"><div><md-button class="md-accent m0" ng-click="onOk()">{{::\'DISMISS\' | translate }}</md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("options_dialog/options_dialog.html",'<md-dialog class="pip-dialog pip-options-dialog" layout="column" min-width="400" md-theme="{{theme}}"><md-dialog-content class="pip-body lp0 tp0 rp0 bp24 pip-scroll"><div class="pip-header"><h3 class="m0 bm16 text-title">{{::title | translate}}</h3><div ng-show="deletedTitle" class="bp16 tp8 text-subhead1 divider-bottom"><md-checkbox ng-model="deleted" aria-label="CHECKBOX" class="m0">{{::deletedTitle | translate}}</md-checkbox></div></div><div class="pip-content"><md-radio-group ng-model="selectedOptionName" class="pip-list md-primary" md-no-ink="true" ng-keypress="onKeyPress($event)" tabindex="0"><div ng-repeat="option in options" class="pip-list-item p0" md-ink-ripple="" ui-event="{ click: \'onOptionSelect($event, option)\' }" ng-class="{ selected: option.name == selectedOptionName }"><div class="pip-list-item"><md-icon class="pip-option-icon rm12" md-svg-icon="icons:{{option.icon}}" ng-if="option.icon"></md-icon><div class="pip-option-title">{{::option.title | translate}}</div><md-radio-button ng-value="option.name" tabindex="-1" aria-label="{{::option.title | translate}}"></md-radio-button></div></div></md-radio-group></div></md-dialog-content><div class="pip-footer"><div><md-button class="pip-cancel" ng-click="onCancel()">{{::\'CANCEL\' | translate}}</md-button><md-button class="pip-submit md-accent" ng-click="onSelect()">{{::applyButtonTitle | translate}}</md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("options_dialog/options_dialog_big.html",'<md-dialog class="pip-dialog pip-options-dialog-big" layout="column" min-width="400" md-theme="{{theme}}"><md-dialog-content class="pip-body p0 pip-scroll" ng-class="{\'bp24\': !noActions}"><div class="pip-header" ng-class="{\'header-hint\': noTitle && hint}"><h3 class="m0 text-title" ng-if="!noTitle">{{::title | translate}}</h3><div ng-show="noTitle && hint" class="dialog-hint" layout="row" layout-align="start center"><div class="w40" flex-fixed=""><md-icon md-svg-icon="icons:info-circle-outline"></md-icon></div><div>{{::hint | translate}}</div></div></div><div class="pip-divider" ng-if="!noTitle"></div><div class="pip-content"><div class="h8" ng-if="noTitle && hint"></div><md-list class="pip-menu pip-ref-list w-stretch" pip-selected="optionIndex" index="{{optionIndex }}" pip-select="onSelected($event)"><md-list-item class="pip-ref-list-item pip-selectable" ng-class="{\'selected\' : option.name == selectedOptionName, \'divider-bottom\': $index != options.length - 1}" layout="row" layout-align="start center" md-ink-ripple="" xxxxng-keypress="onKeyPress($event)" ng-keyup="onKeyUp($event, $index)" ng-repeat="option in options" ng-click="onOptionSelect($event, option)"><div class="pip-content line-height-string max-w100-stretch"><p class="pip-title rp24-flex" ng-if="option.title" style="margin-bottom: 4px !important;">{{::option.title | translate}}</p><div class="pip-subtitle rp24-flex" style="height: inherit" ng-if="option.subtitle">{{::option.subtitle | translate}}</div><div class="pip-subtitle rp24-flex" style="height: inherit" ng-if="option.text" pip-translate-html="{{::option.text | translate}}"></div></div></md-list-item></md-list></div><div class="h8" ng-if="noActions"></div></md-dialog-content><div class="pip-footer" ng-if="!noActions"><div><md-button class="pip-cancel" ng-click="onCancel()">{{::\'CANCEL\' | translate}}</md-button><md-button class="pip-submit md-accent" ng-click="onSelect()" style="margin-right: -6px">{{::applyButtonTitle | translate}}</md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("information_dialog/information_dialog.html",'<md-dialog class="pip-dialog pip-information-dialog" layout="column" width="400" md-theme="{{theme}}"><div class="pip-header"><h3 class="m0">{{ title | translate }}</h3></div><div class="pip-body"><div class="pip-content">{{ content }}</div></div><div class="pip-footer"><div><md-button class="md-accent" ng-click="onOk()">{{ ok | translate }}</md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("popover/popover.template.html",'<div ng-if="params.templateUrl" class="pip-popover flex layout-column" ng-click="onPopoverClick($event)" ng-include="params.templateUrl"></div><div ng-if="params.template" class="pip-popover" ng-click="onPopoverClick($event)"></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("progress/routing_progress.html",'<div class="pip-routing-progress" layout="column" layout-align="center center" ng-show="$routing || $reset"><div class="loader"><svg class="circular" viewbox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg></div><img src="images/Logo_animation.svg" height="40" width="40" class="pip-img"><md-progress-circular md-diameter="96" class="fix-ie"></md-progress-circular></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("tags/tag_list.html",'<div class="pip-chip rm4 pip-type-chip pip-type-chip-left {{\'bg-\' + pipType + \'-chips\'}}" ng-if="pipType && !pipTypeLocal"><span>{{pipType.toUpperCase() | translate | uppercase}}</span></div><div class="pip-chip rm4 pip-type-chip pip-type-chip-left {{\'bg-\' + pipType + \'-chips\'}}" ng-if="pipType && pipTypeLocal"><span>{{pipTypeLocal.toUpperCase() | translate | uppercase}}</span></div><div class="pip-chip rm4" ng-repeat="tag in pipTags"><span>{{::tag}}</span></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("time_edit/time_edit.html",'<div layout="row" class="event-edit" layout-xs="column" flex="" layout-align="start start"><div flex="47" class="w-stretch rm24-flex0"><p class="text-caption text-grey tm0">{{startLabel}}</p><div layout="row" layout-align="space-between center"><div class="rm16 pip-datepicker-container" flex="49"><md-datepicker ng-model="data.startDate" xmd-placeholder="{{startLabel}}" ng-change="onChangeStartDate()" ng-disabled="isDisabled()" aria-label="START-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="START-TIME" class="tm0 bm0" ng-model="data.startTime" ng-disabled="isDisabled()" ng-change="onChangeStartTime()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div><div flex="47" class="w-stretch"><p class="text-caption text-grey tm0">{{endLabel}}</p><div layout="row" layout-align="space-between center"><div class="rm16 pip-datepicker-container" flex="49"><md-datepicker ng-model="data.endDate" xmd-placeholder="{{endLabel}}" ng-disabled="isDisabled()" ng-change="onChangeEndDate()" aria-label="END-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="END-TIME" class="tm0 bm0" ng-model="data.endTime" ng-change="onChangeEndTime()" ng-disabled="isDisabled()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div></div>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("time_view/time_view.html",'<p><span ng-if="data.start != null">{{data.start | formatShortDateTime}}</span> <span class="rm4 lm4" ng-if="data.start && data.end">-</span> <span ng-if="data.end != null">{{data.end | formatShortDateTime}}</span></p>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("toggle_buttons/toggle_buttons.html",'<div class="pip-toggle-buttons flex layout-row {{class}}" pip-selected="bufButtonIndex" pip-enter-space-press="enterSpacePress($event)" ng-if="$mdMedia(\'gt-xs\')"><md-button tabindex="-1" ng-repeat="button in buttons" ng-class="{\'md-accent md-raised selected color-accent-bg\' : currentButtonIndex == $index}" ng-attr-style="{{ \'background-color:\' + (currentButtonIndex == $index ? button.backgroundColor : \'\') + \'!important\' }}" class="pip-selectable pip-chip-button flex" ng-click="buttonSelected($index, $event)" ng-disabled="button.disabled || disabled()">{{button.name || button.title | translate}} <span ng-if="button.checked || button.complete || button.filled" class="pip-tagged">*</span></md-button></div><md-input-container class="md-block" ng-if="$mdMedia(\'xs\')"><md-select ng-model="currentButtonIndex" ng-disabled="disabled()" aria-label="DROPDOWN" md-on-close="buttonSelected(currentButtonIndex)"><md-option ng-repeat="action in buttons" value="{{ ::$index }}">{{ (action.title || action.name) | translate }} <span ng-if="action.checked || action.complete || action.filled" class="pip-tagged">*</span></md-option></md-select></md-input-container>')}])}(),function(t){try{t=angular.module("pipBasicControls.Templates")}catch(e){t=angular.module("pipBasicControls.Templates",[])}t.run(["$templateCache",function(t){t.put("toast/toast.html",'<md-toast class="md-action pip-toast" ng-class="{\'pip-error\': toast.type==\'error\', \'pip-column-toast\': toast.type == \'error\' || toast.actions.length > 1 || actionLenght > 4, \'pip-no-action-toast\': actionLenght == 0}" style="height:initial; max-height: initial;"><span class="flex-var m0 pip-text" ng-bind-html="message"></span><div layout="row" layout-align="end start" class="pip-actions" ng-if="actions.length > 0 || (toast.type==\'error\' && toast.error)"><md-button class="flex-fixed m0 lm8" ng-if="toast.type==\'error\' && toast.error" ng-click="onDetails()">Details</md-button><md-button class="flex-fixed m0 lm8" ng-click="onAction(action)" ng-repeat="action in actions" aria-label="{{::action| translate}}">{{::action| translate}}</md-button></div></md-toast>')}])}(),function(){"use strict";var t=angular.module("pipColorPicker",["pipUtils","pipFocused","pipBasicControls.Templates"]);t.directive("pipColorPicker",function(){return{restrict:"EA",scope:{ngDisabled:"&",colors:"=pipColors",currentColor:"=ngModel",colorChange:"&ngChange"},templateUrl:"color_picker/color_picker.html",controller:"pipColorPickerController"}}),t.controller("pipColorPickerController",["$scope","$element","$attrs","$timeout",function(t,e,n,a){var i=["purple","lightgreen","green","darkred","pink","yellow","cyan"];t["class"]=n["class"]||"",(!t.colors||_.isArray(t.colors)&&0===t.colors.length)&&(t.colors=i),t.currentColor=t.currentColor||t.colors[0],t.currentColorIndex=t.colors.indexOf(t.currentColor),t.disabled=function(){return t.ngDisabled?t.ngDisabled():!0},t.selectColor=function(e){t.disabled()||(t.currentColorIndex=e,t.currentColor=t.colors[t.currentColorIndex],a(function(){t.$apply()}),t.colorChange&&t.colorChange())},t.enterSpacePress=function(e){t.selectColor(e.index)}}])}(),function(){"use strict";var t=angular.module("pipConfirmationDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{CONFIRM_TITLE:"Confirm"}),t.translations("ru",{CONFIRM_TITLE:"Подтвердите"})}]),t.factory("pipConfirmationDialog",["$mdDialog",function(t){return{show:function(e,n,a){t.show({targetEvent:e.event,templateUrl:"confirmation_dialog/confirmation_dialog.html",controller:"pipConfirmationDialogController",locals:{params:e},clickOutsideToClose:!0}).then(function(){n&&n()},function(){a&&a()})}}}]),t.controller("pipConfirmationDialogController",["$scope","$rootScope","$mdDialog","pipTranslate","params",function(t,e,n,a,i){t.theme=e.$theme,t.title=i.title||"CONFIRM_TITLE",t.ok=i.ok||"OK",t.cancel=i.cancel||"CANCEL",t.onCancel=function(){n.cancel()},t.onOk=function(){n.hide()}}])}(),function(){"use strict";var t=angular.module("pipConversionDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{CONVERT_PARENT_TITLE:"Choose type of the parent record",CONVERT_PARENT_SUBTITLE:"The <b>%s</b> is missing and will be created from scratch. Find and clarify it later",CONVERT_TO_GOAL_SUBTITLE:"Result that requires significant efforts",CONVERT_TO_TASK_SUBTITLE:"Simple work that doesn't need a plan",CONVERT_TO_AREA_SUBTITLE:"Area of interests or actions of any kind",CONVERT_TO_VISION_SUBTITLE:"Situation in specific time period",CONVERT_TO_CANCEL:"Do not create a parent record",CONVERT_TO_CANCEL_SUBTITLE:"The <b>%s</b> is deleted",CONVERT_RECORD_TO_GOAL:"Result that requires significant efforts",CONVERT_RECORD_TO_TASK:"Simple work that doesn't need a pla",CONVERT_RECORD_TO_EVENT:"Reminder or scheduled block of time",CONVERT_RECORD_TO_POST:"Any useful information"}),t.translations("ru",{CONVERT_PARENT_TITLE:"Определите тип родительской записи",CONVERT_PARENT_SUBTITLE:"Запись <b>%s</b> отсутствует и будет создана с нуля. Найдите и скорректируйте ее позже",CONVERT_TO_GOAL_SUBTITLE:"Результат требующий значительных усилий",CONVERT_TO_TASK_SUBTITLE:"Простая работа, для которой не нужен план",CONVERT_TO_AREA_SUBTITLE:"Область интересов или какой-либо активности",CONVERT_TO_VISION_SUBTITLE:"Ситуация в определенный промежуток времени",CONVERT_TO_CANCEL:"Не создавать родительскую запись",CONVERT_TO_CANCEL_SUBTITLE:"<b>%s</b> будет удалена",CONVERT_RECORD_TO_GOAL:"Результат требующий значительных усилий",CONVERT_RECORD_TO_TASK:"Простая работа, для которой не нужен план",CONVERT_RECORD_TO_EVENT:"Напоминание или блок времени в расписании",CONVERT_RECORD_TO_POST:"Любая полезная информация"})}]),t.factory("pipConversionDialog",["$mdDialog",function(t){return{show:function(e,n,a){function i(){e.event&&e.event.currentTarget&&e.event.currentTarget.focus()}e.event&&(e.event.stopPropagation(),e.event.preventDefault()),e.options&&0!=e.options.length&&t.show({targetEvent:e.event,templateUrl:"conversion_dialog/conversion_dialog.html",controller:"pipConversionDialogController",locals:{params:e},clickOutsideToClose:!0}).then(function(t){i(),n&&n(t)},function(){i(),a&&a()})}}}]),t.controller("pipConversionDialogController",["$scope","$rootScope","$mdDialog","params","pipUtils","pipTranslate",function(t,e,n,a,i,o){function l(){var t=$(".pip-conversion-dialog .pip-list");t.focus()}t.theme=e.$theme,t.title=a.title||"CONVERT_PARENT_TITLE",t.recordName=a.recordName||"",t.subtitle=a.subtitle||i.sprintf(o.translate("CONVERT_PARENT_SUBTITLE"),t.recordName),t.withoutTitle=a.deleteTitle?a.deleteTitle:!1,t.deleted=!!a.deleted,t.options=_.cloneDeep(a.options),t.selectedIndex=-1,t.cancelConverting=!!t.recordName,t.selectedOptionName="",t.cancelConverting&&t.options.push({name:"cancel",title:"CONVERT_TO_CANCEL",subtitle:i.sprintf(o.translate("CONVERT_TO_CANCEL_SUBTITLE"),t.recordName)}),t.onOptionSelect=function(e,n){e.stopPropagation(),t.selectedOptionName=n.name,t.onSelect()},t.onKeyPress=function(e){return 32==e.keyCode||13==e.keyCode?(e.stopPropagation(),e.preventDefault(),t.selectedOptionName=-1==t.selectedIndex?t.options[0].name:t.options[t.selectedIndex].name,void t.onSelect()):void 0},t.onKeyDown=function(e){return 40==e.keyCode?(e.stopPropagation(),e.preventDefault(),t.selectedIndex+=1,t.selectedIndex=t.selectedIndex%t.options.length,void(t.selectedOptionName=t.options[t.selectedIndex].name)):38==e.keyCode?(e.stopPropagation(),e.preventDefault(),t.selectedIndex=t.selectedIndex<=0?t.selectedIndex=t.options.length-1:t.selectedIndex-1,void(t.selectedOptionName=t.options[t.selectedIndex].name)):void 0},t.onCancel=function(){n.cancel()},t.onSelect=function(){var e=_.find(t.options,{name:t.selectedOptionName});e&&"cancel"!=e.name?n.hide({option:e,deleted:t.deleted}):n.hide(null)},setTimeout(l,500)}])}(),function(){"use strict";var t=angular.module("pipDate",["pipBasicControls.Templates"]);t.directive("pipDate",["$parse",function(t){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",ngChange:"&"},templateUrl:"date/date.html",controller:"pipDateController"}}]),t.controller("pipDateController",["$scope","$element","pipTranslate",function(t,e,n){function a(t,e){var n=31;4==t||6==t||9==t||11==t?n=30:2==t&&(n=e&&e%4==0?29:28);for(var a=[],i=1;n>=i;i++)a.push(i);return a}function i(){for(var t=[],e=1;12>=e;e++)t.push({id:e,name:n.translate("MONTH_"+e)});return t}function o(){var e=(new Date).getFullYear(),n="future"==t.timeMode?e:e-100,a="past"==t.timeMode?e:e+100,i=[];if("past"==t.timeMode)for(var o=a;o>=n;o--)i.push(o);else for(var o=n;a>=o;o++)i.push(o);return i}function l(){var e=a(t.month,t.year);t.days.length!=e.length&&(t.day>e.length&&(t.day=e.length),t.days=e)}function r(e){e=e?_.isDate(e)?e:new Date(e):null;var n=e?e.getDate():null,i=e?e.getMonth()+1:null,o=e?e.getFullYear():null;t.month!=i&&t.year!=o&&(t.days=a(t.month,t.year)),t.day=n,t.month=i,t.year=o}function s(){if(t.day&&t.month&&t.year){var e=new Date(t.year,t.month-1,t.day,0,0,0,0);t.model=e,t.ngChange()}}t.onDayChanged=function(){s()},t.onMonthChanged=function(){l(),s()},t.onYearChanged=function(){l(),s()};var p=t.model?_.isDate(t.model)?t.model:new Date(t.model):null;t.day=p?p.getDate():null,t.month=p?p.getMonth()+1:null,t.year=p?p.getFullYear():null,t.dayLabel=n.translate("DAY"),t.monthLabel=n.translate("MONTH"),t.yearLabel=n.translate("YEAR"),t.days=a(t.month,t.year),t.months=i(),t.years=o(),t.disableControls=t.disabled?t.disabled():!1,t.$watch("model",function(t,e){r(t)}),t.$watch(t.disabled,function(e){t.disableControls=e})}])}(),function(){"use strict";var t=angular.module("pipDateRange",[]);t.directive("pipDateRange",function(){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",pipChanged:"&",pipDateRangeType:"@",pipDateFormat:"@",pipNoLine:"@"},templateUrl:"date_range/date_range.html",controller:"pipDateRangeController"}}),t.controller("pipDateRangeController",["$scope","$element","pipTranslate","$mdMedia","$rootScope",function(t,e,n,a,i){function o(){x.day=t.day,x.month=t.month,x.year=t.year,x.week=t.week,x.dateRangeType=t.pipDateRangeType,x.model=t.model}function l(){t.days=d(t.month,t.year),t.weeks=m(t.month,t.year),t.months=g(),t.shortMonths=g(!0),t.years=f()}function r(){(!k.model||k.model&&k.model.getTime()>=t.model.getTime())&&t.weeks&&t.weeks[t.week]&&t.weeks[t.week].id<=0&&(t.month<12?t.month+=1:(t.month=1,t.year+=1),l())}function s(){var e=t.model?new Date(t.model):null;t.day=e?e.getUTCDate():null,t.month=e?e.getUTCMonth()+1:null,t.year=e?e.getUTCFullYear():null,t.week=e?c(t.day,t.month-1,t.year):null,l(),"weekly"==t.pipDateRangeType?(r(),v()):h(),C()}function p(t,e){var n=31;return 4==t||6==t||9==t||11==t?n=30:2==t&&(n=e&&e%4==0?29:28),n}function d(e,n){var a=p(e,n);t.nameDays=[];for(var o=[],l=1;a>=l;l++)o.push(l),t.nameDays.push(t.daysWeek[i.$language||"en"][new Date(n,e-1,l).getDay()]);return o}function c(t,e,n){var a,i=new Date(Date.UTC(n,e,t)),o=i.getUTCDay()?i.getUTCDay():7;return a=1==o?t:t+1-o}function u(t,e,n){var a=t+6>e?e-t-6:t+6,i=t>0?t:n+t;return i.toString()+" - "+Math.abs(a).toString()}function m(t,e){var n,a=[],i=p(t,e),o=c(1,t-1,e);for(n=t-1?p(t-1,e):p(12,e-1);i+1>o;)a.push({id:o,name:u(o,i,n)}),o+=7;return a}function g(t){for(var e=[],a=1;12>=a;a++)e.push({id:a,name:n.translate("MONTH_"+a)});return e}function f(){var e,n,a=[];switch(t.timeMode){case"future":e=b,n=b+100;break;case"past":e=b-100,n=b;break;case"now":e=b-50,n=b+100;break;default:e=b-50,n=b+50}if("future"==t.timeMode)for(var i=e;n>=i;i++)a.push(i);else for(var i=n;i>=e;i--)a.push(i);return a}function h(){var e=d(t.month,t.year);switch(t.pipDateRangeType){case"monthly":t.day=1;break;case"yearly":t.month=1,t.day=1;break;default:t.days.length!=e.length&&t.day>e.length&&(t.day=e.length)}t.days=e}function v(){var e=m(t.month,t.year);t.week=c(t.week,t.month-1,t.year),t.weeks=e}function T(e){e=e?new Date(e):null;var n=e?e.getUTCDate():null,a=e?e.getUTCMonth()+1:null,i=e?e.getUTCFullYear():null,o=e?c(n,a-1,i):null;t.day==n&&t.month==a&&t.year==i&&t.week==o||(t.day=n,t.month=a,t.year=i,t.week=o,t.days=d(t.month,t.year),t.weeks=m(t.month,t.year))}function C(){var e;"weekly"==t.pipDateRangeType?(e=new Date(t.year,t.month-1,t.week,0,0,0,0),e=new Date(e.getTime()-6e4*e.getTimezoneOffset()),t.model=e):(e=new Date(t.year,t.month-1,t.day,0,0,0,0),e=new Date(e.getTime()-6e4*e.getTimezoneOffset()),t.model=e),k=_.cloneDeep(x),o(),t.onChange()}var y=new Date,b=y.getUTCFullYear(),D=y.getUTCMonth()+1,w=y.getUTCDate(),k={},x={};t.daysWeek={en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ru:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},t.onDayChanged=function(){C()},t.onMonthChanged=function(){if("weekly"==t.pipDateRangeType){var e=new Date(Date.UTC(t.year,t.month-1,1)),n=e.getUTCDay()?e.getUTCDay():7;t.week=c(n,t.month-1,t.year),r(),v()}else h();C()},t.onYearChanged=function(){if("weekly"==t.pipDateRangeType){var e=new Date(Date.UTC(t.year,t.month-1,1)),n=e.getUTCDay()?e.getUTCDay():7;t.week=c(n,t.month-1,t.year),v(),r()}else h();C()},t.onWeekChange=function(){"weekly"==t.pipDateRangeType?(v(),r()):h(),C()},t.isDay=function(){return"daily"==t.pipDateRangeType},t.isWeek=function(){return"weekly"==t.pipDateRangeType},t.isMonth=function(){return"daily"==t.pipDateRangeType||"weekly"==t.pipDateRangeType||"monthly"==t.pipDateRangeType;
},t.onChange=function(){t.pipChanged&&t.pipChanged()},t.$mdMedia=a,s(),t.disableControls=t.disabled?t.disabled():!1,t.$watch("model",function(t,e){t!=e&&T(t)}),t.$watch(t.disabled,function(e){t.disableControls=e}),t.$watch("pipDateRangeType",function(t,e){t!=e&&e&&s()}),t.onYearClick=function(){null==t.year&&(t.year=b)},t.onMonthClick=function(){null==t.month&&(t.month=D)},t.onDayClick=function(){null==t.year&&(t.day=w)}}])}(),function(){"use strict";var t=angular.module("pipErrorDetailsDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{ERROR_DETAILS:"Error details",CODE:"Code",PATH:"Path",ERROR:"Error code",METHOD:"Method",MESSAGE:"Message"}),t.translations("ru",{ERROR_DETAILS:"Детали ошибки",CODE:"Код",PATH:"Путь",ERROR:"Код ошибки",METHOD:"Метод",MESSAGE:"Сообщение"})}]),t.factory("pipErrorDetailsDialog",["$mdDialog",function(t){return{show:function(e,n,a){t.show({targetEvent:e.event,templateUrl:"error_details_dialog/error_details_dialog.html",controller:"pipErrorDetailsDialogController",locals:{params:e},clickOutsideToClose:!0}).then(function(){n&&n()},function(){a&&a()})}}}]),t.controller("pipErrorDetailsDialogController",["$scope","$rootScope","$mdDialog","pipTranslate","params",function(t,e,n,a,i){t.error=i.error,t.ok=i.ok||"OK",t.cancel=i.cancel||"CANCEL",t.onCancel=function(){n.cancel()},t.onOk=function(){n.hide()}}])}(),function(){"use strict";var t=angular.module("pipImageSlider",[]);t.directive("pipImageSlider",function(){return{scope:!1,controller:["$scope","$element","$attrs","$parse","$timeout","$interval","$pipImageSlider",function(t,e,n,a,i,o,l){function r(){f&&f(t,h)}function s(){g=o(function(){u=h+1==c.length?0:h+1,m="next",y()},C||T)}function p(){o.cancel(g)}function d(){p(),s()}var c,u,m,g,f=a(n.pipImageSliderIndex).assign,h=0,v=a(n.pipAnimationType)(t),T=4500,C=a(n.pipAnimationInterval)(t);e.addClass("pip-image-slider"),e.addClass("pip-animation-"+v),t.swipeStart=0,r(),i(function(){c=e.find(".pip-animation-block"),c.length>0&&$(c[0]).addClass("pip-show")}),s();var y=_.throttle(function(){l.toBlock(v,c,h,u,m),h=u,r()},600);t.nextBlock=function(){d(),u=h+1==c.length?0:h+1,m="next",y()},t.prevBlock=function(){d(),u=0>h-1?c.length-1:h-1,m="prev",y()},t.slideTo=function(t){t==h||t>c.length-1||(d(),u=t,m=t>h?"next":"prev",y())},e.on("$destroy",function(){p()})}]}}),t.directive("pipSliderButton",function(){return{scope:{},controller:["$scope","$element","$parse","$attrs",function(t,e,n,a){var i=n(a.pipButtonType)(t),o=n(a.pipSliderId)(t);e.on("click",function(){o&&i&&angular.element(document.getElementById(o)).scope()[i+"Block"]()})}]}}),t.directive("pipSliderIndicator",function(){return{scope:!1,controller:["$scope","$element","$parse","$attrs",function(t,e,n,a){var i=n(a.pipSliderId)(t),o=n(a.pipSlideTo)(t);e.css("cursor","pointer"),e.on("click",function(){!i||o&&0>o||angular.element(document.getElementById(i)).scope().slideTo(o)})}]}}),t.service("$pipImageSlider",["$timeout",function(t){function e(e,n){e.removeClass("animated").addClass("pip-next"),t(function(){e.addClass("animated").addClass("pip-show").removeClass("pip-next"),n.addClass("animated").removeClass("pip-show")},100)}function n(e,n){e.removeClass("animated"),t(function(){e.addClass("animated").addClass("pip-show"),n.addClass("animated").addClass("pip-next").removeClass("pip-show"),t(function(){n.removeClass("pip-next").removeClass("animated")},i-100)},100)}function a(t,a,i,o,l){var r=$(a[i]),s=o,p=$(a[s]);"carousel"==t?($(a).removeClass("pip-next").removeClass("pip-prev"),l&&"prev"==l?n(p,r):l&&"next"==l?e(p,r):o&&i>o?n(p,r):e(p,r)):(r.addClass("animated").removeClass("pip-show"),p.addClass("animated").addClass("pip-show"))}var i=550;return{nextCarousel:e,prevCarousel:n,toBlock:a}}])}(),function(){"use strict";var t=angular.module("pipMarkdown",["ngSanitize","pipUtils","pipTranslate"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{MARKDOWN_ATTACHMENTS:"Attachments:",checklist:"Checklist",documents:"Documents",pictures:"Pictures",location:"Location",time:"Time"}),t.translations("ru",{MARKDOWN_ATTACHMENTS:"Вложения:",checklist:"Список",documents:"Документы",pictures:"Изображения",location:"Местонахождение",time:"Время"})}]),t.directive("pipMarkdown",["$parse","pipUtils","pipTranslate",function(t,e,n){return{restrict:"EA",scope:!1,link:function(a,i,o){function l(t){var e="",a=[];return _.each(t,function(t){t.type&&"text"!=t.type&&(0==e.length&&(e=n.translate("MARKDOWN_ATTACHMENTS")),a.indexOf(t.type)<0&&(a.push(t.type),e+=(a.length>1?", ":" ")+n.translate(t.type)))}),e}function r(t){var e;if(_.isArray(t)){var n=_.find(t,function(t){return"text"==t.type&&t.text});e=n?n.text:l(t)}else e=t;var a,r=o.pipLineCount&&_.isNumber(d())&&e&&e.length>0,s={gfm:!0,tables:!0,breaks:!0,sanitize:!0,pedantic:!0,smartLists:!0,smartypents:!1};e=marked(e||"",s),r&&(a=1.5*d()),i.html("<div"+(r?p()?' class="pip-markdown-content pip-markdown-list" style="max-height: '+a+'em">':' class="pip-markdown-content" style="max-height: '+a+'em">':p()?' class="pip-markdown-list">':">")+e+"</div>"),i.find("a").attr("target","blank"),!p()&&r&&i.append('<div class="pip-gradient-block"></div>')}var s=t(o.pipText),p=t(o.pipList),d=t(o.pipLineCount);r(s(a)),e.toBoolean(o.pipRebind)&&a.$watch(s,function(t){r(t)}),a.$on("pipWindowResized",function(){r(s(a))}),i.addClass("pip-markdown")}}}])}(),function(){"use strict";var t=angular.module("pipInformationDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{INFORMATION_TITLE:"Information"}),t.translations("ru",{INFORMATION_TITLE:"Информация"})}]),t.factory("pipInformationDialog",["$mdDialog","$timeout",function(t,e){return{show:function(e,n){t.show({targetEvent:e.event,templateUrl:"information_dialog/information_dialog.html",controller:"pipInformationDialogController",locals:{params:e},clickOutsideToClose:!0}).then(function(){n&&n()})}}}]),t.controller("pipInformationDialogController",["$scope","$rootScope","$mdDialog","pipTranslate","params","pipUtils",function(t,e,n,a,i,o){t.theme=e.$theme,t.title=i.title||"INFORMATION_TITLE";var l=a.translate(i.message);if(i.item){var r=_.truncate(i.item,25);l=o.sprintf(l,r)}t.content=l,t.ok=i.ok||"OK",t.onOk=function(){n.hide()}}])}(),function(){"use strict";var t=angular.module("pipOptionsDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{OPTIONS_TITLE:"Choose Option"}),t.translations("ru",{OPTIONS_TITLE:"Выберите опцию"})}]),t.factory("pipOptionsDialog",["$mdDialog",function(t){return{show:function(e,n,a){function i(){e.event&&e.event.currentTarget&&e.event.currentTarget.focus()}e.event&&(e.event.stopPropagation(),e.event.preventDefault()),t.show({targetEvent:e.event,templateUrl:"options_dialog/options_dialog.html",controller:"pipOptionsDialogController",locals:{params:e},clickOutsideToClose:!0}).then(function(t){i(),n&&n(t)},function(){i(),a&&a()})}}}]),t.controller("pipOptionsDialogController",["$scope","$rootScope","$mdDialog","params",function(t,e,n,a){function i(){var t=$(".pip-options-dialog .pip-list");t.focus()}t.theme=e.$theme,t.title=a.title||"OPTIONS_TITLE",t.options=a.options,t.selectedOption=_.find(a.options,{active:!0})||{},t.selectedOptionName=t.selectedOption.name,t.applyButtonTitle=a.appleButtonTitle||"SELECT",t.deleted=a.deleted,t.deletedTitle=a.deletedTitle,t.onOptionSelect=function(e,n){e.stopPropagation(),t.selectedOptionName=n.name},t.onKeyPress=function(e){32!=e.keyCode&&13!=e.keyCode||(e.stopPropagation(),e.preventDefault(),t.onSelect())},t.onCancel=function(){n.cancel()},t.onSelect=function(){var e=_.find(a.options,{name:t.selectedOptionName});n.hide({option:e,deleted:t.deleted})},setTimeout(i,500)}])}(),function(){"use strict";var t=angular.module("pipOptionsBigDialog",["ngMaterial","pipUtils","pipTranslate","pipBasicControls.Templates"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{OPTIONS_TITLE:"Choose Option"}),t.translations("ru",{OPTIONS_TITLE:"Выберите опцию"})}]),t.factory("pipOptionsBigDialog",["$mdDialog",function(t){return{show:function(e,n,a){function i(){e.event&&e.event.currentTarget&&e.event.currentTarget.focus()}e.event&&(e.event.stopPropagation(),e.event.preventDefault()),t.show({targetEvent:e.event,templateUrl:"options_dialog/options_dialog_big.html",controller:"pipOptionsDialogBigController",locals:{params:e},clickOutsideToClose:!0}).then(function(t){i(),n&&n(t)},function(){i(),a&&a()})}}}]),t.controller("pipOptionsDialogBigController",["$scope","$rootScope","$mdDialog","params",function(t,e,n,a){function i(){var t=$(".pip-options-dialog .pip-list");t.focus()}t.theme=e.$theme,t.title=a.title||"OPTIONS_TITLE",t.options=a.options,t.noActions=a.noActions||!1,t.noTitle=a.noTitle||!1,t.hint=a.hint||"",t.selectedOption=_.find(a.options,{active:!0})||{},t.selectedOptionName=t.selectedOption.name,t.optionIndex=_.findIndex(a.options,t.selectedOption),t.applyButtonTitle=a.applyButtonTitle||"SELECT",t.deleted=a.deleted,t.deletedTitle=a.deletedTitle,t.onOptionSelect=function(e,n){e.stopPropagation(),t.selectedOptionName=n.name,t.noActions&&t.onSelect()},t.onSelected=function(e){t.selectedOptionName=t.options[t.optionIndex].name,t.noActions},t.onKeyUp=function(e,n){32!=e.keyCode&&13!=e.keyCode||(e.stopPropagation(),e.preventDefault(),void 0!=n&&n>-1&&n<t.options.length&&(t.selectedOptionName=t.options[n].name,t.onSelect()))},t.onCancel=function(){n.cancel()},t.onSelect=function(){var e=_.find(t.options,{name:t.selectedOptionName});n.hide({option:e,deleted:t.deleted})},setTimeout(i,500)}])}(),function(){"use strict";var t=angular.module("pipPopover",["pipAssert"]);t.directive("pipPopover",function(){return{restrict:"EA",scope:!0,templateUrl:"popover/popover.template.html",controller:["$scope","$rootScope","$element","$timeout","$compile",function(t,e,n,a,i){function o(){u.addClass("opened"),$(".pip-popover-backdrop").focus(),t.params.timeout&&a(function(){r()},t.params.timeout)}function l(){t.params.cancelCallback&&t.params.cancelCallback(),r()}function r(){u.removeClass("opened"),a(function(){u.remove()},100)}function s(t){t.stopPropagation()}function p(){if(t.params.element){var e=$(t.params.element),n=e.offset(),a=e.width(),i=e.height(),o=$(document).width(),l=$(document).height(),r=u.find(".pip-popover");n&&r.css("max-width",o-(o-n.left)).css("max-height",l-(n.top+i)-32,0).css("left",n.left-r.width()+a/2).css("top",n.top+i+16)}}function d(){if(t.params.calcHeight!==!1){var e=u.find(".pip-popover"),n=e.find(".pip-title"),a=e.find(".pip-footer"),i=e.find(".pip-content"),o=e.height()-n.outerHeight(!0)-a.outerHeight(!0);i.css("max-height",Math.max(o,0)+"px").css("box-sizing","border-box")}}function c(){u.find(".pip-popover").find(".pip-content").css("max-height","100%"),p(),d()}var u=$(".pip-popover-backdrop");u.on("click keydown scroll",l),u.addClass(t.params.responsive!==!1?"pip-responsive":""),a(function(){if(p(),t.params.template){var e=i(t.params.template)(t);n.find(".pip-popover").append(e)}o()}),a(function(){d()},200),t.onPopoverClick=s,t=_.defaults(t,t.$parent),e.$on("pipPopoverResize",c),$(window).resize(c)}]}}),t.service("$pipPopover",["$compile","$rootScope","$timeout",function(t,e,n){function a(n){var a=$("body");if(!(a.find("md-backdrop").length>0)){i();var o,r=e.$new(),n=n&&_.isObject(n)?n:{};r.params=n,r.locals=n.locals,o=t(l)(r),a.append(o)}}function i(){var t=$(".pip-popover-backdrop");t.removeClass("opened"),n(function(){t.remove()},100)}function o(){e.$broadcast("pipPopoverResize")}var l="<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'><pip-popover pip-params='params'></pip-popover></div>";return{show:a,hide:i,resize:o}}])}(),function(){"use strict";var t=angular.module("pipRoutingProgress",["ngMaterial"]);t.directive("pipRoutingProgress",function(){return{restrict:"EA",replace:!0,templateUrl:"progress/routing_progress.html"}})}(),function(){"use strict";var t=angular.module("pipRefreshButton",["ngMaterial"]);t.directive("pipRefreshButton",["$parse",function(t){return{restrict:"EA",scope:!1,template:String()+'<md-button class="pip-refresh-button" tabindex="-1" ng-click="onClick($event)" aria-label="REFRESH"><md-icon md-svg-icon="icons:refresh"></md-icon> <span class="pip-refresh-text"></span></md-button>',replace:!1,link:function(e,n,a){function i(){s.hide()}var o=t(a.pipText),l=t(a.pipVisible),r=t(a.pipRefresh),s=n.children(".md-button"),p=s.children(".pip-refresh-text"),d=function(){var t=o(e);p.text(t),s.show();var n=s.width();s.css("margin-left","-"+n/2+"px")};e.onClick=function(t){r(e)},e.$watch(l,function(t){1==t?d():i()}),e.$watch(o,function(t){p.text(t)})}}}])}(),function(){"use strict";var t=angular.module("pipTagList",["pipCore"]);t.directive("pipTagList",["$parse",function(t){return{restrict:"EA",scope:{pipTags:"=",pipType:"=",pipTypeLocal:"="},templateUrl:"tags/tag_list.html",controller:["$scope","$element","$attrs","pipUtils",function(e,n,a,i){var o=t(a.pipTags);n.css("display","block"),e.tags=o(e),i.toBoolean(a.pipRebind)&&e.$watch(o,function(t){e.tags=o(e)}),n.addClass("pip-tag-list")}]}}])}(),function(){"use strict";var t=angular.module("pipTimeEdit",["pipUtils","pipTranslate"]);t.directive("pipTimeEdit",function(){return{restrict:"EA",scope:{pipStartDate:"=",pipChanged:"&",pipEndDate:"=",pipStartLabel:"@",pipEndLabel:"@",disabled:"&ngDisabled",pipSize:"="},templateUrl:"time_edit/time_edit.html",controller:"pipTimeEditController"}}),t.controller("pipTimeEditController",["$scope","$element","$attrs","pipDates","pipTranslate",function(t,e,n,a,i){function o(t){var e=t?new Date(t):null;return e}function l(){if(!t.data.startDate||!t.data.endDate)return null;var e,n;return e=new Date(t.data.startDate.getTime()+60*t.data.startTime*1e3),n=new Date(t.data.endDate.getTime()+60*t.data.endTime*1e3),n-e}function r(){if(!t.data.startDate)return void(t.data.startTime=null);if(!t.data.startTime)if(t.data.endTime)t.data.startTime=0==t.data.endTime?0:t.data.endTime-30;else{var e=new Date;t.data.startTime=30*Math.floor((e.getTime()-a.toStartDay(e))/18e5)}if(!t.data.endDate)return void(t.data.endTime=null);var n,i;n=new Date(t.data.startDate.getTime()+60*t.data.startTime*1e3),t.data.duration?(i=new Date(n.getTime()+t.data.duration),t.data.endDate=a.toStartDay(i),t.data.endTime=30*Math.floor((i.getTime()-t.data.endDate.getTime())/18e5)):(i=new Date(t.data.endDate.getTime()+60*t.data.endTime*1e3),n>=i&&(t.data.endDate=a.toStartDay(new Date(n.getTime()+18e5)),t.data.endTime=(t.data.startTime+30)%1440))}function s(){if(!t.data.endDate)return void(t.data.endTime=null);if(!t.data.endTime)if(t.data.startTime)t.data.endTime=1410==t.data.startTime?1410:t.data.startTime+30;else{var e=new Date;t.data.endTime=30*Math.floor((e.getTime()-a.toStartDay(e))/18e5)}if(!t.data.startDate)return void(t.data.startTime=null);var n,i;n=new Date(t.data.startDate.getTime()+60*t.data.startTime*1e3),i=new Date(t.data.endDate.getTime()+60*t.data.endTime*1e3),n>=i&&(t.data.startDate=a.toStartDay(new Date(i.getTime()-18e5)),t.data.startTime=t.data.endTime%1440==0?1410:t.data.endTime-30),t.data.duration=l()}function p(){if(t.data.bind=!1,t.data.startDate){var e=t.data.startTime?60*t.data.startTime*1e3:0;t.pipStartDate=new Date(t.data.startDate.getTime()+e)}if(t.data.endDate){var e=t.data.endTime?60*t.data.endTime*1e3:0;t.pipEndDate=new Date(t.data.endDate.getTime()+e)}t.data.bind=!0}function d(){var e,n;if(null!==t.pipStartDate&&void 0!==t.pipStartDate){var e=_.isDate(t.pipStartDate)?t.pipStartDate:null;e||(e=o(t.pipStartDate)),t.data.startDate=a.toStartDay(e),t.data.startTime=(new Date(e)-t.data.startDate)/6e4}if(null!==t.pipEndDate&&void 0!==t.pipEndDate){var n=_.isDate(t.pipEndDate)?t.pipEndDate:null;e||(n=o(t.pipEndDate)),t.data.endDate=a.toStartDay(n),t.data.endTime=(new Date(n)-t.data.endDate)/6e4}r(),t.data.duration=l(),p()}function c(){for(var t=[],e=0;24>e;e++)for(var n=0;2>n;n++){var a=30*n;t.push({id:60*e+a,time:_.pad(e.toString(),3,"0").substr(0,2)+":"+_.pad(a.toString(),2,"0")})}return t}function u(){t.data.startDate=null,t.data.startTime=null,t.data.endDate=null,t.data.endTime=null,t.data.duration=null}t.intervalTimeCollection=c(),t.data={},t.startLabel=t.pipStartLabel?i.translate(t.pipStartLabel):i.translate("EVENT_NEW_START_TIME"),t.endLabel=t.pipEndLabel?i.translate(t.pipEndLabel):i.translate("EVENT_NEW_END_TIME"),u(),d(),t.onChangeStartDate=function(){r(),t.data.duration=l(),p(),t.pipChanged()},t.onChangeEndDate=function(){s(),t.data.duration=l(),p(),t.pipChanged()},t.onChangeStartTime=function(){t.data.startDate||(t.data.startDate=a.toStartDay(new Date)),r(),t.data.duration=l(),p(),t.pipChanged()},t.onChangeEndTime=function(){t.data.endDate||(t.data.endDate=a.toStartDay(new Date)),s(),t.data.duration=l(),p(),t.pipChanged()},t.isDisabled=function(){return t.disabled?t.disabled():!1},t.$watchGroup([t.pipStartDate,t.pipEndDate],function(){t.data.bind&&(u(),d())}),t.$watch(t.disabled,function(e){t.disableControls=e}),e.addClass("pip-time-edit")}])}(),function(){"use strict";var t=angular.module("pipTimeView",["pipUtils"]);t.directive("pipTimeView",["pipUtils",function(t){return{restrict:"EA",scope:{pipStartDate:"=",pipEndDate:"="},templateUrl:"time_view/time_view.html",link:function(e,n,a){function i(t){var e=t?new Date(t):null;return e}function o(){null!==e.pipStartDate&&void 0!==e.pipStartDate&&(e.data.start=_.isDate(e.pipStartDate)?e.pipStartDate:i(e.pipStartDate))}function l(){null!==e.pipEndDate&&void 0!==e.pipEndDate&&(e.data.end=_.isDate(e.pipEndDate)?e.pipEndDate:i(e.pipEndDate))}e.data={},e.data.start=null,e.data.end=null,o(),l(),t.toBoolean(a.pipRebind)&&(e.$watch("pipStartDate",function(t){e.data.start=null,o()}),e.$watch("pipEndDate",function(t){e.data.end=null,l()})),n.addClass("pip-time-view")}}}])}(),function(){"use strict";var t=angular.module("pipToasts",["pipTranslate","ngMaterial","pipAssert"]);t.controller("pipToastController",["$scope","$mdToast","toast","pipErrorDetailsDialog","sounds",function(t,e,n,a,i){t.message=n.message,t.actions=n.actions,t.toast=n,0==n.actions.length?t.actionLenght=0:1==n.actions.length?t.actionLenght=n.actions[0].toString().length:t.actionLenght=null,console.log(t.actionLenght),t.onDetails=function(n){e.hide(),a.show({error:t.toast.error,ok:"Ok"},function(){console.log("You agreed")},function(){console.log("You disagreed")})},t.onAction=function(t){e.hide({action:t})}}]),t.service("pipToasts",["$rootScope","$mdToast","pipAssert",function(t,e,n){function a(){if(C.length>0){var t=C[0];C.splice(0,1),i(t)}}function i(t){h=t,e.show({templateUrl:"toast/toast.html",hideDelay:t.duration||v,position:"bottom left",controller:"pipToastController",locals:{toast:h,sounds:y}}).then(function(t){h.successCallback&&h.successCallback(t),h=null,a()},function(t){h.cancelCallback&&h.cancelCallback(t),h=null,a()})}function o(t){h&&"error"!=t.type?C.push(t):i(t)}function l(t){var e=[];_.each(C,function(n){n.type&&n.type==t||e.push(n)}),C=_.cloneDeep(e)}function r(t){_.remove(C,{id:t})}function s(t){return _.find(C,{id:t})}function p(t,n,i,o,l){C=_.reject(C,function(t){return"error"==t.type}),h&&"error"==h.type&&(e.cancel(),a())}function d(t){f()}function c(t,e,a,i,l){n.isDef(t,"pipToasts.showNotification: message should be defined"),n.isString(t,"pipToasts.showNotification: message should be a string"),n.isArray(e||[],"pipToasts.showNotification: actions should be an array"),a&&n.isFunction(a,"pipToasts.showNotification: successCallback should be a function"),i&&n.isFunction(i,"pipToasts.showNotification: cancelCallback should be a function"),o({id:l||null,type:"notification",message:t,actions:e||["ok"],successCallback:a,cancelCallback:i,duration:T})}function u(t,e,a,i){n.isDef(t,"pipToasts.showMessage: message should be defined"),n.isString(t,"pipToasts.showMessage: message should be a string"),e&&n.isFunction(e,"pipToasts.showMessage: successCallback should be a function"),a&&n.isFunction(a,"pipToasts.showMessage: cancelCallback should be a function"),o({id:i||null,type:"message",message:t,actions:["ok"],successCallback:e,cancelCallback:a})}function m(t,e,a,i,l){n.isDef(t,"pipToasts.showError: message should be defined"),n.isString(t,"pipToasts.showError: message should be a string"),e&&n.isFunction(e,"pipToasts.showError: successCallback should be a function"),a&&n.isFunction(a,"pipToasts.showError: cancelCallback should be a function"),o({id:i||null,error:l,type:"error",message:t,actions:["ok"],successCallback:e,cancelCallback:a})}function g(){e.cancel(),C=[]}function f(t){t?(n.isString(t,"pipToasts.clearToasts: type should be a string"),l(t)):(e.cancel(),C=[])}var h,v=2e4,T=2e4,C=[],y={};return t.$on("$stateChangeSuccess",p),t.$on("pipSessionClosed",d),{showNotification:c,showMessage:u,showError:m,hideAllToasts:g,clearToasts:f,removeToastsById:r,getToastById:s}}])}(),function(){"use strict";var t=angular.module("pipToggleButtons",["pipBasicControls.Templates"]);t.directive("pipToggleButtons",function(){return{restrict:"EA",scope:{ngDisabled:"&",buttons:"=pipButtons",currentButtonValue:"=ngModel",currentButton:"=?pipButtonObject",change:"&ngChange"},templateUrl:"toggle_buttons/toggle_buttons.html",controller:["$scope","$element","$attrs","$mdMedia","$timeout",function(t,e,n,a,i){t.$mdMedia=a,t["class"]=n["class"]||"",(!t.buttons||_.isArray(t.buttons)&&0===t.buttons.length)&&(t.buttons=[],console.error("PipToggleButtons: attribute pipButtons should take array of buttons"));var o=_.indexOf(t.buttons,_.find(t.buttons,{id:t.currentButtonValue}));t.currentButtonIndex=0>o?0:o,t.currentButton=t.buttons.length>0?t.buttons[t.currentButtonIndex]:t.currentButton,t.buttonSelected=function(e,n){t.disabled()||(t.currentButtonIndex=e,t.currentButton=t.buttons[t.currentButtonIndex],t.currentButtonValue=t.currentButton.id||e,i(function(){t.$apply(),t.change&&t.change()}))},t.enterSpacePress=function(e){t.buttonSelected(e.index)},t.disabled=function(){return t.ngDisabled?t.ngDisabled():void 0}}],link:function(t,e,n){e.on("focusin",function(){e.addClass("focused-container")}).on("focusout",function(){e.removeClass("focused-container")})}}})}();
!function(){"use strict";angular.module("pipNav",["pipDropdown","pipTabs","pipAppBar","pipSideNav"])}(),function(n){try{n=angular.module("pipNav.Templates")}catch(e){n=angular.module("pipNav.Templates",[])}n.run(["$templateCache",function(n){n.put("appbar/appbar.html",'<md-toolbar md-theme-watch="true" ng-if="!$partialReset" ng-class="config.ngClasses" class="{{ config.cssClass }}"><div class="md-toolbar-tools rp24-flex lp24-flex" ng-if="!searchEnabled"><md-button class="md-icon-button flex-fixed p0" ng-if="config.navIconType != \'none\'" ng-class="{ \'pip-third-party\': getParty() && !getUser(\'owner\') }" ng-click="onNavIconClick()" aria-label="menu"><md-icon ng-if="config.navIconType==\'menu\' && (!getParty() || getUser(\'owner\'))" md-svg-icon="icons:menu"></md-icon><pip-avatar ng-if="config.navIconType==\'menu\' && (getParty() && !getUser(\'owner\'))" pip-rebind-avatar="true" pip-rebind="true" pip-party-id="getParty(\'id\')" class="pip-face" pip-party-name="getParty(\'name\')"></pip-avatar><md-icon ng-if="config.navIconType==\'back\'" md-svg-icon="icons:arrow-left"></md-icon></md-button><div class="flex-var text-overflow"><img class="pip-appbar-logo" ng-if="config.titleType == \'logo\'" ng-src="{{config.titleLogo}}"><div ng-if="config.titleType == \'text\'" class="text-overflow pip-appbar-text"><span ng-if="config.searchCriteria" ng-click="onSearchEnable()">{{config.searchCriteria}} -</span><span class="text-overflow">{{config.titleText | translate}}</span></div><div ng-if="config.titleType==\'breadcrumb\'"><div class="hide-xs text-overflow"><span ng-if="config.searchCriteria" ng-click="onSearchEnable()">{{config.searchCriteria}} -</span><span class="pip-appbar-breadcrumb" ng-repeat-start="item in config.titleBreadcrumb" ng-click="onBreadcrumbClick(item)" ng-init="stepWidth = 100/(config.titleBreadcrumb.length + 1)" ng-style="{\'max-width\': stepWidth + \'%\'}">{{item.title | translate}}</span><md-icon ng-repeat-end="" md-svg-icon="icons:chevron-right"></md-icon><span class="pip-title">{{config.titleText | translate}}</span></div><md-menu xmd-offset="0 48" class="hide-gt-xs"><span class="pip-appbar-mobile-breadcrumb" layout="row" ng-click="$mdOpenMenu()" md-ink-ripple="" aria-label="open breadcrumb"><span class="text-overflow"><span ng-if="config.searchCriteria" ng-click="onSearchEnable()">{{config.searchCriteria}} -</span> {{config.titleText | translate}}</span><md-icon class="m0 flex-none" md-svg-icon="icons:triangle-down"></md-icon></span><md-menu-content width="3"><md-menu-item ng-repeat="item in config.titleBreadcrumb"><md-button ng-click="onBreadcrumbClick(item)"><span>{{item.title | translate}}</span></md-button></md-menu-item><md-menu-item><md-button><span class="text-grey">{{config.titleText | translate}}</span></md-button></md-menu-item></md-menu-content></md-menu></div></div><div class="flex-fixed pip-appbar-actions" layout="row" ng-class="{ \'pip-language-action\': config.actionsType==\'language\' }"><md-menu ng-if="config.actionsType==\'language\'" md-position-mode="target-right target"><span class="pip-appbar-language" ng-click="$mdOpenMenu()" aria-label="language selection">{{language() | translate}}<md-icon md-svg-icon="icons:triangle-down"></md-icon></span><md-menu-content width="3"><md-menu-item ng-repeat="lang in config.languages"><md-button ng-click="onLanguageClick(lang)">{{lang | translate}}</md-button></md-menu-item></md-menu-content></md-menu><md-button class="md-icon-button m0" ng-if="config.searchVisible" ng-click="onSearchEnable()" aria-label="open search"><md-icon md-svg-icon="icons:search"></md-icon></md-button><div ng-if="config.actionsType==\'list\'"><md-menu md-position-mode="target-right target" ng-repeat="action in config.primaryGlobalActions"><md-button class="pip-appbar-action md-icon-button m0" ng-class="{ \'pip-appbar-hide-sm\': action.hideSmall }" ng-click="onActionClick(action, $mdOpenMenu);" ng-hide="actionHidden(action)" aria-label="{{action.tooltip | translate}}"><div class="pip-appbar-badge color-badge-bg" ng-if="action.count > 0">{{actionCount(action)}}</div><md-icon md-svg-icon="{{action.icon}}"></md-icon></md-button><md-menu-content width="3" ng-show="action.menu"><md-menu-item ng-repeat-start="subAction in action.subActions" ng-if="!subAction.divider" ng-hide="actionHidden(subAction)"><md-button ng-hide="subAction.divider" ng-click="onActionClick(subAction)">{{subAction.title | translate}}</md-button></md-menu-item><md-menu-divider ng-if="subAction.divider" ng-repeat-end=""></md-menu-divider></md-menu-content></md-menu><md-menu md-position-mode="target-right target" ng-repeat="action in config.primaryLocalActions"><md-button class="pip-appbar-action md-icon-button m0" ng-class="{ \'pip-appbar-hide-sm\': action.hideSmall, \'pip-appbar-show-sm\': action.showSmall,}" ng-click="onActionClick(action, $mdOpenMenu);" ng-hide="actionHidden(action)" aria-label="{{action.tooltip | translate}}"><div class="pip-appbar-badge" ng-show="action.count > 0">{{actionCount(action)}}</div><md-icon md-svg-icon="{{action.icon}}"></md-icon></md-button><md-menu-content width="3"><md-menu-item ng-repeat-start="subAction in action.subActions" ng-if="!subAction.divider" ng-hide="actionHidden(subAction)"><md-button ng-hide="subAction.divider" ng-click="onActionClick(subAction)">{{subAction.title | translate}}</md-button></md-menu-item><md-menu-divider ng-if="subAction.divider" ng-repeat-end=""></md-menu-divider></md-menu-content></md-menu><md-menu ng-if="secondaryActionsVisible()" md-position-mode="target-right target"><md-button class="md-icon-button m0" ng-click="onSecondaryActionClick(); openMenu($mdOpenMenu, $event);" aria-label="open actions"><md-icon md-svg-icon="icons:vdots"></md-icon></md-button><md-menu-content width="3"><md-menu-item ng-repeat-start="action in config.secondaryLocalActions" ng-if="!action.divider" ng-hide="actionHidden(action)"><md-button ng-hide="action.divider" ng-click="onActionClick(action)">{{action.title | translate}}</md-button></md-menu-item><md-menu-divider ng-if="action.divider" ng-repeat-end=""></md-menu-divider><md-menu-divider ng-if="secondaryDividerVisible()"></md-menu-divider><md-menu-item ng-repeat-start="action in config.secondaryGlobalActions" ng-if="!action.divider" ng-hide="actionHidden(action)"><md-button ng-hide="action.divider" ng-click="onActionClick(action)">{{action.title | translate}}</md-button></md-menu-item><md-menu-divider ng-if="action.divider" ng-repeat-end=""></md-menu-divider></md-menu-content></md-menu></div></div></div><div class="md-toolbar-tools" layout="row" ng-if="searchEnabled"><md-button class="md-icon-button" aria-label="start search" ng-click="onSearchClick()"><md-icon md-svg-icon="icons:search"></md-icon></md-button><input class="pip-search-text" type="search" flex="" ng-model="search.text" ng-keydown="onSearchKeyDown($event)"><md-button class="md-icon-button" aria-label="clear search" ng-click="onSearchClear()"><md-icon md-svg-icon="icons:cross-circle"></md-icon></md-button></div></md-toolbar>')}])}(),function(n){try{n=angular.module("pipNav.Templates")}catch(e){n=angular.module("pipNav.Templates",[])}n.run(["$templateCache",function(n){n.put("dropdown/dropdown.html",'<md-content class="md-subhead md-hue-1 {{class}}" ng-if="show()" ng-class="{\'md-whiteframe-3dp\': $mdMedia(\'xs\')}"><div class="pip-divider position-top m0"></div><md-select ng-model="selectedIndex" ng-disabled="disabled()" md-container-class="pip-full-width-dropdown" aria-label="DROPDOWN" md-ink-ripple="" md-on-close="onSelect(selectedIndex)"><md-option ng-repeat="action in actions" value="{{ ::$index }}" ng-selected="activeIndex == $index ? true : false">{{ (action.title || action.name) | translate }}</md-option></md-select></md-content>')}])}(),function(n){try{n=angular.module("pipNav.Templates")}catch(e){n=angular.module("pipNav.Templates",[])}n.run(["$templateCache",function(n){n.put("sidenav/sidenav.html",'<md-sidenav class="md-sidenav-left md-whiteframe-z2 pip-sidenav" md-component-id="pip-sidenav" ng-if="!$partialReset" pip-focused=""><md-toolbar class="pip-sidenav-header" ng-class="{\'pip-sidenav-owner\': $user.owner}" md-theme="{{ $theme|| $user.theme || config.theme }}" ng-hide="!$party"><md-button class="pip-sidenav-party md-icon-button" ng-click="onPartyClick()" aria-label="current party"><pip-avatar ng-if="!$avatarReset" pip-party-id="$party.id" pip-default-icon="icon-person" pip-party-name="$party.name" pip-rebind-avatar="true" pip-rebind="true"></pip-avatar></md-button><md-button class="pip-sidenav-user md-icon-button" ng-click="onUserClick()" ng-hide="$user.owner" aria-label="current user"><pip-avatar class="pic-pic pip-face-ld" ng-if="!$avatarReset" pip-default-icon="icon-person" pip-rebind="true" pip-rebind-avatar="true" pip-party-id="$user.id" pip-party-name="$user.name"></pip-avatar></md-button><div class="pip-sidenav-party-text"><a class="pip-sidenav-party-pri cursor-pointer" ng-click="onPartyClick()">{{$party.name}}</a><div class="pip-sidenav-party-sec" ng-show="$connection && !$user.owner">{{$connection.relation | translate}} <span ng-show="$connection.relation_since">{{::\'SIDENAV_SINCE\' | translate}} {{$connection.relation_since | formatLongDate}}</span></div></div></md-toolbar><md-list><div class="pip-section" ng-repeat="section in config.sections" ng-hide="section.access && !section.access($party, $user, section)"><md-divider ng-show="$index > 0 && !isSectionEmpty(section.links)"></md-divider><md-subheader ng-show="section.title">{{::section.title | translate}}</md-subheader><md-list-item class="pip-focusable no-border" ng-repeat="link in section.links" ng-click="onLinkClick($event, link)" ng-hide="link.access && !link.access($party, $user, link)"><md-icon md-svg-icon="{{link.icon}}" ng-hide="!link.icon" class="tm0 bm0"></md-icon><p>{{::link.title | translate}}</p></md-list-item></div></md-list></md-sidenav>')}])}(),function(n){try{n=angular.module("pipNav.Templates")}catch(e){n=angular.module("pipNav.Templates",[])}n.run(["$templateCache",function(n){n.put("tabs/tabs.html",'<md-toolbar class="pip-nav {{ class }}" ng-class="{\'pip-visible\': show(), \'pip-shadow\': showShadow()}"><md-tabs class="hide-xs" md-selected="activeTab" ng-class="{\'disabled\': disabled()}" md-stretch-tabs="true" md-dynamic-height="true"><md-tab ng-repeat="tab in tabs" ng-disabled="tabDisabled($index)" md-on-select="onSelect($index)"><md-tab-label>{{ (tab.title || tab.name) | translate }}<div class="pip-tabs-badge color-badge-bg" ng-if="tab.newCounts > 0 && tab.newCounts <= 99">{{ tab.newCounts }}</div><div class="pip-tabs-badge color-badge-bg" ng-if="tab.newCounts > 99">!</div></md-tab-label></md-tab></md-tabs><md-content class="md-subhead md-hue-1 show-xs hide-sm hide-gt-sm"><div class="pip-divider position-top m0"></div><md-select ng-model="activeIndex" ng-disabled="disabled()" md-container-class="pip-full-width-dropdown" aria-label="SELECT" md-ink-ripple="" md-on-close="onSelect(activeIndex)"><md-option ng-repeat="tab in tabs" value="{{ ::$index }}">{{ (tab.title || tab.name) | translate }}<div class="pip-tabs-badge color-badge-bg" ng-if="tab.newCounts > 0 && tab.newCounts <= 99">{{ tab.newCounts }}</div><div class="pip-tabs-badge color-badge-bg" ng-if="tab.newCounts > 99">!</div></md-option></md-select></md-content></md-toolbar>')}])}(),function(){"use strict";var n=angular.module("pipAppBar",["ngMaterial","pipTranslate","pipNav.Templates","pipAppBar.Service"]);n.config(["pipTranslateProvider",function(n){n.translations("en",{APPBAR_SEARCH:"Search"}),n.translations("ru",{APPBAR_SEARCH:"Поиск"})}]),n.directive("pipAppbar",function(){return{restrict:"E",scope:{title:"=pipTitle",showMenu:"=pipShowMenu",localActions:"=pipLocalActions",globalActions:"=pipGlobalActions"},replace:!1,templateUrl:function(n,e){return"appbar/appbar.html"},controller:"pipAppBarController"}}),n.controller("pipAppBarController",["$scope","$element","$attrs","$rootScope","$window","$state","$location","pipTranslate","pipAppBar","localStorageService",function(n,e,i,t,a,o,c,s,r,l){function d(e,i){n.originatorEv=i,e(i)}function p(n){return t.$party?n?t.$party[n]:t.$party:void 0}function u(n){return t.$user?n?t.$user[n]:t.$user:void 0}function m(e,i){n.config=i,n.searchEnabled=!1,n.search.text=""}function g(){return s.use()}function b(n){return n.access&&!n.access(t.$party,t.$user,n)}function h(n){return null==n.count||n.count<=0?"":n.count>99?"!":n.count}function f(n){var e=0;return _.each(n,function(n){b(n)||e++}),e}function v(){return f(n.config.secondaryGlobalActions)>0||f(n.config.secondaryLocalActions)>0}function y(){return f(n.config.secondaryGlobalActions)>0&&f(n.config.secondaryLocalActions)>0}function w(){if(_.isFunction(n.config.navIconCallback))n.config.navIconCallback();else if("back"!=n.config.navIconType)t.$broadcast("pipAppBarNavIconClicked");else if("breadcrumb"==n.config.titleType){var e=n.config.titleBreadcrumb;if(_.isArray(e)&&e.length>0){var i=e[e.length-1].click;_.isFunction(i)?i():a.history.back()}else a.history.back()}else a.history.back()}function A(n){_.isFunction(n.click)&&n.click(n)}function C(n){setTimeout(function(){s.use(n),t.$apply()},0)}function k(n){if(null==n)return null;var e,i={};for(e in n)n.hasOwnProperty(e)&&(":party_id"==n[e]?i[e]=t.$party?t.$party.id:null:":user_id"==n[e]?i[e]=t.$user?t.$user.id:null:i[e]=n[e]);return i}function T(n){if(null==n)return null;var e=n.replace(":party_id",t.$party?t.$party.id:"");return e=e.replace(":user_id",t.user?t.$user.id:"")}function S(){setTimeout(function(){var n=$(".pip-search-text");n.length>0&&n.focus()},0)}function x(e,i){null==e||e.divider||(e.close&&(n.originatorEv=null),e.menu?i(n.originatorEv):e.callback?e.callback():e.href?a.location.href=T(e.href):e.url?c.url(T(e.url)):e.state?o.go(e.state,k(e.stateParams)):e.event?t.$broadcast(e.event):t.$broadcast("pipAppBarActionClicked",e.name))}function I(){n.search.text=n.config.searchCriteria,n.searchEnabled=!0,S()}function N(){var e=n.search.text;n.search.text="",n.searchEnabled=!1,n.config.searchCallback?n.config.searchCallback(e):t.$broadcast("pipAppBarSearchClicked",e)}function L(){n.search.text?(n.search.text="",S()):(n.searchEnabled=!1,N())}function E(e){13==e.keyCode?n.onSearchClick():27==e.keyCode&&(n.searchEnabled=!1)}n.title&&r.showTitleText(n.title),n.showMenu&&r.showMenuNavIcon(),e.addClass("pip-appbar"),n.$emit("pipResizeWindow"),n.config=r.config(),n.localActions&&(r.showLocalActions(),n.config.primaryLocalActions=n.localActions[0],n.config.secondaryLocalActions=n.localActions[1]),n.globalActions&&(r.showLocalActions(),n.config.primaryGlobalActions=n.globalActions[0],n.config.secondaryGlobalActions=n.globalActions[0]),n.searchEnabled=!1,n.search={text:""},t.$on("pipAppBarChanged",m),n.language=g,n.actionHidden=b,n.actionCount=h,n.secondaryActionsVisible=v,n.secondaryDividerVisible=y,n.onNavIconClick=w,n.onBreadcrumbClick=A,n.onLanguageClick=C,n.onActionClick=x,n.onSearchEnable=I,n.onSearchClick=N,n.onSearchClear=L,n.onSearchKeyDown=E,n.getParty=p,n.getUser=u,n.openMenu=d}])}(),function(){"use strict";var n=angular.module("pipAppBar.Service",[]);n.provider("pipAppBar",function(){function n(n){return null!=n&&(c.appTitleText=n),c.appTitleText}function e(n){return null!=n&&(c.appTitleLogo=n),c.appTitleLogo}function i(n){return c.theme=n||c.theme,c.theme}function t(n,e){c.primaryGlobalActions=n||[],c.secondaryGlobalActions=e||[]}function a(n){c.primaryGlobalActions=n||[]}function o(n){c.secondaryGlobalActions=n||[]}var c={appTitleText:null,appTitleLogo:"images/piplife_logo.svg",theme:"blue",cssClass:"",ngClasses:{},navIconType:"none",navIconCallback:!1,titleType:"none",titleLogo:null,titleText:null,titleBreadcrumb:null,actionsType:"none",languages:["en","ru"],searchVisible:!1,searchCriteria:"",searchHistory:[],searchCallback:null,primaryGlobalActions:[],primaryLocalActions:[],secondaryGlobalActions:[],secondaryLocalActions:[]};this.appTitleText=n,this.appTitleLogo=e,this.theme=i,this.globalActions=t,this.globalPrimaryActions=a,this.globalSecondaryActions=o,this.$get=["$rootScope",function(n){function e(){return c}function i(n){return void 0!=n&&(c.cssClass=n,T()),c.cssClass}function t(){c.ngClasses["pip-shadow"]=!1,c.ngClasses["pip-shadow-sm"]=!0,c.ngClasses["pip-shadow-xs"]=!1,T()}function a(){c.ngClasses["pip-shadow"]=!1,c.ngClasses["pip-shadow-sm"]=!0,c.ngClasses["pip-shadow-xs"]=!0,T()}function o(){c.ngClasses["pip-shadow"]=!0,T()}function s(){c.ngClasses["pip-shadow"]=!1,c.ngClasses["pip-shadow-sm"]=!1,c.ngClasses["pip-shadow-xs"]=!1,T()}function r(){c.navIconType="none",c.navIconCallback=null,T()}function l(n){c.navIconType="menu",c.navIconCallback=n,T()}function d(n){c.navIconType="back",c.navIconCallback=n,T()}function p(){c.titleType="none",c.titleLogo=null,c.titleText=null,c.titleBreadcrumb=null,T()}function u(n){c.titleType="logo",c.titleLogo=n,c.titleText=null,c.titleBreadcrumb=null,T()}function m(n){c.titleType="text",c.titleLogo=null,c.titleText=n,c.titleBreadcrumb=null,T()}function g(n,e){_.isArray(n)&&(e=n,n=e[e.length-1].title,e.splice(e.length-1,1)),c.titleType="breadcrumb",c.titleLogo=null,c.titleText=n,c.titleBreadcrumb=e,e.length>0?(c.navIconType="none"==c.navIconType?"back":c.navIconType,c.navIconCallback=e[e.length-1]):(c.navIconType="menu",c.navIconCallback=null),T()}function b(){u(c.appTitleLogo)}function h(){m(c.appTitleText)}function f(){c.actionsType="none",c.primaryLocalActions=[],c.secondaryLocalActions=[],T()}function v(n){c.actionsType="language",c.languages=n||c.languages,T()}function y(n,e){c.actionsType="list",c.primaryLocalActions=n||[],c.secondaryLocalActions=e||[],T()}function w(n,e){_.each(c.primaryGlobalActions,function(i){i.name==n&&(i.count=e)}),_.each(c.primaryLocalActions,function(i){i.name==n&&(i.count=e)}),T()}function A(n,e,i){c.searchVisible=!0,c.searchCallback=n,c.searchCriteria=e,c.searchHistory=i,T()}function $(){c.searchVisible=!1,c.searchCallback=null,c.searchCriteria=null,T()}function C(n){c.searchCriteria=n,T()}function k(n){c.searchHistory=n,T()}function T(){n.$broadcast("pipAppBarChanged",c)}return{config:e,cssClass:i,hideNavIcon:r,showMenuNavIcon:l,showBackNavIcon:d,showAppTitleLogo:b,showAppTitleText:h,showTitleLogo:u,showTitleText:m,showTitleBreadcrumb:g,hideTitle:p,showLanguage:v,showLocalActions:y,hideLocalActions:f,updateActionCount:w,showSearch:A,hideSearch:$,updateSearchCriteria:C,updateSearchHistory:k,showShadow:o,showShadowSm:t,showShadowSmXs:a,hideShadow:s}}]})}(),function(){"use strict";var n=angular.module("pipDropdown",["pipAssert","pipNav.Templates"]);n.directive("pipDropdown",["$mdMedia","pipAssert",function(n,e){return{restrict:"E",scope:{ngDisabled:"&",actions:"=pipActions",showDropdown:"&pipShow",activeIndex:"=pipActiveIndex",select:"=pipDropdownSelect"},templateUrl:"dropdown/dropdown.html",controller:["$scope","$element","$attrs","localStorageService",function(i,t,a,o){i["class"]=(a["class"]||"")+" md-"+o.get("theme")+"-theme",e.isArray(i.actions,"pipDropdown: pip-actions attribute should take an array, but take "+typeof i.actions),i.$mdMedia=n,i.actions=i.actions&&_.isArray(i.actions)?i.actions:[],i.activeIndex=i.activeIndex||0,i.disabled=function(){return i.ngDisabled()?i.ngDisabled():!1},i.onSelect=function(n){i.activeIndex=n,i.select&&i.select(i.actions[n],i.activeIndex)},i.show=function(){return i.showDropdown()?i.showDropdown():!0}}]}}])}(),function(){"use strict";var n=angular.module("pipSideNav",["ngMaterial","pipTranslate","pipFocused","pipNav.Templates","pipSideNav.Service"]);n.config(["pipTranslateProvider",function(n){n.translations("en",{SIDENAV_SINCE:"since"}),n.translations("ru",{SIDENAV_SINCE:"с"})}]),n.directive("pipSidenav",function(){return{restrict:"EA",scope:!1,replace:!1,templateUrl:"sidenav/sidenav.html",controller:"pipSideNavController"}}),n.controller("pipSideNavController",["$scope","$element","$state","$rootScope","$window","$location","$timeout","pipState","pipTranslate","pipSideNav",function(n,e,i,t,a,o,c,s,r,l){function d(n){return n&&n.access&&!n.access(t.$party,t.$user,n)}function p(n){var e=!0;return _.each(n,function(n){d(n)||(e=!1)}),e}function u(n){l.open()}function m(e,i){n.config=i}function g(){t.$broadcast("pipSideNavUserClicked"),l.close()}function b(){t.$broadcast("pipSideNavPartyClicked"),l.close()}function h(n){if(null==n)return null;var e={};for(var i in n)n.hasOwnProperty(i)&&(":party_id"==n[i]?e[i]=t.$party?t.$party.id:null:":user_id"==n[i]?e[i]=t.$user?t.$user.id:null:e[i]=n[i]);return e}function f(n){if(null==n)return null;var e=n.replace(":party_id",t.$party?t.$party.id:"");return e=e.replace(":user_id",t.$user?t.$user.id:"")}function v(n,e){if(n.stopPropagation(),!e)return void l.close();if(e.href){if(e.href.split("?")[0]===a.location.href.split("?")[0])return void l.close();a.location.href=f(e.href)}else if(e.url){if(e.url.split(/[\s/?]+/)[1]===o.url().split(/[\s/?]+/)[1])return void l.close();o.url(f(e.url))}else if(e.state){if(i.current.name===e.state)return void l.close();s.go(e.state,h(e.stateParams))}else e.event&&t.$broadcast("pipSideNavLinkClicked",e.event);l.close()}e.addClass("pip-sidenav"),n.config=l.config(),n.$avatarReset=!1,t.$on("pipAppBarNavIconClicked",u),t.$on("pipSideNavChanged",m),n.itemVisible=d,n.onUserClick=g,n.onPartyClick=b,n.onLinkClick=v,n.isSectionEmpty=p}])}(),function(){"use strict";var n=angular.module("pipSideNav.Service",["pipAssert","pipDebug"]);n.provider("pipSideNav",["pipAssertProvider","pipDebugProvider",function(n,e){function i(n){return o.theme=n||o.theme,o.theme}function t(e){n.isArray(e,"pipSideNavProvider.sections or pipSideNav.sections: sections should be an array"),_.each(e,function(e,i){e.access&&n.isFunction(e.access,"pipSideNavProvider.sections or pipSideNav.sections: in section number "+i+" with title "+e.title+" access should be a function"),e.links&&(n.isArray(e.links,"pipSideNavProvider.sections or pipSideNav.sections: in section number "+i+" with title "+e.title+" links should be an array"),_.each(e.links,function(t){t.access&&n.isFunction(t.access,"pipSideNavProvider.sections or pipSideNav.sections: in section number "+i+" with title "+e.title+" in link with title "+t.title+" access should be a function")}))})}function a(n){return e.enabled()&&t(n),_.isArray(n)&&(o.sections=n),o.sections}var o={theme:"blue",sections:[]};this.theme=i,this.sections=a,this.$get=["$rootScope","$mdSidenav",function(n,e){function t(){return o}function c(n){return i(n),r(),o.theme}function s(n){return a(n),r(),o.sections}function r(){n.$broadcast("pipSideNavChanged",o)}function l(n){e("pip-sidenav").open()}function d(n){e("pip-sidenav").close()}function p(){e("pip-sidenav").toggle()}return n.$on("pipSideNavOpen",l),n.$on("pipSideNavClose",d),{config:t,theme:c,sections:s,open:l,close:d,toggle:p}}]}])}(),function(){"use strict";var n=angular.module("pipTabs",["pipAssert","pipNav.Templates"]);n.directive("pipTabs",["$mdMedia","pipAssert",function(n,e){return{restrict:"E",scope:{ngDisabled:"&",tabs:"=pipTabs",showTabs:"&pipShowTabs",showTabsShadow:"&pipTabsShadow",activeIndex:"=pipActiveIndex",select:"=pipTabsSelect"},templateUrl:"tabs/tabs.html",controller:["$scope","$element","$attrs","localStorageService",function(i,t,a,o){i["class"]=(a["class"]||"")+" md-"+o.get("theme")+"-theme",e.isArray(i.tabs,"pipTabs: pipTabs attribute should take an array"),i.$mdMedia=n,i.tabs=i.tabs&&_.isArray(i.tabs)?i.tabs:[],i.activeIndex=i.activeIndex||0,i.activeTab=i.activeIndex,i.disabled=function(){return i.ngDisabled?i.ngDisabled():void 0},i.tabDisabled=function(n){return i.disabled()&&i.activeIndex!=n},i.onSelect=function(n){i.disabled()||(i.activeIndex=n,i.activeTab=i.activeIndex,i.select&&i.select(i.tabs[i.activeIndex],i.activeIndex))},i.showShadow=function(){return i.showTabsShadow?i.showTabsShadow():!1},i.show=function(){return i.showTabs?i.showTabs():!0}}]}}])}();
!function(){"use strict";angular.module("pipLocations",["pipLocation","pipLocationMap","pipLocationIp","pipLocationEdit","pipLocationEditDialog"])}(),function(o){try{o=angular.module("pipLocations.Templates")}catch(n){o=angular.module("pipLocations.Templates",[])}o.run(["$templateCache",function(o){o.put("location_dialog/location_dialog.html",'<md-dialog class="pip-dialog pip-location-edit-dialog" layout="column" md-theme="{{theme}}"><div class="pip-header" layout="column" layout-align="start start"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h3 class="m0 w-stretch" flex="">{{ \'LOCATION_SET_LOCATION\' | translate }}</h3></div><div class="pip-footer"><div layout="row" layout-align="start center"><md-button class="md-accent" ng-click="onAddPin()" ng-show="locationPos == null" ng-disabled="transaction.busy()" aria-label="{{ ::\'LOCATION_ADD_PIN\' | translate }}">{{ ::\'LOCATION_ADD_PIN\' | translate }}</md-button><md-button class="md-accent" ng-click="onRemovePin()" ng-show="locationPos != null" ng-disabled="transaction.busy()" aria-label="{{ ::\'LOCATION_REMOVE_PIN\' | translate }}">{{ ::\'LOCATION_REMOVE_PIN\' | translate }}</md-button></div><div flex=""></div><div layout="row" layout-align="end center"><md-button ng-click="onCancel()" aria-label="{{ ::\'CANCEL\' | translate }}">{{ ::\'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="onApply()" ng-disabled="transaction.busy()" aria-label="{{ ::\'APPLY\' | translate }}">{{ ::\'APPLY\' | translate }}</md-button></div></div><div class="pip-body"><div class="pip-location-container"></div><md-button class="md-icon-button md-fab pip-zoom-in" ng-click="onZoomIn()" aria-label="{{ ::\'LOCATION_ZOOM_IN\' | translate }}"><md-icon md-svg-icon="icons:plus"></md-icon></md-button><md-button class="md-icon-button md-fab pip-zoom-out" ng-click="onZoomOut()" aria-label="{{ ::\'LOCATION_ZOOM_OUT\' | translate }}"><md-icon md-svg-icon="icons:minus"></md-icon></md-button><md-button class="md-icon-button md-fab pip-set-location" ng-click="onSetLocation()" aria-label="{{ ::\'LOCATION_SET_LOCATION\' | translate }}" ng-show="supportSet" ng-disabled="transaction.busy()"><md-icon md-svg-icon="icons:target"></md-icon></md-button></div></md-dialog>')}])}(),function(){"use strict";var o=angular.module("pipLocation",["pipUtils"]);o.directive("pipLocation",["pipUtils",function(o){return{restrict:"EA",scope:{pipLocationName:"&",pipLocationPos:"&",pipLocationResize:"&",pipShowLocationIcon:"="},template:function(n,i){return o.toBoolean(i.pipCollapse)?String()+'<div class="pip-location-name bm0" ng-click="pipLocationResize()" ng-hide="!pipLocationName()"ng-class="pipShowLocationIcon ? \'lp24-flex rp16\' : \'\'"><md-icon md-svg-icon="icons:location" class="flex-fixed pip-icon" ng-if="pipShowLocationIcon"></md-icon><span class="pip-location-text">{{pipLocationName()}}</span> </div><div class="pip-location-container bm8" ng-hide="!pipLocationPos()"></div>':String()+'<md-button class="pip-location-name" ng-click="pipLocationResize()" ng-class="pipShowLocationIcon ? \'lp24-flex rp16\' : \'\'"><div class="layout-align-start-center layout-row w-stretch"><md-icon md-svg-icon="icons:location" class="flex-fixed pip-icon" ng-if="pipShowLocationIcon"></md-icon><span class="pip-location-text flex">{{pipLocationName()}}</span><md-icon md-svg-icon="icons:triangle-down" class="flex-fixed" ng-if="!showMap"></md-icon><md-icon md-svg-icon="icons:triangle-up" class="flex-fixed" ng-if="showMap"></md-icon></div></md-button><div class="pip-location-container bm8"ng-class="pipShowLocationIcon ? \'lm24-flex rm24-flex\' : \'\'"></div>'},controller:"pipLocationController"}}]),o.controller("pipLocationController",["$scope","$element","$attrs","pipUtils",function(o,n,i,t){function a(){p&&p.remove(),p=null,c.hide()}function e(){var n=o.pipLocationPos();if(0==o.showMap||null==n||null==n.coordinates||n.coordinates.length<0)return void a();var i=new google.maps.LatLng(n.coordinates[0],n.coordinates[1]);p&&p.remove(),p=$("<div></div>"),c.show(),p.appendTo(c);var t={center:i,zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,draggable:!1},e=new google.maps.Map(p[0],t);new google.maps.Marker({position:i,map:e})}var l=n.children(".pip-location-name"),c=n.children(".pip-location-container"),p=null,s=n.find(".icon-up"),r=n.find(".icon-down"),d=t.toBoolean(i.pipCollapse);d||(o.showMap=!1,s.hide(),c.hide(),l.click(function(n){n.stopPropagation(),i.disabled||(o.showMap=!o.showMap,s[o.showMap?"show":"hide"](),r[o.showMap?"hide":"show"](),e())})),t.toBoolean(i.pipRebind)&&o.$watch(o.pipLocationPos,function(o){e()}),n.addClass("pip-location"),o.pipLocationPos()?e():a()}])}(),function(){"use strict";var o=angular.module("pipLocationEditDialog",["ngMaterial","pipTranslate","pipTransactions","pipLocations.Templates"]);o.config(["pipTranslateProvider",function(o){o.translations("en",{LOCATION_ADD_LOCATION:"Add location",LOCATION_SET_LOCATION:"Set location",LOCATION_ADD_PIN:"Add pin",LOCATION_REMOVE_PIN:"Remove pin"}),o.translations("ru",{LOCATION_ADD_LOCATION:"Добавить местоположение",LOCATION_SET_LOCATION:"Определить положение",LOCATION_ADD_PIN:"Добавить точку",LOCATION_REMOVE_PIN:"Убрать точку"})}]),o.factory("pipLocationEditDialog",["$mdDialog",function(o){return{show:function(n,i,t){o.show({controller:"pipLocationEditDialogController",templateUrl:"location_dialog/location_dialog.html",locals:{locationName:n.locationName,locationPos:n.locationPos},clickOutsideToClose:!0}).then(function(o){i&&i(o)},function(){t&&t()})}}}]),o.controller("pipLocationEditDialogController",["$scope","$rootScope","$timeout","$mdDialog","pipTransaction","locationPos","locationName",function(o,n,i,t,a,e,l){o.theme=n.$theme,o.locationPos=e&&"Point"==e.type&&e.coordinates&&2==e.coordinates.length?e:null,o.locationName=l,o.supportSet=null!=navigator.geolocation,o.transaction=a("location_edit_dialog",o);var c=null,p=null,s=function(o){if(p&&p.setMap(null),o){p=new google.maps.Marker({position:o,map:c,draggable:!0,animation:google.maps.Animation.DROP});var n=p;google.maps.event.addListener(n,"dragend",function(){var o=n.getPosition();r(o)})}else p=null;return p},r=function(n,i){if(o.locationPos={type:"Point",coordinates:[n.lat(),n.lng()]},o.locationName=null,null!=i||(i=o.transaction.begin(),null!=i)){var t=new google.maps.Geocoder;t.geocode({location:n},function(n,t){o.transaction.aborted(i)||(t==google.maps.GeocoderStatus.OK&&n&&n.length>0&&(o.locationName=n[0].formatted_address),o.transaction.end(),o.$apply())})}};i(function(){var n=$(".pip-location-edit-dialog .pip-location-container"),i=o.locationPos?new google.maps.LatLng(o.locationPos.coordinates[0],o.locationPos.coordinates[1]):null,t={center:new google.maps.LatLng(0,0),zoom:1,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0};null!=i&&(t.center=i,t.zoom=12),c=new google.maps.Map(n[0],t),p=s(i),setTimeout(function(){google.maps.event.trigger(c,"resize")},1e3)},0),o.$on("pipLayoutResized",function(o){null!=c&&google.maps.event.trigger(c,"resize")}),o.onAddPin=function(){if(null!=c){var o=c.getCenter();p=s(o),r(o)}},o.onRemovePin=function(){null!=c&&(p=s(null),o.locationPos=null,o.locationName=null)},o.onZoomIn=function(){if(null!=c){var o=c.getZoom();c.setZoom(o+1)}},o.onZoomOut=function(){if(null!=c){var o=c.getZoom();c.setZoom(o>1?o-1:o)}},o.onSetLocation=function(){if(null!=c){var n=o.transaction.begin();null!=n&&navigator.geolocation.getCurrentPosition(function(i){if(!o.transaction.aborted(n)){var t=new google.maps.LatLng(i.coords.latitude,i.coords.longitude);p=s(t),c.setCenter(t),c.setZoom(12),r(t,n)}},function(){o.transaction.end(),o.$apply()},{maximumAge:0,enableHighAccuracy:!0,timeout:5e3})}},o.onCancel=function(){t.cancel()},o.onApply=function(){t.hide({location:o.locationPos,locationPos:o.locationPos,locationName:o.locationName})}}])}(),function(){"use strict";var o=angular.module("pipLocationEdit",["pipLocationEditDialog"]);o.directive("pipLocationEdit",["$parse","$http","pipLocationEditDialog",function(o,n,i){return{restrict:"EAC",scope:{pipLocationName:"=",pipLocationPos:"=",pipLocationHolder:"=",ngDisabled:"&",pipChanged:"&"},template:String()+'<md-input-container class="md-block"><label>{{ \'LOCATION\' | translate }}</label><input ng-model="pipLocationName"ng-disabled="ngDisabled()"/></md-input-container><div class="pip-location-empty" layout="column" layout-align="center center"><md-button class="md-raised" ng-disabled="ngDisabled()" ng-click="onSetLocation()"aria-label="LOCATION_ADD_LOCATION"><span class="icon-location"></span> {{::\'LOCATION_ADD_LOCATION\' | translate}}</md-button></div><div class="pip-location-container" tabindex="{{ ngDisabled() ? -1 : 0 }}" ng-click="onMapClick($event)" ng-keypress=""onMapKeyPress($event)"></div>',controller:["$scope","$element",function(o,n){n.find("md-input-container").attr("md-no-float",!!o.pipLocationHolder)}],link:function(o,n){var t=n.children(".pip-location-empty"),a=n.children(".pip-location-container"),e=null,l=function(){e&&e.remove(),e=null,a.hide(),t.show()},c=function(){var n=o.pipLocationPos;if(null==n||null==n.coordinates||n.coordinates.length<0)return void l();var i=new google.maps.LatLng(n.coordinates[0],n.coordinates[1]);e&&e.remove(),a.show(),t.hide(),e=$("<div></div>"),e.appendTo(a);var c={center:i,zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,draggable:!1},p=new google.maps.Map(e[0],c);new google.maps.Marker({position:i,map:p})},p=function(){var n=o.pipLocationName;if(""==n)return o.pipLocationPos=null,l(),void o.$apply();var i=new google.maps.Geocoder;i.geocode({address:n},function(n,i){o.$apply(function(){if(i==google.maps.GeocoderStatus.OK){if(null==n||0==n.length)return o.pipLocationPos=null,void l();var t=n[0].geometry||{},a=t.location||{};if(null==a.lat||null==a.lng)return o.pipLocationPos=null,void l();o.pipLocationPos={type:"Point",coordinates:[a.lat(),a.lng()]}}else console.error(response),o.pipLocationPos=null})})},s=_.debounce(p,2e3);o.onSetLocation=function(){o.ngDisabled()||i.show({locationName:o.pipLocationName,locationPos:o.pipLocationPos},function(n){var i=n.location,t=n.locationName;o.pipLocationPos&&"Point"==o.pipLocationPos.type&&2==o.pipLocationPos.coordinates.length&&i&&2==i.coordinates.length&&o.pipLocationPos.coordinates[0]-i.coordinates[0]<1e-4&&o.pipLocationPos.coordinates[1]-i.coordinates[1]<1e-4&&t==o.pipLocationName||(o.pipLocationPos=i,o.pipLocationName=t,null==t&&null!=i&&(o.pipLocationName="("+n.location.coordinates[0]+","+n.location.coordinates[1]+")"),o.pipChanged(),a[0].focus())})},o.onMapClick=function(n){o.ngDisabled()||(a[0].focus(),o.onSetLocation())},o.onMapKeyPress=function(n){o.ngDisabled()||13!=n.keyCode&&32!=n.keyCode||o.onSetLocation()},o.$watch(function(){return o.pipLocationName},function(o,n){o!=n&&s()}),o.$watch(function(){return o.pipLocationPos},function(){c()}),n.addClass("pip-location-edit"),o.pipLocationPos?c():l()}}}])}(),function(){"use strict";var o=angular.module("pipLocationIp",["pipUtils"]);o.directive("pipLocationIp",function(){return{restrict:"EA",scope:{pipIpaddress:"&",pipExtraInfo:"&"},template:'<div class="pip-location-container"></div>',controller:"pipLocationIpController"}}),o.controller("pipLocationIpController",["$scope","$element","$attrs","$http","pipUtils",function(o,n,i,t,a){function e(){s&&s.remove(),s=null}function l(o,n){if(null==o||null==n)return void e();var i=new google.maps.LatLng(o,n);s&&s.remove(),s=$("<div></div>"),s.appendTo(p);var t={center:i,zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,draggable:!1},a=new google.maps.Map(s[0],t);new google.maps.Marker({position:i,map:a})}function c(){var n=o.pipIpaddress();return""==n?void e():void t.jsonp("http://www.geoplugin.net/json.gp?ip="+n+"&jsoncallback=JSON_CALLBACK").success(function(n){if(null!=n&&null!=n.geoplugin_latitude&&null!=n.geoplugin_longitude){if(l(n.geoplugin_latitude,n.geoplugin_longitude),o.pipExtraInfo){var i={city:n.geoplugin_city,regionCode:n.geoplugin_regionCode,region:n.geoplugin_regionName,areaCode:n.geoplugin_areaCode,countryCode:n.geoplugin_countryCode,country:n.geoplugin_countryName,continentCode:n.geoplugin_continentCode};o.pipExtraInfo({extraInfo:i})}}else e()}).error(function(o){console.error(o),e()})}var p=n.children(".pip-location-container"),s=null;a.toBoolean(i.pipRebind)&&o.$watch(function(){return o.pipIpaddress()},function(o){c()}),n.addClass("pip-location-ip"),c()}])}(),function(){"use strict";var o=angular.module("pipLocationMap",["pipUtils"]);o.directive("pipLocationMap",function(){return{restrict:"EA",scope:{pipLocationPos:"&"},template:'<div class="pip-location-container"></div>',controller:"pipLocationMapController"}}),o.controller("pipLocationMapController",["$scope","$element","$attrs","$parse","pipUtils",function(o,n,i,t,a){function e(){p&&p.remove(),p=null}function l(){var n=o.pipLocationPos();if(null==n||null==n.coordinates||n.coordinates.length<0)return void e();var i=new google.maps.LatLng(n.coordinates[0],n.coordinates[1]);p&&p.remove(),p=$("<div></div>"),p.appendTo(c);var t={center:i,zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,draggable:!1},a=new google.maps.Map(p[0],t);new google.maps.Marker({position:i,map:a})}var c=n.children(".pip-location-container"),p=null;a.toBoolean(i.pipRebind)&&o.$watch(function(){return o.pipLocationPos()},function(o){l()}),n.addClass("pip-location-map"),o.pipLocationPos()?l():e()}])}();
!function(){"use strict";angular.module("pipDocuments",["pipDocumentList","pipDocumentListEdit"])}(),function(e){try{e=angular.module("pipDocuments.Templates")}catch(n){e=angular.module("pipDocuments.Templates",[])}e.run(["$templateCache",function(e){e.put("document_list/document_list.html",'<md-button class="pip-documents-name" ng-class="{\'lp24-flex rp16\': pipDocumentIcon}" ng-click="onTitleClick($event); onResize()" aria-label="RESIZE"><div class="layout-align-start-center layout-row w-stretch"><md-icon md-svg-icon="icons:document" ng-class="{\'pip-icon\': pipDocumentIcon}" ng-if="pipDocumentIcon"></md-icon><span class="pip-documents-text">{{documents.length}} {{::\'DOCUMENTS_ATTACHED\' | translate}}</span><md-icon class="icon-up" md-svg-icon="icons:triangle-up"></md-icon><md-icon class="icon-down" md-svg-icon="icons:triangle-down"></md-icon></div></md-button><div pip-focused="" class="pip-documents-container bm8" ng-class="{\'lp24-flex rp24-flex\': pipDocumentIcon}"><md-button class="pip-document-download md-primary" ng-class="{\'pip-focusable\' : !ngDisabled()}" href="{{::documentUrl(document)}}" target="_blank" ng-disabled="ngDisabled() || document.error" ng-repeat="document in documents track by document.file_id" aria-label="DOCUMENT"><div class="pip-default-icon"><md-icon md-svg-icon="icons:{{::documentList.icon}}"></md-icon></div><div class="pip-document-title">{{::document.file_name}}</div></md-button></div>')}])}(),function(e){try{e=angular.module("pipDocuments.Templates")}catch(n){e=angular.module("pipDocuments.Templates",[])}e.run(["$templateCache",function(e){e.put("document_list/document_list_collapse.html",'<div class="pip-documents-name" ng-click="onTitleClick($event); onResize()"><span class="pip-documents-text">{{documents.length}} {{::\'DOCUMENTS_ATTACHED\' | translate}}</span><md-icon class="icon-up" md-svg-icon="icons:triangle-up"></md-icon><md-icon class="icon-down" md-svg-icon="icons:triangle-down"></md-icon></div><div pip-focused="" class="pip-documents-container bm8"><md-button class="pip-document-download pip-focusable md-primary" href="{{::document.url}}" target="_blank" ng-repeat="document in documents track by document.file_id" aria-label="DOCUMENT"><div class="pip-default-icon"><md-icon md-svg-icon="icons:{{::icon}}"></md-icon></div><div class="pip-document-title">{{::document.file_name}}</div></md-button></div>')}])}(),function(e){try{e=angular.module("pipDocuments.Templates")}catch(n){e=angular.module("pipDocuments.Templates",[])}e.run(["$templateCache",function(e){e.put("document_list_edit/document_list_edit.html",'<div pip-focusable=""><div class="pip-document-upload pointer md-primary" ng-class="{\'pip-focusable\' : !ngDisabled(), \'pip-item-error\' : item.state == \'error\'}" ng-keydown="onKeyDown($event, item)" tabindex="{{ ngDisabled() ? -1 : 0 }}" ng-repeat="item in control.items | filter: filterItem"><div class="pip-default-icon" ng-class="{ \'pip-document-new\': item.id == null }"><md-icon pip-cancel-drag="true" class="md-primary" ng-if="item.state == \'original\' || item.state == \'added\'" md-svg-icon="icons:{{::documentList.icon}}"></md-icon><md-icon pip-cancel-drag="true" class="md-warn" ng-if="item.state == \'error\'" md-svg-icon="icons:{{::documentList.iconError}}"></md-icon></div><div class="pip-document-title" pip-cancel-drag="true">{{::item.name}}</div><md-button ng-click="onDelete(item)" ng-disabled="ngDisabled() || control.uploading" tabindex="-1" ng-hide="ngDisabled()" class="md-icon-button" aria-label="DELETE"><md-icon md-svg-icon="icons:cross" pip-cancel-drag="true"></md-icon></md-button><md-progress-linear ng-show="item.uploading" ng-value="item.progress"></md-progress-linear></div><button class="pip-document-upload pip-document-drop" ng-class="{\'pip-focusable\' : !ngDisabled()}" ng-keydown="onKeyDown($event)" tabindex="0" ng-file-drop="" ng-file-select="" ng-file-change="onSelect($files)" ng-multiple="true" ng-disabled="ngDisabled() || control.uploading" aria-label="UPLOAD"><div class="pip-default-icon"><md-icon pip-cancel-drag="true" md-svg-icon="icons:{{::documentList.icon}}"></md-icon></div><div class="pip-default-text"><span>{{documentList.text | translate}}</span></div></button><div class="clearfix"></div></div>')}])}(),function(){"use strict";var e=angular.module("pipDocumentList",["pipCore","pipRest","pipFocused","pipDocuments.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{DOCUMENTS_ATTACHED:"document(s) attached",ERROR_DOCUMENTS_LOADED:"Error: <%= error_number %> document(s) are not loaded"}),e.translations("ru",{DOCUMENTS_ATTACHED:"документов добавлено",ERROR_DOCUMENTS_LOADED:"Ошибка: <%= error_number %> документ(ов) не загружено"})}]),e.directive("pipDocumentList",["$parse","$rootScope","pipUtils","pipRest","$http","pipToasts","pipTranslate",function(e,n,t,i,o,a,d){return{restrict:"EA",scope:!0,templateUrl:"document_list/document_list.html",link:function(o,a,d){function c(e){if(!o.documents&&e)return!0;if(o.documents&&!e)return!0;if(o.documents.length!=e.length)return!0;for(var n=0;n<e.length;n++){var t=_.find(o.documents,{file_id:e[n].file_id});if(void 0===t)return!0}return!1}function l(e){e&&e.stopPropagation(),d.disabled||(o.showDocuments=!o.showDocuments,u[o.showDocuments?"show":"hide"](),m[o.showDocuments?"hide":"show"](),p[o.showDocuments?"show":"hide"]())}function s(e){var t=i.serverUrl(),o=(n.$user||{}).id,a=(n.$party||{}).id||o;return t+"/api/parties/"+a+"/files/"+e.file_id+"/content"}var r=e(d.pipDocuments),p=a.children(".pip-documents-container"),u=a.find(".icon-up"),m=a.find(".icon-down"),g=t.toBoolean(d.pipCollapse);o.documentList={},o.documentList.icon="document",o.documents=r(o),d.pipDocumentIcon&&(o.pipDocumentIcon=!0),o.showDocuments=g,g?m.hide():(u.hide(),p.hide()),d.disabled&&(u.hide(),m.hide()),t.toBoolean(d.pipRebind)&&o.$watch(r,function(e){c(e)&&(o.documents=e)}),o.onTitleClick=l,o.documentUrl=s,a.addClass("pip-document-list")}}}])}(),function(){"use strict";var e=angular.module("pipDocumentListEdit",["ui.event","angularFileUpload","pipCore","pipFocused","pipRest","pipDocuments.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{DOCUMENT_LIST_EDIT_TEXT:"Click here to add a document",ERROR_TRANSACTION_IN_PROGRESS:"Transaction is in progress. Please, wait until it's finished or abort"}),e.translations("ru",{DOCUMENT_LIST_EDIT_TEXT:"Нажмите сюда, чтобы добавить документ",ERROR_TRANSACTION_IN_PROGRESS:"Транзакция еще не завершена. Подождите окончания или прервите её"})}]),e.directive("pipDocumentListEdit",function(){return{restrict:"EA",scope:{pipDocuments:"=",pipAddedDocument:"=",ngDisabled:"&",pipCreated:"&",pipChanged:"&"},templateUrl:"document_list_edit/document_list_edit.html",controller:"pipDocumentListEditController"}}),e.controller("pipDocumentListEditController",["$scope","$rootScope","$element","$attrs","$parse","$http","$upload","$timeout","pipRest","pipUtils",function(e,n,t,i,o,a,d,c,l,s){function r(){var n=e.pipDocuments,t=[];if(null==n||0==n.length)return t;for(var i=0;i<n.length;i++)t.push({pin:y++,id:n[i].file_id,name:n[i].file_name,uploading:!1,uploaded:!1,progress:0,file:null,state:e.documentStartState});return t}function p(){e.pipDocuments&&e.pipDocuments.length>0&&e.pipDocuments.splice(0,e.pipDocuments.length);for(var n=0;n<e.control.items.length;n++){var t=e.control.items[n];t.id&&e.pipDocuments.push({file_id:t.id,file_name:t.name})}}function u(){e.control.uploading=0,e.control.items=r()}function m(e){var t=l.serverUrl(),i=n.$party?n.$party.id:l.userId();return t+"/api/parties/"+i+"/files/"+e.id}function g(e){var t=l.serverUrl(),i=n.$party?n.$party.id:l.userId();return t+"/api/parties/"+i+"/files?name="+e.file.name}function f(n,t){var i=(e.control,n.file);if(!n.uploading&&null!=n.file&&"added"==n.state){var o=new FileReader;o.onload=function(e){n.uploading||(n.uploading=!0,n.upload=d.http({url:g(n),headers:{"Content-Type":i.type},data:e.target.result}).then(function(e){n.id=e.data.id,n.name=e.data.filename||n.name,n.uploaded=!0,n.uploading=!1,n.progress=0,n.upload=null,n.file=null,n.state="original",t()},function(e){n.uploaded=!1,n.uploading=!1,n.progress=0,n.upload=null,n.state="error",t()},function(e){n.progress=Math.min(100,parseInt(100*e.loaded/e.total))}))},o.readAsArrayBuffer(i)}}function v(n,t){var i=e.control;n.upload&&(n.upload.abort(),n.upload=null),"deleted"==n.state&&a["delete"](m(n)).success(function(e){_.remove(i.items,{pin:n.pin}),t()}).error(function(e,o){null==e?_.remove(i.items,{pin:n.pin}):(n.uploaded=!1,n.uploading=!1,n.progress=0,n.upload=null),t(e)})}function D(n,t){var i=e.control;if(i.uploading)return void(t&&t("ERROR_TRANSACTION_IN_PROGRESS"));i.error=null,i.uploading=0;for(var o=function(e){e&&!i.error&&(i.error=e),i.uploading--,0==i.uploading&&(i.error?t?t(i.error):console.error(i.error):(p(),n&&n()))},a=0;a<i.items.length;a++){var d=i.items[a];"added"==d.state?(i.uploading++,f(d,o)):"deleted"==d.state&&(i.uploading++,v(d,o))}0==i.uploading&&n&&n()}function h(){for(var n=e.control,t=0;t<n.items.length;t++){var i=n.items[t];i.uploading&&(i.upload&&i.upload.abort(),i.uploaded=!1,i.uploading=!1,i.progress=0,i.upload=null)}n.uploading=0}function T(e){return"deleted"!=e.state}function b(n){if($.focus(),null!=n&&0!=n.length){for(var t=0;t<n.length;t++){var i=n[t];e.control.items.push({pin:y++,id:null,name:i.name,uploading:!1,uploaded:!1,progress:0,file:i,state:"added"})}e.onChange()}}function C(n){"added"==n.state||"copied"==n.state?_.remove(e.control.items,{pin:n.pin}):n.state="deleted",e.onChange()}function E(n,t){t?46!=n.keyCode&&8!=n.keyCode||("added"==t.state?_.remove(e.control.items,{pin:t.pin}):t.state="deleted",e.onChange()):13!=n.keyCode&&32!=n.keyCode||setTimeout(function(){$.trigger("click")},0)}function R(){e.pipChanged&&e.pipChanged({$event:{sender:e.control},$control:e.control})}function w(){e.pipCreated&&e.pipCreated({$event:{sender:e.control},$control:e.control})}var $=t.children(".pip-picture-drop");e.documentList={},e.documentList.text=i.pipDefaultText||"DOCUMENT_LIST_EDIT_TEXT",e.documentList.icon=i.pipDefaultIcon||"document",e.documentList.iconError="warn-circle",e.documentStartState=s.toBoolean(e.pipAddedDocument)?"copied":"original",e.cancelDrag=s.toBoolean(i.pipCanselDrag)===!0;var y=0;e.control={uploading:0,items:r(),reset:u,save:D,abort:h},e.filterItem=T,e.onDelete=C,e.onKeyDown=E,e.onChange=R,e.onSelect=b,t.addClass("pip-document-list-edit"),e.control.reset(),w(),e.$watchCollection(function(){return e.pipDocuments},function(n){_.isEqual(n,e.pipDocuments)||e.control.reset()})}])}();
!function(){"use strict";angular.module("pipPictures",["pipAddImage","pipAvatar","pipAvatarEdit","pipPicture","pipPictureEdit","pipCollage","pipPictureListEdit","pipCameraDialog","pipPictureUrlDialog"])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("add_image/add_image.html",'<md-menu><ng-transclude class="pip-add-image-open-button" ng-click="ngDisabled() ? \'\' : $mdOpenMenu()"></ng-transclude><md-menu-content width="4"><md-menu-item><md-button layout="row" layout-align="start center" accept="image/*" ng-keydown="onKeyDown($event)" ng-multiple="isMulti()" ng-file-select="" ng-file-change="onFileChange($files)" ng-click="hideMenu()" ng-file-drop=""><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:folder"></md-icon><span class="text-grey">{{::\'FILE\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button layout="row" layout-align="start center" ng-click="onWebLinkClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:weblink"></md-icon><span class="text-grey">{{::\'WEB_LINK\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button layout="row" layout-align="start center" ng-click="onCameraClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:camera"></md-icon><span class="text-grey">{{::\'CAMERA\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button layout="row" layout-align="start center" ng-click="onGalleryClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:images"></md-icon><span class="text-grey">{{::\'IMAGE_GALLERY\' | translate}}</span></md-button></md-menu-item></md-menu-content></md-menu>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("camera_dialog/camera_dialog.html",'<md-dialog class="pip-dialog pip-picture-dialog pip-camera-dialog" layout="column" md-theme="{{theme}}"><div class="pip-header" layout="row" layout-align="start center"><md-button ng-click="onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="m0 text-title">{{ ::\'TAKE_PICTURE\' | translate }}</h3></div><div class="pip-body"><div class="camera-stream" ng-hide="webCamError"></div><div class="camera-error" ng-show="webCamError" layout="row" layout-align="center center"><span>{{ ::\'WEB_CAM_ERROR\' | translate }}</span></div></div><div class="pip-footer"><div class="w48"><md-button ng-click="onResetPicture()" ng-hide="!$freeze || webCamError" class="md-icon-button" ng-disabled="transaction.busy()" aria-label="{{ ::\'REMOVE_PICTURE\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:refresh"></md-icon></md-button></div><div flex=""></div><div class="w48"><md-button ng-click="onTakePictureClick()" ng-hide="webCamError" class="md-icon-button" aria-label="{{ ::\'TAKE_PICTURE\' | translate }}"><md-icon class="text-grey icon-button" md-svg-icon="icons:{{$freeze ? \'check\' : \'camera\'}}"></md-icon></md-button></div><div flex=""></div><div class="w48"><md-button ng-click="onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:cross"></md-icon></md-button></div></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("gallery_search_dialog/gallery_search_dialog.html",'<md-dialog class="pip-dialog pip-gallery-search-dialog pip-picture-dialog" layout="column" md-theme="{{theme}}"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate"></md-progress-linear><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll" layout="row" flex=""><div layout="column" layout-align="start start" flex=""><div class="pip-header w-stretch" layout="column" layout-align="start start"><h3 class="w-stretch text-title m0 bp8"><md-button class="md-icon-button m0" ng-click="onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button>{{::\'IMAGE_GALLERY\' | translate}}</h3><div class="w-stretch divider-bottom" layout="row"><input class="no-divider rm8 text-subhead1" flex="" ng-disabled="transaction.busy()" ng-model="$search" ng-keypress="onKeyPress($event)" placeholder="{{::\'SEARCH_PICTURES\' | translate}}" type="text" tabindex="1"><md-button class="md-icon-button md-icon-button-square p0 pip-search-button md-primary" ng-click="onSearchClick()" ng-hide="optionDefault" tabindex="-1" aria-label="SEARCH"><md-icon class="text-opacity md-primary" md-svg-icon="icons:search-square"></md-icon></md-button></div></div><div class="pip-content" flex="" ng-show="$images.length > 0"><div class="pip-image-container" ng-click="onImageClick(image)" ng-repeat="image in $images track by $index" ng-class="{\'checked\': image.checked}" tabindex="{{ $index + 2 }}"><pip-picture pip-src="image.thumbnail" pip-default-icon="icon-images" pip-rebind="true"></pip-picture><div class="pip-checked-cover"></div><div class="pip-checkbox-backdrop"><md-checkbox md-no-ink="" ng-model="image.checked" ng-click="image.checked = !image.checked" aria-label="CHECKED"></md-checkbox></div></div></div><div class="pip-no-images w-stretch" layout="column" layout-align="center center" flex="" ng-show="$images.length == 0"><img src="images/add_from_image_library.svg" width="200" height="200"><p class="text-secondary opacity-secondary text-center">{{\'IMAGE_START_SEARCH\' | translate}}</p></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="onCancelClick()" ng-hide="transaction.busy()" aria-label="{{ ::\'CANCEL\' | translate }}" tabindex="{{ $images.length + 3 }}"><span class="text-grey">{{ ::\'CANCEL\' | translate }}</span></md-button><md-button ng-if="transaction.busy()" ng-click="onStopSearchClick()" class="md-raised md-warn m0" tabindex="5" aria-label="ABORT" pip-test="button-cancel">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-hide="transaction.busy()" ng-disabled="addButtonDisabled()" ng-click="onAddClick()" aria-label="{{ ::\'ADD\' | translate }}" tabindex="{{ $images.length + 4 }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("picture_edit/picture_edit.html",'<div class="pip-picture-upload pip-picture-drop md-focused" ng-keydown="onKeyDown($event)" tabindex="{{ ngDisabled() || control.uploading ? -1 : 0 }}" pip-changed="readItemLocally(url, file)" ng-disabled="ngDisabled()" pip-multi="false" ng-focus="onFocus()" ng-blur="onBlur()" pip-add-image=""><div class="pip-default-icon" ng-show="empty()"><md-icon class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text" ng-show="empty()"><span>{{text | translate}}</span></div><img class="pip-picture-image" ng-src="{{control.url}}" ng-show="!empty()" ng-class="{ \'pip-image-new\': isUpdated(), \'cursor-default\' : ngDisabled() || control.uploading }" ui-event="{ error: \'onImageError($event)\', load: \'onImageLoad($event)\' }"><md-button class="md-icon-button" ng-click="onDeleteClick($event)" tabindex="-1" aria-label="delete" ng-hide="empty() || ngDisabled()" ng-disabled="ngDisabled() || control.uploading"><md-icon md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear ng-show="control.uploading" ng-value="control.progress"></md-progress-linear></div>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("picture_list_edit/picture_list_edit.html",'<div pip-focused=""><div class="pip-picture-upload pointer pip-focusable" ng-class="{\'pip-picture-error\': item.error}" ng-keydown="onKeyDown($event, item)" tabindex="{{ ngDisabled() ? -1 : 0 }}" ng-repeat="item in control.items | filter: filterItem"><div class="pip-default-icon" ng-hide="item.loaded || item.error"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text" ng-show="item.error"><md-icon pip-cancel-drag="true" md-svg-icon="icons:warn-circle"></md-icon></div><img ng-src="{{::item.url}}" pip-cancel-drag="true" ng-hide="item.error" ng-class="{ \'pip-image-new\': item.state == \'added\' }" ui-event="{ error: \'onImageError($event, item)\', load: \'onImageLoad($event, item)\' }"><md-button ng-click="onDeleteClick(item)" ng-disabled="ngDisabled() || control.uploading" tabindex="-1" aria-label="delete" class="md-icon-button"><md-icon pip-cancel-drag="true" md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear md-mode="indeterminate" ng-show="item.uploading" value="{{ item.progress }}"></md-progress-linear></div><button class="pip-picture-upload pip-picture-drop pip-focusable" pip-add-image="" ng-focus="onFocus()" ng-blur="onBlur()" pip-changed="readItemLocally(url, file)" ng-disabled="ngDisabled() || control.uploading"><div class="pip-default-icon"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text"><span>{{text | translate}}</span></div></button><div class="clearfix"></div></div>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(e){e.put("picture_url_dialog/picture_url_dialog.html",'<md-dialog class="pip-dialog pip-picture-url-dialog pip-picture-dialog" layout="column" md-theme="{{theme}}"><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll"><div class="pip-header bm16" layout="row" layout-align="start center"><md-button ng-click="onCancelClick()" class="md-icon-button lm0" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="text-title m0">{{ ::\'PICTURE_FROM_WEBLINK\' | translate}}</h3></div><div class="pip-content"><md-input-container md-no-float="" class="w-stretch text-subhead1"><input type="text" ng-model="url" ng-change="checkUrl()" placeholder="{{:: \'LINK_PICTURE\' | translate}}"></md-input-container><div class="w-stretch" ng-hide="invalid" layout="row" layout-align="center center"><img id="url_image"></div><div class="pip-no-images" ng-show="invalid" layout="row" layout-align="center center"><md-icon class="text-grey" md-svg-icon="icons:images"></md-icon></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}">{{ ::\'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="onAddClick()" ng-disabled="invalid" aria-label="{{ ::\'ADD\' | translate }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}(),function(){"use strict";var e=angular.module("pipAddImage",["pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog","pipCore"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{FILE:"Upload pictures",WEB_LINK:"Use web link",CAMERA:"Take photo",IMAGE_GALLERY:"Use image library"}),e.translations("ru",{FILE:"Загрузить картинку",WEB_LINK:"Вставить веб ссылка",CAMERA:"Использовать камеру",IMAGE_GALLERY:"Открыть галерею изображений"})}]),e.directive("pipAddImage",function(){return{restrict:"AC",scope:{$images:"=pipImages",onChange:"&pipChanged",multi:"&pipMulti",ngDisabled:"&"},transclude:!0,templateUrl:"add_image/add_image.html",controller:"pipAddImageController"}}),e.controller("pipAddImageController",["$scope","$element","$mdMenu","$timeout","pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog","pipUtils",function(e,t,i,l,n,o,a,r){function d(){$(t).find(".pip-add-image-open-button").scope().$mdOpenMenu()}function c(){return void 0!==e.multi()?r.toBoolean(e.multi()):!0}function p(){i.hide()}function u(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],l=new Uint8Array(t.length),n=0;n<t.length;n++)l[n]=t.charCodeAt(n);return new Blob([l],{type:i})}function s(t){void 0!==t&&(Array.isArray(t)?t.forEach(function(t){e.onChange&&e.onChange({url:t.url,file:t.file})}):e.onChange&&e.onChange({url:t.url,file:t.file}),void 0!==e.$images&&Array.isArray(e.$images)&&(Array.isArray(t)?t.forEach(function(t){e.$images.push(t.url)}):e.$images.push(t.url)))}function g(e){null!=e&&0!=e.length&&e.forEach(function(e){e.type.indexOf("image")>-1&&l(function(){var t=new FileReader;t.readAsDataURL(e),t.onload=function(t){l(function(){s({url:t.target.result,file:e})})}})})}function f(){o.show(function(e){var t=null;"data:image"==e.substring(0,10)&&(t=u(e),t.name=e.slice(e.lastIndexOf("/")+1,e.length).split("?")[0]),s({url:e,file:t})})}function h(){n.show(function(e){var t=u(e);t.name="camera",s({url:e,file:t})})}function m(){a.show(function(e){var t=[];e.forEach(function(e){t.push({url:e,file:null})}),s(t)},e.isMulti())}e.hideMenu=p,e.onFileChange=g,e.onWebLinkClick=f,e.onCameraClick=h,e.onGalleryClick=m,e.isMulti=c,t.click(function(){e.ngDisabled()||d()})}])}(),function(){"use strict";var e=angular.module("pipAvatar",["pipCore","pipRest","pipImageUtils"]);e.directive("pipAvatar",function(){return{restrict:"EA",scope:!1,template:'<md-icon></md-icon><img/><div><md-icon class="default_icon" id="icon-film" md-svg-icon="icons:film"></md-icon><md-icon class="default_icon" id="icon-task" md-svg-icon="icons:task"></md-icon><md-icon class="default_icon" id="icon-folder" md-svg-icon="icons:folder"></md-icon></div>',controller:"pipAvatarController"}}),e.controller("pipAvatarController",["$scope","$rootScope","$element","$attrs","$parse","pipUtils","pipStrings","pipRest","$http","pipImageUtils",function(e,t,i,l,n,o,a,r,d,c){function p(){m.css("display","none"),h.css("display","none"),P.css("display","none"),f.css("display","none"),g.attr("src",""),s.css("display","none"),g.css("display","inline-block"),u()}function u(){var t=b(e),l=y(e),n=C(e),o=x(e);m.css("display","none"),h.css("display","none"),P.css("display","none"),f.css("display","none");var r=c.getAvatarUrl(l,t,n,o,!1,!1);if(o&&n&&l||l&&t)if(o&&n&&l){if("category"==o)return;if("goals"==E[o]||"areas"==E[o])g.attr("src",r),s.css("display","none"),g.css("display","inline-block");else{f.css("display","block");var d=a.hashCode(n)%w.length;switch(i.addClass(I[d]),o){case"vision":s.css("display","none"),h.css("display","inline-block"),m.css("display","none"),P.css("display","none"),g.css("display","none");break;case"event":s.css("display","none"),m.css("display","inline-block"),h.css("display","none"),P.css("display","none"),g.css("display","none");break;case"note":s.css("display","none"),P.css("display","inline-block"),m.css("display","none"),h.css("display","none"),g.css("display","none")}}}else g.attr("src",r),s.css("display","none"),g.css("display","inline-block")}var s=i.children("md-icon"),g=i.children("img"),f=i.children("div"),h=i.find("#icon-film"),m=i.find("#icon-task"),P=i.find("#icon-folder"),v=null,y=n(l.pipPartyId),b=n(l.pipPartyName),x=n(l.pipEntityType),C=n(l.pipId),w=c.getAvatarColors(),I=c.getColorClasses(),E=c.getEntityTypes();g.load(function(e){v=$(e.target),c.setImageMarginCSS(i,v)}),i.addClass("pip-avatar flex-fixed"),l.ngClass&&e.$watch(l.ngClass,function(){setTimeout(function(){c.setImageMarginCSS(i,v)},50)}),u(),o.toBoolean(l.pipRebindAvatar)&&t.$on("pipPartyAvatarUpdated",p),o.toBoolean(l.pipRebind)&&(e.$watch(y,function(e,t){t!==e&&u()}),e.$watch(C,function(e,t){t!==e&&u()}))}])}(),function(){"use strict";var e=angular.module("pipAvatarEdit",["ui.event","angularFileUpload","pipPicturePaste","pipRest","pipImageUtils","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_EDIT_TEXT:"Click here to upload a picture"}),e.translations("ru",{PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки"})}]),e.directive("pipAvatarEdit",function(){return{restrict:"EA",scope:{ngDisabled:"&",pipPartyId:"&",pipEntityType:"&",pipId:"&",pipCreated:"&",pipChanged:"&",pipReset:"&"},templateUrl:"picture_edit/picture_edit.html",controller:"pipAvatarEditController"}}),e.controller("pipAvatarEditController",["$scope","$element","$attrs","$http","$upload","$rootScope","pipPicturePaste","pipRest","pipImageUtils",function(e,t,i,l,n,o,a,r,d){function c(t){if(e.control.progress=0,e.control.uploading=!1,e.control.uploaded=!1,e.control.file=null,e.control.state="original",e.control.url="",t)e.onChange();else{var i=d.getAvatarUrl(e.pipPartyId(),"",e.pipId(),e.pipEntityType(),!1,!0);if(!i)return;e.control.progress=0,e.control.url=i,e.control.uploaded=""!=e.control.url,e.onChange()}}function p(){return e.pipEntityType()&&e.pipId()&&e.pipPartyId()?_+"/api/parties/"+e.pipPartyId()+"/"+E[e.pipEntityType()]+"/"+e.pipId()+"/avatar":e.pipPartyId()&&!e.pipEntityType()?i.pipEntityType||i.pipId?"":_+"/api/parties/"+e.pipPartyId()+"/avatar":""}function u(){var t=e.control.url,i=p(),l=t.slice(t.lastIndexOf("/")+1,t.length).split("?")[0];return i+"?name="+l+"&url="+t}function s(t,i){var o=e.control,a=o.file;if(null!==e.control.file){var r=new FileReader,d=p();r.onload=function(e){o.uploading=!0;n.http({url:d+"?name="+a.name,headers:{"Content-Type":a.type},data:e.target.result}).then(function(e){o.reset(),t&&t(e)},function(e){o.uploading=!1,o.upload=!1,o.progress=0,i?i(e):console.error(e)},function(e){o.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},r.readAsArrayBuffer(a)}else{var c=u();o.uploading=!0,l.post(c).success(function(e){o.reset(),t&&t(e)}).error(function(e){o.uploading=!1,o.upload=!1,i?i(e):console.error(e)})}}function g(t,i){var n=e.control;l["delete"](p()).success(function(e){n.reset(!0),t&&t()}).error(function(e){n.uploading=!1,n.upload=!1,n.progress=0,i?i(e):console.error(e)})}function f(t,i){"changed"==e.control.state?s(t,i):"deleted"==e.control.state?g(t,i):t&&t()}function h(){return""==e.control.url&&!e.control.uploading}function m(){return"original"!=e.control.state}function P(t,i){e.control.file=i,e.control.url=t,e.control.state="changed",e.onChange()}function v(t){t.stopPropagation(),w.focus(),e.control.file=null,e.control.url="",e.control.state="deleted",e.onChange()}function y(t){13==t.keyCode||32==t.keyCode?setTimeout(function(){w.trigger("click")},0):46==t.keyCode||8==t.keyCode?(e.control.file=null,e.control.url="",e.control.state="deleted",e.onChange()):27==t.keyCode&&e.control.reset()}function b(t){e.$apply(function(){e.control.url="";var i=$(t.target);d.setErrorImageCSS(i,{width:"auto",height:"100%"})})}function x(t){var i=$(t.target);d.setImageMarginCSS({clientWidth:80,clientHeight:80},i),e.control.uploading=!1}function C(){e.pipChanged&&e.pipChanged({$event:{sender:e.control},$control:e.control})}var w=t.children(".pip-picture-upload"),I=w.children("input[type=file]"),E=d.getEntityTypes(),_=r.serverUrl();e.text=i.pipDefaultText||"PICTURE_EDIT_TEXT",e.icon=i.pipDefaultIcon||"picture-no-border",e.control={url:"",progress:0,uploaded:!1,uploading:!1,loaded:!1,file:null,state:"original"},e.control.reset=c,e.control.save=f,e.empty=h,e.isUpdated=m,e.readItemLocally=P,e.onDeleteClick=v,e.onKeyDown=y,e.onImageError=b,e.onImageLoad=x,e.onChange=C,e.$watch(e.pipId,function(t){e.pipReset()!==!1&&e.control.reset()}),e.$watch(e.pipPartyId,function(t){e.pipReset()!==!1&&e.control.reset()}),e.$watch(e.ngDisabled,function(t){I.attr("disabled",e.control.disabled)}),t.children(".pip-picture-upload").focus(function(){a.addPasteListener(function(t){e.readItemLocally(t.url,t.file)})}),t.children(".pip-picture-upload").blur(function(){a.removePasteListener()}),t.addClass("pip-picture-edit"),e.pipCreated&&e.pipCreated({$event:{sender:e.control},$control:e.control}),e.control.reset()}])}(),function(){"use strict";var e=angular.module("pipCameraDialog",["ngMaterial","pipCore","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{TAKE_PICTURE:"Take a picture",WEB_CAM_ERROR:"Webcam is missing or was not found"}),e.translations("ru",{TAKE_PICTURE:"Сделать фото",WEB_CAM_ERROR:"Web-камера отсутствует или не найдена"})}]),e.factory("pipCameraDialog",["$mdDialog",function(e){return{show:function(t){e.show({templateUrl:"camera_dialog/camera_dialog.html",clickOutsideToClose:!0,controller:"pipCameraController"}).then(function(e){Webcam.reset(),t&&t(e)},function(){Webcam.reset()})}}}]),e.controller("pipCameraController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog",function(e,t,i,l,n){function o(){e.$freeze?Webcam.snap(function(t){e.$freeze=!1,n.hide(t)}):(e.$freeze=!0,Webcam.freeze())}function a(){e.$freeze=!1,Webcam.unfreeze()}function r(){n.cancel()}e.theme=t.$theme,Webcam.init(),setTimeout(function(){Webcam.attach(".camera-stream")},0),Webcam.on("error",function(t){e.webCamError=!0,console.error(t)}),Webcam.set({width:400,height:300,dest_width:400,dest_height:300,crop_width:400,crop_height:300,image_format:"jpeg",jpeg_quality:90}),Webcam.setSWFLocation("webcam.swf"),e.$freeze=!1,e.onTakePictureClick=o,e.onResetPicture=a,e.onCancelClick=r}])}(),function(){"use strict";var e=angular.module("pipCollage",["pipCore","pipRest"]);e.directive("pipCollage",function(){return{restrict:"EA",scope:!1,controller:"pipCollageController"}}),e.controller("pipCollageController",["$scope","$element","$attrs","$parse","$rootScope","pipUtils","pipStrings","pipRest","pipImageUtils",function(e,t,i,l,n,o,a,r,d){function c(){var e=t.find("img"),i=0;for(i;i<e.length;i++){var l=angular.element(e[i].parentElement),n=angular.element(e[i]);"none"!=n.css("display")&&d.setImageMarginCSS(l,n)}var o=t.find("md-icon"),i=0;for(i;i<o.length;i++){var l=angular.element(o[i].parentElement),a=angular.element(o[i]);"none"!=l.css("display")&&d.setIconMarginCSS(l[0],a)}}function p(){var e={h:t.height(),w:t.width()};return e}function u(e){var t=$(e.target),i=t.parent(),l=i.children("div"),n=t.parent().find("md-icon");l.css("display","block"),t.css("display","none"),d.setIconMarginCSS(i[0],n),n.empty().append(E)}function s(e){var t=$(e.target),i=t.parent(),l=i.children("div");d.setImageMarginCSS(i,t),l.css("display","none")}function g(t){var i=I[t-1];if(1==i.length)return i[0];var l=x?""+x(e):"",n=a.hashCode(l);return i[n%i.length]}function f(){if(b){var t=b(e);return _.clone(t)}if(y){for(var i=y(e)||[],l=r.serverUrl(),o=(n.$user||{}).id,a=(n.$party||{}).id||o,d=[],c=0;c<i.length;c++)d.push(l+"/api/parties/"+a+"/files/"+i[c]+"/content");return d}return[]}function h(e,t){var i=e[0],l="",n="";return e.splice(0,1),l+=t.fullWidth?" pip-full-width":"",l+=t.fullHeight?" pip-full-height":"",l+=" flex-"+t.flex,n+=t.leftPadding?" pip-left":"",n+=t.rightPadding?" pip-right":"",n+=t.topPadding?" pip-top":"",n+=t.bottomPadding?" pip-bottom":"",w?'<a class="pip-picture-container'+l+'" flex="'+t.flex+'" href="'+i+'"  target="_blank"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon></md-icon></div></div></a>':'<div class="pip-picture-container'+l+'" flex="'+t.flex+'"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon></md-icon></div></div></div>'}function m(e,t){var i,l="";l+=t.fullWidth?" pip-full-width":"",l+=t.fullHeight?" pip-full-height":"",l+=" flex-"+t.flex,l+=" layout-"+t.layout,i='<div class="pip-picture-group layout'+l+'" flex="'+t.flex+'" layout="'+t.layout+'">';for(var n=0;n<t.children.length;n++)i+=P(e,t.children[n]);return i+="</div>"}function P(e,t){return t.group?m(e,t):h(e,t)}function v(i){t.find("img").unbind("error").unbind("load"),t.empty();var i=f();if(0==i.length)return void t.hide();if(i.length>8){var l=C?C(e):!1;l||(i.length=8)}if(i.length<=8){var n=g(i.length),o='<div class="pip-collage-section">'+P(i,n)+"</div>";o+='<div class="clearfix"></div>',t.html(o)}else{for(var o="";i.length>0;){var a=i.splice(0,8),n=g(a.length);o+='<div class="pip-collage-section">'+P(a,n)+"</div>"}o+='<div class="clearfix"></div>',t.html(o)}t.find("img").bind("error",u).bind("load",s),t.show()}var y=i.pipPictureIds?l(i.pipPictureIds):null,b=i.pipSrcs?l(i.pipSrcs):null,x=i.pipUniqueCode?l(i.pipUniqueCode):null,C=i.pipMultiple?l(i.pipMultiple):null,w=o.toBoolean(i.pipOpen),I=d.getCollageSchemes(),E='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1"xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"x="0px" y="0px"viewBox="0 0 510 510"style="enable-background:new 0 0 515 515;"xml:space="preserve"><defs><style type="text/css"><![CDATA[#symbol-picture-no-border {        transform-origin: 50% 50%;        transform: scale(0.6, -0.6);    }        ]]></style>        </defs><rect x="0" width="515" height="515"/><path id="symbol-picture-no-border" d="M120 325l136-102 69 33 136-82 0-54-410 0 0 136z m341 15c0-28-23-51-51-51-29 0-52 23-52 51 0 29 23 52 52 52 28 0 51-23 51-52z" /></svg>';t.addClass("pip-collage"),o.toBoolean(i.pipRebind)&&(b?(e.$watch(b,function(e){v()}),e.$watchCollection(b,function(e){v()})):y&&e.$watch(y,function(e){v()})),e.getElementDimensions=p;_.debounce(c,50);e.$watch(e.getElementDimensions,function(e,t){e&&t&&t.h==e.h&&t.w==e.w||c()},!0),v()}])}(),function(){"use strict";var e=angular.module("pipGallerySearchDialog",["ngMaterial","pipCore","pipPictures.Templates","pipRest"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{IMAGE_GALLERY:"Add from image gallery",SEARCH_PICTURES:"Search for pictures...",IMAGE_START_SEARCH:"Images will appear here once you start searching"}),e.translations("ru",{IMAGE_GALLERY:"Добавить из галереи изображений",SEARCH_PICTURES:"Поиск изображений...",IMAGE_START_SEARCH:"Картинки появятся после начала поиска"})}]),e.factory("pipGallerySearchDialog",["$mdDialog",function(e){return{show:function(t,i){e.show({templateUrl:"gallery_search_dialog/gallery_search_dialog.html",clickOutsideToClose:!0,controller:"pipGallerySearchController",locals:{multiple:i}}).then(function(e){t&&t(e)},function(){})}}}]),e.controller("pipGallerySearchController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog","$http","pipRest","multiple","pipTransaction",function(e,t,i,l,n,o,a,r,d){function c(){if(!e.transaction.busy()&&""!=e.$search&&e.$search!=P){P=e.$search,e.$images=[],e.stop=null;var t=v+"?q="+e.$search,i=e.transaction.begin("ENTERING");i&&o.get(t).success(function(t){if(!e.transaction.aborted(i)){for(var l=0;l<t.length;l++)e.$images.push({checked:!1,url:t[l].link,thumbnail:t[l].thumbnail});e.transaction.end()}}).error(function(e){console.error(e)})}}function p(){e.transaction.abort(),P=""}function u(t){13===t.keyCode&&e.onSearchClick()}function s(t){e.transaction.busy()||(t.checked=!t.checked,r?t.checked?y.push(t):_.remove(y,{url:t.url}):t.checked?y.length>0?(y[0].checked=!1,y[0]=t):y.push(t):y=[])}function g(){if(!e.transaction.busy()){var t=[];y.forEach(function(e){e.checked&&t.push(e.url)}),n.hide(t)}}function f(){n.cancel()}function h(){return 0==y.length||e.transaction.busy()}function m(){setTimeout(function(){var e=$(".pip-gallery-search-dialog .search-images");e.length>0&&e.focus()},0)}var P="",v=a.serverUrl()+"/api/images/search",y=[];e.theme=t.$theme,e.$serverUrl=a.serverUrl(),e.$search="",e.$images=[],e.transaction=d("search",e),e.onSearchClick=c,e.onKeyPress=u,e.onImageClick=s,e.onAddClick=g,e.onCancelClick=f,e.addButtonDisabled=h,e.onStopSearchClick=p,m()}])}(),function(){"use strict";var e=angular.module("pipPicture",["pipCore"]);e.directive("pipPicture",function(){return{restrict:"EA",scope:{src:"&pipSrc",pictureId:"=pipPictureId",defaultIcon:"=pipDefaultIcon"},template:"<img ui-event=\"{ error: 'onImageError($event)', load: 'onImageLoad($event)' }\"/><div><span></span></div>",controller:"pipPictureController"}}),e.controller("pipPictureController",["$scope","$element","$attrs","$rootScope","pipUtils","pipImageUtils","pipRest",function(e,t,i,l,n,o,a){function r(t){e.$apply(function(){var e=$(t.target);o.setErrorImageCSS(e),u.css("display","block")})}function d(e){var i=$(e.target);o.setImageMarginCSS(t,i),u.css("display","none")}function c(){if(e.pictureId){var t=a.serverUrl(),i=(l.$user||{}).id,n=(l.$party||{}).id||i,o=t+"/api/parties/"+n+"/files/"+e.pictureId+"/content";p.attr("src",o)}else e.src?p.attr("src",e.src()):p.attr("src","")}var p=t.children("img"),u=t.children("div");e.onImageError=r,e.onImageLoad=d,t.addClass("pip-picture"),c(),n.toBoolean(i.pipRebind)&&e.$watch(e.pictureId,function(t){e.pictureId!=t&&c()}),n.toBoolean(i.pipRebind)&&e.$watch(e.src,function(t){e.src!=t&&c()})}])}(),function(){"use strict";var e=angular.module("pipPictureEdit",["ui.event","angularFileUpload","pipRest","pipPicturePaste","pipTranslate","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{ERROR_WRONG_IMAGE_FILE:"Incorrect image file. Please, choose another one",PICTURE_EDIT_TEXT:"Click here to upload a picture"}),e.translations("ru",{ERROR_WRONG_IMAGE_FILE:"Неправильный файл с изображением. Выберете другой файл",PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки"})}]),e.directive("pipPictureEdit",function(){return{restrict:"EA",scope:{ngDisabled:"&",pipCreated:"&",pipChanged:"&",pipReset:"&",pipPictureId:"=",pipAddedPicture:"="},templateUrl:"picture_edit/picture_edit.html",controller:"pipPictureEditController"}}),e.controller("pipPictureEditController",["$scope","$element","$attrs","$http","$upload","$timeout","$rootScope","$parse","pipRest","pipPicturePaste","pipImageUtils","pipUtils",function(e,t,i,l,n,o,a,r,d,c,p,u){function s(t){e.control.progress=0,e.control.uploading=!1,e.control.uploaded=!1,e.control.file=null,e.control.state=e.pictureStartState,e.control.url="";var i="";if(t)e.onChange();else{if(a.$party&&a.$party.id&&e.pipPictureId&&(i=R+"/"+e.pipPictureId+"/content"),!i)return;e.control.url=i,e.control.uploaded=!0,e.onChange()}}function g(){var t=e.control.url,i=t.slice(t.lastIndexOf("/")+1,t.length).split("?")[0];return R+"?name="+i+"&url="+t}function f(){c.addPasteListener(function(t){e.readItemLocally(t.url,t.file)})}function h(){c.removePasteListener()}function m(t,i){var o=e.control,a=o.file;if(null!==e.control.file){var r=new FileReader;r.onload=function(l){o.uploading=!0;n.http({url:R+"?name="+a.name,headers:{"Content-Type":a.type},data:l.target.result}).then(function(i){e.pipPictureId=i.data.id,o.reset(),t&&t(i)},function(e){o.uploading=!1,o.upload=!1,o.progress=0,i?i(e):console.error(e)},function(e){o.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},r.readAsArrayBuffer(a)}else{var d=g();o.uploading=!0,l.post(d).success(function(i){e.pipPictureId=i.id,o.reset(),t&&t(i)}).error(function(e){o.uploading=!1,o.upload=!1,i?i(e):console.error(e)})}}function P(t,i){var n=e.control;l["delete"](R+"/"+e.pipPictureId).success(function(i){e.pipPictureId=null,n.reset(!0),t&&t()}).error(function(e){n.uploading=!1,n.upload=!1,n.progress=0,i?i(e):console.error(e)})}function v(t,i){"changed"==e.control.state?m(t,i):"deleted"==e.control.state?P(t,i):t&&t()}function y(){return""==e.control.url&&!e.control.uploading}function b(){return"original"!=e.control.state}function x(t,i){e.control.file=i,e.control.url=t,e.control.state="changed",e.onChange()}function C(t){t.stopPropagation(),k.focus(),e.control.file=null,e.control.url="","copied"!=e.control.state&&(e.control.state="deleted"),e.onChange()}function w(t){13==t.keyCode||32==t.keyCode?setTimeout(function(){k.trigger("click")},0):46==t.keyCode||8==t.keyCode?(e.control.file=null,e.control.url="",e.control.state="deleted",e.onChange()):27==t.keyCode&&e.control.reset()}function I(t){e.$apply(function(){e.control.url="";var i=$(t.target);p.setErrorImageCSS(i,{width:"auto",height:"100%"})})}function E(t){
var i=$(t.target);p.setImageMarginCSS({clientWidth:80,clientHeight:80},i),e.control.uploading=!1}function _(){e.pipChanged&&e.pipChanged({$event:{sender:e.control},$control:e.control})}var k=t.children(".pip-picture-upload"),T=k.children("input[type=file]"),W=d.serverUrl(),R=W+"/api/parties/"+a.$party.id+"/files";e.text=i.pipDefaultText||"PICTURE_EDIT_TEXT",e.icon=i.pipDefaultIcon||"picture-no-border",e.pictureStartState=u.toBoolean(e.pipAddedPicture)?"copied":"original",e.control={url:"",progress:0,uploaded:!1,uploading:!1,loaded:!1,file:null,state:e.pictureStartState},e.control.reset=s,e.control.save=v,e.empty=y,e.isUpdated=b,e.readItemLocally=x,e.onDeleteClick=C,e.onKeyDown=w,e.onImageError=I,e.onImageLoad=E,e.onChange=_,e.onBlur=h,e.onFocus=f,u.toBoolean(i.pipRebind)&&e.$watch("pipPictureId",function(t){e.control.reset()}),e.$watch(e.ngDisabled,function(t){T.attr("disabled",e.control.disabled)}),t.addClass("pip-picture-edit"),e.control.reset(),e.pipCreated&&e.pipCreated({$event:{sender:e.control},$control:e.control})}])}(),function(){"use strict";var e=angular.module("pipPictureListEdit",["ui.event","angularFileUpload","pipCore","pipFocused","pipRest","pipPicturePaste"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_LIST_EDIT_TEXT:"Click here to add a picture",ERROR_TRANSACTION_IN_PROGRESS:"Transaction is in progress. Please, wait until it is finished or abort",ERROR_IMAGE_PRELOADING:"Image loading error. The picture can not be saved"}),e.translations("ru",{PICTURE_LIST_EDIT_TEXT:"Нажмите сюда чтобы добавить картинку",ERROR_TRANSACTION_IN_PROGRESS:"Транзакция еще не завершена. Подождите окончания или прервите её",ERROR_IMAGE_PRELOADING:"Ошибка при загрузки картинки. Картинка не сохранена."})}]),e.directive("pipPictureListEdit",function(){return{restrict:"EA",scope:{pipPictureIds:"=",pipAddedPicture:"=",ngDisabled:"&",pipCreated:"&",pipChanged:"&"},templateUrl:"picture_list_edit/picture_list_edit.html",controller:"pipPictureListEditController"}}),e.controller("pipPictureListEditController",["$scope","$rootScope","$element","$attrs","$parse","$http","$upload","$timeout","pipUtils","pipRest","pipPicturePaste","pipImageUtils",function(e,t,i,l,n,o,a,r,d,c,p,u){function s(t){var i=c.serverUrl(),l=e.$party?e.$party.id:c.userId();return i+"/api/parties/"+l+"/files/"+t+"/content"}function g(e,t){t.error=!0}function f(t){p.addPasteListener(function(t){e.readItemLocally(t.url,t.file)})}function h(){p.removePasteListener()}function m(){var t=e.pipPictureIds,i=[];if(null==t||0==t.length)return i;for(var l=0;l<t.length;l++)i.push({pin:U++,id:t[l],uploading:!1,uploaded:!1,progress:0,file:null,url:s(t[l]),state:e.pictureStartState});return i}function P(){e.pipPictureIds&&e.pipPictureIds.length>0&&e.pipPictureIds.splice(0,e.pipPictureIds.length);for(var t=0;t<e.control.items.length;t++){var i=e.control.items[t];i.id&&e.pipPictureIds.push(i.id)}}function v(){e.control.uploading=0,e.control.items=m()}function y(t){var i=t.url.slice(t.url.lastIndexOf("/")+1,t.url.length).split("?")[0],l=c.serverUrl(),n=e.$party?e.$party.id:c.userId();return l+"/api/parties/"+n+"/files?name="+i+"&url="+t.url}function b(t){var i=c.serverUrl(),l=e.$party?e.$party.id:c.userId();return i+"/api/parties/"+l+"/files?name="+t.file.name}function x(e,t){if(null!==e.file){var i=e.file,l=new FileReader;l.onload=function(l){e.uploading||(e.uploading=!0,e.upload=a.http({url:b(e),headers:{"Content-Type":i.type},data:l.target.result}).then(function(i){e.id=i.data?i.data.id:null,e.uploaded=!0,e.uploading=!1,e.progress=0,e.upload=null,e.file=null,e.url=s(e.id),e.state="original",t()},function(i){e.uploaded=!1,e.uploading=!1,e.progress=0,e.upload=null,t(i)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))}))},l.readAsArrayBuffer(i)}else{var n=y(e);e.uploading=!0,o.post(n).success(function(i){e.id=i.data?i.data.id:i.id||null,e.uploaded=!0,e.uploading=!1,e.progress=0,e.upload=null,e.file=null,e.url=s(e.id),e.state="original",t()}).error(function(i){e.uploaded=!1,e.uploading=!1,e.progress=0,e.upload=null,t()})}}function C(t){var i=c.serverUrl(),l=e.$party?e.$party.id:c.userId();return i+"/api/parties/"+l+"/files/"+t.id}function w(t,i){var l=e.control;t.upload&&(t.upload.abort(),t.upload=null),"deleted"==t.state&&o["delete"](C(t)).success(function(e){_.remove(l.items,{pin:t.pin}),i()}).error(function(e,n){null==e?_.remove(l.items,{pin:t.pin}):(t.uploaded=!1,t.uploading=!1,t.progress=0,t.upload=null),i(e)})}function I(t,i){var l=e.control;if(l.uploading)return void(i&&i("ERROR_TRANSACTION_IN_PROGRESS"));l.error=null,l.uploading=0;for(var n=function(e){e&&!l.error&&(l.error=e),l.uploading--,0==l.uploading&&(l.error?i?i(l.error):console.error(l.error):(P(),t&&t()))},o=0;o<l.items.length;o++){var a=l.items[o];"added"!=a.state||a.error?"deleted"==a.state&&(l.uploading++,w(a,n)):(l.uploading++,x(a,n))}0==l.uploading&&t&&t()}function E(){for(var t=e.control,i=0;i<t.items.length;i++){var l=t.items[i];l.uploading&&(l.upload&&l.upload.abort(),l.uploaded=!1,l.uploading=!1,l.progress=0,l.upload=null)}t.uploading=0}function k(t,i){e.control.items.push({pin:U++,id:null,uploading:!1,uploaded:!1,progress:0,file:i,url:t,state:"added"}),e.onChange()}function T(e){if(D.focus(),null!=e&&0!=e.length)for(var t=0;t<e.length;t++){var i=e[t];i.type.indexOf("image")>-1&&k(i)}}function W(t){"added"==t.state||"copied"==t.state?_.remove(e.control.items,{pin:t.pin}):t.state="deleted",e.onChange()}function R(t,i){i?46!=t.keyCode&&8!=t.keyCode||("added"==i.state?_.remove(e.control.items,{pin:i.pin}):i.state="deleted",e.onChange()):13!=t.keyCode&&32!=t.keyCode||setTimeout(function(){D.trigger("click")},0)}function A(e,t){t.error=!1,setTimeout(function(){var t=$(e.target);u.setImageMarginCSS({clientWidth:80,clientHeight:80},t)},250),t.loaded=!0}function S(){e.pipChanged&&e.pipChanged({$event:{sender:e.control},$control:e.control})}var D=i.children(".pip-picture-drop"),U=0;e.text=l.pipDefaultText||"PICTURE_LIST_EDIT_TEXT",e.icon=l.pipDefaultIcon||"picture-no-border",e.pipRebind=d.toBoolean(l.pipRebind),e.pictureStartState=d.toBoolean(e.pipAddedPicture)?"copied":"original",e.control={uploading:0,items:[]},e.control.reset=v,e.control.save=I,e.control.abort=E,e.filterItem=function(e){return"deleted"!=e.state},e.readItemLocally=k,e.onSelectClick=T,e.onDeleteClick=W,e.onKeyDown=R,e.onImageError=g,e.onImageLoad=A,e.onChange=S,e.onBlur=h,e.onFocus=f,e.pipRebind&&e.$watch(function(){return e.pipPictureIds},function(t){e.control.reset()}),i.addClass("pip-picture-list-edit"),e.control.reset(),e.pipCreated&&e.pipCreated({$event:{sender:e.control},$control:e.control})}])}(),function(){"use strict";var e=angular.module("pipPictureUrlDialog",["ngMaterial","pipCore","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_FROM_WEBLINK:"Add from web link",LINK_PICTURE:"Link to the picture..."}),e.translations("ru",{PICTURE_FROM_WEBLINK:"Добавить из веб ссылки",LINK_PICTURE:"Ссылка на изображение..."})}]),e.factory("pipPictureUrlDialog",["$mdDialog",function(e){return{show:function(t){e.show({templateUrl:"picture_url_dialog/picture_url_dialog.html",clickOutsideToClose:!0,controller:"pipPictureUrlDialogController"}).then(function(e){t&&t(e)})}}}]),e.controller("pipPictureUrlDialogController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog","pipImageUtils",function(e,t,i,l,n,o){function a(e){var t=e.width(),i=e.height(),l={};t>i?(l.width="250px",l.height="auto"):(l.width="auto",l.height="250px"),e.css(l)}function r(){var t=$("img#url_image").on("error",function(){e.invalid=!0,e.$apply()}).on("load",function(){e.invalid=!1,a(t),e.$apply()}).attr("src",e.url)}function d(){n.cancel()}function c(){n.hide(e.url)}e.url="",e.invalid=!0,e.theme=t.$theme,e.checkUrl=r,e.onCancelClick=d,e.onAddClick=c}])}(),function(){"use strict";var e=angular.module("pipPicturePaste",[]);e.factory("pipPicturePaste",["$timeout",function(e){var t={},i=null;return t.addPasteListener=function(t){window.Clipboard||(null!==i&&this.removePasteElement(),i=document.createElement("div"),i.setAttribute("contenteditable","true"),$(i).css({position:"absolute",left:"-999",width:"0",height:"0",overflow:"hidden",outline:0}),document.body.appendChild(i)),$(document).on("paste",function(i){if(null==i.clipboardData&&i.originalEvent&&(i=i.originalEvent),i.clipboardData){var l=i.clipboardData.items;_.each(l,function(i){if(-1!=i.type.indexOf("image")){var l=i.getAsFile(),n=new FileReader;n.onload=function(i){e(function(){t({url:i.target.result,file:l})})},n.readAsDataURL(l)}})}else window.clipboardData&&window.clipboardData.files&&_.each(window.clipboardData.files,function(i){var l=new FileReader;l.onload=function(l){e(function(){t({url:l.target.result,file:i})})},l.readAsDataURL(i)})})},t.removePasteListener=function(){window.Clipboard||null!==i&&(document.body.removeChild(i),i=null),$(document).off("paste")},t}])}(),function(){"use strict";var e=angular.module("pipImageUtils",[]);e.service("pipImageUtils",["$http","pipStrings","$rootScope","pipRest",function(e,t,i,l){function n(){return h}function o(){return g}function a(){return f}function r(){return m}function d(e,i,n,o,a,r){var d=1e3*Math.floor((new Date).getTime()/1e3),c=t.hashCode(n)%f.length,p=null,u=null,s="",g=l.serverUrl();if(a=a&&a===!0?"&no_redirect=true":"",o&&n&&e||e)if(o&&n&&e){if("category"==o)return;r||(s="default_template="+o+"&bg="+f[c]+"&fg=white&"),"goals"!=h[o]&&"areas"!=h[o]||(u=g+"/api/parties/"+e+"/"+h[o]+"/"+n+"/avatar?"+s+"timestamp="+d+"&obj_id="+n+a)}else e&&i?(c=t.hashCode(e)%f.length,p=(i[0]||"?").toUpperCase(),r||(s="default_template=letter&bg="+f[c]+"&fg=white&chr="+p+"&"),u=g+"/api/parties/"+e+"/avatar?"+s+"timestamp="+d+"&obj_id="+e+a):!e||o||n||(u=g+"/api/parties/"+e+"/avatar?timestamp="+d+"&obj_id="+e+a);return u}function c(t,n,o){var a,r=(i.$user||{}).id,d=(i.$party||{}).id||r,c=l.serverUrl()+"/api/parties/"+d+"/files/"+t;c&&e.get(c).success(function(e){a=e&&e.url?e.url:"",n&&n(a)}).error(function(e){o&&o(e)})}function p(e,t){var i={width:"","margin-left":"",height:"","margin-top":""};t&&(i=_.assign(i,t)),e&&e.css(i)}function u(e,t,i){var l=e.width?e.width():e.clientWidth,n=e.height?e.height():e.clientHeight,o=t[0].naturalWidth||t.width,a=t[0].naturalHeight||t.height,r=0,d={};o/l>a/n?(r=-((o/a*n-l)/2),d["margin-left"]=""+r+"px",d.height=""+n+"px",d.width=""+o*n/a+"px",d["margin-top"]=""):(r=-((a/o*l-n)/2),d["margin-top"]=""+r+"px",d.height=""+a*l/o+"px",d.width=""+l+"px",d["margin-left"]=""),i&&(d=_.assign(d,i)),t.css(d)}function s(e,t){var i=e.clientWidth?e.clientWidth:e.width,l=e.clientHeight?e.clientHeight:e.height,n=0,o=i>l?l:i,a={width:""+o+"px","margin-left":"",height:""+o+"px","margin-top":""};i>l?(n=(i-l)/2,a["margin-left"]=""+n+"px"):(n=(l-i)/2,a["margin-top"]=""+n+"px"),t.css(a)}var g=["pip-avatar-color-0","pip-avatar-color-1","pip-avatar-color-2","pip-avatar-color-3","pip-avatar-color-4","pip-avatar-color-5","pip-avatar-color-6","pip-avatar-color-7","pip-avatar-color-8","pip-avatar-color-9","pip-avatar-color-10","pip-avatar-color-11","pip-avatar-color-12","pip-avatar-color-13","pip-avatar-color-14","pip-avatar-color-15"],f=["rgba(239,83,80,1)","rgba(236,64,122,1)","rgba(171,71,188,1)","rgba(126,87,194,1)","rgba(92,107,192,1)","rgba(3,169,244,1)","rgba(0,188,212,1)","rgba(0,150,136,1)","rgba(76,175,80,1)","rgba(139,195,74,1)","rgba(205,220,57,1)","rgba(255,193,7,1)","rgba(255,152,0,1)","rgba(255,87,34,1)","rgba(121,85,72,1)","rgba(96,125,139,1)"],h={goal:"goals",objective:"goals",dream:"goals",accomplishment:"goals",area:"areas",overall:"visions",vision:"visions",event:"events",instance:"events"},m=[[{flex:100,fullWidth:!0,fullHeight:!0}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{flex:50,fullHeight:!0,leftPadding:!0}]}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullHeight:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:70,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:30,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,rightPadding:!0,topPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:30,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:70,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:75,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,fullWidth:!0,children:[{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]];return{getColorClasses:o,getAvatarColors:a,getEntityTypes:n,setErrorImageCSS:p,setImageMarginCSS:u,setIconMarginCSS:s,getAvatarUrl:d,bindFile:c,getCollageSchemes:r}}])}();
!function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("checklist_edit/checklist_edit.html",'<div ng-class="{\'pip-checklist-draggable\': selected.drag}" id="{{\'checklist-\' + selected.id}}"><div ng-repeat="item in checklistContent" ng-mousedown="onClick($event, $index)" class="pip-checklist-item" id="{{\'check-item-\' + selected.id + \'-\' + $index}}" pip-drag="checklistContent.length > 1 && selected.drag && !item.empty" pip-drag-data="item" pip-force-touch="true" pip-touch-delay="30" pip-drop="true" pip-drag-stop="onStop(selected.id)" pip-drag-start="onStart(selected.id)" pip-scroll-container="pipScrollContainer" pip-drop-success="onDropComplete($index, $data, $event, selected.id)"><div ng-class="{\'put_place\': selected.drag}"></div><div class="pip-checklist-item-body" pip-cancel-drag="true" ng-class="{ \'select-active-item\': isSelectedItem($index) }" layout="row" layout-align="start start"><div class="pip-checklist-button" pip-cancel-drag="true"><md-button pip-drag-handle="" class="pip-icon-checklist-button md-icon-button no-ripple-container" aria-label="REARRANGE" tabindex="-1" pip-mobile-mousedown="onDownDragg(item)" pip-mobile-mouseup="onDraggEnd()" ng-if="pipDraggable && checklistContent.length > 2 && !item.empty" ng-class="checklistContent.length > 1 ? \'cursor-move\' : \'cursor-default\'" ng-disabled="ngDisabled()"><md-icon class="text-grey" md-svg-icon="icons:vhandle"></md-icon></md-button></div><div class="pip-checklist-button" style="overflow: hidden" pip-cancel-drag="true"><div class="pip-checklist-button-container"><md-button class="pip-icon-checklist-button md-icon-button" ng-show="item.empty" ng-disabled="ngDisabled()" md-ink-ripple="" ng-click="onAddItem()" tabindex="-1" aria-label="PLUS"><md-icon class="text-grey" md-svg-icon="icons:plus"></md-icon></md-button><md-checkbox ng-model="item.checked" ng-show="!item.empty" aria-label="COMPLETE" pip-cancel-drag="true" ng-focus="onItemFocus($index)" ng-change="onChecked(item)" ng-disabled="ngDisabled()"></md-checkbox></div></div><div class="pip-checklist-text" flex="" pip-cancel-drag="true"><md-input-container md-no-float="" flex=""><textarea ng-model="item.text" name="{{\'text\' + $index}}" aria-label="TEXT" class="pip-text-checkbox" ng-focus="onItemFocus($index)" ng-change="onChangeItem($index)" ng-keydown="onTextareaKeyDown($event, $index, item)" placeholder="{{::\'TEXT\' | translate}}" id="{{\'check-item-text-\' + selected.id + \'-\' + $index}}" ng-disabled="ngDisabled()">\n                    </textarea></md-input-container></div><div class="pip-checklist-button" pip-cancel-drag="true"><md-button class="pip-icon-checklist-button md-icon-button" md-ink-ripple="" ng-click="onDeleteItem($index, item)" ng-disabled="ngDisabled()" tabindex="-1" ng-focus="onItemFocus($index)" ng-show="isSelectedItem($index)" aria-label="DELETE-ITEM"><md-icon class="text-grey" md-svg-icon="icons:cross-circle"></md-icon></md-button></div></div></div><div id="{{\'check-item-empty-\' + selected.id}}" class="pip-empty-text" pip-drag="false" pip-drop="true" pip-drop-success="onDropComplete(checklistContent.length, $data, $event, selected.id)"><div ng-class="{\'put_place\': selected.drag}"></div></div></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("composite_edit/composite_edit.html",'<div class="divider-top"><div class="pip-composite-body" ng-show="compositeContent.length != 0" ng-class="{\'drag-active\': selected.drag}"><div class="pip-composite-item" ng-repeat="obj in compositeContent track by obj.id" ng-mousedown="onClick($event, $index, obj)" ng-class="{\'selected-content\': isSelectedSection($index, obj), \'composite-animate\': !obj.empty && compositeContent.length > 1}" ng-keyup="onKeyUp($event)" ng-keydown="onKeyDown($event, $index, obj)" pip-drag="compositeContent.length > 1 && selected.drag" pip-touch-delay="10" pip-drag-data="obj" pip-scroll-container="pipScrollContainer" pip-drop="true" pip-force-touch="true" pip-drag-stop="onStop(selected.id)" pip-drag-start="onStart(selected.id)" pip-drop-success="onDropComplete($index, $data, $event, selected.id)" id="{{\'composite-item-\' + selected.id + \'-\' + $index}}"><div class="putt_box"></div><div class="pip-section-header" ng-if="!obj.empty" layout="row" layout-align="start center"><div class="w38"></div><md-button class="md-icon-button md-icon-button-little icon-rearrange-btn no-ripple-container rm8 cursor-move" ng-if="!ngDisabled() && compositeContent.length > 1" pip-drag-handle="" pip-mobile-mousedown="onDownDragg($event, obj)" pip-mobile-mouseup="onDraggEnd()" tabindex="-1" aria-label="COMPOSITE-DRAGG" ng-hide="compositeContent.length == 1"><md-icon class="composite-icon cursor-move" md-svg-icon="icons:handle"></md-icon></md-button><div><md-button class="md-icon-button md-icon-button-little rm8" ng-click="onDeleteItem($index)" ng-disabled="ngDisabled()" aria-label="COMPOSITE-DELETE"><md-icon class="composite-icon" md-svg-icon="icons:cross"></md-icon></md-button></div></div><div class="pip-section-content rp24-flex lp24-flex tp16 bp16" ng-if="obj.type == \'text\'" pip-cancel-drag="true"><md-input-container class="p0 m0 w-stretch" md-no-float=""><textarea ng-model="obj.text" aria-label="text" placeholder="{{ isFirst ? compositePlaceholder : \'TEXT\' | translate}}" id="{{\'composite-item-text-\' + selected.id + \'-\' + $index}}" ng-change="onContentChange(obj)" pip-cancel-drag="true" ng-disabled="ngDisabled()">\n                            </textarea></md-input-container></div><div class="pip-section-content rp24-flex lp24-flex vp20" ng-if="obj.type == \'pictures\'" pip-cancel-drag="true"><pip-picture-list-edit class="w-stretch" pip-cancel-drag="true" pip-picture-ids="obj.pic_ids" pip-changed="onContentChange(obj)" pip-created="obj.pictures = $event.sender" pip-added-picture="addedContent" ng-disabled="ngDisabled()"></pip-picture-list-edit></div><div class="pip-section-content rp24-flex lp24-flex vp20" ng-if="obj.type == \'documents\'" pip-cancel-drag="true"><pip-document-list-edit class="w-stretch" pip-documents="obj.docs" pip-cancel-drag="true" pip-changed="onContentChange(obj)" pip-created="obj.documents = $event.sender" pip-added-document="addedContent" ng-disabled="ngDisabled()"></pip-document-list-edit></div><div class="pip-section-content" ng-if="obj.type == \'checklist\'" pip-cancel-drag="true" layout="row" layout-align="start center"><pip-checklist-edit pip-options="obj.checklist" pip-draggable="isActiveChecklist(obj)" pip-changed="onContentChange(obj)" ng-disabled="ngDisabled()" pip-scroll-container="{{pipScrollContainer}}" pip-rebind="true"></pip-checklist-edit></div><div class="pip-section-content vp20 rp24-flex lp24-flex" ng-if="obj.type == \'location\'" pip-cancel-drag="true"><pip-location-edit class="pip-location-attachments w-stretch" pip-location-name="obj.loc_name" pip-location-pos="obj.loc_pos" pip-cancel-drag="true" pip-location-holder="pipLocationHolder" pip-changed="onContentChange(obj)" ng-disabled="ngDisabled()"></pip-location-edit></div><div class="pip-section-content bp16-flex rp24-flex lp24-flex tp20" ng-if="obj.type == \'time\'" pip-cancel-drag="true"><pip-time-edit class="w-stretch" pip-start-date="obj.start" pip-end-date="obj.end" pip-size="$sizeGtSmall" pip-changed="onContentChange(obj)" ng-disabled="ngDisabled()" pip-start-label="{{ \'COMPOSITE_START_TIME\' | translate }}" pip-end-label="{{ \'COMPOSITE_END_TIME\' | translate }}"></pip-time-edit></div></div><div class="pip-composite-item w-stretch" pip-drag="false" pip-drop="true" pip-drop-success="onDropComplete(compositeContent.length, $data, $event, selected.id)" pip-drag-stop="onStop(selected.id)" pip-drag-start="onStart(selected.id)" id="{{\'pip-composite-last-\' + selected.id}}"><div class="putt_box"></div><div class="pip-section-content h24" style="border: 0px!important;"></div></div></div></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("checklist_view/checklist_view.html",'<div ng-repeat="item in checklistContent track by $index"><div class="pip-checklist-item" layout="row" layout-align="start start"><div class="pip-checklist-icon"><md-checkbox ng-model="item.checked" ng-click="onClick($event, item)" aria-label="COMPLETE" ng-disabled="ngDisabled()"></md-checkbox></div><div class="pip-checklist-text" flex=""><pip-markdown pip-text="item.text" pip-rebind="true" ng-disabled="true"></pip-markdown></div></div></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("composite_summary/composite_summary.html",'<div ng-repeat="item in compositeContent track by $index"><div class="pip-composite-text" ng-if="item.type == \'text\' && item.text"><pip-markdown pip-text="item.text" pip-line-count="{{textSize}}" pip-rebind="true" ng-disabled="true"></pip-markdown></div><div ng-if="item.type == \'pictures\' && item.pic_ids.length > 0" ng-class="compositeContent[$index - 1].type != \'pictures\' ? compositeContent[$index + 1].type != \'pictures\' ? \'tm16 bm16\' : \'tm16 bm0\' : compositeContent[$index + 1].type != \'pictures\' ? \'tm8 bm16\' : \'tm8 bm0\'" class="pip-composite-pictures"><pip-collage ng-if="rebind" pip-picture-ids="item.pic_ids" pip-unique-code="item.id" pip-multiple="true" pip-open="disableControl" pip-rebind="true" ng-disabled="disableControl"></pip-collage></div><div ng-if="item.type == \'documents\' && item.docs.length > 0" class="pip-composite-documents" layout="row" flex=""><pip-document-list flex="" pip-documents="item.docs" pip-rebind="true" pip-document-icon="true" pip-collapse="true" ng-disabled="disableControl"></pip-document-list></div><div ng-if="item.type == \'checklist\' && item.checklist.length > 0" class="pip-composite-checklist"><pip-checklist-view pip-options="item.checklist" pip-changed="onContentChange()" pip-rebind="true" pip-collapse="true" ng-disabled="disabledChecklist"></pip-checklist-view></div><div class="pip-composite-location" layout="row" layout-align="start center" flex="" ng-if="item.type == \'location\' && (item.loc_pos || item.loc_name)"><pip-location pip-location-name="item.loc_name" pip-location-pos="item.loc_pos" pip-collapse="true" pip-show-location-icon="true" ng-disabled="disableControl" pip-rebind="true" flex=""></pip-location></div><div class="pip-composite-time" ng-if="item.type == \'time\' && (item.start || item.end)" layout="row" layout-align="start center" flex=""><md-icon md-svg-icon="icons:time" class="rm24 lm0"></md-icon><pip-time-view pip-start-date="item.start" pip-end-date="item.end" pip-rebind="true" ng-disabled="disableControl"></pip-time-view></div></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("composite_view/composite_view.html",'<div ng-repeat="item in compositeContent track by $index"><div class="pip-composite-text lp24-flex rp24-flex" ng-if="item.type == \'text\' && item.text" ng-class="{\'bm16\': $last}"><pip-markdown pip-text="item.text" pip-rebind="true" ng-disabled="true"></pip-markdown></div><div ng-if="item.type == \'pictures\' && item.pic_ids.length > 0" ng-class="compositeContent[$index - 1].type != \'pictures\' ? compositeContent[$index + 1].type != \'pictures\' ? \'tm16 bm16\' : \'tm16 bm0\' : compositeContent[$index + 1].type != \'pictures\' ? \'tm8 bm16\' : \'tm8 bm0\'" class="pip-composite-pictures lp24-flex rp24-flex"><pip-collage ng-if="rebind" pip-picture-ids="item.pic_ids" pip-unique-code="item.id" pip-multiple="true" pip-open="true" pip-rebind="true" ng-disabled="ngDisabled()"></pip-collage></div><div ng-if="item.type == \'documents\' && item.docs.length > 0" class="pip-composite-documents" layout="row" layout-align="start start" flex=""><pip-document-list pip-documents="item.docs" pip-document-icon="true" pip-rebind="true" ng-disabled="ngDisabled()"></pip-document-list></div><div ng-if="item.type == \'checklist\' && item.checklist.length > 0" class="pip-composite-checklist lp24-flex rp24-flex"><pip-checklist-view pip-options="item.checklist" pip-changed="onContentChange()" pip-rebind="true" ng-disabled="isDisabled()"></pip-checklist-view></div><div class="pip-composite-location" layout="row" layout-align="start start" flex="" ng-if="item.type == \'location\' && (item.loc_pos || item.loc_name)"><pip-location pip-location-name="item.loc_name" pip-location-pos="item.loc_pos" pip-show-location-icon="true" pip-collapse="false" ng-disabled="ngDisabled()" pip-rebind="true" flex=""></pip-location></div><div class="pip-composite-time lp24-flex rp24-flex" ng-if="item.type == \'time\'" layout="row" layout-align="start center" flex=""><md-icon md-svg-icon="icons:time" class="lm0"></md-icon><pip-time-view pip-start-date="item.start" pip-end-date="item.end" pip-rebind="true" ng-disabled="ngDisabled()"></pip-time-view></div></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("composite_toolbar/composite_toolbar.html",'<div layout="row" layout-align="start start" flex=""><md-button class="pip-composite-button" ng-if="!emptyState" ng-class="{ \'remove-item\': !emptyState , \'new-item\': !emptyState }" ng-click="onAddItem(\'text\');" aria-label="COMPOSITE-BUTTON-TEXT" ng-disabled="ngDisabled()"><md-icon class="icon-text-block" md-svg-icon="icons:text"></md-icon><md-tooltip>{{::\'TEXT\'| translate}}</md-tooltip></md-button><md-button ng-if="toolbarButton.checklist" ng-click="onAddItem(\'checklist\')" ng-disabled="ngDisabled()" class="pip-composite-button" aria-label="COMPOSITE-BUTTON-CHECKLIST"><md-icon class="icon-checkbox-on" md-svg-icon="icons:checkbox-on"></md-icon><md-tooltip>{{::\'CHECKLIST\'| translate}}</md-tooltip></md-button><md-button ng-if="toolbarButton.picture" ng-click="onAddItem(\'pictures\')" ng-disabled="ngDisabled()" class="pip-composite-button" aria-label="COMPOSITE-BUTTON-PICTURES"><md-icon class="icon-camera" md-svg-icon="icons:camera"></md-icon><md-tooltip>{{::\'PICTURE\'| translate}}</md-tooltip></md-button><md-button ng-click="onAddItem(\'documents\')" ng-if="toolbarButton.document" ng-disabled="ngDisabled()" class="pip-composite-button" aria-label="COMPOSITE-BUTTON-DOCUMENTS"><md-icon class="icon-document" md-svg-icon="icons:document"></md-icon><md-tooltip>{{::\'DOCUMENT\'| translate}}</md-tooltip></md-button><md-button ng-click="onAddItem(\'location\')" ng-if="toolbarButton.location" ng-disabled="ngDisabled()" class="pip-composite-button" aria-label="COMPOSITE-BUTTON-LOCATIONS"><md-icon class="icon-location" md-svg-icon="icons:location"></md-icon><md-tooltip>{{::\'LOCATION\'| translate}}</md-tooltip></md-button><md-button ng-click="onAddItem(\'time\')" ng-if="toolbarButton.event" ng-disabled="ngDisabled()" class="pip-composite-button" aria-label="COMPOSITE-BUTTON-TIME"><md-icon class="icon-time" md-svg-icon="icons:time"></md-icon><md-tooltip>{{::\'TIME\'| translate}}</md-tooltip></md-button></div>')}])}(),function(e){try{e=angular.module("pipComposite.Templates")}catch(t){e=angular.module("pipComposite.Templates",[])}e.run(["$templateCache",function(e){e.put("content_switch/content_switch.html",'<md-button ng-click="showPictures = !showPictures; onButtonClick(\'pictures\')" aria-label="showPictures" class="md-icon-button" ng-show="showIconPicture" ng-disabled="transaction.busy()"><md-icon class="active-camera" xng-class="{ \'active-camera\': showPictures }" md-svg-icon="icons:camera"></md-icon></md-button><md-button ng-click="showDocuments = !showDocuments; onButtonClick(\'documents\')" aria-label="showDocuments" class="md-icon-button" ng-show="showIconDocument" ng-disabled="transaction.busy()"><md-icon ng-class="{ \'active-document\': showDocuments }" md-svg-icon="icons:document"></md-icon></md-button><md-button ng-click="showEvent = !showEvent; onButtonClick(\'event\')" aria-label="showEvent" class="md-icon-button" ng-show="showIconEvent" ng-disabled="transaction.busy()"><md-icon ng-class="{ \'active-time\': showEvent }" md-svg-icon="icons:time"></md-icon></md-button><md-button ng-click="showLocation = !showLocation; onButtonClick(\'location\')" aria-label="showLocation" class="md-icon-button" ng-show="showIconLocation" ng-disabled="transaction.busy()"><md-icon ng-class="{ \'active-location\': showLocation }" md-svg-icon="icons:location"></md-icon></md-button>\'')}])}(),function(){"use strict";angular.module("pipComposite",["pipContentSwitch","pipChecklistEdit","pipChecklistView","pipCompositeEdit","pipCompositeView","pipCompositeSummary","pipCompositeToolbar","pipCompositeFocused","pipMobileMouseup","pipMobileMousedown"])}(),function(){"use strict";var e=angular.module("pipChecklistEdit",["pipCore","pipComposite.Templates"]);e.directive("pipChecklistEdit",function(){return{restrict:"EA",replace:!1,scope:{ngDisabled:"&",pipChanged:"=",pipDraggable:"=",pipOptions:"=",pipScrollContainer:"@"},templateUrl:"checklist_edit/checklist_edit.html",controller:"pipChecklistEditController"}}),e.controller("pipChecklistEditController",["$scope","$element","$attrs","$document","pipUtils","$rootScope",function(e,t,i,o,n,c){function p(e){if(e.selectionStart)return e.selectionStart;if(o.selection){e.focus();var t=o.selection.createRange();if(null==t)return 0;var i=e.createTextRange(),n=i.duplicate();return i.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",i),n.text.length}return 0}function s(){return e.ngDisabled?e.ngDisabled():!1}function l(t){s()||(e.selected.index=t)}function d(t){var i;try{i=e.checklistContent[t].empty}catch(o){i=!0}return e.selected.index==t&&e.pipDraggable&&!i}function a(e,t,i){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,i);else if(e.createTextRange){var o=e.createTextRange();o.collapse(!0),o.moveEnd("character",i),o.moveStart("character",t),o.select()}}function r(e,t){a(e,t,t)}function m(t,i,o){if(!s()&&-1!=e.selected.index){if(t&&t.target){var n=p(t.target);if(void 0!==t.target.value)var c=t.target.value.length}if(e.selected.index>0&&""!=o.text&&0==n&&8==t.keyCode&&!t.ctrlKey&&!t.shiftKey){if(!o.empty){var l=e.checklistContent[e.selected.index-1].text.length;e.checklistContent[e.selected.index-1].text=e.checklistContent[e.selected.index-1].text+o.text,e.selected.index-=1,e.checklistContent.splice(e.selected.index+1,1),e.onChecklistChange(),E(e.selected.index,l)}return t&&t.stopPropagation(),!1}if(!(""!=o.text||8!=t.keyCode&&46!=t.keyCode||t.ctrlKey||t.shiftKey))return o.empty||y(i,o),t&&t.stopPropagation(),!1;if(!(13!=t.keyCode&&45!=t.keyCode||t.ctrlKey||t.shiftKey)){if(void 0!==n&&0==n)return e.selected.index>0?$("",e.selected.index-1):(e.selected.index=-1,$("",-1)),t&&t.stopPropagation(),t&&t.preventDefault(),!1;if(c&&n&&c==n)return o.empty||$("",e.selected.index),t&&t.stopPropagation(),t&&t.preventDefault(),!1;if(c&&n&&c>n){if(!o.empty){var d,a;d=o.text.substring(0,n),a=o.text.substring(n),o.text=d,$(a,e.selected.index),E(e.selected.index,0)}return t&&t.stopPropagation(),t&&t.preventDefault(),!1}return t&&t.preventDefault(),!1}if((0===n||n==c)&&e.checklistContent.length>1&&38==t.keyCode&&!t.ctrlKey&&!t.shiftKey){if(t&&t.stopPropagation(),t&&t.preventDefault(),void 0!==n&&void 0!==c&&0==n)if(0==e.selected.index){e.selected.index=e.checklistContent.length-1;var l=e.checklistContent[e.selected.index].text.length;E(e.selected.index,l)}else{e.selected.index-=1;var l=e.checklistContent[e.selected.index].text.length;E(e.selected.index,l)}else E(e.selected.index,0);return!1}return 0!==n&&n!=c||!(e.checklistContent.length>1)||40!=t.keyCode||t.ctrlKey||t.shiftKey?o.empty||46!=t.keyCode||!t.ctrlKey||t.shiftKey?32==t.keyCode&&t.ctrlKey&&!t.shiftKey?(t&&t.stopPropagation(),t&&t.preventDefault(),o&&(o.checked=!o.checked,e.onChecklistChange()),!1):void 0:(t&&t.stopPropagation(),t&&t.preventDefault(),y(i,o),!1):(t&&t.stopPropagation(),t&&t.preventDefault(),void 0!==n&&void 0!==c&&n==c?e.selected.index>=e.checklistContent.length-1?(e.selected.index=0,E(e.selected.index,0)):(e.selected.index+=1,E(e.selected.index,0)):E(e.selected.index,c),!1)}}function u(){$("",e.selected.index-1)}function g(t){t>-1&&e.checklistContent[t]&&e.checklistContent[t].empty&&e.checklistContent[t].empty&&(e.checklistContent[t].empty=!1,e.checklistContent.push(S("",!0))),e.onChecklistChange()}function h(t,i){s()||(e.selected.index=i)}function C(t,i){s()||(e.selected.index=i)}function b(t,i,o,n){if(e.selected.id==n&&e.selected.drag){var c=t,p=e.selected.index,s=_.cloneDeep(e.checklistContent);if(0!=p||1!=t){if(p>c){c>s.length-1&&(c=s.length-1);for(var l=0;p-c>l;l++)s[p-l]=s[p-l-1];s[c]=i}if(c>p){c-=1;for(var l=0;c-p>l;l++)s[p+l]=s[p+l+1];s[c]=i}e.selected.index=c}e.checklistContent=s,e.onChecklistChange()}}function f(){M(),e.isWidth=!0}function v(t){setTimeout(function(){e.selected.drag=e.selected.dragInit,e.selected.dragId=0,e.$apply()},50),e.isWidth&&(P(),e.isWidth=!1)}function k(t){e.selected.isChanged=!0,t&&t!=e.selected.dragId&&(e.selected.drag=!1)}function x(t){e.pipDraggable&&e.checklistContent.length>2&&!t.empty&&(c.$broadcast("onChecklistDrag"),e.selected.dragId=e.selected.id)}function y(t,i){if(1==e.checklistContent.length)e.checklistContent[0].text="",e.checklistContent[0].checked=!1,e.checklistContent[0].empty=!0,e.selected.index=0;else{if(!(t>=0&&t<=e.checklistContent.length))return;e.checklistContent.splice(t,1)}e.selected.index>=e.checklistContent.length&&(e.selected.index=e.checklistContent.length-1),E(e.selected.index,0),e.onChecklistChange()}function T(t){e.onChecklistChange()}function w(){e.selected.isChanged=!0;var t,i=[];for(t=0;t<e.checklistContent.length;t++)e.checklistContent[t]&&!e.checklistContent[t].empty&&i.push({checked:e.checklistContent[t].checked,text:e.checklistContent[t].text});e.pipOptions=i}function D(){w(),e.pipChanged&&e.pipChanged()}function E(t,i){t>-1&&setTimeout(function(){var o=angular.element("#check-item-text-"+e.selected.id+"-"+t);o&&(o.focus(),void 0!==i&&o[0]&&r(o[0],i))},50)}function $(t,i){var o=S(t,!1);i>-1&&(e.selected.index=i),e.checklistContent.length<2?e.checklistContent.unshift(o):e.checklistContent.splice(e.selected.index+1,0,o),e.selected.index+=1,E(e.selected.index),e.onChecklistChange()}function S(e,t){return{checked:!1,text:e||"",empty:t}}function I(){return+new Date}function O(){e.selected.index=0,e.checklistContent=[],e.checklistContent.push(S("",!0))}function B(t){!t||t.length<1?O():(e.checklistContent=[],_.each(t,function(t){e.checklistContent.push(t)}),e.checklistContent.push(S("",!0)))}function P(){var t=angular.element("#check-item-"+ +e.selected.id+"-"+e.selected.index);t.css("width","none"),t.css("max-width","none")}function M(){if(!e.isWidth){var t=angular.element("#check-item-empty-"+e.selected.id),i=t.width(),o=angular.element("#check-item-"+e.selected.id+"-"+e.selected.index);o&&(o.css("width",i+"px"),o.css("max-width",i+"px"))}}e.selected={},e.selected.index=0,e.selected.drag=e.pipDraggable,e.selected.dragInit=e.pipDraggable,e.selected.dragId=0,e.selected.id=I(),e.selected.isChanged=!1,B(e.pipOptions),e.onTextareaKeyDown=m,e.onAddItem=u,e.onChangeItem=g,e.onClick=h,e.onTextAreaClick=C,e.onDropComplete=b,e.onDeleteItem=y,e.onChecked=T,e.updateContents=w,e.onItemFocus=l,e.onMove=f,e.onStart=k,e.onStop=v,e.isDisabled=s,e.onDownDragg=x,e.isSelectedItem=d,n.toBoolean(i.pipRebind)&&e.$watchCollection("pipOptions",function(t){e.selected.isChanged?e.selected.isChanged=!1:B(e.pipOptions)}),n.toBoolean(i.pipRebind)&&e.$watchCollection("pipDraggable",function(t){e.pipDraggable=t}),e.onChecklistChange=_.debounce(D,200),t.addClass("pip-checklist-edit")}])}(),function(){"use strict";var e=angular.module("pipChecklistView",["pipCore","pipComposite.Templates"]);e.directive("pipChecklistView",function(){return{restrict:"EA",replace:!1,scope:{ngDisabled:"&",pipChanged:"&",pipOptions:"="},templateUrl:"checklist_view/checklist_view.html",controller:"pipChecklistViewController"}}),e.controller("pipChecklistViewController",["$scope","$element","$attrs","pipUtils",function(e,t,i,o){function n(){e.selected.isChanged=!0,e.pipOptions=e.checklistContent}function c(){n(),e.pipChanged&&e.pipChanged()}function p(){e.checklistContent=[]}function s(t){return!t||t.length<1?void p():(e.checklistContent=[],void _.each(t,function(t){e.checklistContent.push(t)}))}function l(t,i){t&&t.stopPropagation(),e.ngDisabled&&e.ngDisabled()||c()}e.disableControl=0!=o.toBoolean(e.ngDisabled()),e.rebind=o.toBoolean(i.pipRebind),e.selected={},e.selected.isChanged=!1,s(e.pipOptions),t.addClass("pip-checklist-view"),o.toBoolean(i.pipRebind)&&e.$watchCollection("pipOptions",function(t){e.selected.isChanged?e.selected.isChanged=!1:s(e.pipOptions)}),e.updateContents=n,e.onClick=l}])}(),function(){"use strict";var e=angular.module("pipCompositeEdit",["pipCore","pipDocuments","pipLocations","pipPictures","pipComposite.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{COMPOSITE_TITLE:"What's on your mind?",COMPOSITE_PLACEHOLDER:"Type text ...",COMPOSITE_START_TIME:"Start time",COMPOSITE_END_TIME:"End time"}),e.translations("ru",{COMPOSITE_TITLE:"Что у вас на уме?",COMPOSITE_PLACEHOLDER:"Введите текст ...",COMPOSITE_START_TIME:"Время начала",COMPOSITE_END_TIME:"Время окончания"})}]),e.directive("pipCompositeEdit",function(){return{restrict:"EA",replace:!1,scope:{ngDisabled:"&",pipChanged:"&",pipContents:"=",compositeId:"=pipCompositeId",pipCompositePlaceholder:"=",pipScrollContainer:"@",pipAddedContent:"&"},templateUrl:"composite_edit/composite_edit.html",controller:"pipCompositeEditController"}}),e.controller("pipCompositeEditController",["$scope","$element","$attrs","$rootScope","pipUtils","pipTranslate","$document",function(e,t,i,o,n,c,p){function s(t){return t.id==e.selected.index}function l(){e.selected.isChanged=!0,e.pipContents=e.compositeContent}function d(t){if(t.length<1)return null;var i=t.parent();if(i[0]&&i[0].id&&i[0].id.indexOf("composite-item-"+e.selected.id)>-1){var o=i[0].id.split("-"),n=parseInt(o[o.length-1],10);return n}return d(i)}function a(t){9==t.keyCode&&setTimeout(function(){var t=angular.element(p[0].activeElement),i=d(t);null!=i&&(e.selected.index=i),e.$apply(e.selected.index=e.compositeContent[i].id)},50)}function r(t,i,o){return e.ngDisabled()?void 0:o&&!o.empty&&46==t.keyCode&&!t.ctrlKey&&t.shiftKey?(t&&t.stopPropagation(),t&&t.preventDefault(),i>-1&&u(i),!1):void 0}function m(){l(),e.pipChanged&&e.pipChanged()}function u(t){0>t||0==e.compositeContent.length||(1==e.compositeContent.length?(e.compositeContent[0]={empty:!0,id:D(),type:"text",text:"",docs:[],pic_ids:[],loc_pos:null,loc_name:"",start:null,end:null,checklist:[]},e.selected.index=e.compositeContent[0].id,y(0),e.isFirst=!0,I()):(t>=0&&t<e.compositeContent.length&&e.compositeContent.splice(t,1),t==e.compositeContent.length?e.selected.index=e.compositeContent[e.compositeContent.length-1].id:e.selected.index=e.compositeContent[t].id,y()),I(),e.onCompositeChange())}function g(t){t&&t.empty&&t.text&&(t.empty=!1,e.isFirst=!1,I()),e.ngDisabled()||e.onCompositeChange()}function h(t,i){return e.selected.index==i.id&&!i.empty}function C(){e.selected.drag=!0}function b(t){t&&t!=e.selected.dragId&&(e.selected.drag=!1)}function f(t){setTimeout(function(){e.selected.drag=!0,e.selected.dragId=0,e.$apply()},500)}function v(t,i){e.ngDisabled&&e.ngDisabled()||(e.selected.dragId=e.selected.id,e.selected.drag=!0,e.selected.index=i.id)}function k(t,i,o){return e.ngDisabled&&e.ngDisabled()?void 0:(e.selected.event="onClick",t&&t.target&&t.target.tagName&&("INPUT"==t.target.tagName||"TEXTAREA"==t.target.tagName)?void(e.selected.index=o.id):void(e.selected.index==o.id&&"checklist"==o.type&&o.checklist.length>0||e.selected.index==o.id&&"location"==o.type||(e.selected.index=o.id,y())))}function x(t,i,o,n){if(n!=e.selected.id||!i||!i.type)return void(e.compositeContent=_.cloneDeep(e.pipContents));var c=t,p=_.findIndex(e.compositeContent,{id:i.id});if(0!=p||1!=t){if(p>c){c>e.compositeContent.length-1&&(c=e.compositeContent.length-1);for(var s=0;p-c>s;s++)e.compositeContent[p-s]=e.compositeContent[p-s-1];e.compositeContent[c]=i}if(c>p){c-=1;for(var s=0;c-p>s;s++)e.compositeContent[p+s]=e.compositeContent[p+s+1];e.compositeContent[c]=i}e.selected.index=e.compositeContent[c].id}y(),e.onCompositeChange()}function y(t){if(t||(t=_.findIndex(e.compositeContent,{id:e.selected.index})),!(0>t)){var i=e.compositeContent[t];if(!_.isEmpty(i))switch(i.type){case"pictures":setTimeout(function(){var i=angular.element("#composite-item-"+e.selected.id+"-"+t+" button.pip-picture-upload");i&&!i.is(":focus")&&i.focus()},50);break;case"documents":setTimeout(function(){var i=angular.element("#composite-item-"+e.selected.id+"-"+t+" button.pip-document-upload");i&&!i.is(":focus")&&i.focus()},50);break;case"location":setTimeout(function(){var i=angular.element("#composite-item-"+e.selected.id+"-"+t+" .pip-location-empty  button");i&&!i.is(":focus")&&i.focus()},50);break;case"time":}}}function T(){e.compositePlaceholder=void 0===e.pipCompositePlaceholder||null===e.pipCompositePlaceholder?c.translate("COMPOSITE_PLACEHOLDER"):c.translate(e.pipCompositePlaceholder)}function w(t,i){if(!(_.indexOf(P,t)<0)){var o={id:D(),type:t,text:"text"==t?i:"",docs:"documents"==t&&i?i:[],pic_ids:"pictures"==t&&i?i:[],loc_pos:"location"==t&&i?i.loc_pos:null,loc_name:"location"==t&&i?i.loc_name:"",start:"time"==t&&i?i.start:null,end:"time"==t&&i?i.end:null,checklist:"checklist"==t&&i?i:[]},n=_.findIndex(e.compositeContent,{id:e.selected.index});n=0>n?0:n,1==e.compositeContent.length&&e.compositeContent[0].empty?e.compositeContent[0]=o:(e.compositeContent.splice(n+1,0,o),n+=1),e.selected.index=o.id,y(),setTimeout(E(e.pipScrollContainer,"#composite-item-"+e.selected.id+"-"+n),1e3),e.isFirst=!1,I(),e.onCompositeChange()}}function D(){var t=-1;return _.each(e.compositeContent,function(e){t<e.id&&(t=e.id)}),t+1}function E(e,t){e&&t&&setTimeout(function(){if($(t).position()){var i=Math.abs($(e).scrollTop()-$(t).position().top);if(!(20>i)){var o=$(e).scrollTop()+($(t).position().top-20);$(e).animate({scrollTop:o+"px"},300)}}},100)}function S(t){return!t||t.length<1?void O():(e.compositeContent=[],_.each(t,function(t){t.id=D(),e.compositeContent.push(t)}),e.isFirst=!1,void I())}function I(){e.compositeContent.length>2||o.$emit("pipCompositeNotEmpty",!e.isFirst)}function O(){e.compositeContent=[],e.compositeContent.push({empty:!0,id:D(),type:"text",text:"",docs:[],pic_ids:[],loc_pos:null,loc_name:"",start:null,end:null,checklist:[]}),e.isFirst=!0}function B(){return+new Date}var P=["time","text","pictures","documents","checklist","location"];e.selected={},e.selected.id=B(),e.selected.index=0,e.selected.drag=!0,e.selected.dragId=0,e.selected.isChanged=!1,e.toolbarButton={},e.rebind=n.toBoolean(i.pipRebind),e.disableControl=0!=n.toBoolean(e.ngDisabled()),e.addedContent=1==n.toBoolean(e.pipAddedContent()),S(e.pipContents),T(),o.$on("pipAddCompositeItem",function(t,i){e.compositeId?i.id&&i.id==e.compositeId&&w(i.type):w(i.type)}),n.toBoolean(i.pipRebind)&&(e.$watchCollection("pipContents",function(t,i){(!e.selected.isChanged||e.pipContents&&e.pipContents.length!=e.compositeContent.length)&&(S(e.pipContents),e.selected.isChanged=!1)}),e.$watch("pipCompositePlaceholder",function(e,t){e!==t&&T()})),t.addClass("pip-composite-edit"),e.onDeleteItem=u,e.onContentChange=g,e.isSelectedSection=h,e.onClick=k,e.onDownDragg=v,e.onDraggEnd=C,e.onDropComplete=x,e.onKeyUp=a,e.onKeyDown=r,e.onStart=b,e.onStop=f,e.isActiveChecklist=s,o.$on("onChecklistDrag",function(){e.selected.drag=!1,setTimeout(function(){e.selected.drag=!1,e.$apply()},0)}),o.$on("focusedComposite",function(){e.isFirst&&setTimeout(function(){
var t=angular.element("#composite-item-text-"+e.selected.id+"-0");t&&!t.is(":focus")&&t.focus()},50)}),e.onCompositeChange=_.debounce(m,200)}])}(),function(){"use strict";var e=angular.module("pipCompositeSummary",["pipCore","pipDocuments","pipLocations","pipPictures","pipComposite.Templates"]);e.directive("pipCompositeSummary",function(){return{restrict:"EA",scope:{pipContents:"=",pipChecklistSize:"=",pipTextSize:"=",pipPrimaryBlockLimit:"=",pipSecondaryBlockLimit:"=",pipSecondaryBlockTypes:"="},templateUrl:"composite_summary/composite_summary.html",controller:"pipCompositeSummaryController"}}),e.controller("pipCompositeSummaryController",["$scope","$element","$attrs","pipUtils",function(e,t,i,o){function n(e,t){t&&_.each(e,function(e){if(e&&"checklist"==e.type){var i=e.checklist.length;e.checklist=_.take(e.checklist,t),i>t&&e.checklist.push({text:"...",checked:!1})}})}function c(t){var i=[],o=0;return _.each(t,function(t){return e.primaryBlockLimit>=0&&o>=e.primaryBlockLimit?i:void(e.secondaryBlockTypes.indexOf(t.type)<0&&(i.push(t),o+=1))}),i}function p(t,i){var o,n=e.secondaryBlockLimit<0?t.length:e.secondaryBlockLimit,c=[];for(o=0;o<t.length&&!(i.indexOf(t[o].type)>-1&&(c.push(t[o]),c.length>=n));o++);return c}function s(t){if(!t||t.length<1)return void l();var i=_.cloneDeep(t),o=c(i);0==o.length&&(o=p(i,e.secondaryBlockTypes)),n(o,e.checklistSize);var s=0;_.each(o,function(e){e.id=s,s++}),e.compositeContent=o}function l(){e.compositeContent=[]}e.rebind=o.toBoolean(i.pipRebind),e.disableControl=!0,e.disabledChecklist=!0,e.secondaryBlockTypes=void 0!==e.pipSecondaryBlockTypes&&Array.isArray(e.pipSecondaryBlockTypes)?e.pipSecondaryBlockTypes:["checklist","documents","location","time"],e.textSize=void 0!==e.pipTextSize&&e.pipTextSize>0?e.pipTextSize:0,e.secondaryBlockLimit=void 0!==e.pipSecondaryBlockLimit&&e.pipSecondaryBlockLimit>0?e.pipSecondaryBlockLimit:-1,e.checklistSize=void 0!==e.pipChecklistSize&&e.pipChecklistSize>0?e.pipChecklistSize:0,e.primaryBlockLimit=void 0!==e.pipPrimaryBlockLimit?e.pipPrimaryBlockLimit:-1,s(e.pipContents),o.toBoolean(i.pipRebind)&&e.$watchCollection("pipContents",function(t){if(!Array.isArray(e.pipContents))throw new Error("Error: Attribute pip-contents must be array!");s(e.pipContents)}),t.addClass("pip-composite-summary")}])}(),function(){"use strict";var e=angular.module("pipCompositeToolbar",["pipCore","pipComposite.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{TEXT:"Text",CHECKLIST:"Checklist",LOCATION:"Location",PICTURE:"Picture",TIME:"Time",DOCUMENT:"Document"}),e.translations("ru",{TEXT:"Текст",CHECKLIST:"Список",LOCATION:"Локация",PICTURE:"Изображение",TIME:"Время",DOCUMENT:"Document"})}]),e.directive("pipCompositeToolbar",function(){return{restrict:"EA",replace:!1,scope:{ngDisabled:"&",pipCompositeEmpty:"&",pipToolbarButton:"=",compositeId:"=pipCompositeId"},templateUrl:"composite_toolbar/composite_toolbar.html",controller:"pipCompositeToolbarController"}}),e.controller("pipCompositeToolbarController",["$scope","$element","$attrs","$rootScope","pipUtils",function(e,t,i,o,n){function c(t){o.$emit("pipAddCompositeItem",{type:t,id:e.compositeId})}function p(){null!==e.pipToolbarButton&&void 0!==e.pipToolbarButton?(e.toolbarButton.picture=e.pipToolbarButton.picture===!1?e.pipToolbarButton.picture:!0,e.toolbarButton.document=e.pipToolbarButton.document===!1?e.pipToolbarButton.document:!0,e.toolbarButton.location=e.pipToolbarButton.location===!1?e.pipToolbarButton.location:!0,e.toolbarButton.event=e.pipToolbarButton.event===!1?e.pipToolbarButton.event:!0,e.toolbarButton.checklist=e.pipToolbarButton.checklist===!1?e.pipToolbarButton.checklist:!0):(e.toolbarButton.picture=!0,e.toolbarButton.document=!0,e.toolbarButton.location=!0,e.toolbarButton.event=!0,e.toolbarButton.checklist=!0),e.toolbarButton.text=!0}e.toolbarButton={},e.emptyState=0!=n.toBoolean(e.pipCompositeEmpty()),e.disableControl=0!=n.toBoolean(e.ngDisabled()),p(),e.onAddItem=c,o.$on("pipCompositeNotEmpty",function(t,i){e.emptyState=!i}),t.addClass("pip-composite-toolbar")}])}(),function(){"use strict";var e=angular.module("pipCompositeView",["pipCore","pipDocuments","pipLocations","pipPictures","pipComposite.Templates"]);e.directive("pipCompositeView",function(){return{restrict:"EA",scope:{ngDisabled:"&",pipDisabledChecklist:"&",pipChanged:"&",pipContents:"="},templateUrl:"composite_view/composite_view.html",controller:"pipCompositeViewController"}}),e.controller("pipCompositeViewController",["$scope","$element","$attrs","pipUtils",function(e,t,i,o){function n(){return 1==o.toBoolean(e.pipDisabledChecklist())||1==o.toBoolean(e.ngDisabled())}function c(){e.selected.isChanged=!0,e.pipContents=e.compositeContent}function p(){s()}function s(){c(),e.pipChanged&&e.pipChanged()}function l(t){if(!t||t.length<1)return void d();e.compositeContent=[];var i=0;_.each(t,function(t){if("object"!=typeof t||null==t)throw new Error("Error: content error!");t.id=i,i++,e.compositeContent.push(t)})}function d(){e.compositeContent=[]}e.rebind=o.toBoolean(i.pipRebind),e.disableControl=0!=o.toBoolean(e.ngDisabled()),e.disabledChecklist=0!=o.toBoolean(e.pipDisabledChecklist()),e.selected={},e.selected.isChanged=!1,l(e.pipContents),e.onContentChange=p,e.isDisabled=n,o.toBoolean(i.pipRebind)&&e.$watchCollection("pipContents",function(t){Array.isArray(e.pipContents)&&(e.selected.isChanged?e.selected.isChanged=!1:l(e.pipContents))}),t.addClass("pip-composite-view")}])}(),function(){"use strict";var e=angular.module("pipContentSwitch",["pipComposite.Templates"]);e.directive("pipContentSwitch",["$parse",function(e){return{restrict:"EA",scope:!1,templateUrl:"content_switch/content_switch.html",link:function(t,i,o){function n(e){setTimeout(function(){var t=Math.abs($(l).scrollTop()-$(e).position().top);if(!(20>t)){var i=$(l).scrollTop()+($(e).position().top-20);$(l).animate({scrollTop:i+"px"},300)}},100)}function c(){null!==t.contentSwitchOption&&void 0!==t.contentSwitchOption?(t.showIconPicture=t.contentSwitchOption.picture?t.contentSwitchOption.picture:t.showIconPicture,t.showIconDocument=t.contentSwitchOption.document?t.contentSwitchOption.document:t.showIconDocument,t.showIconLocation=t.contentSwitchOption.location?t.contentSwitchOption.location:t.showIconLocation,t.showIconEvent=t.contentSwitchOption.event?t.contentSwitchOption.event:t.showIconEvent):(t.showIconPicture=!0,t.showIconDocument=!0,t.showIconLocation=!0,t.showIconEvent=!0)}function p(e){if(l)switch(e){case"event":t.showEvent&&n(".event-edit");break;case"documents":t.showDocuments&&n(".pip-document-list-edit");break;case"pictures":t.showPictures&&n(".pip-picture-list-edit");break;case"location":t.showLocation&&n(".pip-location-edit")}}var s=e(o.pipParentElementName),l=s(t);t.onButtonClick=p,c(),i.addClass("pip-content-switch")}}}])}(),function(){"use strict";var e=angular.module("pipMobileMousedown",[]);e.directive("pipMobileMousedown",function(){return function(e,t,i){t.bind("touchstart mousedown",function(t){e.$apply(i.pipMobileMousedown)})}})}(),function(){"use strict";var e=angular.module("pipMobileMouseup",[]);e.directive("pipMobileMouseup",function(){return function(e,t,i){t.bind("touchend mouseup",function(t){e.$apply(i.pipMobileMouseup)})}})}(),function(){"use strict";var e=angular.module("pipCompositeFocused",[]);e.directive("pipCompositeFocused",function(){return{restrict:"A",scope:!1,controller:"pipCompositeFocusedController"}}),e.controller("pipCompositeFocusedController",["$scope","$element","$rootScope",function(e,t,i){t.bind("touchstart mousedown",function(e){i.$broadcast("focusedComposite")})}])}();
!function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("post_signup/post_signup.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><pip-post-signup-panel pip-data="data" pip-created="$panel = $control" pip-party="$party"></pip-post-signup-panel><div class="pip-footer"><md-button ng-hide="transaction.busy()" class="md-accent" ng-click="onPostSignupSubmit()" aria-label="CONTINUE">{{::\'CONTINUE\' | translate}}</md-button><md-button ng-show="transaction.busy()" class="md-warn" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></div></pip-card></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("post_signup/post_signup_dialog.html",'<md-dialog class="pip-entry lp0 rp0"><md-dialog-content><pip-post-signup-panel pip-data="data" pip-created="$panel = $control" pip-party="$party"></pip-post-signup-panel></md-dialog-content><md-dialog-actions layout="row" layout-align="end center"><md-button ng-hide="transaction.busy()" class="md-accent" ng-click="onPostSignupSubmit()" aria-label="CONTINUE">{{::\'CONTINUE\' | translate}}</md-button><md-button ng-show="transaction.busy()" class="md-warn" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></md-dialog-actions></md-dialog>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("post_signup/post_signup_panel.html",'<div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2 class="text-overflow">{{\'POST_SIGNUP_TITLE\' | translate}}</h2><p class="bm0 line-height-string">{{\'POST_SIGNUP_TEXT_1\' | translate}}</p><p class="line-height-string m0">{{\'POST_SIGNUP_TEXT_2\' | translate}}</p><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8" md-auto-hide="false"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_1002">{{::\'ERROR_1002\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><div class="pip-ref-item"><pip-avatar-edit ng-disabled="transaction.busy()" pip-reset="false" pip-party-id="data.id" pip-created="onPictureCreated($event)" pip-changed="onPictureChanged($control, $event)" class="rm16 flex-fixed"></pip-avatar-edit><div class="pip-content"><p class="pip-title">{{data.name}}</p><p class="pip-subtitle">{{data.email}}</p></div></div><md-input-container class="pip-no-hint bp4"><label>{{\'HINT_ABOUT\' | translate}}</label> <textarea ng-model="data.about" ng-initial="" ng-disabled="transaction.busy()" pip-clear-errors="">\n                        </textarea></md-input-container><div class="tm2"><p class="text-caption bm0">{{\'GENDER\' | translate}}</p><md-select class="w-stretch tm0 tp0 bp8" ng-disabled="transaction.busy()" ng-model="data.gender" label="{{\'GENDER\' | translate}}" ng-change="onStatusChange(data)" pip-clear-errors=""><md-option ng-value="opt.id" ng-repeat="opt in genders track by opt.id">{{ opt.name }}</md-option></md-select></div><div class="tm2"><p class="text-caption bm0">{{::\'BIRTHDAY\' | translate}}</p><pip-date ng-disabled="transaction.busy()" ng-model="data.birthday" pip-time-mode="past" pip-clear-errors="" time-mode="past"></pip-date></div><md-input-container><label>{{::\'LANGUAGE\' | translate}}</label><md-select class="w-stretch tm0 tp0 bp16" ng-disabled="transaction.busy()" ng-model="data.language" ng-change="onStatusChange(data)" pip-clear-errors=""><md-option ng-value="opt.id" ng-repeat="opt in languages track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container></form></div></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("recover_password/recover_password.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><pip-recover-password-panel pip-data="data" pip-created="$panel = $control"></pip-recover-password-panel><div class="pip-footer"><md-button ng-hide="transaction.busy()" ng-click="goBack()" class="rm8" aria-label="CANCEL">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" class="md-accent" ng-click="onRecover()" aria-label="RECOVER_PWD_RECOVER" ng-disabled="(form.$pristine && !data.email) || data.serverUrl.length == 0 || data.email.length == 0">{{::\'RECOVER_PWD_RECOVER\' | translate}}</md-button><md-button ng-show="transaction.busy()" class="md-warn" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></div></pip-card></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("recover_password/recover_password_dialog.html",'<md-dialog class="pip-entry lp0 rp0"><md-dialog-content><pip-recover-password-panel pip-data="data" pip-created="$panel = $control" pip-goto-reset="pipGotoReset"></pip-recover-password-panel></md-dialog-content><md-dialog-actions layout="row" layout-align="end center"><md-button ng-hide="transaction.busy()" ng-click="goBack()" class="rm8" aria-label="CANCEL">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" class="md-accent" ng-click="onRecover()" aria-label="RECOVER_PWD_RECOVER" ng-disabled="(form.$pristine && !data.email) || data.email== undefined || || data.serverUrl.length == 0 || data.email.length == 0">{{::\'RECOVER_PWD_RECOVER\' | translate}}</md-button><md-button ng-show="transaction.busy()" class="md-warn" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></md-dialog-actions></md-dialog>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("recover_password/recover_password_panel.html",'<div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2>{{\'RECOVER_PWD_TITLE\' | translate}}</h2><p class="text-primary tm0 bm16">{{\'RECOVER_PWD_TEXT_1\' | translate}}</p><p class="text-primary tm0 bm16">{{\'RECOVER_PWD_TEXT_2\' | translate}}</p><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8" md-auto-hide="false"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><a ng-hide="showServerUrl || fixedServerUrl" ng-click="showServerUrl = true" href="">{{\'ENTRY_CHANGE_SERVER\' | translate}}</a><div ng-show="showServerUrl"><md-autocomplete ng-initial="" autofocus="" tabindex="1" class="pip-combobox w-stretch bm8" name="server" ng-enabled="!transaction.busy()" placeholder="{{::\'ENTRY_SERVER_URL\' | translate}}" md-no-cache="true" md-selected-item="data.serverUrl" md-search-text="selected.searchURLs" md-items="item in getMatches()" md-item-text="item" md-selected-item-change="onServerUrlChanged()" md-delay="200" ng-model="data.serverUrl" pip-clear-errors=""><span md-highlight-text="selected.searchURLs">{{item}}</span></md-autocomplete></div><md-input-container class="pip-no-hint" style="padding-bottom: 4px!important;"><label>{{::\'EMAIL\' | translate}}</label> <input name="email" type="email" ng-model="data.email" pip-email-unique="data.email" required="" step="any" pip-clear-errors="" ng-disabled="transaction.busy()" tabindex="2"><div class="hint" ng-if="touchedErrorsWithHint(form, form.email).hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.email)" class="md-input-error" md-auto-hide="false"><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="emailUnique">{{::\'ERROR_1104\' | translate}}</div><div ng-message="ERROR_1100">{{::\'ERROR_1100\' | translate}}</div><div ng-message="ERROR_1106">{{::\'ERROR_1106\' | translate}}</div></div></md-input-container></form></div></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("reset_password/reset_password.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><pip-reset-password-panel pip-data="data" pip-created="$panel = $control"></pip-reset-password-panel><div class="pip-footer"><md-button ng-hide="transaction.busy()" ng-click="goBack()" class="rm8" aria-label="CANCEL">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" ng-click="onReset()" aria-label="ENTRY_SET_PASSWORD" ng-disabled="(form.$pristine && !data.email) || data.serverUrl.length == 0 || data.email.length == 0 || data.code.length == 0 || data.password.length < 6" class="md-accent" type="submit">{{::\'ENTRY_SET_PASSWORD\' | translate}}</md-button><md-button class="md-warn" ng-show="transaction.busy()" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></div></pip-card></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("reset_password/reset_password_dialog.html",'<md-dialog class="pip-entry lp0 rp0"><md-dialog-content><pip-reset-password-panel pip-data="data" pip-created="$panel = $control"></pip-reset-password-panel></md-dialog-content><md-dialog-actions layout="row" layout-align="end center"><md-button ng-hide="transaction.busy()" ng-click="goBack()" class="rm8" aria-label="CANCEL">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" ng-click="onReset()" aria-label="ENTRY_SET_PASSWORD" ng-disabled="(form.$pristine && !data.email) || data.serverUrl.length == 0 || data.email.length == 0 || data.code.length == 0 || data.password.length < 6" class="md-accent" type="submit">{{::\'ENTRY_SET_PASSWORD\' | translate}}</md-button><md-button class="md-warn" ng-show="transaction.busy()" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></md-dialog-actions></md-dialog>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("reset_password/reset_password_panel.html",'<div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy() && showServerError" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2>{{::\'RESET_PWD_PASSWORD\' | translate}}</h2><p class="title-padding bm16">{{::\'RESET_PWD_TEXT\' | translate}}</p><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8" md-auto-hide="false"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><a ng-hide="showServerUrl || fixedServerUrl" ng-click="showServerUrl = true" href="">{{::\'ENTRY_CHANGE_SERVER\' | translate}}</a><div ng-show="showServerUrl"><md-autocomplete ng-initial="" autofocus="" tabindex="1" class="pip-combobox w-stretch bm8" name="server" ng-enabled="!transaction.busy()" placeholder="{{::\'ENTRY_SERVER_URL\' | translate}}" md-no-cache="true" md-selected-item="data.serverUrl" md-search-text="selected.searchURLs" md-items="item in getMatches()" md-item-text="item" md-selected-item-change="onServerUrlChanged()" md-delay="200" ng-model="data.serverUrl" pip-clear-errors=""><span md-highlight-text="selected.searchURLs">{{item}}</span></md-autocomplete></div><md-input-container class="pip-no-hint" style="padding-bottom: 4px!important;"><label>{{::\'EMAIL\' | translate}}</label> <input name="email" type="email" ng-model="data.email" required="" step="any" pip-clear-errors="" ng-disabled="transaction.busy()" tabindex="2" pip-email-unique="data.email"><div class="hint" ng-if="touchedErrorsWithHint(form, form.email).hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.email)" class="md-input-error" md-auto-hide="false"><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="emailUnique">{{::\'ERROR_1104\' | translate}}</div><div ng-message="ERROR_1100">{{::\'ERROR_1100\' | translate}}</div><div ng-message="ERROR_1106">{{::\'ERROR_1106\' | translate}}</div></div></md-input-container><md-input-container class="pip-no-hint"><label>{{::\'ENTRY_RESET_CODE\' | translate}}</label> <input name="code" ng-disabled="transaction.busy()" ng-model="data.code" required="" tabindex="3" pip-clear-errors=""><div class="hint" ng-if="touchedErrorsWithHint(form, form.code).hint">{{::\'ENTRY_RESET_CODE\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.code)" class="md-input-error" md-auto-hide="false"><div ng-message="required">{{::\'ERROR_CODE_INVALID\' | translate }}</div><div ng-message="ERROR_1108">{{::\'ERROR_1108\' | translate}}</div><div ng-message="ERROR_1109">{{::\'ERROR_1109\' | translate}}</div></div></md-input-container><md-input-container class="pip-no-hint" style="padding-bottom: 4px!important;"><label>{{::\'PASSWORD\' | translate}}</label> <input name="password" ng-disabled="transaction.busy()" pip-clear-errors="" type="password" tabindex="4" ng-model="data.password" required="" minlength="6"><div class="hint" ng-if="touchedErrorsWithHint(form, form.password).hint">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.password)" class="md-input-error" md-auto-hide="false"><div ng-message="required">{{::\'MINLENGTH_PASSWORD\' | translate}}</div><div ng-message="minlength">{{::\'MINLENGTH_PASSWORD\' | translate}}</div><div ng-message="ERROR_1102">{{::\'ERROR_1102\' | translate}}</div><div ng-message="ERROR_1103">{{::\'ERROR_1103\' | translate}}</div><div ng-message="ERROR_1105">{{::\'ERROR_1105\' | translate}}</div></div></md-input-container></form></div></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signin/signin.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><pip-signin-panel pipfixedserverurl="fixedServerUrl"></pip-signin-panel></pip-card></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signin/signin_dialog.html",'<md-dialog class="pip-entry"><md-dialog-content><pip-signin-panel pip-goto-signup-dialog="pipGotoSignupDialog" pip-goto-recover-password-dialog="pipGotoRecoverPasswordDialog"></pip-signin-panel></md-dialog-content></md-dialog>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signin/signin_panel.html",'<div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2 pip-translate="SIGNIN_TITLE"></h2><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8 color-error" md-auto-hide="false"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><a ng-hide="showServerUrl || fixedServerUrl" ng-click="showServerUrl = true" href="" id="link-server-url" pip-test="link-server-url">{{::\'ENTRY_CHANGE_SERVER\' | translate}}</a><div ng-show="showServerUrl"><md-autocomplete ng-initial="" autofocus="" tabindex="1" class="pip-combobox w-stretch bm8" name="server" placeholder="{{::\'ENTRY_SERVER_URL\' | translate}}" md-no-cache="true" md-selected-item="data.serverUrl" md-search-text="selected.searchURLs" md-items="item in getMatches()" md-item-text="item" md-selected-item-change="onServerUrlChanged()" md-delay="200" ng-model="data.serverUrl" ng-disabled="transaction.busy()" pip-clear-errors="" pip-test="autocomplete-server"><span md-highlight-text="selected.searchURLs">{{item}}</span></md-autocomplete></div><md-input-container class="display bp4"><label>{{::\'EMAIL\' | translate}}</label> <input name="email" type="email" ng-model="data.email" required="" step="any" ng-keypress="onEnter($event)" pip-clear-errors="" ng-disabled="transaction.busy()" tabindex="2" pip-test="input-email"><div class="hint" ng-if="touchedErrorsWithHint(form, form.email).hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.email)" md-auto-hide="false"><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="ERROR_1100">{{::\'ERROR_1100\' | translate}}</div><div ng-message="ERROR_1106">{{::\'ERROR_1106\' | translate}}</div><div ng-message="ERROR_1114">{{::\'ERROR_1114\' | translate}}</div></div></md-input-container><md-input-container class="display bp4"><label>{{::\'PASSWORD\' | translate}}</label> <input name="password" ng-disabled="transaction.busy()" pip-clear-errors="" type="password" tabindex="3" ng-model="data.password" ng-keypress="onEnter($event)" required="" minlength="6" pip-test="input-password"><div class="hint" ng-if="touchedErrorsWithHint(form, form.password).hint">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.password)" md-auto-hide="false"><div ng-message="required">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-message="minlength">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-message="ERROR_1102">{{::\'ERROR_1102\' | translate}}</div><div ng-message="ERROR_1107">{{::\'ERROR_1107\' | translate}}</div></div></md-input-container><a href="" class="display bm16" ng-click="gotoRecoverPassword()" tabindex="4">{{::\'SIGNIN_FORGOT_PASSWORD\' | translate}}</a><md-checkbox ng-disabled="transaction.busy()" md-no-ink="" class="lm0" aria-label="{{\'SIGNIN_REMEMBER\' | translate}}" tabindex="5" ng-model="data.remember" pip-test-checkbox="remember"><label class="label-check">{{::\'SIGNIN_REMEMBER\' | translate}}</label></md-checkbox><div style="height: 36px; overflow: hidden;"><md-button ng-if="!transaction.busy()" ng-click="onSignin()" aria-label="SIGNIN" class="md-raised md-accent w-stretch m0" tabindex="6" ng-disabled="(data.email == undefined) || data.email.length == 0 || data.serverUrl == \'\' || data.serverUrl == undefined || data.serverUrl.length == 0 || (data.password == undefined)" pip-test="button-signin">{{::\'SIGNIN_TITLE\' | translate}}</md-button><md-button ng-if="transaction.busy()" ng-click="transaction.abort()" class="md-raised md-warn m0 w-stretch" tabindex="5" aria-label="ABORT" pip-test="button-cancel">{{::\'CANCEL\' | translate}}</md-button></div><div layout="row" class="tm24" ng-if="!adminOnly && $mdMedia(\'gt-xs\')"><p class="m0 text-small">{{::\'SIGNIN_NOT_MEMBER\' | translate}} <a href="" ng-click="gotoSignup()" tabindex="6">{{::\'SIGNIN_SIGNUP_HERE\' | translate}}</a></p></div><div class="tm24 divider-top" style="margin-right: -16px; margin-left: -16px; background-color: rgb(238, 238, 238);" ng-if="!adminOnly && $mdMedia(\'xs\')"><div class="h48" layout="row" layout-align="center end"><p class="m0 text-small">{{::\'SIGNIN_NOT_MEMBER\' | translate}}</p></div><div class="h48" layout="row" layout-align="center start"><a class="text-small" ng-click="gotoSignup()" href="" tabindex="6">{{::\'SIGNIN_SIGNUP_HERE\' | translate}}</a></div></div></form></div></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signup/signup.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><pip-signup-panel></pip-signup-panel></pip-card></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signup/signup_dialog.html",'<md-dialog class="pip-entry"><md-dialog-content><pip-signup-panel pip-goto-signin-dialog="pipGotoSigninDialog" pip-post-signup="pipPostSignup"></pip-signup-panel></md-dialog-content></md-dialog>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("signup/signup_panel.html",'<div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2 pip-translate="SIGNUP_TITLE"></h2><form name="form" novalidate="" autocomplete="off"><input type="email" style="display:none"> <input type="password" style="display:none"><div ng-messages="form.$serverError" class="text-error bm8" md-auto-hide="false"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><a ng-hide="showServerUrl || fixedServerUrl" ng-click="showServerUrl = true" href="">{{::\'ENTRY_CHANGE_SERVER\' | translate}}</a><div ng-show="showServerUrl"><md-autocomplete ng-initial="" autofocus="" tabindex="1" class="pip-combobox w-stretch bm8" name="server" ng-enabled="!transaction.busy()" placeholder="{{::\'ENTRY_SERVER_URL\' | translate}}" md-no-cache="true" md-selected-item="data.serverUrl" md-search-text="selected.searchURLs" md-items="item in getMatches()" md-item-text="item" md-selected-item-change="onServerUrlChanged()" md-delay="200" ng-model="data.serverUrl" ng-disabled="transaction.busy()" pip-clear-errors=""><span md-highlight-text="selected.searchURLs">{{item}}</span></md-autocomplete></div><md-input-container class="display bp4"><label>{{::\'FULLNAME\' | translate}}</label> <input name="signupFullName" ng-disabled="transaction.busy()" autocomplete="off" ng-model="data.name" ng-init="data.name = \'\'" required="" tabindex="2" pip-clear-errors="" ng-keypress="onEnter($event)"><div class="hint text-overflow w-stretch" ng-if="touchedErrorsWithHint(form, form.signupFullName).hint">{{::\'HINT_FULLNAME\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.signupFullName)" md-auto-hide="false"><div ng-message="required">{{::\'HINT_FULLNAME\' | translate}} {{::\'ERROR_FULLNAME_INVALID\' | translate }}</div><div ng-message="ERROR_1101">{{::\'ERROR_1101\' | translate}}</div></div></md-input-container><md-input-container class="display bp4"><label>{{::\'EMAIL\' | translate}}</label> <input name="userEmail" ng-disabled="transaction.busy()" pip-clear-errors="" type="email" tabindex="3" ng-model="data.email" xxng-pattern="/^[_a-z0-9]+(\\.[_a-z0-9]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,4})$/" required="" pip-email-unique="data.email" ng-keypress="onEnter($event)" pip-test="input-password"><div class="hint" ng-if="touchedErrorsWithHint(form, form.userEmail).hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.userEmail)" md-auto-hide="false"><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="emailUnique">{{::\'ERROR_1104\' | translate}}</div><div ng-message="ERROR_1100">{{::\'ERROR_1100\' | translate}}</div><div ng-message="ERROR_1106">{{::\'ERROR_1106\' | translate}}</div><div ng-message="ERROR_1104">{{::\'ERROR_1104\' | translate}}</div><div ng-message="ERROR_1300">{{::\'ERROR_1300\' | translate}}</div><div ng-message="ERROR_1305">{{::\'ERROR_1305\' | translate}}</div><div ng-message="ERROR_1301">{{::\'ERROR_1301\' | translate}}</div><div ng-message="ERROR_1114">{{::\'ERROR_1114\' | translate}}</div></div></md-input-container><md-input-container class="display bp4"><label>{{::\'PASSWORD_SET\' | translate}}</label> <input name="password" ng-disabled="transaction.busy()" pip-clear-errors="" type="password" tabindex="4" ng-model="data.password" required="" minlength="6" ng-keypress="onEnter($event)" pip-test="input-password"><div class="hint" ng-if="touchedErrorsWithHint(form, form.password).hint">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.password)" md-auto-hide="false"><div ng-message="required">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-message="minlength">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-message="ERROR_1102" ng-if="!form.password.$pristine">{{::\'ERROR_1102\' | translate}}</div><div ng-message="ERROR_1107" ng-if="!form.password.$pristine">{{::\'ERROR_1107\' | translate}}</div></div></md-input-container><md-input-container class="display bp4"><label>{{::\'PASSWORD_CONFIRM\' | translate}}</label> <input name="passwordConfirm" type="password" tabindex="4" required="" minlength="6" ng-model="confirmPassword" ng-disabled="transaction.busy()" pip-clear-errors="" compare-to="data.password" ng-keypress="onEnter($event)" pip-test="input-password"><div class="hint" ng-if="touchedErrorsWithHint(form, form.passwordConfirm).hint">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-messages="touchedErrorsWithHint(form, form.passwordConfirm)" md-auto-hide="false"><div ng-message="compareTo">{{::\'PASSWORD_MATCH\' | translate}}</div><div ng-message="required">{{::\'HINT_PASSWORD\' | translate}}</div><div ng-message="minlength">{{::\'HINT_PASSWORD\' | translate}}</div></div></md-input-container><p class="text-small-secondary">{{::\'SIGNUP_TEXT_11\' | translate}} <a href="#/legal/privacy">{{::\'SIGNUP_PRIVACY\' | translate}}</a> {{::\'SIGNUP_TEXT_12\' | translate}} <a href="#/legal/services">{{::\'SIGNUP_SERVICES\' | translate}}</a></p><md-button ng-hide="transaction.busy()" class="md-raised m0 md-accent w-stretch" ng-click="onSignup()" aria-label="SIGNUP" ng-disabled="form.$invalid || (form.$pristine && !data.email) || data.serverUrl.length == 0 || data.email.length == 0 || (!data.password) || (!data.name) || data.name.length == 0 || data.password.length == 0">{{::\'SIGNUP_TITLE\' | translate}}</md-button><md-button ng-show="transaction.busy()" ng-click="transaction.abort()" class="md-raised md-warn m0 w-stretch" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button><div layout="row" class="tm24" ng-if="$mdMedia(\'gt-xs\')"><p class="text-small m0">{{::\'SIGNUP_TEXT_2\' | translate}} <a href="" ng-click="gotoSignin()">{{::\'SIGNUP_SIGNIN_HERE\' | translate}}</a></p></div><div class="tm24 divider-top" ng-if="$mdMedia(\'xs\')" style="margin-right: -16px; margin-left: -16px; background-color: rgb(238, 238, 238);"><div class="h48" layout="row" layout-align="center end"><p class="bm0 text-small">{{::\'SIGNUP_TEXT_2\' | translate}}</p></div><div class="h48" layout="row" layout-align="center start"><p class="bm0 text-small"><a href="" ng-click="gotoSignin()">{{::\'SIGNUP_SIGNIN_HERE\' | translate}}</a></p></div></div></form></div></div>')}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("verify_email/verify_email.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2>{{\'VERIFY_EMAIL_TITLE\' | translate}}</h2><p class="title-padding">{{\'VERIFY_EMAIL_TEXT_1\' | translate}}</p><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8"><div ng-message="ERROR_1000">{{::\'ERROR_1000\' | translate}}</div><div ng-message="ERROR_1110">{{::\'ERROR_1110\' | translate}}</div><div ng-message="ERROR_1111">{{::\'ERROR_1111\' | translate}}</div><div ng-message="ERROR_1112">{{::\'ERROR_1112\' | translate}}</div><div ng-message="ERROR_-1">{{::\'ERROR_SERVER\' | translate}}</div><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><a ng-hide="showServerUrl || fixedServerUrl" ng-click="showServerUrl = true" href="">{{\'ENTRY_CHANGE_SERVER\' | translate}}</a><div ng-show="showServerUrl"><md-autocomplete ng-initial="" autofocus="" tabindex="1" class="pip-combobox w-stretch bm8" name="server" ng-enabled="!transaction.busy()" placeholder="{{::\'ENTRY_SERVER_URL\' | translate}}" md-no-cache="true" md-selected-item="data.serverUrl" md-search-text="selected.searchURLs" md-items="item in getMatches()" md-item-text="item" md-selected-item-change="onServerUrlChanged()" md-delay="200" ng-model="data.serverUrl" pip-clear-errors=""><span md-highlight-text="selected.searchURLs">{{item}}</span></md-autocomplete></div><md-input-container class="pip-no-hint" style="padding-bottom: 4px!important;"><label>{{::\'EMAIL\' | translate}}</label> <input name="email" type="email" ng-model="data.email" required="" step="any" pip-clear-errors="" ng-disabled="transaction.busy()" tabindex="2"><div ng-messages="touchedErrorsWithHint(form, form.email)" ng-if="!form.email.$pristine" class="md-input-error"><div ng-message="hint" class="pip-input-hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="ERROR_1100">{{::\'ERROR_1100\' | translate}}</div><div ng-message="ERROR_1104">{{::\'ERROR_1104\' | translate}}</div><div ng-message="ERROR_1305">{{::\'ERROR_1305\' | translate}}</div><div ng-message="ERROR_1106">{{::\'ERROR_1106\' | translate}}</div></div></md-input-container><md-input-container class="pip-no-hint"><label>{{::\'ENTRY_RESET_CODE\' | translate}}</label> <input name="code" ng-disabled="transaction.busy()" ng-model="data.code" required="" tabindex="3"><div ng-messages="touchedErrorsWithHint(form, form.code)" ng-if="!form.fullName.$pristine" class="md-input-error"><div ng-message="hint" class="pip-input-hint">{{::\'ENTRY_RESET_CODE\' | translate}}</div><div ng-message="required">{{::\'ERROR_CODE_INVALID\' | translate }}</div><div ng-message="ERROR_1108">{{::\'ERROR_1108\' | translate}}</div></div></md-input-container><p>{{\'VERIFY_EMAIL_TEXT_21\' | translate}} <a ng-click="onRecover()" class="pointer" href="">{{\'VERIFY_EMAIL_RESEND\' | translate}}</a> {{\'VERIFY_EMAIL_TEXT_22\' | translate}}</p></form></div></div><div class="pip-footer"><md-button ng-click="goBack()" ng-hide="transaction.busy()" class="rm8" aria-label="CANCEL">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-click="onVerify()" ng-hide="transaction.busy()" aria-label="VERIFY" ng-disabled="data.code.length == 0 || data.email.length == 0 || (!data.email && form.$pristine) || (!data.code)">{{::\'VERIFY\' | translate}}</md-button><md-button class="md-warn" ng-show="transaction.busy()" ng-click="transaction.abort()" aria-label="ABORT">{{::\'CANCEL\' | translate}}</md-button></div></pip-card></div>');
}])}(),function(e){try{e=angular.module("pipEntry.Templates")}catch(t){e=angular.module("pipEntry.Templates",[])}e.run(["$templateCache",function(e){e.put("verify_email/verify_email_success.html",'<div class="pip-card-container pip-outer-scroll pip-entry"><pip-card width="400"><div class="pip-footer"><md-button ng-click="onContinue()" class="md-accent">{{\'CONTINUE\' | translate}}</md-button></div><div class="pip-body"><div class="pip-content"><h2>{{\'VERIFY_EMAIL_TITLE\' | translate}}</h2><p class="title-padding">{{\'VERIFY_EMAIL_SUCCESS_TEXT\' | translate}}</p></div></div></pip-card></div>')}])}(),function(){"use strict";var e=angular.module("pipEntry",["ui.router","ngMessages","pipCore","pipRest","pipBasicControls","pipLocations","pipPictures","pipRest.State","pipEntry.Strings","pipEntry.Common","pipEntry.Signin","pipEntry.Signup","pipEntry.PostSignup","pipEntry.RecoverPassword","pipEntry.ResetPassword","pipEntry.VerifyEmail","pipEntry.Templates"]);e.config(["$stateProvider","$locationProvider","$httpProvider","pipAuthStateProvider",function(e,t,a,r){e.state("signin",{url:"/signin?email&server_url&redirect_to",auth:!1,controller:"pipSigninController",templateUrl:"signin/signin.html"}).state("recover_password",{url:"/recover_password?server_url&email",auth:!1,controller:"pipRecoverPasswordController",templateUrl:"recover_password/recover_password.html"}).state("reset_password",{url:"/reset_password?server_url&email&code",auth:!1,controller:"pipResetPasswordController",templateUrl:"reset_password/reset_password.html"}).state("signout",{url:"/signout",auth:!1}).state("signup",{url:"/signup?name&email&server_url",auth:!1,controller:"pipSignupController",templateUrl:"signup/signup.html"}).state("post_signup",{url:"/post_signup?party_id",auth:!1,controller:"pipPostSignupController",templateUrl:"post_signup/post_signup.html",resolve:{$party:["$rootScope","$stateParams","pipRest","pipSession",function(e,t,a,r){var n=r.userId(),i=t.party_id||n;if(i!=n)throw"ERROR_NOT_ALLOWED";return a.parties().get({id:i}).$promise}]}}).state("verify_email",{url:"/verify_email?server_url&email&code",auth:!1,controller:"pipVerifyEmailController",templateUrl:"verify_email/verify_email.html"}).state("verify_email_success",{url:"/verify_email_success",auth:!1,controller:"pipVerifyEmailSuccessController",templateUrl:"verify_email/verify_email_success.html"}),r.signinState("signin"),r.signoutState("signout")}])}(),function(){"use strict";var e=angular.module("pipEmailUnique",["ngResource","pipRest"]);e.directive("pipEmailUnique",["$http","pipRest",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,a,r,n){var i=r.pipEmailUnique;e.$watch(r.ngModel,_.throttle(function(e){var a=n.$validators.emailUnique;return e&&0!=e.length&&i!=e?(e||n.$setValidity("emailUnique",!0),void t.signupValidate().call({email:e},function(e){n.$setValidity("emailUnique",!0)},function(e){n.$setValidity("emailUnique",!1)})):void n.$setValidity("emailUnique",a)},500))}}}])}(),function(){"use strict";var e=angular.module("pipEntry.Common",[]);e.provider("pipEntry",function(){var e=!1,t=null;this.adminOnly=function(t){e=t},this.fixedServerUrl=function(e){t=e},this.$get=function(){return{adminOnly:function(){return e},fixedServerUrl:function(){return t}}}}),e.factory("pipEntryCommon",["$rootScope","$state","$window","pipAppBar","pipSession","pipRest","pipEntry","pipFormErrors",function(e,t,a,r,n,i,s,o){function l(){r.hideNavIcon(),r.appLogo?r.showTitleLogo(r.appLogo):r.showTitleLogo("images/piplife_logo.svg"),r.showLanguage(),r.showShadow(),r.hideSearch()}function p(e){function a(t){var a=e.selected.searchURLs&&t&&t.toLowerCase().indexOf(e.selected.searchURLs.toLowerCase())>=0;return a}function r(){return e.selected.searchURLs?(e.data.serverUrl=e.selected.searchURLs,_.filter(e.serverUrls,e.filterItem)):e.showServerUrl}function l(){if(i.serverUrl(e.data.serverUrl),e.selected.searchURLs){var a=e.servers[e.data.serverUrl];a&&"signup"!=t.name&&(e.data.email=a.email,e.data.password=a.password),o.resetFormErrors(e.form,!1),o.resetFieldsErrors(e.form)}}if(e.adminOnly=s.adminOnly(),e.data={serverUrl:i.serverUrl(),email:"signup"!=t.name&&t.params.email?t.params.email:null,password:"",remember:!1,adminOnly:e.adminOnly,name:t.params.name||null,code:t.params.code||null},e.showServerUrl=!1,e.fixedServerUrl=!1,e.data.serverUrl=e.data.serverUrl||n.usedServerUrls(),s.fixedServerUrl()&&(e.data.serverUrl=s.fixedServerUrl(),e.fixedServerUrl=!0),"signup"!=t.name&&(e.data.email=e.data.email||n.lastUsedEmail(e.data.serverUrl)),e.serverUrls=n.usedServerUrls(),e.servers=n.usedServers(),e.selected={},e.selected.searchURLs=e.data.serverUrl,e.data.serverUrl&&!e.data.email&&"signup"!=t.name){var p=e.servers[e.data.serverUrl];e.data.email=(p||{}).email}e.filterItem=a,e.getMatches=r,e.onServerUrlChanged=l,e.isEmpty=_.isEmpty}return{configureAppBar:l,initScope:p}}])}(),function(){"use strict";var e=angular.module("pipEntry.Strings",[]);e.config(["pipTranslateProvider",function(e){e.translations("en",{FULLNAME:"First and last name",EMAIL:"Email",PASSWORD:"Password",LANGUAGE:"Language",GENDER:"Gender",BIRTHDAY:"Birthday",LOCATION:"Location",HINT_FULLNAME:"Use your real name, so others know who you are",HINT_PASSWORD:"Minimum 6 characters",HINT_ABOUT:"Few words about yourself",VERIFY_EMAIL:"Please, verify your email address. ",HINT_EMAIL:"Please, type your email address.",SIGNIN_TITLE:"Sign in",SIGNIN_NOT_MEMBER:"Not a member?",SIGNIN_REMEMBER:"Remember",SIGNIN_FORGOT_PASSWORD:"Forgot password?",SIGNIN_SIGNUP_HERE:" Sign up here",SIGNUP_TITLE:"Sign up",SIGNUP_NOT_MEMBER:"Not a member? Sign up now",SIGNUP_TEXT_11:"By clicking Sign up, you agree to the",SIGNUP_PRIVACY:"privacy statement",SIGNUP_TEXT_12:"and",SIGNUP_SERVICES:"services agreement",SIGNUP_TEXT_2:"Do you have an account?",SIGNUP_SIGNIN_HERE:" Sign in here",SIGNUP_EMAIL_REGISTERED:"This email is already registered",SIGNUP_FULLNAME_WRONG:"xxxx",SIGNUP_EMAIL_WRONG:"xxxx",POST_SIGNUP_TITLE:"Welcome to Pip.Life",POST_SIGNUP_TEXT_1:"Your account was successfully created.",POST_SIGNUP_TEXT_2:"Tell us some more about yourself.",RECOVER_PWD_TITLE:"Forgot password?",RECOVER_PWD_TEXT_1:"Enter the email address you used when you joined and we'll send you instructions to reset your password.",RECOVER_PWD_TEXT_2:"For security reasons, we do NOT store your password. So rest assured that we will never send your password via email.",RECOVER_PWD_RECOVER:"Recover password",RESET_PWD_PASSWORD:"Reset password",RESET_PWD_TEXT:"Enter the email address together with the reset code you received in email from PipLife. Remember the code is only active for 24 hours.",RESET_PWD_SUCCESS_TEXT:"Your password was successfully changed",VERIFY_EMAIL_TITLE:"Email verification",VERIFY_EMAIL_TEXT_1:"Confirm your email address using verification code",VERIFY_EMAIL_TEXT_21:"If you haven't received the code, press ",VERIFY_EMAIL_RESEND:"resend",VERIFY_EMAIL_TEXT_22:"to send it again.",VERIFY_EMAIL_SUCCESS_TEXT:"Your email address was successfully verified. Thank you!",PASSWORD_MATCH:"Passwords don't match",PASSWORD_CONFIRM:"Confirm the password",PASSWORD_SET:"Set a password",ENTRY_CHANGE_SERVER:"Change server",ENTRY_SERVER_URL:"Server URL",ENTRY_RESET_CODE:"Reset code",ENTRY_VERIFICATION_CODE:"Verification code",ENTRY_NEW_PASSWORD:"New password",ENTRY_SET_PASSWORD:"Set Password",ENTRY_FREE:"Free",ENTRY_REPEAT:"Repeat",ERROR_EMAIL_INVALID:"Enter a valid email",ERROR_PASSWORD_INVALID:"Enter a valid password",ERROR_FULLNAME_INVALID:"Enter full name",ERROR_CODE_INVALID:"Enter a code from mail",ERROR_ACCOUNT_NOT_FOUND:"User name or password are incorrect",ERROR_WRONG_PASSWORD:"User name or password are incorrect",ERROR_CODE_WRONG:"Wrong recovery code",ERROR_SERVER:"Server is not responding",ERROR_SERVER_INVALID:"Enter server URL",LANGUAGE_RUSSIAN:"Russian",LANGUAGE_ENGLISH:"English"}),e.translations("ru",{FULLNAME:"Имя и фамилия",EMAIL:"Адрес эл.почты",PASSWORD:"Пароль",LANGUAGE:"Язык",GENDER:"Пол",BIRTHDAY:"Дата рождения",LOCATION:"Местонахождение",HINT_FULLNAME:"Используйте своё настоящее имя, чтобы другие знали с кем имеют дело",HINT_PASSWORD:"Минимум 6 символов",HINT_ABOUT:"Несколько слов о себе",VERIFY_EMAIL:"Подтвердите адрес своей эл.почты",HINT_EMAIL:"Введите адрес своей эл.почты",SIGNIN_TITLE:"Вход в систему",SIGNIN_NOT_MEMBER:"Еще не зарегистрировались?",SIGNIN_REMEMBER:"Запомнить",SIGNIN_FORGOT_PASSWORD:"Забыли пароль?",SIGNIN_SIGNUP_HERE:" Зарегистрироваться здесь",SIGNUP_TITLE:"Регистрация",SIGNUP_NOT_MEMBER:"Новенький? Зарегистрируйтесь сейчас",SIGNUP_TEXT_11:"Нажимая кнопку регистрация, я соглашаюсь с",SIGNUP_SERVICES:"договором об услугах",SIGNUP_TEXT_12:"и",SIGNUP_PRIVACY:"соглашением о личных данных",SIGNUP_TEXT_2:"Уже зарегистрировались?",SIGNUP_SIGNIN_HERE:" Вход здесь",SIGNUP_EMAIL_REGISTERED:"Данный адрес эл.почты уже занят",POST_SIGNUP_TITLE:"Добро пожаловать в Pip.Life",POST_SIGNUP_TEXT_1:"Ваша учетная запись создана.",POST_SIGNUP_TEXT_2:"Несклько слов о о себе",RECOVER_PWD_TITLE:"Забыли пароль?",RECOVER_PWD_TEXT_1:"Введите адрес эл.почты, который вы использовали при регистрации и мы вышлем вам инструкции как изменить пароль.",RECOVER_PWD_TEXT_2:"По соображениям безопасности мы НЕ храним пароли. Таким образом, мы никогда не пошлем ваш пароль по электронной почте.",RECOVER_PWD_RECOVER:"Восстановить пароль",RESET_PWD_PASSWORD:"Изменить пароль",RESET_PWD_TEXT:"Введите адрес эл.почты вместе с кодом, который вы получили в почтовом сообщении от PipLife. Помните, что код действителен только 24 часа.",RESET_PWD_SUCCESS_TEXT:"Ваш пароль успешно изменён",VERIFY_EMAIL_TITLE:"Подтверждение адреса эл.почты",VERIFY_EMAIL_TEXT_1:"Введите код, который вы получили по эл.почте",VERIFY_EMAIL_TEXT_21:"Если вы не получили почтовое сообщение с кодом, нажмите ",VERIFY_EMAIL_RESEND:"отправить снова",VERIFY_EMAIL_TEXT_22:".",VERIFY_EMAIL_SUCCESS_TEXT:"Адрес вашей электронной почты успешно подтвержден. Спасибо!",PASSWORD_MATCH:"Пароли не совпадают",PASSWORD_CONFIRM:"Подтвердите пароль",PASSWORD_SET:"Задайте пароль",ENTRY_CHANGE_SERVER:"Изменить сервер",ENTRY_SERVER_URL:"URL сервера",ENTRY_RESET_CODE:"Код подтверждения",ENTRY_VERIFICATION_CODE:"Код проверки",ENTRY_NEW_PASSWORD:"Новый пароль",ENTRY_SET_PASSWORD:"Изменить пароль",ENTRY_FREE:"бесплатно",ENTRY_REPEAT:"Повторить",ERROR_EMAIL_INVALID:"Введите адрес электронной почты",ERROR_PASSWORD_INVALID:"Введите пароль",ERROR_FULLNAME_INVALID:"Введите полное имя",ERROR_CODE_INVALID:"Введите код",ERROR_ACCOUNT_NOT_FOUND:"Введено неверное имя пользователя или пароль",ERROR_WRONG_PASSWORD:"Введено неверное имя пользователя или пароль",ERROR_CODE_WRONG:"Неправильный код",ERROR_SERVER:"Сервер не отвечает. Проверьте URL сервера.",ERROR_SERVER_INVALID:"Введите URL сервера",LANGUAGE_RUSSIAN:"Русский",LANGUAGE_ENGLISH:"Английский"})}])}(),function(){"use strict";var e=angular.module("pipPasswordMatch",[]);e.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,a,r){r.$validators.compareTo=function(t){return t==e.otherModelValue},e.$watch("otherModelValue",function(){r.$validate()})}}})}(),function(){"use strict";var e=angular.module("pipEntry.PostSignup",["pipEntry.Common","pipPostSignupPanel"]);e.controller("pipPostSignupController",["$scope","$rootScope","pipAuthState","$party",function(e,t,a,r){function n(){e.$panel&&e.$panel.onPostSignupSubmit()}e.$party=r,e.onPostSignupSubmit=n,e.$panel&&(e.transaction=e.$panel.transacton)}])}(),function(){"use strict";var e=angular.module("pipEntry.PostSignupDialog",["pipEntry.Common","pipPostSignupPanel"]);e.factory("pipPostSignupDialog",["$mdDialog",function(e){return{show:function(t,a,r){e.show({targetEvent:t.event,templateUrl:"post_signup/post_signup_dialog.html",controller:"pipPostSignupDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){a&&a()},function(){r&&r()})}}}]),e.controller("pipPostSignupDialogController",["$scope","$rootScope","$location","pipSession","params",function(e,t,a,r,n){function i(){e.$panel&&e.$panel.onPostSignupSubmit()}e.$party=n.$party,e.onPostSignupSubmit=i,e.$panel&&(e.transaction=e.$panel.transacton)}])}(),function(){"use strict";var e=angular.module("pipPostSignupPanel",["pipUtils","pipFocused","pipEntry.Strings"]);e.directive("pipPostSignupPanel",function(){return{restrict:"EA",replace:!0,scope:{data:"=pipData",created:"&pipCreated",$party:"=pipParty"},templateUrl:"post_signup/post_signup_panel.html",controller:"pipPostSignupPanelController"}}),e.controller("pipPostSignupPanelController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipFormErrors","pipEntryCommon","$state","$mdMedia","pipTranslate","pipEnums","pipRest","pipUtils",function(e,t,a,r,n,i,s,o,l,p,d,c,m,g){function u(t){e.picture&&e.picture.save(function(){},function(e){console.error(e)})}function R(t){e.picture=t.sender}function E(){if(e.form.$invalid)return void s.resetFormErrors(e.form,!0);var t=e.transaction.begin("PROCESSING");t&&m.parties().update(e.data,function(a){return s.resetFormErrors(e.form,!1),e.transaction.aborted(t)?void 0:(e.transaction.end(),g.checkSupported()?void n.goToAuthorized({party_id:a.id}):(i.signout(),void l.go("errors_unsupported")))},function(t){e.error=t,e.transaction.end(e.error),s.resetFormErrors(e.form,!0),s.setFormError(e.form,t,{1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"})})}e.$mdMedia=p,o.initScope(e),e.showServerError=!0,e.genders=d.translateSet(c.GENDERS),e.languages=d.translateSet(c.LANGUAGES),e.data={id:e.$party.id,name:e.$party.name,email:e.$party.email,about:e.$party.about,language:d.use(),birthday:e.$party.birthday,gender:e.$party.gender||c.GENDER.NOT_SPECIFIED,location:e.$party.location},e.transaction=r("entry.post_signup",e),e.$control={},e.$control.onPostSignupSubmit=E,e.$control.transaction=e.transaction,e.created&&e.created({$control:e.$control}),e.onPictureChanged=u,e.onPictureCreated=R,e.onPostSignupSubmit=E}])}(),function(){"use strict";var e=angular.module("pipEntry.RecoverPassword",["pipEntry.Common","pipRecoverPasswordPanel"]);e.controller("pipRecoverPasswordController",["$scope","$rootScope","pipUtils","pipAuthState","pipTransaction","pipRest","pipFormErrors","pipEntryCommon","$window",function(e,t,a,r,n,i,s,o,l){function p(){l.history.back()}function d(){e.$panel&&e.$panel.onRecover()}o.configureAppBar(),e.goBack=p,e.onRecover=d,e.transaction=n("entry.recover_password",e)}])}(),function(){"use strict";var e=angular.module("pipEntry.RecoverPasswordDialog",["pipEntry.Common","pipRecoverPasswordPanel","pipEntry.ResetPasswordDialog"]);e.factory("pipRecoverPasswordDialog",["$mdDialog",function(e){return{show:function(t,a,r){e.show({targetEvent:t.event,templateUrl:"recover_password/recover_password_dialog.html",controller:"pipRecoverPasswordDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){a&&a()},function(){r&&r()})}}}]),e.controller("pipRecoverPasswordDialogController",["$scope","$rootScope","$location","pipSession","params","$mdDialog","pipResetPasswordDialog",function(e,t,a,r,n,i,s){function o(){e.$panel&&e.$panel.onRecover()}function l(){s.show({})}e.onRecover=o,e.$panel&&(e.transaction=e.$panel.transacton),e.goBack=i.cancel,e.pipGotoReset=l}])}(),function(){"use strict";var e=angular.module("pipRecoverPasswordPanel",["pipUtils","pipFocused","pipEntry.Strings"]);e.directive("pipRecoverPasswordPanel",function(){return{restrict:"EA",replace:!0,scope:{data:"=pipData",created:"&pipCreated",gotoReset:"=pipGotoReset"},templateUrl:"recover_password/recover_password_panel.html",controller:"pipRecoverPasswordPanelController"}}),e.controller("pipRecoverPasswordPanelController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipFormErrors","pipEntryCommon","$state","$mdMedia","pipTranslate","pipEnums","pipRest","pipUtils",function(e,t,a,r,n,i,s,o,l,p,d,c,m,g){function u(){if(e.form.$invalid)return void s.resetFormErrors(e.form,!0);var t=e.transaction.begin("PROCESSING");t&&m.recoverPassword(e.data.serverUrl).call({email:e.data.email},function(a){s.resetFormErrors(e.form,!1),e.transaction.aborted(t)||(e.transaction.end(),e.gotoReset?e.gotoReset():n.go("reset_password",{server_url:e.data.serverUrl,email:e.data.email}))},function(t){e.error=t,e.transaction.end(e.error),s.setFormError(e.form,e.error,{1100:"email",1106:"email",1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"}),s.resetFormErrors(e.form,!0)})}e.$mdMedia=p,o.initScope(e),e.showServerError=!0,e.touchedErrorsWithHint=s.touchedErrorsWithHint,e.onRecover=u,e.transaction=r("entry.recover_password",e),e.$control={},e.$control.onRecover=u,e.created&&e.created({$control:e.$control})}])}(),function(){"use strict";var e=angular.module("pipEntry.ResetPassword",["pipEntry.Common","pipResetPasswordPanel","pipEmailUnique"]);e.controller("pipResetPasswordController",["$scope","$rootScope","pipUtils","pipAuthState","pipTransaction","pipRest","pipToasts","pipTranslate","pipFormErrors","pipEntryCommon","$window",function(e,t,a,r,n,i,s,o,l,p,d){function c(){d.history.back()}function m(){e.$panel&&e.$panel.onReset()}p.configureAppBar(),e.goBack=c,e.onReset=m,e.transaction=n("entry.reset_password",e)}])}(),function(){"use strict";var e=angular.module("pipEntry.ResetPasswordDialog",["pipEntry.Common","pipResetPasswordPanel"]);e.factory("pipResetPasswordDialog",["$mdDialog",function(e){return{show:function(t,a,r){e.show({targetEvent:t.event,templateUrl:"entry/dialogs/reset_password.html",controller:"pipResetPasswordDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){a&&a()},function(){r&&r()})}}}]),e.controller("pipResetPasswordDialogController",["$scope","$rootScope","$location","pipSession","params","$mdDialog",function(e,t,a,r,n,i){function s(){e.$panel&&e.$panel.onReset()}e.onReset=s,e.$panel&&(e.transaction=e.$panel.transacton),e.goBack=i.cancel}])}(),function(){"use strict";var e=angular.module("pipResetPasswordPanel",["pipUtils","pipFocused","pipEntry.Strings"]);e.directive("pipResetPasswordPanel",function(){return{restrict:"EA",replace:!0,scope:{data:"=pipData",created:"&pipCreated"},templateUrl:"reset_password/reset_password_panel.html",controller:"pipResetPasswordPanelController"}}),e.controller("pipResetPasswordPanelController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipToasts","pipFormErrors","pipEntryCommon","$state","$mdMedia","pipTranslate","pipEnums","pipRest","pipUtils",function(e,t,a,r,n,i,s,o,l,p,d,c,m,g,u){function R(e,t){return e?(e=c.translate(e),t=t||"message","message"==t?void s.showMessage(e):"error"==t?void s.showError(e):void 0):void 0}function E(){if(e.form.$invalid)return void o.resetFormErrors(e.form,!0);var t=e.transaction.begin("PROCESSING");t&&g.resetPassword(e.data.serverUrl).call({email:e.data.email,code:e.data.code,password:e.data.password},function(a){if(o.resetFormErrors(e.form,!1),!e.transaction.aborted(t)){var r=String()+"RESET_PWD_SUCCESS_TEXT";R(r,"message"),e.transaction.end(),n.go("signin",{server_url:e.data.serverUrl,email:e.data.email})}},function(t){e.error=t,e.transaction.end(e.error),o.resetFormErrors(e.form,!0),o.setFormError(e.form,t,{1100:"email",1106:"email",1102:"password",1103:"password",1105:"password",1108:"code",1109:"code",1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"})})}e.$mdMedia=d,l.initScope(e),e.showServerError=!0,e.touchedErrorsWithHint=o.touchedErrorsWithHint,e.onReset=E,e.transaction=r("entry.recover_password",e),e.$control={},e.$control.onReset=E,e.created&&e.created({$control:e.$control})}])}(),function(){"use strict";var e=angular.module("pipEntry.Signin",["pipEntry.Common","pipSigninPanel"]);e.controller("pipSigninController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipFormErrors","pipEntryCommon",function(e,t,a,r,n,i,s,o){o.configureAppBar(),t.isSignin||i.signout(),t.isSignin=!1}])}(),function(){"use strict";var e=angular.module("pipEntry.SigninDialog",["pipEntry.Common","pipSigninPanel","pipEntry.SignupDialog","pipEntry.RecoverPasswordDialog"]);e.factory("pipSigninDialog",["$mdDialog",function(e){return{show:function(t,a,r){e.show({targetEvent:t.event,templateUrl:"signin/signin_dialog.html",controller:"pipSigninDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){a&&a()},function(){r&&r()})}}}]),e.controller("pipSigninDialogController",["$scope","$rootScope","$location","pipSession","pipSignupDialog","pipRecoverPasswordDialog",function(e,t,a,r,n,i){function s(){n.show({})}function o(){i.show({})}r.signout(),e.pipGotoSignupDialog=s,e.pipGotoRecoverPasswordDialog=o}])}(),function(){"use strict";var e=angular.module("pipSigninPanel",["pipUtils","pipFocused","pipEntry.Strings"]);e.directive("pipSigninPanel",function(){return{restrict:"EA",replace:!0,scope:{gotoSignupPage:"=pipGotoSignupPage",gotoSignupDialog:"=pipGotoSignupDialog",gotoRecoverPasswordDialog:"=pipGotoRecoverPasswordDialog"},templateUrl:"signin/signin_panel.html",controller:"pipSigninPanelController"}}),e.controller("pipSigninPanelController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipFormErrors","pipEntryCommon","$state","$mdMedia","pipTheme","pipUtils",function(e,t,a,r,n,i,s,o,l,p,d,c){function m(){return e.gotoSignupPage||e.gotoSignupDialog?e.gotoSignupPage?void l.go(e.gotoSignupPage):e.gotoSignupDialog?void e.gotoSignupDialog():void 0:void l.go("signup",{server_url:e.data.serverUrl,email:e.data.email})}function g(){return e.gotoRecoverPasswordDialog?e.gotoRecoverPasswordDialog?void e.gotoRecoverPasswordDialog():void 0:void l.go("recover_password",{server_url:e.data.serverUrl,email:e.data.email})}function u(){if(e.form.$invalid)return void s.resetFormErrors(e.form,!0);var r=e.transaction.begin("ENTERING");r&&(t.isSignin=!0,i.signin(e.data,function(t){return s.resetFormErrors(e.form,!1),e.transaction.aborted(r)?void 0:(e.transaction.end(),c.checkSupported()?void(n.params.redirect_to?a.url(n.params.redirect_to):n.goToAuthorized()):(i.signout(),void l.go("errors_unsupported")))},function(a){t.isSignin=!1,s.resetFormErrors(e.form,!0),s.setFormError(e.form,a,{1100:"email",1106:"email",1114:"email",1102:"password",1107:"password",1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"}),e.transaction.end({message:a})}))}function R(e){13===e.keyCode&&u()}e.$mdMedia=p,e.showServerError=!0,e.transaction=r("entry.signin",e),e.touchedErrorsWithHint=s.touchedErrorsWithHint,e.onSignin=u,e.gotoSignup=m,e.gotoRecoverPassword=g,e.onEnter=R,o.initScope(e)}])}(),function(){"use strict";var e=angular.module("pipEntry.Signup",["pipEntry.Common","pipEmailUnique","pipSignupPanel","pipPasswordMatch"]);e.controller("pipSignupController",["$scope","$rootScope","pipAuthState","pipTransaction","pipRest","pipSession","pipFormErrors","pipEntryCommon",function(e,t,a,r,n,i,s,o){o.configureAppBar()}])}(),function(){"use strict";var e=angular.module("pipEntry.SignupDialog",["pipEntry.Common","pipSignupPanel","pipEntry.SigninDialog","pipEntry.PostSignupDialog"]);e.factory("pipSignupDialog",["$mdDialog",function(e){return{show:function(t,a,r){e.show({targetEvent:t.event,templateUrl:"signup/signup_dialog.html",controller:"pipSignupDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){a&&a()},function(){r&&r()})}}}]),e.controller("pipSignupDialogController",["$scope","$rootScope","$location","pipSession","pipSigninDialog","pipPostSignupDialog",function(e,t,a,r,n,i){function s(){n.show({})}function o(e){i.show({$party:e})}r.signout(),e.pipGotoSigninDialog=s,e.pipPostSignup=o}])}(),function(){"use strict";var e=angular.module("pipSignupPanel",["pipUtils","pipFocused","pipEntry.Strings"]);e.directive("pipSignupPanel",function(){return{restrict:"EA",replace:!0,scope:{gotoPostSignup:"=pipPostSignup",gotoSigninPage:"=pipGotoSigninPage",gotoSigninDialog:"=pipGotoSigninDialog"},templateUrl:"signup/signup_panel.html",controller:"pipSignupPanelController"}}),e.controller("pipSignupPanelController",["$scope","$rootScope","$location","pipTransaction","pipAuthState","pipSession","pipFormErrors","pipEntryCommon","pipRest","$mdMedia","$state",function(e,t,a,r,n,i,s,o,l,p,d){function c(){return e.gotoSigninPage||e.gotoSigninDialog?e.gotoSigninPage?void d.go(e.gotoSigninPage):e.gotoSigninDialog?void e.gotoSigninDialog():void 0:void d.go("signin",{})}function m(t){var a=e.selected.searchURLs&&t&&t.toLowerCase().indexOf(e.selected.searchURLs.toLowerCase())>=0;return a}function g(){return e.selected.searchURLs?(e.data.serverUrl=e.selected.searchURLs,_.filter(e.serverUrls,e.filterItem)):e.showServerUrl}function u(){if(e.form.$invalid)return void s.resetFormErrors(e.form,!0);var a=e.transaction.begin("PROCESSING");a&&l.signup(e.data.serverUrl).call({name:e.data.name,email:e.data.email,password:e.data.password,language:t.$language||"en",theme:t.theme||"blue"},function(t){s.resetFormErrors(e.form,!1),e.transaction.aborted(a)||(e.transaction.end(),i.open(e.data.serverUrl,t,e.data.password,!1),e.gotoPostSignup?e.gotoPostSignup(t):n.go("post_signup",{party_id:t.id}))},function(t){e.error=t,s.resetFormErrors(e.form,!0),s.setFormError(e.form,t,{1101:"signupFullName",1100:"userEmail",1106:"userEmail",1104:"userEmail",1305:"userEmail",1114:"userEmail",1301:"userEmail",1300:"userEmail",1102:"password",1103:"password",1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"}),e.transaction.end(t)})}function R(e){13===e.keyCode&&u()}e.$mdMedia=p,o.initScope(e),e.confirmPassword="",e.isEmpty=_.isEmpty,e.onEnter=R,e.showServerError=!0,e.transaction=r("entry.signup",e),e.filterItem=m,e.getMatches=g,e.touchedErrorsWithHint=s.touchedErrorsWithHint,e.onServerUrlChanged=function(){},e.onSignup=u,e.gotoSignin=c}])}(),function(){"use strict";var e=angular.module("pipEntry.VerifyEmail",["pipEntry.Common"]);e.controller("pipVerifyEmailController",["$scope","$rootScope","pipAuthState","pipTransaction","pipRest","pipFormErrors","pipEntryCommon",function(e,t,a,r,n,i,s){function o(){if(e.form.$invalid)return void i.resetFormErrors(e.form,!0);var t=e.transaction.begin("PROCESSING");t&&n.verifyEmail(e.data.serverUrl).call({email:e.data.email,code:e.data.code},function(r){i.resetFormErrors(e.form,!1),e.transaction.aborted(t)||(e.transaction.end(),a.go("verify_email_success",{}))},function(t){e.error=t,e.transaction.end(e.error),i.resetFormErrors(e.form,!0),i.setFormError(e.form,e.error,{1100:"email",1106:"email",1104:"email",1305:"email",1108:"code",1e3:"form",1110:"form",1111:"form",1112:"form","-1":"form"})})}function l(){if(t.$user&&t.$user.id){var r=e.transaction.begin("PROCESSING");r&&n.requestEmailVerification(e.data.serverUrl).get({party_id:t.$user.id,email:e.data.email},function(t){e.transaction.aborted(r)||(e.transaction.end(),a.go("reset_password",{server_url:e.data.serverUrl,email:e.data.email}))},function(t){e.transaction.end(t)})}}s.configureAppBar(),s.initScope(e),e.showServerError=!0,e.transaction=r("entry.verify_email",e),e.touchedErrorsWithHint=i.touchedErrorsWithHint,e.onVerify=o,e.onRecover=l}]),e.controller("pipVerifyEmailSuccessController",["$scope","pipAuthState","pipEntryCommon",function(e,t,a){function r(){t.goToAuthorized({})}a.configureAppBar(),e.onContinue=r}])}();
!function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("no_connection/no_connection.html",'<div class="pip-error pip-empty layout-column flex layout-align-center-center"><div style="background-image: url(\'../../dist/images/no_response.svg\');" class="pip-pic"></div><div class="pip-error-text">{{::\'ERROR_RESPONDING_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_RESPONDING_SUBTITLE\' | translate}}</div><div class="pip-error-actions h48" layout="column" layout-align="center center"><md-button aria-label="RETRY" class="md-accent" ng-click="onRetry($event)">{{::\'ERROR_RESPONDING_RETRY\' | translate}}</md-button></div></div>')}])}(),function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("no_connection/pip_no_connection_panel.html",'<div class="pip-empty pip-error" layout="column" layout-align="center center" flex=""><img src="images/no_response.svg" class="pip-pic block"><div class="pip-error-text">{{::\'ERROR_RESPONDING_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_RESPONDING_SUBTITLE\' | translate}}</div><div class="pip-error-actions h48" layout="column" layout-align="center center"><md-button aria-label="RETRY" class="md-accent" ng-click="onRetry($event)">{{::\'ERROR_RESPONDING_RETRY\' | translate}}</md-button></div></div>')}])}(),function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("maintenance/maintenance.html",'<div class="pip-error pip-empty layout-column flex layout-align-center-center"><div style="background-image: url(\'../../dist/images/maintenance.svg\');" class="pip-pic"></div><div class="pip-error-text">{{::\'ERROR_AVAILABLE_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_AVAILABLE_SUBTITLE\' | translate}}</div><div class="pip-error-subtext" ng-if="timeoutInterval">{{::\'ERROR_AVAILABLE_TRY_AGAIN\' | translate}} {{timeoutInterval}} sec.</div><div class="pip-error-actions h48" ng-if="isCordova" layout="column" layout-align="center center"><md-button class="md-accent" ng-click="onClose($event)" aria-label="CLOSE">{{::\'ERROR_AVAILABLE_CLOSE\' | translate}}</md-button></div></div>')}])}(),function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("missing_route/missing_route.html",'<div class="pip-error pip-empty layout-column flex layout-align-center-center"><div style="background-image: url(\'../../dist/images/invalid_route.svg\');" class="pip-pic"></div><div class="pip-error-text">{{::\'ERROR_ROUTE_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_ROUTE_SUBTITLE\' | translate}}</div><div class="pip-error-actions h48" layout="column" layout-align="center center"><md-button aria-label="CONTINUE" class="md-accent" ng-click="onContinue($event)">{{::\'ERROR_ROUTE_CONTINUE\' | translate}}</md-button></div><div class="h48" ng-if="url"><a ng-href="{{url}}">{{::\'ERROR_ROUTE_TRY_AGAIN\' | translate }}: {{url}}</a></div><div class="h48" ng-if="urlBack"><a ng-href="{{urlBack}}">{{::\'ERROR_ROUTE_GO_BACK\' | translate }}: {{urlBack}}</a></div></div>')}])}(),function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("unknown/unknown.html",'<div class="pip-error pip-empty layout-column flex layout-align-center-center"><div style="background-image: url(\'../../dist/images/unknown_error.svg\');" class="pip-pic"></div><div class="pip-error-text">{{::\'ERROR_UNKNOWN_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_UNKNOWN_SUBTITLE\' | translate}}</div><div class="pip-error-subtext" ng-if="error_details && error_details.status"><div>Code: {{error_details.code}}</div><div>Description: {{error_details.description}}</div><div>HTTP status: {{error_details.status}}</div><div>Server stacktrace: {{error_details.server_stacktrace}}</div><div>Client stacktrace stacktrace: {{error_details.client_stacktrace}}</div></div><div class="pip-error-actions" layout="column" layout-align="center center"><div class="h48" ng-if="isCordova"><md-button aria-label="CLOSE" class="md-accent" ng-click="onClose($event)">{{::\'ERROR_UNKNOWN_CLOSE\' | translate}}</md-button></div><div class="h48"><md-button aria-label="DETAILS" class="md-accent" ng-click="onDetails($event)">{{::\'ERROR_UNKNOWN_DETAILS\' | translate}}</md-button></div></div></div>')}])}(),function(r){try{r=angular.module("pipErrors.Templates")}catch(e){r=angular.module("pipErrors.Templates",[])}r.run(["$templateCache",function(r){r.put("unsupported/unsupported.html",'<div class="pip-error pip-empty layout-column flex layout-align-center-center"><div class="pip-error-text">{{::\'ERROR_UNSUPPORTED_TITLE\' | translate}}</div><div class="pip-error-subtext">{{::\'ERROR_UNSUPPORTED_SUBTITLE\' | translate}}</div><div class="pip-error-details" layout="row" layout-align="center center" ng-if="$mdMedia(\'gt-xs\')"><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/ie.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.microsoft.com/en-us/download/internet-explorer-11-for-windows-7-details.aspx">{{::\'ERROR_UNSUPPORTED_IE\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_IE_VER\' | translate}}</p></div></div><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/fm.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.mozilla.org/ru/firefox/new/">{{::\'ERROR_UNSUPPORTED_FM\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_FM_VER\' | translate}}</p></div></div><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/gc.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.google.com/chrome/browser/desktop/index.html?platform=win64#">{{::\'ERROR_UNSUPPORTED_GC\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_GC_VER\' | translate}}</p></div></div><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/o.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="http://www.opera.com/ru/download">{{::\'ERROR_UNSUPPORTED_O\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_O_VER\' | translate}}</p></div></div></div><div class="pip-error-details" ng-if="$mdMedia(\'xs\')"><div layout="row" layout-align="center center"><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/ie.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.microsoft.com/en-us/download/internet-explorer-11-for-windows-7-details.aspx">{{::\'ERROR_UNSUPPORTED_IE\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_IE_VER\' | translate}}</p></div></div><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/fm.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.mozilla.org/ru/firefox/new/">{{::\'ERROR_UNSUPPORTED_FM\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_FM_VER\' | translate}}</p></div></div></div><div class="tm16" layout="row" layout-align="center center"><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/gc.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="https://www.google.com/chrome/browser/desktop/index.html?platform=win64#">{{::\'ERROR_UNSUPPORTED_GC\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_GC_VER\' | translate}}</p></div></div><div class="pip-error-details-item" layout="column" layout-align="center center"><div style="background-image: url(\'../../dist/images/o.svg\');" class="pip-pic"></div><div class="h64 tp16 bp16"><a class="text-body2 m0" target="_blank" href="http://www.opera.com/ru/download">{{::\'ERROR_UNSUPPORTED_O\' | translate}}</a><p class="text-body1 m0">{{::\'ERROR_UNSUPPORTED_O_VER\' | translate}}</p></div></div></div></div></div>')}])}(),function(){"use strict";angular.module("pipErrorHandling",["pipErrors.Pages","pipNoConnectionPanel"])}(),function(){"use strict";var r=angular.module("pipErrors.Pages",["pipAppBar","pipRest.State","pipTransactions","pipRest","ngMaterial","pipErrors.Strings","pipErrors.NoConnection","pipErrors.MissingRoute","pipErrors.Unsupported","pipErrors.Unknown","pipErrors.Maintenance","pipErrors.Templates"]);r.config(["pipAuthStateProvider",function(r){r.state("errors_no_connection",{url:"/errors/no_connection",params:{error:null},auth:!1,controller:"pipErrorNoConnectionController",templateUrl:"no_connection/no_connection.html"}).state("errors_maintenance",{url:"/errors/maintenance",params:{error:null},auth:!1,controller:"pipErrorMaintenanceController",templateUrl:"maintenance/maintenance.html"}).state("errors_missing_route",{url:"/errors/missing_route",params:{unfoundState:null,fromState:null},auth:!0,controller:"pipErrorMissingRouteController",templateUrl:"missing_route/missing_route.html"}).state("errors_unsupported",{url:"/errors/unsupported",params:{error:null},auth:!1,controller:"pipErrorUnsupportedController",templateUrl:"unsupported/unsupported.html"}).state("errors_unknown",{url:"/errors/unknown",params:{error:null},auth:!1,controller:"pipErrorUnknownController",templateUrl:"unknown/unknown.html"})}])}(),function(){"use strict";var r=angular.module("pipErrors.Strings",["pipTranslate"]);r.config(["pipTranslateProvider",function(r){r.translations("en",{ERROR_ROUTE_TITLE:"Sorry, the page isn't available",ERROR_ROUTE_SUBTITLE:"The link you followed may be broken, or the page may have been removed.",ERROR_ROUTE_CONTINUE:"Continue",ERROR_ROUTE_TRY_AGAIN:"Try again",ERROR_ROUTE_GO_BACK:"Go Back",ERROR_ROUTE_PAGE_TITLE:"Wrong page",ERROR_UNKNOWN_TITLE:"Oops. Something went wrong",ERROR_UNKNOWN_SUBTITLE:"Unknown error occurred, but don't worry we already have been notified.",ERROR_UNKNOWN_CLOSE:"Close",ERROR_UNKNOWN_DETAILS:"Details",ERROR_AVAILABLE_TITLE:"The server is on maintenance",ERROR_AVAILABLE_SUBTITLE:"Sorry for the inconvenience. This application is undergoing maintenance for a short period. We'll be back soon. Thank for your patience.",ERROR_AVAILABLE_CLOSE:"Close",ERROR_AVAILABLE_TRY_AGAIN:"Try after",ERROR_RESPONDING_TITLE:"No connection to the server",ERROR_RESPONDING_SUBTITLE:"Unable to connect to the server. Check your Internet connection and try again.",ERROR_RESPONDING_RETRY:"Retry",ERROR_UNSUPPORTED_TITLE:"This browser is not supported",ERROR_UNSUPPORTED_SUBTITLE:"Our application using the latest technology. This makes the application faster and easier to use. Unfortunately, your browser doesn't support those technologies. Download on of these great browsers and you'll be on your way:",ERROR_UNSUPPORTED_O:"Opera",ERROR_UNSUPPORTED_O_VER:"Version 36+",ERROR_UNSUPPORTED_IE:"Internet Explorer",ERROR_UNSUPPORTED_IE_VER:"Version 11+",ERROR_UNSUPPORTED_GC:"Google Chrome",ERROR_UNSUPPORTED_GC_VER:"Version 48+",ERROR_UNSUPPORTED_FM:"Mozilla Firefox",ERROR_UNSUPPORTED_FM_VER:"Version 45+"}),r.translations("ru",{ERROR_ROUTE_TITLE:"Sorry, the page isn't available",ERROR_ROUTE_SUBTITLE:"The link you followed may be broken, or the page may have been removed.",ERROR_ROUTE_CONTINUE:"Continue",ERROR_ROUTE_TRY_AGAIN:"Try again",ERROR_ROUTE_GO_BACK:"Go Back",ERROR_ROUTE_PAGE_TITLE:"Wrong page",ERROR_UNKNOWN_TITLE:"Oops. Something went wrong",ERROR_UNKNOWN_SUBTITLE:"Unknown error occurred, but don't worry we already have been notified.",ERROR_UNKNOWN_CLOSE:"Close",ERROR_UNKNOWN_DETAILS:"Details",ERROR_AVAILABLE_TITLE:"The server is on maintenance",ERROR_AVAILABLE_SUBTITLE:"Sorry for the inconvenience. This application is undergoing maintenance for a short period. We'll be back soon. Thank for your patience.",ERROR_AVAILABLE_CLOSE:"Close",ERROR_AVAILABLE_TRY_AGAIN:"Try after",ERROR_RESPONDING_TITLE:"No connection to the server",ERROR_RESPONDING_SUBTITLE:"Unable to connect to server. Check your Internet connection and try again.",ERROR_RESPONDING_RETRY:"Retry",ERROR_UNSUPPORTED_TITLE:"This browser is not supported",ERROR_UNSUPPORTED_SUBTITLE:"Our application using the latest technology. This makes the application faster and easier to use. Unfortunately, your browser doesn't support those technologies. Download on of these great browsers and you'll be on your way:",ERROR_UNSUPPORTED_O:"Opera",ERROR_UNSUPPORTED_O_VER:"Version 35+",ERROR_UNSUPPORTED_IE:"Internet Explorer",ERROR_UNSUPPORTED_IE_VER:"Version 11+",ERROR_UNSUPPORTED_GC:"Google Chrome",ERROR_UNSUPPORTED_GC_VER:"Version 47+",ERROR_UNSUPPORTED_FM:"Mozilla Firefox",ERROR_UNSUPPORTED_FM_VER:"Version 43+"})}])}(),function(){"use strict";var r=angular.module("pipErrors.Maintenance",[]);r.controller("pipErrorMaintenanceController",["$scope","$state","$rootScope","pipAppBar",function(r,e,t,o){function n(){o.showMenuNavIcon(),o.showTitleBreadcrumb("ERROR_AVAILABLE_TITLE",[]),o.showLocalActions(null,[])}function a(){}t.$routing=!1,r.isCordova=!1,n(),r.error=e&&e.params&&e.params.error?e.params.error:{},r.timeoutInterval=r.error&&r.error.config&&r.error.config.params&&r.error.config.params.interval?r.error.config.params.interval:0,r.onClose=a}])}(),function(){"use strict";var r=angular.module("pipErrors.MissingRoute",[]);r.controller("pipErrorMissingRouteController",["$scope","$state","$rootScope","pipAppBar","pipAuthState",function(r,e,t,o,n){function a(){o.showMenuNavIcon(),o.showTitleBreadcrumb("ERROR_ROUTE_PAGE_TITLE",[]),o.showLocalActions(null,[])}function i(){n.goToAuthorized()}a(),t.$routing=!1,r.error=e&&e.params&&e.params.error?e.params.fromState:{},r.unfoundState=e&&e.params?e.params.unfoundState:{},r.url=r.unfoundState&&r.unfoundState.to?e.href(r.unfoundState.to,r.unfoundState.toParams,{absolute:!0}):"",r.urlBack=r.fromState&&r.fromState.to?e.href(r.fromState.to,r.fromState.fromParams,{absolute:!0}):"",r.onContinue=i}])}(),function(){"use strict";var r=angular.module("pipErrors.NoConnection",[]);r.controller("pipErrorNoConnectionController",["$scope","$state","$rootScope","$window","pipAppBar",function(r,e,t,o,n){function a(){o.history.back()}function i(){n.showMenuNavIcon(),n.showTitleBreadcrumb("ERROR_RESPONDING_TITLE",[]),n.showLocalActions(null,[])}t.$routing=!1,i(),r.error=e&&e.params&&e.params.error?e.params.error:{},r.onRetry=a}])}(),function(){"use strict";var r=angular.module("pipNoConnectionPanel",[]);r.directive("pipNoConnectionPanel",function(){return{restrict:"E",scope:{error:"=pipError",retry:"=pipRetry"},templateUrl:"no_connection/pip_no_connection_panel.html",controller:"pipNoConnectionPanelController"}}),r.controller("pipNoConnectionPanelController",["$scope","$element","$attrs","pipTranslate",function(r,e,t,o){function n(){r.retry&&angular.isFunction(r.retry)&&r.retry()}r.onRetry=n}])}(),function(){"use strict";var r=angular.module("pipErrors.Unknown",[]);r.controller("pipErrorUnknownController",["$scope","$state","$rootScope","pipAppBar",function(r,e,t,o){function n(){o.showMenuNavIcon(),o.showTitleBreadcrumb("ERROR_UNKNOWN_TITLE",[]),o.showLocalActions(null,[])}function a(){r.error_details={},r.error_details.code=r.error.code,r.error_details.description=r.error.message,r.error_details.status=r.error.status,r.error_details.server_stacktrace=function(){},r.error_details.client_stacktrace=function(){}}function i(){}function s(){}t.$routing=!1,r.isCordova=!1,n(),r.error=e&&e.params&&e.params.error?e.params.error:{},r.error_details=null,r.onDetails=i,r.onClose=s,a()}])}(),function(){"use strict";var r=angular.module("pipErrors.Unsupported",[]);r.controller("pipErrorUnsupportedController",["$scope","$state","$rootScope","$mdMedia","pipAppBar",function(r,e,t,o,n){function a(){n.showMenuNavIcon(),n.showTitleBreadcrumb("ERROR_UNSUPPORTED_TITLE",[]),n.showLocalActions(null,[])}r.$mdMedia=o,t.$routing=!1,a(),r.error=e&&e.params&&e.params.error?e.params.error:{}}])}();
!function(){"use strict";angular.module("pipSettings",["pipSettings.Service","pipSettings.Page","pipUserSettings"])}(),function(e){try{e=angular.module("pipSettings.Templates")}catch(t){e=angular.module("pipSettings.Templates",[])}e.run(["$templateCache",function(e){e.put("settings_page/settings_page.html",'<md-toolbar class="pip-appbar-ext"></md-toolbar><pip-document width="800" min-height="400" class="pip-settings"><div class="pip-menu-container" ng-hide="manager === false || !pages || pages.length < 1"><md-list class="pip-menu pip-simple-list hide-xs" pip-selected="selected.pageIndex" pip-selected-watch="selected.navId" pip-select="onNavigationSelect($event.id)"><md-list-item class="pip-simple-list-item pip-selectable flex" md-ink-ripple="" pip-id="{{ page.state }}" ng-repeat="page in pages track by page.state" ng-if="$party.id == $user.id || page.state == \'settings.basic_info\'|| page.state ==\'settings.contact_info\' || page.state ==\'settings.blacklist\'"><p>{{page.title | translate}}</p></md-list-item></md-list><div class="pip-content-container" ng-if="selected.page" style="min-height: 100%;"><pip-dropdown pip-actions="pages" class="hide-gt-xs" pip-dropdown-select="onDropdownSelect" pip-active-index="selected.pageIndex"></pip-dropdown><div class="pip-body tp24-flex" ui-view="" layout="column" style="max-width: none !important; min-height: 100%"></div></div></div><div ng-show="manager === false || !pages || pages.length < 1" layout="column" layout-align="center center" flex="">{{::\'ERROR_400\' | translate}}</div></pip-document>')}])}(),function(e){try{e=angular.module("pipSettings.Templates")}catch(t){e=angular.module("pipSettings.Templates",[])}e.run(["$templateCache",function(e){e.put("user_settings/user_settings_basic_info.html",'<form name="form" style="width:100%;" novalidate=""><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><div layout="row" class="bm12"><div class="md-tile-left" style="position: relative; margin-right: 16px; height: 80px; width: 80px"><pip-avatar-edit pip-party-id="$party.id" pip-created="onPictureCreated($event)" pip-changed="onPictureChanged($control, $event)"></pip-avatar-edit></div><div class="md-tile-content tp0" layout-align="center"><h3 class="tm16 bm8 text-one-line">{{ nameCopy }}</h3><p class="text-primary text-overflow m0">{{::\'SETTINGS_BASIC_INFO_FROM\' | translate}} {{$user.signup | formatLongDate }}</p></div></div><md-input-container class="md-block"><label>{{::\'SETTINGS_BASIC_INFO_FULL_NAME\' | translate}}</label> <input name="fullName" ng-model="$party.name" ng-disabled="transaction.busy()" step="any" type="text" tabindex="0" required="" ng-change="onChangeBasicInfo()"><div class="hint" ng-if="errorsWithHint(form, form.fullName).hint">{{::\'ERROR_FULLNAME_INVALID\' | translate}}</div></md-input-container><md-input-container class="md-block bm0"><label>{{::\'SETTINGS_BASIC_INFO_PRIMARY_EMAIL\' | translate}}</label> <input name="email" pip-email-unique="{{$party.email}}" ng-model="$party.email" type="email" required="" ng-change="onChangeBasicInfo()"><div class="hint" ng-if="errorsWithHint(form, form.email).hint && !$user.email_ver">{{::\'SETTINGS_BASIC_INFO_VERIFY_HINT\' | translate}}</div><div ng-messages="errorsWithHint(form.email)" ng-hide="$party.type ==\'team\'"><div ng-message="email">{{::\'ERROR_EMAIL_INVALID\' | translate}}</div><div ng-message="emailUnique">{{::\'ERROR_EMAIL_INVALID\' | translate}}</div></div></md-input-container><md-button ng-click="onVerifyEmail($event)" ng-hide="$user.email_ver || $party.type ==\'team\'" class="md-raised bm16 tm8 rm8">{{::\'SETTINGS_BASIC_INFO_VERIFY_CODE\' | translate}}</md-button><md-button ng-click="onChangePassword($event)" class="md-raised bm16 tm8" ng-hide="$party.type ==\'team\'">{{::\'SETTINGS_BASIC_INFO_CHANGE_PASSWORD\' | translate}}</md-button><md-input-container flex="" class="md-block"><label>{{::\'SETTINGS_BASIC_INFO_WORDS_ABOUT_ME\' | translate }}</label> <textarea ng-model="$party.about" columns="1" ng-change="onChangeBasicInfo()"></textarea></md-input-container><md-input-container class="md-block" ng-hide="$party.type ==\'team\'"><label>{{::\'GENDER\' | translate}}</label><md-select ng-model="$party.gender" ng-change="onChangeBasicInfo()" placeholder="{{\'GENDER\' | translate}}"><md-option ng-value="gender.id" ng-repeat="gender in genders">{{gender.name}}</md-option></md-select></md-input-container><div ng-hide="$party.type ==\'team\'"><p class="text-caption text-grey tm0 bm0">{{::\'SETTINGS_BASIC_INFO_BIRTHDAY\' | translate}}</p><pip-date ng-model="$party.birthday" time-mode="past" ng-change="onChangeBasicInfo()" pip-time-mode="past"></pip-date></div><md-input-container class="md-block" ng-hide="$party.type ==\'team\'"><label>{{::\'LANGUAGE\' | translate}}</label><md-select ng-model="$user.language" ng-change="onChangeUser()" placeholder="{{\'LANGUAGE\' | translate}}"><md-option ng-value="language.id" ng-repeat="language in languages">{{language.name}}</md-option></md-select></md-input-container><md-input-container class="md-block" ng-if="$party.type !=\'team\'"><label>{{::\'THEME\' | translate}}</label><md-select ng-model="$user.theme" ng-change="onChangeUser()" class="w-stretch theme-text-primary" ng-disabled="transaction.busy()"><md-option ng-value="theme" ng-repeat="theme in themes" ng-selected="$theme == theme ? true : false">{{ theme | translate }}</md-option></md-select></md-input-container><pip-location-edit class="map-edit bm24-flex" ng-hide="$party.type ==\'team\'" pip-changed="onChangeBasicInfo()" pip-location-name="$party.loc_name" pip-location-pos="loc_pos"></pip-location-edit></form>')}])}(),function(e){try{e=angular.module("pipSettings.Templates")}catch(t){e=angular.module("pipSettings.Templates",[])}e.run(["$templateCache",function(e){e.put("user_settings/user_settings_change_password.html",'<md-dialog class="pip-dialog" layout="column" width="440"><form name="form" ng-submit="onApply()"><div class="pip-header"><h3 class="m0">{{\'SETTINGS_CHANGE_PASSWORD_TITLE\' | translate : module}}</h3></div><div class="pip-body"><div class="pip-content"><div ng-messages="form.$serverError" class="text-error bm8"><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><md-input-container class="md-block"><label>{{ \'SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD\' | translate }}</label> <input name="oldPassword" ng-model="changePasData.old_password" type="password" ng-required="change_password.$submitted" pip-clear-errors=""><div ng-messages="errorsWithHint(form, form.oldPassword)"><div ng-message="required">{{ \'ERROR_REQUIRED\' | translate }}</div><div ng-message="ERROR_1107">{{ \'ERROR_WRONG_PASSWORD\' | translate }}</div></div></md-input-container><md-input-container class="md-block"><label>{{ \'SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD\' | translate }}</label> <input name="newPassword" ng-model="changePasData.new_password" ng-change="onCheckRepeatPassword()" ng-minlength="6" type="password" ng-required="change_password.$submitted" pip-clear-errors=""><div class="hint" ng-if="errorsWithHint(form, form.newPassword).hint">{{ \'HINT_PASSWORD\' | translate }}</div><div ng-messages="errorsWithHint(form, form.newPassword)"><div ng-message="required">{{ \'ERROR_REQUIRED\' | translate }}</div><div ng-message="minlength">{{ \'HINT_PASSWORD\' | translate }}</div><div ng-message="ERROR_1105">{{ \'ERROR_IDENTICAL_PASSWORDS\' | translate }}</div></div></md-input-container><md-input-container class="md-block"><label>{{ \'SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD\' | translate }}</label> <input name="repeat" ng-model="repeat" ng-change="onCheckRepeatPassword()" ng-minlength="6" type="password" ng-required="change_password.$submitted"><div class="hint" ng-if="errorsRepeatWithHint(form.repeat).hint">{{ \'HINT_REPEAT_PASSWORD\' | translate }}</div><div ng-messages="errorsRepeatWithHint(form.repeat)"><div ng-message="required">{{ \'ERROR_REQUIRED\' | translate }}</div><div ng-message="minlength">{{ \'HINT_PASSWORD\' | translate }}</div><div ng-message="repeat">{{ \'REPEAT_PASSWORD_INVALID\' | translate }}</div></div></md-input-container></div></div><div class="pip-footer"><div><md-button ng-click="onCancel()" aria-label="xxx">{{ \'CANCEL\' | translate }}</md-button><md-button type="submit" class="md-accent" aria-label="xxx">{{ \'APPLY\' | translate : module}}</md-button></div></div></form></md-dialog>')}])}(),function(e){try{e=angular.module("pipSettings.Templates")}catch(t){e=angular.module("pipSettings.Templates",[])}e.run(["$templateCache",function(e){e.put("user_settings/user_settings_sessions.html",'<md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><div class="pip-details-title"><p class="pip-title bm16">{{\'SETTINGS_ACTIVE_SESSIONS_TITLE\' | translate}}</p><p class="pip-subtitle">{{\'SETTINGS_ACTIVE_SESSIONS_SUBTITLE\' | translate}}</p></div><md-list class="w-stretch"><md-item ng-repeat="session in sessions"><div layout="row" ng-init="session.id != sessionId ? showBlock = true : showBlock = false" ng-click="showBlock = !showBlock"><p class="m0 text-subhead2 text-overflow max-w50-stretch">{{session.client}}</p><p class="m0 lp4 text-body1 color-secondary-text" flex="">{{\'SETTINGS_ACTIVE_SESSION_ACTIVE\' | translate}}</p><p class="m0 text-body1 color-secondary-text">{{country}}<md-icon ng-if="showBlock" md-svg-icon="icons:triangle-up"></md-icon><md-icon ng-if="!showBlock" md-svg-icon="icons:triangle-down"></md-icon></p></div><div layout="row" class="bm8 bp8" ng-class="{\' divider-bottom\':!$last}"><div flex="50"><p class="m0 bm4 text-body1 text-overflow color-secondary-text">{{ session.last_req | date : \'medium\' }}</p><p class="m0 bm4 text-body1 text-overflow color-secondary-text" ng-show="showBlock">{{\'SETTINGS_ACTIVE_SESSION_OS\' | translate}}{{session.platform}}</p><p class="m0 bm4 text-body1 text-overflow color-secondary-text" ng-show="showBlock">{{\'SETTINGS_ACTIVE_SESSION_IP\' | translate}}{{session.address}}</p><md-button class="md-raised" ng-show="showBlock && session.id != sessionId" ng-click="onRemove(session)">{{\'SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION\' | translate}}</md-button></div><pip-location-ip class="map-edit" ng-if="showBlock" flex="50" pip-ipaddress="session.address" pip-extra-info="country = extraInfo.country"></pip-location-ip></div></md-item></md-list><div layout="row" layout-align="end center"><md-button class="md-raised" ng-show="sessions.length > 1" ng-click="onRemoveAll()">{{\'SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS\' | translate}}</md-button></div>')}])}(),function(e){try{e=angular.module("pipSettings.Templates")}catch(t){e=angular.module("pipSettings.Templates",[])}e.run(["$templateCache",function(e){e.put("user_settings/user_settings_verify_email.html",'<md-dialog class="pip-dialog" layout="column" width="440"><div class="pip-body"><div class="pip-content"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-top"></md-progress-linear><h2>{{\'VERIFY_EMAIL_TITLE\' | translate}}</h2><p class="title-padding">{{\'VERIFY_EMAIL_TEXT_1\' | translate}}</p><form name="form" novalidate=""><div ng-messages="form.$serverError" class="text-error bm8"><div ng-message="ERROR_UNKNOWN">{{ form.$serverError.ERROR_UNKNOWN | translate }}</div></div><md-input-container class="display bp4 md-block"><label>{{::\'EMAIL\' | translate}}</label> <input name="email" type="email" ng-model="data.email" required="" step="any" pip-clear-errors="" tabindex="1" ng-disabled="transaction.busy()" pip-test="input-email"><div class="hint" ng-if="errorsWithHint(form, form.email).hint">{{::\'HINT_EMAIL\' | translate}}</div><div ng-messages="errorsWithHint(form, form.email)" xng-if="!form.email.$pristine"><div ng-message="required">{{::\'ERROR_EMAIL_INVALID\' | translate }}</div><div ng-message="ERROR_1106">{{::\'ERROR_USER_NOT_FOUND\' | translate}}</div></div></md-input-container><md-input-container class="md-block"><label>{{\'ENTRY_VERIFICATION_CODE\' | translate}}</label> <input name="code" ng-disabled="transaction.busy()" tabindex="0" ng-model="data.code" required="" pip-clear-errors=""><div ng-messages="errorsWithHint(form, form.code)"><div ng-message="required">{{ \'ERROR_CODE_INVALID\' | translate }}</div><div ng-message="ERROR_1103">{{ \'ERROR_CODE_WRONG\' | translate }}</div></div></md-input-container><p>{{\'VERIFY_EMAIL_TEXT_21\' | translate}} <a ng-click="onRequestVerificationClick()" class="pointer" tabindex="0">{{\'VERIFY_EMAIL_RESEND\' | translate}}</a> {{\'VERIFY_EMAIL_TEXT_22\' | translate}}</p></form></div></div><div class="pip-footer"><md-button ng-click="onCancel()" ng-hide="transaction.busy()" aria-label="xxx">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-click="onVerify()" ng-hide="transaction.busy()" tabindex="0" aria-label="xxx" ng-disabled="data.code.length == 0 || data.email.length == 0 || (!data.email && form.$pristine) || (!data.code)">{{::\'VERIFY\' | translate}}</md-button><md-button class="md-warn" ng-show="transaction.busy()" ng-click="transaction.abort()" tabindex="0" aria-label="xxx">{{::\'CANCEL\' | translate}}</md-button></div></md-dialog>')}])}(),function(){"use strict";var e=angular.module("pipSettings.Page",["pipState","pipSettings.Service","pipAppBar","pipSelected","pipTranslate","pipSettings.Templates"]);e.config(["pipAuthStateProvider",function(e){e.state("settings",{url:"/settings?party_id",auth:!0,controller:"pipSettingsPageController",templateUrl:"settings_page/settings_page.html"})}]),e.controller("pipSettingsPageController",["$scope","$state","$rootScope","pipAppBar","pipSettings",function(e,t,n,a,i){function s(){a.showMenuNavIcon(),a.showTitleText("SETTINGS_TITLE"),a.showLocalActions(null,[]),a.showShadowSm(),a.hideSearch()}function r(e){o(e.state)}function o(n){l(n),e.selected.page&&t.go(n)}function l(t){e.selected.page=_.find(e.pages,function(e){return e.state==t}),e.selected.pageIndex=_.indexOf(e.pages,e.selected.page),e.selected.pageId=t}e.pages=_.filter(i.getPages(),function(e){return e.visible===!0&&(e.access?e.access(n.$user,e):!0)?e:void 0}),e.pages=_.sortBy(e.pages,function(e){return e.index}),e.selected={},"settings"!=t.current.name?l(t.current.name):i.getDefaultPage()?l(i.getDefaultPage().state):setTimeout(function(){i.getDefaultPage()?l(i.getDefaultPage().state):e.pages.length>0&&l(e.pages[0].state)},0),s(),e.onNavigationSelect=o,e.onDropdownSelect=r}])}(),function(){"use strict";var e=angular.module("pipSettings.Service",[]);e.provider("pipSettings",["pipAuthStateProvider",function(e){function t(e){return"settings."+e}function n(){return _.clone(l,!0)}function a(){var e=_.find(l,function(t){return t.state==e});return _.clone(e,!0)}function i(n){r(n);var a=_.find(l,function(e){return e.state==t(n.state)});if(a)throw new Error('Page with state name "'+n.state+'" is already registered');l.push({state:t(n.state),title:n.title,index:n.index||1e5,access:n.access,visible:n.visible!==!1,stateConfig:_.clone(n.stateConfig,!0)}),e.state(t(n.state),n.stateConfig),"undefined"==typeof o&&1===l.length&&s(n.state)}function s(n){if(!_.find(l,function(e){return e.state==t(n)}))throw new Error('Page with state name "'+n+'" is not registered');o=t(n),e.redirect("settings",t(n))}function r(e){if(!e||!_.isObject(e))throw new Error("Invalid object");if(null==e.state||""==e.state)throw new Error("Page should have valid Angular UI router state name");if(e.access&&!_.isFunction(e.access))throw new Error('"access" should be a function');if(!e.stateConfig||!_.isObject(e.stateConfig))throw new Error("Invalid state configuration object")}var o,l=[];return{addPage:i,getPages:n,setDefaultPage:s,getDefaultPage:a,$get:function(){return{getPages:n,addPage:i,getDefaultPage:a,setDefaultPage:s}}}}])}(),function(){"use strict";angular.module("pipUserSettings",["ngMaterial","pipData","pipSettings.Service","pipSettings.Page","pipUserSettings.Data","pipUserSettings.Strings","pipUserSettings.BasicInfo","pipUserSettings.Sessions","pipSettings.Templates"])}(),function(){"use strict";var e=angular.module("pipUserSettings.BasicInfo",["pipUserSettings.ChangePassword","pipUserSettings.VerifyEmail"]);e.config(["pipSettingsProvider","pipUserSettingsPageDataProvider","pipAuthStateProvider",function(e,t,n){e.addPage({state:"basic_info",index:1,title:"SETTINGS_BASIC_INFO_TITLE",stateConfig:{url:"/basic_info",controller:"pipUserSettingsBasicInfoController",templateUrl:"user_settings/user_settings_basic_info.html",auth:!0}}),e.setDefaultPage("basic_info")}]),e.controller("pipUserSettingsBasicInfoController",["$scope","$rootScope","$mdDialog","$state","pipTranslate","pipTransaction","pipFormErrors","pipUserSettingsPageData","pipToasts","$window","pipTheme","$mdTheming",function(e,t,n,a,i,s,r,o,l,d,p,c){function S(n){e.picture.save(function(){t.$broadcast("pipPartyAvatarUpdated")},function(e){console.error(e)})}function g(n){e.picture=n.sender,e.picture.save(function(){t.$broadcast("pipPartyAvatarUpdated")},function(e){console.error(e)})}function m(){if(e.form&&e.form.$setSubmitted(),t.$party){if("person"==t.$party.type&&e.form.$invalid)return;t.$party.loc_pos=e.loc_pos;var n=angular.toJson(t.$party);n!=e.originalParty&&o.updateParty(e.transaction,t.$party,function(t){e.originalParty=n,e.nameCopy=t.name},function(n){e.message=String()+"ERROR_"+n.status||n.data.status_code,t.$party=angular.fromJson(e.originalParty)})}}function u(){t.$user.id==t.$party.id&&o.updateUser(e.transaction,t.$user,function(e){i.use(e.language),t.$user.language=e.language,t.$user.theme=e.theme,t.$user.theme&&p.setCurrentTheme(t.$user.theme,!0)},function(e){var t=String()+"ERROR_"+e.status||e.data.status_code;l.showNotification(i.translate(t),null,null,null)})}function I(e){n.show({templateUrl:"user_settings/user_settings_change_password.html",controller:"pipUserSettingsChangePasswordController",targetEvent:e,locals:{email:t.$party.email}}).then(function(e){if(e){var t=String()+"RESET_PWD_SUCCESS_TEXT";l.showNotification(i.translate(t),null,null,null)}})}function T(a){n.show({templateUrl:"user_settings/user_settings_verify_email.html",controller:"pipUserSettingsVerifyEmailController",targetEvent:a,locals:{email:t.$party.email}}).then(function(t){if(e.user.email_ver=t,t){var n=String()+"VERIFY_EMAIL_SUCCESS_TEXT";l.showNotification(i.translate(n),null,null,null)}})}e.originalParty=angular.toJson(t.$party),e.nameCopy=t.$party.name,setTimeout(function(){e.loc_pos=t.$party.loc_pos,e.$apply()}),e.genders=i.translateSet(["male","female","n/s"]),e.languages=i.translateSet(["ru","en"]),e.transaction=s("settings.basic_info",e),e.themes=_.keys(_.omit(c.THEMES,"default")),a.get("settings.basic_info").onExit=m,e.errorsWithHint=r.errorsWithHint,e.onChangePassword=I,e.onVerifyEmail=T,e.onPictureCreated=g,e.onPictureChanged=S,e.onChangeUser=_.debounce(u,2e3),e.onChangeBasicInfo=_.debounce(m,2e3)}])}(),function(){"use strict";var e=angular.module("pipUserSettings.ChangePassword",[]);e.controller("pipUserSettingsChangePasswordController",["$scope","$rootScope","$mdDialog","pipRest","pipTransaction","pipFormErrors","email",function(e,t,n,a,i,s,r){function o(){n.cancel()}function l(){e.changePasData&&(e.repeat!==e.changePasData.new_password&&""!=e.repeat&&e.repeat?(e.showRepeatHint=!0,e.form.repeat.$setValidity("repeat",!1)):(e.form.repeat.$setValidity("repeat",!0),e.repeat===e.changePasData.new_password?e.showRepeatHint=!1:e.showRepeatHint=!0))}function d(){e.onCheckRepeatPassword(),e.form.$invalid||e.transaction.begin("CHANGE_PASSWORD")&&(e.changePasData.email=r,a.changePassword().call(e.changePasData,function(t){e.transaction.end(),n.hide(!0)},function(t){e.transaction.end(t),s.setFormError(e.form,t,{1107:"oldPassword",1105:"newPassword"})}))}e.transaction=i("settings.change_password",e),e.errorsRepeatWithHint=function(t,n){return e.showRepeatHint?s.errorsWithHint(t,n):{}},e.showRepeatHint=!0,e.changePasData={},e.errorsWithHint=s.errorsWithHint,e.onCancel=o,e.onCheckRepeatPassword=l,e.onApply=d}])}(),function(){"use strict";var e=angular.module("pipUserSettings.Data",["pipDataModel"]);e.provider("pipUserSettingsPageData",function(){this.readContactsResolver=["$stateParams","pipRest",function(e,t){return t.getOwnContacts().get({party_id:t.partyId(e),session_id:t.sessionId()}).$promise}],this.readBlocksResolver=["$stateParams","pipRest",function(e,t){return t.connectionBlocks().query({party_id:t.partyId(e)}).$promise}],this.readSessionsResolver=["$stateParams","pipRest",function(e,t){return t.userSessions().query({party_id:t.partyId(e)}).$promise}],this.readActivitiesResolver=["$stateParams","pipRest",function(e,t){return t.partyActivities().page({party_id:t.partyId(e),paging:1,skip:0,take:25}).$promise}],this.readSettingsResolver=["$stateParams","pipRest",function(e,t){return t.partySettings().get({party_id:t.partyId(e)}).$promise}],this.readSessionIdResolver=["$stateParams","pipRest",function(e,t){return t.sessionId()}],this.$get=["pipRest","$stateParams",function(e,t){return{partyId:e.partyId,updateParty:function(t,n,a,i){var s=t.begin("UPDATING");s&&e.parties().update(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},saveContacts:function(t,n,a,i){var s=t.begin("SAVING");s&&e.contacts().save(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},updateContact:function(t,n,a,i){var s=t.begin("UPDATING");s&&e.contacts().update(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},updateUser:function(t,n,a,i){var s=t.begin("UPDATING");s&&e.users().update(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},removeBlock:function(t,n,a,i){var s=t.begin("REMOVING");s&&e.connectionBlocks().remove(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},removeSession:function(n,a,i,s){var r=n.begin("REMOVING");r&&e.userSessions().remove({id:a.id,party_id:e.partyId(t)},function(e){n.aborted(r)||(n.end(),i&&i(e))},function(e){n.end(e),s&&s(e)})},requestEmailVerification:function(n){var a=n.begin("RequestEmailVerification");a&&e.requestEmailVerification().get({party_id:e.partyId(t)},function(){n.aborted(a)||n.end()},function(e){n.end(e)})},verifyEmail:function(t,n,a,i){var s=t.begin("Verifying");s&&e.verifyEmail().call(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},saveSettings:function(t,n,a,i){var s=t.begin("SAVING");s&&e.partySettings().save(n,function(e){t.aborted(s)||(t.end(),a&&a(e))},function(e){t.end(e),i&&i(e)})},getPreviousActivities:function(n,a,i,s){var r=n.begin("SAVING");r&&e.partyActivities().page({party_id:e.partyId(t),paging:1,skip:a,take:25},function(e){n.aborted(r)||(n.end(),i&&i(e))},function(e){n.end(e),s&&s(e)})},getRefPreviousEventsActivities:function(n,a,i,s,r,o){var l=n.begin("SAVING");l&&e.partyActivities().page({party_id:e.partyId(t),paging:1,skip:a,ref_type:i,ref_id:s.id,take:25},function(e){n.aborted(l)||(n.end(),r&&r(e))},function(e){n.end(e),o&&o(e)})}}}]})}(),function(){"use strict";var e=angular.module("pipUserSettings.Sessions",[]);e.config(["pipSettingsProvider","pipUserSettingsPageDataProvider","pipAuthStateProvider",function(e,t,n){e.addPage({state:"sessions",index:3,title:"SETTINGS_ACTIVE_SESSIONS_TITLE",stateConfig:{url:"/sessions",controller:"pipUserSettingsSessionsController",templateUrl:"user_settings/user_settings_sessions.html",auth:!0,resolve:{sessions:t.readSessionsResolver,sessionId:t.readSessionIdResolver}}})}]),e.controller("pipUserSettingsSessionsController",["$scope","pipTransaction","pipUserSettingsPageData","sessions","sessionId",function(e,t,n,a,i){function s(){async.each(e.sessions,function(t){t.id!=e.sessionId&&e.onRemove(t)})}function r(t){t.id!=e.sessionId&&n.removeSession(e.transaction,t,function(){e.sessions=_.without(e.sessions,t)},function(t){e.message="ERROR_"+t.status||t.data.status_code})}e.sessionId=i,e.transaction=t("settings.sessions",e),e.sessions=a,e.onRemoveAll=s,e.onRemove=r}])}(),function(){"use strict";var e=angular.module("pipUserSettings.Strings",["pipTranslate"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{SETTINGS_TITLE:"Settings",SETTINGS_BASIC_INFO_TITLE:"Basic info",SETTINGS_ACTIVE_SESSIONS_TITLE:"Active sessions",SETTINGS_BASIC_INFO_FULL_NAME:"Full name",SETTINGS_BASIC_INFO_VERIFY_HINT:"Please, verify your email address.",SETTINGS_BASIC_INFO_VERIFY_CODE:"Verify email address",SETTINGS_BASIC_INFO_DATE_CHANGE_PASSWORD:"Your password was changed on ",SETTINGS_BASIC_INFO_CHANGE_PASSWORD:"Change your password",SETTINGS_BASIC_INFO_NAME_HINT:"Please, use your real name to let other people know who you are.",SETTINGS_BASIC_INFO_WORDS_ABOUT_ME:"Few words about yourself",SETTINGS_BASIC_INFO_GENDER:"Gender",SETTINGS_BASIC_INFO_BIRTHDAY:"Birthday",SETTINGS_BASIC_INFO_LOCATION:"Current location",SETTINGS_BASIC_INFO_PRIMARY_EMAIL:"Primary email",SETTINGS_BASIC_INFO_FROM:"User since ",SETTINGS_BASIC_INFO_USER_ID:"User ID",SETTINGS_CHANGE_PASSWORD_TITLE:"Change password",SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD:"New password",SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD:"Repeat password",SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD:"Current password",SETTINGS_ACTIVE_SESSIONS_SUBTITLE:" If you notice any unfamiliar devices or locations, click 'Close Session' to end the session.",SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION:"Close session",SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS:"Close active sessions",SETTINGS_ACTIVE_SESSION_OS:"OS: ",SETTINGS_ACTIVE_SESSION_IP:"IP: ",SETTINGS_ACTIVE_SESSION_ACTIVE:"active",SETTINGS_BLACKLIST_TITLE:"Blacklist",SETTINGS_BLACKLIST_SUBTITLE:"Parties from blacklist will not be able to send you invitations and private messages.",SETTINGS_BLACKLIST_UNBLOCK:"Unblock",SETTINGS_BLACKLIST_EMPTY:"You have no blocked parties",SETTINGS_CONTACT_INFO_TITLE:"Contact info",SETTINGS_CONTACT_INFO_EMAIL:"Email",SETTINGS_CONTACT_INFO_ADD_EMAIL:"Add email",SETTINGS_CONTACT_INFO_ADD_PHONE:"Add phone",SETTINGS_CONTACT_INFO_ADD_ADDRESS:"Add address",SETTINGS_CONTACT_INFO_ADD_ACCOUNT:"Add account",SETTINGS_CONTACT_INFO_ADD_URL:"Add URL",SETTINGS_CONTACT_INFO_ADDRESS:"Address",SETTINGS_CONTACT_INFO_PHONE:"Phone",SETTINGS_CONTACT_INFO_ACCOUNT_NAME:"Account name",SETTINGS_CONTACT_INFO_URL:"URL",THEME:"Theme",HINT_REPEAT_PASSWORD:"Repeat password",ERROR_WRONG_PASSWORD:"Wrong password",ERROR_IDENTICAL_PASSWORDS:"Old and new passwords are identical",REPEAT_PASSWORD_INVALID:"Password does not match",ERROR_EMAIL_INVALID:"Please, enter a valid email"}),e.translations("ru",{SETTINGS_TITLE:"Настройки",SETTINGS_BASIC_INFO_TITLE:"Основные данные",SETTINGS_ACTIVE_SESSIONS_TITLE:"Активные сессии",SETTINGS_BASIC_INFO_FULL_NAME:"Полное имя",SETTINGS_BASIC_INFO_NAME_HINT:"Пожалуйста, используйте реальное имя, чтоб люди могли вас узнать",SETTINGS_BASIC_INFO_VERIFY_HINT:"Пожалуйста, подтвердите адрес своей электронной почты",SETTINGS_BASIC_INFO_VERIFY_CODE:"Подтвердите адрес эл.почты",SETTINGS_BASIC_INFO_DATE_CHANGE_PASSWORD:"Ваш пароль был изменен ",SETTINGS_BASIC_INFO_CHANGE_PASSWORD:"Поменять пароль",SETTINGS_BASIC_INFO_WORDS_ABOUT_ME:"Несколько слов о себе",SETTINGS_BASIC_INFO_GENDER:"Пол",SETTINGS_BASIC_INFO_BIRTHDAY:"Дата рождения",SETTINGS_BASIC_INFO_LOCATION:"Текущее местонахождение",SETTINGS_BASIC_INFO_PRIMARY_EMAIL:"Основной адрес эл. почты",SETTINGS_BASIC_INFO_FROM:"Начиная с",SETTINGS_BASIC_INFO_USER_ID:"Личный код",SETTINGS_CHANGE_PASSWORD_TITLE:"Изменить пароль",SETTINGS_CHANGE_PASSWORD_NEW_PASSWORD:"Новый пароль",SETTINGS_CHANGE_PASSWORD_REPEAT_RASSWORD:"Повтор",SETTINGS_CHANGE_PASSWORD_CURRENT_PASSWORD:"Текущий пароль",SETTINGS_ACTIVE_SESSIONS_SUBTITLE:'Если вы заметили какие-либо незнакомые устройства или месторасположение, нажмите кнопку "Закончить сеанс", чтобы завершить сеанс.',SETTINGS_ACTIVE_SESSIONS_CLOSE_SESSION:"Закрыть сессию",SETTINGS_ACTIVE_SESSIONS_CLOSE_ACTIVE_SESSIONS:"Закрыть активные сессии",SETTINGS_ACTIVE_SESSION_OS:"ОС: ",SETTINGS_ACTIVE_SESSION_IP:"IP: ",SETTINGS_ACTIVE_SESSION_ACTIVE:"Активно",SETTINGS_BLACKLIST_TITLE:"Блокировки",SETTINGS_BLACKLIST_SUBTITLE:"Участники из черного списка не смогут посылать вам приглашения и личные сообщения.",SETTINGS_BLACKLIST_UNBLOCK:"Разблокировать",SETTINGS_BLACKLIST_EMPTY:"У вас нет заблокированных участников",SETTINGS_CONTACT_INFO_TITLE:"Контакты",SETTINGS_CONTACT_INFO_EMAIL:"Адрес электронной почты",SETTINGS_CONTACT_INFO_ADD_EMAIL:"Добавить адрес эл. почты",SETTINGS_CONTACT_INFO_ADD_PHONE:"Добавить телефон",SETTINGS_CONTACT_INFO_ADD_ADDRESS:"Добавить адрес",SETTINGS_CONTACT_INFO_ADD_ACCOUNT:"Добавить аккаунт",SETTINGS_CONTACT_INFO_ADD_URL:"Добавить веб-сайт",SETTINGS_CONTACT_INFO_ADDRESS:"Адрес",SETTINGS_CONTACT_INFO_PHONE:"Телефон",SETTINGS_CONTACT_INFO_ACCOUNT_NAME:"Учетка в мессенджере",SETTINGS_CONTACT_INFO_URL:"Веб сайт",THEME:"Тема",HINT_REPEAT_PASSWORD:"Повторите пароль",ERROR_WRONG_PASSWORD:"Неправильный пароль",ERROR_IDENTICAL_PASSWORDS:"Старый и новый пароли идентичны",REPEAT_PASSWORD_INVALID:"Пароль не совпадает",ERROR_EMAIL_INVALID:"Пожалуйста, введите правильный почт.адрес"})}])}(),function(){"use strict";var e=angular.module("pipUserSettings.VerifyEmail",[]);e.controller("pipUserSettingsVerifyEmailController",["$scope","$rootScope","$mdDialog","pipTransaction","pipFormErrors","pipUserSettingsPageData","email",function(e,t,n,a,i,s,r){function o(){e.transaction.abort()}function l(){n.cancel()}function d(){s.requestEmailVerification(e.transaction)}function p(){e.form.$setSubmitted(),e.form.$invalid||s.verifyEmail(e.transaction,e.data,function(e){n.hide(!0)},function(t){i.setFormError(e.form,t,{1106:"email",1103:"code"})})}e.emailVerified=!1,e.data={email:r,code:""},e.transaction=a("settings.verify_email",e),e.onAbort=o,e.onRequestVerificationClick=d,e.errorsWithHint=i.errorsWithHint,e.onVerify=p,e.onCancel=l}])}();
!function(e){try{e=angular.module("pipGuidance.Templates")}catch(t){e=angular.module("pipGuidance.Templates",[])}e.run(["$templateCache",function(e){e.put("guidance/guidance_dialog.html",'<md-dialog class="pip-dialog pip-guidance-dialog" layout="column" width="768" md-theme="{{theme}}"><div class="pip-header" layout="row"><h3 flex="" class="rm16">{{title | translate}}</h3><md-button class="pip-dialog-close" ng-click="onCancel()" aria-label="{{::\'CLOSE\' | translate}}"><span class="icon-cross"></span></md-button></div><div class="pip-body"><div class="pip-content"><pip-picture pip-src="imageUrl" ng-hide="!imageUrl || imageUrl == \'\'" class="bm16 center-block" ng-style="{ width: imageWidth, height: imageHeight, display: \'block\' }"></pip-picture><div class="bm16" pip-translate-html="{{::content}}"></div><md-button class="md-raised md-accent w-stretch" ng-click="onAction()" ng-hide="!action || action==\'\'" arial-label="{{::action | translate}}">{{::action | translate}}</md-button><md-checkbox aria-label="{{\'DO_NOT_SHOW\' | translate}}" class="w-stretch m0 tm16 regular_14" ng-model="hideToggle" ng-change="onHideToggle()" ng-show="showHideToggle">{{::\'GUIDANCE_DO_NOT_SHOW\' | translate}}</md-checkbox></div></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipGuidance.Templates")}catch(t){e=angular.module("pipGuidance.Templates",[])}e.run(["$templateCache",function(e){e.put("intro_guidance/intro_guidance_dialog.html",'<md-dialog class="pip-dialog pip-guidance-dialog pip-guide-preview" layout="column" md-theme="{{theme}}"><div ng-if="!$routing" flex="" ng-swipe-left="onNextPage()" ng-swipe-right="onBackPage()" class="h-stretch layout layout-column {{\'bg-\' + data.pages[number].color}}"><div class="layout layout-row layout-align-space-between-center layout-align-xs-center-center w-stretch pip-guide-page"><md-button ng-click="onBackPage()" class="lm16 hide-xs" aria-label="BACK" ng-disabled="transaction.busy() || number == 0"><md-icon md-svg-icon="icons:arrow-left" class="pip-arrow-button" ng-class="{\'opacity-disabled\' :number == 0}"></md-icon></md-button><div class="layout layout-column layout-align-center-center bm16"><pip-collage class="flex-fixed" ng-if="data.pages[number].pic_id && (!data.pictures || !data.pictures[number])" pip-picture-ids="data.pages[number].picId" pip-unique-code="data.id" pip-multiple="false" pip-open="false" pip-rebind="true"></pip-collage><div class="pip-pic" ng-if="!data.pages[number].pic_id || data.pictures[number]" style="background-image: url({{data.pictures[number]}})"></div><div class="layout layout-column layout-align-center-center pip-text"><p class="pip-preview-title" ng-if="data.pages[number].title[ln]">{{data.pages[number].title[ln]}}</p><p class="pip-preview-content" ng-if="data.pages[number].content[ln]">{{data.pages[number].content[ln]}}</p></div></div><md-button ng-click="onNextPage()" class="rm16 hide-xs" aria-label="DOWN" ng-disabled="transaction.busy() || number == data.pages.length - 1"><md-icon md-svg-icon="icons:arrow-right" class="pip-arrow-button" ng-class="{\'opacity-disabled\' : number == data.pages.length - 1}"></md-icon></md-button></div><div class="flex-fixed flex w-stretch pip-guide-page-footer"><div layout="row" layout-align="center center" ng-if="data.pages.length > 1"><md-icon ng-repeat="radio in data.pages" ng-click="onChangePage($index)" class="pip-radio-button" md-svg-icon="{{radio != data.pages[number] ? \'icons:radio-off\' : \'icons:circle\'}}"></md-icon></div><div class="h64" layout="row" layout-align-xs="space-between center" layout-align="center center"><md-button ng-click="onBackPage()" class="lm16" ng-if="$mdMedia(\'xs\')" aria-label="BACK" ng-disabled="transaction.busy() || number == 0"><md-icon md-svg-icon="icons:arrow-left" class="pip-arrow-button" ng-class="{\'opacity-disabled\' :number == 0}"></md-icon></md-button><md-button ng-click="onClose()" class="pip-button-got rm8 lm8 {{number == data.pages.length - 1 ? \'fg-\' + data.pages[number].color : \'bg-\' + data.pages[number].color}}" ng-class="{\'md-raised\': number == data.pages.length - 1}" aria-label="NEXT" ng-disabled="transaction.busy()">GOT IT !</md-button><md-button ng-click="onNextPage()" class="rm16" ng-if="$mdMedia(\'xs\')" aria-label="DOWN" ng-disabled="transaction.busy() || number == data.pages.length - 1"><md-icon md-svg-icon="icons:arrow-right" class="pip-arrow-button" ng-class="{\'opacity-disabled\' : number == data.pages.length - 1}"></md-icon></md-button></div></div></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipGuidance.Templates")}catch(t){e=angular.module("pipGuidance.Templates",[])}e.run(["$templateCache",function(e){e.put("tips/tip.template.html",'<div ng-if="title" class="pip-title p24-flex flex-fixed bp16">{{ title | translate }}</div><div class="pip-content pip-popover-content lp24-flex rp24-flex text-body1 bm64 pip-scroll" ng-class="{\'tm24\' : !title }"><div ng-if="image && $mdMedia(\'gt-xs\')" class="pip-pic"></div><pip-markdown pip-text="content" pip-rebind="true"></pip-markdown></div><div class="pip-footer lm24-flex rm24-flex position-bottom" layout="row" layout-align="start center"><a ng-if="link" target="_blank" href="{{ link }}" class="text-body2" flex="">{{ \'MORE_URL\' | translate }}</a><div ng-if="!link" flex=""></div><md-button ng-click="onNextClick()" class="rm0">{{ \'NEXT\' | translate }}</md-button></div>')}])}(),function(){"use strict";angular.module("pipGuidance",["pipTips.Service","pipIntroGuidance.Service","pipGuidance.Dialog","pipReleaseIntroDialog"])}(),function(){"use strict";var e=angular.module("pipGuidance.Dialog",["ngMaterial","pipTranslate","pipGuidance.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{GUIDANCE_TITLE:"What should you do here?",GUIDANCE_ACTION:"Do it now!",GUIDANCE_DO_NOT_SHOW:"Don't show it again"}),e.translations("ru",{GUIDANCE_TITLE:"Что здесь делать?",GUIDANCE_ACTION:"Сделать это сейчас!",GUIDANCE_DO_NOT_SHOW:"Не показывать это снова"})}]),e.factory("pipGuidanceDialog",["$mdDialog",function(e){return{show:function(t,i,a){e.show({targetEvent:t.event,templateUrl:"guidance/guidance_dialog.html",controller:"pipGuidanceDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){i&&i()},function(){a&&a()})}}}]),e.controller("pipGuidanceDialogController",["$scope","$rootScope","$mdDialog","params",function(e,t,i,a){e.theme=t.$theme,e.title=a.title||"GUIDANCE_TITLE",e.imageUrl=a.imageUrl||"",e.imageWidth=a.imageWidth||"100%",e.imageHeight=a.imageHeight||"150px",e.content=a.content,e.action=a.action||"GUIDANCE_ACTION",e.hideToggle=a.hideToggle,e.showHideToggle=null!=a.hideToggleCallback,e.onCancel=function(){i.cancel()},e.onAction=function(){i.hide()},e.onHideToggle=function(t){a.hideToggleCallback&&a.hideToggleCallback(e.hideToggle)}}])}(),function(){"use strict";var e=angular.module("pipReleaseIntroDialog",["ngMaterial","pipTranslate","pipGuidance.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{GUIDANCE_TITLE:"What should you do here?",GUIDANCE_ACTION:"Do it now!",GUIDANCE_DO_NOT_SHOW:"Don't show it again"}),e.translations("ru",{GUIDANCE_TITLE:"Что здесь делать?",GUIDANCE_ACTION:"Сделать это сейчас!",GUIDANCE_DO_NOT_SHOW:"Не показывать это снова"})}]),e.factory("pipReleaseIntroDialog",["$mdDialog",function(e){return{show:function(t,i,a){e.show({targetEvent:t.event,templateUrl:"intro_guidance/intro_guidance_dialog.html",controller:"pipReleaseIntroDialogController",locals:{params:t},clickOutsideToClose:!0}).then(function(){i&&i()},function(){a&&a()})}}}]),e.controller("pipReleaseIntroDialogController",["$scope","$rootScope","$mdDialog","$mdMedia","params","$state",function(e,t,i,a,n,l){e.theme=t.$theme,e.settings=n.settings,e.admin=n.admin,e.$mdMedia=a;var o=n.guide;e.admin||e.settings[n.settingsName]&&e.settings[n.settingsName].lastId&&(n.settingsName="release"),e.number=0,e.ln=n.ln||t.$language||"en",e.data=o,_.each(e.data.pages,function(e){if(e.pic_id){var t=e.pic_id;e.picId=[],e.picId.push(t)}}),e.onChangePage=function(t){e.number=t},e.onBackPage=function(){0!=e.number&&(e.number-=1)},e.onNextPage=function(){e.number!=e.data.pages.length-1&&(e.number+=1)},e.onClose=function(){e.admin||(e.settings[n.settingsName].lastId=e.data.id,e.settings[n.settingsName].date=new Date,n.pipSettingsData.saveSettings(e.settings,n.settingsName)),i.cancel()}}])}(),function(){"use strict";var e=angular.module("pipIntroGuidance.Service",["pipReleaseIntroDialog"]);e.factory("pipGuidance",["pipReleaseIntroDialog","pipSettingsData","$rootScope",function(e,t,i){function a(i,a,n,l,o,s){i&&o.id==s.id&&e.show({guide:i,settings:a,settingsName:"intro"==i.type?"intro":"release",pipSettingsData:t,admin:n,ln:l})}function n(e,t){var i;return t.intro&&t.intro.lastId?(i=_.filter(e,function(e){return"new release"==e.type&&"completed"==e.status}),i=_.sortBy(i,function(e){return-new Date(e.created).getTime()}),!t.intro.date||i.length>0&&new Date(t.intro.date)<new Date(i[0].created)&&i[0].id!=t.release.lastId?i[0]:null):(i=_.filter(e,function(e){return"intro"==e.type&&"completed"==e.status}),i=_.sortBy(i,function(e){return-new Date(e.created).getTime()}),i[0])}return{showIntroReleaseGuide:a,findIntroReleaseGuide:n}}])}(),function(){"use strict";var e=angular.module("pipTips.Service",["pipGuidance.Templates"]);e.factory("pipTips",["$pipPopover","pipTipsData","pipRest","$timeout","$rootScope","pipSettingsData",function(e,t,i,a,n,l){function o(e){return"completed"==e.status}function s(e,t){return Math.random()-.5}function c(e,t){g=[];for(var i=_.filter(e,o),a=0;a<i.length;a++){var t=_.find(i[a].topics,function(e){return e==t});t&&g.push(i[a])}return g.sort(s),g}function r(t,a,n){function l(){t.title=t.locals.tips[t.index].title[t.locals.ln],t.content=t.locals.tips[t.index].content[t.locals.ln],t.locals.tips[t.index].pic_id&&(t.image=i.serverUrl()+"/api/parties/"+t.locals.tips[t.index].creator_id+"/files/"+t.locals.tips[t.index].pic_id+"/content"),t.link=t.locals.tips[t.index].more_url,t.image&&a(function(){var e=$(".pip-popover-backdrop"),i=e.find(".pip-popover");i.find(".pip-pic").css("background-image","url("+t.image+")")},100)}t.index=0,t.$mdMedia=n,l(),t.onNextClick=function(){t.index++,t.index==t.locals.tips.length?e.hide():(l(),e.resize())},t.$on("pipWindowResized",l)}function p(t,i,a){t&&t.length>0&&(e.hide(),e.show({element:a?a.currentTarget:null,"class":"pip-tip",cancelCallback:function(){return!1},locals:{tips:t,ln:i||"en"},controller:["$scope","$timeout","$mdMedia",r],templateUrl:"tips/tip.template.html"}))}function d(t,i,a,n,o){var s,i=i||"en",o=o||2,c=new Date;n&&n[a].tips?(s=(c.getTime()-new Date(n[a].tips).getTime())/864e5,s>o&&(e.hide(),p(t,i),n[a].tips=new Date,l.saveSettings(n,a))):n[a]&&(e.hide(),p(t,i),n[a].tips=new Date,l.saveSettings(n,a))}function u(e,i,a,n){t.readTips({item:{}},null,function(e){return c(e.data,a),n&&n(g),g},function(e){return null})}var g;return{getTips:u,filterTips:c,showTips:p,firstShowTips:d}}])}();
!function(){"use strict";angular.module("pipHelp",["pipHelp.Service","pipHelp.Page"])}(),function(e){try{e=angular.module("pipHelp.Templates")}catch(t){e=angular.module("pipHelp.Templates",[])}e.run(["$templateCache",function(e){e.put("help_page/help_page.html",'<md-toolbar class="pip-appbar-ext"></md-toolbar><pip-document width="800" min-height="400"><div class="pip-menu-container pip-help" ng-hide="manager === false"><md-list class="pip-menu pip-simple-list hide-xs" pip-selected="selected.pageIndex" pip-selected-watch="selected.navId" pip-select="onNavigationSelect($event.id)"><md-list-item class="pip-simple-list-item pip-selectable" md-ink-ripple="" pip-id="{{ page.state }}" ng-repeat="page in pages track by page.state"><p>{{page.title | translate}}</p></md-list-item></md-list><div class="pip-content-container"><pip-dropdown pip-actions="pages" class="hide-gt-xs" pip-dropdown-select="onDropdownSelect" pip-active-index="selected.pageIndex"></pip-dropdown><div class="pip-body p24-flex" ui-view="" layout="column" flex="" style="max-width: none !important"></div></div></div><div ng-show="manager === false" layout="column" layout-align="center center" flex="">{{::\'ERROR_400\' | translate}}</div></pip-document>')}])}(),function(e,t){"use strict";function i(e){e.state("help",{url:"/help",auth:!0,controller:"pipHelpPageController",templateUrl:"help_page/help_page.html"})}function a(e,i,a,n,p,l){function s(e){r(e.state)}function o(){p.showMenuNavIcon(),p.showTitleText("Help"),p.showShadowSm(),p.showLocalActions(null,[])}function r(t){c(t),e.selected.page&&a.go(t)}function c(i){e.selected.page=t.find(e.pages,function(e){return e.state==i}),e.selected.pageIndex=t.indexOf(e.pages,e.selected.page),e.selected.pageId=i}e.$mdMedia=n,e.pages=t.filter(l.getPages(),function(e){return e.visible===!0&&(e.access?e.access(i.$user,e):!0)?e:void 0}),e.selected={},c("help"!=a.current.name?a.current.name:l.getDefaultPage().state),o(),e.onNavigationSelect=r,e.onDropdownSelect=s}i.$inject=["pipStateProvider"],a.$inject=["$scope","$rootScope","$state","$mdMedia","pipAppBar","pipHelp"],e.module("pipHelp.Page",["pipState","pipHelp.Service","pipAppBar","pipSelected","pipTranslate","pipHelp.Templates"]).config(i).controller("pipHelpPageController",a)}(window.angular,window._),function(){"use strict";angular.module("pipHelp.Service",["pipState"]).provider("pipHelp",["pipAuthStateProvider",function(e){function t(e){return"help."+e}function i(){return _.clone(o,!0)}function a(){return _.clone(_.find(o,function(e){return e.state==s}),!0)}function n(i){if(l(i),_.find(o,function(e){return e.state==t(i.state)}))throw new Error('Page with state name "'+i.state+'" is already registered');o.push({state:t(i.state),title:i.title,access:i.access,visible:i.visible!==!1,stateConfig:_.clone(i.stateConfig,!0)}),e.state(t(i.state),i.stateConfig),"undefined"==typeof s&&1===o.length&&p(i.state)}function p(i){if(!_.find(o,function(e){return e.state==t(i)}))throw new Error('Page with state name "'+i+'" is not registered');s=t(i),e.redirect("help",t(i))}function l(e){if(!e||!_.isObject(e))throw new Error("Invalid object");if(null==e.state||""==e.state)throw new Error("Page should have valid Angular UI router state name");if(e.access&&!_.isFunction(e.access))throw new Error('"access" should be a function');if(!e.stateConfig||!_.isObject(e.stateConfig))throw new Error("Invalid state configuration object")}var s,o=[];this.addPage=n,this.setDefaultPage=p,this.getPages=i,this.getDefaultPage=a,this.$get=function(){return{getPages:i,getDefaultPage:a,addPage:n,setDefaultPage:p}}}])}();
!function(){"use strict";angular.module("pipSupport",["pipFeedback","pipAnalytics"])}(),function(t){try{t=angular.module("pipSupport.Templates")}catch(e){t=angular.module("pipSupport.Templates",[])}t.run(["$templateCache",function(t){t.put("feedback/feedback.html",'<md-toolbar class="pip-appbar-ext"></md-toolbar><pip-document width="800"><pip-feedback-panel data="data" pip-created="$panel = $control" show-pictures="showPictures" show-documents="showDocuments" save-callback="saveCallback" type-collection="typeCollection"></pip-feedback-panel><div class="pip-footer"><pip-content-switch class="hide-xs"></pip-content-switch><div flex=""></div><div layout="row" class="flex-fixed"><md-button ng-show="transaction.busy()" ng-click="transaction.abort()" class="md-raised md-warn">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" ng-click="goBack()">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-hide="transaction.busy()" ng-click="onSave()" ng-disabled="data.content == \'\' && data.title == \'\'">{{::\'SEND\' | translate}}</md-button></div></div></pip-document>')}])}(),function(t){try{t=angular.module("pipSupport.Templates")}catch(e){t=angular.module("pipSupport.Templates",[])}t.run(["$templateCache",function(t){t.put("feedback/feedback_dialog.html",'<md-dialog width="800" class="pip-feedback-dialog"><md-dialog-content class="lp24-flex rp24-flex"><pip-feedback-panel data="data" pip-created="$panel = $control" show-pictures="showPictures" show-documents="showDocuments" save-callback="saveCallback" type-collection="typeCollection"></pip-feedback-panel></md-dialog-content><md-dialog-actions layout="row"><pip-content-switch class="show-gt-sm"></pip-content-switch><div flex=""></div><div layout="row" class="flex-fixed"><md-button ng-show="transaction.busy()" ng-click="transaction.abort()" class="md-raised md-warn">{{::\'CANCEL\' | translate}}</md-button><md-button ng-hide="transaction.busy()" ng-click="goBack()">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-hide="transaction.busy()" ng-click="onSave()" ng-disabled="data.content == \'\' && data.title == \'\'">{{::\'SEND\' | translate}}</md-button></div></md-dialog-actions></md-dialog>')}])}(),function(t){try{t=angular.module("pipSupport.Templates")}catch(e){t=angular.module("pipSupport.Templates",[])}t.run(["$templateCache",function(t){t.put("feedback/feedback_panel.html",'<div class="pip-body tp24-flex"><div class="pip-content" layout="column"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate" class="pip-progress-ontop"></md-progress-linear><form name="form" novalidate=""><md-input-container class="md-block hide-gt-xs"><md-select ng-model="typeIndex" ng-disabled="transaction.busy()" aria-label="DROPDOWN"><md-option ng-repeat="action in typeCollection" value="{{ ::$index }}">{{ (action.title || action.name) | translate }}</md-option></md-select></md-input-container><pip-toggle-buttons ng-model="data.type" pip-buttons="typeCollection" class="bm16 hide-xs"></pip-toggle-buttons><p class="tm0 bm16 text-small text-grey line-height-string" ng-if="data.type==\'feedback\' || data.type==\'support\'">{{::\'FEEDBACK_HINT_FEEDBACK\' | translate}}</p><div ng-if="data.type==\'copyright\'"><p class="tm0 bm16 text-small text-grey line-height-string">{{::\'FEEDBACK_HINT_COPYRIGHT\' | translate}}</p><p class="tm0 bm16 text-small text-grey line-height-string">{{::\'FEEDBACK_HINT_COPYRIGHT2\' | translate }}</p></div><div class="pip-ref-item"><pip-avatar pip-party-id="$party.id" pip-party-name="$party.name" class="pip-pic pip-face"></pip-avatar><div class="pip-content"><p class="pip-title">{{$party.name}}</p><p class="pip-subtitle">{{$party.email}}</p></div></div><div ng-if="data.type!=\'copyright\'"><md-input-container class="md-block" md-no-float=""><input type="text" ng-model="data.title" ng-disabled="transaction.busy()" placeholder="{{:: \'SUBJECT\' | translate}}"></md-input-container><md-input-container class="md-block" md-no-float=""><textarea ng-model="data.content" ng-disabled="transaction.busy()" placeholder="{{::\'FEEDBACK_MESSAGE\'|translate}}">\n                        </textarea></md-input-container></div><div ng-if="data.type==\'copyright\'"><md-input-container class="md-block"><label>{{::\'FEEDBACK_COMPANY\'|translate}}</label> <input type="text" ng-model="data.company_name" ng-disabled="transaction.busy()" placeholder="Company Name"></md-input-container><md-input-container class="md-block"><label>{{::\'FEEDBACK_ADDRESS\'|translate}}</label> <input type="text" ng-model="data.company_addr" ng-disabled="transaction.busy()"></md-input-container><md-input-container class="md-block"><label>{{::\'FEEDBACK_COPYRIGHT_HOLDER\' | translate}}</label> <input name="data.copyright_holder" ng-model="data.copyright_holder" ng-disabled="transaction.busy()" step="any" type="text" tabindex="0" required=""><div ng-messages="errorsWithHint(form.data.copyright_holder)"><div ng-message="hint">{{::\'FEEDBACK_COPYRIGHT_HOLDER_HINT\' | translate}}</div></div></md-input-container><md-input-container class="md-block" flex=""><label>{{::\'FEEDBACK_ORIGINAL_LOCATION\'|translate}}</label> <input type="text" ng-model="data.original_loc" ng-disabled="transaction.busy()"></md-input-container><md-input-container class="md-block"><label>{{::\'FEEDBACK_DESCRIBE_COPYRIGHTED\' | translate}}</label> <input name="data.copyrighted_work" ng-model="data.copyrighted_work" ng-disabled="transaction.busy()" step="any" type="text" tabindex="0" required=""><div ng-messages="errorsWithHint(form.data.copyrighted_work)"><div ng-message="hint">{{::\'FEEDBACK_DESCRIBE_COPYRIGHTED_HINT\'| translate}}</div></div></md-input-container><md-input-container class="md-block"><label>{{::\'FEEDBACK_UNAUTHORIZE_LOCATION\' | translate}}</label> <textarea name="data.unauth_loc" ng-model="data.unauth_loc" ng-disabled="transaction.busy()" step="any" type="text" tabindex="0" required=""></textarea><div ng-messages="errorsWithHint(form.data.unauth_loc)"><div ng-message="hint">{{::\'FEEDBACK_UNAUTHORIZE_LOCATION_HINT\' | translate}}</div></div></md-input-container><div layout="row" class="bm16"><md-checkbox ng-model="data.copyright_conc" class="lm0 bm0 flex-fixed" aria-label="FEEDBACK_COPYRIGHT_CONC" style="min-width: 24px; margin-top: -2px"></md-checkbox><p class="m0 text-small text-grey line-height-string">{{::\'FEEDBACK_COPYRIGHT_CONC\'|translate}}</p></div><div layout="row" class="bm16"><md-checkbox ng-model="data.request_conc" class="lm0 bm0 flex-fixed" aria-label="FEEDBACK_REGUEST_CONC" style="min-width: 24px; margin-top: -2px"></md-checkbox><p class="m0 text-small text-grey line-height-string">{{::\'FEEDBACK_REGUEST_CONC\'|translate}}</p></div><md-input-container class="md-block"><label>{{::\'FEEDBACK_SIGNATURE\' | translate}}</label> <input name="data.signature" ng-model="data.signature" ng-disabled="transaction.busy()" step="any" type="text" tabindex="0" required=""><div ng-messages="errorsWithHint(form.data.signature)"><div ng-message="hint">{{::\'FEEDBACK_SIGNATURE_HINT\' | translate}}</div></div></md-input-container></div><pip-picture-list-edit class="bm8" ng-show="showPictures" pip-picture-ids="data.pic_ids" pip-created="pictures = $event.sender" ng-disabled="transaction.busy()"></pip-picture-list-edit><pip-document-list-edit ng-show="showDocuments" pip-documents="data.docs" pip-created="docs = $event.sender" ng-disabled="transaction.busy()"></pip-document-list-edit></form></div></div>')}])}(),function(){"use strict";var t=angular.module("pipFeedback",["pipAppBar","pipRest.State","pipTransactions","pipRest","pipDropdown","ngMaterial","pipTranslate","pipFeedbacksData","pipToasts","pipFeedback.Strings","pipFeedbackPanel","pipSupport.Templates"]);t.config(["pipAuthStateProvider",function(t){t.state("feedback",{url:"/feedback",controller:"FeedbackController",templateUrl:"feedback/feedback.html",auth:!0})}]),t.controller("FeedbackController",["$scope","$rootScope","$state","pipUtils","pipAppBar","pipToasts","pipTranslate",function(t,e,a,n,i,o,s){function l(){i.showBackNavIcon(),i.showTitleText("FEEDBACK_TITLE"),i.showLocalActions([{"class":"icon-send",hideSmall:!0,callback:p}],[]),i.showShadowSm()}function p(){t.$panel&&t.$panel.onSave()}function r(){t.$panel&&t.$panel.onTypeChange(t.item)}function c(){n.goBack(),o.showNotification(s.translate("FEEDBACK_SUCCESS"),null,null,null)}l(),t.data={},t.contentSwitchOption={picture:!0,document:!0,location:!1,event:!1},t.goBack=n.goBack,t.onSave=p,t.onTypeChange=r,t.saveCallback=c}])}(),function(){"use strict";var t=angular.module("pipFeedbackDialog",["pipAppBar","pipRest.State","pipTransactions","pipRest","pipDropdown","ngMaterial","pipTranslate","pipFeedbacksData","pipToasts","pipFeedback.Strings","pipFeedbackPanel","pipSupport.Templates"]);t.controller("FeedbackDialogController",["$scope","$rootScope","$state","pipUtils","party","$mdDialog","pipToasts","pipTranslate",function(t,e,a,n,i,o,s,l){function p(){t.$panel&&t.$panel.onSave()}function r(){t.$panel&&t.$panel.onTypeChange(t.item)}function c(){o.cancel(),s.showNotification(l.translate("FEEDBACK_SUCCESS"),null,null,null)}e.$party=i,t.data={},t.contentSwitchOption={picture:!0,document:!0,location:!1,event:!1},t.goBack=o.cancel,t.onSave=p,t.onTypeChange=r,t.saveCallback=c}])}(),function(){"use strict";var t=angular.module("pipFeedbackPanel",["pipUtils","pipFocused","pipSupport.Templates"]);t.directive("pipFeedbackPanel",function(){return{restrict:"EA",replace:!0,scope:{data:"=",created:"&pipCreated",showPictures:"=",showDocuments:"=",typeCollection:"=typeCollection",saveCallback:"="},templateUrl:"feedback/feedback_panel.html",controller:"pipFeedbackPanelController"}}),t.controller("pipFeedbackPanelController",["$scope","$rootScope","$state","pipUtils","pipAppBar","pipTranslate","pipFeedbacksData","pipTransaction","pipToasts","pipFormErrors","$mdDialog",function(t,e,a,n,i,o,s,l,p,r,c){function d(){t.form.$setSubmitted(),t.form.$invalid||s.createFeedbackWithFiles({transaction:t.transaction,pictures:t.pictures,documents:t.docs,item:t.data},t.saveCallback)}function u(e){t.data.type=t.typeCollection[t.typeIndex],t.type=e.name}t.$party=e.$party,t.typeCollection=[{id:"support",name:"SUPPORT"},{id:"feedback",name:"FEEDBACK"},{id:"copyright",name:"COPYRIGHT"},{id:"business",name:"BUSINESS"},{id:"advertising",name:"ADVERTISING"}],o.translateObjects(t.typeCollection,"name","name"),t.transaction=l("feedback",t),t.type=o.translate("FEEDBACK"),t.data.sender_id=e.$party.id,t.data.sender_name=e.$party.name,t.data.sender_email=e.$party.email,t.data.pic_ids=[],t.data.docs=[],t.data.type=t.typeCollection[0].id,t.$control={},t.$control.goBack=n.goBack,t.$control.onSave=d,t.$control.onTypeChange=u,t.created&&t.created({$control:t.$control}),t.errorsWithHint=r.errorsWithHint,t.onTypeChange=u}])}(),function(){"use strict";var t=angular.module("pipFeedback.Strings",["pipTranslate"]);t.config(["pipTranslateProvider",function(t){t.translations("en",{FEEDBACK_TITLE:"Contact us",FEEDBACK_HINT_FEEDBACK:"If you need help or you have some ideas or suggestions to improve Pip.Life just use form below",FEEDBACK_HINT_COPYRIGHT:"If you believe that content available on Pip.Life infringes one or more of your copyrights, you can use the form below to submit a DMCA notice. Upon receipt of a valid notice, we are required by law to respond to it by disabling access to the allegedly infringing content. Your Infringement Notice may be forwarded to the party that made the content available, or to third parties such as ChillingEffects.org.",FEEDBACK_HINT_COPYRIGHT2:"If you choose to request removal of content by submitting an infringement notification, please remember that you are initiating a legal process. Do not make false claims. Please be advised that under 17 U.S.C. § 512(f), you may be liable for damages (including costs and attorneys’ fees) if you knowingly misrepresent that a product or activity is infringing your copyrights. Thus, if you are not sure content located on or linked-to by Dribbble infringes your copyright, you should consider first contacting an attorney.",FEEDBACK_COMPANY:"Company name",FEEDBACK_MESSAGE:"Message",FEEDBACK_ADDRESS:"Address",FEEDBACK_COPYRIGHT_HOLDER:"Copyright holder you represent",FEEDBACK_COPYRIGHT_HOLDER_HINT:"If representing someone other than yourself",FEEDBACK_ORIGINAL_LOCATION:"Location of original copyrighted work",FEEDBACK_DESCRIBE_COPYRIGHTED:"Describe the copyrighted work",FEEDBACK_DESCRIBE_COPYRIGHTED_HINT:"Helps us identify the specific referenced work",FEEDBACK_UNAUTHORIZE_LOCATION:"Location of unauthorized material",FEEDBACK_UNAUTHORIZE_LOCATION_HINT:"Please provide specific page URLs, one per line",FEEDBACK_COPYRIGHT_CONC:"I have a good faith belief that use of the copyrighted materials described above as allegedly infringing is not authorized by the copyright owner, its agent, or the law",FEEDBACK_REGUEST_CONC:"I swear, under penalty of perjury, that the information in the notification is accurate and that I am the copyright owner or am authorized to act on behalf of the owner of an exclusive right that is allegedly infringed.",FEEDBACK_SIGNATURE:"You first and last name",FEEDBACK_SIGNATURE_HINT:"Signature",FEEDBACK_SUBJECT:"Subject",FEEDBACK_SUCCESS:"Your message was sent to Pip.Life support team. They will contact you via personal messaging soon. Thanks for your interest in PipLife!"}),t.translations("ru",{FEEDBACK_TITLE:"Обратная связь",FEEDBACK_HINT_FEEDBACK:"Если Вам нужна помощь или у вас есть идеи или предложения по улучшению Pip.Life используйте рассположенную ниже форму",FEEDBACK_HINT_COPYRIGHT:"Если вы считаете, что контент, доступный на Pip.Life нарушает одно или более ваших авторских прав, вы можете использовать форму ниже, чтобы представить уведомление DMCA. После получения уведомления, мы по закону обязаны ответить на него, отключив доступ к контенту, который предположительно нарушает авторские права. Уведомление может быть направлено со стороны, представившей контент или третьих сторон, таких как ChillingEffects.org.",FEEDBACK_HINT_COPYRIGHT2:"Если вы решите запросить удаление содержания, подав уведомление о нарушении, пожалуйста, помните, что вы инициируете судебный процесс. Пожалуйста, обратите внимание, что исодя из статьи 17 U.S.C. § 512 (F), вы можете нести ответственность за убытки (включая расходы и гонорары адвокатам), если вы сознательно искажаете действительность, что продукт или деятельность нарушает ваши авторские права. Таким образом, если вы не уверены, что содержание, расположенное на PipLife нарушает Ваши авторские права посоветуйтесь с адвокатом.",FEEDBACK_COMPANY:"Название компании",FEEDBACK_MESSAGE:"Сообщение",FEEDBACK_ADDRESS:"Адрес",FEEDBACK_COPYRIGHT_HOLDER:"Владелец авторского права",FEEDBACK_COPYRIGHT_HOLDER_HINT:"Заполните поле, если Вы  представляете кого-то кроме себя",FEEDBACK_ORIGINAL_LOCATION:"Расположение оригинальной авторской работы",FEEDBACK_DESCRIBE_COPYRIGHTED:"Опишите авторские права на произведение",FEEDBACK_DESCRIBE_COPYRIGHTED_HINT:"Это поможет нам идентифицировать ссылки на работу",FEEDBACK_UNAUTHORIZE_LOCATION:"Расположение несанкционированного материала",FEEDBACK_UNAUTHORIZE_LOCATION_HINT:"Пожалуйста, укажите конкретную страницу URL, по одной в строке",FEEDBACK_COPYRIGHT_CONC:"У меня есть добросовестное предположение, что использование защищенных авторским правом материалов, описанных выше, в качестве якобы нарушает авторские права, не разрешено владельцем авторского права, его агентом или законом",FEEDBACK_REGUEST_CONC:"Я клянусь под страхом наказания за лжесвидетельство, что содержащаяся в уведомлении информация верна и что я являюсь владельцем авторского права или имею право действовать от имени владельца эксклюзивных прав, которые якобы нарушены.",FEEDBACK_SIGNATURE:"Ваше имя и фамилия",FEEDBACK_SIGNATURE_HINT:"Подпись",FEEDBACK_SUBJECT:"Заголовок",FEEDBACK_SUCCESS:"Ваш запрос передан команде технической поддержки Pip.Life. C вами свяжутся в ближайшее время по электронной почте. Спасибо за ваш интерес и поддержку PipLife."})}])}(),function(){"use strict";var t=angular.module("pipAnalytics",[]);t.run(["$rootScope","$location","pipAnalytics",function(t,e,a){t.$on("$stateChangeSuccess",function(n,i,o,s,l){var p=e.url(),r=(t.$user||{}).id,c=t.$language||"en",d=p.indexOf("?");d>0&&(p=p.substring(0,d)),a.pageView(p,r,c)})}]),t.provider("pipAnalytics",function(){function t(t){return t&&(i=t,n=!0,window.GoogleAnalyticsObject="ga",window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=1*new Date,window.ga("create",t)),n}function e(t,e,a){n&&window.ga&&window.ga("send","pageview",{page:t,userId:e,language:a})}function a(t,e,a,i,o){n&&window.ga&&window.ga("send","event",{eventCategory:t,eventAction:e,eventValue:a,userId:i,language:o})}var n=!1,i=null;this.enable=t,this.$get=function(){return{enabled:n,trackingId:i,pageView:e,event:a}}})}();